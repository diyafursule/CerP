current path: saved_models/model_cifar100_Oct.25_17.34.19_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4751/5308 (89.5064%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43909497416931. Distance: 2.2822668866115623
Total norm for 4 adversaries is: 42.43909497416931. distance: 2.2822668866115623
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5786, Accuracy: 8562/9900 (86.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5304/5777 (91.8124%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.42959471657136. Distance: 2.1739404311735444
Total norm for 4 adversaries is: 42.42959471657136. distance: 2.1739404311735444
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5813, Accuracy: 8559/9900 (86.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4581/5123 (89.4203%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.43914099597873. Distance: 2.264222230403806
Total norm for 4 adversaries is: 42.43914099597873. distance: 2.264222230403806
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4704, Accuracy: 8755/9900 (88.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4940/5503 (89.7692%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.43932076819356. Distance: 2.305209860360912
Total norm for 4 adversaries is: 42.43932076819356. distance: 2.305209860360912
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5300, Accuracy: 8604/9900 (86.9091%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6154/6947 (88.5850%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6172/6947 (88.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0249, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3575/4028 (88.7537%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3698/4028 (91.8073%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9084, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4121/4736 (87.0144%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4247/4736 (89.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8904, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3440/3959 (86.8906%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3578/3959 (90.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8619, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5472/6235 (87.7626%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5444/6235 (87.3136%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1949, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4528/5224 (86.6769%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4726/5224 (90.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9758, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3456/3929 (87.9613%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3569/3929 (90.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9204, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4571/5068 (90.1934%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4684/5068 (92.4230%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9482, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4300/4732 (90.8707%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4386/4732 (92.6881%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7710, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4437/4911 (90.3482%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4508/4911 (91.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9339, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4286/4869 (88.0263%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4030/4869 (82.7685%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2978, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3758/4249 (88.4443%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3846/4249 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9937, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4423/4929 (89.7342%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4454/4929 (90.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0390, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5115/5696 (89.7999%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5115/5696 (89.7999%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0440, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3915/4364 (89.7113%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3905/4364 (89.4821%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0252, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4524/5035 (89.8510%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4639/5035 (92.1351%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0951, Accuracy: 5282/10000 (52.8200%)
time spent on training: 267.5697727203369
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1047, Accuracy: 7045/10000 (70.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8504, Accuracy: 138/9900 (1.3939%)
Done in 302.1022756099701 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4872/5308 (91.7860%), train_poison_data_count: 415
Global model norm: 42.45326158194813.
Norm before scaling: 42.45557478209575. Distance: 2.0671889439907205
Total norm for 4 adversaries is: 42.45557478209575. distance: 2.0671889439907205
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2291, Accuracy: 9314/9900 (94.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5374/5777 (93.0241%), train_poison_data_count: 455
Global model norm: 42.45326158194813.
Norm before scaling: 42.44509033279792. Distance: 1.9895758171006144
Total norm for 4 adversaries is: 42.44509033279792. distance: 1.9895758171006144
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2225, Accuracy: 9334/9900 (94.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4608/5123 (89.9473%), train_poison_data_count: 403
Global model norm: 42.45326158194813.
Norm before scaling: 42.45746665322102. Distance: 2.1496668402234564
Total norm for 4 adversaries is: 42.45746665322102. distance: 2.1496668402234564
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1217, Accuracy: 9577/9900 (96.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5043/5503 (91.6409%), train_poison_data_count: 430
Global model norm: 42.45326158194813.
Norm before scaling: 42.45580048847492. Distance: 2.1040615269545246
Total norm for 4 adversaries is: 42.45580048847492. distance: 2.1040615269545246
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2921, Accuracy: 9169/9900 (92.6162%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4498/5123 (87.8001%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4210/5123 (82.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0267, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4547/5068 (89.7198%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4607/5068 (90.9037%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1363, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4345/5018 (86.5883%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4447/5018 (88.6210%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3219, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3748/4161 (90.0745%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3788/4161 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9717, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4302/4894 (87.9036%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4336/4894 (88.5983%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1133, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4416/4956 (89.1041%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4572/4956 (92.2518%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9914, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4094/4587 (89.2522%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4146/4587 (90.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9911, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6197/6947 (89.2040%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6188/6947 (89.0744%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2077, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4496/5055 (88.9416%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4592/5055 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0858, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4422/4929 (89.7139%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4437/4929 (90.0183%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3077, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4213/4797 (87.8257%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4269/4797 (88.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9861, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4865/5645 (86.1825%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4894/5645 (86.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3666, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4852/5362 (90.4886%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4873/5362 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0169, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4784/5489 (87.1561%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4911/5489 (89.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1576, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3680/4108 (89.5813%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3817/4108 (92.9163%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0021, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3720/4130 (90.0726%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3814/4130 (92.3487%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0368, Accuracy: 5507/10000 (55.0700%)
time spent on training: 282.3909225463867
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0965, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.4939, Accuracy: 335/9900 (3.3838%)
Done in 318.4136109352112 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4887/5308 (92.0686%), train_poison_data_count: 415
Global model norm: 42.47628876705067.
Norm before scaling: 42.47564645761366. Distance: 1.9791461207343983
Total norm for 4 adversaries is: 42.47564645761366. distance: 1.9791461207343983
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3091, Accuracy: 9132/9900 (92.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5397/5777 (93.4222%), train_poison_data_count: 455
Global model norm: 42.47628876705067.
Norm before scaling: 42.469701401226914. Distance: 1.9622418446433934
Total norm for 4 adversaries is: 42.469701401226914. distance: 1.9622418446433934
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2997, Accuracy: 9131/9900 (92.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4683/5123 (91.4113%), train_poison_data_count: 403
Global model norm: 42.47628876705067.
Norm before scaling: 42.47428996012985. Distance: 1.966173514535496
Total norm for 4 adversaries is: 42.47428996012985. distance: 1.966173514535496
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2915, Accuracy: 9203/9900 (92.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5017/5503 (91.1685%), train_poison_data_count: 430
Global model norm: 42.47628876705067.
Norm before scaling: 42.47552288018727. Distance: 2.0842830654841986
Total norm for 4 adversaries is: 42.47552288018727. distance: 2.0842830654841986
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1039, Accuracy: 9647/9900 (97.4444%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4094/4537 (90.2358%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4189/4537 (92.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8327, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4545/5123 (88.7175%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4487/5123 (87.5854%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2361, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3850/4196 (91.7541%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3940/4196 (93.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8297, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4133/4605 (89.7503%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4249/4605 (92.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8605, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4324/4851 (89.1363%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4425/4851 (91.2183%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8720, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3673/4145 (88.6128%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3796/4145 (91.5802%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9449, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4538/5035 (90.1291%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4644/5035 (92.2344%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9309, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3685/4175 (88.2635%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3792/4175 (90.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0333, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5451/5939 (91.7831%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5499/5939 (92.5913%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9792, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4002/4368 (91.6209%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4072/4368 (93.2234%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0122, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4003/4587 (87.2684%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4147/4587 (90.4077%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0198, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4130/4397 (93.9277%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4199/4397 (95.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7562, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4275/4869 (87.8004%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4199/4869 (86.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0774, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5151/5696 (90.4319%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5166/5696 (90.6952%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0072, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3173/3552 (89.3300%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3271/3552 (92.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8365, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4161/4736 (87.8590%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4270/4736 (90.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0167, Accuracy: 5409/10000 (54.0900%)
time spent on training: 257.7422649860382
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0909, Accuracy: 7084/10000 (70.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.4080, Accuracy: 666/9900 (6.7273%)
Done in 293.28445982933044 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4907/5308 (92.4454%), train_poison_data_count: 415
Global model norm: 42.49613091303872.
Norm before scaling: 42.49677865778843. Distance: 1.9502516706381523
Total norm for 4 adversaries is: 42.49677865778843. distance: 1.9502516706381523
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1167, Accuracy: 9612/9900 (97.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5394/5777 (93.3703%), train_poison_data_count: 455
Global model norm: 42.49613091303872.
Norm before scaling: 42.48653710248621. Distance: 1.938704885109134
Total norm for 4 adversaries is: 42.48653710248621. distance: 1.938704885109134
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1384, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4628/5123 (90.3377%), train_poison_data_count: 403
Global model norm: 42.49613091303872.
Norm before scaling: 42.49987074888434. Distance: 2.06503648554826
Total norm for 4 adversaries is: 42.49987074888434. distance: 2.06503648554826
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1597, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5062/5503 (91.9862%), train_poison_data_count: 430
Global model norm: 42.49613091303872.
Norm before scaling: 42.49751830989664. Distance: 2.0085248462753627
Total norm for 4 adversaries is: 42.49751830989664. distance: 2.0085248462753627
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1890, Accuracy: 9412/9900 (95.0707%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4632/5068 (91.3970%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4537/5068 (89.5225%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3531, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3467/3959 (87.5726%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3566/3959 (90.0733%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9072, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5489/6068 (90.4581%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5531/6068 (91.1503%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9893, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5306/5907 (89.8256%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5323/5907 (90.1134%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4666, Accuracy: 4757/10000 (47.5700%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4509/4956 (90.9806%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4569/4956 (92.1913%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9360, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4236/4903 (86.3961%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4403/4903 (89.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2818, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4993/5727 (87.1835%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5105/5727 (89.1392%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0713, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4891/5346 (91.4890%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4967/5346 (92.9106%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1210, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5373/5871 (91.5176%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5389/5871 (91.7902%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9878, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4336/4889 (88.6889%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4401/4889 (90.0184%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1559, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4849/5497 (88.2118%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4949/5497 (90.0309%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0530, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4246/4818 (88.1279%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4276/4818 (88.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9345, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4122/4397 (93.7457%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8438, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3727/4130 (90.2421%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3795/4130 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9236, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3989/4364 (91.4070%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3955/4364 (90.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9407, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4835/5702 (84.7948%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4615/5702 (80.9365%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1721, Accuracy: 5016/10000 (50.1600%)
time spent on training: 277.00150871276855
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0927, Accuracy: 7073/10000 (70.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.5226, Accuracy: 1129/9900 (11.4040%)
Done in 311.69020342826843 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4927/5308 (92.8222%), train_poison_data_count: 415
Global model norm: 42.5189238659535.
Norm before scaling: 42.51294179101892. Distance: 1.875174387133761
Total norm for 4 adversaries is: 42.51294179101892. distance: 1.875174387133761
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2295, Accuracy: 9347/9900 (94.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5441/5777 (94.1838%), train_poison_data_count: 455
Global model norm: 42.5189238659535.
Norm before scaling: 42.506645849869756. Distance: 1.8238957055750373
Total norm for 4 adversaries is: 42.506645849869756. distance: 1.8238957055750373
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2095, Accuracy: 9395/9900 (94.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4654/5123 (90.8452%), train_poison_data_count: 403
Global model norm: 42.5189238659535.
Norm before scaling: 42.52008228426819. Distance: 1.992955676805662
Total norm for 4 adversaries is: 42.52008228426819. distance: 1.992955676805662
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1744, Accuracy: 9472/9900 (95.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5107/5503 (92.8039%), train_poison_data_count: 430
Global model norm: 42.5189238659535.
Norm before scaling: 42.51631264374078. Distance: 1.9383269360350082
Total norm for 4 adversaries is: 42.51631264374078. distance: 1.9383269360350082
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1014, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4564/4956 (92.0904%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4545/4956 (91.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0121, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3670/4145 (88.5404%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3748/4145 (90.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0235, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4231/4797 (88.2010%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4333/4797 (90.3273%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8897, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4635/5193 (89.2548%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4603/5193 (88.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2830, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5434/5871 (92.5566%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5370/5871 (91.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1046, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3869/4196 (92.2069%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3948/4196 (94.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9472, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4424/4979 (88.8532%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4527/4979 (90.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9961, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4854/5362 (90.5259%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4862/5362 (90.6751%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9998, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5061/5727 (88.3709%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5050/5727 (88.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1445, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4908/5461 (89.8736%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4941/5461 (90.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1714, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5119/5696 (89.8701%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5157/5696 (90.5372%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9512, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4176/4605 (90.6840%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4280/4605 (92.9425%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9405, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4342/4843 (89.6552%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4401/4843 (90.8734%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1513, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4883/5298 (92.1669%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4908/5298 (92.6387%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9879, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4836/5427 (89.1100%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4835/5427 (89.0916%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0230, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4433/4830 (91.7805%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4431/4830 (91.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1005, Accuracy: 5424/10000 (54.2400%)
time spent on training: 278.07781648635864
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0963, Accuracy: 7056/10000 (70.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.6855, Accuracy: 1766/9900 (17.8384%)
Done in 311.6043257713318 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4940/5308 (93.0671%), train_poison_data_count: 415
Global model norm: 42.5412885379457.
Norm before scaling: 42.53795553541346. Distance: 1.841161171194143
Total norm for 4 adversaries is: 42.53795553541346. distance: 1.841161171194143
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2223, Accuracy: 9378/9900 (94.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5457/5777 (94.4608%), train_poison_data_count: 455
Global model norm: 42.5412885379457.
Norm before scaling: 42.52834245664149. Distance: 1.7818064573358714
Total norm for 4 adversaries is: 42.52834245664149. distance: 1.7818064573358714
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1067, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4677/5123 (91.2942%), train_poison_data_count: 403
Global model norm: 42.5412885379457.
Norm before scaling: 42.54120532366972. Distance: 1.9347958921871935
Total norm for 4 adversaries is: 42.54120532366972. distance: 1.9347958921871935
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1409, Accuracy: 9545/9900 (96.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5079/5503 (92.2951%), train_poison_data_count: 430
Global model norm: 42.5412885379457.
Norm before scaling: 42.5429843520424. Distance: 1.964556572557577
Total norm for 4 adversaries is: 42.5429843520424. distance: 1.964556572557577
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1390, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3972/4364 (91.0174%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3995/4364 (91.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9273, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4798/5353 (89.6320%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4833/5353 (90.2858%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9050, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4222/4672 (90.3682%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4311/4672 (92.2731%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8096, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3719/4145 (89.7226%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3767/4145 (90.8806%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0002, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3925/4313 (91.0039%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3949/4313 (91.5604%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9311, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4360/4889 (89.1798%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4410/4889 (90.2025%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0614, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4403/5050 (87.1881%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4495/5050 (89.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9666, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4814/5702 (84.4265%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0112, Accuracy: 4518/5702 (79.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2307, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4935/5461 (90.3681%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4917/5461 (90.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2311, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4539/5122 (88.6177%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0122, Accuracy: 4010/5122 (78.2897%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3903, Accuracy: 4693/10000 (46.9300%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4272/4714 (90.6237%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4349/4714 (92.2571%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2041, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3537/3968 (89.1381%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3635/3968 (91.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8409, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3496/3959 (88.3051%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3633/3959 (91.7656%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9261, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4531/4956 (91.4245%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4561/4956 (92.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9840, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4266/4818 (88.5430%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4316/4818 (89.5807%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9832, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3982/4368 (91.1630%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4020/4368 (92.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1161, Accuracy: 5270/10000 (52.7000%)
time spent on training: 263.81383085250854
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1014, Accuracy: 7039/10000 (70.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 4.0065, Accuracy: 2518/9900 (25.4343%)
Done in 301.60235261917114 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5308 (93.0294%), train_poison_data_count: 415
Global model norm: 42.562504302037226.
Norm before scaling: 42.55768718200332. Distance: 1.8478027027631017
Total norm for 4 adversaries is: 42.55768718200332. distance: 1.8478027027631017
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1045, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5474/5777 (94.7551%), train_poison_data_count: 455
Global model norm: 42.562504302037226.
Norm before scaling: 42.55122286589203. Distance: 1.7282603619558847
Total norm for 4 adversaries is: 42.55122286589203. distance: 1.7282603619558847
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1977, Accuracy: 9405/9900 (95.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4732/5123 (92.3678%), train_poison_data_count: 403
Global model norm: 42.562504302037226.
Norm before scaling: 42.55901807527108. Distance: 1.8584681631650095
Total norm for 4 adversaries is: 42.55901807527108. distance: 1.8584681631650095
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2043, Accuracy: 9388/9900 (94.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5128/5503 (93.1855%), train_poison_data_count: 430
Global model norm: 42.562504302037226.
Norm before scaling: 42.55956160699599. Distance: 1.8820964670500682
Total norm for 4 adversaries is: 42.55956160699599. distance: 1.8820964670500682
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2158, Accuracy: 9345/9900 (94.3939%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4373/4732 (92.4134%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4396/4732 (92.8994%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9444, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4557/5035 (90.5065%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4583/5035 (91.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8818, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4274/4797 (89.0974%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4265/4797 (88.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0945, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 4753/5702 (83.3567%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4672/5702 (81.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2242, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3791/4161 (91.1079%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3805/4161 (91.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8981, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4899/5526 (88.6536%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4885/5526 (88.4003%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0759, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4896/5497 (89.0668%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4910/5497 (89.3214%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1023, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5446/5939 (91.6989%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5478/5939 (92.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0833, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4636/5193 (89.2740%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4465/5193 (85.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.5464, Accuracy: 4656/10000 (46.5600%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4873/5559 (87.6597%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4875/5559 (87.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0792, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3539/3968 (89.1885%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3634/3968 (91.5827%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8532, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3749/4086 (91.7523%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3835/4086 (93.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9335, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4041/4527 (89.2644%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4031/4527 (89.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0376, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4027/4485 (89.7882%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3826/4485 (85.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0814, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5678/6419 (88.4561%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5536/6419 (86.2440%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3006, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4858/5489 (88.5043%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4933/5489 (89.8707%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0669, Accuracy: 5314/10000 (53.1400%)
time spent on training: 262.285222530365
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1045, Accuracy: 7032/10000 (70.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.4843, Accuracy: 3225/9900 (32.5758%)
Done in 297.44230031967163 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4949/5308 (93.2366%), train_poison_data_count: 415
Global model norm: 42.58622915993502.
Norm before scaling: 42.58361059846338. Distance: 1.8151362747862547
Total norm for 4 adversaries is: 42.58361059846338. distance: 1.8151362747862547
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2031, Accuracy: 9424/9900 (95.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5490/5777 (95.0320%), train_poison_data_count: 455
Global model norm: 42.58622915993502.
Norm before scaling: 42.57106449487213. Distance: 1.7029846553547983
Total norm for 4 adversaries is: 42.57106449487213. distance: 1.7029846553547983
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2013, Accuracy: 9392/9900 (94.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4719/5123 (92.1140%), train_poison_data_count: 403
Global model norm: 42.58622915993502.
Norm before scaling: 42.583202105554484. Distance: 1.8399253227794738
Total norm for 4 adversaries is: 42.583202105554484. distance: 1.8399253227794738
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2032, Accuracy: 9381/9900 (94.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5110/5503 (92.8584%), train_poison_data_count: 430
Global model norm: 42.58622915993502.
Norm before scaling: 42.58306164042077. Distance: 1.8711375826676895
Total norm for 4 adversaries is: 42.58306164042077. distance: 1.8711375826676895
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1305, Accuracy: 9568/9900 (96.6465%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4830/5427 (88.9994%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4888/5427 (90.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9447, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4379/4748 (92.2283%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4374/4748 (92.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0371, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4920/5645 (87.1568%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4815/5645 (85.2967%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1787, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3568/3910 (91.2532%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3460/3910 (88.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0541, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4622/5224 (88.4763%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4766/5224 (91.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9713, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4609/5068 (90.9432%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4567/5068 (90.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1392, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4580/5086 (90.0511%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4648/5086 (91.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0864, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4890/5489 (89.0873%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4952/5489 (90.2168%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1892, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5514/6235 (88.4362%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5518/6235 (88.5004%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9885, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4150/4397 (94.3825%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4198/4397 (95.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7622, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4450/4929 (90.2820%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4459/4929 (90.4646%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1461, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6227/6947 (89.6358%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6081/6947 (87.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1066, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4287/4731 (90.6151%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4347/4731 (91.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9263, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5303/6080 (87.2204%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5369/6080 (88.3059%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1806, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3192/3552 (89.8649%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3306/3552 (93.0743%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7769, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4315/4737 (91.0914%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4323/4737 (91.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0576, Accuracy: 5332/10000 (53.3200%)
time spent on training: 269.9443347454071
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1096, Accuracy: 7032/10000 (70.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 2.9095, Accuracy: 4018/9900 (40.5859%)
Done in 304.98990201950073 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4974/5308 (93.7076%), train_poison_data_count: 415
Global model norm: 42.60781361734019.
Norm before scaling: 42.604322502516546. Distance: 1.7841758122477755
Total norm for 4 adversaries is: 42.604322502516546. distance: 1.7841758122477755
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1770, Accuracy: 9455/9900 (95.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5479/5777 (94.8416%), train_poison_data_count: 455
Global model norm: 42.60781361734019.
Norm before scaling: 42.596614391488764. Distance: 1.765814711919763
Total norm for 4 adversaries is: 42.596614391488764. distance: 1.765814711919763
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2014, Accuracy: 9432/9900 (95.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4728/5123 (92.2897%), train_poison_data_count: 403
Global model norm: 42.60781361734019.
Norm before scaling: 42.6014328406701. Distance: 1.823718637532741
Total norm for 4 adversaries is: 42.6014328406701. distance: 1.823718637532741
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3619, Accuracy: 8979/9900 (90.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5120/5503 (93.0402%), train_poison_data_count: 430
Global model norm: 42.60781361734019.
Norm before scaling: 42.60244718158072. Distance: 1.814924394488305
Total norm for 4 adversaries is: 42.60244718158072. distance: 1.814924394488305
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3730, Accuracy: 8918/9900 (90.0808%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4258/4549 (93.6030%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4264/4549 (93.7349%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7050, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4272/4737 (90.1837%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4287/4737 (90.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3217, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3216/3552 (90.5405%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3302/3552 (92.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8526, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5035/5422 (92.8624%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4996/5422 (92.1431%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9612, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4876/5454 (89.4023%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4797/5454 (87.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0129, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4345/4748 (91.5122%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4339/4748 (91.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9740, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4668/5399 (86.4605%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4705/5399 (87.1458%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1761, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5444/5871 (92.7270%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5371/5871 (91.4836%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0823, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4470/4830 (92.5466%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4528/4830 (93.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0674, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4621/4993 (92.5496%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4665/4993 (93.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8955, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4306/4903 (87.8238%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4370/4903 (89.1291%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1314, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4597/5086 (90.3854%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4702/5086 (92.4499%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8851, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3730/4111 (90.7322%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3682/4111 (89.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0684, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4356/4869 (89.4640%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4103/4869 (84.2678%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3787, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3546/3910 (90.6905%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3553/3910 (90.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9573, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3729/4175 (89.3174%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3782/4175 (90.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0323, Accuracy: 5418/10000 (54.1800%)
time spent on training: 264.2032194137573
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1156, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.5500, Accuracy: 4582/9900 (46.2828%)
Done in 297.38592648506165 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4973/5308 (93.6888%), train_poison_data_count: 415
Global model norm: 42.6290793158885.
Norm before scaling: 42.622220572413134. Distance: 1.7537143661783292
Total norm for 4 adversaries is: 42.622220572413134. distance: 1.7537143661783292
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1336, Accuracy: 9571/9900 (96.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5485/5777 (94.9455%), train_poison_data_count: 455
Global model norm: 42.6290793158885.
Norm before scaling: 42.6133856289972. Distance: 1.6688462390365713
Total norm for 4 adversaries is: 42.6133856289972. distance: 1.6688462390365713
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1158, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4756/5123 (92.8362%), train_poison_data_count: 403
Global model norm: 42.6290793158885.
Norm before scaling: 42.62194849093672. Distance: 1.7888595266018812
Total norm for 4 adversaries is: 42.62194849093672. distance: 1.7888595266018812
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2604, Accuracy: 9248/9900 (93.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5151/5503 (93.6035%), train_poison_data_count: 430
Global model norm: 42.6290793158885.
Norm before scaling: 42.62255995582034. Distance: 1.811809210844468
Total norm for 4 adversaries is: 42.62255995582034. distance: 1.811809210844468
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2193, Accuracy: 9347/9900 (94.4141%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4643/5075 (91.4877%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4558/5075 (89.8128%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1349, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3416/3774 (90.5140%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3509/3774 (92.9783%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.7973, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4362/4843 (90.0681%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4448/4843 (91.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9628, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4249/4605 (92.2693%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4239/4605 (92.0521%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9108, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3487/3959 (88.0778%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3597/3959 (90.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0377, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4567/5035 (90.7051%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4617/5035 (91.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0036, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5208/5696 (91.4326%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5221/5696 (91.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0821, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4668/5399 (86.4605%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4688/5399 (86.8309%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0624, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4349/4903 (88.7008%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4356/4903 (88.8436%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0661, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4474/4911 (91.1016%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4481/4911 (91.2441%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9270, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4602/5086 (90.4837%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4628/5086 (90.9949%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1159, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4122/4537 (90.8530%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4178/4537 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9401, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4455/5018 (88.7804%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4408/5018 (87.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1944, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5467/5939 (92.0525%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5513/5939 (92.8271%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9795, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5794/6664 (86.9448%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0083, Accuracy: 5600/6664 (84.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3984, Accuracy: 4810/10000 (48.1000%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4859/5702 (85.2157%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0111, Accuracy: 4521/5702 (79.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3848, Accuracy: 4785/10000 (47.8500%)
time spent on training: 270.19529962539673
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1231, Accuracy: 6997/10000 (69.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.1672, Accuracy: 5252/9900 (53.0505%)
Done in 308.8860807418823 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4996/5308 (94.1221%), train_poison_data_count: 415
Global model norm: 42.65100557275511.
Norm before scaling: 42.641052982003885. Distance: 1.667958386855797
Total norm for 4 adversaries is: 42.641052982003885. distance: 1.667958386855797
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1050, Accuracy: 9643/9900 (97.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5512/5777 (95.4128%), train_poison_data_count: 455
Global model norm: 42.65100557275511.
Norm before scaling: 42.63219044465549. Distance: 1.638215175273076
Total norm for 4 adversaries is: 42.63219044465549. distance: 1.638215175273076
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0974, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4772/5123 (93.1485%), train_poison_data_count: 403
Global model norm: 42.65100557275511.
Norm before scaling: 42.64387698299282. Distance: 1.7475611859089464
Total norm for 4 adversaries is: 42.64387698299282. distance: 1.7475611859089464
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1797, Accuracy: 9426/9900 (95.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5175/5503 (94.0396%), train_poison_data_count: 430
Global model norm: 42.65100557275511.
Norm before scaling: 42.64247001550728. Distance: 1.752370046893635
Total norm for 4 adversaries is: 42.64247001550728. distance: 1.752370046893635
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1763, Accuracy: 9447/9900 (95.4242%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3970/4364 (90.9716%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4004/4364 (91.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1665, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4347/4894 (88.8230%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4372/4894 (89.3339%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9958, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4700/5068 (92.7388%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4608/5068 (90.9234%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1332, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3955/4313 (91.6995%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3971/4313 (92.0705%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8624, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5505/6068 (90.7218%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5479/6068 (90.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1397, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4957/5645 (87.8122%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4896/5645 (86.7316%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.5131, Accuracy: 4763/10000 (47.6300%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5053/5615 (89.9911%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5046/5615 (89.8664%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1893, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4138/4397 (94.1096%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4169/4397 (94.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7854, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5338/5907 (90.3674%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5309/5907 (89.8764%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.3261, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4635/5193 (89.2548%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4521/5193 (87.0595%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.4798, Accuracy: 4873/10000 (48.7300%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4679/5209 (89.8253%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4676/5209 (89.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1922, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6261/6812 (91.9113%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6209/6812 (91.1480%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1761, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4207/4605 (91.3572%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4268/4605 (92.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9373, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3562/3959 (89.9722%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3634/3959 (91.7909%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9983, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4350/4732 (91.9273%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4431/4732 (93.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8706, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4630/5075 (91.2315%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4649/5075 (91.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0877, Accuracy: 5340/10000 (53.4000%)
time spent on training: 263.9931049346924
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1311, Accuracy: 6968/10000 (69.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 1.8569, Accuracy: 5796/9900 (58.5455%)
Done in 303.40436911582947 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5017/5308 (94.5177%), train_poison_data_count: 415
Global model norm: 42.67292628465164.
Norm before scaling: 42.664485239848496. Distance: 1.6785306983574562
Total norm for 4 adversaries is: 42.664485239848496. distance: 1.6785306983574562
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2434, Accuracy: 9318/9900 (94.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5517/5777 (95.4994%), train_poison_data_count: 455
Global model norm: 42.67292628465164.
Norm before scaling: 42.65326082704214. Distance: 1.5960660075924307
Total norm for 4 adversaries is: 42.65326082704214. distance: 1.5960660075924307
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1389, Accuracy: 9559/9900 (96.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4804/5123 (93.7732%), train_poison_data_count: 403
Global model norm: 42.67292628465164.
Norm before scaling: 42.663013142881596. Distance: 1.6704806636592062
Total norm for 4 adversaries is: 42.663013142881596. distance: 1.6704806636592062
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3863, Accuracy: 8981/9900 (90.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5148/5503 (93.5490%), train_poison_data_count: 430
Global model norm: 42.67292628465164.
Norm before scaling: 42.66555530372246. Distance: 1.7629789932522746
Total norm for 4 adversaries is: 42.66555530372246. distance: 1.7629789932522746
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3248, Accuracy: 9064/9900 (91.5556%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3933/4196 (93.7321%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3978/4196 (94.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8943, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5000/5645 (88.5740%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4885/5645 (86.5368%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1403, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4935/5346 (92.3120%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4931/5346 (92.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1070, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4462/4911 (90.8573%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4458/4911 (90.7758%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9640, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3295/3589 (91.8083%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3134/3589 (87.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0540, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4265/4605 (92.6167%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4307/4605 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9806, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5550/6068 (91.4634%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5556/6068 (91.5623%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0065, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4030/4527 (89.0214%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4010/4527 (88.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9934, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4371/4869 (89.7720%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4228/4869 (86.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2561, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3749/4086 (91.7523%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3833/4086 (93.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8972, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3729/4111 (90.7079%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3751/4111 (91.2430%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2396, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4853/5702 (85.1105%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0116, Accuracy: 4440/5702 (77.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2628, Accuracy: 4976/10000 (49.7600%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4092/4485 (91.2375%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4083/4485 (91.0368%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0863, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4880/5427 (89.9208%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4859/5427 (89.5338%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9121, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4832/5353 (90.2671%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4806/5353 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1047, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4856/5489 (88.4678%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4981/5489 (90.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0386, Accuracy: 5347/10000 (53.4700%)
time spent on training: 262.83035254478455
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1335, Accuracy: 6962/10000 (69.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.6740, Accuracy: 6154/9900 (62.1616%)
Done in 297.54062819480896 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5036/5308 (94.8757%), train_poison_data_count: 415
Global model norm: 42.6956305740668.
Norm before scaling: 42.68248392014867. Distance: 1.619713105711954
Total norm for 4 adversaries is: 42.68248392014867. distance: 1.619713105711954
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1045, Accuracy: 9643/9900 (97.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5530/5777 (95.7244%), train_poison_data_count: 455
Global model norm: 42.6956305740668.
Norm before scaling: 42.67702390210246. Distance: 1.6007582715434567
Total norm for 4 adversaries is: 42.67702390210246. distance: 1.6007582715434567
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1263, Accuracy: 9582/9900 (96.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4798/5123 (93.6561%), train_poison_data_count: 403
Global model norm: 42.6956305740668.
Norm before scaling: 42.68587427129363. Distance: 1.682663521153633
Total norm for 4 adversaries is: 42.68587427129363. distance: 1.682663521153633
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4182, Accuracy: 8849/9900 (89.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5184/5503 (94.2032%), train_poison_data_count: 430
Global model norm: 42.6956305740668.
Norm before scaling: 42.68634755490478. Distance: 1.7318977328584035
Total norm for 4 adversaries is: 42.68634755490478. distance: 1.7318977328584035
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0502, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4750/5399 (87.9793%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4717/5399 (87.3680%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2371, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4028/4368 (92.2161%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3985/4368 (91.2317%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0239, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4937/5346 (92.3494%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4949/5346 (92.5739%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0357, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4382/4869 (89.9979%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4172/4869 (85.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2465, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4419/4889 (90.3866%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4445/4889 (90.9184%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9978, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4286/4797 (89.3475%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4271/4797 (89.0348%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9086, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3532/3995 (88.4105%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3614/3995 (90.4631%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0267, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4561/5123 (89.0299%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4554/5123 (88.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1765, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5532/6235 (88.7249%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5517/6235 (88.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1568, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4612/5224 (88.2848%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4670/5224 (89.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0576, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5661/6419 (88.1913%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5597/6419 (87.1943%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2221, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5018/5652 (88.7827%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4987/5652 (88.2343%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0971, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4665/5075 (91.9212%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4652/5075 (91.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9666, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5411/5871 (92.1649%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5410/5871 (92.1478%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9895, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5459/5939 (91.9178%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5424/5939 (91.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0105, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4888/5454 (89.6223%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4877/5454 (89.4206%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1422, Accuracy: 5271/10000 (52.7100%)
time spent on training: 271.1000406742096
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1402, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.4738, Accuracy: 6537/9900 (66.0303%)
Done in 304.66231322288513 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5035/5308 (94.8568%), train_poison_data_count: 415
Global model norm: 42.71999443825675.
Norm before scaling: 42.70740693863156. Distance: 1.6298556042703551
Total norm for 4 adversaries is: 42.70740693863156. distance: 1.6298556042703551
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1372, Accuracy: 9556/9900 (96.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5513/5777 (95.4302%), train_poison_data_count: 455
Global model norm: 42.71999443825675.
Norm before scaling: 42.70033350508299. Distance: 1.6186452735988124
Total norm for 4 adversaries is: 42.70033350508299. distance: 1.6186452735988124
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1264, Accuracy: 9591/9900 (96.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4808/5123 (93.8513%), train_poison_data_count: 403
Global model norm: 42.71999443825675.
Norm before scaling: 42.70994359896255. Distance: 1.6685236916693347
Total norm for 4 adversaries is: 42.70994359896255. distance: 1.6685236916693347
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3393, Accuracy: 9075/9900 (91.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5163/5503 (93.8216%), train_poison_data_count: 430
Global model norm: 42.71999443825675.
Norm before scaling: 42.71273303684233. Distance: 1.7603451941914725
Total norm for 4 adversaries is: 42.71273303684233. distance: 1.7603451941914725
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1564, Accuracy: 9502/9900 (95.9798%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4956/5461 (90.7526%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4924/5461 (90.1666%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2117, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4945/5346 (92.4991%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4925/5346 (92.1250%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0265, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4932/5489 (89.8524%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4937/5489 (89.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1324, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4513/4929 (91.5602%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4481/4929 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0051, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4531/4956 (91.4245%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4568/4956 (92.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1242, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5172/5696 (90.8006%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5187/5696 (91.0639%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0585, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3265/3589 (90.9724%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0097, Accuracy: 2950/3589 (82.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2882, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5504/6235 (88.2759%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5479/6235 (87.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1512, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3516/3959 (88.8103%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3620/3959 (91.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9816, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3742/4086 (91.5810%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3837/4086 (93.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9413, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4352/4714 (92.3207%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4333/4714 (91.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1045, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3823/4161 (91.8770%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3810/4161 (91.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2186, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4097/4485 (91.3489%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3995/4485 (89.0747%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0327, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4956/5454 (90.8691%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4976/5454 (91.2358%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9147, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5050/5422 (93.1391%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5038/5422 (92.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9491, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4583/5122 (89.4768%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4218/5122 (82.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3678, Accuracy: 4920/10000 (49.2000%)
time spent on training: 270.1931457519531
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1457, Accuracy: 6947/10000 (69.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.2801, Accuracy: 6920/9900 (69.8990%)
Done in 307.7099266052246 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5050/5308 (95.1394%), train_poison_data_count: 415
Global model norm: 42.74268229356269.
Norm before scaling: 42.72945155596357. Distance: 1.6071678507844451
Total norm for 4 adversaries is: 42.72945155596357. distance: 1.6071678507844451
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1156, Accuracy: 9600/9900 (96.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5529/5777 (95.7071%), train_poison_data_count: 455
Global model norm: 42.74268229356269.
Norm before scaling: 42.72235605665083. Distance: 1.5819907100805004
Total norm for 4 adversaries is: 42.72235605665083. distance: 1.5819907100805004
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2229, Accuracy: 9348/9900 (94.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4792/5123 (93.5389%), train_poison_data_count: 403
Global model norm: 42.74268229356269.
Norm before scaling: 42.73023003207156. Distance: 1.6571884375678714
Total norm for 4 adversaries is: 42.73023003207156. distance: 1.6571884375678714
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3136, Accuracy: 9191/9900 (92.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5191/5503 (94.3304%), train_poison_data_count: 430
Global model norm: 42.74268229356269.
Norm before scaling: 42.73039858099413. Distance: 1.6972740533090502
Total norm for 4 adversaries is: 42.73039858099413. distance: 1.6972740533090502
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1550, Accuracy: 9495/9900 (95.9091%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4589/5123 (89.5764%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4466/5123 (87.1755%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.4261, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4926/5526 (89.1422%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4905/5526 (88.7622%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1855, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4931/5362 (91.9620%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4865/5362 (90.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0967, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3784/4111 (92.0457%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3809/4111 (92.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9184, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4175/4537 (92.0212%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4209/4537 (92.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8511, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4408/4732 (93.1530%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4465/4732 (94.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7819, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4955/5497 (90.1401%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4932/5497 (89.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1100, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5352/6080 (88.0263%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5311/6080 (87.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1336, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6257/6812 (91.8526%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6194/6812 (90.9278%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1335, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4463/4889 (91.2866%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4437/4889 (90.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8576, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4323/4714 (91.7056%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4398/4714 (93.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8829, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4313/4714 (91.4934%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4368/4714 (92.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1229, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3792/4130 (91.8160%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3824/4130 (92.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8861, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4060/4485 (90.5240%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3994/4485 (89.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1353, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3752/4175 (89.8683%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3756/4175 (89.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9810, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4346/4894 (88.8026%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4322/4894 (88.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0737, Accuracy: 5385/10000 (53.8500%)
time spent on training: 257.8704173564911
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1519, Accuracy: 6938/10000 (69.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.1279, Accuracy: 7240/9900 (73.1313%)
Done in 292.82472467422485 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5034/5308 (94.8380%), train_poison_data_count: 415
Global model norm: 42.76485715879921.
Norm before scaling: 42.75106221268075. Distance: 1.617473632267408
Total norm for 4 adversaries is: 42.75106221268075. distance: 1.617473632267408
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1571, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5546/5777 (96.0014%), train_poison_data_count: 455
Global model norm: 42.76485715879921.
Norm before scaling: 42.74212966661231. Distance: 1.5383856974761625
Total norm for 4 adversaries is: 42.74212966661231. distance: 1.5383856974761625
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1794, Accuracy: 9449/9900 (95.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4809/5123 (93.8708%), train_poison_data_count: 403
Global model norm: 42.76485715879921.
Norm before scaling: 42.75353775109581. Distance: 1.65658875365971
Total norm for 4 adversaries is: 42.75353775109581. distance: 1.65658875365971
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2268, Accuracy: 9341/9900 (94.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5218/5503 (94.8210%), train_poison_data_count: 430
Global model norm: 42.76485715879921.
Norm before scaling: 42.75298240921693. Distance: 1.6777685514972525
Total norm for 4 adversaries is: 42.75298240921693. distance: 1.6777685514972525
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0996, Accuracy: 9634/9900 (97.3131%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4933/5362 (91.9993%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4884/5362 (91.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9443, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3758/4175 (90.0120%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3788/4175 (90.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0989, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3622/3910 (92.6343%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3570/3910 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1245, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4355/4714 (92.3844%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4412/4714 (93.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7946, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3922/4313 (90.9344%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3982/4313 (92.3255%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8105, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5537/6068 (91.2492%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5548/6068 (91.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0332, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3213/3552 (90.4561%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3265/3552 (91.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8498, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4373/4732 (92.4134%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4463/4732 (94.3153%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7448, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4205/4736 (88.7880%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4249/4736 (89.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0757, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4366/4757 (91.7805%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4358/4757 (91.6124%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9071, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4579/5086 (90.0315%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4580/5086 (90.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0161, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5039/5422 (92.9362%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5009/5422 (92.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9485, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4577/4956 (92.3527%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4548/4956 (91.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1141, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3490/3774 (92.4748%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3557/3774 (94.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8324, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4677/5068 (92.2849%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4657/5068 (91.8903%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9704, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4922/5346 (92.0688%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4942/5346 (92.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0582, Accuracy: 5385/10000 (53.8500%)
time spent on training: 269.538498878479
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1627, Accuracy: 6911/10000 (69.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.9664, Accuracy: 7614/9900 (76.9091%)
Done in 308.7187988758087 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5023/5308 (94.6307%), train_poison_data_count: 415
Global model norm: 42.78449272087742.
Norm before scaling: 42.771269208740605. Distance: 1.5991430103459954
Total norm for 4 adversaries is: 42.771269208740605. distance: 1.5991430103459954
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2203, Accuracy: 9348/9900 (94.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5541/5777 (95.9148%), train_poison_data_count: 455
Global model norm: 42.78449272087742.
Norm before scaling: 42.76113907098871. Distance: 1.5192706122369337
Total norm for 4 adversaries is: 42.76113907098871. distance: 1.5192706122369337
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1007, Accuracy: 9646/9900 (97.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4814/5123 (93.9684%), train_poison_data_count: 403
Global model norm: 42.78449272087742.
Norm before scaling: 42.76995633665135. Distance: 1.5934193586060046
Total norm for 4 adversaries is: 42.76995633665135. distance: 1.5934193586060046
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1035, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5229/5503 (95.0209%), train_poison_data_count: 430
Global model norm: 42.78449272087742.
Norm before scaling: 42.76912007320162. Distance: 1.6113002335417488
Total norm for 4 adversaries is: 42.76912007320162. distance: 1.6113002335417488
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3324, Accuracy: 9084/9900 (91.7576%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4620/5123 (90.1815%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4444/5123 (86.7460%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1670, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4331/4818 (89.8921%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4283/4818 (88.8958%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1143, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4601/5035 (91.3803%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4628/5035 (91.9166%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1411, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4164/4397 (94.7009%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4198/4397 (95.4742%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8813, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5273/6080 (86.7270%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5297/6080 (87.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2723, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4624/5086 (90.9162%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4636/5086 (91.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1206, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3796/4145 (91.5802%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3802/4145 (91.7250%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0309, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4846/5362 (90.3767%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4840/5362 (90.2648%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1938, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4327/4869 (88.8684%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4051/4869 (83.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2720, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3950/4364 (90.5133%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4011/4364 (91.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8380, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4442/5018 (88.5213%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4441/5018 (88.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2197, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4578/5038 (90.8694%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4634/5038 (91.9809%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8504, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3789/4108 (92.2347%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3739/4108 (91.0175%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9679, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5057/5615 (90.0623%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5085/5615 (90.5610%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0464, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4550/5055 (90.0099%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4515/5055 (89.3175%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1258, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4278/4797 (89.1807%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4340/4797 (90.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9259, Accuracy: 5572/10000 (55.7200%)
time spent on training: 271.5903902053833
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1672, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.8558, Accuracy: 7874/9900 (79.5354%)
Done in 305.1890347003937 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5082/5308 (95.7423%), train_poison_data_count: 415
Global model norm: 42.806433477578025.
Norm before scaling: 42.791600738345835. Distance: 1.5578514377391832
Total norm for 4 adversaries is: 42.791600738345835. distance: 1.5578514377391832
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1042, Accuracy: 9598/9900 (96.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5521/5777 (95.5686%), train_poison_data_count: 455
Global model norm: 42.806433477578025.
Norm before scaling: 42.78692923635164. Distance: 1.61117001769288
Total norm for 4 adversaries is: 42.78692923635164. distance: 1.61117001769288
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0955, Accuracy: 9655/9900 (97.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4820/5123 (94.0855%), train_poison_data_count: 403
Global model norm: 42.806433477578025.
Norm before scaling: 42.79280312182689. Distance: 1.6242608076396263
Total norm for 4 adversaries is: 42.79280312182689. distance: 1.6242608076396263
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1557, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5212/5503 (94.7120%), train_poison_data_count: 430
Global model norm: 42.806433477578025.
Norm before scaling: 42.793191072277345. Distance: 1.6652146769787417
Total norm for 4 adversaries is: 42.793191072277345. distance: 1.6652146769787417
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0632, Accuracy: 9726/9900 (98.2424%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4065/4527 (89.7946%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4052/4527 (89.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0181, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3802/4086 (93.0494%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3792/4086 (92.8047%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0196, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4368/4903 (89.0883%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4398/4903 (89.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0965, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3624/3968 (91.3306%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3677/3968 (92.6663%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7499, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5114/5615 (91.0775%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5115/5615 (91.0953%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0782, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4419/4748 (93.0708%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4365/4748 (91.9334%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0503, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4842/5361 (90.3190%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4846/5361 (90.3936%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0574, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4464/5050 (88.3960%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4550/5050 (90.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1683, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5039/5652 (89.1543%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4998/5652 (88.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1819, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4342/4731 (91.7776%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4377/4731 (92.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9758, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5309/5907 (89.8764%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5315/5907 (89.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.4505, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4669/5224 (89.3760%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4686/5224 (89.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1019, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3585/3959 (90.5532%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3630/3959 (91.6898%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8058, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4285/4605 (93.0510%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4286/4605 (93.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9731, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4335/4797 (90.3690%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4264/4797 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9297, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5233/5696 (91.8715%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5170/5696 (90.7654%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1448, Accuracy: 5209/10000 (52.0900%)
time spent on training: 268.6329183578491
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1660, Accuracy: 6910/10000 (69.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.8141, Accuracy: 7946/9900 (80.2626%)
Done in 306.6136095523834 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5039/5308 (94.9322%), train_poison_data_count: 415
Global model norm: 42.82820195633363.
Norm before scaling: 42.81433333209657. Distance: 1.5932186961466466
Total norm for 4 adversaries is: 42.81433333209657. distance: 1.5932186961466466
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0683, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5542/5777 (95.9321%), train_poison_data_count: 455
Global model norm: 42.82820195633363.
Norm before scaling: 42.806149734332855. Distance: 1.5675648045871022
Total norm for 4 adversaries is: 42.806149734332855. distance: 1.5675648045871022
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1668, Accuracy: 9470/9900 (95.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4817/5123 (94.0269%), train_poison_data_count: 403
Global model norm: 42.82820195633363.
Norm before scaling: 42.812504276915845. Distance: 1.567513775924672
Total norm for 4 adversaries is: 42.812504276915845. distance: 1.567513775924672
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2903, Accuracy: 9198/9900 (92.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5201/5503 (94.5121%), train_poison_data_count: 430
Global model norm: 42.82820195633363.
Norm before scaling: 42.81141792656268. Distance: 1.6113733273726007
Total norm for 4 adversaries is: 42.81141792656268. distance: 1.6113733273726007
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1388, Accuracy: 9560/9900 (96.5657%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4179/4397 (95.0421%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4191/4397 (95.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7507, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4030/4368 (92.2619%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4006/4368 (91.7125%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0531, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4785/5504 (86.9368%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4830/5504 (87.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1286, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3446/3774 (91.3090%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3513/3774 (93.0843%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9644, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4990/5526 (90.3004%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4891/5526 (88.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2490, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3976/4313 (92.1864%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3984/4313 (92.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9181, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4485/4979 (90.0783%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4551/4979 (91.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0122, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4296/4737 (90.6903%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4336/4737 (91.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1334, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4782/5399 (88.5720%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4713/5399 (87.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0948, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3773/4145 (91.0253%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3834/4145 (92.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9560, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4431/4748 (93.3235%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4371/4748 (92.0598%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1320, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4494/5050 (88.9901%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4524/5050 (89.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1340, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4439/5018 (88.4615%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4460/5018 (88.8800%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2397, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5905/6664 (88.6104%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5699/6664 (85.5192%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1396, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3997/4364 (91.5903%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4089/4364 (93.6984%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7759, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3921/4196 (93.4461%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3929/4196 (93.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8221, Accuracy: 5844/10000 (58.4400%)
time spent on training: 261.59537172317505
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1660, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7523, Accuracy: 8075/9900 (81.5657%)
Done in 296.58744716644287 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5060/5308 (95.3278%), train_poison_data_count: 415
Global model norm: 42.84797515180122.
Norm before scaling: 42.83245429140151. Distance: 1.5758217348222971
Total norm for 4 adversaries is: 42.83245429140151. distance: 1.5758217348222971
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0448, Accuracy: 9774/9900 (98.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5537/5777 (95.8456%), train_poison_data_count: 455
Global model norm: 42.84797515180122.
Norm before scaling: 42.82696493777314. Distance: 1.5608878401760247
Total norm for 4 adversaries is: 42.82696493777314. distance: 1.5608878401760247
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0721, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4852/5123 (94.7101%), train_poison_data_count: 403
Global model norm: 42.84797515180122.
Norm before scaling: 42.834201274543744. Distance: 1.5690848642839792
Total norm for 4 adversaries is: 42.834201274543744. distance: 1.5690848642839792
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2867, Accuracy: 9172/9900 (92.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5231/5503 (95.0572%), train_poison_data_count: 430
Global model norm: 42.84797515180122.
Norm before scaling: 42.83215504570573. Distance: 1.6162049630507023
Total norm for 4 adversaries is: 42.83215504570573. distance: 1.6162049630507023
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0966, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4515/4929 (91.6007%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4433/4929 (89.9371%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3891, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4677/5209 (89.7869%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4681/5209 (89.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0724, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3528/3929 (89.7938%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3559/3929 (90.5828%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9071, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4364/4818 (90.5770%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4317/4818 (89.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1849, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5249/5696 (92.1524%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5168/5696 (90.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9776, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4987/5526 (90.2461%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4907/5526 (88.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0498, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5360/5907 (90.7398%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5392/5907 (91.2815%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3013, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4855/5427 (89.4601%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4818/5427 (88.7783%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0615, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4714/5193 (90.7760%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4517/5193 (86.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2329, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4545/5055 (89.9110%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4593/5055 (90.8605%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9925, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4891/5298 (92.3179%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4910/5298 (92.6765%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9628, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4572/5122 (89.2620%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4211/5122 (82.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2478, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4063/4368 (93.0174%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4070/4368 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8845, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3772/4175 (90.3473%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3808/4175 (91.2096%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0014, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4379/4851 (90.2700%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4394/4851 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9646, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4855/5353 (90.6968%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4799/5353 (89.6507%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0050, Accuracy: 5402/10000 (54.0200%)
time spent on training: 274.2598440647125
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1730, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.6712, Accuracy: 8233/9900 (83.1616%)
Done in 309.0089225769043 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5068/5308 (95.4785%), train_poison_data_count: 415
Global model norm: 42.87122170396623.
Norm before scaling: 42.855653718780935. Distance: 1.559981032280662
Total norm for 4 adversaries is: 42.855653718780935. distance: 1.559981032280662
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0814, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5550/5777 (96.0706%), train_poison_data_count: 455
Global model norm: 42.87122170396623.
Norm before scaling: 42.84601932584067. Distance: 1.5237025103784752
Total norm for 4 adversaries is: 42.84601932584067. distance: 1.5237025103784752
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0597, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4860/5123 (94.8663%), train_poison_data_count: 403
Global model norm: 42.87122170396623.
Norm before scaling: 42.85181816810694. Distance: 1.518403956546593
Total norm for 4 adversaries is: 42.85181816810694. distance: 1.518403956546593
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1615, Accuracy: 9504/9900 (96.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5248/5503 (95.3662%), train_poison_data_count: 430
Global model norm: 42.87122170396623.
Norm before scaling: 42.85442603809655. Distance: 1.5893111402948397
Total norm for 4 adversaries is: 42.85442603809655. distance: 1.5893111402948397
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0570, Accuracy: 9738/9900 (98.3636%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4877/5427 (89.8655%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4897/5427 (90.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0291, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5020/5645 (88.9283%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4959/5645 (87.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1520, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3882/4249 (91.3627%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3905/4249 (91.9040%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9071, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 6221/6812 (91.3241%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6181/6812 (90.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9360, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4349/4757 (91.4232%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4304/4757 (90.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1550, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4910/5702 (86.1101%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4857/5702 (85.1806%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2212, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4928/5298 (93.0162%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4932/5298 (93.0917%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0244, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4136/4587 (90.1679%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4174/4587 (90.9963%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0171, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4812/5353 (89.8935%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4771/5353 (89.1276%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0852, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3701/4028 (91.8818%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3709/4028 (92.0804%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8753, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4286/4672 (91.7380%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4328/4672 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9132, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4399/4732 (92.9628%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4452/4732 (94.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8961, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3791/4130 (91.7918%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3822/4130 (92.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9323, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4928/5559 (88.6490%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4873/5559 (87.6597%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2561, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4803/5504 (87.2638%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4828/5504 (87.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1383, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4576/5123 (89.3227%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4231/5123 (82.5883%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2922, Accuracy: 5042/10000 (50.4200%)
time spent on training: 270.0591034889221
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1750, Accuracy: 6896/10000 (68.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.6130, Accuracy: 8376/9900 (84.6061%)
Done in 303.3915596008301 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5077/5308 (95.6481%), train_poison_data_count: 415
Global model norm: 42.894404432753525.
Norm before scaling: 42.874716710525476. Distance: 1.5039133839623815
Total norm for 4 adversaries is: 42.874716710525476. distance: 1.5039133839623815
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0382, Accuracy: 9799/9900 (98.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5568/5777 (96.3822%), train_poison_data_count: 455
Global model norm: 42.894404432753525.
Norm before scaling: 42.869258396077804. Distance: 1.4703318417256972
Total norm for 4 adversaries is: 42.869258396077804. distance: 1.4703318417256972
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2506, Accuracy: 9327/9900 (94.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4852/5123 (94.7101%), train_poison_data_count: 403
Global model norm: 42.894404432753525.
Norm before scaling: 42.87903275722661. Distance: 1.5614296107824075
Total norm for 4 adversaries is: 42.87903275722661. distance: 1.5614296107824075
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1341, Accuracy: 9527/9900 (96.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5234/5503 (95.1118%), train_poison_data_count: 430
Global model norm: 42.894404432753525.
Norm before scaling: 42.87698582090324. Distance: 1.5953959025701112
Total norm for 4 adversaries is: 42.87698582090324. distance: 1.5953959025701112
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2031, Accuracy: 9400/9900 (94.9495%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4278/4797 (89.1807%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4265/4797 (88.9097%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0791, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4662/5068 (91.9890%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4629/5068 (91.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0993, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4931/5298 (93.0729%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4916/5298 (92.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0493, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4494/4911 (91.5089%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4549/4911 (92.6288%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0442, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4489/4979 (90.1587%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4538/4979 (91.1428%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0201, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4264/4549 (93.7349%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4113/4549 (90.4155%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9345, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4391/4818 (91.1374%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4329/4818 (89.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0167, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5048/5422 (93.1022%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5069/5422 (93.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8835, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4660/5075 (91.8227%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4637/5075 (91.3695%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0141, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4821/5361 (89.9273%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4820/5361 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1208, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3565/3910 (91.1765%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3489/3910 (89.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2842, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4930/5454 (90.3924%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4805/5454 (88.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9850, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4559/5122 (89.0082%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4247/5122 (82.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3443, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5002/5645 (88.6094%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4947/5645 (87.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2249, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5418/5871 (92.2841%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5360/5871 (91.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0404, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 6296/6812 (92.4251%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6239/6812 (91.5884%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0633, Accuracy: 5425/10000 (54.2500%)
time spent on training: 267.70686316490173
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1739, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.5841, Accuracy: 8457/9900 (85.4242%)
Done in 305.0532364845276 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5075/5308 (95.6104%), train_poison_data_count: 415
Global model norm: 42.917940129518534.
Norm before scaling: 42.90075870723326. Distance: 1.5353232722386871
Total norm for 4 adversaries is: 42.90075870723326. distance: 1.5353232722386871
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0727, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5534/5777 (95.7937%), train_poison_data_count: 455
Global model norm: 42.917940129518534.
Norm before scaling: 42.893537867845694. Distance: 1.5265837434600529
Total norm for 4 adversaries is: 42.893537867845694. distance: 1.5265837434600529
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1131, Accuracy: 9609/9900 (97.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4859/5123 (94.8468%), train_poison_data_count: 403
Global model norm: 42.917940129518534.
Norm before scaling: 42.90048127871426. Distance: 1.5457741259043734
Total norm for 4 adversaries is: 42.90048127871426. distance: 1.5457741259043734
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1512, Accuracy: 9514/9900 (96.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5244/5503 (95.2935%), train_poison_data_count: 430
Global model norm: 42.917940129518534.
Norm before scaling: 42.90105036092138. Distance: 1.548742226988319
Total norm for 4 adversaries is: 42.90105036092138. distance: 1.548742226988319
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0868, Accuracy: 9665/9900 (97.6263%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6299/6812 (92.4692%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6262/6812 (91.9260%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1573, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3964/4196 (94.4709%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3973/4196 (94.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8644, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4870/5489 (88.7229%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4982/5489 (90.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9547, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4873/5353 (91.0331%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4770/5353 (89.1089%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1781, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4135/4397 (94.0414%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8613, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3557/3995 (89.0363%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3565/3995 (89.2365%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9710, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4857/5361 (90.5988%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4723/5361 (88.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1493, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4529/5018 (90.2551%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4456/5018 (88.8003%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0496, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4590/5123 (89.5959%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4345/5123 (84.8136%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2335, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4401/4843 (90.8734%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4432/4843 (91.5135%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9307, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4550/4929 (92.3108%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4474/4929 (90.7689%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1034, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4412/4869 (90.6141%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4068/4869 (83.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4573, Accuracy: 4836/10000 (48.3600%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4880/5298 (92.1102%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4890/5298 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9713, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3997/4364 (91.5903%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3885/4364 (89.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0194, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3768/4111 (91.6565%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3727/4111 (90.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9609, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3655/4028 (90.7398%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3716/4028 (92.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9233, Accuracy: 5670/10000 (56.7000%)
time spent on training: 256.0513768196106
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1778, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.5130, Accuracy: 8628/9900 (87.1515%)
Done in 292.5235095024109 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5093/5308 (95.9495%), train_poison_data_count: 415
Global model norm: 42.93997331850301.
Norm before scaling: 42.91998653472092. Distance: 1.4904268272991328
Total norm for 4 adversaries is: 42.91998653472092. distance: 1.4904268272991328
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0712, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5573/5777 (96.4688%), train_poison_data_count: 455
Global model norm: 42.93997331850301.
Norm before scaling: 42.9116424483751. Distance: 1.4419007318959547
Total norm for 4 adversaries is: 42.9116424483751. distance: 1.4419007318959547
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1634, Accuracy: 9489/9900 (95.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4861/5123 (94.8858%), train_poison_data_count: 403
Global model norm: 42.93997331850301.
Norm before scaling: 42.92159201990808. Distance: 1.5449214120278225
Total norm for 4 adversaries is: 42.92159201990808. distance: 1.5449214120278225
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1497, Accuracy: 9513/9900 (96.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5257/5503 (95.5297%), train_poison_data_count: 430
Global model norm: 42.93997331850301.
Norm before scaling: 42.92256182331808. Distance: 1.570365487338684
Total norm for 4 adversaries is: 42.92256182331808. distance: 1.570365487338684
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0899, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3954/4196 (94.2326%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3980/4196 (94.8522%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7563, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4895/5298 (92.3934%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4937/5298 (93.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0902, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3864/4249 (90.9390%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3871/4249 (91.1038%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9337, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4626/5123 (90.2987%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4593/5123 (89.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9757, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3831/4130 (92.7603%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3808/4130 (92.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9392, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4525/4979 (90.8817%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4517/4979 (90.7210%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9071, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4876/5353 (91.0891%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4747/5353 (88.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0582, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4298/4672 (91.9949%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4342/4672 (92.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9040, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4133/4587 (90.1025%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4180/4587 (91.1271%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2958, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4567/5122 (89.1644%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4318/5122 (84.3030%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3746, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4354/4818 (90.3694%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4369/4818 (90.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1868, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4681/4993 (93.7513%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4619/4993 (92.5095%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9655, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4422/4903 (90.1897%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4409/4903 (89.9245%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0923, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4946/5559 (88.9728%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4920/5559 (88.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3123, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4506/4830 (93.2919%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4515/4830 (93.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0879, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5202/5696 (91.3272%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5150/5696 (90.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0777, Accuracy: 5215/10000 (52.1500%)
time spent on training: 263.0316767692566
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1750, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.4866, Accuracy: 8681/9900 (87.6869%)
Done in 296.6121916770935 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5063/5308 (95.3843%), train_poison_data_count: 415
Global model norm: 42.961188255087436.
Norm before scaling: 42.94132221206414. Distance: 1.5171281105619994
Total norm for 4 adversaries is: 42.94132221206414. distance: 1.5171281105619994
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0272, Accuracy: 9822/9900 (99.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5561/5777 (96.2610%), train_poison_data_count: 455
Global model norm: 42.961188255087436.
Norm before scaling: 42.93359925876818. Distance: 1.4866015148997302
Total norm for 4 adversaries is: 42.93359925876818. distance: 1.4866015148997302
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1960, Accuracy: 9453/9900 (95.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4834/5123 (94.3588%), train_poison_data_count: 403
Global model norm: 42.961188255087436.
Norm before scaling: 42.94814847035027. Distance: 1.6102985583870946
Total norm for 4 adversaries is: 42.94814847035027. distance: 1.6102985583870946
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1927, Accuracy: 9409/9900 (95.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5278/5503 (95.9113%), train_poison_data_count: 430
Global model norm: 42.961188255087436.
Norm before scaling: 42.94030024074849. Distance: 1.4765936631239425
Total norm for 4 adversaries is: 42.94030024074849. distance: 1.4765936631239425
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1443, Accuracy: 9519/9900 (96.1515%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3968/4196 (94.5663%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3941/4196 (93.9228%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8969, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4629/5123 (90.3572%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4201/5123 (82.0027%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3775, Accuracy: 4848/10000 (48.4800%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4267/4605 (92.6602%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4267/4605 (92.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8933, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4224/4736 (89.1892%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4231/4736 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9857, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4349/4714 (92.2571%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4400/4714 (93.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0430, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4917/5489 (89.5792%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4920/5489 (89.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2089, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4488/4911 (91.3867%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4481/4911 (91.2441%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1153, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3518/3959 (88.8608%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3627/3959 (91.6140%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0111, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5438/5939 (91.5642%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5519/5939 (92.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0610, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5126/5615 (91.2912%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5101/5615 (90.8459%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1156, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6298/6947 (90.6578%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6135/6947 (88.3115%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3617, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4823/5504 (87.6272%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4823/5504 (87.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0746, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4410/4748 (92.8812%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4386/4748 (92.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0878, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4982/5645 (88.2551%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4914/5645 (87.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1717, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5369/6080 (88.3059%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5345/6080 (87.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1872, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3301/3589 (91.9755%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3240/3589 (90.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1011, Accuracy: 5413/10000 (54.1300%)
time spent on training: 276.2468249797821
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1741, Accuracy: 6885/10000 (68.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.4614, Accuracy: 8740/9900 (88.2828%)
Done in 310.4201235771179 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5103/5308 (96.1379%), train_poison_data_count: 415
Global model norm: 42.98278463979067.
Norm before scaling: 42.96019801259359. Distance: 1.4172776064254056
Total norm for 4 adversaries is: 42.96019801259359. distance: 1.4172776064254056
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1235, Accuracy: 9580/9900 (96.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5570/5777 (96.4168%), train_poison_data_count: 455
Global model norm: 42.98278463979067.
Norm before scaling: 42.957079380997406. Distance: 1.5084932994143698
Total norm for 4 adversaries is: 42.957079380997406. distance: 1.5084932994143698
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0435, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4862/5123 (94.9053%), train_poison_data_count: 403
Global model norm: 42.98278463979067.
Norm before scaling: 42.96527116599158. Distance: 1.5273403938432195
Total norm for 4 adversaries is: 42.96527116599158. distance: 1.5273403938432195
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2970, Accuracy: 9148/9900 (92.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5258/5503 (95.5479%), train_poison_data_count: 430
Global model norm: 42.98278463979067.
Norm before scaling: 42.964168789872886. Distance: 1.5789553280261672
Total norm for 4 adversaries is: 42.964168789872886. distance: 1.5789553280261672
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0918, Accuracy: 9658/9900 (97.5556%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4836/5361 (90.2071%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4862/5361 (90.6920%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1489, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3763/4086 (92.0950%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3834/4086 (93.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0369, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4937/5702 (86.5837%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0100, Accuracy: 4619/5702 (81.0067%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2656, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5329/6080 (87.6480%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5332/6080 (87.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2598, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5439/5939 (91.5811%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5448/5939 (91.7326%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9411, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4923/5497 (89.5579%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4960/5497 (90.2310%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1765, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4546/5038 (90.2342%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4583/5038 (90.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8314, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4641/4993 (92.9501%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4573/4993 (91.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0684, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4394/4903 (89.6186%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4429/4903 (90.3324%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1701, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6303/6812 (92.5279%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6265/6812 (91.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1249, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4995/5526 (90.3909%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4890/5526 (88.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0519, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3609/3910 (92.3018%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3490/3910 (89.2583%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1252, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4720/5075 (93.0049%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4626/5075 (91.1527%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1267, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3770/4108 (91.7722%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3768/4108 (91.7235%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9654, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4965/5298 (93.7146%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4971/5298 (93.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1105, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5001/5422 (92.2353%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5001/5422 (92.2353%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9958, Accuracy: 5489/10000 (54.8900%)
time spent on training: 270.4676308631897
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1698, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.4547, Accuracy: 8742/9900 (88.3030%)
Done in 312.11717796325684 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5103/5308 (96.1379%), train_poison_data_count: 415
Global model norm: 43.00587600658484.
Norm before scaling: 42.9837388629773. Distance: 1.4351235524597123
Total norm for 4 adversaries is: 42.9837388629773. distance: 1.4351235524597123
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0505, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5571/5777 (96.4341%), train_poison_data_count: 455
Global model norm: 43.00587600658484.
Norm before scaling: 42.9787346353912. Distance: 1.4661096418215251
Total norm for 4 adversaries is: 42.9787346353912. distance: 1.4661096418215251
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0823, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4869/5123 (95.0420%), train_poison_data_count: 403
Global model norm: 43.00587600658484.
Norm before scaling: 42.98472004359878. Distance: 1.4883896195012538
Total norm for 4 adversaries is: 42.98472004359878. distance: 1.4883896195012538
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2253, Accuracy: 9343/9900 (94.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5258/5503 (95.5479%), train_poison_data_count: 430
Global model norm: 43.00587600658484.
Norm before scaling: 42.98558903002043. Distance: 1.5362690006133313
Total norm for 4 adversaries is: 42.98558903002043. distance: 1.5362690006133313
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1056, Accuracy: 9607/9900 (97.0404%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5421/5939 (91.2780%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5444/5939 (91.6653%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2125, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4305/4894 (87.9649%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4340/4894 (88.6800%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0904, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4819/5353 (90.0243%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4845/5353 (90.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0358, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4072/4527 (89.9492%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4031/4527 (89.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0617, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3586/3929 (91.2700%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3589/3929 (91.3464%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8202, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5379/5907 (91.0615%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5346/5907 (90.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1675, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5089/5652 (90.0389%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5029/5652 (88.9774%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2394, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4440/4843 (91.6787%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4424/4843 (91.3483%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0464, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3617/3968 (91.1542%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3679/3968 (92.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8767, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4475/4889 (91.5320%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4475/4889 (91.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.3308, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3221/3552 (90.6813%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3296/3552 (92.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8354, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3820/4086 (93.4900%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3851/4086 (94.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9127, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4548/4979 (91.3436%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4585/4979 (92.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0445, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4650/5035 (92.3535%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4667/5035 (92.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9634, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4617/5122 (90.1406%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0118, Accuracy: 3996/5122 (78.0164%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.4264, Accuracy: 4631/10000 (46.3100%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5132/5615 (91.3980%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5182/5615 (92.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1876, Accuracy: 5208/10000 (52.0800%)
time spent on training: 259.87790274620056
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1794, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4069, Accuracy: 8860/9900 (89.4949%)
Done in 295.7029285430908 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5102/5308 (96.1191%), train_poison_data_count: 415
Global model norm: 43.02683857652831.
Norm before scaling: 43.00578517587779. Distance: 1.4942131473667986
Total norm for 4 adversaries is: 43.00578517587779. distance: 1.4942131473667986
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0672, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5586/5777 (96.6938%), train_poison_data_count: 455
Global model norm: 43.02683857652831.
Norm before scaling: 42.99759543149622. Distance: 1.4498670418388784
Total norm for 4 adversaries is: 42.99759543149622. distance: 1.4498670418388784
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0505, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4865/5123 (94.9639%), train_poison_data_count: 403
Global model norm: 43.02683857652831.
Norm before scaling: 43.0090350927497. Distance: 1.5220494133175178
Total norm for 4 adversaries is: 43.0090350927497. distance: 1.5220494133175178
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1553, Accuracy: 9513/9900 (96.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5265/5503 (95.6751%), train_poison_data_count: 430
Global model norm: 43.02683857652831.
Norm before scaling: 43.00747260878408. Distance: 1.5349583000706999
Total norm for 4 adversaries is: 43.00747260878408. distance: 1.5349583000706999
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0433, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4505/4830 (93.2712%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4488/4830 (92.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0033, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4304/4737 (90.8592%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4297/4737 (90.7114%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1742, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5104/5615 (90.8994%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5075/5615 (90.3829%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1370, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3568/3959 (90.1238%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3613/3959 (91.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0131, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3835/4175 (91.8563%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3807/4175 (91.1856%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8850, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5100/5526 (92.2910%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4925/5526 (89.1241%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1288, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4185/4537 (92.2416%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4174/4537 (91.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8653, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3929/4313 (91.0967%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3952/4313 (91.6300%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0091, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5077/5422 (93.6370%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5041/5422 (92.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0592, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4968/5645 (88.0071%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4878/5645 (86.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0808, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4352/4741 (91.7950%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0098, Accuracy: 3858/4741 (81.3752%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4952, Accuracy: 4707/10000 (47.0700%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5216/5696 (91.5730%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5149/5696 (90.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9930, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4575/5038 (90.8098%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4603/5038 (91.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9488, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4402/4903 (89.7818%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4426/4903 (90.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0123, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4687/5068 (92.4822%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4619/5068 (91.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3709, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4415/4748 (92.9865%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4413/4748 (92.9444%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0611, Accuracy: 5424/10000 (54.2400%)
time spent on training: 264.31184554100037
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1809, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3781, Accuracy: 8917/9900 (90.0707%)
Done in 306.3008849620819 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5096/5308 (96.0060%), train_poison_data_count: 415
Global model norm: 43.04850836284139.
Norm before scaling: 43.025913680558546. Distance: 1.4729562145285287
Total norm for 4 adversaries is: 43.025913680558546. distance: 1.4729562145285287
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0217, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5553/5777 (96.1226%), train_poison_data_count: 455
Global model norm: 43.04850836284139.
Norm before scaling: 43.02181240688771. Distance: 1.5019075662080077
Total norm for 4 adversaries is: 43.02181240688771. distance: 1.5019075662080077
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0820, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4869/5123 (95.0420%), train_poison_data_count: 403
Global model norm: 43.04850836284139.
Norm before scaling: 43.02991669139914. Distance: 1.545871062045396
Total norm for 4 adversaries is: 43.02991669139914. distance: 1.545871062045396
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1205, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5233/5503 (95.0936%), train_poison_data_count: 430
Global model norm: 43.04850836284139.
Norm before scaling: 43.03031526989504. Distance: 1.5530164930176495
Total norm for 4 adversaries is: 43.03031526989504. distance: 1.5530164930176495
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1455, Accuracy: 9519/9900 (96.1515%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3220/3552 (90.6532%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3312/3552 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8426, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3657/3910 (93.5294%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3276/3910 (83.7852%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.4278, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4769/5399 (88.3312%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4785/5399 (88.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1921, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5133/5615 (91.4159%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5167/5615 (92.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1558, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5685/6419 (88.5652%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5485/6419 (85.4494%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2719, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4433/4889 (90.6729%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4442/4889 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0333, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4892/5427 (90.1419%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4883/5427 (89.9760%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0853, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5271/5696 (92.5386%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5244/5696 (92.0646%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0305, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4155/4537 (91.5803%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4133/4537 (91.0954%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9148, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3596/3995 (90.0125%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3542/3995 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0755, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4692/4993 (93.9716%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4666/4993 (93.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0182, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4383/4869 (90.0185%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4354/4869 (89.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0501, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4715/5068 (93.0347%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4607/5068 (90.9037%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1716, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3489/3774 (92.4483%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3529/3774 (93.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1416, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4959/5298 (93.6014%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4898/5298 (92.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0245, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4987/5461 (91.3203%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4992/5461 (91.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1783, Accuracy: 5260/10000 (52.6000%)
time spent on training: 264.98083090782166
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1838, Accuracy: 6875/10000 (68.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3441, Accuracy: 8983/9900 (90.7374%)
Done in 299.7768976688385 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5117/5308 (96.4017%), train_poison_data_count: 415
Global model norm: 43.06979312787705.
Norm before scaling: 43.04722096049726. Distance: 1.4172744101862986
Total norm for 4 adversaries is: 43.04722096049726. distance: 1.4172744101862986
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0807, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5586/5777 (96.6938%), train_poison_data_count: 455
Global model norm: 43.06979312787705.
Norm before scaling: 43.039997749186746. Distance: 1.4207734252888742
Total norm for 4 adversaries is: 43.039997749186746. distance: 1.4207734252888742
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0572, Accuracy: 9748/9900 (98.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4858/5123 (94.8272%), train_poison_data_count: 403
Global model norm: 43.06979312787705.
Norm before scaling: 43.04846299248819. Distance: 1.5080191515103585
Total norm for 4 adversaries is: 43.04846299248819. distance: 1.5080191515103585
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1193, Accuracy: 9594/9900 (96.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5294/5503 (96.2021%), train_poison_data_count: 430
Global model norm: 43.06979312787705.
Norm before scaling: 43.04646948538579. Distance: 1.4870475401471586
Total norm for 4 adversaries is: 43.04646948538579. distance: 1.4870475401471586
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0570, Accuracy: 9726/9900 (98.2424%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3572/3995 (89.4118%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3526/3995 (88.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1931, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4394/4851 (90.5793%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4410/4851 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1358, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4646/5035 (92.2741%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4663/5035 (92.6117%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0753, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3818/4130 (92.4455%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3838/4130 (92.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9062, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4492/5018 (89.5177%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4466/5018 (88.9996%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0796, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4995/5346 (93.4343%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4991/5346 (93.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1100, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4569/4929 (92.6963%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4481/4929 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1535, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4945/5454 (90.6674%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4891/5454 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0737, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3795/4108 (92.3807%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3783/4108 (92.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9614, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4076/4368 (93.3150%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3988/4368 (91.3004%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0881, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3905/4249 (91.9040%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3875/4249 (91.1979%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8848, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4312/4737 (91.0281%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4322/4737 (91.2392%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0427, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6300/6812 (92.4839%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6243/6812 (91.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2446, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5483/5939 (92.3219%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5471/5939 (92.1199%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0112, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5342/5907 (90.4351%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5337/5907 (90.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.4023, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4442/4843 (91.7200%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4485/4843 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0495, Accuracy: 5393/10000 (53.9300%)
time spent on training: 259.7838087081909
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1882, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2999, Accuracy: 9091/9900 (91.8283%)
Done in 301.4459776878357 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5124/5308 (96.5335%), train_poison_data_count: 415
Global model norm: 43.09068352713771.
Norm before scaling: 43.06775667525606. Distance: 1.43085786203382
Total norm for 4 adversaries is: 43.06775667525606. distance: 1.43085786203382
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0459, Accuracy: 9768/9900 (98.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5574/5777 (96.4861%), train_poison_data_count: 455
Global model norm: 43.09068352713771.
Norm before scaling: 43.06094229085753. Distance: 1.4522231389978173
Total norm for 4 adversaries is: 43.06094229085753. distance: 1.4522231389978173
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0485, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4882/5123 (95.2957%), train_poison_data_count: 403
Global model norm: 43.09068352713771.
Norm before scaling: 43.069494114073215. Distance: 1.4857213389575084
Total norm for 4 adversaries is: 43.069494114073215. distance: 1.4857213389575084
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0975, Accuracy: 9649/9900 (97.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5265/5503 (95.6751%), train_poison_data_count: 430
Global model norm: 43.09068352713771.
Norm before scaling: 43.070260775635546. Distance: 1.5189077475926644
Total norm for 4 adversaries is: 43.070260775635546. distance: 1.5189077475926644
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0252, Accuracy: 9831/9900 (99.3030%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6315/6812 (92.7041%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6201/6812 (91.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1362, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4993/5346 (93.3969%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4900/5346 (91.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0584, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5031/5526 (91.0423%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4866/5526 (88.0565%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0737, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4414/4757 (92.7896%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4307/4757 (90.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0749, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4565/5018 (90.9725%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4461/5018 (88.9000%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2048, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4216/4537 (92.9248%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4240/4537 (93.4538%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9110, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4674/4993 (93.6111%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4631/4993 (92.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9253, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5558/6235 (89.1419%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5514/6235 (88.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3586, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4724/5193 (90.9686%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4506/5193 (86.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3535, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4087/4485 (91.1260%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3779/4485 (84.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2480, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5368/6080 (88.2895%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5362/6080 (88.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1989, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4651/5224 (89.0314%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4701/5224 (89.9885%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0584, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4417/4869 (90.7168%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4240/4869 (87.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1901, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4545/4956 (91.7070%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4428/4956 (89.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0389, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5189/5696 (91.0990%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5149/5696 (90.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0792, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4492/4889 (91.8797%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4476/4889 (91.5525%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0149, Accuracy: 5423/10000 (54.2300%)
time spent on training: 264.92932868003845
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1931, Accuracy: 6848/10000 (68.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2765, Accuracy: 9145/9900 (92.3737%)
Done in 302.8950078487396 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5147/5308 (96.9668%), train_poison_data_count: 415
Global model norm: 43.115306881663265.
Norm before scaling: 43.087683413175775. Distance: 1.3298062622251035
Total norm for 4 adversaries is: 43.087683413175775. distance: 1.3298062622251035
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1274, Accuracy: 9561/9900 (96.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5562/5777 (96.2783%), train_poison_data_count: 455
Global model norm: 43.115306881663265.
Norm before scaling: 43.08673999139338. Distance: 1.4697086371155628
Total norm for 4 adversaries is: 43.08673999139338. distance: 1.4697086371155628
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0561, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4888/5123 (95.4128%), train_poison_data_count: 403
Global model norm: 43.115306881663265.
Norm before scaling: 43.09455588668147. Distance: 1.5079342491528158
Total norm for 4 adversaries is: 43.09455588668147. distance: 1.5079342491528158
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1322, Accuracy: 9573/9900 (96.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5271/5503 (95.7841%), train_poison_data_count: 430
Global model norm: 43.115306881663265.
Norm before scaling: 43.092175007476705. Distance: 1.517076564076293
Total norm for 4 adversaries is: 43.092175007476705. distance: 1.517076564076293
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0394, Accuracy: 9791/9900 (98.8990%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5047/5422 (93.0837%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5019/5422 (92.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0319, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4999/5497 (90.9405%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4951/5497 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0018, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5701/6419 (88.8145%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5556/6419 (86.5555%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2856, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5431/5871 (92.5055%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5364/5871 (91.3643%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0614, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4146/4397 (94.2916%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4187/4397 (95.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8089, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4685/4993 (93.8314%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4626/4993 (92.6497%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0530, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3575/3959 (90.3006%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3599/3959 (90.9068%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0396, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5047/5652 (89.2958%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5031/5652 (89.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1558, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4950/5702 (86.8116%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4598/5702 (80.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2635, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3617/3968 (91.1542%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3677/3968 (92.6663%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8744, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5514/5939 (92.8439%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5476/5939 (92.2041%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0922, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4628/5123 (90.3377%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4476/5123 (87.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1678, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4281/4549 (94.1086%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4010/4549 (88.1512%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0757, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3210/3552 (90.3716%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3275/3552 (92.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8584, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4575/5122 (89.3206%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4222/5122 (82.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3015, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6310/6812 (92.6307%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6277/6812 (92.1462%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2015, Accuracy: 5212/10000 (52.1200%)
time spent on training: 275.77852725982666
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1904, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2620, Accuracy: 9188/9900 (92.8081%)
Done in 317.9014217853546 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5131/5308 (96.6654%), train_poison_data_count: 415
Global model norm: 43.137123239353684.
Norm before scaling: 43.11155814062512. Distance: 1.3870437026423703
Total norm for 4 adversaries is: 43.11155814062512. distance: 1.3870437026423703
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1124, Accuracy: 9597/9900 (96.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5562/5777 (96.2783%), train_poison_data_count: 455
Global model norm: 43.137123239353684.
Norm before scaling: 43.10787986714987. Distance: 1.4733579061941715
Total norm for 4 adversaries is: 43.10787986714987. distance: 1.4733579061941715
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0884, Accuracy: 9669/9900 (97.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4869/5123 (95.0420%), train_poison_data_count: 403
Global model norm: 43.137123239353684.
Norm before scaling: 43.11568909903186. Distance: 1.5044743245280268
Total norm for 4 adversaries is: 43.11568909903186. distance: 1.5044743245280268
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1562, Accuracy: 9499/9900 (95.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5272/5503 (95.8023%), train_poison_data_count: 430
Global model norm: 43.137123239353684.
Norm before scaling: 43.11353731265129. Distance: 1.4996269079973517
Total norm for 4 adversaries is: 43.11353731265129. distance: 1.4996269079973517
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0367, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4356/4731 (92.0736%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4412/4731 (93.2572%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9772, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4361/4797 (90.9110%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4328/4797 (90.2231%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9599, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4663/5035 (92.6117%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4632/5035 (91.9960%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1161, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4861/5362 (90.6565%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4855/5362 (90.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1756, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4660/5123 (90.9623%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4486/5123 (87.5659%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2624, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4946/5346 (92.5178%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4928/5346 (92.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2219, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4394/4714 (93.2117%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4412/4714 (93.5936%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8699, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5084/5652 (89.9505%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5021/5652 (88.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0818, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4068/4527 (89.8608%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3978/4527 (87.8728%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0870, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3987/4313 (92.4415%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4003/4313 (92.8124%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8433, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6290/6947 (90.5427%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0054, Accuracy: 6212/6947 (89.4199%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1570, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4689/4993 (93.9115%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4593/4993 (91.9888%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1482, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4666/5086 (91.7420%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4696/5086 (92.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1058, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4622/5038 (91.7428%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4623/5038 (91.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8086, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4988/5461 (91.3386%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4926/5461 (90.2033%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0483, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5142/5727 (89.7852%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5096/5727 (88.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0705, Accuracy: 5319/10000 (53.1900%)
time spent on training: 284.42966318130493
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1864, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2574, Accuracy: 9191/9900 (92.8384%)
Done in 317.78331422805786 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5105/5308 (96.1756%), train_poison_data_count: 415
Global model norm: 43.1586061313746.
Norm before scaling: 43.13679780877705. Distance: 1.4680734252964895
Total norm for 4 adversaries is: 43.13679780877705. distance: 1.4680734252964895
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0756, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5594/5777 (96.8323%), train_poison_data_count: 455
Global model norm: 43.1586061313746.
Norm before scaling: 43.12769183174976. Distance: 1.4135546114653765
Total norm for 4 adversaries is: 43.12769183174976. distance: 1.4135546114653765
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0716, Accuracy: 9714/9900 (98.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4877/5123 (95.1981%), train_poison_data_count: 403
Global model norm: 43.1586061313746.
Norm before scaling: 43.13809810147522. Distance: 1.4675426796680697
Total norm for 4 adversaries is: 43.13809810147522. distance: 1.4675426796680697
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2337, Accuracy: 9255/9900 (93.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5300/5503 (96.3111%), train_poison_data_count: 430
Global model norm: 43.1586061313746.
Norm before scaling: 43.133764111717774. Distance: 1.4595322812134628
Total norm for 4 adversaries is: 43.133764111717774. distance: 1.4595322812134628
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0629, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3952/4313 (91.6300%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3946/4313 (91.4908%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9797, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4426/4894 (90.4373%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4334/4894 (88.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9837, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4195/4397 (95.4060%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4206/4397 (95.6561%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7657, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4425/4748 (93.1971%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4448/4748 (93.6816%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0851, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5271/5696 (92.5386%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5159/5696 (90.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9595, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4917/5427 (90.6025%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4838/5427 (89.1469%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0740, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4291/4605 (93.1813%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4292/4605 (93.2030%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0691, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5065/5422 (93.4157%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5090/5422 (93.8768%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0049, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5461/5871 (93.0165%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5329/5871 (90.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0642, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5082/5652 (89.9151%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5065/5652 (89.6143%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1004, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4914/5362 (91.6449%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4820/5362 (89.8918%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1759, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4935/5702 (86.5486%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4692/5702 (82.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3136, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4700/5075 (92.6108%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4630/5075 (91.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1709, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5556/6068 (91.5623%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5579/6068 (91.9413%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2537, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6307/6812 (92.5866%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6282/6812 (92.2196%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0621, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4409/4732 (93.1741%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4421/4732 (93.4277%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8767, Accuracy: 5704/10000 (57.0400%)
time spent on training: 276.09188055992126
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1867, Accuracy: 6872/10000 (68.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2583, Accuracy: 9189/9900 (92.8182%)
Done in 312.366295337677 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5124/5308 (96.5335%), train_poison_data_count: 415
Global model norm: 43.18060274156673.
Norm before scaling: 43.1554311222998. Distance: 1.382081264110569
Total norm for 4 adversaries is: 43.1554311222998. distance: 1.382081264110569
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1013, Accuracy: 9635/9900 (97.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.18060274156673.
Norm before scaling: 43.14960660081025. Distance: 1.4029538413412406
Total norm for 4 adversaries is: 43.14960660081025. distance: 1.4029538413412406
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0700, Accuracy: 9701/9900 (97.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4902/5123 (95.6861%), train_poison_data_count: 403
Global model norm: 43.18060274156673.
Norm before scaling: 43.15755394934501. Distance: 1.4475697803972225
Total norm for 4 adversaries is: 43.15755394934501. distance: 1.4475697803972225
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1696, Accuracy: 9444/9900 (95.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5299/5503 (96.2929%), train_poison_data_count: 430
Global model norm: 43.18060274156673.
Norm before scaling: 43.15453302612745. Distance: 1.4569065562217818
Total norm for 4 adversaries is: 43.15453302612745. distance: 1.4569065562217818
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0434, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5614/6235 (90.0401%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5641/6235 (90.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1564, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5089/5422 (93.8584%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5035/5422 (92.8624%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8755, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4138/4587 (90.2115%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4105/4587 (89.4920%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0454, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4832/5399 (89.4981%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4758/5399 (88.1274%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3383, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3626/3910 (92.7366%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3639/3910 (93.0691%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9759, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5360/5907 (90.7398%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5284/5907 (89.4532%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3610, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4860/5361 (90.6547%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4834/5361 (90.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9711, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4530/5018 (90.2750%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4501/5018 (89.6971%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0890, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6295/6947 (90.6147%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6107/6947 (87.9084%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3042, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3289/3589 (91.6411%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3160/3589 (88.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1616, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5028/5559 (90.4479%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4946/5559 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1508, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6357/6812 (93.3206%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 6180/6812 (90.7223%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1096, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4982/5346 (93.1912%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4960/5346 (92.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0264, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4389/4903 (89.5166%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4414/4903 (90.0265%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9882, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4236/4397 (96.3384%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0019, Accuracy: 4250/4397 (96.6568%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7464, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4701/5035 (93.3664%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4705/5035 (93.4459%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8992, Accuracy: 5687/10000 (56.8700%)
time spent on training: 262.6150403022766
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1875, Accuracy: 6877/10000 (68.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2544, Accuracy: 9196/9900 (92.8889%)
Done in 307.23861718177795 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5126/5308 (96.5712%), train_poison_data_count: 415
Global model norm: 43.20343721632212.
Norm before scaling: 43.17979139326202. Distance: 1.4169849524388862
Total norm for 4 adversaries is: 43.17979139326202. distance: 1.4169849524388862
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0308, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5579/5777 (96.5726%), train_poison_data_count: 455
Global model norm: 43.20343721632212.
Norm before scaling: 43.173225130444706. Distance: 1.4332543576831536
Total norm for 4 adversaries is: 43.173225130444706. distance: 1.4332543576831536
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0692, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4913/5123 (95.9008%), train_poison_data_count: 403
Global model norm: 43.20343721632212.
Norm before scaling: 43.18023523377044. Distance: 1.4155288596275084
Total norm for 4 adversaries is: 43.18023523377044. distance: 1.4155288596275084
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0794, Accuracy: 9681/9900 (97.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5277/5503 (95.8931%), train_poison_data_count: 430
Global model norm: 43.20343721632212.
Norm before scaling: 43.18081617735111. Distance: 1.5037328843104307
Total norm for 4 adversaries is: 43.18081617735111. distance: 1.5037328843104307
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0307, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5411/5871 (92.1649%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5328/5871 (90.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0555, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4698/5193 (90.4679%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4507/5193 (86.7899%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2829, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5013/5559 (90.1781%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4933/5559 (88.7390%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1739, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4430/4843 (91.4722%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4422/4843 (91.3070%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9920, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4324/4672 (92.5514%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4311/4672 (92.2731%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8852, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4724/5075 (93.0837%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4682/5075 (92.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2774, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4427/4851 (91.2595%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4409/4851 (90.8885%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0568, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4722/5209 (90.6508%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4703/5209 (90.2860%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1509, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5251/5696 (92.1875%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5156/5696 (90.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2984, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4648/5122 (90.7458%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4414/5122 (86.1773%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3010, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4319/4741 (91.0989%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4130/4741 (87.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2539, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4324/4797 (90.1397%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4291/4797 (89.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0884, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3977/4196 (94.7807%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3945/4196 (94.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7916, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3759/4111 (91.4376%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3792/4111 (92.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1225, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4484/4869 (92.0928%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4172/4869 (85.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3920, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5049/5645 (89.4420%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5026/5645 (89.0345%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0661, Accuracy: 5351/10000 (53.5100%)
time spent on training: 265.5243515968323
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1852, Accuracy: 6882/10000 (68.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2302, Accuracy: 9261/9900 (93.5455%)
Done in 308.5466287136078 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5131/5308 (96.6654%), train_poison_data_count: 415
Global model norm: 43.226618273278675.
Norm before scaling: 43.201864809830546. Distance: 1.4298816820027374
Total norm for 4 adversaries is: 43.201864809830546. distance: 1.4298816820027374
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0558, Accuracy: 9745/9900 (98.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5609/5777 (97.0919%), train_poison_data_count: 455
Global model norm: 43.226618273278675.
Norm before scaling: 43.1921522005879. Distance: 1.3695456957232024
Total norm for 4 adversaries is: 43.1921522005879. distance: 1.3695456957232024
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0327, Accuracy: 9811/9900 (99.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4919/5123 (96.0180%), train_poison_data_count: 403
Global model norm: 43.226618273278675.
Norm before scaling: 43.20276474759385. Distance: 1.4378630967369201
Total norm for 4 adversaries is: 43.20276474759385. distance: 1.4378630967369201
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1154, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5314/5503 (96.5655%), train_poison_data_count: 430
Global model norm: 43.226618273278675.
Norm before scaling: 43.20029093326514. Distance: 1.41362051616217
Total norm for 4 adversaries is: 43.20029093326514. distance: 1.41362051616217
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1088, Accuracy: 9611/9900 (97.0808%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4888/5353 (91.3133%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4814/5353 (89.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0158, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3217/3552 (90.5687%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3289/3552 (92.5957%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8104, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3591/3959 (90.7047%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3632/3959 (91.7403%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8916, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4590/5055 (90.8012%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4513/5055 (89.2779%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2148, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4938/5702 (86.6012%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0129, Accuracy: 4348/5702 (76.2539%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3831, Accuracy: 4803/10000 (48.0300%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3805/4108 (92.6241%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3779/4108 (91.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9223, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 6291/6812 (92.3517%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6240/6812 (91.6031%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1153, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4129/4485 (92.0624%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3970/4485 (88.5173%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0838, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4720/5193 (90.8916%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4464/5193 (85.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.4164, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4152/4397 (94.4280%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4214/4397 (95.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6895, Accuracy: 5994/10000 (59.9400%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3788/4145 (91.3872%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3800/4145 (91.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0354, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5001/5346 (93.5466%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4980/5346 (93.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0264, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3476/3774 (92.1039%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3550/3774 (94.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9045, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5040/5461 (92.2908%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5077/5461 (92.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2679, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5079/5652 (89.8620%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5011/5652 (88.6589%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0964, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5550/5939 (93.4501%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5515/5939 (92.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0555, Accuracy: 5356/10000 (53.5600%)
time spent on training: 266.25300645828247
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1907, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2133, Accuracy: 9298/9900 (93.9192%)
Done in 299.4649133682251 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5134/5308 (96.7219%), train_poison_data_count: 415
Global model norm: 43.24676254591926.
Norm before scaling: 43.220587282440555. Distance: 1.3812806432440496
Total norm for 4 adversaries is: 43.220587282440555. distance: 1.3812806432440496
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0417, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5587/5777 (96.7111%), train_poison_data_count: 455
Global model norm: 43.24676254591926.
Norm before scaling: 43.21359219946023. Distance: 1.3770252398281075
Total norm for 4 adversaries is: 43.21359219946023. distance: 1.3770252398281075
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0847, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4913/5123 (95.9008%), train_poison_data_count: 403
Global model norm: 43.24676254591926.
Norm before scaling: 43.22204603754749. Distance: 1.418040208093127
Total norm for 4 adversaries is: 43.22204603754749. distance: 1.418040208093127
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0813, Accuracy: 9697/9900 (97.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5321/5503 (96.6927%), train_poison_data_count: 430
Global model norm: 43.24676254591926.
Norm before scaling: 43.22050255168619. Distance: 1.4346624647318864
Total norm for 4 adversaries is: 43.22050255168619. distance: 1.4346624647318864
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1168, Accuracy: 9595/9900 (96.9192%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4121/4485 (91.8841%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3939/4485 (87.8261%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0643, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4313/4605 (93.6591%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4302/4605 (93.4202%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8900, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5296/5696 (92.9775%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5213/5696 (91.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9942, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3853/4161 (92.5979%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3816/4161 (91.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2084, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3978/4196 (94.8046%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3986/4196 (94.9952%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7762, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4397/4818 (91.2619%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4210/4818 (87.3807%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0646, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4669/4993 (93.5109%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4668/4993 (93.4909%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1207, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3675/3968 (92.6159%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3682/3968 (92.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8488, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5387/6080 (88.6020%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5396/6080 (88.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1022, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4600/5038 (91.3061%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4620/5038 (91.7031%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9475, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5851/6664 (87.8001%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0087, Accuracy: 5532/6664 (83.0132%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.4010, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3811/4111 (92.7025%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3797/4111 (92.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0712, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5027/5526 (90.9700%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4846/5526 (87.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1514, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4761/5068 (93.9424%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/5068 (91.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1199, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3608/3959 (91.1341%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3687/3959 (93.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8511, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4081/4368 (93.4295%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4064/4368 (93.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9922, Accuracy: 5535/10000 (55.3500%)
time spent on training: 269.8302879333496
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1919, Accuracy: 6862/10000 (68.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1980, Accuracy: 9339/9900 (94.3333%)
Done in 310.5726270675659 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5135/5308 (96.7408%), train_poison_data_count: 415
Global model norm: 43.266481291183275.
Norm before scaling: 43.24018386844074. Distance: 1.391373764935436
Total norm for 4 adversaries is: 43.24018386844074. distance: 1.391373764935436
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1162, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5602/5777 (96.9707%), train_poison_data_count: 455
Global model norm: 43.266481291183275.
Norm before scaling: 43.23354207275006. Distance: 1.3783199803829131
Total norm for 4 adversaries is: 43.23354207275006. distance: 1.3783199803829131
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0972, Accuracy: 9642/9900 (97.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4906/5123 (95.7642%), train_poison_data_count: 403
Global model norm: 43.266481291183275.
Norm before scaling: 43.24210069435732. Distance: 1.4283486022192446
Total norm for 4 adversaries is: 43.24210069435732. distance: 1.4283486022192446
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1009, Accuracy: 9630/9900 (97.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5308/5503 (96.4565%), train_poison_data_count: 430
Global model norm: 43.266481291183275.
Norm before scaling: 43.24084305159302. Distance: 1.4601142726230134
Total norm for 4 adversaries is: 43.24084305159302. distance: 1.4601142726230134
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1320, Accuracy: 9531/9900 (96.2727%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4304/4605 (93.4636%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4281/4605 (92.9642%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9347, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4754/5193 (91.5463%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4462/5193 (85.9234%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3342, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4777/5209 (91.7067%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4710/5209 (90.4204%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0545, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5509/5939 (92.7597%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5460/5939 (91.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0331, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5315/5696 (93.3111%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5193/5696 (91.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1205, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3806/4108 (92.6485%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3710/4108 (90.3116%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0618, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4464/4889 (91.3070%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4477/4889 (91.5729%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0216, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5059/5645 (89.6191%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4890/5645 (86.6253%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2480, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4538/4911 (92.4048%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4510/4911 (91.8347%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9650, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4135/4587 (90.1461%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4192/4587 (91.3887%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1453, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3337/3589 (92.9785%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3139/3589 (87.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0912, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4962/5298 (93.6580%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4917/5298 (92.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0179, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5043/5497 (91.7409%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4980/5497 (90.5949%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0955, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4433/4869 (91.0454%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4179/4869 (85.8287%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2813, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3980/4196 (94.8522%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3972/4196 (94.6616%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7452, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3664/3968 (92.3387%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3684/3968 (92.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7687, Accuracy: 5856/10000 (58.5600%)
time spent on training: 266.8630356788635
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1935, Accuracy: 6858/10000 (68.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2050, Accuracy: 9323/9900 (94.1717%)
Done in 301.83428740501404 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5129/5308 (96.6277%), train_poison_data_count: 415
Global model norm: 43.28756440852124.
Norm before scaling: 43.2620049722473. Distance: 1.4054051722533296
Total norm for 4 adversaries is: 43.2620049722473. distance: 1.4054051722533296
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0327, Accuracy: 9815/9900 (99.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.28756440852124.
Norm before scaling: 43.255115360877404. Distance: 1.3662169144822125
Total norm for 4 adversaries is: 43.255115360877404. distance: 1.3662169144822125
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0439, Accuracy: 9782/9900 (98.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4895/5123 (95.5495%), train_poison_data_count: 403
Global model norm: 43.28756440852124.
Norm before scaling: 43.263704984031506. Distance: 1.4468293349637749
Total norm for 4 adversaries is: 43.263704984031506. distance: 1.4468293349637749
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2241, Accuracy: 9333/9900 (94.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5323/5503 (96.7291%), train_poison_data_count: 430
Global model norm: 43.28756440852124.
Norm before scaling: 43.2596389525466. Distance: 1.4025164314572245
Total norm for 4 adversaries is: 43.2596389525466. distance: 1.4025164314572245
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0280, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3861/4161 (92.7902%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3762/4161 (90.4110%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0421, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4425/4748 (93.1971%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4411/4748 (92.9023%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9103, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4908/5361 (91.5501%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4833/5361 (90.1511%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9417, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3799/4145 (91.6526%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3830/4145 (92.4005%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8810, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4436/4714 (94.1027%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4387/4714 (93.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9721, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3832/4175 (91.7844%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3798/4175 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0395, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3582/3929 (91.1682%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3539/3929 (90.0738%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9167, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4077/4368 (93.3379%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4064/4368 (93.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9753, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5742/6419 (89.4532%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5514/6419 (85.9012%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2522, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4296/4549 (94.4383%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4002/4549 (87.9754%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0890, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4584/5122 (89.4963%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0147, Accuracy: 3782/5122 (73.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.7455, Accuracy: 4296/10000 (42.9600%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4558/4911 (92.8121%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4573/4911 (93.1175%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9921, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3711/4028 (92.1301%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3728/4028 (92.5521%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8811, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5176/5727 (90.3789%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5125/5727 (89.4884%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1424, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4706/4993 (94.2520%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4631/4993 (92.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1262, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4411/4714 (93.5723%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4388/4714 (93.0844%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0039, Accuracy: 5546/10000 (55.4600%)
time spent on training: 261.36810660362244
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1865, Accuracy: 6865/10000 (68.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2023, Accuracy: 9337/9900 (94.3131%)
Done in 295.72712802886963 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5148/5308 (96.9857%), train_poison_data_count: 415
Global model norm: 43.306523250599184.
Norm before scaling: 43.27724767144539. Distance: 1.3065076911486744
Total norm for 4 adversaries is: 43.27724767144539. distance: 1.3065076911486744
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0330, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5610/5777 (97.1092%), train_poison_data_count: 455
Global model norm: 43.306523250599184.
Norm before scaling: 43.273378966154674. Distance: 1.3716672909543242
Total norm for 4 adversaries is: 43.273378966154674. distance: 1.3716672909543242
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0768, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.306523250599184.
Norm before scaling: 43.28066617386018. Distance: 1.3805499343877028
Total norm for 4 adversaries is: 43.28066617386018. distance: 1.3805499343877028
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1075, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5300/5503 (96.3111%), train_poison_data_count: 430
Global model norm: 43.306523250599184.
Norm before scaling: 43.28241621849383. Distance: 1.4842883436105498
Total norm for 4 adversaries is: 43.28241621849383. distance: 1.4842883436105498
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1591, Accuracy: 9476/9900 (95.7172%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4972/5461 (91.0456%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4934/5461 (90.3498%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1433, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4001/4364 (91.6819%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3895/4364 (89.2530%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1139, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4432/4714 (94.0178%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4450/4714 (94.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8291, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4367/4757 (91.8016%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4263/4757 (89.6153%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1493, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5011/5346 (93.7336%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4914/5346 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0973, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4294/4605 (93.2465%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4320/4605 (93.8111%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9537, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5564/6068 (91.6941%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5517/6068 (90.9196%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2768, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4536/5050 (89.8218%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4492/5050 (88.9505%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0934, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5115/5615 (91.0953%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5104/5615 (90.8994%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0153, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4916/5427 (90.5841%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4902/5427 (90.3261%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0332, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4408/4731 (93.1727%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4348/4731 (91.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9804, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3927/4249 (92.4217%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3899/4249 (91.7628%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9213, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4624/5123 (90.2596%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4135/5123 (80.7144%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2234, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4662/5038 (92.5367%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4632/5038 (91.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9506, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4741/4993 (94.9529%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4646/4993 (93.0503%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0739, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4608/4979 (92.5487%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4612/4979 (92.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1083, Accuracy: 5441/10000 (54.4100%)
time spent on training: 271.8520712852478
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1830, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1981, Accuracy: 9356/9900 (94.5051%)
Done in 305.77867436408997 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5143/5308 (96.8915%), train_poison_data_count: 415
Global model norm: 43.32770380475046.
Norm before scaling: 43.29853699219019. Distance: 1.3440895982151229
Total norm for 4 adversaries is: 43.29853699219019. distance: 1.3440895982151229
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0362, Accuracy: 9806/9900 (99.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5600/5777 (96.9361%), train_poison_data_count: 455
Global model norm: 43.32770380475046.
Norm before scaling: 43.29309122766443. Distance: 1.3642485501542234
Total norm for 4 adversaries is: 43.29309122766443. distance: 1.3642485501542234
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0620, Accuracy: 9734/9900 (98.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4924/5123 (96.1156%), train_poison_data_count: 403
Global model norm: 43.32770380475046.
Norm before scaling: 43.30188192810591. Distance: 1.3930819805035475
Total norm for 4 adversaries is: 43.30188192810591. distance: 1.3930819805035475
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0656, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5300/5503 (96.3111%), train_poison_data_count: 430
Global model norm: 43.32770380475046.
Norm before scaling: 43.300331421039665. Distance: 1.433656779470603
Total norm for 4 adversaries is: 43.300331421039665. distance: 1.433656779470603
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0643, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4884/5427 (89.9945%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4889/5427 (90.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9886, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3964/4196 (94.4709%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3975/4196 (94.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9248, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3706/4028 (92.0060%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3763/4028 (93.4211%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8380, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3524/3774 (93.3757%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3574/3774 (94.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8123, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4929/5298 (93.0351%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4893/5298 (92.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0354, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6311/6947 (90.8450%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 6059/6947 (87.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1787, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3822/4175 (91.5449%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3842/4175 (92.0240%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0175, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5424/5871 (92.3863%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5375/5871 (91.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1726, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4120/4527 (91.0095%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4055/4527 (89.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0363, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4167/4397 (94.7692%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4184/4397 (95.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8265, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5095/5422 (93.9690%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5011/5422 (92.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9734, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4924/5362 (91.8314%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4824/5362 (89.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1923, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5069/5652 (89.6851%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5053/5652 (89.4020%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1347, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4534/4911 (92.3234%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4560/4911 (92.8528%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0018, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5827/6664 (87.4400%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5664/6664 (84.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2805, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4598/5055 (90.9594%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4553/5055 (90.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2220, Accuracy: 5259/10000 (52.5900%)
time spent on training: 267.1821529865265
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1854, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1871, Accuracy: 9387/9900 (94.8182%)
Done in 304.64516615867615 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5141/5308 (96.8538%), train_poison_data_count: 415
Global model norm: 43.34778138921515.
Norm before scaling: 43.32004832538928. Distance: 1.3815725338340028
Total norm for 4 adversaries is: 43.32004832538928. distance: 1.3815725338340028
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0396, Accuracy: 9799/9900 (98.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5593/5777 (96.8150%), train_poison_data_count: 455
Global model norm: 43.34778138921515.
Norm before scaling: 43.315717040970675. Distance: 1.4304430690024774
Total norm for 4 adversaries is: 43.315717040970675. distance: 1.4304430690024774
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0573, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4906/5123 (95.7642%), train_poison_data_count: 403
Global model norm: 43.34778138921515.
Norm before scaling: 43.32280975106027. Distance: 1.4378169166515347
Total norm for 4 adversaries is: 43.32280975106027. distance: 1.4378169166515347
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0826, Accuracy: 9679/9900 (97.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5296/5503 (96.2384%), train_poison_data_count: 430
Global model norm: 43.34778138921515.
Norm before scaling: 43.32146850914754. Distance: 1.4551090109190572
Total norm for 4 adversaries is: 43.32146850914754. distance: 1.4551090109190572
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0409, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3890/4161 (93.4871%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3838/4161 (92.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0972, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4108/4368 (94.0476%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4062/4368 (92.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9491, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4320/4818 (89.6638%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4332/4818 (89.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0071, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3808/4111 (92.6295%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3815/4111 (92.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0695, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4900/5353 (91.5375%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4852/5353 (90.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9299, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5008/5346 (93.6775%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5006/5346 (93.6401%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1129, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4847/5504 (88.0632%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4759/5504 (86.4644%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2402, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3498/3774 (92.6868%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3538/3774 (93.7467%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8816, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3842/4175 (92.0240%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3815/4175 (91.3772%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0755, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5084/5422 (93.7661%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5023/5422 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0143, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5610/6068 (92.4522%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5504/6068 (90.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1909, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4552/4929 (92.3514%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4493/4929 (91.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0088, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4409/4757 (92.6845%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4302/4757 (90.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9787, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4633/5055 (91.6518%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4568/5055 (90.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9854, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4477/4843 (92.4427%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4470/4843 (92.2982%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9273, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4715/5035 (93.6445%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4666/5035 (92.6713%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9775, Accuracy: 5605/10000 (56.0500%)
time spent on training: 263.15525007247925
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1877, Accuracy: 6867/10000 (68.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1808, Accuracy: 9401/9900 (94.9596%)
Done in 300.08161211013794 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5147/5308 (96.9668%), train_poison_data_count: 415
Global model norm: 43.368015749386814.
Norm before scaling: 43.33882255021544. Distance: 1.3414562076070504
Total norm for 4 adversaries is: 43.33882255021544. distance: 1.3414562076070504
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0500, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5598/5777 (96.9015%), train_poison_data_count: 455
Global model norm: 43.368015749386814.
Norm before scaling: 43.33221700159637. Distance: 1.34101882876406
Total norm for 4 adversaries is: 43.33221700159637. distance: 1.34101882876406
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0426, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4919/5123 (96.0180%), train_poison_data_count: 403
Global model norm: 43.368015749386814.
Norm before scaling: 43.341672906702186. Distance: 1.4177448526799226
Total norm for 4 adversaries is: 43.341672906702186. distance: 1.4177448526799226
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0835, Accuracy: 9685/9900 (97.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5308/5503 (96.4565%), train_poison_data_count: 430
Global model norm: 43.368015749386814.
Norm before scaling: 43.339919621666354. Distance: 1.4338510059008234
Total norm for 4 adversaries is: 43.339919621666354. distance: 1.4338510059008234
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0544, Accuracy: 9758/9900 (98.5657%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4431/4818 (91.9676%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4289/4818 (89.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1114, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4057/4527 (89.6178%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4022/4527 (88.8447%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0454, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4714/5068 (93.0150%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4604/5068 (90.8445%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2807, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4703/5035 (93.4062%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4743/5035 (94.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9211, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4749/4993 (95.1132%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4625/4993 (92.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0559, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4552/5055 (90.0495%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4605/5055 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0075, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4432/4748 (93.3446%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4377/4748 (92.1862%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0128, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3983/4313 (92.3487%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3964/4313 (91.9082%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0058, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4341/4894 (88.7004%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4288/4894 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1984, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4950/5353 (92.4715%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4817/5353 (89.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0460, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5115/5727 (89.3138%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4987/5727 (87.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2086, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3925/4249 (92.3747%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3950/4249 (92.9631%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9549, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4166/4587 (90.8219%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4116/4587 (89.7319%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1424, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3658/3968 (92.1875%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3657/3968 (92.1623%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8410, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4998/5559 (89.9083%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4961/5559 (89.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2572, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4932/5298 (93.0917%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4946/5298 (93.3560%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9959, Accuracy: 5557/10000 (55.5700%)
time spent on training: 269.07361006736755
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.1919, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1675, Accuracy: 9431/9900 (95.2626%)
Done in 311.70300483703613 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5153/5308 (97.0799%), train_poison_data_count: 415
Global model norm: 43.38894824812103.
Norm before scaling: 43.35948338950416. Distance: 1.3326703101959596
Total norm for 4 adversaries is: 43.35948338950416. distance: 1.3326703101959596
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0810, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.38894824812103.
Norm before scaling: 43.35217845683334. Distance: 1.3420492098778285
Total norm for 4 adversaries is: 43.35217845683334. distance: 1.3420492098778285
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0492, Accuracy: 9770/9900 (98.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.38894824812103.
Norm before scaling: 43.362702575016876. Distance: 1.4090227130848796
Total norm for 4 adversaries is: 43.362702575016876. distance: 1.4090227130848796
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0757, Accuracy: 9701/9900 (97.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5306/5503 (96.4201%), train_poison_data_count: 430
Global model norm: 43.38894824812103.
Norm before scaling: 43.358789410460076. Distance: 1.3914419624761842
Total norm for 4 adversaries is: 43.358789410460076. distance: 1.3914419624761842
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0499, Accuracy: 9773/9900 (98.7172%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4390/4818 (91.1166%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4300/4818 (89.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0113, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5014/5298 (94.6395%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4957/5298 (93.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0240, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4966/5353 (92.7704%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4828/5353 (90.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1508, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3534/3774 (93.6407%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3494/3774 (92.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9162, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3631/3910 (92.8645%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3564/3910 (91.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0203, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4165/4537 (91.8007%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4159/4537 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9735, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5925/6664 (88.9106%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5639/6664 (84.6188%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2420, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4728/5209 (90.7660%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4642/5209 (89.1150%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2858, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4612/5123 (90.0254%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0122, Accuracy: 3993/5123 (77.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.4003, Accuracy: 4666/10000 (46.6600%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3844/4145 (92.7382%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3793/4145 (91.5078%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9958, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5089/5526 (92.0919%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4979/5526 (90.1013%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2016, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6346/6812 (93.1591%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6250/6812 (91.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1777, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5422/5907 (91.7894%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5355/5907 (90.6552%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2996, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3864/4175 (92.5509%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3856/4175 (92.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9827, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4726/5075 (93.1232%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4628/5075 (91.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2495, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3813/4111 (92.7512%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3775/4111 (91.8268%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0014, Accuracy: 5473/10000 (54.7300%)
time spent on training: 275.1262969970703
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.1954, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1604, Accuracy: 9456/9900 (95.5152%)
Done in 308.5062782764435 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 43.40980175803473.
Norm before scaling: 43.38041859841186. Distance: 1.3474930374163794
Total norm for 4 adversaries is: 43.38041859841186. distance: 1.3474930374163794
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0527, Accuracy: 9759/9900 (98.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5609/5777 (97.0919%), train_poison_data_count: 455
Global model norm: 43.40980175803473.
Norm before scaling: 43.37598780845659. Distance: 1.3955407001952647
Total norm for 4 adversaries is: 43.37598780845659. distance: 1.3955407001952647
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0620, Accuracy: 9733/9900 (98.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4931/5123 (96.2522%), train_poison_data_count: 403
Global model norm: 43.40980175803473.
Norm before scaling: 43.38194232537168. Distance: 1.3622568648500155
Total norm for 4 adversaries is: 43.38194232537168. distance: 1.3622568648500155
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0893, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5296/5503 (96.2384%), train_poison_data_count: 430
Global model norm: 43.40980175803473.
Norm before scaling: 43.38449441296683. Distance: 1.477869736806704
Total norm for 4 adversaries is: 43.38449441296683. distance: 1.477869736806704
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0397, Accuracy: 9798/9900 (98.9697%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4388/4714 (93.0844%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4393/4714 (93.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0717, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5054/5652 (89.4197%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5014/5652 (88.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2027, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4678/5086 (91.9780%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4657/5086 (91.5651%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0192, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4309/4737 (90.9647%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4253/4737 (89.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3430, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6385/6812 (93.7317%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6289/6812 (92.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1656, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4698/5075 (92.5714%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4718/5075 (92.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0308, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5407/5907 (91.5355%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5325/5907 (90.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3193, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4493/4830 (93.0228%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4546/4830 (94.1201%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0436, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4303/4549 (94.5922%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3914/4549 (86.0409%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4789, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5243/5696 (92.0471%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5184/5696 (91.0112%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0587, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3617/3959 (91.3615%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3622/3959 (91.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8724, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4359/4672 (93.3005%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4344/4672 (92.9795%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9645, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4414/4732 (93.2798%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4414/4732 (93.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8755, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4555/4929 (92.4123%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4470/4929 (90.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0956, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5634/6068 (92.8477%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5598/6068 (92.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1875, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3595/3995 (89.9875%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3568/3995 (89.3116%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1768, Accuracy: 5299/10000 (52.9900%)
time spent on training: 256.46145939826965
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.1969, Accuracy: 6875/10000 (68.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1553, Accuracy: 9476/9900 (95.7172%)
Done in 295.4710795879364 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5108/5308 (96.2321%), train_poison_data_count: 415
Global model norm: 43.431052803912664.
Norm before scaling: 43.40400434030756. Distance: 1.4004815363404015
Total norm for 4 adversaries is: 43.40400434030756. distance: 1.4004815363404015
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0631, Accuracy: 9721/9900 (98.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5581/5777 (96.6072%), train_poison_data_count: 455
Global model norm: 43.431052803912664.
Norm before scaling: 43.39859009311607. Distance: 1.4137601581886483
Total norm for 4 adversaries is: 43.39859009311607. distance: 1.4137601581886483
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0531, Accuracy: 9767/9900 (98.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4906/5123 (95.7642%), train_poison_data_count: 403
Global model norm: 43.431052803912664.
Norm before scaling: 43.406077044741814. Distance: 1.450135303630054
Total norm for 4 adversaries is: 43.406077044741814. distance: 1.450135303630054
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0149, Accuracy: 9861/9900 (99.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5332/5503 (96.8926%), train_poison_data_count: 430
Global model norm: 43.431052803912664.
Norm before scaling: 43.40028194212856. Distance: 1.343958949322141
Total norm for 4 adversaries is: 43.40028194212856. distance: 1.343958949322141
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0485, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4693/4993 (93.9916%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4637/4993 (92.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1317, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3844/4175 (92.0719%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3785/4175 (90.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1252, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4126/4368 (94.4597%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4079/4368 (93.3837%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0369, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4512/4911 (91.8754%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4453/4911 (90.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1191, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3640/3910 (93.0946%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3442/3910 (88.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1255, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3319/3589 (92.4770%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3203/3589 (89.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2233, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4408/4731 (93.1727%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4405/4731 (93.1093%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8904, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3998/4196 (95.2812%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3952/4196 (94.1849%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8332, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4667/5035 (92.6912%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4603/5035 (91.4201%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0589, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4336/4672 (92.8082%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4367/4672 (93.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8277, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4559/4979 (91.5646%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4537/4979 (91.1227%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0387, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4298/4605 (93.3333%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4307/4605 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0024, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4940/5702 (86.6363%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4751/5702 (83.3216%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0964, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5037/5346 (94.2200%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5028/5346 (94.0516%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1554, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5424/5871 (92.3863%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5322/5871 (90.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1120, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5079/5645 (89.9734%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5003/5645 (88.6271%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1042, Accuracy: 5258/10000 (52.5800%)
time spent on training: 256.3513572216034
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.1957, Accuracy: 6868/10000 (68.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1474, Accuracy: 9495/9900 (95.9091%)
Done in 294.00152039527893 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 43.45098571010429.
Norm before scaling: 43.42030347551995. Distance: 1.2865564666673293
Total norm for 4 adversaries is: 43.42030347551995. distance: 1.2865564666673293
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0433, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.45098571010429.
Norm before scaling: 43.41578256557458. Distance: 1.3596373995381863
Total norm for 4 adversaries is: 43.41578256557458. distance: 1.3596373995381863
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0776, Accuracy: 9674/9900 (97.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4938/5123 (96.3888%), train_poison_data_count: 403
Global model norm: 43.45098571010429.
Norm before scaling: 43.423131616397725. Distance: 1.3661074050383173
Total norm for 4 adversaries is: 43.423131616397725. distance: 1.3661074050383173
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0688, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5330/5503 (96.8563%), train_poison_data_count: 430
Global model norm: 43.45098571010429.
Norm before scaling: 43.42083341454955. Distance: 1.3678802914778982
Total norm for 4 adversaries is: 43.42083341454955. distance: 1.3678802914778982
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0944, Accuracy: 9637/9900 (97.3434%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5931/6664 (89.0006%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0091, Accuracy: 5532/6664 (83.0132%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4543, Accuracy: 4757/10000 (47.5700%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4855/5504 (88.2086%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4850/5504 (88.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0831, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4741/5075 (93.4187%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4682/5075 (92.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1514, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4377/4894 (89.4360%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4309/4894 (88.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3055, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5026/5346 (94.0142%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4934/5346 (92.2933%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9900, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3628/3910 (92.7877%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3454/3910 (88.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1114, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5393/6080 (88.7007%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5378/6080 (88.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3633, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4044/4313 (93.7630%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3989/4313 (92.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8746, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4313/4605 (93.6591%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4332/4605 (94.0717%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7459, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4564/4929 (92.5948%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4496/4929 (91.2153%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0189, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5075/5645 (89.9026%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4849/5645 (85.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3305, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4926/5353 (92.0232%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4852/5353 (90.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0305, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5736/6419 (89.3597%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5484/6419 (85.4339%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3839, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5021/5298 (94.7716%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4973/5298 (93.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9888, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4741/5209 (91.0156%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4730/5209 (90.8044%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0649, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4364/4714 (92.5753%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4326/4714 (91.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1545, Accuracy: 5313/10000 (53.1300%)
time spent on training: 273.8508343696594
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.1993, Accuracy: 6865/10000 (68.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1399, Accuracy: 9516/9900 (96.1212%)
Done in 307.3491711616516 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.47275435366098.
Norm before scaling: 43.43975235842094. Distance: 1.2711015116074202
Total norm for 4 adversaries is: 43.43975235842094. distance: 1.2711015116074202
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0734, Accuracy: 9705/9900 (98.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5598/5777 (96.9015%), train_poison_data_count: 455
Global model norm: 43.47275435366098.
Norm before scaling: 43.43720211228792. Distance: 1.3630642431292526
Total norm for 4 adversaries is: 43.43720211228792. distance: 1.3630642431292526
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0653, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4902/5123 (95.6861%), train_poison_data_count: 403
Global model norm: 43.47275435366098.
Norm before scaling: 43.447777280154824. Distance: 1.4530365619614423
Total norm for 4 adversaries is: 43.447777280154824. distance: 1.4530365619614423
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0871, Accuracy: 9672/9900 (97.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5310/5503 (96.4928%), train_poison_data_count: 430
Global model norm: 43.47275435366098.
Norm before scaling: 43.44323534528276. Distance: 1.391820586519399
Total norm for 4 adversaries is: 43.44323534528276. distance: 1.391820586519399
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0272, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4389/4714 (93.1056%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4352/4714 (92.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9807, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4228/4537 (93.1893%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4191/4537 (92.3738%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7912, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5626/6235 (90.2326%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5505/6235 (88.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2346, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4067/4527 (89.8387%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4015/4527 (88.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0193, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4703/5035 (93.4062%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4692/5035 (93.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9846, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3775/4145 (91.0736%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3814/4145 (92.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0355, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3869/4175 (92.6707%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3785/4175 (90.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0770, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4633/5123 (90.4353%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0164, Accuracy: 3630/5123 (70.8569%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.4839, Accuracy: 4554/10000 (45.5400%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3891/4130 (94.2131%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3857/4130 (93.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9440, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4777/5209 (91.7067%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4651/5209 (89.2878%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0969, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3812/4111 (92.7268%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3789/4111 (92.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8899, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4645/5038 (92.1993%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4646/5038 (92.2191%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0146, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3763/4028 (93.4211%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3767/4028 (93.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8297, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4545/5050 (90.0000%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4537/5050 (89.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1212, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4480/4889 (91.6343%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4378/4889 (89.5480%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1502, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4038/4364 (92.5298%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3970/4364 (90.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0181, Accuracy: 5435/10000 (54.3500%)
time spent on training: 274.1640441417694
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.1985, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1318, Accuracy: 9544/9900 (96.4040%)
Done in 308.87953305244446 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 43.4919468232518.
Norm before scaling: 43.46141428037058. Distance: 1.3169330029778568
Total norm for 4 adversaries is: 43.46141428037058. distance: 1.3169330029778568
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0357, Accuracy: 9798/9900 (98.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5624/5777 (97.3516%), train_poison_data_count: 455
Global model norm: 43.4919468232518.
Norm before scaling: 43.453797808077866. Distance: 1.315093158134489
Total norm for 4 adversaries is: 43.453797808077866. distance: 1.315093158134489
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0557, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4937/5123 (96.3693%), train_poison_data_count: 403
Global model norm: 43.4919468232518.
Norm before scaling: 43.46348143844439. Distance: 1.363344338605029
Total norm for 4 adversaries is: 43.46348143844439. distance: 1.363344338605029
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1658, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5309/5503 (96.4747%), train_poison_data_count: 430
Global model norm: 43.4919468232518.
Norm before scaling: 43.4651876123834. Distance: 1.4310429719008293
Total norm for 4 adversaries is: 43.4651876123834. distance: 1.4310429719008293
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1021, Accuracy: 9627/9900 (97.2424%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4782/5193 (92.0855%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4505/5193 (86.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3561, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3507/3774 (92.9253%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3498/3774 (92.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8820, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4657/5086 (91.5651%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/5086 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0138, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5608/6235 (89.9439%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5532/6235 (88.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3767, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4896/5504 (88.9535%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4825/5504 (87.6635%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1911, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5112/5422 (94.2826%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5057/5422 (93.2682%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9706, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4230/4537 (93.2334%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4176/4537 (92.0432%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8985, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4943/5362 (92.1858%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4917/5362 (91.7009%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9597, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4587/5038 (91.0480%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4605/5038 (91.4053%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9885, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4560/4911 (92.8528%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4574/4911 (93.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0626, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4617/4979 (92.7295%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4583/4979 (92.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0381, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4322/4741 (91.1622%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3797/4741 (80.0886%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.6646, Accuracy: 4377/10000 (43.7700%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4749/5068 (93.7056%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4632/5068 (91.3970%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1628, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3263/3552 (91.8637%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3284/3552 (92.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7667, Accuracy: 5970/10000 (59.7000%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4666/5055 (92.3046%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4570/5055 (90.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1534, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3658/3959 (92.3971%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3635/3959 (91.8161%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0724, Accuracy: 5516/10000 (55.1600%)
time spent on training: 264.29877400398254
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2026, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1266, Accuracy: 9553/9900 (96.4949%)
Done in 301.0763359069824 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5166/5308 (97.3248%), train_poison_data_count: 415
Global model norm: 43.51152920581079.
Norm before scaling: 43.478536989081604. Distance: 1.2676547222770063
Total norm for 4 adversaries is: 43.478536989081604. distance: 1.2676547222770063
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0600, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 43.51152920581079.
Norm before scaling: 43.476177137780006. Distance: 1.3437392212191468
Total norm for 4 adversaries is: 43.476177137780006. distance: 1.3437392212191468
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1381, Accuracy: 9566/9900 (96.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.51152920581079.
Norm before scaling: 43.483545457861844. Distance: 1.3950048331720446
Total norm for 4 adversaries is: 43.483545457861844. distance: 1.3950048331720446
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0585, Accuracy: 9732/9900 (98.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5338/5503 (97.0016%), train_poison_data_count: 430
Global model norm: 43.51152920581079.
Norm before scaling: 43.48128554197556. Distance: 1.3530272556443945
Total norm for 4 adversaries is: 43.48128554197556. distance: 1.3530272556443945
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0197, Accuracy: 9862/9900 (99.6162%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3563/3929 (90.6847%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3538/3929 (90.0484%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9718, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4375/4797 (91.2028%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4294/4797 (89.5143%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1123, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4744/5224 (90.8116%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4721/5224 (90.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2092, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4040/4313 (93.6703%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4057/4313 (94.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7680, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3844/4108 (93.5735%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3834/4108 (93.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9049, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4743/5209 (91.0539%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4698/5209 (90.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2235, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3652/3910 (93.4015%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3590/3910 (91.8159%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0534, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3825/4086 (93.6123%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3801/4086 (93.0250%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0468, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4573/5122 (89.2815%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4383/5122 (85.5720%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.5543, Accuracy: 4652/10000 (46.5200%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4898/5362 (91.3465%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4806/5362 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1483, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4402/4731 (93.0459%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4398/4731 (92.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9497, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3651/3968 (92.0111%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3649/3968 (91.9607%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9049, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4444/4818 (92.2374%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4331/4818 (89.8921%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0113, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3873/4161 (93.0786%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3800/4161 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9407, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4518/4911 (91.9976%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4529/4911 (92.2215%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9446, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4758/5068 (93.8832%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4766/5068 (94.0410%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0100, Accuracy: 5535/10000 (55.3500%)
time spent on training: 256.1221215724945
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2134, Accuracy: 6838/10000 (68.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1165, Accuracy: 9586/9900 (96.8283%)
Done in 291.32473373413086 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5173/5308 (97.4567%), train_poison_data_count: 415
Global model norm: 43.53002314540003.
Norm before scaling: 43.49564032795772. Distance: 1.222035503333713
Total norm for 4 adversaries is: 43.49564032795772. distance: 1.222035503333713
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0625, Accuracy: 9732/9900 (98.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5619/5777 (97.2650%), train_poison_data_count: 455
Global model norm: 43.53002314540003.
Norm before scaling: 43.494411065622124. Distance: 1.3552149554283133
Total norm for 4 adversaries is: 43.494411065622124. distance: 1.3552149554283133
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0962, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4931/5123 (96.2522%), train_poison_data_count: 403
Global model norm: 43.53002314540003.
Norm before scaling: 43.5003381474824. Distance: 1.3424102402983045
Total norm for 4 adversaries is: 43.5003381474824. distance: 1.3424102402983045
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1542, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5320/5503 (96.6745%), train_poison_data_count: 430
Global model norm: 43.53002314540003.
Norm before scaling: 43.499682896653106. Distance: 1.4117539249971551
Total norm for 4 adversaries is: 43.499682896653106. distance: 1.4117539249971551
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0893, Accuracy: 9672/9900 (97.6970%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4453/4818 (92.4242%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4212/4818 (87.4222%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1791, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5448/6080 (89.6053%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5345/6080 (87.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1573, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4831/5399 (89.4795%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4743/5399 (87.8496%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2115, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5600/6235 (89.8156%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5462/6235 (87.6022%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1495, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5342/5696 (93.7851%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5271/5696 (92.5386%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9435, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4326/4605 (93.9414%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4338/4605 (94.2020%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8162, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4133/4485 (92.1516%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4018/4485 (89.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0530, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5144/5615 (91.6118%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5066/5615 (90.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1347, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3257/3552 (91.6948%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3314/3552 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7428, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4021/4313 (93.2298%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4052/4313 (93.9485%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7814, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3615/3995 (90.4881%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3589/3995 (89.8373%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2253, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4325/4549 (95.0758%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3982/4549 (87.5357%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2785, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5007/5346 (93.6588%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4944/5346 (92.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1092, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4875/5361 (90.9345%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4816/5361 (89.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1124, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3863/4161 (92.8383%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3830/4161 (92.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1352, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4397/4714 (93.2754%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4410/4714 (93.5511%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0582, Accuracy: 5520/10000 (55.2000%)
time spent on training: 271.9751172065735
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2227, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1136, Accuracy: 9593/9900 (96.8990%)
Done in 305.49639105796814 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5180/5308 (97.5885%), train_poison_data_count: 415
Global model norm: 43.550230293234385.
Norm before scaling: 43.51573861071345. Distance: 1.2467476495323262
Total norm for 4 adversaries is: 43.51573861071345. distance: 1.2467476495323262
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0982, Accuracy: 9642/9900 (97.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.550230293234385.
Norm before scaling: 43.51348036681061. Distance: 1.383247048586329
Total norm for 4 adversaries is: 43.51348036681061. distance: 1.383247048586329
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0421, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4951/5123 (96.6426%), train_poison_data_count: 403
Global model norm: 43.550230293234385.
Norm before scaling: 43.51966150488765. Distance: 1.3422270727929586
Total norm for 4 adversaries is: 43.51966150488765. distance: 1.3422270727929586
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0835, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5338/5503 (97.0016%), train_poison_data_count: 430
Global model norm: 43.550230293234385.
Norm before scaling: 43.51869378766296. Distance: 1.363758604755056
Total norm for 4 adversaries is: 43.51869378766296. distance: 1.363758604755056
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0468, Accuracy: 9773/9900 (98.7172%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5175/5727 (90.3614%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5106/5727 (89.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1365, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5870/6664 (88.0852%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5704/6664 (85.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2915, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4059/4364 (93.0110%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3919/4364 (89.8029%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9458, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4990/5454 (91.4925%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4851/5454 (88.9439%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1035, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4475/5050 (88.6139%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4429/5050 (87.7030%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0629, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4728/4993 (94.6926%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4641/4993 (92.9501%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0193, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4427/4818 (91.8846%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4298/4818 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0169, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4693/5035 (93.2075%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4680/5035 (92.9494%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9567, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6389/6812 (93.7904%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 6318/6812 (92.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1537, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4472/4843 (92.3395%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4436/4843 (91.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0509, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3320/3552 (93.4685%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3331/3552 (93.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7776, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4642/5123 (90.6110%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4423/5123 (86.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.4010, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4472/4903 (91.2095%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4449/4903 (90.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1132, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5130/5422 (94.6145%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5093/5422 (93.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9548, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4746/5209 (91.1115%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4725/5209 (90.7084%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0757, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5293/5696 (92.9249%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5212/5696 (91.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0637, Accuracy: 5426/10000 (54.2600%)
time spent on training: 273.1626591682434
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2218, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1171, Accuracy: 9588/9900 (96.8485%)
Done in 311.30070066452026 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 43.571674798274195.
Norm before scaling: 43.54001925088214. Distance: 1.320899155878991
Total norm for 4 adversaries is: 43.54001925088214. distance: 1.320899155878991
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0918, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5619/5777 (97.2650%), train_poison_data_count: 455
Global model norm: 43.571674798274195.
Norm before scaling: 43.535262624645725. Distance: 1.356881716169958
Total norm for 4 adversaries is: 43.535262624645725. distance: 1.356881716169958
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0938, Accuracy: 9656/9900 (97.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4947/5123 (96.5645%), train_poison_data_count: 403
Global model norm: 43.571674798274195.
Norm before scaling: 43.54089818151579. Distance: 1.3379338835245351
Total norm for 4 adversaries is: 43.54089818151579. distance: 1.3379338835245351
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1597, Accuracy: 9470/9900 (95.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5316/5503 (96.6019%), train_poison_data_count: 430
Global model norm: 43.571674798274195.
Norm before scaling: 43.54308912274785. Distance: 1.437036854313172
Total norm for 4 adversaries is: 43.54308912274785. distance: 1.437036854313172
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0262, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4441/4818 (92.1752%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4257/4818 (88.3562%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0784, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4454/4851 (91.8161%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4427/4851 (91.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9609, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4238/4587 (92.3915%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4224/4587 (92.0863%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9825, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4145/4485 (92.4192%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3995/4485 (89.0747%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0542, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5312/5696 (93.2584%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5231/5696 (91.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1411, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4354/4672 (93.1935%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4325/4672 (92.5728%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8869, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6248/6947 (89.9381%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6117/6947 (88.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3494, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5075/5645 (89.9026%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4967/5645 (87.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1365, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4921/5702 (86.3031%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0123, Accuracy: 4308/5702 (75.5524%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3156, Accuracy: 4799/10000 (47.9900%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4339/4741 (91.5208%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4221/4741 (89.0318%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1169, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3821/4145 (92.1834%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3761/4145 (90.7358%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0775, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4673/5038 (92.7551%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4600/5038 (91.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9462, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5385/6080 (88.5691%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5320/6080 (87.5000%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2669, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4404/4894 (89.9877%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4252/4894 (86.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1668, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4444/4732 (93.9138%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4498/4732 (95.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8417, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3953/4249 (93.0337%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3899/4249 (91.7628%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0755, Accuracy: 5427/10000 (54.2700%)
time spent on training: 274.94102334976196
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2211, Accuracy: 6817/10000 (68.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1225, Accuracy: 9567/9900 (96.6364%)
Done in 311.09964299201965 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.592593510645536.
Norm before scaling: 43.56185969534803. Distance: 1.309267969240885
Total norm for 4 adversaries is: 43.56185969534803. distance: 1.309267969240885
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0757, Accuracy: 9690/9900 (97.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5607/5777 (97.0573%), train_poison_data_count: 455
Global model norm: 43.592593510645536.
Norm before scaling: 43.55628710627634. Distance: 1.3960967693072066
Total norm for 4 adversaries is: 43.55628710627634. distance: 1.3960967693072066
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0741, Accuracy: 9712/9900 (98.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4943/5123 (96.4864%), train_poison_data_count: 403
Global model norm: 43.592593510645536.
Norm before scaling: 43.562521016404546. Distance: 1.3328811305846961
Total norm for 4 adversaries is: 43.562521016404546. distance: 1.3328811305846961
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0389, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5333/5503 (96.9108%), train_poison_data_count: 430
Global model norm: 43.592593510645536.
Norm before scaling: 43.56210769192074. Distance: 1.3710289312185728
Total norm for 4 adversaries is: 43.56210769192074. distance: 1.3710289312185728
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0581, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5888/6664 (88.3553%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5725/6664 (85.9094%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2447, Accuracy: 4923/10000 (49.2300%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4433/4757 (93.1890%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4319/4757 (90.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0278, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4619/5055 (91.3749%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4599/5055 (90.9792%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1461, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5140/5422 (94.7990%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5049/5422 (93.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9582, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4412/4869 (90.6141%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4177/4869 (85.7876%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1463, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3826/4111 (93.0674%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3799/4111 (92.4106%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1224, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3880/4130 (93.9467%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3815/4130 (92.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0216, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4028/4313 (93.3921%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4030/4313 (93.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7664, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4947/5353 (92.4155%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4837/5353 (90.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3037, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4645/5122 (90.6872%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4348/5122 (84.8887%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.5108, Accuracy: 4734/10000 (47.3400%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4718/5068 (93.0939%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4679/5068 (92.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2332, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4884/5504 (88.7355%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4790/5504 (87.0276%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2406, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3594/3929 (91.4737%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3588/3929 (91.3209%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0257, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4682/5123 (91.3918%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4333/5123 (84.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.5299, Accuracy: 4635/10000 (46.3500%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3905/4161 (93.8476%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3800/4161 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0194, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4996/5454 (91.6025%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4867/5454 (89.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1055, Accuracy: 5384/10000 (53.8400%)
time spent on training: 259.3136656284332
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2249, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1138, Accuracy: 9594/9900 (96.9091%)
Done in 294.53834867477417 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5180/5308 (97.5885%), train_poison_data_count: 415
Global model norm: 43.61339303193243.
Norm before scaling: 43.57864041466444. Distance: 1.219509621623278
Total norm for 4 adversaries is: 43.57864041466444. distance: 1.219509621623278
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1182, Accuracy: 9579/9900 (96.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5624/5777 (97.3516%), train_poison_data_count: 455
Global model norm: 43.61339303193243.
Norm before scaling: 43.57596663487871. Distance: 1.3386927518171226
Total norm for 4 adversaries is: 43.57596663487871. distance: 1.3386927518171226
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0775, Accuracy: 9696/9900 (97.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.61339303193243.
Norm before scaling: 43.583683593587374. Distance: 1.346438579261941
Total norm for 4 adversaries is: 43.583683593587374. distance: 1.346438579261941
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1796, Accuracy: 9434/9900 (95.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5329/5503 (96.8381%), train_poison_data_count: 430
Global model norm: 43.61339303193243.
Norm before scaling: 43.58211930421552. Distance: 1.3725871677199601
Total norm for 4 adversaries is: 43.58211930421552. distance: 1.3725871677199601
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0856, Accuracy: 9669/9900 (97.6667%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3700/3968 (93.2460%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3684/3968 (92.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8759, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4107/4368 (94.0247%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3977/4368 (91.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0589, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4592/4956 (92.6554%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4521/4956 (91.2228%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0666, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4405/4714 (93.4451%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4378/4714 (92.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9617, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5462/5871 (93.0336%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5382/5871 (91.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0959, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4666/5038 (92.6161%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4647/5038 (92.2390%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9070, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5119/5615 (91.1665%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5109/5615 (90.9884%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0626, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3813/4175 (91.3293%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3743/4175 (89.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1988, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4856/5399 (89.9426%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4708/5399 (87.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4187, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5867/6664 (88.0402%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5708/6664 (85.6543%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2132, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4445/4732 (93.9349%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4442/4732 (93.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9267, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4529/4830 (93.7681%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4469/4830 (92.5259%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0135, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4916/5427 (90.5841%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4864/5427 (89.6259%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0193, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5075/5497 (92.3231%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4988/5497 (90.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0962, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5005/5489 (91.1824%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4988/5489 (90.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1027, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4640/5055 (91.7903%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4581/5055 (90.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1605, Accuracy: 5294/10000 (52.9400%)
time spent on training: 275.0673313140869
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2256, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1187, Accuracy: 9581/9900 (96.7778%)
Done in 308.4351980686188 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.63418263851461.
Norm before scaling: 43.60042231643949. Distance: 1.2865433555440642
Total norm for 4 adversaries is: 43.60042231643949. distance: 1.2865433555440642
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0627, Accuracy: 9725/9900 (98.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5616/5777 (97.2131%), train_poison_data_count: 455
Global model norm: 43.63418263851461.
Norm before scaling: 43.596622889207254. Distance: 1.3534866924413795
Total norm for 4 adversaries is: 43.596622889207254. distance: 1.3534866924413795
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0451, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4942/5123 (96.4669%), train_poison_data_count: 403
Global model norm: 43.63418263851461.
Norm before scaling: 43.60469872590066. Distance: 1.3696568885705471
Total norm for 4 adversaries is: 43.60469872590066. distance: 1.3696568885705471
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0190, Accuracy: 9842/9900 (99.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5318/5503 (96.6382%), train_poison_data_count: 430
Global model norm: 43.63418263851461.
Norm before scaling: 43.60249968196347. Distance: 1.3895958510506579
Total norm for 4 adversaries is: 43.60249968196347. distance: 1.3895958510506579
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0327, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4448/4731 (94.0182%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4377/4731 (92.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9161, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4122/4485 (91.9064%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3886/4485 (86.6444%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2786, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4411/4903 (89.9653%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4371/4903 (89.1495%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1472, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4748/5224 (90.8882%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4766/5224 (91.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1107, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4865/5361 (90.7480%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4749/5361 (88.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9966, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5087/5645 (90.1151%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4983/5645 (88.2728%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2420, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4677/5038 (92.8345%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4623/5038 (91.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0659, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4650/5086 (91.4274%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4565/5086 (89.7562%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2186, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4489/4889 (91.8184%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4487/4889 (91.7775%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0230, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4792/5209 (91.9946%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4644/5209 (89.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2853, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4236/4736 (89.4426%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4271/4736 (90.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0476, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4590/4956 (92.6150%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4490/4956 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1477, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4438/4748 (93.4709%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4391/4748 (92.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9986, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4525/5018 (90.1754%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4373/5018 (87.1463%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2396, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4349/4605 (94.4408%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4331/4605 (94.0499%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8818, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4951/5353 (92.4902%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4805/5353 (89.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1352, Accuracy: 5391/10000 (53.9100%)
time spent on training: 266.6025855541229
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2313, Accuracy: 6803/10000 (68.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1037, Accuracy: 9628/9900 (97.2525%)
Done in 304.4998691082001 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5177/5308 (97.5320%), train_poison_data_count: 415
Global model norm: 43.65540694649476.
Norm before scaling: 43.6222842882332. Distance: 1.2633183027411707
Total norm for 4 adversaries is: 43.6222842882332. distance: 1.2633183027411707
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0921, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5614/5777 (97.1785%), train_poison_data_count: 455
Global model norm: 43.65540694649476.
Norm before scaling: 43.61860430597892. Distance: 1.3963614029526685
Total norm for 4 adversaries is: 43.61860430597892. distance: 1.3963614029526685
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0843, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4952/5123 (96.6621%), train_poison_data_count: 403
Global model norm: 43.65540694649476.
Norm before scaling: 43.62502378446701. Distance: 1.3339005048757024
Total norm for 4 adversaries is: 43.62502378446701. distance: 1.3339005048757024
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1046, Accuracy: 9633/9900 (97.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5340/5503 (97.0380%), train_poison_data_count: 430
Global model norm: 43.65540694649476.
Norm before scaling: 43.621884122697665. Distance: 1.3507238001876292
Total norm for 4 adversaries is: 43.621884122697665. distance: 1.3507238001876292
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0726, Accuracy: 9698/9900 (97.9596%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4749/5068 (93.7056%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4633/5068 (91.4167%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0952, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4727/5193 (91.0264%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4622/5193 (89.0044%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4301, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4547/4911 (92.5881%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4498/4911 (91.5903%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0494, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5034/5559 (90.5559%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4894/5559 (88.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2425, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3782/4145 (91.2425%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3821/4145 (92.1834%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1049, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4281/4549 (94.1086%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4081/4549 (89.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1529, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3576/3929 (91.0155%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3566/3929 (90.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0003, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4421/4714 (93.7845%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4407/4714 (93.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0189, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4445/4851 (91.6306%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4474/4851 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0042, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4291/4736 (90.6039%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4249/4736 (89.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9884, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4460/4894 (91.1320%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4333/4894 (88.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3209, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4339/4605 (94.2237%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4309/4605 (93.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1702, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3335/3589 (92.9228%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3017/3589 (84.0624%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4071, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5501/5939 (92.6250%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5453/5939 (91.8168%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0787, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3518/3774 (93.2167%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3537/3774 (93.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9664, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3263/3552 (91.8637%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3292/3552 (92.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9583, Accuracy: 5672/10000 (56.7200%)
time spent on training: 249.9473602771759
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2382, Accuracy: 6789/10000 (67.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1005, Accuracy: 9632/9900 (97.2929%)
Done in 285.2272939682007 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.67417676179269.
Norm before scaling: 43.63982779884105. Distance: 1.248949229143869
Total norm for 4 adversaries is: 43.63982779884105. distance: 1.248949229143869
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0858, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5616/5777 (97.2131%), train_poison_data_count: 455
Global model norm: 43.67417676179269.
Norm before scaling: 43.63822915684495. Distance: 1.374278616238259
Total norm for 4 adversaries is: 43.63822915684495. distance: 1.374278616238259
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0318, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4932/5123 (96.2717%), train_poison_data_count: 403
Global model norm: 43.67417676179269.
Norm before scaling: 43.64404720514944. Distance: 1.3350355885080396
Total norm for 4 adversaries is: 43.64404720514944. distance: 1.3350355885080396
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1257, Accuracy: 9568/9900 (96.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5346/5503 (97.1470%), train_poison_data_count: 430
Global model norm: 43.67417676179269.
Norm before scaling: 43.641204010659465. Distance: 1.3387028588437495
Total norm for 4 adversaries is: 43.641204010659465. distance: 1.3387028588437495
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0819, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4377/4741 (92.3223%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4255/4741 (89.7490%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4013, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4456/4818 (92.4865%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4419/4818 (91.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0973, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5699/6419 (88.7833%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5562/6419 (86.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2621, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4525/4830 (93.6853%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4547/4830 (94.1408%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0829, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5057/5497 (91.9956%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4987/5497 (90.7222%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2304, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4505/5018 (89.7768%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4416/5018 (88.0032%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2353, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5672/6235 (90.9703%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5491/6235 (88.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4689, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4352/4797 (90.7234%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4309/4797 (89.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1396, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4623/4979 (92.8500%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4608/4979 (92.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0274, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3816/4086 (93.3921%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3805/4086 (93.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0088, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5610/6068 (92.4522%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5587/6068 (92.0732%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1796, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3971/4196 (94.6378%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3971/4196 (94.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7988, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5119/5652 (90.5697%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5003/5652 (88.5173%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0788, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3824/4111 (93.0187%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3781/4111 (91.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9611, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4530/4889 (92.6570%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4520/4889 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1518, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4077/4368 (93.3379%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3996/4368 (91.4835%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1231, Accuracy: 5345/10000 (53.4500%)
time spent on training: 266.14684772491455
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2395, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1001, Accuracy: 9634/9900 (97.3131%)
Done in 301.0901298522949 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5181/5308 (97.6074%), train_poison_data_count: 415
Global model norm: 43.69453236050393.
Norm before scaling: 43.66191746945357. Distance: 1.293787901318577
Total norm for 4 adversaries is: 43.66191746945357. distance: 1.293787901318577
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0257, Accuracy: 9829/9900 (99.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5598/5777 (96.9015%), train_poison_data_count: 455
Global model norm: 43.69453236050393.
Norm before scaling: 43.65779206072139. Distance: 1.3625404509392967
Total norm for 4 adversaries is: 43.65779206072139. distance: 1.3625404509392967
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0648, Accuracy: 9736/9900 (98.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4938/5123 (96.3888%), train_poison_data_count: 403
Global model norm: 43.69453236050393.
Norm before scaling: 43.662304687063155. Distance: 1.2966962484321212
Total norm for 4 adversaries is: 43.662304687063155. distance: 1.2966962484321212
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0988, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5334/5503 (96.9289%), train_poison_data_count: 430
Global model norm: 43.69453236050393.
Norm before scaling: 43.662745020605094. Distance: 1.3521534945128784
Total norm for 4 adversaries is: 43.662745020605094. distance: 1.3521534945128784
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0417, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4419/4731 (93.4052%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4414/4731 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0219, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5017/5346 (93.8459%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4924/5346 (92.1062%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9833, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4876/5399 (90.3130%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4709/5399 (87.2199%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1469, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4494/4818 (93.2752%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4404/4818 (91.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1551, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5177/5652 (91.5959%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4998/5652 (88.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1827, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4434/4714 (94.0602%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4441/4714 (94.2087%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9585, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5114/5422 (94.3194%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5019/5422 (92.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0651, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3852/4130 (93.2688%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3801/4130 (92.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9960, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4419/4732 (93.3855%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4454/4732 (94.1251%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8361, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5101/5645 (90.3632%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4887/5645 (86.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3775, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5009/5702 (87.8464%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0134, Accuracy: 4246/5702 (74.4651%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.4547, Accuracy: 4582/10000 (45.8200%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4345/4736 (91.7441%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4342/4736 (91.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9613, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4092/4527 (90.3910%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4077/4527 (90.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0482, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3835/4111 (93.2863%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3724/4111 (90.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0491, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4921/5362 (91.7755%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4856/5362 (90.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1227, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5507/5939 (92.7260%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5407/5939 (91.0423%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2459, Accuracy: 5198/10000 (51.9800%)
time spent on training: 267.62986946105957
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2387, Accuracy: 6811/10000 (68.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0984, Accuracy: 9635/9900 (97.3232%)
Done in 301.33505177497864 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.71509628897879.
Norm before scaling: 43.68179532899332. Distance: 1.2678175877823268
Total norm for 4 adversaries is: 43.68179532899332. distance: 1.2678175877823268
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1100, Accuracy: 9630/9900 (97.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 43.71509628897879.
Norm before scaling: 43.67435284786355. Distance: 1.291852209649594
Total norm for 4 adversaries is: 43.67435284786355. distance: 1.291852209649594
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0628, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 43.71509628897879.
Norm before scaling: 43.68293827891718. Distance: 1.295578687900999
Total norm for 4 adversaries is: 43.68293827891718. distance: 1.295578687900999
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0764, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5362/5503 (97.4378%), train_poison_data_count: 430
Global model norm: 43.71509628897879.
Norm before scaling: 43.68049165889162. Distance: 1.3181576722872361
Total norm for 4 adversaries is: 43.68049165889162. distance: 1.3181576722872361
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0575, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4741/5075 (93.4187%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4610/5075 (90.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0948, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4674/5086 (91.8993%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4645/5086 (91.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2188, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5023/5497 (91.3771%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4956/5497 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0827, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4422/4748 (93.1340%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4326/4748 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1261, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5122/5652 (90.6228%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4942/5652 (87.4381%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2303, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4613/4979 (92.6491%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4584/4979 (92.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0021, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4025/4364 (92.2319%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3984/4364 (91.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2116, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4505/4889 (92.1456%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4486/4889 (91.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0101, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4951/5427 (91.2290%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4822/5427 (88.8520%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0709, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3655/3910 (93.4783%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3597/3910 (91.9949%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0334, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3694/3968 (93.0948%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3678/3968 (92.6915%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8443, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4804/5193 (92.5091%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4551/5193 (87.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2652, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5403/5907 (91.4678%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5352/5907 (90.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2977, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4484/4869 (92.0928%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3929/4869 (80.6942%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.5171, Accuracy: 4720/10000 (47.2000%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4451/4894 (90.9481%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4272/4894 (87.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1204, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5187/5727 (90.5710%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5032/5727 (87.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0733, Accuracy: 5374/10000 (53.7400%)
time spent on training: 272.459068775177
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2431, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0993, Accuracy: 9635/9900 (97.3232%)
Done in 308.9766776561737 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5171/5308 (97.4190%), train_poison_data_count: 415
Global model norm: 43.73659253265151.
Norm before scaling: 43.70309427510539. Distance: 1.2716968552208794
Total norm for 4 adversaries is: 43.70309427510539. distance: 1.2716968552208794
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0405, Accuracy: 9793/9900 (98.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5625/5777 (97.3689%), train_poison_data_count: 455
Global model norm: 43.73659253265151.
Norm before scaling: 43.696599664798. Distance: 1.2973234481353237
Total norm for 4 adversaries is: 43.696599664798. distance: 1.2973234481353237
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0920, Accuracy: 9674/9900 (97.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4955/5123 (96.7207%), train_poison_data_count: 403
Global model norm: 43.73659253265151.
Norm before scaling: 43.70358307768512. Distance: 1.2942627024507107
Total norm for 4 adversaries is: 43.70358307768512. distance: 1.2942627024507107
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0481, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5365/5503 (97.4923%), train_poison_data_count: 430
Global model norm: 43.73659253265151.
Norm before scaling: 43.703070533126585. Distance: 1.3208102128966623
Total norm for 4 adversaries is: 43.703070533126585. distance: 1.3208102128966623
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0443, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4514/4843 (93.2067%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4432/4843 (91.5135%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0842, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4436/4757 (93.2520%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4374/4757 (91.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9268, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4505/4830 (93.2712%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4502/4830 (93.2091%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1142, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4583/4979 (92.0466%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4568/4979 (91.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9517, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4202/4537 (92.6163%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4211/4537 (92.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0006, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6311/6812 (92.6453%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6212/6812 (91.1920%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2065, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3758/4028 (93.2969%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3745/4028 (92.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9212, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4181/4485 (93.2219%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3982/4485 (88.7848%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9978, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4971/5427 (91.5976%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4917/5427 (90.6025%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0912, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4644/5123 (90.6500%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4268/5123 (83.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3438, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3987/4249 (93.8338%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3875/4249 (91.1979%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0688, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3638/3995 (91.0638%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3565/3995 (89.2365%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0707, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4403/4737 (92.9491%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4306/4737 (90.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1119, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4693/5038 (93.1520%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4640/5038 (92.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9008, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4337/4736 (91.5752%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4281/4736 (90.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0417, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5498/5871 (93.6467%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5365/5871 (91.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0351, Accuracy: 5492/10000 (54.9200%)
time spent on training: 258.99881505966187
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2438, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0913, Accuracy: 9659/9900 (97.5657%)
Done in 294.13661074638367 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5197/5308 (97.9088%), train_poison_data_count: 415
Global model norm: 43.75661361841844.
Norm before scaling: 43.71958345569023. Distance: 1.1794305483659835
Total norm for 4 adversaries is: 43.71958345569023. distance: 1.1794305483659835
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0733, Accuracy: 9703/9900 (98.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5615/5777 (97.1958%), train_poison_data_count: 455
Global model norm: 43.75661361841844.
Norm before scaling: 43.71939498720076. Distance: 1.3821503945289813
Total norm for 4 adversaries is: 43.71939498720076. distance: 1.3821503945289813
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0495, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4953/5123 (96.6816%), train_poison_data_count: 403
Global model norm: 43.75661361841844.
Norm before scaling: 43.72532088531126. Distance: 1.3260139292622586
Total norm for 4 adversaries is: 43.72532088531126. distance: 1.3260139292622586
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0509, Accuracy: 9773/9900 (98.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 43.75661361841844.
Norm before scaling: 43.72118889507052. Distance: 1.2756206310894551
Total norm for 4 adversaries is: 43.72118889507052. distance: 1.2756206310894551
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0147, Accuracy: 9864/9900 (99.6364%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3977/4196 (94.7807%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3973/4196 (94.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9251, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3837/4145 (92.5694%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3805/4145 (91.7973%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0007, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4997/5298 (94.3186%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4957/5298 (93.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1269, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4348/4737 (91.7881%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4367/4737 (92.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0939, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4683/5193 (90.1791%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4454/5193 (85.7693%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2230, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4503/4818 (93.4620%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4332/4818 (89.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0388, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3855/4111 (93.7728%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3874/4111 (94.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0035, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6336/6812 (93.0123%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 6316/6812 (92.7187%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2319, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4689/5035 (93.1281%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4661/5035 (92.5720%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0161, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4970/5427 (91.5791%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4770/5427 (87.8939%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1303, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4346/4672 (93.0223%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4328/4672 (92.6370%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8859, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4907/5361 (91.5314%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4824/5361 (89.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1213, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4143/4368 (94.8489%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4094/4368 (93.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9754, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4495/4843 (92.8144%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4456/4843 (92.0091%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9987, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4975/5353 (92.9385%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4795/5353 (89.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2114, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4442/4714 (94.2300%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4422/4714 (93.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8503, Accuracy: 5759/10000 (57.5900%)
time spent on training: 270.0867850780487
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2566, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0796, Accuracy: 9688/9900 (97.8586%)
Done in 308.8529314994812 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5190/5308 (97.7769%), train_poison_data_count: 415
Global model norm: 43.77520897606815.
Norm before scaling: 43.738010354892545. Distance: 1.2028668609727513
Total norm for 4 adversaries is: 43.738010354892545. distance: 1.2028668609727513
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0428, Accuracy: 9781/9900 (98.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.77520897606815.
Norm before scaling: 43.735480291499314. Distance: 1.2934341284631223
Total norm for 4 adversaries is: 43.735480291499314. distance: 1.2934341284631223
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0843, Accuracy: 9693/9900 (97.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 43.77520897606815.
Norm before scaling: 43.74143610378922. Distance: 1.2689547594331474
Total norm for 4 adversaries is: 43.74143610378922. distance: 1.2689547594331474
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1497, Accuracy: 9490/9900 (95.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5348/5503 (97.1834%), train_poison_data_count: 430
Global model norm: 43.77520897606815.
Norm before scaling: 43.740370033907176. Distance: 1.340916551663255
Total norm for 4 adversaries is: 43.740370033907176. distance: 1.340916551663255
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0322, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4278/4549 (94.0426%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3972/4549 (87.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1928, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5095/5652 (90.1451%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4971/5652 (87.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.4461, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3550/3774 (94.0647%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3575/3774 (94.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7880, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5225/5727 (91.2345%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5073/5727 (88.5804%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2849, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5573/6068 (91.8425%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5506/6068 (90.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1486, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6270/6947 (90.2548%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6079/6947 (87.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1705, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6341/6812 (93.0857%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6174/6812 (90.6342%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2791, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4458/4903 (90.9239%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4478/4903 (91.3318%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2228, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5479/5871 (93.3231%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5380/5871 (91.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0614, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4937/5427 (90.9711%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4905/5427 (90.3814%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1867, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3838/4108 (93.4275%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3843/4108 (93.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9535, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5921/6664 (88.8505%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0083, Accuracy: 5584/6664 (83.7935%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0786, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4633/4979 (93.0508%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4602/4979 (92.4282%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1831, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4880/5399 (90.3871%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4725/5399 (87.5162%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2507, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4459/4894 (91.1116%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4315/4894 (88.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2725, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3701/3968 (93.2712%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3706/3968 (93.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8709, Accuracy: 5712/10000 (57.1200%)
time spent on training: 282.0770342350006
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2590, Accuracy: 6787/10000 (67.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0857, Accuracy: 9670/9900 (97.6768%)
Done in 315.4866807460785 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.7977404146571.
Norm before scaling: 43.76168370775398. Distance: 1.2645228732307803
Total norm for 4 adversaries is: 43.76168370775398. distance: 1.2645228732307803
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0389, Accuracy: 9789/9900 (98.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5629/5777 (97.4381%), train_poison_data_count: 455
Global model norm: 43.7977404146571.
Norm before scaling: 43.75861801280549. Distance: 1.3215110349883608
Total norm for 4 adversaries is: 43.75861801280549. distance: 1.3215110349883608
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0408, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4941/5123 (96.4474%), train_poison_data_count: 403
Global model norm: 43.7977404146571.
Norm before scaling: 43.76607545064513. Distance: 1.329913741161224
Total norm for 4 adversaries is: 43.76607545064513. distance: 1.329913741161224
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.2034, Accuracy: 9398/9900 (94.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5342/5503 (97.0743%), train_poison_data_count: 430
Global model norm: 43.7977404146571.
Norm before scaling: 43.765456254137376. Distance: 1.3730448347052098
Total norm for 4 adversaries is: 43.765456254137376. distance: 1.3730448347052098
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0124, Accuracy: 9869/9900 (99.6869%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6330/6812 (92.9243%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6233/6812 (91.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2311, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5161/5652 (91.3128%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5108/5652 (90.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1608, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4601/4956 (92.8370%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4551/4956 (91.8281%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0588, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5511/5939 (92.7934%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5439/5939 (91.5811%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9373, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4822/5399 (89.3128%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4722/5399 (87.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1055, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6267/6947 (90.2116%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6094/6947 (87.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2048, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4399/4741 (92.7863%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4212/4741 (88.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4485, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3859/4108 (93.9387%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3784/4108 (92.1130%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0193, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3531/3774 (93.5612%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3582/3774 (94.9126%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8095, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4538/4889 (92.8206%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4491/4889 (91.8593%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3096, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4363/4605 (94.7448%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4315/4605 (93.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9816, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4677/5038 (92.8345%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4648/5038 (92.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9777, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4642/5122 (90.6287%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4336/5122 (84.6544%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4110, Accuracy: 4744/10000 (47.4400%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4977/5298 (93.9411%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4941/5298 (93.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0187, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5045/5461 (92.3823%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5014/5461 (91.8147%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3598, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4508/4830 (93.3333%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4490/4830 (92.9607%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1691, Accuracy: 5349/10000 (53.4900%)
time spent on training: 278.29969549179077
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2686, Accuracy: 6759/10000 (67.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0781, Accuracy: 9694/9900 (97.9192%)
Done in 312.83392786979675 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 43.817918820565005.
Norm before scaling: 43.7846584259437. Distance: 1.3132531412124464
Total norm for 4 adversaries is: 43.7846584259437. distance: 1.3132531412124464
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0427, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5628/5777 (97.4208%), train_poison_data_count: 455
Global model norm: 43.817918820565005.
Norm before scaling: 43.77958123827177. Distance: 1.335095458100392
Total norm for 4 adversaries is: 43.77958123827177. distance: 1.335095458100392
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0411, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4949/5123 (96.6036%), train_poison_data_count: 403
Global model norm: 43.817918820565005.
Norm before scaling: 43.78469606352201. Distance: 1.3022856847568414
Total norm for 4 adversaries is: 43.78469606352201. distance: 1.3022856847568414
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1903, Accuracy: 9449/9900 (95.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5349/5503 (97.2015%), train_poison_data_count: 430
Global model norm: 43.817918820565005.
Norm before scaling: 43.78372444604487. Distance: 1.3262912432471468
Total norm for 4 adversaries is: 43.78372444604487. distance: 1.3262912432471468
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0450, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5364/6080 (88.2237%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5311/6080 (87.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2086, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5002/5559 (89.9802%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4851/5559 (87.2639%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1282, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5465/5871 (93.0847%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5398/5871 (91.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1825, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3982/4249 (93.7162%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3930/4249 (92.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0639, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3646/3995 (91.2641%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3593/3995 (89.9374%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1740, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5019/5454 (92.0242%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4827/5454 (88.5039%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1863, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3898/4161 (93.6794%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3853/4161 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9910, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4501/4732 (95.1183%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4471/4732 (94.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8106, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4416/4851 (91.0328%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4426/4851 (91.2389%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0144, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4654/5122 (90.8629%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4086/5122 (79.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.5438, Accuracy: 4711/10000 (47.1100%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5485/5939 (92.3556%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5458/5939 (91.9010%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0915, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4415/4672 (94.4991%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4360/4672 (93.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8947, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 6390/6812 (93.8050%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6293/6812 (92.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1728, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5069/5461 (92.8218%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5017/5461 (91.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2828, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4482/4894 (91.5815%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4346/4894 (88.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1617, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3861/4175 (92.4790%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3810/4175 (91.2575%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0572, Accuracy: 5385/10000 (53.8500%)
time spent on training: 258.2485113143921
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2758, Accuracy: 6745/10000 (67.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0782, Accuracy: 9692/9900 (97.8990%)
Done in 294.0791747570038 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5193/5308 (97.8335%), train_poison_data_count: 415
Global model norm: 43.83851536819535.
Norm before scaling: 43.800276636094864. Distance: 1.1907447854808269
Total norm for 4 adversaries is: 43.800276636094864. distance: 1.1907447854808269
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0578, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5646/5777 (97.7324%), train_poison_data_count: 455
Global model norm: 43.83851536819535.
Norm before scaling: 43.79877582389575. Distance: 1.3003766229574103
Total norm for 4 adversaries is: 43.79877582389575. distance: 1.3003766229574103
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0716, Accuracy: 9718/9900 (98.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4954/5123 (96.7012%), train_poison_data_count: 403
Global model norm: 43.83851536819535.
Norm before scaling: 43.806043902889414. Distance: 1.3217355857540802
Total norm for 4 adversaries is: 43.806043902889414. distance: 1.3217355857540802
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0503, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5342/5503 (97.0743%), train_poison_data_count: 430
Global model norm: 43.83851536819535.
Norm before scaling: 43.80535003177409. Distance: 1.3534927696511214
Total norm for 4 adversaries is: 43.80535003177409. distance: 1.3534927696511214
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0759, Accuracy: 9713/9900 (98.1111%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4773/5224 (91.3668%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4681/5224 (89.6057%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1799, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4379/4797 (91.2862%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4325/4797 (90.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1075, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5011/5298 (94.5829%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4974/5298 (93.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8750, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3671/3910 (93.8875%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3439/3910 (87.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1945, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4222/4587 (92.0427%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4213/4587 (91.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0499, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4414/4731 (93.2995%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4400/4731 (93.0036%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0605, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6424/6812 (94.3042%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6241/6812 (91.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0810, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5016/5702 (87.9691%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4798/5702 (84.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2091, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4564/4911 (92.9342%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4555/4911 (92.7510%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0760, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3817/4111 (92.8485%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3752/4111 (91.2673%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1048, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3854/4145 (92.9795%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3867/4145 (93.2931%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0525, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4200/4397 (95.5197%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4209/4397 (95.7244%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8186, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4577/4979 (91.9261%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4588/4979 (92.1470%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0609, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5014/5353 (93.6671%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4814/5353 (89.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1575, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4136/4368 (94.6886%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4103/4368 (93.9332%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9749, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5040/5346 (94.2761%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4939/5346 (92.3868%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1803, Accuracy: 5317/10000 (53.1700%)
time spent on training: 260.0220396518707
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2742, Accuracy: 6752/10000 (67.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0773, Accuracy: 9690/9900 (97.8788%)
Done in 296.42436027526855 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5197/5308 (97.9088%), train_poison_data_count: 415
Global model norm: 43.85741000229465.
Norm before scaling: 43.81949697828225. Distance: 1.1890903665132002
Total norm for 4 adversaries is: 43.81949697828225. distance: 1.1890903665132002
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1222, Accuracy: 9562/9900 (96.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.85741000229465.
Norm before scaling: 43.817213993903124. Distance: 1.3031344278483943
Total norm for 4 adversaries is: 43.817213993903124. distance: 1.3031344278483943
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0889, Accuracy: 9651/9900 (97.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4957/5123 (96.7597%), train_poison_data_count: 403
Global model norm: 43.85741000229465.
Norm before scaling: 43.82522829108395. Distance: 1.3205682630939017
Total norm for 4 adversaries is: 43.82522829108395. distance: 1.3205682630939017
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1445, Accuracy: 9540/9900 (96.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 43.85741000229465.
Norm before scaling: 43.82359741543005. Distance: 1.3548260135081394
Total norm for 4 adversaries is: 43.82359741543005. distance: 1.3548260135081394
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0673, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5019/5489 (91.4374%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4964/5489 (90.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1136, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4492/4748 (94.6083%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4418/4748 (93.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0912, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5109/5645 (90.5049%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4932/5645 (87.3694%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4231, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4568/5018 (91.0323%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4440/5018 (88.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1725, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3544/3774 (93.9057%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3536/3774 (93.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0649, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4541/4830 (94.0166%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4497/4830 (93.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1292, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4146/4485 (92.4415%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3761/4485 (83.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.5506, Accuracy: 4758/10000 (47.5800%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4328/4605 (93.9848%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4271/4605 (92.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9570, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5612/6068 (92.4852%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5502/6068 (90.6724%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2447, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6324/6947 (91.0321%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6100/6947 (87.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3758, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4923/5362 (91.8128%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4850/5362 (90.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0291, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4746/5224 (90.8499%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4696/5224 (89.8928%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1253, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4164/4368 (95.3297%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4091/4368 (93.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8907, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4003/4249 (94.2104%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3917/4249 (92.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9082, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4975/5454 (91.2175%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4856/5454 (89.0356%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1587, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5519/5939 (92.9281%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5449/5939 (91.7495%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9803, Accuracy: 5525/10000 (55.2500%)
time spent on training: 273.4742593765259
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2798, Accuracy: 6755/10000 (67.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0822, Accuracy: 9674/9900 (97.7172%)
Done in 307.11175656318665 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5169/5308 (97.3813%), train_poison_data_count: 415
Global model norm: 43.87797410236855.
Norm before scaling: 43.84558475758278. Distance: 1.3167888866307862
Total norm for 4 adversaries is: 43.84558475758278. distance: 1.3167888866307862
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0525, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 43.87797410236855.
Norm before scaling: 43.83757000502323. Distance: 1.3200310401445832
Total norm for 4 adversaries is: 43.83757000502323. distance: 1.3200310401445832
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0215, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4978/5123 (97.1696%), train_poison_data_count: 403
Global model norm: 43.87797410236855.
Norm before scaling: 43.84323909404747. Distance: 1.2531676687077713
Total norm for 4 adversaries is: 43.84323909404747. distance: 1.2531676687077713
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0871, Accuracy: 9680/9900 (97.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 43.87797410236855.
Norm before scaling: 43.84465485969327. Distance: 1.367355467151424
Total norm for 4 adversaries is: 43.84465485969327. distance: 1.367355467151424
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0470, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4165/4397 (94.7237%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4189/4397 (95.2695%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8065, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3577/3774 (94.7801%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3626/3774 (96.0784%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7900, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4451/4894 (90.9481%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4298/4894 (87.8218%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1916, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4850/5361 (90.4682%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4767/5361 (88.9200%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1929, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5041/5526 (91.2233%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4856/5526 (87.8755%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3056, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5016/5298 (94.6772%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4942/5298 (93.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2276, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4934/5353 (92.1726%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4765/5353 (89.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0395, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4405/4797 (91.8282%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4371/4797 (91.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1500, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5489/5871 (93.4934%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5360/5871 (91.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1732, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6356/6947 (91.4927%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6097/6947 (87.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1976, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4427/4757 (93.0629%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4401/4757 (92.5163%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9985, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5043/5559 (90.7178%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4926/5559 (88.6131%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3863, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4596/4956 (92.7361%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4526/4956 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3289, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4759/5193 (91.6426%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4514/5193 (86.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2717, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3978/4249 (93.6220%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3912/4249 (92.0687%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0210, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4849/5399 (89.8129%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4726/5399 (87.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0982, Accuracy: 5262/10000 (52.6200%)
time spent on training: 280.6688675880432
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2823, Accuracy: 6754/10000 (67.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0802, Accuracy: 9685/9900 (97.8283%)
Done in 317.02010774612427 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5182/5308 (97.6262%), train_poison_data_count: 415
Global model norm: 43.899175086124195.
Norm before scaling: 43.86370826028905. Distance: 1.2894014317534888
Total norm for 4 adversaries is: 43.86370826028905. distance: 1.2894014317534888
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0157, Accuracy: 9852/9900 (99.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 43.899175086124195.
Norm before scaling: 43.859589307456474. Distance: 1.3369418378888605
Total norm for 4 adversaries is: 43.859589307456474. distance: 1.3369418378888605
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0227, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4935/5123 (96.3303%), train_poison_data_count: 403
Global model norm: 43.899175086124195.
Norm before scaling: 43.86798265641754. Distance: 1.362929071882877
Total norm for 4 adversaries is: 43.86798265641754. distance: 1.362929071882877
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0471, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 43.899175086124195.
Norm before scaling: 43.864525047208566. Distance: 1.3501939846116717
Total norm for 4 adversaries is: 43.864525047208566. distance: 1.3501939846116717
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0348, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4020/4249 (94.6105%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3974/4249 (93.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9200, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3631/3959 (91.7151%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3632/3959 (91.7403%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9992, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4534/4843 (93.6197%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4471/4843 (92.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9654, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5306/5696 (93.1531%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5279/5696 (92.6791%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0403, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4695/5086 (92.3122%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4683/5086 (92.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9853, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5105/5645 (90.4340%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4833/5645 (85.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2465, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5125/5422 (94.5223%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5040/5422 (92.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8973, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4959/5362 (92.4841%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4801/5362 (89.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9815, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5474/6080 (90.0329%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5315/6080 (87.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3530, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4321/4736 (91.2373%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4283/4736 (90.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0418, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3861/4086 (94.4934%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3878/4086 (94.9094%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8179, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3707/3968 (93.4224%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3684/3968 (92.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8686, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4557/5050 (90.2376%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4519/5050 (89.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0853, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3331/3589 (92.8114%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3331/3589 (92.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9468, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5373/5907 (90.9599%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5419/5907 (91.7386%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1772, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4697/4993 (94.0717%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4661/4993 (93.3507%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0444, Accuracy: 5616/10000 (56.1600%)
time spent on training: 269.6553568840027
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2939, Accuracy: 6718/10000 (67.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0713, Accuracy: 9712/9900 (98.1010%)
Done in 305.38872170448303 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 69, 7, 17, 81, 55, 66, 54, 73, 78, 3, 79, 38, 84, 90, 5, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.91885245069522.
Norm before scaling: 43.88251554888846. Distance: 1.2136580393689829
Total norm for 4 adversaries is: 43.88251554888846. distance: 1.2136580393689829
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0512, Accuracy: 9768/9900 (98.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 43.91885245069522.
Norm before scaling: 43.87665678629341. Distance: 1.286253579508228
Total norm for 4 adversaries is: 43.87665678629341. distance: 1.286253579508228
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0267, Accuracy: 9836/9900 (99.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4964/5123 (96.8963%), train_poison_data_count: 403
Global model norm: 43.91885245069522.
Norm before scaling: 43.8826838446129. Distance: 1.2417861962016756
Total norm for 4 adversaries is: 43.8826838446129. distance: 1.2417861962016756
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1215, Accuracy: 9586/9900 (96.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5349/5503 (97.2015%), train_poison_data_count: 430
Global model norm: 43.91885245069522.
Norm before scaling: 43.885152571353075. Distance: 1.3714563917207812
Total norm for 4 adversaries is: 43.885152571353075. distance: 1.3714563917207812
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0280, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4018/4364 (92.0715%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3969/4364 (90.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9960, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4485/4869 (92.1134%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4176/4869 (85.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1979, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4473/4903 (91.2299%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4451/4903 (90.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1370, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4747/5035 (94.2800%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4715/5035 (93.6445%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9007, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4408/4731 (93.1727%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4401/4731 (93.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9555, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4525/4843 (93.4338%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4506/4843 (93.0415%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0618, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5129/5645 (90.8592%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4894/5645 (86.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2426, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4335/4605 (94.1368%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4357/4605 (94.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9255, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4135/4368 (94.6658%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4122/4368 (94.3681%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0720, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5028/5346 (94.0516%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4938/5346 (92.3681%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1935, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3877/4111 (94.3080%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3823/4111 (92.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9510, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5660/6235 (90.7779%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5571/6235 (89.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2854, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4762/5209 (91.4187%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4688/5209 (89.9981%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1589, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4420/4748 (93.0918%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4370/4748 (92.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0831, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4729/4993 (94.7126%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4666/4993 (93.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0595, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4573/4911 (93.1175%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4526/4911 (92.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1821, Accuracy: 5295/10000 (52.9500%)
time spent on training: 258.4199662208557
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2923, Accuracy: 6734/10000 (67.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0670, Accuracy: 9728/9900 (98.2626%)
Done in 293.4746594429016 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 96, 52, 20, 2, 65, 42, 1, 45, 48, 32, 68, 12, 39, 33, 4, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5174/5308 (97.4755%), train_poison_data_count: 415
Global model norm: 43.93727912684526.
Norm before scaling: 43.90089213305494. Distance: 1.2543936284330393
Total norm for 4 adversaries is: 43.90089213305494. distance: 1.2543936284330393
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0649, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 43.93727912684526.
Norm before scaling: 43.89713956859476. Distance: 1.337772024424979
Total norm for 4 adversaries is: 43.89713956859476. distance: 1.337772024424979
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0473, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4959/5123 (96.7988%), train_poison_data_count: 403
Global model norm: 43.93727912684526.
Norm before scaling: 43.90296918347323. Distance: 1.2817891079952206
Total norm for 4 adversaries is: 43.90296918347323. distance: 1.2817891079952206
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2235, Accuracy: 9305/9900 (93.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 43.93727912684526.
Norm before scaling: 43.90217952661918. Distance: 1.3399487334735618
Total norm for 4 adversaries is: 43.90217952661918. distance: 1.3399487334735618
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0499, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4664/5086 (91.7027%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4649/5086 (91.4078%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0547, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3888/4130 (94.1404%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3863/4130 (93.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0023, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4408/4714 (93.5087%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4419/4714 (93.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9294, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3680/3968 (92.7419%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3646/3968 (91.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0611, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5024/5497 (91.3953%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4920/5497 (89.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1283, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5464/5907 (92.5004%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5350/5907 (90.5705%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2054, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5135/5422 (94.7068%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5056/5422 (93.2497%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8996, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5047/5489 (91.9475%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4929/5489 (89.7978%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3070, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4543/4830 (94.0580%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4551/4830 (94.2236%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1125, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5377/6080 (88.4375%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5348/6080 (87.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3586, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3357/3589 (93.5358%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3082/3589 (85.8735%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2078, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5080/5526 (91.9291%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4947/5526 (89.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1441, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3851/4175 (92.2395%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3842/4175 (92.0240%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9590, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4466/4818 (92.6941%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4413/4818 (91.5940%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9418, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3745/4028 (92.9742%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3739/4028 (92.8252%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8497, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5399 (89.8315%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4691/5399 (86.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3958, Accuracy: 4906/10000 (49.0600%)
time spent on training: 281.4752781391144
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2871, Accuracy: 6727/10000 (67.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0693, Accuracy: 9720/9900 (98.1818%)
Done in 314.88440203666687 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 27, 65, 15, 35, 94, 34, 49, 50, 42, 4, 93, 68, 90, 96, 92, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 43.95688944730749.
Norm before scaling: 43.91928048411298. Distance: 1.217331133730455
Total norm for 4 adversaries is: 43.91928048411298. distance: 1.217331133730455
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0220, Accuracy: 9841/9900 (99.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5633/5777 (97.5074%), train_poison_data_count: 455
Global model norm: 43.95688944730749.
Norm before scaling: 43.91683313288738. Distance: 1.3190122894946625
Total norm for 4 adversaries is: 43.91683313288738. distance: 1.3190122894946625
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0388, Accuracy: 9793/9900 (98.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4957/5123 (96.7597%), train_poison_data_count: 403
Global model norm: 43.95688944730749.
Norm before scaling: 43.922869963828354. Distance: 1.304734691748616
Total norm for 4 adversaries is: 43.922869963828354. distance: 1.304734691748616
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1187, Accuracy: 9601/9900 (96.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 43.95688944730749.
Norm before scaling: 43.91849667948503. Distance: 1.250966318462277
Total norm for 4 adversaries is: 43.91849667948503. distance: 1.250966318462277
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0270, Accuracy: 9834/9900 (99.3333%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4263/4587 (92.9366%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4205/4587 (91.6721%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0599, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5002/5497 (90.9951%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4984/5497 (90.6676%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0860, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5577/6068 (91.9084%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5494/6068 (90.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3077, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5244/5615 (93.3927%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5175/5615 (92.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4757, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4726/5224 (90.4671%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4715/5224 (90.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2695, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4557/4911 (92.7917%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4523/4911 (92.0994%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1302, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5143/5652 (90.9943%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5075/5652 (89.7912%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2507, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4442/4757 (93.3782%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4347/4757 (91.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1733, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5421/5907 (91.7725%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5328/5907 (90.1981%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4617, Accuracy: 4801/10000 (48.0100%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3711/4028 (92.1301%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3717/4028 (92.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9483, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4654/5055 (92.0673%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4550/5055 (90.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2152, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3359/3589 (93.5915%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3329/3589 (92.7556%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9556, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4482/4748 (94.3976%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4319/4748 (90.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0062, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4708/5086 (92.5678%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4673/5086 (91.8797%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0635, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6373/6812 (93.5555%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6256/6812 (91.8379%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1504, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4099/4364 (93.9276%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3997/4364 (91.5903%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0620, Accuracy: 5526/10000 (55.2600%)
time spent on training: 274.47647285461426
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2775, Accuracy: 6737/10000 (67.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0689, Accuracy: 9723/9900 (98.2121%)
Done in 308.5697841644287 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 0, 83, 23, 90, 88, 51, 9, 6, 70, 7, 75, 87, 85, 89, 84, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.9769379258713.
Norm before scaling: 43.93948641935719. Distance: 1.2368052256576172
Total norm for 4 adversaries is: 43.93948641935719. distance: 1.2368052256576172
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0778, Accuracy: 9694/9900 (97.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5617/5777 (97.2304%), train_poison_data_count: 455
Global model norm: 43.9769379258713.
Norm before scaling: 43.936841544674955. Distance: 1.3580783052663674
Total norm for 4 adversaries is: 43.936841544674955. distance: 1.3580783052663674
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0926, Accuracy: 9664/9900 (97.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4964/5123 (96.8963%), train_poison_data_count: 403
Global model norm: 43.9769379258713.
Norm before scaling: 43.94239087510274. Distance: 1.2845289096363177
Total norm for 4 adversaries is: 43.94239087510274. distance: 1.2845289096363177
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0510, Accuracy: 9758/9900 (98.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5366/5503 (97.5104%), train_poison_data_count: 430
Global model norm: 43.9769379258713.
Norm before scaling: 43.94124217260904. Distance: 1.3165833215450118
Total norm for 4 adversaries is: 43.94124217260904. distance: 1.3165833215450118
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0418, Accuracy: 9797/9900 (98.9596%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4976/5454 (91.2358%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4809/5454 (88.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2738, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3277/3552 (92.2579%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3277/3552 (92.2579%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0548, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4252/4549 (93.4711%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4067/4549 (89.4043%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9135, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4513/4748 (95.0505%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4411/4748 (92.9023%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0461, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4951/5362 (92.3349%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4812/5362 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0629, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3796/4108 (92.4051%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3795/4108 (92.3807%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0154, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5244/5727 (91.5663%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5018/5727 (87.6200%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2427, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4570/4929 (92.7166%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4503/4929 (91.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1793, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5498/5871 (93.6467%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5408/5871 (92.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1930, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4488/4869 (92.1750%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3928/4869 (80.6736%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.5895, Accuracy: 4520/10000 (45.2000%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4377/4672 (93.6858%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4341/4672 (92.9152%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0308, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3601/3995 (90.1377%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3599/3995 (90.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1107, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6302/6947 (90.7154%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 6018/6947 (86.6273%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.4559, Accuracy: 4825/10000 (48.2500%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4356/4737 (91.9569%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4238/4737 (89.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2355, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4768/5209 (91.5339%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4654/5209 (89.3454%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2755, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3746/3968 (94.4052%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3736/3968 (94.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8278, Accuracy: 5808/10000 (58.0800%)
time spent on training: 266.2770924568176
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2898, Accuracy: 6720/10000 (67.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0680, Accuracy: 9722/9900 (98.2020%)
Done in 301.69550013542175 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 27, 69, 59, 16, 44, 4, 1, 35, 8, 7, 23, 66, 88, 42, 52, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5177/5308 (97.5320%), train_poison_data_count: 415
Global model norm: 43.99677750317701.
Norm before scaling: 43.95943870179148. Distance: 1.2478884027726742
Total norm for 4 adversaries is: 43.95943870179148. distance: 1.2478884027726742
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0273, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 43.99677750317701.
Norm before scaling: 43.95514820485693. Distance: 1.3078378344489525
Total norm for 4 adversaries is: 43.95514820485693. distance: 1.3078378344489525
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0443, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4981/5123 (97.2282%), train_poison_data_count: 403
Global model norm: 43.99677750317701.
Norm before scaling: 43.96279166273737. Distance: 1.26457632440995
Total norm for 4 adversaries is: 43.96279166273737. distance: 1.26457632440995
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1476, Accuracy: 9535/9900 (96.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 43.99677750317701.
Norm before scaling: 43.96172957234722. Distance: 1.3415244546396612
Total norm for 4 adversaries is: 43.96172957234722. distance: 1.3415244546396612
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0449, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4198/4587 (91.5195%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4157/4587 (90.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2077, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4061/4364 (93.0568%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4023/4364 (92.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9603, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4181/4397 (95.0876%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4208/4397 (95.7016%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7769, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4936/5353 (92.2100%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4769/5353 (89.0902%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2588, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4760/5075 (93.7931%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4642/5075 (91.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0391, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3748/4028 (93.0487%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3748/4028 (93.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9451, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5146/5422 (94.9096%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5029/5422 (92.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1005, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5223/5615 (93.0187%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5147/5615 (91.6652%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2596, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4544/4889 (92.9433%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4458/4889 (91.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0578, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4461/4869 (91.6205%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4183/4869 (85.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3379, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4288/4549 (94.2625%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3890/4549 (85.5133%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.5206, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4513/4843 (93.1860%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4495/4843 (92.8144%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9373, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4926/5362 (91.8687%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4862/5362 (90.6751%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1291, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5492/5907 (92.9744%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5371/5907 (90.9260%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3703, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3883/4130 (94.0194%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3828/4130 (92.6877%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8811, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5039/5454 (92.3909%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4886/5454 (89.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0762, Accuracy: 5536/10000 (55.3600%)
time spent on training: 261.35981369018555
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2887, Accuracy: 6707/10000 (67.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0682, Accuracy: 9722/9900 (98.2020%)
Done in 296.3058364391327 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 54, 63, 3, 38, 67, 73, 20, 32, 49, 0, 75, 56, 10, 2, 42, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5183/5308 (97.6451%), train_poison_data_count: 415
Global model norm: 44.016405688408526.
Norm before scaling: 43.98024791916537. Distance: 1.2603020523966255
Total norm for 4 adversaries is: 43.98024791916537. distance: 1.2603020523966255
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0164, Accuracy: 9855/9900 (99.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5648/5777 (97.7670%), train_poison_data_count: 455
Global model norm: 44.016405688408526.
Norm before scaling: 43.97401076825805. Distance: 1.282623113482294
Total norm for 4 adversaries is: 43.97401076825805. distance: 1.282623113482294
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0441, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4959/5123 (96.7988%), train_poison_data_count: 403
Global model norm: 44.016405688408526.
Norm before scaling: 43.982597377489114. Distance: 1.3180246337909798
Total norm for 4 adversaries is: 43.982597377489114. distance: 1.3180246337909798
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1307, Accuracy: 9563/9900 (96.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5373/5503 (97.6377%), train_poison_data_count: 430
Global model norm: 44.016405688408526.
Norm before scaling: 43.979658106315895. Distance: 1.2938391300035366
Total norm for 4 adversaries is: 43.979658106315895. distance: 1.2938391300035366
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0613, Accuracy: 9752/9900 (98.5051%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5117/5645 (90.6466%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4857/5645 (86.0407%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2533, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3676/3910 (94.0153%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3455/3910 (88.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4354, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5090/5346 (95.2114%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5038/5346 (94.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0456, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5606/6235 (89.9118%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5432/6235 (87.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3672, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5054/5559 (90.9156%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4941/5559 (88.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1329, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4351/4605 (94.4843%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4302/4605 (93.4202%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1181, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4476/4714 (94.9512%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4489/4714 (95.2270%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9172, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5460/6080 (89.8026%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5248/6080 (86.3158%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2850, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5166/5652 (91.4013%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4949/5652 (87.5619%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3712, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5041/5454 (92.4276%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4734/5454 (86.7987%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1757, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4390/4672 (93.9640%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4405/4672 (94.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0038, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4933/5427 (90.8974%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4853/5427 (89.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2646, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4747/5068 (93.6661%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4659/5068 (91.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2814, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3727/3968 (93.9264%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3711/3968 (93.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8749, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5414/5907 (91.6540%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5369/5907 (90.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4083, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4482/4851 (92.3933%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4448/4851 (91.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1846, Accuracy: 5351/10000 (53.5100%)
time spent on training: 275.9569230079651
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2942, Accuracy: 6702/10000 (67.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0596, Accuracy: 9751/9900 (98.4949%)
Done in 309.2155225276947 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 92, 39, 50, 63, 32, 3, 4, 22, 47, 68, 64, 51, 16, 62, 87, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5193/5308 (97.8335%), train_poison_data_count: 415
Global model norm: 44.037810292424425.
Norm before scaling: 43.99713402864299. Distance: 1.1740222840151961
Total norm for 4 adversaries is: 43.99713402864299. distance: 1.1740222840151961
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0739, Accuracy: 9712/9900 (98.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5652/5777 (97.8362%), train_poison_data_count: 455
Global model norm: 44.037810292424425.
Norm before scaling: 43.99414855889218. Distance: 1.2562246310581013
Total norm for 4 adversaries is: 43.99414855889218. distance: 1.2562246310581013
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0397, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4975/5123 (97.1111%), train_poison_data_count: 403
Global model norm: 44.037810292424425.
Norm before scaling: 44.00133443022637. Distance: 1.2173287345225559
Total norm for 4 adversaries is: 44.00133443022637. distance: 1.2173287345225559
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0496, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 44.037810292424425.
Norm before scaling: 44.002865784692084. Distance: 1.3480814387428874
Total norm for 4 adversaries is: 44.002865784692084. distance: 1.3480814387428874
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1200, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6431/6812 (94.4069%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0033, Accuracy: 6379/6812 (93.6436%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1870, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3881/4175 (92.9581%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3717/4175 (89.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1327, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4452/4757 (93.5884%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4391/4757 (92.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0212, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3696/3910 (94.5269%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3408/3910 (87.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1347, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5465/6080 (89.8849%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5372/6080 (88.3553%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1815, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5014/5346 (93.7897%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4967/5346 (92.9106%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2137, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3766/4028 (93.4955%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3714/4028 (92.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0017, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5342/5696 (93.7851%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5234/5696 (91.8890%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9259, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4695/5123 (91.6455%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   2,  Average loss: 0.0103, Accuracy: 4150/5123 (81.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2928, Accuracy: 4915/10000 (49.1500%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3370/3589 (93.8980%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3182/3589 (88.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9915, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4504/4894 (92.0311%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4334/4894 (88.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1988, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3864/4108 (94.0604%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3778/4108 (91.9669%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0340, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4998/5353 (93.3682%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4879/5353 (91.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0758, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4904/5504 (89.0988%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4928/5504 (89.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3100, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3650/3995 (91.3642%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3574/3995 (89.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1793, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5186/5615 (92.3598%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5157/5615 (91.8433%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1130, Accuracy: 5422/10000 (54.2200%)
time spent on training: 278.0473544597626
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.3011, Accuracy: 6688/10000 (66.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0590, Accuracy: 9752/9900 (98.5051%)
Done in 315.71308612823486 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 34, 96, 45, 52, 66, 63, 32, 29, 57, 44, 77, 79, 94, 64, 51, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5174/5308 (97.4755%), train_poison_data_count: 415
Global model norm: 44.058085162249874.
Norm before scaling: 44.02155122955403. Distance: 1.261916201232033
Total norm for 4 adversaries is: 44.02155122955403. distance: 1.261916201232033
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0479, Accuracy: 9780/9900 (98.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5632/5777 (97.4900%), train_poison_data_count: 455
Global model norm: 44.058085162249874.
Norm before scaling: 44.01565134672623. Distance: 1.3116544088609248
Total norm for 4 adversaries is: 44.01565134672623. distance: 1.3116544088609248
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0862, Accuracy: 9672/9900 (97.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4986/5123 (97.3258%), train_poison_data_count: 403
Global model norm: 44.058085162249874.
Norm before scaling: 44.021387624192116. Distance: 1.2245205446967644
Total norm for 4 adversaries is: 44.021387624192116. distance: 1.2245205446967644
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0822, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 44.058085162249874.
Norm before scaling: 44.02001359245232. Distance: 1.3025019265305224
Total norm for 4 adversaries is: 44.02001359245232. distance: 1.3025019265305224
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0502, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4612/4911 (93.9116%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4552/4911 (92.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0453, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4748/5086 (93.3543%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4736/5086 (93.1184%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0104, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4993/5489 (90.9637%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4975/5489 (90.6358%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1196, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3876/4130 (93.8499%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3843/4130 (93.0508%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9889, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4501/4843 (92.9383%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4458/4843 (92.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0865, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3664/3910 (93.7084%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3547/3910 (90.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3241, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5516/6080 (90.7237%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5297/6080 (87.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2478, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4477/4732 (94.6112%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4451/4732 (94.0617%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9091, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4616/4956 (93.1396%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4508/4956 (90.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1866, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4739/5075 (93.3793%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4580/5075 (90.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1286, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4592/5050 (90.9307%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4480/5050 (88.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2041, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3855/4111 (93.7728%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3803/4111 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0746, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4773/5224 (91.3668%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4705/5224 (90.0651%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0057, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4548/4894 (92.9301%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4413/4894 (90.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1535, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3858/4108 (93.9143%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3832/4108 (93.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9923, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5939/6664 (89.1206%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5684/6664 (85.2941%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3174, Accuracy: 4853/10000 (48.5300%)
time spent on training: 262.53740072250366
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3058, Accuracy: 6682/10000 (66.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0575, Accuracy: 9752/9900 (98.5051%)
Done in 301.74270391464233 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 69, 1, 68, 16, 44, 2, 45, 27, 14, 83, 87, 12, 50, 43, 37, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 44.07712384763425.
Norm before scaling: 44.04011510295188. Distance: 1.2685534188702519
Total norm for 4 adversaries is: 44.04011510295188. distance: 1.2685534188702519
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0933, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5631/5777 (97.4727%), train_poison_data_count: 455
Global model norm: 44.07712384763425.
Norm before scaling: 44.03481787798009. Distance: 1.3150806487847913
Total norm for 4 adversaries is: 44.03481787798009. distance: 1.3150806487847913
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0491, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4968/5123 (96.9744%), train_poison_data_count: 403
Global model norm: 44.07712384763425.
Norm before scaling: 44.04358802918281. Distance: 1.311329864964426
Total norm for 4 adversaries is: 44.04358802918281. distance: 1.311329864964426
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1649, Accuracy: 9471/9900 (95.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 44.07712384763425.
Norm before scaling: 44.04035902051946. Distance: 1.3276932856191224
Total norm for 4 adversaries is: 44.04035902051946. distance: 1.3276932856191224
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0201, Accuracy: 9858/9900 (99.5758%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4093/4364 (93.7901%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4023/4364 (92.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0003, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5093/5422 (93.9321%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5047/5422 (93.0837%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9234, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3357/3589 (93.5358%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3129/3589 (87.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2657, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5353 (92.2473%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4829/5353 (90.2111%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2923, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4747/5075 (93.5369%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4642/5075 (91.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0498, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3693/3968 (93.0696%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3665/3968 (92.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9594, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5090/5489 (92.7309%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4977/5489 (90.6723%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1404, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4242/4587 (92.4787%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4169/4587 (90.8873%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0296, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3998/4196 (95.2812%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4021/4196 (95.8294%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9376, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3278/3552 (92.2860%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3296/3552 (92.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8821, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3619/3995 (90.5882%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3557/3995 (89.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2752, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5076/5526 (91.8567%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4933/5526 (89.2689%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4684, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4431/4757 (93.1469%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4428/4757 (93.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0019, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4596/4979 (92.3077%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4560/4979 (91.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1949, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4397/4741 (92.7441%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4276/4741 (90.1919%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1648, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4754/5193 (91.5463%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4581/5193 (88.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4832, Accuracy: 4927/10000 (49.2700%)
time spent on training: 260.0025563240051
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3063, Accuracy: 6680/10000 (66.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0593, Accuracy: 9748/9900 (98.4646%)
Done in 294.7545816898346 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 63, 26, 6, 29, 91, 4, 39, 1, 80, 62, 89, 20, 33, 74, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5218/5308 (98.3044%), train_poison_data_count: 415
Global model norm: 44.09625812320984.
Norm before scaling: 44.05673582642826. Distance: 1.1891897125969375
Total norm for 4 adversaries is: 44.05673582642826. distance: 1.1891897125969375
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0305, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 44.09625812320984.
Norm before scaling: 44.0527319070743. Distance: 1.2842039156756777
Total norm for 4 adversaries is: 44.0527319070743. distance: 1.2842039156756777
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0487, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 44.09625812320984.
Norm before scaling: 44.0598555833248. Distance: 1.2569314939605694
Total norm for 4 adversaries is: 44.0598555833248. distance: 1.2569314939605694
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1930, Accuracy: 9383/9900 (94.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 44.09625812320984.
Norm before scaling: 44.059940085212325. Distance: 1.3389076989164157
Total norm for 4 adversaries is: 44.059940085212325. distance: 1.3389076989164157
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0553, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3670/3910 (93.8619%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3551/3910 (90.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1717, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3856/4086 (94.3710%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3874/4086 (94.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0821, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4635/4929 (94.0353%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4507/4929 (91.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1198, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4477/4732 (94.6112%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4478/4732 (94.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8431, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4155/4527 (91.7826%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4016/4527 (88.7122%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1202, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3780/4028 (93.8431%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3740/4028 (92.8500%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0213, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3883/4175 (93.0060%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3850/4175 (92.2156%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9479, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5174/5422 (95.4260%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5098/5422 (94.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9882, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5059/5461 (92.6387%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4981/5461 (91.2104%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2663, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4926/5504 (89.4985%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4850/5504 (88.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0063, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4392/4737 (92.7169%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4324/4737 (91.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2881, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4425/4714 (93.8693%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4414/4714 (93.6360%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9118, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4469/4818 (92.7563%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4315/4818 (89.5600%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9891, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4422/4797 (92.1826%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4332/4797 (90.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1559, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4669/5055 (92.3640%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4583/5055 (90.6627%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1996, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5083/5497 (92.4686%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4956/5497 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2073, Accuracy: 5289/10000 (52.8900%)
time spent on training: 264.5286912918091
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3031, Accuracy: 6681/10000 (66.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0610, Accuracy: 9744/9900 (98.4242%)
Done in 304.2708098888397 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 4, 98, 5, 17, 65, 46, 15, 48, 68, 94, 2, 93, 43, 10, 26, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.11470339539939.
Norm before scaling: 44.07441522185447. Distance: 1.1614170608828218
Total norm for 4 adversaries is: 44.07441522185447. distance: 1.1614170608828218
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0876, Accuracy: 9671/9900 (97.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5660/5777 (97.9747%), train_poison_data_count: 455
Global model norm: 44.11470339539939.
Norm before scaling: 44.06945451544712. Distance: 1.211080333530574
Total norm for 4 adversaries is: 44.06945451544712. distance: 1.211080333530574
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0802, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4968/5123 (96.9744%), train_poison_data_count: 403
Global model norm: 44.11470339539939.
Norm before scaling: 44.081172628157674. Distance: 1.3187550494924478
Total norm for 4 adversaries is: 44.081172628157674. distance: 1.3187550494924478
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0307, Accuracy: 9813/9900 (99.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.11470339539939.
Norm before scaling: 44.075675390546344. Distance: 1.2235973989320004
Total norm for 4 adversaries is: 44.075675390546344. distance: 1.2235973989320004
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0368, Accuracy: 9803/9900 (99.0202%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3752/4028 (93.1480%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3762/4028 (93.3962%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8414, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3939/4161 (94.6647%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3847/4161 (92.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9063, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4724/4993 (94.6125%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4578/4993 (91.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2965, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4446/4903 (90.6792%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4333/4903 (88.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4129, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5083/5497 (92.4686%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4918/5497 (89.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2422, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4878/5399 (90.3501%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4722/5399 (87.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3214, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5638/6068 (92.9136%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5467/6068 (90.0956%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3561, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4573/4830 (94.6791%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4516/4830 (93.4990%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1512, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3377/3589 (94.0931%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3246/3589 (90.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4566, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4797/5224 (91.8262%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4735/5224 (90.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1121, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3685/3968 (92.8679%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3675/3968 (92.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.7942, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4674/5055 (92.4629%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4605/5055 (91.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1966, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4598/4979 (92.3479%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4563/4979 (91.6449%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0609, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4782/5068 (94.3567%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4678/5068 (92.3047%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2249, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3861/4086 (94.4934%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3857/4086 (94.3955%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9247, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4966/5362 (92.6147%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4851/5362 (90.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1479, Accuracy: 5275/10000 (52.7500%)
time spent on training: 275.8569869995117
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3016, Accuracy: 6691/10000 (66.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0648, Accuracy: 9729/9900 (98.2727%)
Done in 311.140762090683 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 7, 81, 4, 44, 5, 99, 83, 55, 94, 14, 32, 74, 20, 49, 23, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5208/5308 (98.1161%), train_poison_data_count: 415
Global model norm: 44.13363882767741.
Norm before scaling: 44.09223979740157. Distance: 1.165991957023323
Total norm for 4 adversaries is: 44.09223979740157. distance: 1.165991957023323
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0887, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 44.13363882767741.
Norm before scaling: 44.090076144787105. Distance: 1.278984299540248
Total norm for 4 adversaries is: 44.090076144787105. distance: 1.278984299540248
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0555, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.13363882767741.
Norm before scaling: 44.097065066293666. Distance: 1.2673483053922
Total norm for 4 adversaries is: 44.097065066293666. distance: 1.2673483053922
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0474, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 44.13363882767741.
Norm before scaling: 44.09248896362976. Distance: 1.2187157650565263
Total norm for 4 adversaries is: 44.09248896362976. distance: 1.2187157650565263
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0885, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4476/4869 (91.9285%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4293/4869 (88.1701%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3341, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4764/5035 (94.6177%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4685/5035 (93.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9081, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3792/4028 (94.1410%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3747/4028 (93.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8905, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4778/5075 (94.1478%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4630/5075 (91.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0997, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4749/4993 (95.1132%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4642/4993 (92.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0365, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4480/4851 (92.3521%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4470/4851 (92.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9677, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3304/3552 (93.0180%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3329/3552 (93.7218%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7666, Accuracy: 5992/10000 (59.9200%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4422/4731 (93.4686%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4373/4731 (92.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9799, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4802/5224 (91.9219%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4711/5224 (90.1799%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1209, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4009/4196 (95.5434%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3981/4196 (94.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7839, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5529/6080 (90.9375%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5351/6080 (88.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.4445, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4413/4797 (91.9950%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4342/4797 (90.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0305, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4435/4714 (94.0815%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4418/4714 (93.7208%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0202, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5157/5652 (91.2420%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4980/5652 (88.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3269, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4303/4549 (94.5922%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4073/4549 (89.5362%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2352, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4965/5504 (90.2071%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4795/5504 (87.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.4463, Accuracy: 4851/10000 (48.5100%)
time spent on training: 262.45285964012146
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3140, Accuracy: 6686/10000 (66.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0610, Accuracy: 9742/9900 (98.4040%)
Done in 300.004585981369 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 0, 97, 90, 3, 15, 93, 69, 88, 79, 65, 44, 84, 6, 78, 24, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 44.15211548451345.
Norm before scaling: 44.113816527180575. Distance: 1.2591726874193463
Total norm for 4 adversaries is: 44.113816527180575. distance: 1.2591726874193463
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0246, Accuracy: 9835/9900 (99.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 44.15211548451345.
Norm before scaling: 44.10853922339613. Distance: 1.272421730122535
Total norm for 4 adversaries is: 44.10853922339613. distance: 1.272421730122535
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0861, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.15211548451345.
Norm before scaling: 44.114775340245274. Distance: 1.260286019650297
Total norm for 4 adversaries is: 44.114775340245274. distance: 1.260286019650297
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2655, Accuracy: 9169/9900 (92.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.15211548451345.
Norm before scaling: 44.111317704296425. Distance: 1.2253055814174614
Total norm for 4 adversaries is: 44.111317704296425. distance: 1.2253055814174614
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0784, Accuracy: 9693/9900 (97.9091%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5061/5454 (92.7943%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4829/5454 (88.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1471, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4324/4736 (91.3007%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4261/4736 (89.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0339, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4535/4748 (95.5139%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4385/4748 (92.3547%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0048, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5051/5346 (94.4819%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4984/5346 (93.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1029, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5591/6068 (92.1391%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5509/6068 (90.7877%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1875, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4702/5055 (93.0168%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4610/5055 (91.1968%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0623, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4077/4364 (93.4235%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3944/4364 (90.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0852, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5033/5362 (93.8642%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4870/5362 (90.8243%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2131, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3852/4111 (93.6998%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3810/4111 (92.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1661, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5028/5497 (91.4681%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4957/5497 (90.1765%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0658, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4805/5075 (94.6798%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4696/5075 (92.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9977, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4805/5209 (92.2442%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4696/5209 (90.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2673, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4583/4929 (92.9803%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4515/4929 (91.6007%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0977, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4094/4368 (93.7271%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3939/4368 (90.1786%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2393, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4031/4313 (93.4616%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3965/4313 (91.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8396, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3792/4028 (94.1410%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3737/4028 (92.7756%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0011, Accuracy: 5675/10000 (56.7500%)
time spent on training: 255.1691439151764
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3176, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0645, Accuracy: 9729/9900 (98.2727%)
Done in 290.087322473526 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 38, 89, 81, 43, 21, 40, 78, 9, 14, 83, 85, 20, 65, 97, 3, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.171450796070616.
Norm before scaling: 44.131442628987614. Distance: 1.190067827711956
Total norm for 4 adversaries is: 44.131442628987614. distance: 1.190067827711956
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0626, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.171450796070616.
Norm before scaling: 44.12614945165381. Distance: 1.2423334095989587
Total norm for 4 adversaries is: 44.12614945165381. distance: 1.2423334095989587
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0343, Accuracy: 9808/9900 (99.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.171450796070616.
Norm before scaling: 44.13338851080112. Distance: 1.1934375393955636
Total norm for 4 adversaries is: 44.13338851080112. distance: 1.1934375393955636
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1208, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5359/5503 (97.3832%), train_poison_data_count: 430
Global model norm: 44.171450796070616.
Norm before scaling: 44.135631631281626. Distance: 1.3359069374559396
Total norm for 4 adversaries is: 44.135631631281626. distance: 1.3359069374559396
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0575, Accuracy: 9744/9900 (98.4242%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5635/6235 (90.3769%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5542/6235 (88.8853%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3936, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4378/4737 (92.4214%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4291/4737 (90.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2513, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4755/5035 (94.4389%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4718/5035 (93.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9502, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4612/4979 (92.6290%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4571/4979 (91.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1582, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4649/5038 (92.2787%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4587/5038 (91.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1746, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5517/5939 (92.8944%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5380/5939 (90.5876%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1842, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4152/4368 (95.0549%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4105/4368 (93.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1060, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5281/5727 (92.2123%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5030/5727 (87.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2528, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4029/4196 (96.0200%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3975/4196 (94.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8097, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3326/3552 (93.6374%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3320/3552 (93.4685%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8904, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6368/6947 (91.6655%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6079/6947 (87.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2302, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4453/4714 (94.4633%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4408/4714 (93.5087%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9244, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5055/5497 (91.9593%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4898/5497 (89.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1902, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4362/4736 (92.1030%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4293/4736 (90.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0629, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5093/5346 (95.2675%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5052/5346 (94.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9215, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4614/4956 (93.0993%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4514/4956 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1517, Accuracy: 5300/10000 (53.0000%)
time spent on training: 269.54537630081177
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3136, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0629, Accuracy: 9736/9900 (98.3434%)
Done in 302.95767974853516 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 79, 41, 44, 27, 24, 6, 29, 62, 19, 17, 51, 10, 22, 55, 2, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5195/5308 (97.8711%), train_poison_data_count: 415
Global model norm: 44.189977940598986.
Norm before scaling: 44.151133981313976. Distance: 1.229979887231899
Total norm for 4 adversaries is: 44.151133981313976. distance: 1.229979887231899
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0608, Accuracy: 9742/9900 (98.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5637/5777 (97.5766%), train_poison_data_count: 455
Global model norm: 44.189977940598986.
Norm before scaling: 44.14645979135105. Distance: 1.26842885204524
Total norm for 4 adversaries is: 44.14645979135105. distance: 1.26842885204524
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1009, Accuracy: 9634/9900 (97.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 44.189977940598986.
Norm before scaling: 44.15309558354176. Distance: 1.2755284840967156
Total norm for 4 adversaries is: 44.15309558354176. distance: 1.2755284840967156
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0399, Accuracy: 9798/9900 (98.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.189977940598986.
Norm before scaling: 44.14899118724642. Distance: 1.1945976164041214
Total norm for 4 adversaries is: 44.14899118724642. distance: 1.1945976164041214
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0704, Accuracy: 9725/9900 (98.2323%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3867/4111 (94.0647%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3805/4111 (92.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0389, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4407/4714 (93.4875%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4383/4714 (92.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2581, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4791/5075 (94.4039%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4729/5075 (93.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1488, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4255/4587 (92.7622%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4188/4587 (91.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1283, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4063/4313 (94.2036%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4036/4313 (93.5776%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8186, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4598/4929 (93.2846%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4465/4929 (90.5863%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1357, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4483/4732 (94.7380%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4443/4732 (93.8926%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8352, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4955/5504 (90.0254%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4832/5504 (87.7907%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3203, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4857/5361 (90.5988%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4800/5361 (89.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1340, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4433/4903 (90.4140%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4405/4903 (89.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1450, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3854/4108 (93.8169%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3758/4108 (91.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0443, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4779/5068 (94.2976%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4458/5068 (87.9637%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2650, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5328/5696 (93.5393%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5167/5696 (90.7128%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2622, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4453/4731 (94.1239%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4379/4731 (92.5597%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9531, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3691/3968 (93.0192%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3675/3968 (92.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9301, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4008/4249 (94.3281%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3908/4249 (91.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0208, Accuracy: 5601/10000 (56.0100%)
time spent on training: 261.5995569229126
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3159, Accuracy: 6681/10000 (66.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0637, Accuracy: 9734/9900 (98.3232%)
Done in 299.4693007469177 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 11, 83, 23, 59, 10, 86, 19, 48, 50, 12, 38, 98, 74, 21, 63, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.20818253808125.
Norm before scaling: 44.16776820314645. Distance: 1.20010715840629
Total norm for 4 adversaries is: 44.16776820314645. distance: 1.20010715840629
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0316, Accuracy: 9818/9900 (99.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5666/5777 (98.0786%), train_poison_data_count: 455
Global model norm: 44.20818253808125.
Norm before scaling: 44.16286220839292. Distance: 1.2422685896598975
Total norm for 4 adversaries is: 44.16286220839292. distance: 1.2422685896598975
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0810, Accuracy: 9702/9900 (98.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4981/5123 (97.2282%), train_poison_data_count: 403
Global model norm: 44.20818253808125.
Norm before scaling: 44.17086906353694. Distance: 1.2405271169642298
Total norm for 4 adversaries is: 44.17086906353694. distance: 1.2405271169642298
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0533, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 44.20818253808125.
Norm before scaling: 44.16728177392033. Distance: 1.2153981896949884
Total norm for 4 adversaries is: 44.16728177392033. distance: 1.2153981896949884
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0574, Accuracy: 9751/9900 (98.4949%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4991/5702 (87.5307%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4526/5702 (79.3757%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3370, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3301/3552 (92.9336%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3311/3552 (93.2151%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8991, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4323/4549 (95.0319%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3791/4549 (83.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2738, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4227/4397 (96.1337%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4187/4397 (95.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8422, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4813/5068 (94.9684%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4663/5068 (92.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1416, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3596/3929 (91.5246%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3580/3929 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9670, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4892/5361 (91.2516%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4840/5361 (90.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1102, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4564/4830 (94.4928%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4558/4830 (94.3685%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0239, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4455/4757 (93.6515%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4343/4757 (91.2970%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0921, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5108/5526 (92.4358%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4848/5526 (87.7307%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3096, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5656/6235 (90.7137%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5422/6235 (86.9607%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2870, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3896/4161 (93.6313%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3842/4161 (92.3336%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0113, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4432/4797 (92.3911%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4344/4797 (90.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4112, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4666/5038 (92.6161%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4657/5038 (92.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8393, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3712/3910 (94.9361%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3505/3910 (89.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2732, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4967/5504 (90.2435%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4815/5504 (87.4818%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3568, Accuracy: 5007/10000 (50.0700%)
time spent on training: 259.8518486022949
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3152, Accuracy: 6677/10000 (66.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0587, Accuracy: 9752/9900 (98.5051%)
Done in 294.38375782966614 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 7, 2, 12, 90, 33, 98, 27, 94, 1, 52, 14, 48, 96, 37, 20, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5208/5308 (98.1161%), train_poison_data_count: 415
Global model norm: 44.22642794428392.
Norm before scaling: 44.185108945651166. Distance: 1.1853477650190447
Total norm for 4 adversaries is: 44.185108945651166. distance: 1.1853477650190447
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0202, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 44.22642794428392.
Norm before scaling: 44.18068425599727. Distance: 1.2618747295891377
Total norm for 4 adversaries is: 44.18068425599727. distance: 1.2618747295891377
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0627, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4972/5123 (97.0525%), train_poison_data_count: 403
Global model norm: 44.22642794428392.
Norm before scaling: 44.18866854448519. Distance: 1.292427894897867
Total norm for 4 adversaries is: 44.18866854448519. distance: 1.292427894897867
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0903, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5373/5503 (97.6377%), train_poison_data_count: 430
Global model norm: 44.22642794428392.
Norm before scaling: 44.18476636920877. Distance: 1.2385367241267002
Total norm for 4 adversaries is: 44.18476636920877. distance: 1.2385367241267002
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1084, Accuracy: 9612/9900 (97.0909%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4454/4869 (91.4767%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4126/4869 (84.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2563, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3742/3968 (94.3044%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3745/3968 (94.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8862, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5124/5526 (92.7253%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4868/5526 (88.0927%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3713, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4502/4748 (94.8189%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4357/4748 (91.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2096, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4483/4818 (93.0469%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4387/4818 (91.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0188, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3945/4161 (94.8089%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3824/4161 (91.9010%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2139, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4257/4587 (92.8058%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4163/4587 (90.7565%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3172, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4767/5224 (91.2519%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4728/5224 (90.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1592, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5170/5422 (95.3523%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5114/5422 (94.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8980, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3906/4130 (94.5763%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3796/4130 (91.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1945, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3992/4196 (95.1382%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3968/4196 (94.5663%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8856, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4595/4830 (95.1346%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4540/4830 (93.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0565, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4701/5086 (92.4302%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4723/5086 (92.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0974, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4384/4741 (92.4699%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4110/4741 (86.6906%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3821, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4467/4714 (94.7603%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4448/4714 (94.3572%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9593, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4636/5122 (90.5115%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4022/5122 (78.5240%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.5526, Accuracy: 4639/10000 (46.3900%)
time spent on training: 270.3073468208313
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3188, Accuracy: 6669/10000 (66.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0552, Accuracy: 9759/9900 (98.5758%)
Done in 309.7097532749176 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 76, 60, 40, 20, 6, 79, 62, 50, 11, 68, 14, 94, 19, 35, 31, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.24420369434707.
Norm before scaling: 44.20212529799189. Distance: 1.1702132077234715
Total norm for 4 adversaries is: 44.20212529799189. distance: 1.1702132077234715
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0266, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5659/5777 (97.9574%), train_poison_data_count: 455
Global model norm: 44.24420369434707.
Norm before scaling: 44.19796469304681. Distance: 1.2347600312243538
Total norm for 4 adversaries is: 44.19796469304681. distance: 1.2347600312243538
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0098, Accuracy: 9872/9900 (99.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4995/5123 (97.5015%), train_poison_data_count: 403
Global model norm: 44.24420369434707.
Norm before scaling: 44.20574013561474. Distance: 1.228486125937568
Total norm for 4 adversaries is: 44.20574013561474. distance: 1.228486125937568
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0256, Accuracy: 9830/9900 (99.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 44.24420369434707.
Norm before scaling: 44.20636006852195. Distance: 1.3368153950162596
Total norm for 4 adversaries is: 44.20636006852195. distance: 1.3368153950162596
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0612, Accuracy: 9742/9900 (98.4040%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3652/3959 (92.2455%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3612/3959 (91.2352%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9246, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3847/4145 (92.8106%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3828/4145 (92.3522%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0808, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5509/5939 (92.7597%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5416/5939 (91.1938%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0023, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4482/4714 (95.0785%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4433/4714 (94.0390%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9066, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4594/4929 (93.2035%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4462/4929 (90.5255%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1650, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3866/4111 (94.0404%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3769/4111 (91.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0637, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4976/5504 (90.4070%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4800/5504 (87.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1777, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4444/4757 (93.4202%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4352/4757 (91.4862%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0665, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5006/5702 (87.7938%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   2,  Average loss: 0.0120, Accuracy: 4412/5702 (77.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4462, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3380/3589 (94.1767%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3355/3589 (93.4801%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9342, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4042/4196 (96.3298%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4014/4196 (95.6625%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7169, Accuracy: 5999/10000 (59.9900%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4787/5224 (91.6348%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4706/5224 (90.0842%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1838, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4978/5361 (92.8558%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4787/5361 (89.2930%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1709, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5197/5615 (92.5557%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5131/5615 (91.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3835, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4228/4537 (93.1893%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4144/4537 (91.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9605, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4449/4732 (94.0194%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4427/4732 (93.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8629, Accuracy: 5749/10000 (57.4900%)
time spent on training: 272.8687586784363
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3342, Accuracy: 6630/10000 (66.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0475, Accuracy: 9772/9900 (98.7071%)
Done in 306.58479166030884 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 97, 47, 16, 70, 11, 17, 62, 21, 9, 1, 10, 20, 30, 84, 83, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.262242579472435.
Norm before scaling: 44.219927380526784. Distance: 1.1321972985176616
Total norm for 4 adversaries is: 44.219927380526784. distance: 1.1321972985176616
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0501, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.262242579472435.
Norm before scaling: 44.21962786231076. Distance: 1.3262163696914886
Total norm for 4 adversaries is: 44.21962786231076. distance: 1.3262163696914886
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0387, Accuracy: 9804/9900 (99.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4974/5123 (97.0915%), train_poison_data_count: 403
Global model norm: 44.262242579472435.
Norm before scaling: 44.22308117039251. Distance: 1.2389086749307738
Total norm for 4 adversaries is: 44.22308117039251. distance: 1.2389086749307738
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0593, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.262242579472435.
Norm before scaling: 44.22285344255346. Distance: 1.2670396034114952
Total norm for 4 adversaries is: 44.22285344255346. distance: 1.2670396034114952
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0405, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4344/4736 (91.7230%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4303/4736 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1129, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4734/5123 (92.4068%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4114/5123 (80.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3618, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5018/5353 (93.7418%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4846/5353 (90.5287%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1646, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5508/5871 (93.8171%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5379/5871 (91.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1396, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5028/5702 (88.1796%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   2,  Average loss: 0.0147, Accuracy: 4171/5702 (73.1498%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4510, Accuracy: 4766/10000 (47.6600%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4466/4903 (91.0871%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4382/4903 (89.3739%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1952, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4929/5504 (89.5531%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4812/5504 (87.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2258, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4682/5038 (92.9337%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4659/5038 (92.4772%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9850, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5261/5727 (91.8631%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5095/5727 (88.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2312, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5139/5422 (94.7805%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5091/5422 (93.8952%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0530, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4793/5068 (94.5738%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4751/5068 (93.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1051, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4462/4714 (94.6542%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4434/4714 (94.0602%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8742, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3570/3774 (94.5946%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3543/3774 (93.8792%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9396, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4777/5209 (91.7067%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4744/5209 (91.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0929, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3283/3552 (92.4268%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3319/3552 (93.4403%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8095, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3701/3910 (94.6547%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3588/3910 (91.7647%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0515, Accuracy: 5570/10000 (55.7000%)
time spent on training: 260.62331438064575
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3318, Accuracy: 6646/10000 (66.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0455, Accuracy: 9778/9900 (98.7677%)
Done in 306.3081386089325 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 82, 6, 27, 91, 61, 74, 8, 42, 9, 15, 85, 19, 89, 48, 96, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5204/5308 (98.0407%), train_poison_data_count: 415
Global model norm: 44.28096192346308.
Norm before scaling: 44.24128870158014. Distance: 1.2216346543364929
Total norm for 4 adversaries is: 44.24128870158014. distance: 1.2216346543364929
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0284, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 44.28096192346308.
Norm before scaling: 44.234787562099385. Distance: 1.2352571353331825
Total norm for 4 adversaries is: 44.234787562099385. distance: 1.2352571353331825
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0882, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 44.28096192346308.
Norm before scaling: 44.24265586124154. Distance: 1.235879729375995
Total norm for 4 adversaries is: 44.24265586124154. distance: 1.235879729375995
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0532, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.28096192346308.
Norm before scaling: 44.24004704671224. Distance: 1.2385666575475858
Total norm for 4 adversaries is: 44.24004704671224. distance: 1.2385666575475858
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0410, Accuracy: 9784/9900 (98.8283%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4926/5298 (92.9785%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4846/5298 (91.4685%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1507, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4623/4929 (93.7918%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4520/4929 (91.7022%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2736, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4292/4587 (93.5688%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4215/4587 (91.8901%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0043, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4152/4527 (91.7164%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4088/4527 (90.3026%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8838, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4107/4485 (91.5719%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4096/4485 (91.3266%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1324, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4483/4797 (93.4542%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4389/4797 (91.4947%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0258, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4545/4889 (92.9638%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4488/4889 (91.7979%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0844, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5420/5907 (91.7555%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5354/5907 (90.6382%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.4500, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5255/5727 (91.7583%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5156/5727 (90.0297%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9550, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5620/6068 (92.6170%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5579/6068 (91.9413%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2382, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6365/6947 (91.6223%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 6029/6947 (86.7857%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2082, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4865/5361 (90.7480%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4847/5361 (90.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1265, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4360/4737 (92.0414%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4310/4737 (90.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3894, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4565/4830 (94.5135%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4510/4830 (93.3747%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1189, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4763/5086 (93.6492%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4705/5086 (92.5088%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0410, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4978/5362 (92.8385%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4848/5362 (90.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0920, Accuracy: 5365/10000 (53.6500%)
time spent on training: 261.98645424842834
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3402, Accuracy: 6623/10000 (66.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0413, Accuracy: 9784/9900 (98.8283%)
Done in 302.06549429893494 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 74, 51, 9, 80, 78, 64, 90, 42, 14, 6, 57, 0, 46, 43, 18, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.30185157230311.
Norm before scaling: 44.258808875589246. Distance: 1.1454098814902902
Total norm for 4 adversaries is: 44.258808875589246. distance: 1.1454098814902902
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0638, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.30185157230311.
Norm before scaling: 44.25587415768598. Distance: 1.2534493537899645
Total norm for 4 adversaries is: 44.25587415768598. distance: 1.2534493537899645
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0423, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4972/5123 (97.0525%), train_poison_data_count: 403
Global model norm: 44.30185157230311.
Norm before scaling: 44.2646708333449. Distance: 1.2758882495232906
Total norm for 4 adversaries is: 44.2646708333449. distance: 1.2758882495232906
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0170, Accuracy: 9860/9900 (99.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.30185157230311.
Norm before scaling: 44.261608260662115. Distance: 1.2572944474630674
Total norm for 4 adversaries is: 44.261608260662115. distance: 1.2572944474630674
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0602, Accuracy: 9752/9900 (98.5051%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4459/4797 (92.9539%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4380/4797 (91.3071%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9540, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3844/4108 (93.5735%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3798/4108 (92.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9503, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5249/5727 (91.6536%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5161/5727 (90.1170%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1499, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5046/5461 (92.4007%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4939/5461 (90.4413%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3482, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4139/4368 (94.7573%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4034/4368 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9926, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4509/4894 (92.1332%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4429/4894 (90.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3426, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4502/4748 (94.8189%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4362/4748 (91.8703%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0164, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5433/5907 (91.9756%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5332/5907 (90.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.5266, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3989/4196 (95.0667%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3948/4196 (94.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8193, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4661/4929 (94.5628%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4509/4929 (91.4790%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1182, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4649/4956 (93.8055%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4533/4956 (91.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1879, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5065/5454 (92.8676%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4843/5454 (88.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3312, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4928/5399 (91.2762%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4713/5399 (87.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2843, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4648/4979 (93.3521%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4600/4979 (92.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9974, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4008/4249 (94.3281%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3958/4249 (93.1513%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9768, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4598/5050 (91.0495%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4488/5050 (88.8713%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2416, Accuracy: 5162/10000 (51.6200%)
time spent on training: 263.84270691871643
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3532, Accuracy: 6600/10000 (66.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0387, Accuracy: 9789/9900 (98.8788%)
Done in 298.5517222881317 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 27, 87, 60, 89, 4, 98, 25, 54, 90, 2, 44, 35, 74, 78, 92, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5220/5308 (98.3421%), train_poison_data_count: 415
Global model norm: 44.32096732395684.
Norm before scaling: 44.277827419336674. Distance: 1.127299448941821
Total norm for 4 adversaries is: 44.277827419336674. distance: 1.127299448941821
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0507, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 44.32096732395684.
Norm before scaling: 44.27654819118765. Distance: 1.2864414270605438
Total norm for 4 adversaries is: 44.27654819118765. distance: 1.2864414270605438
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0215, Accuracy: 9839/9900 (99.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4981/5123 (97.2282%), train_poison_data_count: 403
Global model norm: 44.32096732395684.
Norm before scaling: 44.28060906161056. Distance: 1.2253819026034651
Total norm for 4 adversaries is: 44.28060906161056. distance: 1.2253819026034651
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0998, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.32096732395684.
Norm before scaling: 44.28056219693425. Distance: 1.2625141766196
Total norm for 4 adversaries is: 44.28056219693425. distance: 1.2625141766196
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0170, Accuracy: 9855/9900 (99.5455%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4288/4587 (93.4816%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4204/4587 (91.6503%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0933, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3652/3995 (91.4143%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3609/3995 (90.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2187, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3837/4145 (92.5694%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3823/4145 (92.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0717, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4384/4737 (92.5480%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4350/4737 (91.8303%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3813, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3758/4028 (93.2969%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3744/4028 (92.9494%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9011, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3978/4161 (95.6020%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3863/4161 (92.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0762, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5784/6419 (90.1075%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5565/6419 (86.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2524, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5118/5645 (90.6643%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4751/5645 (84.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3438, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4495/4748 (94.6714%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4394/4748 (92.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0464, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3728/3968 (93.9516%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3734/3968 (94.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.7952, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4805/5075 (94.6798%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4735/5075 (93.3005%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0175, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5226/5615 (93.0721%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5126/5615 (91.2912%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1610, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4474/4797 (93.2666%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4386/4797 (91.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0308, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4161/4368 (95.2610%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4054/4368 (92.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0640, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6430/6812 (94.3922%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6236/6812 (91.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2169, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4786/5068 (94.4357%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4697/5068 (92.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0903, Accuracy: 5444/10000 (54.4400%)
time spent on training: 265.50063920021057
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3605, Accuracy: 6571/10000 (65.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0383, Accuracy: 9790/9900 (98.8889%)
Done in 298.9714434146881 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 95, 8, 67, 7, 31, 90, 40, 65, 34, 20, 2, 82, 51, 83, 86, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5208/5308 (98.1161%), train_poison_data_count: 415
Global model norm: 44.33845601326939.
Norm before scaling: 44.297049988631436. Distance: 1.1859948507522038
Total norm for 4 adversaries is: 44.297049988631436. distance: 1.1859948507522038
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0323, Accuracy: 9823/9900 (99.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5665/5777 (98.0613%), train_poison_data_count: 455
Global model norm: 44.33845601326939.
Norm before scaling: 44.28994792619074. Distance: 1.208309842023835
Total norm for 4 adversaries is: 44.28994792619074. distance: 1.208309842023835
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0262, Accuracy: 9834/9900 (99.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4997/5123 (97.5405%), train_poison_data_count: 403
Global model norm: 44.33845601326939.
Norm before scaling: 44.3000839335936. Distance: 1.2461254630044418
Total norm for 4 adversaries is: 44.3000839335936. distance: 1.2461254630044418
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0483, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.33845601326939.
Norm before scaling: 44.29746472270592. Distance: 1.2247131401039237
Total norm for 4 adversaries is: 44.29746472270592. distance: 1.2247131401039237
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0727, Accuracy: 9700/9900 (97.9798%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4505/5018 (89.7768%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4426/5018 (88.2025%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1844, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4539/4889 (92.8411%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4398/4889 (89.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3609, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5076/5559 (91.3114%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4860/5559 (87.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3050, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4481/4869 (92.0312%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3992/4869 (81.9881%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.4459, Accuracy: 4854/10000 (48.5400%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4255/4537 (93.7844%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4213/4537 (92.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9466, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4556/4748 (95.9562%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4463/4748 (93.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0735, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5550/5939 (93.4501%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5441/5939 (91.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1705, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5094/5497 (92.6687%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4934/5497 (89.7580%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0976, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4548/4911 (92.6084%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4555/4911 (92.7510%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0440, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4492/4714 (95.2906%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4434/4714 (94.0602%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8554, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3715/3968 (93.6240%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3718/3968 (93.6996%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8989, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4973/5298 (93.8656%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4976/5298 (93.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0513, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3875/4108 (94.3281%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3882/4108 (94.4985%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9741, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3281/3552 (92.3705%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3360/3552 (94.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7278, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3590/3929 (91.3719%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3595/3929 (91.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0191, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6447/6812 (94.6418%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   2,  Average loss: 0.0033, Accuracy: 6385/6812 (93.7317%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0930, Accuracy: 5442/10000 (54.4200%)
time spent on training: 256.124703168869
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3630, Accuracy: 6566/10000 (65.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0388, Accuracy: 9790/9900 (98.8889%)
Done in 292.36902117729187 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 93, 42, 22, 44, 28, 6, 70, 27, 35, 41, 8, 24, 26, 60, 31, 12].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.356144211336435.
Norm before scaling: 44.31416935325258. Distance: 1.1526670875158769
Total norm for 4 adversaries is: 44.31416935325258. distance: 1.1526670875158769
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0525, Accuracy: 9750/9900 (98.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 44.356144211336435.
Norm before scaling: 44.31126722765117. Distance: 1.2964316380076826
Total norm for 4 adversaries is: 44.31126722765117. distance: 1.2964316380076826
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0748, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 44.356144211336435.
Norm before scaling: 44.31711673763874. Distance: 1.2379207146389128
Total norm for 4 adversaries is: 44.31711673763874. distance: 1.2379207146389128
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0668, Accuracy: 9707/9900 (98.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5390/5503 (97.9466%), train_poison_data_count: 430
Global model norm: 44.356144211336435.
Norm before scaling: 44.31415420263951. Distance: 1.241982065163456
Total norm for 4 adversaries is: 44.31415420263951. distance: 1.241982065163456
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0769, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4675/5055 (92.4827%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4615/5055 (91.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2937, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5441/5907 (92.1111%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5286/5907 (89.4870%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3293, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5275/5696 (92.6088%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5164/5696 (90.6601%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1505, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4770/5075 (93.9901%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4653/5075 (91.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1337, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4688/5122 (91.5267%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4167/5122 (81.3549%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.6959, Accuracy: 4556/10000 (45.5600%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4654/4929 (94.4208%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4491/4929 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0944, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5510/5871 (93.8511%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5338/5871 (90.9215%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2157, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4289/4587 (93.5034%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4227/4587 (92.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0375, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5251/5615 (93.5174%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5119/5615 (91.1665%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3771, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4443/4714 (94.2512%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4403/4714 (93.4026%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0883, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4563/4889 (93.3320%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4467/4889 (91.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1190, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4063/4313 (94.2036%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4028/4313 (93.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9073, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3876/4086 (94.8605%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3828/4086 (93.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9643, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3867/4145 (93.2931%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3847/4145 (92.8106%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0862, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4250/4537 (93.6742%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4179/4537 (92.1093%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8984, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5078/5526 (91.8929%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4876/5526 (88.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2561, Accuracy: 5191/10000 (51.9100%)
time spent on training: 258.1749622821808
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3724, Accuracy: 6568/10000 (65.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0375, Accuracy: 9795/9900 (98.9394%)
Done in 293.29804587364197 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 90, 84, 56, 79, 2, 19, 51, 77, 98, 18, 60, 16, 88, 63, 69, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.37550065738695.
Norm before scaling: 44.33385664169724. Distance: 1.177470821415949
Total norm for 4 adversaries is: 44.33385664169724. distance: 1.177470821415949
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0584, Accuracy: 9755/9900 (98.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5658/5777 (97.9401%), train_poison_data_count: 455
Global model norm: 44.37550065738695.
Norm before scaling: 44.32938346380705. Distance: 1.2652798876772133
Total norm for 4 adversaries is: 44.32938346380705. distance: 1.2652798876772133
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0750, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.37550065738695.
Norm before scaling: 44.336682950781565. Distance: 1.230688360083651
Total norm for 4 adversaries is: 44.336682950781565. distance: 1.230688360083651
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1166, Accuracy: 9582/9900 (96.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5396/5503 (98.0556%), train_poison_data_count: 430
Global model norm: 44.37550065738695.
Norm before scaling: 44.33231606905819. Distance: 1.2184052591101395
Total norm for 4 adversaries is: 44.33231606905819. distance: 1.2184052591101395
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0616, Accuracy: 9737/9900 (98.3535%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4535/4748 (95.5139%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4425/4748 (93.1971%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0780, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4813/5209 (92.3978%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4731/5209 (90.8236%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.4011, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5028/5427 (92.6479%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4831/5427 (89.0179%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1389, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3881/4111 (94.4053%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3766/4111 (91.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1282, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3765/3968 (94.8841%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3736/3968 (94.1532%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7497, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4941/5361 (92.1656%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4738/5361 (88.3790%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1973, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3885/4108 (94.5716%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3689/4108 (89.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2275, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4643/5050 (91.9406%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4517/5050 (89.4455%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0987, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3913/4161 (94.0399%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3821/4161 (91.8289%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0754, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3968/4249 (93.3867%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3897/4249 (91.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0787, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3886/4145 (93.7515%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3840/4145 (92.6417%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0529, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5027/5353 (93.9100%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4882/5353 (91.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1846, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4950/5362 (92.3163%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4848/5362 (90.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2030, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3711/3910 (94.9105%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3678/3910 (94.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0651, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4095/4364 (93.8359%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4010/4364 (91.8882%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0316, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5303/5727 (92.5965%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5132/5727 (89.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9027, Accuracy: 5677/10000 (56.7700%)
time spent on training: 268.98270440101624
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3852, Accuracy: 6537/10000 (65.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0392, Accuracy: 9792/9900 (98.9091%)
Done in 304.21636390686035 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 37, 97, 49, 32, 82, 55, 2, 63, 31, 12, 87, 60, 93, 0, 66, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5186/5308 (97.7016%), train_poison_data_count: 415
Global model norm: 44.39337482683227.
Norm before scaling: 44.35395903006433. Distance: 1.2547444426844252
Total norm for 4 adversaries is: 44.35395903006433. distance: 1.2547444426844252
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0554, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5666/5777 (98.0786%), train_poison_data_count: 455
Global model norm: 44.39337482683227.
Norm before scaling: 44.34604992053619. Distance: 1.2005357003549888
Total norm for 4 adversaries is: 44.34604992053619. distance: 1.2005357003549888
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0560, Accuracy: 9747/9900 (98.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 44.39337482683227.
Norm before scaling: 44.35401407373548. Distance: 1.2334773989038337
Total norm for 4 adversaries is: 44.35401407373548. distance: 1.2334773989038337
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0516, Accuracy: 9765/9900 (98.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5390/5503 (97.9466%), train_poison_data_count: 430
Global model norm: 44.39337482683227.
Norm before scaling: 44.35137740515366. Distance: 1.2357511454643855
Total norm for 4 adversaries is: 44.35137740515366. distance: 1.2357511454643855
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0266, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4433/4741 (93.5035%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4239/4741 (89.4115%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.4873, Accuracy: 4918/10000 (49.1800%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4298/4736 (90.7517%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4248/4736 (89.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3396, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5173/5652 (91.5251%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5015/5652 (88.7297%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2044, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5494/6080 (90.3618%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5353/6080 (88.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3376, Accuracy: 4936/10000 (49.3600%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5027/5298 (94.8849%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4959/5298 (93.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8661, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4475/4731 (94.5889%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4430/4731 (93.6377%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8924, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3763/3968 (94.8337%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3714/3968 (93.5988%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8945, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3711/3910 (94.9105%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3534/3910 (90.3836%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1753, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4282/4537 (94.3795%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4198/4537 (92.5281%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9061, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5068/5526 (91.7119%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4944/5526 (89.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2721, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3703/3995 (92.6909%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3637/3995 (91.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0859, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3898/4145 (94.0410%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3876/4145 (93.5103%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1034, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4714/5055 (93.2542%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4590/5055 (90.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1420, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5038/5454 (92.3726%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4858/5454 (89.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2950, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4487/4843 (92.6492%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4504/4843 (93.0002%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9237, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3901/4130 (94.4552%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3826/4130 (92.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0432, Accuracy: 5610/10000 (56.1000%)
time spent on training: 264.75367307662964
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3924, Accuracy: 6527/10000 (65.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0378, Accuracy: 9795/9900 (98.9394%)
Done in 305.0558490753174 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 59, 98, 38, 39, 7, 3, 32, 76, 35, 66, 73, 20, 74, 49, 62, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 44.41139297716156.
Norm before scaling: 44.36808787495453. Distance: 1.1598378781778107
Total norm for 4 adversaries is: 44.36808787495453. distance: 1.1598378781778107
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0308, Accuracy: 9823/9900 (99.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 44.41139297716156.
Norm before scaling: 44.363415906560185. Distance: 1.1931002721127386
Total norm for 4 adversaries is: 44.363415906560185. distance: 1.1931002721127386
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0434, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.41139297716156.
Norm before scaling: 44.37161491269996. Distance: 1.2051224414460768
Total norm for 4 adversaries is: 44.37161491269996. distance: 1.2051224414460768
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0595, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 44.41139297716156.
Norm before scaling: 44.37239621542246. Distance: 1.2958363429747013
Total norm for 4 adversaries is: 44.37239621542246. distance: 1.2958363429747013
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0460, Accuracy: 9791/9900 (98.8990%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4228/4397 (96.1565%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0019, Accuracy: 4240/4397 (96.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7133, Accuracy: 6109/10000 (61.0900%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3938/4161 (94.6407%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3837/4161 (92.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1792, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5667/6235 (90.8901%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5502/6235 (88.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3258, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3899/4175 (93.3892%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3762/4175 (90.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1750, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4482/4869 (92.0518%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4349/4869 (89.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2714, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5042/5346 (94.3135%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4984/5346 (93.2286%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1561, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5492/6080 (90.3289%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5282/6080 (86.8750%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3709, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3649/3959 (92.1697%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3555/3959 (89.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1069, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5207/5615 (92.7337%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5145/5615 (91.6296%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1913, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4527/4843 (93.4751%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4487/4843 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0030, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4406/4605 (95.6786%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4362/4605 (94.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8446, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4473/4714 (94.8876%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4424/4714 (93.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9443, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4415/4797 (92.0367%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4348/4797 (90.6400%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1201, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5170/5652 (91.4720%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5012/5652 (88.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2586, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4917/5504 (89.3350%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4826/5504 (87.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2422, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4778/5075 (94.1478%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4592/5075 (90.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0312, Accuracy: 5490/10000 (54.9000%)
time spent on training: 252.610280752182
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3953, Accuracy: 6523/10000 (65.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0382, Accuracy: 9794/9900 (98.9293%)
Done in 287.89951729774475 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 32, 2, 40, 91, 74, 50, 6, 92, 53, 87, 69, 86, 52, 37, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.42990111716714.
Norm before scaling: 44.38778562504907. Distance: 1.1932162684466834
Total norm for 4 adversaries is: 44.38778562504907. distance: 1.1932162684466834
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0114, Accuracy: 9871/9900 (99.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5649/5777 (97.7843%), train_poison_data_count: 455
Global model norm: 44.42990111716714.
Norm before scaling: 44.38259728098672. Distance: 1.2324184411631294
Total norm for 4 adversaries is: 44.38259728098672. distance: 1.2324184411631294
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0485, Accuracy: 9771/9900 (98.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4999/5123 (97.5795%), train_poison_data_count: 403
Global model norm: 44.42990111716714.
Norm before scaling: 44.391528336901594. Distance: 1.2402133729613252
Total norm for 4 adversaries is: 44.391528336901594. distance: 1.2402133729613252
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.2161, Accuracy: 9295/9900 (93.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5370/5503 (97.5831%), train_poison_data_count: 430
Global model norm: 44.42990111716714.
Norm before scaling: 44.388722020104666. Distance: 1.2841475682176207
Total norm for 4 adversaries is: 44.388722020104666. distance: 1.2841475682176207
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0277, Accuracy: 9830/9900 (99.2929%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3922/4175 (93.9401%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3845/4175 (92.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9443, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5468/6080 (89.9342%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5278/6080 (86.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3582, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3765/3968 (94.8841%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3740/3968 (94.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7664, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5555/5939 (93.5343%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5395/5939 (90.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1887, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4120/4527 (91.0095%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4026/4527 (88.9331%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1956, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4498/4797 (93.7669%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4426/4797 (92.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0580, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4453/4757 (93.6094%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4335/4757 (91.1289%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2133, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4619/4929 (93.7107%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4473/4929 (90.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1167, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6487/6812 (95.2290%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 6351/6812 (93.2325%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1026, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5941/6664 (89.1507%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   2,  Average loss: 0.0090, Accuracy: 5512/6664 (82.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2549, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3687/3995 (92.2904%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3602/3995 (90.1627%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2661, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4053/4364 (92.8735%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4032/4364 (92.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1223, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3617/3929 (92.0590%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3585/3929 (91.2446%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1617, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3892/4130 (94.2373%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3785/4130 (91.6465%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0810, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4382/4741 (92.4278%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4027/4741 (84.9399%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.6342, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5508/5871 (93.8171%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5333/5871 (90.8363%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2280, Accuracy: 5232/10000 (52.3200%)
time spent on training: 269.9991910457611
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.3917, Accuracy: 6523/10000 (65.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0398, Accuracy: 9791/9900 (98.8990%)
Done in 304.93921971321106 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 30, 23, 34, 24, 2, 67, 21, 72, 83, 87, 29, 15, 42, 37, 70, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.44891923206275.
Norm before scaling: 44.405179273245395. Distance: 1.1564998356793885
Total norm for 4 adversaries is: 44.405179273245395. distance: 1.1564998356793885
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0323, Accuracy: 9812/9900 (99.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5658/5777 (97.9401%), train_poison_data_count: 455
Global model norm: 44.44891923206275.
Norm before scaling: 44.40287691710555. Distance: 1.2477324900207747
Total norm for 4 adversaries is: 44.40287691710555. distance: 1.2477324900207747
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0259, Accuracy: 9828/9900 (99.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.44891923206275.
Norm before scaling: 44.410208303525216. Distance: 1.2519363664049958
Total norm for 4 adversaries is: 44.410208303525216. distance: 1.2519363664049958
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0359, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5383/5503 (97.8194%), train_poison_data_count: 430
Global model norm: 44.44891923206275.
Norm before scaling: 44.405873393019476. Distance: 1.241371222470599
Total norm for 4 adversaries is: 44.405873393019476. distance: 1.241371222470599
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0223, Accuracy: 9844/9900 (99.4343%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3569/3774 (94.5681%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3562/3774 (94.3826%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9540, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4295/4549 (94.4164%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4230/4549 (92.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9262, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4608/4911 (93.8302%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4512/4911 (91.8754%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3282, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4056/4313 (94.0413%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4006/4313 (92.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0096, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3780/3968 (95.2621%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3691/3968 (93.0192%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8011, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5117/5559 (92.0489%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4906/5559 (88.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2185, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4697/5038 (93.2314%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4594/5038 (91.1870%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9579, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4776/5193 (91.9700%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4658/5193 (89.6977%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3101, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3278/3552 (92.2860%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3269/3552 (92.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8563, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3699/3995 (92.5907%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3579/3995 (89.5870%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1243, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4486/4732 (94.8014%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4483/4732 (94.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8787, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5612/6068 (92.4852%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5487/6068 (90.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1615, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5360/5907 (90.7398%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5300/5907 (89.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.5573, Accuracy: 4803/10000 (48.0300%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4444/4741 (93.7355%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4063/4741 (85.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.5117, Accuracy: 4805/10000 (48.0500%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5528/5871 (94.1577%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5428/5871 (92.4544%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9966, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3878/4111 (94.3323%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3781/4111 (91.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2179, Accuracy: 5333/10000 (53.3300%)
time spent on training: 264.7938985824585
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.3989, Accuracy: 6515/10000 (65.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0374, Accuracy: 9793/9900 (98.9192%)
Done in 298.19973826408386 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 51, 97, 20, 54, 5, 34, 74, 14, 77, 50, 56, 10, 16, 39, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.4660748382791.
Norm before scaling: 44.423886473980694. Distance: 1.1619455430406649
Total norm for 4 adversaries is: 44.423886473980694. distance: 1.1619455430406649
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0197, Accuracy: 9848/9900 (99.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 44.4660748382791.
Norm before scaling: 44.41880952534002. Distance: 1.2176968841841178
Total norm for 4 adversaries is: 44.41880952534002. distance: 1.2176968841841178
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0235, Accuracy: 9847/9900 (99.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.4660748382791.
Norm before scaling: 44.42583878068243. Distance: 1.2208767942866707
Total norm for 4 adversaries is: 44.42583878068243. distance: 1.2208767942866707
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0407, Accuracy: 9802/9900 (99.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 44.4660748382791.
Norm before scaling: 44.42340559709206. Distance: 1.2237665174887231
Total norm for 4 adversaries is: 44.42340559709206. distance: 1.2237665174887231
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0544, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4371/4672 (93.5574%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4399/4672 (94.1567%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9695, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3882/4108 (94.4985%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3805/4108 (92.6241%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9842, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4366/4736 (92.1875%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4290/4736 (90.5828%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0475, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4473/4714 (94.8876%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4471/4714 (94.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7485, Accuracy: 5978/10000 (59.7800%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5118/5645 (90.6643%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4880/5645 (86.4482%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2487, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4734/4993 (94.8127%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4588/4993 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1369, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4628/4911 (94.2374%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4573/4911 (93.1175%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9985, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4421/4797 (92.1618%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4428/4797 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9618, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4012/4196 (95.6149%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3973/4196 (94.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7472, Accuracy: 5987/10000 (59.8700%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4607/5050 (91.2277%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4562/5050 (90.3366%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2943, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4477/4757 (94.1139%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4376/4757 (91.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0618, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4963/5427 (91.4502%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4832/5427 (89.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0697, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4772/5068 (94.1594%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4697/5068 (92.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1360, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4976/5353 (92.9572%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4787/5353 (89.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0916, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3883/4175 (93.0060%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3821/4175 (91.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0684, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3875/4111 (94.2593%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3825/4111 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0033, Accuracy: 5548/10000 (55.4800%)
time spent on training: 256.71906781196594
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4119, Accuracy: 6484/10000 (64.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0330, Accuracy: 9806/9900 (99.0505%)
Done in 293.9477925300598 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 31, 8, 83, 64, 23, 74, 90, 97, 86, 76, 0, 62, 33, 32, 54, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.48355587364911.
Norm before scaling: 44.44039113529282. Distance: 1.1589918361998366
Total norm for 4 adversaries is: 44.44039113529282. distance: 1.1589918361998366
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0406, Accuracy: 9799/9900 (98.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5658/5777 (97.9401%), train_poison_data_count: 455
Global model norm: 44.48355587364911.
Norm before scaling: 44.43641217022927. Distance: 1.2275454233470589
Total norm for 4 adversaries is: 44.43641217022927. distance: 1.2275454233470589
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0740, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 44.48355587364911.
Norm before scaling: 44.44252811962954. Distance: 1.1952042873492066
Total norm for 4 adversaries is: 44.44252811962954. distance: 1.1952042873492066
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0695, Accuracy: 9725/9900 (98.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5357/5503 (97.3469%), train_poison_data_count: 430
Global model norm: 44.48355587364911.
Norm before scaling: 44.44246906553038. Distance: 1.290974811133888
Total norm for 4 adversaries is: 44.44246906553038. distance: 1.290974811133888
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0242, Accuracy: 9835/9900 (99.3434%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4300/4537 (94.7763%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4210/4537 (92.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9367, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4542/4889 (92.9024%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4584/4889 (93.7615%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9189, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3314/3552 (93.2995%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3372/3552 (94.9324%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8436, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4508/4894 (92.1128%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4413/4894 (90.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1974, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4333/4549 (95.2517%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3792/4549 (83.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.5849, Accuracy: 4745/10000 (47.4500%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4447/4797 (92.7038%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4336/4797 (90.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0938, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4536/4748 (95.5350%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4367/4748 (91.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0467, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4355/4736 (91.9552%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4250/4736 (89.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2429, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3658/3929 (93.1026%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3592/3929 (91.4228%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9020, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3650/3959 (92.1950%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3660/3959 (92.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0904, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5020/5454 (92.0425%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4849/5454 (88.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4506, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4937/5504 (89.6984%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4735/5504 (86.0283%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3353, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4501/4818 (93.4205%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4368/4818 (90.6600%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1594, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5457/6080 (89.7533%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5396/6080 (88.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2084, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5143/5645 (91.1072%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4845/5645 (85.8282%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2986, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4497/4869 (92.3598%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4036/4869 (82.8918%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.6742, Accuracy: 4689/10000 (46.8900%)
time spent on training: 269.75355982780457
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4169, Accuracy: 6468/10000 (64.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0317, Accuracy: 9811/9900 (99.1010%)
Done in 306.2359519004822 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 93, 25, 55, 21, 42, 88, 17, 23, 2, 68, 12, 52, 5, 44, 72, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5220/5308 (98.3421%), train_poison_data_count: 415
Global model norm: 44.50256888872049.
Norm before scaling: 44.458313350559784. Distance: 1.1239625597789777
Total norm for 4 adversaries is: 44.458313350559784. distance: 1.1239625597789777
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0209, Accuracy: 9847/9900 (99.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.50256888872049.
Norm before scaling: 44.45585173974569. Distance: 1.2450378632054226
Total norm for 4 adversaries is: 44.45585173974569. distance: 1.2450378632054226
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0841, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5007/5123 (97.7357%), train_poison_data_count: 403
Global model norm: 44.50256888872049.
Norm before scaling: 44.46064441016558. Distance: 1.1945798535934415
Total norm for 4 adversaries is: 44.46064441016558. distance: 1.1945798535934415
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0629, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5397/5503 (98.0738%), train_poison_data_count: 430
Global model norm: 44.50256888872049.
Norm before scaling: 44.45878561279044. Distance: 1.1737457094124242
Total norm for 4 adversaries is: 44.45878561279044. distance: 1.1737457094124242
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0567, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4679/5055 (92.5618%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4641/5055 (91.8101%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1796, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5873/6419 (91.4940%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5541/6419 (86.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2530, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4482/4731 (94.7368%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4418/4731 (93.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9015, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4669/5038 (92.6757%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4631/5038 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9596, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5458/5907 (92.3988%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5312/5907 (89.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.5046, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4984/5362 (92.9504%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4808/5362 (89.6680%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1967, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4506/4903 (91.9029%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4395/4903 (89.6390%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1606, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4321/4549 (94.9879%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4167/4549 (91.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0681, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3756/3968 (94.6573%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3757/3968 (94.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8282, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3406/3589 (94.9011%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3228/3589 (89.9415%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0565, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5149/5526 (93.1777%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4813/5526 (87.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3625, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3910/4130 (94.6731%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3852/4130 (93.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9260, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4736/4993 (94.8528%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4588/4993 (91.8886%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2934, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4794/5075 (94.4631%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4580/5075 (90.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1837, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4781/5193 (92.0662%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4448/5193 (85.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.7438, Accuracy: 4568/10000 (45.6800%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4722/5035 (93.7835%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4722/5035 (93.7835%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0380, Accuracy: 5579/10000 (55.7900%)
time spent on training: 267.242871761322
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4233, Accuracy: 6454/10000 (64.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0323, Accuracy: 9808/9900 (99.0707%)
Done in 301.88703632354736 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 32, 54, 57, 25, 67, 38, 0, 98, 43, 94, 42, 26, 70, 90, 56, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5224/5308 (98.4175%), train_poison_data_count: 415
Global model norm: 44.52144628926042.
Norm before scaling: 44.47745517174614. Distance: 1.1273064282664027
Total norm for 4 adversaries is: 44.47745517174614. distance: 1.1273064282664027
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0407, Accuracy: 9802/9900 (99.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5661/5777 (97.9920%), train_poison_data_count: 455
Global model norm: 44.52144628926042.
Norm before scaling: 44.473491874286054. Distance: 1.2209082347212539
Total norm for 4 adversaries is: 44.473491874286054. distance: 1.2209082347212539
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0544, Accuracy: 9758/9900 (98.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5004/5123 (97.6771%), train_poison_data_count: 403
Global model norm: 44.52144628926042.
Norm before scaling: 44.47896327285658. Distance: 1.2143720588118372
Total norm for 4 adversaries is: 44.47896327285658. distance: 1.2143720588118372
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0247, Accuracy: 9833/9900 (99.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.52144628926042.
Norm before scaling: 44.48103116823015. Distance: 1.286470106845783
Total norm for 4 adversaries is: 44.48103116823015. distance: 1.286470106845783
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0297, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5550/6080 (91.2829%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5259/6080 (86.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4743, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5163/5645 (91.4615%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4880/5645 (86.4482%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3054, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4663/4956 (94.0880%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4544/4956 (91.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1181, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5821/6419 (90.6839%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5561/6419 (86.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3494, Accuracy: 4973/10000 (49.7300%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5120/5559 (92.1029%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4897/5559 (88.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2842, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5687/6235 (91.2109%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5465/6235 (87.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3768, Accuracy: 4897/10000 (48.9700%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5067/5454 (92.9043%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4904/5454 (89.9157%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0344, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3939/4161 (94.6647%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3840/4161 (92.2855%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0183, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4641/4979 (93.2115%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4521/4979 (90.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0398, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4799/5224 (91.8645%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4762/5224 (91.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1545, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5504/5907 (93.1776%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5425/5907 (91.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3449, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3884/4086 (95.0563%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3844/4086 (94.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9004, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5539/5871 (94.3451%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5405/5871 (92.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3572, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4531/4748 (95.4297%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4345/4748 (91.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2052, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4951/5427 (91.2290%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4852/5427 (89.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0989, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4029/4196 (96.0200%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4002/4196 (95.3765%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8468, Accuracy: 5825/10000 (58.2500%)
time spent on training: 273.7619397640228
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4344, Accuracy: 6434/10000 (64.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0302, Accuracy: 9815/9900 (99.1414%)
Done in 307.39129972457886 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 12, 96, 75, 78, 54, 4, 5, 33, 35, 83, 57, 40, 6, 38, 18, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.54163530215999.
Norm before scaling: 44.49922916730553. Distance: 1.2122466363370474
Total norm for 4 adversaries is: 44.49922916730553. distance: 1.2122466363370474
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0284, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.54163530215999.
Norm before scaling: 44.49332403618617. Distance: 1.2305171412080467
Total norm for 4 adversaries is: 44.49332403618617. distance: 1.2305171412080467
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0350, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.54163530215999.
Norm before scaling: 44.499594011490714. Distance: 1.1647102038906227
Total norm for 4 adversaries is: 44.499594011490714. distance: 1.1647102038906227
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0447, Accuracy: 9786/9900 (98.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5408/5503 (98.2737%), train_poison_data_count: 430
Global model norm: 44.54163530215999.
Norm before scaling: 44.497432334630275. Distance: 1.1769719985476694
Total norm for 4 adversaries is: 44.497432334630275. distance: 1.1769719985476694
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0892, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5056/5526 (91.4948%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4791/5526 (86.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4178, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4780/5086 (93.9835%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4739/5086 (93.1773%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9488, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4414/4672 (94.4777%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4344/4672 (92.9795%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9596, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4128/4368 (94.5055%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0622, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5121/5645 (90.7174%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4780/5645 (84.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3115, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3802/4028 (94.3893%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3797/4028 (94.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8740, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4717/4993 (94.4723%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4629/4993 (92.7098%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1497, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4504/4818 (93.4828%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4417/4818 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9563, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5219/5615 (92.9475%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5101/5615 (90.8459%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3301, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3294/3552 (92.7365%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3333/3552 (93.8345%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8850, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4638/4956 (93.5835%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4578/4956 (92.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0108, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5569/5939 (93.7700%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5516/5939 (92.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0737, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4641/4929 (94.1570%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4525/4929 (91.8036%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1645, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5692/6235 (91.2911%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5479/6235 (87.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4190, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4013/4249 (94.4458%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3926/4249 (92.3982%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9486, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4224/4485 (94.1806%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3718/4485 (82.8986%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3426, Accuracy: 4852/10000 (48.5200%)
time spent on training: 270.0181884765625
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4368, Accuracy: 6440/10000 (64.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0298, Accuracy: 9815/9900 (99.1414%)
Done in 306.1481759548187 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 65, 4, 57, 0, 72, 62, 24, 77, 78, 41, 19, 61, 52, 59, 2, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5230/5308 (98.5305%), train_poison_data_count: 415
Global model norm: 44.55965787965121.
Norm before scaling: 44.51444447144727. Distance: 1.1116323473683363
Total norm for 4 adversaries is: 44.51444447144727. distance: 1.1116323473683363
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0490, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.55965787965121.
Norm before scaling: 44.51011422760772. Distance: 1.1992699925909467
Total norm for 4 adversaries is: 44.51011422760772. distance: 1.1992699925909467
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0619, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4993/5123 (97.4624%), train_poison_data_count: 403
Global model norm: 44.55965787965121.
Norm before scaling: 44.51883187597764. Distance: 1.2030086708802787
Total norm for 4 adversaries is: 44.51883187597764. distance: 1.2030086708802787
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0485, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.55965787965121.
Norm before scaling: 44.51516979409239. Distance: 1.206287735264785
Total norm for 4 adversaries is: 44.51516979409239. distance: 1.206287735264785
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0377, Accuracy: 9803/9900 (99.0202%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5114/5497 (93.0326%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4943/5497 (89.9218%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0938, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3830/4028 (95.0844%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3779/4028 (93.8183%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9835, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4685/4956 (94.5319%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4482/4956 (90.4358%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1607, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5026/5454 (92.1525%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4876/5454 (89.4023%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3217, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4805/5193 (92.5284%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4558/5193 (87.7720%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.5069, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4990/5504 (90.6613%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4913/5504 (89.2624%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2426, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4057/4313 (94.0645%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4024/4313 (93.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9367, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4614/5050 (91.3663%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4465/5050 (88.4158%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2562, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4127/4368 (94.4826%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4056/4368 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9905, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4471/4714 (94.8451%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4383/4714 (92.9784%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0467, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4910/5361 (91.5874%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4837/5361 (90.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0657, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4166/4485 (92.8874%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3764/4485 (83.9242%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4467, Accuracy: 4766/10000 (47.6600%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3903/4130 (94.5036%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3863/4130 (93.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8871, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4181/4397 (95.0876%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4195/4397 (95.4060%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9220, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3749/3968 (94.4808%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3748/3968 (94.4556%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8538, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4379/4605 (95.0923%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4298/4605 (93.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9780, Accuracy: 5616/10000 (56.1600%)
time spent on training: 262.36782670021057
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4385, Accuracy: 6444/10000 (64.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0305, Accuracy: 9814/9900 (99.1313%)
Done in 299.164080619812 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 19, 85, 76, 57, 46, 62, 22, 25, 89, 95, 48, 51, 45, 96, 41, 17].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5197/5308 (97.9088%), train_poison_data_count: 415
Global model norm: 44.577225444393825.
Norm before scaling: 44.53487923807586. Distance: 1.1883383351595682
Total norm for 4 adversaries is: 44.53487923807586. distance: 1.1883383351595682
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0467, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.577225444393825.
Norm before scaling: 44.527794547952716. Distance: 1.1836321229662958
Total norm for 4 adversaries is: 44.527794547952716. distance: 1.1836321229662958
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0239, Accuracy: 9830/9900 (99.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.577225444393825.
Norm before scaling: 44.53405692907957. Distance: 1.1669518372012146
Total norm for 4 adversaries is: 44.53405692907957. distance: 1.1669518372012146
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0767, Accuracy: 9698/9900 (97.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.577225444393825.
Norm before scaling: 44.53205317258149. Distance: 1.2042562442623197
Total norm for 4 adversaries is: 44.53205317258149. distance: 1.2042562442623197
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0521, Accuracy: 9756/9900 (98.5455%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4916/5361 (91.6993%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4800/5361 (89.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2696, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6346/6947 (91.3488%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5998/6947 (86.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3012, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3650/3959 (92.1950%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3672/3959 (92.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0292, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4640/4956 (93.6239%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4588/4956 (92.5747%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1584, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4851/5399 (89.8500%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4723/5399 (87.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4061, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4943/5504 (89.8074%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4817/5504 (87.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2553, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5317/5696 (93.3462%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5073/5696 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3073, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5818/6419 (90.6372%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5592/6419 (87.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2558, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4418/4737 (93.2658%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4295/4737 (90.6692%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4109, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4622/5018 (92.1084%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4427/5018 (88.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4780, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4600/4830 (95.2381%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4496/4830 (93.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0529, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3903/4108 (95.0097%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3811/4108 (92.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0052, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4999/5489 (91.0731%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4954/5489 (90.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2588, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4783/5086 (94.0425%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4735/5086 (93.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0386, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4454/4714 (94.4845%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4419/4714 (93.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0684, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4489/4903 (91.5562%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4418/4903 (90.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2022, Accuracy: 5252/10000 (52.5200%)
time spent on training: 275.75985074043274
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4462, Accuracy: 6437/10000 (64.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0301, Accuracy: 9815/9900 (99.1414%)
Done in 319.04137921333313 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 2, 27, 99, 74, 8, 3, 67, 72, 7, 24, 17, 10, 20, 59, 16, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5220/5308 (98.3421%), train_poison_data_count: 415
Global model norm: 44.5969074631127.
Norm before scaling: 44.55064133718714. Distance: 1.094026530594423
Total norm for 4 adversaries is: 44.55064133718714. distance: 1.094026530594423
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0337, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.5969074631127.
Norm before scaling: 44.54518833399335. Distance: 1.164945945631769
Total norm for 4 adversaries is: 44.54518833399335. distance: 1.164945945631769
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0360, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.5969074631127.
Norm before scaling: 44.55427036561703. Distance: 1.190462182393992
Total norm for 4 adversaries is: 44.55427036561703. distance: 1.190462182393992
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0772, Accuracy: 9702/9900 (98.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.5969074631127.
Norm before scaling: 44.552577129794074. Distance: 1.2019019908522592
Total norm for 4 adversaries is: 44.552577129794074. distance: 1.2019019908522592
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0358, Accuracy: 9809/9900 (99.0808%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3768/3968 (94.9597%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3746/3968 (94.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8423, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4317/4587 (94.1138%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4237/4587 (92.3697%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0805, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4428/4851 (91.2801%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4372/4851 (90.1257%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2252, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4509/4797 (93.9962%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4372/4797 (91.1403%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9949, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4588/4889 (93.8433%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4442/4889 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0898, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5082/5346 (95.0617%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5014/5346 (93.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1308, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5137/5559 (92.4087%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4904/5559 (88.2173%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.6289, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4722/5193 (90.9301%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4483/5193 (86.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.4570, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4529/4869 (93.0170%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4239/4869 (87.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2433, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4065/4313 (94.2499%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4036/4313 (93.5776%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8673, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4541/4903 (92.6168%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4467/4903 (91.1075%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2540, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4849/5068 (95.6788%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4645/5068 (91.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1806, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4504/4714 (95.5452%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4431/4714 (93.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8594, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4216/4397 (95.8836%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4214/4397 (95.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7535, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5023/5353 (93.8352%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4872/5353 (91.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1380, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4545/4818 (94.3337%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4372/4818 (90.7430%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2149, Accuracy: 5288/10000 (52.8800%)
time spent on training: 275.50423669815063
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4565, Accuracy: 6418/10000 (64.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0276, Accuracy: 9824/9900 (99.2323%)
Done in 317.32823848724365 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 44, 6, 40, 60, 96, 93, 0, 47, 5, 94, 78, 63, 23, 45, 26, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5217/5308 (98.2856%), train_poison_data_count: 415
Global model norm: 44.61427430407994.
Norm before scaling: 44.56970379185563. Distance: 1.1282095689855667
Total norm for 4 adversaries is: 44.56970379185563. distance: 1.1282095689855667
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0818, Accuracy: 9678/9900 (97.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.61427430407994.
Norm before scaling: 44.564444864642375. Distance: 1.1948977480120824
Total norm for 4 adversaries is: 44.564444864642375. distance: 1.1948977480120824
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0351, Accuracy: 9811/9900 (99.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.61427430407994.
Norm before scaling: 44.572030395245484. Distance: 1.210459313267837
Total norm for 4 adversaries is: 44.572030395245484. distance: 1.210459313267837
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0296, Accuracy: 9822/9900 (99.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.61427430407994.
Norm before scaling: 44.569803760242905. Distance: 1.199004063975595
Total norm for 4 adversaries is: 44.569803760242905. distance: 1.199004063975595
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0375, Accuracy: 9813/9900 (99.1212%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4788/5075 (94.3448%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4746/5075 (93.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2147, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4607/4929 (93.4672%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4463/4929 (90.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3442, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5581/5939 (93.9720%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5463/5939 (91.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2521, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3878/4145 (93.5585%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3882/4145 (93.6550%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0089, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4780/5086 (93.9835%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4727/5086 (92.9414%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1664, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4725/5055 (93.4718%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4622/5055 (91.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0661, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5034/5454 (92.2992%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4825/5454 (88.4672%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0073, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4758/5123 (92.8753%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   2,  Average loss: 0.0123, Accuracy: 4009/5123 (78.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.5713, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4695/4993 (94.0316%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4631/4993 (92.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1100, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4839/5224 (92.6302%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4742/5224 (90.7734%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0563, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4157/4368 (95.1694%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4135/4368 (94.6658%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9374, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3731/3910 (95.4220%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3581/3910 (91.5857%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1719, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4356/4549 (95.7573%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4037/4549 (88.7448%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3073, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5002/5489 (91.1277%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4974/5489 (90.6176%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1530, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3869/4086 (94.6892%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3849/4086 (94.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9897, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4792/5193 (92.2781%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4622/5193 (89.0044%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3855, Accuracy: 5143/10000 (51.4300%)
time spent on training: 265.4976456165314
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4689, Accuracy: 6389/10000 (63.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0261, Accuracy: 9832/9900 (99.3131%)
Done in 303.4061858654022 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 27, 56, 90, 39, 16, 69, 88, 23, 98, 84, 48, 3, 35, 81, 55, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.63276258639779.
Norm before scaling: 44.5864967055785. Distance: 1.0865114739729862
Total norm for 4 adversaries is: 44.5864967055785. distance: 1.0865114739729862
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0552, Accuracy: 9751/9900 (98.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5676/5777 (98.2517%), train_poison_data_count: 455
Global model norm: 44.63276258639779.
Norm before scaling: 44.582578696640994. Distance: 1.167586145919045
Total norm for 4 adversaries is: 44.582578696640994. distance: 1.167586145919045
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0272, Accuracy: 9836/9900 (99.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.63276258639779.
Norm before scaling: 44.59018988723515. Distance: 1.1827969024718268
Total norm for 4 adversaries is: 44.59018988723515. distance: 1.1827969024718268
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0740, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5404/5503 (98.2010%), train_poison_data_count: 430
Global model norm: 44.63276258639779.
Norm before scaling: 44.587950470373016. Distance: 1.2259785908452383
Total norm for 4 adversaries is: 44.587950470373016. distance: 1.2259785908452383
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0322, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4316/4587 (94.0920%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4246/4587 (92.5659%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1251, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5024/5427 (92.5742%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4852/5427 (89.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1662, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4507/4748 (94.9242%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4412/4748 (92.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0224, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3904/4175 (93.5090%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3780/4175 (90.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0845, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5080/5353 (94.9001%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4868/5353 (90.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1880, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4087/4364 (93.6526%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3899/4364 (89.3446%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1294, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5034/5362 (93.8829%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4931/5362 (91.9620%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2209, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4338/4549 (95.3616%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3815/4549 (83.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4545, Accuracy: 4956/10000 (49.5600%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3954/4161 (95.0252%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3877/4161 (93.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1336, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4820/5209 (92.5322%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4741/5209 (91.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1998, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4587/4830 (94.9689%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4517/4830 (93.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1859, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5097/5346 (95.3423%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5063/5346 (94.7063%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1071, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5277/5615 (93.9804%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5182/5615 (92.2885%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0805, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4757/5035 (94.4786%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4659/5035 (92.5323%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9801, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4540/4731 (95.9628%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4415/4731 (93.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0204, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5089/5702 (89.2494%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0119, Accuracy: 4409/5702 (77.3237%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4232, Accuracy: 4886/10000 (48.8600%)
time spent on training: 258.2966661453247
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4789, Accuracy: 6375/10000 (63.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0247, Accuracy: 9832/9900 (99.3131%)
Done in 293.32066345214844 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 97, 21, 14, 37, 95, 9, 28, 17, 73, 23, 0, 68, 19, 50, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5244/5308 (98.7943%), train_poison_data_count: 415
Global model norm: 44.65132522923102.
Norm before scaling: 44.60380328602175. Distance: 1.0456519882814377
Total norm for 4 adversaries is: 44.60380328602175. distance: 1.0456519882814377
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0302, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.65132522923102.
Norm before scaling: 44.602578565016145. Distance: 1.2077611302830418
Total norm for 4 adversaries is: 44.602578565016145. distance: 1.2077611302830418
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0211, Accuracy: 9851/9900 (99.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4993/5123 (97.4624%), train_poison_data_count: 403
Global model norm: 44.65132522923102.
Norm before scaling: 44.60925049238316. Distance: 1.1768767870516181
Total norm for 4 adversaries is: 44.60925049238316. distance: 1.1768767870516181
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0588, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 44.65132522923102.
Norm before scaling: 44.607333578508985. Distance: 1.2091896979734484
Total norm for 4 adversaries is: 44.607333578508985. distance: 1.2091896979734484
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0389, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4377/4736 (92.4198%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4264/4736 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0816, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4694/5038 (93.1719%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4660/5038 (92.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0905, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4039/4196 (96.2583%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4010/4196 (95.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8322, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4427/4741 (93.3769%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4062/4741 (85.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.7902, Accuracy: 4669/10000 (46.6900%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4569/5018 (91.0522%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4465/5018 (88.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0341, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5287/5727 (92.3171%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5066/5727 (88.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2761, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4674/5122 (91.2534%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4099/5122 (80.0273%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6920, Accuracy: 4581/10000 (45.8100%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4557/4903 (92.9431%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4426/4903 (90.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0496, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4388/4605 (95.2877%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4341/4605 (94.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0674, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4328/4549 (95.1418%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3773/4549 (82.9413%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6183, Accuracy: 4712/10000 (47.1200%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5113/5454 (93.7477%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4927/5454 (90.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3626, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3382/3589 (94.2324%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3266/3589 (91.0003%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0973, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4925/5361 (91.8672%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4756/5361 (88.7148%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2348, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4488/4757 (94.3452%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4346/4757 (91.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0615, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4483/4731 (94.7580%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4419/4731 (93.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0237, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5701/6235 (91.4354%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5480/6235 (87.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3943, Accuracy: 4965/10000 (49.6500%)
time spent on training: 268.2267253398895
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4840, Accuracy: 6368/10000 (63.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0227, Accuracy: 9839/9900 (99.3838%)
Done in 303.1629137992859 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 89, 53, 72, 87, 21, 48, 39, 95, 70, 57, 16, 55, 17, 7, 74, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.67095820369133.
Norm before scaling: 44.627803767837655. Distance: 1.1838702391934623
Total norm for 4 adversaries is: 44.627803767837655. distance: 1.1838702391934623
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0219, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5680/5777 (98.3209%), train_poison_data_count: 455
Global model norm: 44.67095820369133.
Norm before scaling: 44.62076529277036. Distance: 1.1894323788792667
Total norm for 4 adversaries is: 44.62076529277036. distance: 1.1894323788792667
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0520, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4977/5123 (97.1501%), train_poison_data_count: 403
Global model norm: 44.67095820369133.
Norm before scaling: 44.63097112974773. Distance: 1.2671210312726136
Total norm for 4 adversaries is: 44.63097112974773. distance: 1.2671210312726136
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0600, Accuracy: 9753/9900 (98.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.67095820369133.
Norm before scaling: 44.62661116226646. Distance: 1.213045463568561
Total norm for 4 adversaries is: 44.62661116226646. distance: 1.213045463568561
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0736, Accuracy: 9707/9900 (98.0505%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4418/4737 (93.2658%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4362/4737 (92.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1300, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5945/6664 (89.2107%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5641/6664 (84.6489%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4009, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4747/5193 (91.4115%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4552/5193 (87.6565%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4302, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3700/3995 (92.6158%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3560/3995 (89.1114%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4226, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4707/5038 (93.4299%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4685/5038 (92.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0127, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4597/4830 (95.1760%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4560/4830 (94.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0743, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3931/4175 (94.1557%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3872/4175 (92.7425%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0213, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4599/5018 (91.6501%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4465/5018 (88.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2535, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5544/5871 (94.4303%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5437/5871 (92.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0500, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4654/4956 (93.9064%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4603/4956 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1820, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5070/5353 (94.7132%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4847/5353 (90.5474%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1774, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4493/4731 (94.9694%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4421/4731 (93.4475%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0696, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4487/4903 (91.5154%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4430/4903 (90.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1829, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4504/4869 (92.5036%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0154, Accuracy: 3508/4869 (72.0476%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.6294, Accuracy: 4512/10000 (45.1200%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4489/4797 (93.5793%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4413/4797 (91.9950%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1683, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3740/3910 (95.6522%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3215/3910 (82.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.5825, Accuracy: 4827/10000 (48.2700%)
time spent on training: 268.9478907585144
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4852, Accuracy: 6385/10000 (63.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0233, Accuracy: 9835/9900 (99.3434%)
Done in 310.77268075942993 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 77, 41, 51, 7, 32, 44, 67, 5, 85, 49, 55, 64, 35, 95, 4, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 44.689703016064705.
Norm before scaling: 44.64457346031122. Distance: 1.1518058944066454
Total norm for 4 adversaries is: 44.64457346031122. distance: 1.1518058944066454
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0427, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5677/5777 (98.2690%), train_poison_data_count: 455
Global model norm: 44.689703016064705.
Norm before scaling: 44.63961185190864. Distance: 1.1833717465322224
Total norm for 4 adversaries is: 44.63961185190864. distance: 1.1833717465322224
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0526, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.689703016064705.
Norm before scaling: 44.647896841652155. Distance: 1.217109897083778
Total norm for 4 adversaries is: 44.647896841652155. distance: 1.217109897083778
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0567, Accuracy: 9758/9900 (98.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5387/5503 (97.8921%), train_poison_data_count: 430
Global model norm: 44.689703016064705.
Norm before scaling: 44.64440530239693. Distance: 1.1894521227802632
Total norm for 4 adversaries is: 44.64440530239693. distance: 1.1894521227802632
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0387, Accuracy: 9803/9900 (99.0202%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4637/5050 (91.8218%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4545/5050 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0124, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4485/4714 (95.1421%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4335/4714 (91.9601%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3078, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3896/4108 (94.8393%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3785/4108 (92.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1431, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4483/4869 (92.0723%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4117/4869 (84.5554%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3466, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5410/6080 (88.9803%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5252/6080 (86.3816%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3922, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4853/5075 (95.6256%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4712/5075 (92.8473%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0560, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5157/5559 (92.7685%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4896/5559 (88.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1450, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4722/4993 (94.5724%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4592/4993 (91.9688%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0498, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6275/6947 (90.3268%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 6000/6947 (86.3682%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3307, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5147/5652 (91.0651%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4998/5652 (88.4289%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.5279, Accuracy: 4841/10000 (48.4100%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4491/4731 (94.9271%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4464/4731 (94.3564%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9354, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4504/4894 (92.0311%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4316/4894 (88.1896%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1918, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5222/5615 (93.0009%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5184/5615 (92.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1853, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4652/5018 (92.7063%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4479/5018 (89.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2212, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3796/4028 (94.2403%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3752/4028 (93.1480%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9769, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4713/5123 (91.9969%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4402/5123 (85.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3485, Accuracy: 5099/10000 (50.9900%)
time spent on training: 265.10614109039307
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4774, Accuracy: 6390/10000 (63.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0250, Accuracy: 9831/9900 (99.3030%)
Done in 303.57067942619324 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 17, 70, 42, 31, 21, 82, 84, 28, 86, 67, 5, 85, 95, 74, 38, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 44.71022832195741.
Norm before scaling: 44.66435425499427. Distance: 1.1224973710842825
Total norm for 4 adversaries is: 44.66435425499427. distance: 1.1224973710842825
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0609, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 44.71022832195741.
Norm before scaling: 44.65952057871101. Distance: 1.1856841207432691
Total norm for 4 adversaries is: 44.65952057871101. distance: 1.1856841207432691
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0556, Accuracy: 9762/9900 (98.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.71022832195741.
Norm before scaling: 44.66779094438813. Distance: 1.1652354021416338
Total norm for 4 adversaries is: 44.66779094438813. distance: 1.1652354021416338
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0129, Accuracy: 9867/9900 (99.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 44.71022832195741.
Norm before scaling: 44.66403448595413. Distance: 1.159725790088112
Total norm for 4 adversaries is: 44.66403448595413. distance: 1.159725790088112
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0464, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4546/4903 (92.7187%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4540/4903 (92.5964%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0824, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5549/5871 (94.5154%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5343/5871 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1484, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5434/5907 (91.9926%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5270/5907 (89.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.6169, Accuracy: 4750/10000 (47.5000%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4263/4537 (93.9608%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4225/4537 (93.1232%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9192, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4674/5038 (92.7749%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4662/5038 (92.5367%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9580, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4997/5298 (94.3186%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4936/5298 (93.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1311, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4852/5209 (93.1465%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4754/5209 (91.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2324, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4716/5122 (92.0734%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4111/5122 (80.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4824, Accuracy: 4834/10000 (48.3400%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3617/3929 (92.0590%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3597/3929 (91.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9871, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5128/5559 (92.2468%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4907/5559 (88.2713%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3069, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4714/4993 (94.4122%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4622/4993 (92.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1842, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6357/6947 (91.5071%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 6032/6947 (86.8288%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3394, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4573/5018 (91.1319%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4391/5018 (87.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2300, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4480/4797 (93.3917%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4423/4797 (92.2035%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9212, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5694/6235 (91.3232%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5453/6235 (87.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3519, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5065/5461 (92.7486%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4942/5461 (90.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1834, Accuracy: 5312/10000 (53.1200%)
time spent on training: 258.5652406215668
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4855, Accuracy: 6365/10000 (63.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0241, Accuracy: 9836/9900 (99.3535%)
Done in 294.0848400592804 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 87, 92, 52, 89, 22, 93, 78, 49, 39, 82, 35, 94, 38, 61, 32, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 44.73030756700721.
Norm before scaling: 44.68373836877768. Distance: 1.1235819992917229
Total norm for 4 adversaries is: 44.68373836877768. distance: 1.1235819992917229
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0589, Accuracy: 9764/9900 (98.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.73030756700721.
Norm before scaling: 44.679805664077. Distance: 1.1882004428853068
Total norm for 4 adversaries is: 44.679805664077. distance: 1.1882004428853068
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0514, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5012/5123 (97.8333%), train_poison_data_count: 403
Global model norm: 44.73030756700721.
Norm before scaling: 44.68772945745286. Distance: 1.1722380012326052
Total norm for 4 adversaries is: 44.68772945745286. distance: 1.1722380012326052
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0625, Accuracy: 9740/9900 (98.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.73030756700721.
Norm before scaling: 44.68485432509193. Distance: 1.1792239863793859
Total norm for 4 adversaries is: 44.68485432509193. distance: 1.1792239863793859
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0555, Accuracy: 9763/9900 (98.6162%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3689/3995 (92.3404%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3620/3995 (90.6133%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1988, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6386/6812 (93.7463%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6263/6812 (91.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0884, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3915/4130 (94.7942%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3889/4130 (94.1646%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8865, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4403/4737 (92.9491%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4377/4737 (92.4003%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2601, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5310/5696 (93.2233%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5176/5696 (90.8708%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0353, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4729/5055 (93.5509%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4548/5055 (89.9703%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1837, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4179/4368 (95.6731%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4145/4368 (94.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0108, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5215/5652 (92.2682%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5018/5652 (88.7827%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2638, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3943/4175 (94.4431%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3871/4175 (92.7186%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9712, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5024/5298 (94.8282%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4891/5298 (92.3179%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1955, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5266/5615 (93.7845%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5127/5615 (91.3090%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2753, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4827/5224 (92.4005%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4788/5224 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2738, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5729/6235 (91.8845%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5468/6235 (87.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3032, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4211/4485 (93.8907%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3776/4485 (84.1918%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.6682, Accuracy: 4504/10000 (45.0400%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5449/6080 (89.6217%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5258/6080 (86.4803%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4205, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3895/4108 (94.8150%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3779/4108 (91.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0299, Accuracy: 5529/10000 (55.2900%)
time spent on training: 269.6821656227112
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4896, Accuracy: 6384/10000 (63.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0246, Accuracy: 9834/9900 (99.3333%)
Done in 304.71974992752075 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 8, 12, 68, 28, 34, 90, 64, 6, 54, 43, 77, 76, 83, 84, 52, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5211/5308 (98.1726%), train_poison_data_count: 415
Global model norm: 44.74940260163397.
Norm before scaling: 44.70317961373805. Distance: 1.1147187706250952
Total norm for 4 adversaries is: 44.70317961373805. distance: 1.1147187706250952
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0508, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.74940260163397.
Norm before scaling: 44.7010509939189. Distance: 1.236033424098346
Total norm for 4 adversaries is: 44.7010509939189. distance: 1.236033424098346
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0306, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5002/5123 (97.6381%), train_poison_data_count: 403
Global model norm: 44.74940260163397.
Norm before scaling: 44.70764952199176. Distance: 1.2089043561494845
Total norm for 4 adversaries is: 44.70764952199176. distance: 1.2089043561494845
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0490, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5363/5503 (97.4559%), train_poison_data_count: 430
Global model norm: 44.74940260163397.
Norm before scaling: 44.70633071343895. Distance: 1.2869261638739915
Total norm for 4 adversaries is: 44.70633071343895. distance: 1.2869261638739915
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0505, Accuracy: 9761/9900 (98.5960%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4590/4889 (93.8842%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4514/4889 (92.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9769, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5121/5526 (92.6710%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4891/5526 (88.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1792, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3398/3589 (94.6782%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3329/3589 (92.7556%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0226, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4695/5122 (91.6634%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   2,  Average loss: 0.0118, Accuracy: 4007/5122 (78.2312%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.6021, Accuracy: 4620/10000 (46.2000%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4571/4911 (93.0768%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4550/4911 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3455, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4524/4748 (95.2822%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4413/4748 (92.9444%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3925, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4522/4894 (92.3989%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4396/4894 (89.8243%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1713, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4695/4929 (95.2526%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4546/4929 (92.2297%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0127, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5200/5645 (92.1169%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4988/5645 (88.3614%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3140, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4639/4979 (93.1713%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4581/4979 (92.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0756, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4662/5050 (92.3168%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4506/5050 (89.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0625, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3683/3959 (93.0285%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3618/3959 (91.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0338, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3318/3552 (93.4122%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3334/3552 (93.8626%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9715, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4817/5209 (92.4746%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4695/5209 (90.1325%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1075, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3916/4130 (94.8184%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3769/4130 (91.2591%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0972, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3881/4086 (94.9829%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3824/4086 (93.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1249, Accuracy: 5435/10000 (54.3500%)
time spent on training: 266.612655878067
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.5003, Accuracy: 6350/10000 (63.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0234, Accuracy: 9838/9900 (99.3737%)
Done in 300.0960557460785 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 90, 6, 39, 89, 88, 7, 3, 94, 74, 66, 25, 96, 31, 98, 78, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.76640760659716.
Norm before scaling: 44.7220583157797. Distance: 1.149505481957451
Total norm for 4 adversaries is: 44.7220583157797. distance: 1.149505481957451
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0235, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5682/5777 (98.3555%), train_poison_data_count: 455
Global model norm: 44.76640760659716.
Norm before scaling: 44.71473574531597. Distance: 1.1692295987590537
Total norm for 4 adversaries is: 44.71473574531597. distance: 1.1692295987590537
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0173, Accuracy: 9857/9900 (99.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5021/5123 (98.0090%), train_poison_data_count: 403
Global model norm: 44.76640760659716.
Norm before scaling: 44.720618464197386. Distance: 1.120707109616397
Total norm for 4 adversaries is: 44.720618464197386. distance: 1.120707109616397
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0988, Accuracy: 9633/9900 (97.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 44.76640760659716.
Norm before scaling: 44.7203905403131. Distance: 1.167300080738769
Total norm for 4 adversaries is: 44.7203905403131. distance: 1.167300080738769
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0470, Accuracy: 9779/9900 (98.7778%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4557/4748 (95.9773%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4458/4748 (93.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9450, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4668/4929 (94.7048%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4519/4929 (91.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0754, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3910/4175 (93.6527%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3876/4175 (92.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0223, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4415/4737 (93.2024%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4286/4737 (90.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4559, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5022/5362 (93.6591%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4868/5362 (90.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2255, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4511/4869 (92.6474%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4024/4869 (82.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5436, Accuracy: 4847/10000 (48.4700%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5064/5346 (94.7250%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4985/5346 (93.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0055, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4792/5224 (91.7305%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4791/5224 (91.7113%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0930, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4460/4797 (92.9748%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4352/4797 (90.7234%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0491, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4547/4843 (93.8881%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4481/4843 (92.5253%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1341, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5810/6419 (90.5125%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5461/6419 (85.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.7619, Accuracy: 4720/10000 (47.2000%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4765/5086 (93.6886%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4659/5086 (91.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0077, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4278/4537 (94.2914%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4211/4537 (92.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8873, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3973/4161 (95.4819%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3859/4161 (92.7421%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9943, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4162/4368 (95.2839%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4125/4368 (94.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0224, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4631/4911 (94.2985%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4553/4911 (92.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1470, Accuracy: 5336/10000 (53.3600%)
time spent on training: 269.77368927001953
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5150, Accuracy: 6330/10000 (63.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0223, Accuracy: 9841/9900 (99.4040%)
Done in 308.81213665008545 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 44, 82, 1, 10, 89, 11, 87, 28, 22, 78, 31, 79, 27, 46, 35, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5211/5308 (98.1726%), train_poison_data_count: 415
Global model norm: 44.784127121025676.
Norm before scaling: 44.739597581972895. Distance: 1.1706071225586883
Total norm for 4 adversaries is: 44.739597581972895. distance: 1.1706071225586883
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0341, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5686/5777 (98.4248%), train_poison_data_count: 455
Global model norm: 44.784127121025676.
Norm before scaling: 44.73360957038133. Distance: 1.1878921965388272
Total norm for 4 adversaries is: 44.73360957038133. distance: 1.1878921965388272
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0546, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4986/5123 (97.3258%), train_poison_data_count: 403
Global model norm: 44.784127121025676.
Norm before scaling: 44.74236688566274. Distance: 1.2253493608817767
Total norm for 4 adversaries is: 44.74236688566274. distance: 1.2253493608817767
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0345, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5383/5503 (97.8194%), train_poison_data_count: 430
Global model norm: 44.784127121025676.
Norm before scaling: 44.73876812169592. Distance: 1.1868923539936411
Total norm for 4 adversaries is: 44.73876812169592. distance: 1.1868923539936411
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0627, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4816/5075 (94.8966%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4677/5075 (92.1576%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1133, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5036/5298 (95.0547%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4965/5298 (93.7146%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1200, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5180/5422 (95.5367%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5073/5422 (93.5633%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0464, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4840/5068 (95.5012%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4585/5068 (90.4696%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2424, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4442/4737 (93.7724%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4336/4737 (91.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1469, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5067/5702 (88.8636%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   2,  Average loss: 0.0107, Accuracy: 4518/5702 (79.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4242, Accuracy: 4779/10000 (47.7900%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3720/3995 (93.1164%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3557/3995 (89.0363%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3665, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4657/5122 (90.9215%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3999/5122 (78.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.5711, Accuracy: 4539/10000 (45.3900%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5333/5696 (93.6271%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5257/5696 (92.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0589, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4168/4368 (95.4212%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4044/4368 (92.5824%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0910, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4287/4537 (94.4898%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4279/4537 (94.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0444, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3862/4111 (93.9431%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3762/4111 (91.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0162, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4289/4587 (93.5034%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4251/4587 (92.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9801, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4856/5399 (89.9426%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4678/5399 (86.6457%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3568, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5265/5615 (93.7667%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5160/5615 (91.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2819, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4431/4714 (93.9966%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4410/4714 (93.5511%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1232, Accuracy: 5446/10000 (54.4600%)
time spent on training: 261.5100131034851
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5171, Accuracy: 6322/10000 (63.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0222, Accuracy: 9842/9900 (99.4141%)
Done in 296.91799545288086 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 50, 45, 74, 0, 54, 55, 59, 96, 81, 75, 98, 14, 62, 25, 73, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 44.80229055816022.
Norm before scaling: 44.75562033709077. Distance: 1.1154533211394058
Total norm for 4 adversaries is: 44.75562033709077. distance: 1.1154533211394058
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0431, Accuracy: 9785/9900 (98.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 44.80229055816022.
Norm before scaling: 44.75588762988689. Distance: 1.3187721340979566
Total norm for 4 adversaries is: 44.75588762988689. distance: 1.3187721340979566
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0493, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5012/5123 (97.8333%), train_poison_data_count: 403
Global model norm: 44.80229055816022.
Norm before scaling: 44.75873774462577. Distance: 1.178846501580004
Total norm for 4 adversaries is: 44.75873774462577. distance: 1.178846501580004
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0536, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5396/5503 (98.0556%), train_poison_data_count: 430
Global model norm: 44.80229055816022.
Norm before scaling: 44.75656403717853. Distance: 1.204680094219951
Total norm for 4 adversaries is: 44.75656403717853. distance: 1.204680094219951
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0146, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4473/4757 (94.0299%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4379/4757 (92.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1033, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5094/5489 (92.8038%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5031/5489 (91.6560%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3036, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4513/4797 (94.0796%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4455/4797 (92.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0512, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5090/5454 (93.3260%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4818/5454 (88.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1444, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5151/5645 (91.2489%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4970/5645 (88.0425%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1924, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4487/4731 (94.8425%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4423/4731 (93.4897%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0347, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4192/4397 (95.3377%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4191/4397 (95.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8634, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4770/5086 (93.7869%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4698/5086 (92.3712%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1034, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4730/5035 (93.9424%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4671/5035 (92.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1233, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4442/4672 (95.0771%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4412/4672 (94.4349%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8698, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3964/4161 (95.2656%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3807/4161 (91.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2773, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4050/4196 (96.5205%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4006/4196 (95.4719%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8031, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4996/5504 (90.7703%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4740/5504 (86.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3980, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5832/6419 (90.8553%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5494/6419 (85.5897%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2989, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4358/4605 (94.6363%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4307/4605 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0615, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4545/4732 (96.0482%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4500/4732 (95.0972%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8293, Accuracy: 5900/10000 (59.0000%)
time spent on training: 269.27003026008606
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5086, Accuracy: 6333/10000 (63.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0212, Accuracy: 9848/9900 (99.4747%)
Done in 304.98066234588623 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 1, 41, 43, 84, 99, 94, 23, 2, 40, 82, 59, 28, 14, 56, 63, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.8186517852954.
Norm before scaling: 44.77176141405638. Distance: 1.095191550549222
Total norm for 4 adversaries is: 44.77176141405638. distance: 1.095191550549222
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0362, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 44.8186517852954.
Norm before scaling: 44.766902523219514. Distance: 1.1606452502167
Total norm for 4 adversaries is: 44.766902523219514. distance: 1.1606452502167
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0323, Accuracy: 9828/9900 (99.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5004/5123 (97.6771%), train_poison_data_count: 403
Global model norm: 44.8186517852954.
Norm before scaling: 44.7748149925512. Distance: 1.197182731808114
Total norm for 4 adversaries is: 44.7748149925512. distance: 1.197182731808114
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0438, Accuracy: 9783/9900 (98.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.8186517852954.
Norm before scaling: 44.77389757768331. Distance: 1.2335206467346687
Total norm for 4 adversaries is: 44.77389757768331. distance: 1.2335206467346687
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0366, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5158/5422 (95.1309%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5066/5422 (93.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9706, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4472/4714 (94.8664%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4448/4714 (94.3572%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9952, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4700/4979 (94.3965%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4581/4979 (92.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0657, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4816/5209 (92.4554%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4680/5209 (89.8445%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2253, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4454/4851 (91.8161%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4430/4851 (91.3214%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1279, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4865/5224 (93.1279%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4687/5224 (89.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3225, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4306/4549 (94.6582%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3972/4549 (87.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.4117, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3826/3968 (96.4214%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3766/3968 (94.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7867, Accuracy: 5946/10000 (59.4600%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5533/5939 (93.1638%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5467/5939 (92.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3166, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4963/5298 (93.6769%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4936/5298 (93.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0402, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4191/4397 (95.3150%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4203/4397 (95.5879%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8867, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4648/5122 (90.7458%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4131/5122 (80.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3721, Accuracy: 4807/10000 (48.0700%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4050/4196 (96.5205%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3997/4196 (95.2574%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8797, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4968/5427 (91.5423%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4846/5427 (89.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0907, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3729/3910 (95.3708%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3227/3910 (82.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.7163, Accuracy: 4591/10000 (45.9100%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3917/4086 (95.8639%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3882/4086 (95.0073%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0999, Accuracy: 5625/10000 (56.2500%)
time spent on training: 271.27121210098267
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5152, Accuracy: 6319/10000 (63.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0218, Accuracy: 9844/9900 (99.4343%)
Done in 304.73459362983704 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 27, 20, 75, 69, 86, 64, 19, 23, 31, 10, 76, 80, 97, 26, 52, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.835540679329526.
Norm before scaling: 44.78737745936348. Distance: 1.0732069764682906
Total norm for 4 adversaries is: 44.78737745936348. distance: 1.0732069764682906
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0168, Accuracy: 9853/9900 (99.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.835540679329526.
Norm before scaling: 44.785326434750786. Distance: 1.1917255411520997
Total norm for 4 adversaries is: 44.785326434750786. distance: 1.1917255411520997
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0230, Accuracy: 9846/9900 (99.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5021/5123 (98.0090%), train_poison_data_count: 403
Global model norm: 44.835540679329526.
Norm before scaling: 44.792758737898275. Distance: 1.2027616571477178
Total norm for 4 adversaries is: 44.792758737898275. distance: 1.2027616571477178
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0205, Accuracy: 9841/9900 (99.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5385/5503 (97.8557%), train_poison_data_count: 430
Global model norm: 44.835540679329526.
Norm before scaling: 44.79076791733984. Distance: 1.2407028154620554
Total norm for 4 adversaries is: 44.79076791733984. distance: 1.2407028154620554
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0306, Accuracy: 9823/9900 (99.2222%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4304/4587 (93.8304%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4256/4587 (92.7840%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9450, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4469/4714 (94.8027%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4449/4714 (94.3784%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9055, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4420/4672 (94.6062%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4369/4672 (93.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0053, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4065/4364 (93.1485%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3892/4364 (89.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3911, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3669/3929 (93.3825%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3601/3929 (91.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9199, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4529/4894 (92.5419%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4328/4894 (88.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2966, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5361 (92.1097%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4808/5361 (89.6848%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3529, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4333/4549 (95.2517%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3796/4549 (83.4469%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3489, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4271/4537 (94.1371%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4210/4537 (92.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9166, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4851/5068 (95.7182%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4735/5068 (93.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1913, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3626/3959 (91.5888%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3559/3959 (89.8964%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0912, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5096/5461 (93.3162%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4980/5461 (91.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4458, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4379/4736 (92.4620%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4293/4736 (90.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1109, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3870/4086 (94.7137%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3841/4086 (94.0039%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0780, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3872/4130 (93.7530%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3861/4130 (93.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0837, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4173/4368 (95.5357%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4154/4368 (95.1007%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9449, Accuracy: 5778/10000 (57.7800%)
time spent on training: 257.2776229381561
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5279, Accuracy: 6299/10000 (62.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0206, Accuracy: 9846/9900 (99.4545%)
Done in 295.18922781944275 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 46, 98, 55, 51, 80, 4, 97, 11, 35, 61, 86, 6, 83, 73, 84, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5222/5308 (98.3798%), train_poison_data_count: 415
Global model norm: 44.85193196263958.
Norm before scaling: 44.80601226790399. Distance: 1.1428519678850175
Total norm for 4 adversaries is: 44.80601226790399. distance: 1.1428519678850175
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0289, Accuracy: 9827/9900 (99.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 44.85193196263958.
Norm before scaling: 44.80177832207459. Distance: 1.207456742137751
Total norm for 4 adversaries is: 44.80177832207459. distance: 1.207456742137751
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0398, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.85193196263958.
Norm before scaling: 44.80808005355661. Distance: 1.1728871869752293
Total norm for 4 adversaries is: 44.80808005355661. distance: 1.1728871869752293
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0560, Accuracy: 9746/9900 (98.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 44.85193196263958.
Norm before scaling: 44.80389806954929. Distance: 1.1323112694319386
Total norm for 4 adversaries is: 44.80389806954929. distance: 1.1323112694319386
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0626, Accuracy: 9731/9900 (98.2929%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4904/5399 (90.8316%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4676/5399 (86.6086%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2735, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3951/4161 (94.9531%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3872/4161 (93.0546%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9171, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4500/4731 (95.1173%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4409/4731 (93.1938%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9688, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3920/4108 (95.4236%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3842/4108 (93.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9120, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5049/5461 (92.4556%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4894/5461 (89.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1872, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3790/4028 (94.0914%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3754/4028 (93.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0026, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4407/4736 (93.0532%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4311/4736 (91.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9858, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5093/5702 (89.3195%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4597/5702 (80.6208%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.6403, Accuracy: 4477/10000 (44.7700%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5265/5615 (93.7667%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5167/5615 (92.0214%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1898, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4199/4485 (93.6232%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4044/4485 (90.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0067, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3621/3929 (92.1609%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3530/3929 (89.8447%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0348, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4695/4929 (95.2526%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4607/4929 (93.4672%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1576, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3318/3552 (93.4122%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3341/3552 (94.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8081, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4412/4605 (95.8089%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4361/4605 (94.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9402, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4868/5209 (93.4536%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4687/5209 (89.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1799, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4495/4869 (92.3188%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3955/4869 (81.2282%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5083, Accuracy: 4779/10000 (47.7900%)
time spent on training: 258.6150212287903
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5274, Accuracy: 6309/10000 (63.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0211, Accuracy: 9844/9900 (99.4343%)
Done in 294.64216446876526 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 14, 5, 1, 61, 91, 75, 59, 44, 12, 38, 53, 74, 20, 89, 0, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5230/5308 (98.5305%), train_poison_data_count: 415
Global model norm: 44.86860972519513.
Norm before scaling: 44.82320141138543. Distance: 1.1434507510076062
Total norm for 4 adversaries is: 44.82320141138543. distance: 1.1434507510076062
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0361, Accuracy: 9803/9900 (99.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5680/5777 (98.3209%), train_poison_data_count: 455
Global model norm: 44.86860972519513.
Norm before scaling: 44.81600840520048. Distance: 1.181024109974631
Total norm for 4 adversaries is: 44.81600840520048. distance: 1.181024109974631
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0067, Accuracy: 9882/9900 (99.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.86860972519513.
Norm before scaling: 44.82535827119093. Distance: 1.2224201791053915
Total norm for 4 adversaries is: 44.82535827119093. distance: 1.2224201791053915
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0530, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.86860972519513.
Norm before scaling: 44.82194319523502. Distance: 1.185261322775238
Total norm for 4 adversaries is: 44.82194319523502. distance: 1.185261322775238
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0267, Accuracy: 9836/9900 (99.3535%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4008/4196 (95.5195%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3956/4196 (94.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9253, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4743/4993 (94.9930%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4609/4993 (92.3092%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1553, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5192/5422 (95.7580%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5036/5422 (92.8809%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0221, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4194/4485 (93.5117%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3686/4485 (82.1851%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3908, Accuracy: 4846/10000 (48.4600%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4185/4527 (92.4453%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4053/4527 (89.5295%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2985, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4430/4672 (94.8202%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4347/4672 (93.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9795, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4221/4397 (95.9973%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4188/4397 (95.2468%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8427, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4816/5075 (94.8966%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4683/5075 (92.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0037, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5126/5526 (92.7615%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4915/5526 (88.9432%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4692, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5670/6235 (90.9383%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5484/6235 (87.9551%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3281, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6024/6664 (90.3962%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5620/6664 (84.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3046, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4483/4797 (93.4542%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4383/4797 (91.3696%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1450, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4531/4714 (96.1179%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4481/4714 (95.0573%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9393, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4443/4737 (93.7935%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4341/4737 (91.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3505, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5077/5454 (93.0876%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4892/5454 (89.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1209, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4530/4869 (93.0376%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4223/4869 (86.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4261, Accuracy: 5076/10000 (50.7600%)
time spent on training: 274.9774487018585
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5541, Accuracy: 6260/10000 (62.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0193, Accuracy: 9851/9900 (99.5051%)
Done in 310.4702241420746 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 17, 26, 15, 18, 38, 29, 82, 21, 84, 80, 85, 11, 12, 88, 89, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 44.886725378828594.
Norm before scaling: 44.84016073397192. Distance: 1.1409500390531109
Total norm for 4 adversaries is: 44.84016073397192. distance: 1.1409500390531109
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0672, Accuracy: 9709/9900 (98.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5679/5777 (98.3036%), train_poison_data_count: 455
Global model norm: 44.886725378828594.
Norm before scaling: 44.83581430219178. Distance: 1.2191289165977193
Total norm for 4 adversaries is: 44.83581430219178. distance: 1.2191289165977193
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0375, Accuracy: 9817/9900 (99.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5018/5123 (97.9504%), train_poison_data_count: 403
Global model norm: 44.886725378828594.
Norm before scaling: 44.84160763610762. Distance: 1.1464805278031172
Total norm for 4 adversaries is: 44.84160763610762. distance: 1.1464805278031172
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0330, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.886725378828594.
Norm before scaling: 44.840072257726405. Distance: 1.1965068260823903
Total norm for 4 adversaries is: 44.840072257726405. distance: 1.1965068260823903
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0368, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4510/4903 (91.9845%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4440/4903 (90.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2551, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3922/4086 (95.9863%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3922/4086 (95.9863%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8241, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5653/6068 (93.1608%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5592/6068 (92.1556%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3305, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4009/4249 (94.3516%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3977/4249 (93.5985%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8957, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5719/6235 (91.7241%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5516/6235 (88.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.6225, Accuracy: 4817/10000 (48.1700%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4457/4732 (94.1885%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4424/4732 (93.4911%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9252, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5026/5298 (94.8660%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4970/5298 (93.8090%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0507, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4687/5038 (93.0329%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4617/5038 (91.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0005, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4877/5209 (93.6264%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4688/5209 (89.9981%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2343, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5125/5461 (93.8473%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4976/5461 (91.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0910, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6341/6947 (91.2768%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5903/6947 (84.9719%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1993, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5147/5702 (90.2666%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4585/5702 (80.4104%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2598, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5101/5526 (92.3091%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4879/5526 (88.2917%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2917, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4984/5362 (92.9504%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4821/5362 (89.9105%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2197, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4372/4737 (92.2947%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4280/4737 (90.3525%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.5939, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5272/5727 (92.0552%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5070/5727 (88.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1585, Accuracy: 5324/10000 (53.2400%)
time spent on training: 276.99918270111084
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5639, Accuracy: 6260/10000 (62.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0184, Accuracy: 9854/9900 (99.5354%)
Done in 310.55211663246155 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 7, 34, 31, 64, 77, 29, 99, 0, 33, 46, 72, 22, 88, 80, 11, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5235/5308 (98.6247%), train_poison_data_count: 415
Global model norm: 44.906131752192955.
Norm before scaling: 44.8583790380557. Distance: 1.0753792337797408
Total norm for 4 adversaries is: 44.8583790380557. distance: 1.0753792337797408
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0638, Accuracy: 9731/9900 (98.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 44.906131752192955.
Norm before scaling: 44.85441674096181. Distance: 1.1610661801147786
Total norm for 4 adversaries is: 44.85441674096181. distance: 1.1610661801147786
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0469, Accuracy: 9777/9900 (98.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4972/5123 (97.0525%), train_poison_data_count: 403
Global model norm: 44.906131752192955.
Norm before scaling: 44.86610668753057. Distance: 1.2812366950111866
Total norm for 4 adversaries is: 44.86610668753057. distance: 1.2812366950111866
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1717, Accuracy: 9416/9900 (95.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.906131752192955.
Norm before scaling: 44.85875864910957. Distance: 1.1900028154997015
Total norm for 4 adversaries is: 44.85875864910957. distance: 1.1900028154997015
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0156, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4534/4869 (93.1197%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4333/4869 (88.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3540, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4598/4911 (93.6266%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4586/4911 (93.3822%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9965, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4277/4537 (94.2693%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4240/4537 (93.4538%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9692, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4524/4894 (92.4397%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4357/4894 (89.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3411, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4657/5050 (92.2178%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4516/5050 (89.4257%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1151, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4505/4732 (95.2029%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4490/4732 (94.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8098, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4510/4851 (92.9705%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4422/4851 (91.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8954, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5126/5454 (93.9861%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4934/5454 (90.4657%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0933, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4533/4818 (94.0847%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4342/4818 (90.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3074, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4925/5399 (91.2206%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4722/5399 (87.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3607, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4826/5193 (92.9328%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4571/5193 (88.0223%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4500, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5391/5696 (94.6454%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5203/5696 (91.3448%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1042, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5010/5362 (93.4353%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4894/5362 (91.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1481, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5145/5461 (94.2135%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5035/5461 (92.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2127, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5043/5702 (88.4427%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4616/5702 (80.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.6748, Accuracy: 4758/10000 (47.5800%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4613/4830 (95.5072%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4496/4830 (93.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1588, Accuracy: 5422/10000 (54.2200%)
time spent on training: 273.1073021888733
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5840, Accuracy: 6227/10000 (62.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0192, Accuracy: 9849/9900 (99.4848%)
Done in 314.88803935050964 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 31, 7, 49, 8, 57, 89, 19, 42, 51, 98, 15, 35, 76, 48, 75, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5239/5308 (98.7001%), train_poison_data_count: 415
Global model norm: 44.92528383805368.
Norm before scaling: 44.87533866733278. Distance: 1.0570356438003423
Total norm for 4 adversaries is: 44.87533866733278. distance: 1.0570356438003423
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0350, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.92528383805368.
Norm before scaling: 44.87211510356056. Distance: 1.1822179975818579
Total norm for 4 adversaries is: 44.87211510356056. distance: 1.1822179975818579
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0113, Accuracy: 9869/9900 (99.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.92528383805368.
Norm before scaling: 44.88074883745744. Distance: 1.1719859261465175
Total norm for 4 adversaries is: 44.88074883745744. distance: 1.1719859261465175
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0230, Accuracy: 9834/9900 (99.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5404/5503 (98.2010%), train_poison_data_count: 430
Global model norm: 44.92528383805368.
Norm before scaling: 44.876683790659875. Distance: 1.1662212043633549
Total norm for 4 adversaries is: 44.876683790659875. distance: 1.1662212043633549
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0683, Accuracy: 9724/9900 (98.2222%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4306/4537 (94.9085%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4256/4537 (93.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8833, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4549/4869 (93.4278%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   2,  Average loss: 0.0113, Accuracy: 3816/4869 (78.3734%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.7114, Accuracy: 4585/10000 (45.8500%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5179/5652 (91.6313%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5058/5652 (89.4904%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4224, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4568/4889 (93.4342%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4548/4889 (93.0252%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9549, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4641/4956 (93.6441%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4514/4956 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1886, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4374/4737 (92.3369%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4300/4737 (90.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3423, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4989/5361 (93.0610%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4830/5361 (90.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1927, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5442/5907 (92.1280%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5299/5907 (89.7071%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4312, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3896/4108 (94.8393%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3819/4108 (92.9649%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0262, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3932/4161 (94.4965%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3851/4161 (92.5499%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0737, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5661/6068 (93.2927%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5513/6068 (90.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3024, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5262/5615 (93.7133%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5119/5615 (91.1665%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1270, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3644/3959 (92.0434%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3600/3959 (90.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0678, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4607/4830 (95.3830%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4556/4830 (94.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0531, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4441/4672 (95.0557%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4402/4672 (94.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9446, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5151/5559 (92.6606%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4801/5559 (86.3645%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3838, Accuracy: 5022/10000 (50.2200%)
time spent on training: 259.61831164360046
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5949, Accuracy: 6192/10000 (61.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0164, Accuracy: 9859/9900 (99.5859%)
Done in 297.37166476249695 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 21, 78, 19, 42, 25, 70, 73, 31, 96, 99, 88, 18, 0, 54, 32, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.943243558977386.
Norm before scaling: 44.894325791588074. Distance: 1.0850880545821613
Total norm for 4 adversaries is: 44.894325791588074. distance: 1.0850880545821613
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0366, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5692/5777 (98.5286%), train_poison_data_count: 455
Global model norm: 44.943243558977386.
Norm before scaling: 44.89019535123316. Distance: 1.141739966598805
Total norm for 4 adversaries is: 44.89019535123316. distance: 1.141739966598805
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0164, Accuracy: 9861/9900 (99.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.943243558977386.
Norm before scaling: 44.90034946229191. Distance: 1.2197895507186054
Total norm for 4 adversaries is: 44.90034946229191. distance: 1.2197895507186054
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0974, Accuracy: 9635/9900 (97.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5409/5503 (98.2918%), train_poison_data_count: 430
Global model norm: 44.943243558977386.
Norm before scaling: 44.89484784784608. Distance: 1.1653670099613207
Total norm for 4 adversaries is: 44.89484784784608. distance: 1.1653670099613207
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0378, Accuracy: 9803/9900 (99.0202%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4676/5038 (92.8146%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4652/5038 (92.3382%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9858, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4204/4368 (96.2454%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4159/4368 (95.2152%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9012, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4903/5361 (91.4568%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4827/5361 (90.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1235, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5514/5907 (93.3469%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5365/5907 (90.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.5749, Accuracy: 4778/10000 (47.7800%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5874/6419 (91.5096%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5581/6419 (86.9450%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4166, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5510/5871 (93.8511%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5428/5871 (92.4544%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2109, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4420/4605 (95.9826%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4364/4605 (94.7666%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9254, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4304/4537 (94.8644%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4288/4537 (94.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9650, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4782/5086 (94.0228%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4686/5086 (92.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0517, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4548/4851 (93.7539%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4487/4851 (92.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0627, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5047/5362 (94.1253%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4835/5362 (90.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2859, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4037/4249 (95.0106%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3894/4249 (91.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9736, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5106/5454 (93.6194%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4820/5454 (88.3755%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.5481, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5184/5645 (91.8335%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4958/5645 (87.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2204, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5474/6080 (90.0329%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5325/6080 (87.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2503, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5112/5489 (93.1317%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5070/5489 (92.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1730, Accuracy: 5317/10000 (53.1700%)
time spent on training: 276.00076723098755
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5966, Accuracy: 6200/10000 (62.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0151, Accuracy: 9861/9900 (99.6061%)
Done in 316.18125796318054 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 84, 48, 20, 55, 59, 40, 92, 0, 16, 85, 82, 90, 52, 6, 15, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5216/5308 (98.2668%), train_poison_data_count: 415
Global model norm: 44.961747250527445.
Norm before scaling: 44.91307386609786. Distance: 1.0885895105582997
Total norm for 4 adversaries is: 44.91307386609786. distance: 1.0885895105582997
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0340, Accuracy: 9812/9900 (99.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.961747250527445.
Norm before scaling: 44.90967497377375. Distance: 1.1900467917915842
Total norm for 4 adversaries is: 44.90967497377375. distance: 1.1900467917915842
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0226, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.961747250527445.
Norm before scaling: 44.916013204507585. Distance: 1.1438313189505516
Total norm for 4 adversaries is: 44.916013204507585. distance: 1.1438313189505516
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0530, Accuracy: 9761/9900 (98.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5394/5503 (98.0193%), train_poison_data_count: 430
Global model norm: 44.961747250527445.
Norm before scaling: 44.913697625279084. Distance: 1.169599281630837
Total norm for 4 adversaries is: 44.913697625279084. distance: 1.169599281630837
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0508, Accuracy: 9764/9900 (98.6263%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4866/5209 (93.4152%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4743/5209 (91.0539%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0742, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4610/4830 (95.4451%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4549/4830 (94.1822%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0501, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4520/4714 (95.8846%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4463/4714 (94.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0244, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4527/4731 (95.6880%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4450/4731 (94.0605%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9737, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4230/4397 (96.2020%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8513, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5596/5939 (94.2246%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5452/5939 (91.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3133, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   1,  Average loss: 0.0028, Accuracy: 6439/6812 (94.5244%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6261/6812 (91.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3121, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5061/5454 (92.7943%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4901/5454 (89.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0885, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5025/5353 (93.8726%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4841/5353 (90.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1612, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6328/6947 (91.0897%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5998/6947 (86.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.5266, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5057/5298 (95.4511%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   2,  Average loss: 0.0028, Accuracy: 5002/5298 (94.4130%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0699, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4531/4748 (95.4297%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4361/4748 (91.8492%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9779, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3932/4130 (95.2058%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3846/4130 (93.1235%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0694, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4684/4929 (95.0294%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4537/4929 (92.0471%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2536, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5678/6068 (93.5728%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5584/6068 (92.0237%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2494, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4430/4736 (93.5389%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4319/4736 (91.1951%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1539, Accuracy: 5427/10000 (54.2700%)
time spent on training: 271.81519746780396
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.6201, Accuracy: 6149/10000 (61.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0146, Accuracy: 9862/9900 (99.6162%)
Done in 313.7165331840515 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 57, 62, 61, 67, 3, 82, 69, 93, 42, 76, 7, 94, 14, 21, 32, 25].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5239/5308 (98.7001%), train_poison_data_count: 415
Global model norm: 44.97925275847674.
Norm before scaling: 44.929703122280365. Distance: 1.0517202953281364
Total norm for 4 adversaries is: 44.929703122280365. distance: 1.0517202953281364
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0574, Accuracy: 9743/9900 (98.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5660/5777 (97.9747%), train_poison_data_count: 455
Global model norm: 44.97925275847674.
Norm before scaling: 44.93006175400552. Distance: 1.2964046498583366
Total norm for 4 adversaries is: 44.93006175400552. distance: 1.2964046498583366
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0075, Accuracy: 9877/9900 (99.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.97925275847674.
Norm before scaling: 44.935279250151126. Distance: 1.1949814481372554
Total norm for 4 adversaries is: 44.935279250151126. distance: 1.1949814481372554
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0835, Accuracy: 9678/9900 (97.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5425/5503 (98.5826%), train_poison_data_count: 430
Global model norm: 44.97925275847674.
Norm before scaling: 44.93157096447817. Distance: 1.1604277424766
Total norm for 4 adversaries is: 44.93157096447817. distance: 1.1604277424766
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0284, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4686/4956 (94.5521%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4522/4956 (91.2429%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1662, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4993/5504 (90.7158%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4836/5504 (87.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2327, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4147/4485 (92.4638%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3881/4485 (86.5329%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2410, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5114/5559 (91.9950%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4937/5559 (88.8109%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3271, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5040/5346 (94.2761%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5036/5346 (94.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0986, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5038/5298 (95.0925%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4934/5298 (93.1295%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0987, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4121/4364 (94.4317%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3928/4364 (90.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1276, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4700/5055 (92.9773%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4581/5055 (90.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1721, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5463/5907 (92.4835%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5323/5907 (90.1134%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4567, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3658/3959 (92.3971%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3656/3959 (92.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9316, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4547/4869 (93.3867%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4071/4869 (83.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4274, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4875/5224 (93.3193%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4760/5224 (91.1179%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4000, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4053/4196 (96.5920%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4004/4196 (95.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8566, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4717/5038 (93.6284%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4671/5038 (92.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0185, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5443/6080 (89.5230%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5353/6080 (88.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1383, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5833/6419 (90.8709%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5515/6419 (85.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2778, Accuracy: 5164/10000 (51.6400%)
time spent on training: 277.3340139389038
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.6265, Accuracy: 6154/10000 (61.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0152, Accuracy: 9860/9900 (99.5960%)
Done in 314.01364755630493 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 19, 16, 82, 89, 45, 31, 91, 9, 44, 66, 11, 76, 92, 37, 54, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5241/5308 (98.7378%), train_poison_data_count: 415
Global model norm: 44.99884031708831.
Norm before scaling: 44.94996811777582. Distance: 1.0587354614448605
Total norm for 4 adversaries is: 44.94996811777582. distance: 1.0587354614448605
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0549, Accuracy: 9759/9900 (98.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5690/5777 (98.4940%), train_poison_data_count: 455
Global model norm: 44.99884031708831.
Norm before scaling: 44.944586650014095. Distance: 1.1494135439344093
Total norm for 4 adversaries is: 44.944586650014095. distance: 1.1494135439344093
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0401, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5016/5123 (97.9114%), train_poison_data_count: 403
Global model norm: 44.99884031708831.
Norm before scaling: 44.95339654940575. Distance: 1.1497955078256217
Total norm for 4 adversaries is: 44.95339654940575. distance: 1.1497955078256217
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0303, Accuracy: 9818/9900 (99.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5416/5503 (98.4190%), train_poison_data_count: 430
Global model norm: 44.99884031708831.
Norm before scaling: 44.94928240007008. Distance: 1.1334663345796232
Total norm for 4 adversaries is: 44.94928240007008. distance: 1.1334663345796232
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0846, Accuracy: 9675/9900 (97.7273%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4992/5361 (93.1170%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4815/5361 (89.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0986, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5040/5353 (94.1528%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4838/5353 (90.3792%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2582, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5066/5298 (95.6210%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4976/5298 (93.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0647, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4429/4737 (93.4980%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4361/4737 (92.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1981, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5047/5489 (91.9475%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4972/5489 (90.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1772, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4321/4537 (95.2391%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4227/4537 (93.1673%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0155, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4169/4527 (92.0919%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4021/4527 (88.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1569, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5293/5727 (92.4219%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5104/5727 (89.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0327, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4795/5075 (94.4828%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4630/5075 (91.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0748, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4581/4843 (94.5901%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4465/4843 (92.1949%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2255, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5046/5702 (88.4953%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   2,  Average loss: 0.0107, Accuracy: 4537/5702 (79.5686%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.5886, Accuracy: 4651/10000 (46.5100%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3691/3959 (93.2306%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3645/3959 (92.0687%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0172, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6436/6812 (94.4803%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6228/6812 (91.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2583, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4380/4741 (92.3856%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3956/4741 (83.4423%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.8100, Accuracy: 4555/10000 (45.5500%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5113/5645 (90.5757%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4968/5645 (88.0071%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3352, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3722/3910 (95.1918%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3519/3910 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2697, Accuracy: 5290/10000 (52.9000%)
time spent on training: 260.73969626426697
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.6314, Accuracy: 6146/10000 (61.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0157, Accuracy: 9859/9900 (99.5859%)
Done in 296.7157094478607 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 42, 74, 66, 6, 50, 49, 10, 11, 1, 96, 61, 52, 79, 72, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 45.018771855037734.
Norm before scaling: 44.96963493743584. Distance: 1.0932591563063148
Total norm for 4 adversaries is: 44.96963493743584. distance: 1.0932591563063148
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0268, Accuracy: 9840/9900 (99.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5677/5777 (98.2690%), train_poison_data_count: 455
Global model norm: 45.018771855037734.
Norm before scaling: 44.965516844334445. Distance: 1.1664022191381078
Total norm for 4 adversaries is: 44.965516844334445. distance: 1.1664022191381078
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1172, Accuracy: 9604/9900 (97.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5027/5123 (98.1261%), train_poison_data_count: 403
Global model norm: 45.018771855037734.
Norm before scaling: 44.97241857646959. Distance: 1.1186765870456545
Total norm for 4 adversaries is: 44.97241857646959. distance: 1.1186765870456545
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2360, Accuracy: 9277/9900 (93.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 45.018771855037734.
Norm before scaling: 44.971103460826654. Distance: 1.1712338028544051
Total norm for 4 adversaries is: 44.971103460826654. distance: 1.1712338028544051
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0358, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5506/5907 (93.2114%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5340/5907 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3113, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4477/4797 (93.3292%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4426/4797 (92.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1750, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4554/4843 (94.0326%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4506/4843 (93.0415%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1398, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4672/4929 (94.7860%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4548/4929 (92.2702%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0327, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4482/4757 (94.2190%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4350/4757 (91.4442%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0708, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5171/5652 (91.4897%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5038/5652 (89.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2612, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4836/5068 (95.4223%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4631/5068 (91.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3574, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5099/5702 (89.4248%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4597/5702 (80.6208%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3859, Accuracy: 4883/10000 (48.8300%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5211/5422 (96.1084%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   2,  Average loss: 0.0029, Accuracy: 5154/5422 (95.0572%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8855, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4786/5086 (94.1015%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4684/5086 (92.0959%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0696, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4202/4485 (93.6901%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3982/4485 (88.7848%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1665, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3943/4130 (95.4722%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3854/4130 (93.3172%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0074, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3869/4111 (94.1134%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3687/4111 (89.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.5339, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4861/5193 (93.6068%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4648/5193 (89.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4120, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4458/4731 (94.2295%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4427/4731 (93.5743%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2475, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5776/6235 (92.6383%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5505/6235 (88.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4242, Accuracy: 4944/10000 (49.4400%)
time spent on training: 266.71393060684204
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6212, Accuracy: 6164/10000 (61.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0193, Accuracy: 9846/9900 (99.4545%)
Done in 302.9641191959381 sec.
Saving all the graphs.
This run has a label: Oct.25_17.34.19. Visdom environment: cifar100_CerP
