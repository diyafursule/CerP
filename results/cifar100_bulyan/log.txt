current path: saved_models/model_cifar100_Oct.25_17.34.28_CerP_bulyan_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4753/5308 (89.5441%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43905182867765. Distance: 2.2816162860436244
Total norm for 4 adversaries is: 42.43905182867765. distance: 2.2816162860436244
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5402, Accuracy: 8634/9900 (87.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5301/5777 (91.7604%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.42961341712369. Distance: 2.173480860416798
Total norm for 4 adversaries is: 42.42961341712369. distance: 2.173480860416798
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5829, Accuracy: 8559/9900 (86.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4584/5123 (89.4788%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.43913092871218. Distance: 2.263562651559033
Total norm for 4 adversaries is: 42.43913092871218. distance: 2.263562651559033
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4763, Accuracy: 8741/9900 (88.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4939/5503 (89.7510%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.4392876901632. Distance: 2.3052974604979233
Total norm for 4 adversaries is: 42.4392876901632. distance: 2.3052974604979233
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5339, Accuracy: 8604/9900 (86.9091%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6163/6947 (88.7146%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6185/6947 (89.0312%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0835, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3578/4028 (88.8282%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3691/4028 (91.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9708, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4112/4736 (86.8243%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4252/4736 (89.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9293, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3444/3959 (86.9917%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3570/3959 (90.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8832, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5478/6235 (87.8589%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5455/6235 (87.4900%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2754, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4525/5224 (86.6194%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4715/5224 (90.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0915, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3457/3929 (87.9868%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3573/3929 (90.9392%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9085, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4571/5068 (90.1934%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4672/5068 (92.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9702, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4303/4732 (90.9341%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4414/4732 (93.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7630, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4431/4911 (90.2260%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4505/4911 (91.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9115, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4282/4869 (87.9441%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4031/4869 (82.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3200, Accuracy: 4873/10000 (48.7300%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3754/4249 (88.3502%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3843/4249 (90.4448%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9975, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4409/4929 (89.4502%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4466/4929 (90.6066%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9843, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5115/5696 (89.7999%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5124/5696 (89.9579%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0376, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3912/4364 (89.6425%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3902/4364 (89.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0273, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4526/5035 (89.8908%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4665/5035 (92.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0297, Accuracy: 5351/10000 (53.5100%)
time spent on training: 262.3412575721741
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1042, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.9484, Accuracy: 120/9900 (1.2121%)
Done in 395.2247235774994 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4871/5308 (91.7671%), train_poison_data_count: 415
Global model norm: 42.447864104006314.
Norm before scaling: 42.45012008596089. Distance: 2.0636905355221766
Total norm for 4 adversaries is: 42.45012008596089. distance: 2.0636905355221766
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2315, Accuracy: 9307/9900 (94.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5375/5777 (93.0414%), train_poison_data_count: 455
Global model norm: 42.447864104006314.
Norm before scaling: 42.43963716544211. Distance: 1.985821594649675
Total norm for 4 adversaries is: 42.43963716544211. distance: 1.985821594649675
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2185, Accuracy: 9349/9900 (94.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4599/5123 (89.7716%), train_poison_data_count: 403
Global model norm: 42.447864104006314.
Norm before scaling: 42.45230549908332. Distance: 2.1490533119572155
Total norm for 4 adversaries is: 42.45230549908332. distance: 2.1490533119572155
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1255, Accuracy: 9566/9900 (96.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5048/5503 (91.7318%), train_poison_data_count: 430
Global model norm: 42.447864104006314.
Norm before scaling: 42.450390393154805. Distance: 2.099078557536723
Total norm for 4 adversaries is: 42.450390393154805. distance: 2.099078557536723
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2995, Accuracy: 9159/9900 (92.5152%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4468/5123 (87.2145%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4239/5123 (82.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0590, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4549/5068 (89.7593%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4609/5068 (90.9432%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1466, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4348/5018 (86.6481%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4450/5018 (88.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2312, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3751/4161 (90.1466%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3785/4161 (90.9637%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0355, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4297/4894 (87.8014%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4339/4894 (88.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0987, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4419/4956 (89.1646%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4580/4956 (92.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1241, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4082/4587 (88.9906%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4142/4587 (90.2987%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0753, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6209/6947 (89.3767%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6155/6947 (88.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2122, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4494/5055 (88.9021%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4594/5055 (90.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1154, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4423/4929 (89.7342%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4420/4929 (89.6734%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2760, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4221/4797 (87.9925%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4268/4797 (88.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0292, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4878/5645 (86.4128%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4885/5645 (86.5368%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1734, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4847/5362 (90.3954%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4868/5362 (90.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9766, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4786/5489 (87.1926%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4903/5489 (89.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1031, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3679/4108 (89.5570%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3819/4108 (92.9649%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9425, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3721/4130 (90.0969%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3821/4130 (92.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9994, Accuracy: 5527/10000 (55.2700%)
time spent on training: 264.4270615577698
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0956, Accuracy: 7059/10000 (70.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.5009, Accuracy: 297/9900 (3.0000%)
Done in 415.6895384788513 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4892/5308 (92.1628%), train_poison_data_count: 415
Global model norm: 42.46492693425069.
Norm before scaling: 42.46444112155045. Distance: 1.9651029199723826
Total norm for 4 adversaries is: 42.46444112155045. distance: 1.9651029199723826
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3074, Accuracy: 9145/9900 (92.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5407/5777 (93.5953%), train_poison_data_count: 455
Global model norm: 42.46492693425069.
Norm before scaling: 42.45820267756721. Distance: 1.9481945825559221
Total norm for 4 adversaries is: 42.45820267756721. distance: 1.9481945825559221
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3003, Accuracy: 9135/9900 (92.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4689/5123 (91.5284%), train_poison_data_count: 403
Global model norm: 42.46492693425069.
Norm before scaling: 42.46291896825615. Distance: 1.950998720537213
Total norm for 4 adversaries is: 42.46291896825615. distance: 1.950998720537213
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3086, Accuracy: 9167/9900 (92.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5020/5503 (91.2230%), train_poison_data_count: 430
Global model norm: 42.46492693425069.
Norm before scaling: 42.46455610730701. Distance: 2.077264937634164
Total norm for 4 adversaries is: 42.46455610730701. distance: 2.077264937634164
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1105, Accuracy: 9629/9900 (97.2626%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4087/4537 (90.0816%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4163/4537 (91.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8588, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4532/5123 (88.4638%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4477/5123 (87.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2983, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3849/4196 (91.7302%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3952/4196 (94.1849%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7732, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4128/4605 (89.6417%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4256/4605 (92.4213%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8431, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4327/4851 (89.1981%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4420/4851 (91.1152%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9073, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3676/4145 (88.6852%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3801/4145 (91.7008%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9280, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4544/5035 (90.2483%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4647/5035 (92.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9646, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3693/4175 (88.4551%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3780/4175 (90.5389%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9853, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5441/5939 (91.6147%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5480/5939 (92.2714%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0179, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3989/4368 (91.3233%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4088/4368 (93.5897%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0284, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4006/4587 (87.3338%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4110/4587 (89.6010%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0230, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4122/4397 (93.7457%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7853, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4290/4869 (88.1084%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4216/4869 (86.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2134, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5156/5696 (90.5197%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5158/5696 (90.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1521, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3169/3552 (89.2173%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3272/3552 (92.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8355, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4158/4736 (87.7956%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4267/4736 (90.0971%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0142, Accuracy: 5398/10000 (53.9800%)
time spent on training: 262.7751636505127
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0884, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.6990, Accuracy: 514/9900 (5.1919%)
Done in 398.52673077583313 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4917/5308 (92.6338%), train_poison_data_count: 415
Global model norm: 42.48054328298059.
Norm before scaling: 42.48149442008911. Distance: 1.9421299404904688
Total norm for 4 adversaries is: 42.48149442008911. distance: 1.9421299404904688
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1220, Accuracy: 9600/9900 (96.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5408/5777 (93.6126%), train_poison_data_count: 455
Global model norm: 42.48054328298059.
Norm before scaling: 42.47117588730032. Distance: 1.9328166594649439
Total norm for 4 adversaries is: 42.47117588730032. distance: 1.9328166594649439
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1267, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4628/5123 (90.3377%), train_poison_data_count: 403
Global model norm: 42.48054328298059.
Norm before scaling: 42.48503298037733. Distance: 2.0764264500628844
Total norm for 4 adversaries is: 42.48503298037733. distance: 2.0764264500628844
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1675, Accuracy: 9458/9900 (95.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5065/5503 (92.0407%), train_poison_data_count: 430
Global model norm: 42.48054328298059.
Norm before scaling: 42.4816567721808. Distance: 1.9952537127671652
Total norm for 4 adversaries is: 42.4816567721808. distance: 1.9952537127671652
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1942, Accuracy: 9403/9900 (94.9798%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4619/5068 (91.1405%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4553/5068 (89.8382%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2059, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3484/3959 (88.0020%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3569/3959 (90.1490%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8785, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5500/6068 (90.6394%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5503/6068 (90.6889%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0088, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5316/5907 (89.9949%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5370/5907 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4073, Accuracy: 4864/10000 (48.6400%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4521/4956 (91.2228%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4553/4956 (91.8684%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9607, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4242/4903 (86.5185%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4374/4903 (89.2107%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3407, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5002/5727 (87.3407%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5092/5727 (88.9122%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0285, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4904/5346 (91.7321%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4950/5346 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1136, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5375/5871 (91.5517%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5357/5871 (91.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9817, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4333/4889 (88.6275%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4420/4889 (90.4070%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0819, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4842/5497 (88.0844%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4934/5497 (89.7580%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0666, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4237/4818 (87.9411%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4321/4818 (89.6845%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8729, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4122/4397 (93.7457%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4190/4397 (95.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8606, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3730/4130 (90.3148%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3788/4130 (91.7191%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8758, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3975/4364 (91.0862%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3963/4364 (90.8112%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9906, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4832/5702 (84.7422%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4591/5702 (80.5156%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1352, Accuracy: 5106/10000 (51.0600%)
time spent on training: 273.3494164943695
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0885, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.0001, Accuracy: 804/9900 (8.1212%)
Done in 406.5196650028229 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4927/5308 (92.8222%), train_poison_data_count: 415
Global model norm: 42.49865576918287.
Norm before scaling: 42.49269669556096. Distance: 1.863657275630238
Total norm for 4 adversaries is: 42.49269669556096. distance: 1.863657275630238
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2176, Accuracy: 9380/9900 (94.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5446/5777 (94.2704%), train_poison_data_count: 455
Global model norm: 42.49865576918287.
Norm before scaling: 42.486581636331074. Distance: 1.8220827720298691
Total norm for 4 adversaries is: 42.486581636331074. distance: 1.8220827720298691
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1948, Accuracy: 9431/9900 (95.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4653/5123 (90.8257%), train_poison_data_count: 403
Global model norm: 42.49865576918287.
Norm before scaling: 42.5009147994377. Distance: 2.019954673900639
Total norm for 4 adversaries is: 42.5009147994377. distance: 2.019954673900639
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1749, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5108/5503 (92.8221%), train_poison_data_count: 430
Global model norm: 42.49865576918287.
Norm before scaling: 42.496195544333. Distance: 1.9322785191118652
Total norm for 4 adversaries is: 42.496195544333. distance: 1.9322785191118652
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1056, Accuracy: 9608/9900 (97.0505%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4552/4956 (91.8483%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4544/4956 (91.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0529, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3669/4145 (88.5163%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3758/4145 (90.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9543, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4246/4797 (88.5137%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4312/4797 (89.8895%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8836, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4634/5193 (89.2355%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4647/5193 (89.4858%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3368, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5440/5871 (92.6588%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5369/5871 (91.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2367, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3858/4196 (91.9447%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3921/4196 (93.4461%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0175, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4436/4979 (89.0942%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4522/4979 (90.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0028, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4861/5362 (90.6565%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4864/5362 (90.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9349, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5061/5727 (88.3709%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5056/5727 (88.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9927, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4908/5461 (89.8736%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4898/5461 (89.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2245, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5118/5696 (89.8525%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5145/5696 (90.3265%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0095, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4181/4605 (90.7926%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4298/4605 (93.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8841, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4342/4843 (89.6552%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4413/4843 (91.1212%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1475, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4867/5298 (91.8649%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4928/5298 (93.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9277, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4818/5427 (88.7783%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4848/5427 (89.3311%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0212, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4431/4830 (91.7391%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4433/4830 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2297, Accuracy: 5242/10000 (52.4200%)
time spent on training: 263.6422965526581
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0876, Accuracy: 7040/10000 (70.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.2818, Accuracy: 1247/9900 (12.5960%)
Done in 395.97445011138916 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4949/5308 (93.2366%), train_poison_data_count: 415
Global model norm: 42.51684667254337.
Norm before scaling: 42.51375868744582. Distance: 1.8333397850732276
Total norm for 4 adversaries is: 42.51375868744582. distance: 1.8333397850732276
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2234, Accuracy: 9373/9900 (94.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5463/5777 (94.5647%), train_poison_data_count: 455
Global model norm: 42.51684667254337.
Norm before scaling: 42.503752419363664. Distance: 1.770566523778339
Total norm for 4 adversaries is: 42.503752419363664. distance: 1.770566523778339
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.0988, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4668/5123 (91.1185%), train_poison_data_count: 403
Global model norm: 42.51684667254337.
Norm before scaling: 42.51868413975863. Distance: 1.9697039276169102
Total norm for 4 adversaries is: 42.51868413975863. distance: 1.9697039276169102
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1625, Accuracy: 9496/9900 (95.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5092/5503 (92.5313%), train_poison_data_count: 430
Global model norm: 42.51684667254337.
Norm before scaling: 42.51846450918413. Distance: 1.9554258908045354
Total norm for 4 adversaries is: 42.51846450918413. distance: 1.9554258908045354
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1319, Accuracy: 9571/9900 (96.6768%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3965/4364 (90.8570%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3972/4364 (91.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9295, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4802/5353 (89.7067%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4830/5353 (90.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0003, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4217/4672 (90.2611%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4295/4672 (91.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8344, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3700/4145 (89.2642%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3766/4145 (90.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9660, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3904/4313 (90.5170%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3955/4313 (91.6995%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9207, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4349/4889 (88.9548%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4386/4889 (89.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1527, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4381/5050 (86.7525%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4516/5050 (89.4257%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9948, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4820/5702 (84.5317%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4558/5702 (79.9369%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1202, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4927/5461 (90.2216%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4942/5461 (90.4962%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1750, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4535/5122 (88.5396%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0111, Accuracy: 4146/5122 (80.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.4298, Accuracy: 4637/10000 (46.3700%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4275/4714 (90.6873%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4341/4714 (92.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1858, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3535/3968 (89.0877%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3641/3968 (91.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8940, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3501/3959 (88.4314%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3627/3959 (91.6140%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9355, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4523/4956 (91.2631%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4538/4956 (91.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0620, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4270/4818 (88.6260%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4282/4818 (88.8751%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0058, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3989/4368 (91.3233%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4036/4368 (92.3993%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1011, Accuracy: 5307/10000 (53.0700%)
time spent on training: 250.3241868019104
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0901, Accuracy: 7018/10000 (70.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 4.4083, Accuracy: 1980/9900 (20.0000%)
Done in 391.6986768245697 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4958/5308 (93.4062%), train_poison_data_count: 415
Global model norm: 42.53209094043726.
Norm before scaling: 42.52737801533707. Distance: 1.8274595565599876
Total norm for 4 adversaries is: 42.52737801533707. distance: 1.8274595565599876
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.0935, Accuracy: 9658/9900 (97.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5487/5777 (94.9801%), train_poison_data_count: 455
Global model norm: 42.53209094043726.
Norm before scaling: 42.52102679529931. Distance: 1.715530779254188
Total norm for 4 adversaries is: 42.52102679529931. distance: 1.715530779254188
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1758, Accuracy: 9456/9900 (95.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4728/5123 (92.2897%), train_poison_data_count: 403
Global model norm: 42.53209094043726.
Norm before scaling: 42.52997851240493. Distance: 1.880137842887605
Total norm for 4 adversaries is: 42.52997851240493. distance: 1.880137842887605
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1913, Accuracy: 9434/9900 (95.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5147/5503 (93.5308%), train_poison_data_count: 430
Global model norm: 42.53209094043726.
Norm before scaling: 42.52870555164403. Distance: 1.8587677549067039
Total norm for 4 adversaries is: 42.52870555164403. distance: 1.8587677549067039
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2130, Accuracy: 9345/9900 (94.3939%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4382/4732 (92.6036%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4401/4732 (93.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8904, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4552/5035 (90.4071%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4592/5035 (91.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9642, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4258/4797 (88.7638%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4270/4797 (89.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1100, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4749/5702 (83.2866%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4688/5702 (82.2168%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3024, Accuracy: 4884/10000 (48.8400%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3782/4161 (90.8916%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3820/4161 (91.8049%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9064, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4881/5526 (88.3279%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4851/5526 (87.7850%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0829, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4880/5497 (88.7757%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4888/5497 (88.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1769, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5450/5939 (91.7663%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5495/5939 (92.5240%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2125, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4627/5193 (89.1007%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4477/5193 (86.2122%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2852, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4841/5559 (87.0840%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4909/5559 (88.3072%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0607, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3541/3968 (89.2389%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3638/3968 (91.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8757, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3751/4086 (91.8013%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3836/4086 (93.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9541, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4024/4527 (88.8889%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4040/4527 (89.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0881, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4039/4485 (90.0557%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3817/4485 (85.1059%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0682, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5678/6419 (88.4561%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5556/6419 (86.5555%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2824, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4870/5489 (88.7229%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4951/5489 (90.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0791, Accuracy: 5299/10000 (52.9900%)
time spent on training: 272.5773720741272
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0934, Accuracy: 7032/10000 (70.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.6053, Accuracy: 2932/9900 (29.6162%)
Done in 409.10376954078674 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4981/5308 (93.8395%), train_poison_data_count: 415
Global model norm: 42.548196190008305.
Norm before scaling: 42.545154952837315. Distance: 1.7784588009381948
Total norm for 4 adversaries is: 42.545154952837315. distance: 1.7784588009381948
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1926, Accuracy: 9461/9900 (95.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5513/5777 (95.4302%), train_poison_data_count: 455
Global model norm: 42.548196190008305.
Norm before scaling: 42.533332229980964. Distance: 1.6810304462913939
Total norm for 4 adversaries is: 42.533332229980964. distance: 1.6810304462913939
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1823, Accuracy: 9444/9900 (95.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4704/5123 (91.8212%), train_poison_data_count: 403
Global model norm: 42.548196190008305.
Norm before scaling: 42.54670428950329. Distance: 1.853597367858829
Total norm for 4 adversaries is: 42.54670428950329. distance: 1.853597367858829
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2154, Accuracy: 9353/9900 (94.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5133/5503 (93.2764%), train_poison_data_count: 430
Global model norm: 42.548196190008305.
Norm before scaling: 42.544695879286024. Distance: 1.8395388081203425
Total norm for 4 adversaries is: 42.544695879286024. distance: 1.8395388081203425
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1443, Accuracy: 9537/9900 (96.3333%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4842/5427 (89.2206%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4899/5427 (90.2709%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9854, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4372/4748 (92.0809%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4351/4748 (91.6386%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0260, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4912/5645 (87.0151%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4785/5645 (84.7653%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1350, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3565/3910 (91.1765%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3457/3910 (88.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0936, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4626/5224 (88.5528%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4775/5224 (91.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9658, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4599/5068 (90.7459%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4559/5068 (89.9566%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1369, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4578/5086 (90.0118%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4666/5086 (91.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9598, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4883/5489 (88.9597%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4949/5489 (90.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1214, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5505/6235 (88.2919%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5531/6235 (88.7089%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1253, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4159/4397 (94.5872%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4193/4397 (95.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7815, Accuracy: 5888/10000 (58.8800%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4436/4929 (89.9980%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1044, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6214/6947 (89.4487%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6073/6947 (87.4190%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0783, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4278/4731 (90.4249%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4325/4731 (91.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9714, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5274/6080 (86.7434%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5318/6080 (87.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2719, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3190/3552 (89.8086%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3288/3552 (92.5676%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8140, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4312/4737 (91.0281%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4287/4737 (90.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0228, Accuracy: 5487/10000 (54.8700%)
time spent on training: 280.06342363357544
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0961, Accuracy: 7030/10000 (70.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 2.9881, Accuracy: 3806/9900 (38.4444%)
Done in 417.18849635124207 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4991/5308 (94.0279%), train_poison_data_count: 415
Global model norm: 42.56370025152375.
Norm before scaling: 42.55979249831935. Distance: 1.7386992562717007
Total norm for 4 adversaries is: 42.55979249831935. distance: 1.7386992562717007
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1783, Accuracy: 9464/9900 (95.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5495/5777 (95.1186%), train_poison_data_count: 455
Global model norm: 42.56370025152375.
Norm before scaling: 42.552763375583936. Distance: 1.7284065858748574
Total norm for 4 adversaries is: 42.552763375583936. distance: 1.7284065858748574
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2009, Accuracy: 9435/9900 (95.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4723/5123 (92.1921%), train_poison_data_count: 403
Global model norm: 42.56370025152375.
Norm before scaling: 42.5582852286316. Distance: 1.8349571045271635
Total norm for 4 adversaries is: 42.5582852286316. distance: 1.8349571045271635
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3988, Accuracy: 8916/9900 (90.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5139/5503 (93.3854%), train_poison_data_count: 430
Global model norm: 42.56370025152375.
Norm before scaling: 42.557974015967325. Distance: 1.7819017924338671
Total norm for 4 adversaries is: 42.557974015967325. distance: 1.7819017924338671
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3056, Accuracy: 9087/9900 (91.7879%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4260/4549 (93.6470%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4263/4549 (93.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7608, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4261/4737 (89.9514%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4287/4737 (90.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1481, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3222/3552 (90.7095%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3310/3552 (93.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8543, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5015/5422 (92.4935%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5006/5422 (92.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9440, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4891/5454 (89.6773%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4807/5454 (88.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0873, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4344/4748 (91.4912%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4372/4748 (92.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9053, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4654/5399 (86.2011%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4713/5399 (87.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1503, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5405/5871 (92.0627%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5367/5871 (91.4154%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0652, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4459/4830 (92.3188%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4531/4830 (93.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1297, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4635/4993 (92.8300%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4650/4993 (93.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8219, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4272/4903 (87.1303%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4368/4903 (89.0883%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1852, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4596/5086 (90.3657%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4660/5086 (91.6241%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8830, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3719/4111 (90.4646%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3703/4111 (90.0754%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1191, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4320/4869 (88.7246%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3975/4869 (81.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2335, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3534/3910 (90.3836%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3575/3910 (91.4322%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9361, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3742/4175 (89.6287%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3761/4175 (90.0838%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0100, Accuracy: 5423/10000 (54.2300%)
time spent on training: 259.50194239616394
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1024, Accuracy: 7011/10000 (70.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.4855, Accuracy: 4644/9900 (46.9091%)
Done in 397.11514592170715 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4999/5308 (94.1786%), train_poison_data_count: 415
Global model norm: 42.57900515145346.
Norm before scaling: 42.57191325101049. Distance: 1.699617536380981
Total norm for 4 adversaries is: 42.57191325101049. distance: 1.699617536380981
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1277, Accuracy: 9597/9900 (96.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5508/5777 (95.3436%), train_poison_data_count: 455
Global model norm: 42.57900515145346.
Norm before scaling: 42.56259034269046. Distance: 1.6278763769765385
Total norm for 4 adversaries is: 42.56259034269046. distance: 1.6278763769765385
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1131, Accuracy: 9621/9900 (97.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4758/5123 (92.8753%), train_poison_data_count: 403
Global model norm: 42.57900515145346.
Norm before scaling: 42.57253547026754. Distance: 1.7865631769701809
Total norm for 4 adversaries is: 42.57253547026754. distance: 1.7865631769701809
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2803, Accuracy: 9224/9900 (93.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5183/5503 (94.1850%), train_poison_data_count: 430
Global model norm: 42.57900515145346.
Norm before scaling: 42.57234479113906. Distance: 1.7642423228945088
Total norm for 4 adversaries is: 42.57234479113906. distance: 1.7642423228945088
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2214, Accuracy: 9353/9900 (94.4747%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4658/5075 (91.7833%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4553/5075 (89.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0180, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3433/3774 (90.9645%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3508/3774 (92.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.7870, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4382/4843 (90.4811%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4433/4843 (91.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0148, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4226/4605 (91.7698%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4249/4605 (92.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9291, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3482/3959 (87.9515%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3608/3959 (91.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9677, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4565/5035 (90.6653%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4617/5035 (91.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0880, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5180/5696 (90.9410%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5198/5696 (91.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1503, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4666/5399 (86.4234%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4678/5399 (86.6457%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1577, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4329/4903 (88.2929%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4373/4903 (89.1903%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0640, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4469/4911 (90.9998%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4502/4911 (91.6718%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9508, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4604/5086 (90.5230%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4601/5086 (90.4640%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2123, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4106/4537 (90.5003%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4167/4537 (91.8448%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0268, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4453/5018 (88.7405%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4421/5018 (88.1028%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1931, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5466/5939 (92.0357%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5471/5939 (92.1199%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0336, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5776/6664 (86.6747%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5578/6664 (83.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2821, Accuracy: 4831/10000 (48.3100%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4839/5702 (84.8650%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4553/5702 (79.8492%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2442, Accuracy: 5004/10000 (50.0400%)
time spent on training: 272.555757522583
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1008, Accuracy: 7014/10000 (70.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.2345, Accuracy: 5110/9900 (51.6162%)
Done in 405.3503932952881 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5031/5308 (94.7815%), train_poison_data_count: 415
Global model norm: 42.596031211839446.
Norm before scaling: 42.58524883065438. Distance: 1.6192615864185917
Total norm for 4 adversaries is: 42.58524883065438. distance: 1.6192615864185917
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1163, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5531/5777 (95.7417%), train_poison_data_count: 455
Global model norm: 42.596031211839446.
Norm before scaling: 42.576039226435064. Distance: 1.5871771867195064
Total norm for 4 adversaries is: 42.576039226435064. distance: 1.5871771867195064
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1033, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4773/5123 (93.1681%), train_poison_data_count: 403
Global model norm: 42.596031211839446.
Norm before scaling: 42.59044116595809. Distance: 1.7604189389306326
Total norm for 4 adversaries is: 42.59044116595809. distance: 1.7604189389306326
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1386, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5204/5503 (94.5666%), train_poison_data_count: 430
Global model norm: 42.596031211839446.
Norm before scaling: 42.58704895013565. Distance: 1.7050323305392787
Total norm for 4 adversaries is: 42.58704895013565. distance: 1.7050323305392787
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1826, Accuracy: 9454/9900 (95.4949%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3969/4364 (90.9487%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4008/4364 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0880, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4343/4894 (88.7413%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4345/4894 (88.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9912, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4690/5068 (92.5414%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/5068 (91.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1513, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3944/4313 (91.4445%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3960/4313 (91.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8627, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5487/6068 (90.4252%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5474/6068 (90.2109%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1890, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4975/5645 (88.1311%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4916/5645 (87.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.5314, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5050/5615 (89.9377%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5071/5615 (90.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1452, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4150/4397 (94.3825%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4157/4397 (94.5417%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8053, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5330/5907 (90.2319%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5302/5907 (89.7579%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2786, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4648/5193 (89.5051%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4502/5193 (86.6936%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2146, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4680/5209 (89.8445%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4682/5209 (89.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1483, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6237/6812 (91.5590%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6235/6812 (91.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1220, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4189/4605 (90.9663%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4274/4605 (92.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9415, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3570/3959 (90.1743%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3642/3959 (91.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9898, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4376/4732 (92.4768%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4421/4732 (93.4277%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9231, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4621/5075 (91.0542%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4615/5075 (90.9360%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0817, Accuracy: 5298/10000 (52.9800%)
time spent on training: 270.35379576683044
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1025, Accuracy: 6998/10000 (69.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 1.8914, Accuracy: 5719/9900 (57.7677%)
Done in 408.5025990009308 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5040/5308 (94.9510%), train_poison_data_count: 415
Global model norm: 42.61081170799334.
Norm before scaling: 42.60125088713285. Distance: 1.6118763863660006
Total norm for 4 adversaries is: 42.60125088713285. distance: 1.6118763863660006
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2182, Accuracy: 9388/9900 (94.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5525/5777 (95.6379%), train_poison_data_count: 455
Global model norm: 42.61081170799334.
Norm before scaling: 42.590259165462356. Distance: 1.5503664783261117
Total norm for 4 adversaries is: 42.590259165462356. distance: 1.5503664783261117
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1338, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4794/5123 (93.5780%), train_poison_data_count: 403
Global model norm: 42.61081170799334.
Norm before scaling: 42.60190706237882. Distance: 1.6864498544267397
Total norm for 4 adversaries is: 42.60190706237882. distance: 1.6864498544267397
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3900, Accuracy: 8983/9900 (90.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5180/5503 (94.1305%), train_poison_data_count: 430
Global model norm: 42.61081170799334.
Norm before scaling: 42.603550321540105. Distance: 1.718338657053937
Total norm for 4 adversaries is: 42.603550321540105. distance: 1.718338657053937
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3117, Accuracy: 9088/9900 (91.7980%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3935/4196 (93.7798%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3965/4196 (94.4948%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8739, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4981/5645 (88.2374%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4894/5645 (86.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1778, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4942/5346 (92.4429%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4914/5346 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0784, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4468/4911 (90.9794%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4417/4911 (89.9409%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0179, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3297/3589 (91.8640%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3147/3589 (87.6846%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0580, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4253/4605 (92.3561%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4298/4605 (93.3333%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9569, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5523/6068 (91.0185%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5521/6068 (90.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1441, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4041/4527 (89.2644%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4002/4527 (88.4029%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9795, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4374/4869 (89.8336%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4148/4869 (85.1920%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4206, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3754/4086 (91.8747%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3817/4086 (93.4165%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9312, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3724/4111 (90.5862%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3729/4111 (90.7079%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3057, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 4832/5702 (84.7422%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4427/5702 (77.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2775, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4096/4485 (91.3266%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4070/4485 (90.7469%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1418, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4863/5427 (89.6075%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4882/5427 (89.9576%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9374, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4812/5353 (89.8935%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4797/5353 (89.6133%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1765, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4851/5489 (88.3768%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4973/5489 (90.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0865, Accuracy: 5345/10000 (53.4500%)
time spent on training: 258.4668924808502
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1061, Accuracy: 7004/10000 (70.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.5970, Accuracy: 6306/9900 (63.6970%)
Done in 395.2498342990875 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5070/5308 (95.5162%), train_poison_data_count: 415
Global model norm: 42.62641899901618.
Norm before scaling: 42.61187452560539. Distance: 1.554216169671739
Total norm for 4 adversaries is: 42.61187452560539. distance: 1.554216169671739
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1057, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5561/5777 (96.2610%), train_poison_data_count: 455
Global model norm: 42.62641899901618.
Norm before scaling: 42.606530089295. Distance: 1.5344509222510967
Total norm for 4 adversaries is: 42.606530089295. distance: 1.5344509222510967
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1324, Accuracy: 9568/9900 (96.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4799/5123 (93.6756%), train_poison_data_count: 403
Global model norm: 42.62641899901618.
Norm before scaling: 42.6179042962176. Distance: 1.6877012486017364
Total norm for 4 adversaries is: 42.6179042962176. distance: 1.6877012486017364
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4773, Accuracy: 8738/9900 (88.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5209/5503 (94.6575%), train_poison_data_count: 430
Global model norm: 42.62641899901618.
Norm before scaling: 42.616460666350065. Distance: 1.6690979469819207
Total norm for 4 adversaries is: 42.616460666350065. distance: 1.6690979469819207
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0631, Accuracy: 9748/9900 (98.4646%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4743/5399 (87.8496%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4698/5399 (87.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2702, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4013/4368 (91.8727%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4009/4368 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9359, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4930/5346 (92.2185%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4979/5346 (93.1351%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1027, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4355/4869 (89.4434%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4152/4869 (85.2742%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2318, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4380/4889 (89.5889%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4416/4889 (90.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0273, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4292/4797 (89.4726%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4288/4797 (89.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0352, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3522/3995 (88.1602%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3582/3995 (89.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0275, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4560/5123 (89.0103%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4521/5123 (88.2491%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2233, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5499/6235 (88.1957%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5505/6235 (88.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1642, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4607/5224 (88.1891%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4642/5224 (88.8591%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0060, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5641/6419 (87.8797%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5559/6419 (86.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1914, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4997/5652 (88.4112%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5002/5652 (88.4996%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0644, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4651/5075 (91.6453%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4649/5075 (91.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0277, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5395/5871 (91.8924%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5401/5871 (91.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0506, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5453/5939 (91.8168%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5419/5939 (91.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9878, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4877/5454 (89.4206%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4836/5454 (88.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1493, Accuracy: 5242/10000 (52.4200%)
time spent on training: 281.3513298034668
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1148, Accuracy: 6984/10000 (69.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.2900, Accuracy: 6920/9900 (69.8990%)
Done in 415.06915378570557 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5063/5308 (95.3843%), train_poison_data_count: 415
Global model norm: 42.64343328513489.
Norm before scaling: 42.628861685867385. Distance: 1.5473138976470038
Total norm for 4 adversaries is: 42.628861685867385. distance: 1.5473138976470038
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1774, Accuracy: 9463/9900 (95.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5548/5777 (96.0360%), train_poison_data_count: 455
Global model norm: 42.64343328513489.
Norm before scaling: 42.62165063132894. Distance: 1.5433612565685901
Total norm for 4 adversaries is: 42.62165063132894. distance: 1.5433612565685901
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1300, Accuracy: 9590/9900 (96.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4812/5123 (93.9293%), train_poison_data_count: 403
Global model norm: 42.64343328513489.
Norm before scaling: 42.63377240879216. Distance: 1.663219112814131
Total norm for 4 adversaries is: 42.63377240879216. distance: 1.663219112814131
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3001, Accuracy: 9169/9900 (92.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5186/5503 (94.2395%), train_poison_data_count: 430
Global model norm: 42.64343328513489.
Norm before scaling: 42.634629937667746. Distance: 1.6907568691530959
Total norm for 4 adversaries is: 42.634629937667746. distance: 1.6907568691530959
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1441, Accuracy: 9545/9900 (96.4141%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4926/5461 (90.2033%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4911/5461 (89.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1372, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4933/5346 (92.2746%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4940/5346 (92.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0645, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4921/5489 (89.6520%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4926/5489 (89.7431%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0919, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4487/4929 (91.0327%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4481/4929 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0098, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4537/4956 (91.5456%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4568/4956 (92.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0079, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5159/5696 (90.5723%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5138/5696 (90.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9965, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3259/3589 (90.8052%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0096, Accuracy: 2958/3589 (82.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3162, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5510/6235 (88.3721%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5536/6235 (88.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2591, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3529/3959 (89.1387%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3613/3959 (91.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8804, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3739/4086 (91.5076%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3836/4086 (93.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0074, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4331/4714 (91.8753%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4367/4714 (92.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0431, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3816/4161 (91.7087%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3776/4161 (90.7474%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3273, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4088/4485 (91.1483%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3938/4485 (87.8038%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1348, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4947/5454 (90.7041%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4939/5454 (90.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9322, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5044/5422 (93.0284%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5030/5422 (92.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9268, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4592/5122 (89.6525%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4156/5122 (81.1402%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3851, Accuracy: 4792/10000 (47.9200%)
time spent on training: 269.90274024009705
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1181, Accuracy: 6975/10000 (69.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.1422, Accuracy: 7242/9900 (73.1515%)
Done in 408.3271293640137 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5081/5308 (95.7234%), train_poison_data_count: 415
Global model norm: 42.661592499687295.
Norm before scaling: 42.64678523658759. Distance: 1.5317642749627385
Total norm for 4 adversaries is: 42.64678523658759. distance: 1.5317642749627385
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1276, Accuracy: 9582/9900 (96.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5563/5777 (96.2957%), train_poison_data_count: 455
Global model norm: 42.661592499687295.
Norm before scaling: 42.63935820534899. Distance: 1.50140704284069
Total norm for 4 adversaries is: 42.63935820534899. distance: 1.50140704284069
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2250, Accuracy: 9364/9900 (94.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4797/5123 (93.6365%), train_poison_data_count: 403
Global model norm: 42.661592499687295.
Norm before scaling: 42.649684705384985. Distance: 1.656164778910101
Total norm for 4 adversaries is: 42.649684705384985. distance: 1.656164778910101
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3159, Accuracy: 9202/9900 (92.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5215/5503 (94.7665%), train_poison_data_count: 430
Global model norm: 42.661592499687295.
Norm before scaling: 42.64758812009112. Distance: 1.6263796011839353
Total norm for 4 adversaries is: 42.64758812009112. distance: 1.6263796011839353
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1725, Accuracy: 9455/9900 (95.5051%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4601/5123 (89.8107%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4431/5123 (86.4923%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1865, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4922/5526 (89.0699%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4942/5526 (89.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1560, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4927/5362 (91.8874%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4918/5362 (91.7195%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1224, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3779/4111 (91.9241%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3776/4111 (91.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0009, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4165/4537 (91.8007%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4180/4537 (92.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8650, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4416/4732 (93.3221%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4460/4732 (94.2519%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7851, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4934/5497 (89.7580%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4936/5497 (89.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2196, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5340/6080 (87.8289%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5315/6080 (87.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1315, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6229/6812 (91.4416%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6242/6812 (91.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0744, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4442/4889 (90.8570%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4433/4889 (90.6729%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9578, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4324/4714 (91.7268%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4394/4714 (93.2117%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8882, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4306/4714 (91.3449%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4369/4714 (92.6814%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1687, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3794/4130 (91.8644%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3822/4130 (92.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9294, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4062/4485 (90.5686%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3935/4485 (87.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2154, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3736/4175 (89.4850%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3746/4175 (89.7246%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9616, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4360/4894 (89.0887%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4292/4894 (87.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0987, Accuracy: 5381/10000 (53.8100%)
time spent on training: 259.837858915329
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1232, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.9551, Accuracy: 7654/9900 (77.3131%)
Done in 400.0885362625122 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5062/5308 (95.3655%), train_poison_data_count: 415
Global model norm: 42.67707967847393.
Norm before scaling: 42.661618251948674. Distance: 1.534978802935342
Total norm for 4 adversaries is: 42.661618251948674. distance: 1.534978802935342
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1370, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5572/5777 (96.4514%), train_poison_data_count: 455
Global model norm: 42.67707967847393.
Norm before scaling: 42.651701050943586. Distance: 1.448367874134563
Total norm for 4 adversaries is: 42.651701050943586. distance: 1.448367874134563
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1635, Accuracy: 9493/9900 (95.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4806/5123 (93.8122%), train_poison_data_count: 403
Global model norm: 42.67707967847393.
Norm before scaling: 42.66702159098186. Distance: 1.6602638120026458
Total norm for 4 adversaries is: 42.66702159098186. distance: 1.6602638120026458
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2375, Accuracy: 9320/9900 (94.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5259/5503 (95.5661%), train_poison_data_count: 430
Global model norm: 42.67707967847393.
Norm before scaling: 42.66300312844256. Distance: 1.5876668887386824
Total norm for 4 adversaries is: 42.66300312844256. distance: 1.5876668887386824
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0865, Accuracy: 9669/9900 (97.6667%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4929/5362 (91.9247%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4900/5362 (91.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0377, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3741/4175 (89.6048%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3805/4175 (91.1377%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1458, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3602/3910 (92.1228%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3537/3910 (90.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1104, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4334/4714 (91.9389%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4419/4714 (93.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7899, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3912/4313 (90.7025%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3991/4313 (92.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7509, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5512/6068 (90.8372%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5535/6068 (91.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9919, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3213/3552 (90.4561%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3254/3552 (91.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9169, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4358/4732 (92.0964%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4465/4732 (94.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8318, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4183/4736 (88.3235%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4263/4736 (90.0127%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9896, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4360/4757 (91.6544%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4349/4757 (91.4232%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9505, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4585/5086 (90.1494%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4596/5086 (90.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0963, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5039/5422 (92.9362%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5016/5422 (92.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9622, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4566/4956 (92.1308%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4557/4956 (91.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0885, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3490/3774 (92.4748%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3549/3774 (94.0382%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9020, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4661/5068 (91.9692%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4706/5068 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9816, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4930/5346 (92.2185%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4940/5346 (92.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0104, Accuracy: 5407/10000 (54.0700%)
time spent on training: 273.25343561172485
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1293, Accuracy: 6942/10000 (69.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.7732, Accuracy: 8052/9900 (81.3333%)
Done in 418.0002055168152 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5070/5308 (95.5162%), train_poison_data_count: 415
Global model norm: 42.69116016519111.
Norm before scaling: 42.675240449948696. Distance: 1.4965575771605286
Total norm for 4 adversaries is: 42.675240449948696. distance: 1.4965575771605286
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2206, Accuracy: 9363/9900 (94.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5581/5777 (96.6072%), train_poison_data_count: 455
Global model norm: 42.69116016519111.
Norm before scaling: 42.66538506808315. Distance: 1.434625322028617
Total norm for 4 adversaries is: 42.66538506808315. distance: 1.434625322028617
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0927, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4811/5123 (93.9098%), train_poison_data_count: 403
Global model norm: 42.69116016519111.
Norm before scaling: 42.67772181657691. Distance: 1.602071243987916
Total norm for 4 adversaries is: 42.67772181657691. distance: 1.602071243987916
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0926, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5260/5503 (95.5842%), train_poison_data_count: 430
Global model norm: 42.69116016519111.
Norm before scaling: 42.67446383121. Distance: 1.5423422785023388
Total norm for 4 adversaries is: 42.67446383121. distance: 1.5423422785023388
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2957, Accuracy: 9195/9900 (92.8788%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4596/5123 (89.7131%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4394/5123 (85.7701%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2906, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4320/4818 (89.6638%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4249/4818 (88.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1942, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4596/5035 (91.2810%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4638/5035 (92.1152%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0043, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4168/4397 (94.7919%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4187/4397 (95.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8786, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5292/6080 (87.0395%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5351/6080 (88.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2737, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4609/5086 (90.6213%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4654/5086 (91.5061%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0696, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3784/4145 (91.2907%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3800/4145 (91.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1057, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4856/5362 (90.5632%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4867/5362 (90.7684%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0542, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4342/4869 (89.1764%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4040/4869 (82.9739%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.3458, Accuracy: 4874/10000 (48.7400%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3925/4364 (89.9404%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3991/4364 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9502, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4428/5018 (88.2423%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4454/5018 (88.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0263, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4573/5038 (90.7701%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4631/5038 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0204, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3785/4108 (92.1373%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3752/4108 (91.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0444, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5024/5615 (89.4746%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5081/5615 (90.4898%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1435, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4537/5055 (89.7527%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4487/5055 (88.7636%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1153, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4265/4797 (88.9097%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4311/4797 (89.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8624, Accuracy: 5604/10000 (56.0400%)
time spent on training: 271.70317578315735
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1333, Accuracy: 6919/10000 (69.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.6379, Accuracy: 8378/9900 (84.6263%)
Done in 416.03700065612793 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5120/5308 (96.4582%), train_poison_data_count: 415
Global model norm: 42.70541751987533.
Norm before scaling: 42.68815056010494. Distance: 1.467022630814709
Total norm for 4 adversaries is: 42.68815056010494. distance: 1.467022630814709
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0983, Accuracy: 9631/9900 (97.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5548/5777 (96.0360%), train_poison_data_count: 455
Global model norm: 42.70541751987533.
Norm before scaling: 42.68515218195755. Distance: 1.5488470588671674
Total norm for 4 adversaries is: 42.68515218195755. distance: 1.5488470588671674
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0897, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4819/5123 (94.0660%), train_poison_data_count: 403
Global model norm: 42.70541751987533.
Norm before scaling: 42.692707062543185. Distance: 1.620514842157564
Total norm for 4 adversaries is: 42.692707062543185. distance: 1.620514842157564
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1299, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5247/5503 (95.3480%), train_poison_data_count: 430
Global model norm: 42.70541751987533.
Norm before scaling: 42.69032092847936. Distance: 1.5865032521144502
Total norm for 4 adversaries is: 42.69032092847936. distance: 1.5865032521144502
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0604, Accuracy: 9738/9900 (98.3636%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4037/4527 (89.1761%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4037/4527 (89.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1487, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3782/4086 (92.5600%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3769/4086 (92.2418%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0411, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4311/4903 (87.9258%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4385/4903 (89.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1526, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3615/3968 (91.1038%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3672/3968 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7612, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5074/5615 (90.3651%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5101/5615 (90.8459%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0616, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4423/4748 (93.1550%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4372/4748 (92.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0437, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4832/5361 (90.1324%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4827/5361 (90.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1525, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4469/5050 (88.4950%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4534/5050 (89.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1257, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5026/5652 (88.9243%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5018/5652 (88.7827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2501, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4332/4731 (91.5663%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4371/4731 (92.3906%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0097, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5295/5907 (89.6394%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5324/5907 (90.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.5286, Accuracy: 4735/10000 (47.3500%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4635/5224 (88.7251%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4692/5224 (89.8162%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0668, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3597/3959 (90.8563%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3621/3959 (91.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8779, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4287/4605 (93.0945%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4306/4605 (93.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9877, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4317/4797 (89.9937%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4295/4797 (89.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9387, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5208/5696 (91.4326%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5170/5696 (90.7654%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1244, Accuracy: 5269/10000 (52.6900%)
time spent on training: 265.8328151702881
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1324, Accuracy: 6930/10000 (69.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.5814, Accuracy: 8500/9900 (85.8586%)
Done in 399.92235565185547 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5079/5308 (95.6858%), train_poison_data_count: 415
Global model norm: 42.72102453710585.
Norm before scaling: 42.705035918184606. Distance: 1.4978268298859017
Total norm for 4 adversaries is: 42.705035918184606. distance: 1.4978268298859017
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0586, Accuracy: 9751/9900 (98.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5575/5777 (96.5034%), train_poison_data_count: 455
Global model norm: 42.72102453710585.
Norm before scaling: 42.69741603349669. Distance: 1.4891559103200338
Total norm for 4 adversaries is: 42.69741603349669. distance: 1.4891559103200338
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1633, Accuracy: 9498/9900 (95.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4823/5123 (94.1441%), train_poison_data_count: 403
Global model norm: 42.72102453710585.
Norm before scaling: 42.70636221950352. Distance: 1.570852917347596
Total norm for 4 adversaries is: 42.70636221950352. distance: 1.570852917347596
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2716, Accuracy: 9265/9900 (93.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5252/5503 (95.4389%), train_poison_data_count: 430
Global model norm: 42.72102453710585.
Norm before scaling: 42.702769105267784. Distance: 1.5389675362814745
Total norm for 4 adversaries is: 42.702769105267784. distance: 1.5389675362814745
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1304, Accuracy: 9591/9900 (96.8788%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4179/4397 (95.0421%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4179/4397 (95.0421%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8331, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4034/4368 (92.3535%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3970/4368 (90.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0482, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4788/5504 (86.9913%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4830/5504 (87.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1505, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3445/3774 (91.2825%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3515/3774 (93.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9428, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4968/5526 (89.9023%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4878/5526 (88.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.5059, Accuracy: 4728/10000 (47.2800%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3980/4313 (92.2792%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3957/4313 (91.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0075, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4472/4979 (89.8172%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4541/4979 (91.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0366, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4299/4737 (90.7536%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4327/4737 (91.3447%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1445, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4737/5399 (87.7385%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4649/5399 (86.1085%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1010, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3785/4145 (91.3148%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3786/4145 (91.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0571, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4419/4748 (93.0708%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4349/4748 (91.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1437, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4458/5050 (88.2772%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4491/5050 (88.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1010, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4440/5018 (88.4815%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4467/5018 (89.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1575, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5854/6664 (87.8451%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5683/6664 (85.2791%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1183, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3973/4364 (91.0403%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4061/4364 (93.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7958, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3913/4196 (93.2555%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3935/4196 (93.7798%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8002, Accuracy: 5843/10000 (58.4300%)
time spent on training: 264.37477707862854
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1325, Accuracy: 6910/10000 (69.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.5147, Accuracy: 8639/9900 (87.2626%)
Done in 404.7579162120819 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5098/5308 (96.0437%), train_poison_data_count: 415
Global model norm: 42.73492915545637.
Norm before scaling: 42.71698114936992. Distance: 1.4781351746416629
Total norm for 4 adversaries is: 42.71698114936992. distance: 1.4781351746416629
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0397, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5563/5777 (96.2957%), train_poison_data_count: 455
Global model norm: 42.73492915545637.
Norm before scaling: 42.71137978209818. Distance: 1.4649714299823984
Total norm for 4 adversaries is: 42.71137978209818. distance: 1.4649714299823984
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0698, Accuracy: 9726/9900 (98.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4859/5123 (94.8468%), train_poison_data_count: 403
Global model norm: 42.73492915545637.
Norm before scaling: 42.72062878778164. Distance: 1.5490342300110251
Total norm for 4 adversaries is: 42.72062878778164. distance: 1.5490342300110251
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2194, Accuracy: 9360/9900 (94.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5262/5503 (95.6206%), train_poison_data_count: 430
Global model norm: 42.73492915545637.
Norm before scaling: 42.71762983169244. Distance: 1.5505042609457929
Total norm for 4 adversaries is: 42.71762983169244. distance: 1.5505042609457929
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0698, Accuracy: 9708/9900 (98.0606%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4486/4929 (91.0124%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4408/4929 (89.4299%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3092, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4665/5209 (89.5565%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4701/5209 (90.2476%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0118, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3521/3929 (89.6157%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3561/3929 (90.6337%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9056, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4330/4818 (89.8713%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4332/4818 (89.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0149, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5223/5696 (91.6959%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5146/5696 (90.3441%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9810, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4963/5526 (89.8118%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4870/5526 (88.1288%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1432, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5363/5907 (90.7906%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5398/5907 (91.3831%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2010, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4835/5427 (89.0916%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4856/5427 (89.4785%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9738, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4705/5193 (90.6027%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4414/5193 (84.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.4637, Accuracy: 4817/10000 (48.1700%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4525/5055 (89.5153%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4589/5055 (90.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0768, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4890/5298 (92.2990%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4898/5298 (92.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9593, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4574/5122 (89.3011%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4236/5122 (82.7021%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3361, Accuracy: 4820/10000 (48.2000%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4064/4368 (93.0403%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4054/4368 (92.8114%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9706, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3748/4175 (89.7725%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3779/4175 (90.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9648, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4371/4851 (90.1051%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4386/4851 (90.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0503, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4831/5353 (90.2485%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4819/5353 (90.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9992, Accuracy: 5317/10000 (53.1700%)
time spent on training: 264.7666275501251
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1360, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.4288, Accuracy: 8818/9900 (89.0707%)
Done in 409.3414487838745 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5099/5308 (96.0625%), train_poison_data_count: 415
Global model norm: 42.75096512982192.
Norm before scaling: 42.733663728084444. Distance: 1.461964700009161
Total norm for 4 adversaries is: 42.733663728084444. distance: 1.461964700009161
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0804, Accuracy: 9689/9900 (97.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5591/5777 (96.7803%), train_poison_data_count: 455
Global model norm: 42.75096512982192.
Norm before scaling: 42.722977513478476. Distance: 1.4260012104248645
Total norm for 4 adversaries is: 42.722977513478476. distance: 1.4260012104248645
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0487, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4866/5123 (94.9834%), train_poison_data_count: 403
Global model norm: 42.75096512982192.
Norm before scaling: 42.73205261056974. Distance: 1.5090520635715183
Total norm for 4 adversaries is: 42.73205261056974. distance: 1.5090520635715183
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1354, Accuracy: 9565/9900 (96.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5275/5503 (95.8568%), train_poison_data_count: 430
Global model norm: 42.75096512982192.
Norm before scaling: 42.73225114694915. Distance: 1.500485659496774
Total norm for 4 adversaries is: 42.73225114694915. distance: 1.500485659496774
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0501, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4834/5427 (89.0732%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4859/5427 (89.5338%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0380, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4972/5645 (88.0779%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4917/5645 (87.1036%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0766, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3869/4249 (91.0567%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3898/4249 (91.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9032, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6176/6812 (90.6635%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6182/6812 (90.7516%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9972, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4351/4757 (91.4652%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4334/4757 (91.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9764, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4898/5702 (85.8997%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4888/5702 (85.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2597, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4897/5298 (92.4311%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4899/5298 (92.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0640, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4115/4587 (89.7101%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4132/4587 (90.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1255, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4789/5353 (89.4639%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4740/5353 (88.5485%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0833, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3684/4028 (91.4598%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3695/4028 (91.7329%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8659, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4248/4672 (90.9247%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4280/4672 (91.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9434, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4379/4732 (92.5402%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4402/4732 (93.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9352, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3783/4130 (91.5981%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3776/4130 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0952, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4920/5559 (88.5051%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4828/5559 (86.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1775, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4785/5504 (86.9368%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4799/5504 (87.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1356, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4572/5123 (89.2446%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4358/5123 (85.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0912, Accuracy: 5314/10000 (53.1400%)
time spent on training: 264.12147974967957
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1367, Accuracy: 6906/10000 (69.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3691, Accuracy: 8964/9900 (90.5455%)
Done in 402.0308494567871 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5126/5308 (96.5712%), train_poison_data_count: 415
Global model norm: 42.765719195183074.
Norm before scaling: 42.74338627568597. Distance: 1.3954091447635253
Total norm for 4 adversaries is: 42.74338627568597. distance: 1.3954091447635253
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0341, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5596/5777 (96.8669%), train_poison_data_count: 455
Global model norm: 42.765719195183074.
Norm before scaling: 42.73828678394307. Distance: 1.3693206276974297
Total norm for 4 adversaries is: 42.73828678394307. distance: 1.3693206276974297
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2281, Accuracy: 9385/9900 (94.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4858/5123 (94.8272%), train_poison_data_count: 403
Global model norm: 42.765719195183074.
Norm before scaling: 42.75043973640798. Distance: 1.5378772799935345
Total norm for 4 adversaries is: 42.75043973640798. distance: 1.5378772799935345
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1424, Accuracy: 9523/9900 (96.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5272/5503 (95.8023%), train_poison_data_count: 430
Global model norm: 42.765719195183074.
Norm before scaling: 42.746003616657696. Distance: 1.4956660443678678
Total norm for 4 adversaries is: 42.746003616657696. distance: 1.4956660443678678
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2162, Accuracy: 9381/9900 (94.7576%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4255/4797 (88.7013%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4254/4797 (88.6804%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0116, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4667/5068 (92.0876%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4635/5068 (91.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0256, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4929/5298 (93.0351%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4931/5298 (93.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0941, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4480/4911 (91.2238%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4516/4911 (91.9568%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0479, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4472/4979 (89.8172%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4513/4979 (90.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9930, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4253/4549 (93.4931%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4159/4549 (91.4267%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9040, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4365/4818 (90.5978%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4305/4818 (89.3524%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0351, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5042/5422 (92.9915%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5067/5422 (93.4526%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8847, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4652/5075 (91.6650%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4644/5075 (91.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9965, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4796/5361 (89.4609%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4790/5361 (89.3490%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1651, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3554/3910 (90.8951%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3521/3910 (90.0512%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1499, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4909/5454 (90.0073%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4818/5454 (88.3388%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0607, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4525/5122 (88.3444%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4362/5122 (85.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2680, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5003/5645 (88.6271%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4930/5645 (87.3339%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1879, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5403/5871 (92.0286%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5339/5871 (90.9385%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1752, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6285/6812 (92.2637%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6213/6812 (91.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0368, Accuracy: 5423/10000 (54.2300%)
time spent on training: 264.66129422187805
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1417, Accuracy: 6901/10000 (69.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.3162, Accuracy: 9078/9900 (91.6970%)
Done in 401.8787579536438 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5123/5308 (96.5147%), train_poison_data_count: 415
Global model norm: 42.78164233521707.
Norm before scaling: 42.76130036135185. Distance: 1.4110724096339289
Total norm for 4 adversaries is: 42.76130036135185. distance: 1.4110724096339289
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0603, Accuracy: 9746/9900 (98.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5580/5777 (96.5899%), train_poison_data_count: 455
Global model norm: 42.78164233521707.
Norm before scaling: 42.75455419363971. Distance: 1.4253868079977239
Total norm for 4 adversaries is: 42.75455419363971. distance: 1.4253868079977239
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0958, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4873/5123 (95.1200%), train_poison_data_count: 403
Global model norm: 42.78164233521707.
Norm before scaling: 42.765469434773685. Distance: 1.5438033924831018
Total norm for 4 adversaries is: 42.765469434773685. distance: 1.5438033924831018
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1113, Accuracy: 9615/9900 (97.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5282/5503 (95.9840%), train_poison_data_count: 430
Global model norm: 42.78164233521707.
Norm before scaling: 42.76138885669086. Distance: 1.4425326445801223
Total norm for 4 adversaries is: 42.76138885669086. distance: 1.4425326445801223
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0755, Accuracy: 9698/9900 (97.9596%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6243/6812 (91.6471%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6231/6812 (91.4709%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2873, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3956/4196 (94.2803%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3963/4196 (94.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8886, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4847/5489 (88.3039%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4925/5489 (89.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0321, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4837/5353 (90.3605%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4726/5353 (88.2869%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0462, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4151/4397 (94.4053%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8594, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3534/3995 (88.4606%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3547/3995 (88.7860%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0073, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4841/5361 (90.3003%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4730/5361 (88.2298%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1240, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4495/5018 (89.5775%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4390/5018 (87.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0782, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4582/5123 (89.4398%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0091, Accuracy: 4292/5123 (83.7790%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2927, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4386/4843 (90.5637%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4410/4843 (91.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0644, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4508/4929 (91.4587%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4450/4929 (90.2820%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2070, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4383/4869 (90.0185%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0108, Accuracy: 3913/4869 (80.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3297, Accuracy: 4862/10000 (48.6200%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4875/5298 (92.0159%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4887/5298 (92.2424%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0241, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3972/4364 (91.0174%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3827/4364 (87.6948%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1609, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3764/4111 (91.5592%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3707/4111 (90.1727%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9978, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3657/4028 (90.7895%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3711/4028 (92.1301%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9460, Accuracy: 5623/10000 (56.2300%)
time spent on training: 261.35641980171204
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1445, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2596, Accuracy: 9230/9900 (93.2323%)
Done in 411.417279958725 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5142/5308 (96.8726%), train_poison_data_count: 415
Global model norm: 42.79594513411142.
Norm before scaling: 42.772667658597264. Distance: 1.3726314171166105
Total norm for 4 adversaries is: 42.772667658597264. distance: 1.3726314171166105
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0622, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5613/5777 (97.1612%), train_poison_data_count: 455
Global model norm: 42.79594513411142.
Norm before scaling: 42.765390938343764. Distance: 1.345887148030194
Total norm for 4 adversaries is: 42.765390938343764. distance: 1.345887148030194
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1161, Accuracy: 9614/9900 (97.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4865/5123 (94.9639%), train_poison_data_count: 403
Global model norm: 42.79594513411142.
Norm before scaling: 42.77748910605612. Distance: 1.5146929834580218
Total norm for 4 adversaries is: 42.77748910605612. distance: 1.5146929834580218
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1304, Accuracy: 9589/9900 (96.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 42.79594513411142.
Norm before scaling: 42.77558713205685. Distance: 1.469804912519168
Total norm for 4 adversaries is: 42.77558713205685. distance: 1.469804912519168
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0633, Accuracy: 9731/9900 (98.2929%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3950/4196 (94.1373%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3973/4196 (94.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7914, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4872/5298 (91.9592%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4942/5298 (93.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0355, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3866/4249 (90.9861%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3866/4249 (90.9861%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0504, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4621/5123 (90.2011%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4546/5123 (88.7371%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1041, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3811/4130 (92.2760%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3831/4130 (92.7603%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9661, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4502/4979 (90.4198%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4503/4979 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9986, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4858/5353 (90.7528%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4755/5353 (88.8287%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1200, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4295/4672 (91.9307%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4362/4672 (93.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8641, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4133/4587 (90.1025%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4178/4587 (91.0835%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1775, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4555/5122 (88.9301%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4332/5122 (84.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.4494, Accuracy: 4782/10000 (47.8200%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4344/4818 (90.1619%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4323/4818 (89.7260%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1971, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4663/4993 (93.3907%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4625/4993 (92.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9829, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4377/4903 (89.2719%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4349/4903 (88.7008%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1242, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4933/5559 (88.7390%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4936/5559 (88.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2974, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4492/4830 (93.0021%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4527/4830 (93.7267%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0477, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5170/5696 (90.7654%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5195/5696 (91.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9960, Accuracy: 5341/10000 (53.4100%)
time spent on training: 268.69949436187744
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1434, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2344, Accuracy: 9294/9900 (93.8788%)
Done in 406.58034658432007 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5108/5308 (96.2321%), train_poison_data_count: 415
Global model norm: 42.81040568554493.
Norm before scaling: 42.78804331107728. Distance: 1.3995380865749691
Total norm for 4 adversaries is: 42.78804331107728. distance: 1.3995380865749691
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0385, Accuracy: 9796/9900 (98.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5599/5777 (96.9188%), train_poison_data_count: 455
Global model norm: 42.81040568554493.
Norm before scaling: 42.779712011251604. Distance: 1.3810945173067857
Total norm for 4 adversaries is: 42.779712011251604. distance: 1.3810945173067857
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1585, Accuracy: 9531/9900 (96.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4851/5123 (94.6906%), train_poison_data_count: 403
Global model norm: 42.81040568554493.
Norm before scaling: 42.796960569465384. Distance: 1.574162938948432
Total norm for 4 adversaries is: 42.796960569465384. distance: 1.574162938948432
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1859, Accuracy: 9439/9900 (95.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5328/5503 (96.8199%), train_poison_data_count: 430
Global model norm: 42.81040568554493.
Norm before scaling: 42.78645421231467. Distance: 1.3579741966622023
Total norm for 4 adversaries is: 42.78645421231467. distance: 1.3579741966622023
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1191, Accuracy: 9579/9900 (96.7576%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3957/4196 (94.3041%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3942/4196 (93.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8675, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4600/5123 (89.7911%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4221/5123 (82.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.5744, Accuracy: 4589/10000 (45.8900%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4255/4605 (92.3996%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4228/4605 (91.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0002, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4209/4736 (88.8725%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4236/4736 (89.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0095, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4330/4714 (91.8541%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4382/4714 (92.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0242, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4900/5489 (89.2694%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4929/5489 (89.7978%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2423, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4481/4911 (91.2441%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4497/4911 (91.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1464, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3529/3959 (89.1387%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3584/3959 (90.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0889, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5431/5939 (91.4464%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5474/5939 (92.1704%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0944, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5084/5615 (90.5432%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5066/5615 (90.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2749, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 6271/6947 (90.2692%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6110/6947 (87.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.4069, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4793/5504 (87.0821%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4799/5504 (87.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1484, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4392/4748 (92.5021%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4395/4748 (92.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1256, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4950/5645 (87.6882%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4919/5645 (87.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3116, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5356/6080 (88.0921%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5325/6080 (87.5822%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1326, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3303/3589 (92.0312%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3217/3589 (89.6350%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0520, Accuracy: 5386/10000 (53.8600%)
time spent on training: 270.7147572040558
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1435, Accuracy: 6889/10000 (68.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2095, Accuracy: 9361/9900 (94.5556%)
Done in 408.72507667541504 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5144/5308 (96.9103%), train_poison_data_count: 415
Global model norm: 42.82539011014304.
Norm before scaling: 42.79928514115335. Distance: 1.305257432911709
Total norm for 4 adversaries is: 42.79928514115335. distance: 1.305257432911709
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0988, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5602/5777 (96.9707%), train_poison_data_count: 455
Global model norm: 42.82539011014304.
Norm before scaling: 42.7975210452333. Distance: 1.4130923910988817
Total norm for 4 adversaries is: 42.7975210452333. distance: 1.4130923910988817
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0393, Accuracy: 9793/9900 (98.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4852/5123 (94.7101%), train_poison_data_count: 403
Global model norm: 42.82539011014304.
Norm before scaling: 42.80873044536301. Distance: 1.5205302350124965
Total norm for 4 adversaries is: 42.80873044536301. distance: 1.5205302350124965
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2815, Accuracy: 9202/9900 (92.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5297/5503 (96.2566%), train_poison_data_count: 430
Global model norm: 42.82539011014304.
Norm before scaling: 42.803985239037615. Distance: 1.4720391313596763
Total norm for 4 adversaries is: 42.803985239037615. distance: 1.4720391313596763
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1139, Accuracy: 9612/9900 (97.0909%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4790/5361 (89.3490%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4814/5361 (89.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0550, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3754/4086 (91.8747%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3830/4086 (93.7347%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0134, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4894/5702 (85.8295%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4629/5702 (81.1820%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3250, Accuracy: 4855/10000 (48.5500%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5307/6080 (87.2862%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5302/6080 (87.2039%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1899, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5424/5939 (91.3285%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5415/5939 (91.1770%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0598, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4889/5497 (88.9394%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4865/5497 (88.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1407, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4548/5038 (90.2739%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4552/5038 (90.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8847, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4641/4993 (92.9501%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4559/4993 (91.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1933, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4353/4903 (88.7824%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4423/4903 (90.2101%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2860, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6247/6812 (91.7058%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6197/6812 (90.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1376, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4973/5526 (89.9928%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4920/5526 (89.0337%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0050, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3580/3910 (91.5601%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3467/3910 (88.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1113, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4709/5075 (92.7882%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4592/5075 (90.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1495, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3758/4108 (91.4800%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3752/4108 (91.3340%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9978, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4947/5298 (93.3749%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4901/5298 (92.5066%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0925, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4995/5422 (92.1247%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4990/5422 (92.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9648, Accuracy: 5509/10000 (55.0900%)
time spent on training: 269.39729928970337
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1459, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1866, Accuracy: 9435/9900 (95.3030%)
Done in 407.4240782260895 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5158/5308 (97.1741%), train_poison_data_count: 415
Global model norm: 42.84126115354872.
Norm before scaling: 42.81632909427635. Distance: 1.3091509188006998
Total norm for 4 adversaries is: 42.81632909427635. distance: 1.3091509188006998
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0560, Accuracy: 9745/9900 (98.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5596/5777 (96.8669%), train_poison_data_count: 455
Global model norm: 42.84126115354872.
Norm before scaling: 42.812541343501934. Distance: 1.3748774040361382
Total norm for 4 adversaries is: 42.812541343501934. distance: 1.3748774040361382
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0968, Accuracy: 9657/9900 (97.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4880/5123 (95.2567%), train_poison_data_count: 403
Global model norm: 42.84126115354872.
Norm before scaling: 42.82131524209059. Distance: 1.4761978587245774
Total norm for 4 adversaries is: 42.82131524209059. distance: 1.4761978587245774
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1908, Accuracy: 9445/9900 (95.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 42.84126115354872.
Norm before scaling: 42.81906028660747. Distance: 1.436065455599895
Total norm for 4 adversaries is: 42.81906028660747. distance: 1.436065455599895
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1020, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5432/5939 (91.4632%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5434/5939 (91.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1869, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4291/4894 (87.6788%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4292/4894 (87.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1629, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4777/5353 (89.2397%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4827/5353 (90.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9779, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4043/4527 (89.3086%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3985/4527 (88.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1478, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3560/3929 (90.6083%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3606/3929 (91.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8507, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5379/5907 (91.0615%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5297/5907 (89.6733%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2131, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5032/5652 (89.0304%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5026/5652 (88.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.3019, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4420/4843 (91.2657%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4427/4843 (91.4103%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0063, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3602/3968 (90.7762%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3655/3968 (92.1119%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8424, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4458/4889 (91.1843%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4484/4889 (91.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2823, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3217/3552 (90.5687%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3301/3552 (92.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8961, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3819/4086 (93.4655%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3835/4086 (93.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9389, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4555/4979 (91.4842%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4556/4979 (91.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0426, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4634/5035 (92.0357%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4646/5035 (92.2741%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0288, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4594/5122 (89.6915%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0157, Accuracy: 3666/5122 (71.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.7346, Accuracy: 4275/10000 (42.7500%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5100/5615 (90.8281%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5132/5615 (91.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1513, Accuracy: 5235/10000 (52.3500%)
time spent on training: 259.71506690979004
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1577, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1535, Accuracy: 9506/9900 (96.0202%)
Done in 399.4679307937622 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5141/5308 (96.8538%), train_poison_data_count: 415
Global model norm: 42.85515524478575.
Norm before scaling: 42.83030537591053. Distance: 1.3537523026944316
Total norm for 4 adversaries is: 42.83030537591053. distance: 1.3537523026944316
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0648, Accuracy: 9737/9900 (98.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5619/5777 (97.2650%), train_poison_data_count: 455
Global model norm: 42.85515524478575.
Norm before scaling: 42.82381522459933. Distance: 1.3538929246883968
Total norm for 4 adversaries is: 42.82381522459933. distance: 1.3538929246883968
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0332, Accuracy: 9818/9900 (99.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4882/5123 (95.2957%), train_poison_data_count: 403
Global model norm: 42.85515524478575.
Norm before scaling: 42.835858420271705. Distance: 1.4848593473774345
Total norm for 4 adversaries is: 42.835858420271705. distance: 1.4848593473774345
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1650, Accuracy: 9516/9900 (96.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5311/5503 (96.5110%), train_poison_data_count: 430
Global model norm: 42.85515524478575.
Norm before scaling: 42.83257256412388. Distance: 1.4200564482040197
Total norm for 4 adversaries is: 42.83257256412388. distance: 1.4200564482040197
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0551, Accuracy: 9759/9900 (98.5758%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4498/4830 (93.1263%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4469/4830 (92.5259%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0314, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4307/4737 (90.9225%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4265/4737 (90.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1863, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5044/5615 (89.8308%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5070/5615 (90.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3224, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3552/3959 (89.7196%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3598/3959 (90.8815%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9541, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3806/4175 (91.1617%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3812/4175 (91.3054%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9227, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5066/5526 (91.6757%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4874/5526 (88.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2095, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4168/4537 (91.8669%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4166/4537 (91.8228%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9080, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3915/4313 (90.7721%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3935/4313 (91.2358%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0483, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5070/5422 (93.5079%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5013/5422 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0582, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4962/5645 (87.9008%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4789/5645 (84.8361%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0206, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4337/4741 (91.4786%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3834/4741 (80.8690%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.6242, Accuracy: 4559/10000 (45.5900%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5154/5696 (90.4846%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5069/5696 (88.9923%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0882, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4559/5038 (90.4923%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4576/5038 (90.8297%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9818, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4364/4903 (89.0067%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4399/4903 (89.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0204, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4661/5068 (91.9692%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4601/5068 (90.7853%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2997, Accuracy: 4958/10000 (49.5800%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4407/4748 (92.8180%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4393/4748 (92.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1165, Accuracy: 5357/10000 (53.5700%)
time spent on training: 274.1998088359833
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1594, Accuracy: 6861/10000 (68.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1320, Accuracy: 9567/9900 (96.6364%)
Done in 412.3632159233093 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5157/5308 (97.1552%), train_poison_data_count: 415
Global model norm: 42.87092557626468.
Norm before scaling: 42.84530420913636. Distance: 1.3518638495392352
Total norm for 4 adversaries is: 42.84530420913636. distance: 1.3518638495392352
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0122, Accuracy: 9865/9900 (99.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5608/5777 (97.0746%), train_poison_data_count: 455
Global model norm: 42.87092557626468.
Norm before scaling: 42.84168855589509. Distance: 1.3873519955989477
Total norm for 4 adversaries is: 42.84168855589509. distance: 1.3873519955989477
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0599, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4879/5123 (95.2372%), train_poison_data_count: 403
Global model norm: 42.87092557626468.
Norm before scaling: 42.85285649254099. Distance: 1.5193620209981031
Total norm for 4 adversaries is: 42.85285649254099. distance: 1.5193620209981031
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1066, Accuracy: 9641/9900 (97.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5291/5503 (96.1476%), train_poison_data_count: 430
Global model norm: 42.87092557626468.
Norm before scaling: 42.849097610283756. Distance: 1.4388068519846975
Total norm for 4 adversaries is: 42.849097610283756. distance: 1.4388068519846975
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0865, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3211/3552 (90.3998%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3304/3552 (93.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8706, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3627/3910 (92.7621%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3300/3910 (84.3990%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.3990, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4785/5399 (88.6275%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4751/5399 (87.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1607, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5056/5615 (90.0445%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5113/5615 (91.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2846, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5627/6419 (87.6616%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5508/6419 (85.8078%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2458, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4403/4889 (90.0593%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4412/4889 (90.2434%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0994, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4827/5427 (88.9442%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4926/5427 (90.7684%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0944, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5230/5696 (91.8188%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5198/5696 (91.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9423, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4130/4537 (91.0293%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4131/4537 (91.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0553, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3565/3995 (89.2365%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3527/3995 (88.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1229, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4681/4993 (93.7513%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4641/4993 (92.9501%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0298, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4374/4869 (89.8336%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4283/4869 (87.9647%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1471, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4695/5068 (92.6401%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4598/5068 (90.7261%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1714, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3484/3774 (92.3158%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3520/3774 (93.2697%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1065, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4928/5298 (93.0162%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4899/5298 (92.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1020, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4968/5461 (90.9723%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4977/5461 (91.1372%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1824, Accuracy: 5200/10000 (52.0000%)
time spent on training: 265.7355160713196
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1632, Accuracy: 6859/10000 (68.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1132, Accuracy: 9616/9900 (97.1313%)
Done in 403.5423860549927 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5164/5308 (97.2871%), train_poison_data_count: 415
Global model norm: 42.88537080750119.
Norm before scaling: 42.85905173274005. Distance: 1.2805313327803336
Total norm for 4 adversaries is: 42.85905173274005. distance: 1.2805313327803336
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0600, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 42.88537080750119.
Norm before scaling: 42.85322538364236. Distance: 1.320358004716947
Total norm for 4 adversaries is: 42.85322538364236. distance: 1.320358004716947
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0392, Accuracy: 9808/9900 (99.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4881/5123 (95.2762%), train_poison_data_count: 403
Global model norm: 42.88537080750119.
Norm before scaling: 42.864646618017275. Distance: 1.493247569351862
Total norm for 4 adversaries is: 42.864646618017275. distance: 1.493247569351862
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0789, Accuracy: 9692/9900 (97.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5356/5503 (97.3287%), train_poison_data_count: 430
Global model norm: 42.88537080750119.
Norm before scaling: 42.85848921341314. Distance: 1.3460861568934175
Total norm for 4 adversaries is: 42.85848921341314. distance: 1.3460861568934175
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0385, Accuracy: 9791/9900 (98.8990%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3558/3995 (89.0613%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3522/3995 (88.1602%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1174, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4384/4851 (90.3731%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4372/4851 (90.1257%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1556, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4651/5035 (92.3734%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4650/5035 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1524, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3811/4130 (92.2760%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3839/4130 (92.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8763, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4433/5018 (88.3420%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4426/5018 (88.2025%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1807, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4968/5346 (92.9293%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4944/5346 (92.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1185, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4530/4929 (91.9051%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4444/4929 (90.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2137, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4954/5454 (90.8324%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4861/5454 (89.1272%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1637, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3796/4108 (92.4051%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3713/4108 (90.3846%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0047, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4060/4368 (92.9487%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3921/4368 (89.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1516, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3879/4249 (91.2921%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3855/4249 (90.7272%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0259, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4271/4737 (90.1626%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4309/4737 (90.9647%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0748, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6237/6812 (91.5590%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6230/6812 (91.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2366, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5457/5939 (91.8842%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5467/5939 (92.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9255, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5326/5907 (90.1642%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5308/5907 (89.8595%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3910, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4401/4843 (90.8734%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4393/4843 (90.7082%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1477, Accuracy: 5236/10000 (52.3600%)
time spent on training: 273.25650691986084
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1656, Accuracy: 6850/10000 (68.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0969, Accuracy: 9651/9900 (97.4848%)
Done in 409.36921787261963 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5165/5308 (97.3060%), train_poison_data_count: 415
Global model norm: 42.89990792075637.
Norm before scaling: 42.87253147503801. Distance: 1.284090614855879
Total norm for 4 adversaries is: 42.87253147503801. distance: 1.284090614855879
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0329, Accuracy: 9815/9900 (99.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5607/5777 (97.0573%), train_poison_data_count: 455
Global model norm: 42.89990792075637.
Norm before scaling: 42.867887301787455. Distance: 1.3402255212262886
Total norm for 4 adversaries is: 42.867887301787455. distance: 1.3402255212262886
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0469, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4898/5123 (95.6080%), train_poison_data_count: 403
Global model norm: 42.89990792075637.
Norm before scaling: 42.8786498537588. Distance: 1.4401958728400057
Total norm for 4 adversaries is: 42.8786498537588. distance: 1.4401958728400057
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1112, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5331/5503 (96.8744%), train_poison_data_count: 430
Global model norm: 42.89990792075637.
Norm before scaling: 42.87469820411276. Distance: 1.3742848183612266
Total norm for 4 adversaries is: 42.87469820411276. distance: 1.3742848183612266
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0215, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6239/6812 (91.5884%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 6166/6812 (90.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1115, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4981/5346 (93.1725%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4880/5346 (91.2832%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0950, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5020/5526 (90.8433%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4883/5526 (88.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1338, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4394/4757 (92.3691%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4271/4757 (89.7835%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1628, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4536/5018 (90.3946%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4417/5018 (88.0231%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1761, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4207/4537 (92.7265%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4241/4537 (93.4759%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8558, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4651/4993 (93.1504%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4607/4993 (92.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0567, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5523/6235 (88.5806%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5518/6235 (88.5004%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2779, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4748/5193 (91.4308%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4501/5193 (86.6744%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3892, Accuracy: 4886/10000 (48.8600%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4070/4485 (90.7469%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3721/4485 (82.9654%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2836, Accuracy: 4865/10000 (48.6500%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5361/6080 (88.1743%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5342/6080 (87.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3730, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4610/5224 (88.2466%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4654/5224 (89.0888%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1367, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4373/4869 (89.8131%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4193/4869 (86.1162%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2256, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4507/4956 (90.9403%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4367/4956 (88.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1956, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5151/5696 (90.4319%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5156/5696 (90.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0567, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4473/4889 (91.4911%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4439/4889 (90.7957%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1190, Accuracy: 5243/10000 (52.4300%)
time spent on training: 276.3200764656067
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1649, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0849, Accuracy: 9696/9900 (97.9394%)
Done in 408.56403946876526 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 42.91684791501978.
Norm before scaling: 42.88493672435069. Distance: 1.1862743979739734
Total norm for 4 adversaries is: 42.88493672435069. distance: 1.1862743979739734
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0983, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5603/5777 (96.9881%), train_poison_data_count: 455
Global model norm: 42.91684791501978.
Norm before scaling: 42.885954322190386. Distance: 1.3672699385720402
Total norm for 4 adversaries is: 42.885954322190386. distance: 1.3672699385720402
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0592, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4896/5123 (95.5690%), train_poison_data_count: 403
Global model norm: 42.91684791501978.
Norm before scaling: 42.89652310311335. Distance: 1.4780058088898231
Total norm for 4 adversaries is: 42.89652310311335. distance: 1.4780058088898231
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1103, Accuracy: 9633/9900 (97.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5331/5503 (96.8744%), train_poison_data_count: 430
Global model norm: 42.91684791501978.
Norm before scaling: 42.89145320238637. Distance: 1.4020118851994585
Total norm for 4 adversaries is: 42.89145320238637. distance: 1.4020118851994585
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0424, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5049/5422 (93.1206%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5028/5422 (92.7333%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0309, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4958/5497 (90.1947%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4881/5497 (88.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0056, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5672/6419 (88.3627%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5487/6419 (85.4806%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3806, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5412/5871 (92.1819%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5355/5871 (91.2110%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0478, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4144/4397 (94.2461%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4179/4397 (95.0421%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8007, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4680/4993 (93.7312%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4622/4993 (92.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0585, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3564/3959 (90.0227%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3601/3959 (90.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0810, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5011/5652 (88.6589%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5014/5652 (88.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2972, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4905/5702 (86.0224%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4702/5702 (82.4623%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1781, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3615/3968 (91.1038%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3676/3968 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8513, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5480/5939 (92.2714%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5470/5939 (92.1030%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1120, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4603/5123 (89.8497%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4485/5123 (87.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3265, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4262/4549 (93.6909%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3930/4549 (86.3926%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1780, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3208/3552 (90.3153%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3272/3552 (92.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9512, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4559/5122 (89.0082%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4063/5122 (79.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.4798, Accuracy: 4680/10000 (46.8000%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6230/6812 (91.4563%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 6169/6812 (90.5608%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1920, Accuracy: 5244/10000 (52.4400%)
time spent on training: 272.09886837005615
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1634, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0770, Accuracy: 9706/9900 (98.0404%)
Done in 407.9114863872528 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 42.93111419945038.
Norm before scaling: 42.901425951042846. Distance: 1.2336516373371729
Total norm for 4 adversaries is: 42.901425951042846. distance: 1.2336516373371729
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0839, Accuracy: 9688/9900 (97.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5606/5777 (97.0400%), train_poison_data_count: 455
Global model norm: 42.93111419945038.
Norm before scaling: 42.89968739642443. Distance: 1.3716691160276722
Total norm for 4 adversaries is: 42.89968739642443. distance: 1.3716691160276722
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0882, Accuracy: 9682/9900 (97.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4879/5123 (95.2372%), train_poison_data_count: 403
Global model norm: 42.93111419945038.
Norm before scaling: 42.910214390322466. Distance: 1.4860083979270498
Total norm for 4 adversaries is: 42.910214390322466. distance: 1.4860083979270498
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1996, Accuracy: 9404/9900 (94.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5329/5503 (96.8381%), train_poison_data_count: 430
Global model norm: 42.93111419945038.
Norm before scaling: 42.90338067381389. Distance: 1.346919956032306
Total norm for 4 adversaries is: 42.90338067381389. distance: 1.346919956032306
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0378, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4341/4731 (91.7565%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4373/4731 (92.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0112, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4331/4797 (90.2856%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4300/4797 (89.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0284, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4656/5035 (92.4727%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4599/5035 (91.3406%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0454, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4831/5362 (90.0970%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4836/5362 (90.1902%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2405, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4611/5123 (90.0059%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4400/5123 (85.8872%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2570, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4926/5346 (92.1437%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4884/5346 (91.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1610, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4355/4714 (92.3844%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4378/4714 (92.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9064, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5018/5652 (88.7827%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5001/5652 (88.4820%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0888, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4016/4527 (88.7122%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3949/4527 (87.2322%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0937, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3983/4313 (92.3487%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3984/4313 (92.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8694, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6255/6947 (90.0389%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6175/6947 (88.8873%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1019, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4675/4993 (93.6311%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4587/4993 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0735, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4639/5086 (91.2112%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4663/5086 (91.6831%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1242, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4600/5038 (91.3061%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4589/5038 (91.0877%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0046, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4945/5461 (90.5512%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4879/5461 (89.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1181, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5119/5727 (89.3836%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5084/5727 (88.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0775, Accuracy: 5369/10000 (53.6900%)
time spent on training: 273.5929036140442
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1606, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0754, Accuracy: 9712/9900 (98.1010%)
Done in 407.4800567626953 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5159/5308 (97.1929%), train_poison_data_count: 415
Global model norm: 42.946120461519136.
Norm before scaling: 42.91957128874163. Distance: 1.301877450560682
Total norm for 4 adversaries is: 42.91957128874163. distance: 1.301877450560682
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0585, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5650/5777 (97.8016%), train_poison_data_count: 455
Global model norm: 42.946120461519136.
Norm before scaling: 42.91210470798129. Distance: 1.2818811769304101
Total norm for 4 adversaries is: 42.91210470798129. distance: 1.2818811769304101
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0799, Accuracy: 9701/9900 (97.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4900/5123 (95.6471%), train_poison_data_count: 403
Global model norm: 42.946120461519136.
Norm before scaling: 42.92610241513533. Distance: 1.4421934547177395
Total norm for 4 adversaries is: 42.92610241513533. distance: 1.4421934547177395
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1549, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5338/5503 (97.0016%), train_poison_data_count: 430
Global model norm: 42.946120461519136.
Norm before scaling: 42.918056744528435. Distance: 1.3237366825691024
Total norm for 4 adversaries is: 42.918056744528435. distance: 1.3237366825691024
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0451, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3943/4313 (91.4213%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3939/4313 (91.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9569, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4389/4894 (89.6812%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4295/4894 (87.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2226, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4187/4397 (95.2240%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4217/4397 (95.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8002, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4394/4748 (92.5442%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4398/4748 (92.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1329, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5228/5696 (91.7837%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5111/5696 (89.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9224, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4887/5427 (90.0498%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4828/5427 (88.9626%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9730, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4274/4605 (92.8122%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4284/4605 (93.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1451, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5064/5422 (93.3973%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5065/5422 (93.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9325, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5443/5871 (92.7099%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5348/5871 (91.0918%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0776, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5032/5652 (89.0304%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5060/5652 (89.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1780, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4870/5362 (90.8243%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4768/5362 (88.9220%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1538, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4904/5702 (86.0049%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4657/5702 (81.6731%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3600, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4661/5075 (91.8424%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4587/5075 (90.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2386, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5529/6068 (91.1173%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5569/6068 (91.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1437, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6257/6812 (91.8526%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6240/6812 (91.6031%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0887, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4422/4732 (93.4489%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4432/4732 (93.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8963, Accuracy: 5676/10000 (56.7600%)
time spent on training: 271.61370825767517
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1574, Accuracy: 6866/10000 (68.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0748, Accuracy: 9713/9900 (98.1111%)
Done in 412.7013792991638 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5189/5308 (97.7581%), train_poison_data_count: 415
Global model norm: 42.96075493800999.
Norm before scaling: 42.93062655365121. Distance: 1.2156506768581803
Total norm for 4 adversaries is: 42.93062655365121. distance: 1.2156506768581803
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0816, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5649/5777 (97.7843%), train_poison_data_count: 455
Global model norm: 42.96075493800999.
Norm before scaling: 42.926773530539045. Distance: 1.2724691816693794
Total norm for 4 adversaries is: 42.926773530539045. distance: 1.2724691816693794
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0617, Accuracy: 9741/9900 (98.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4910/5123 (95.8423%), train_poison_data_count: 403
Global model norm: 42.96075493800999.
Norm before scaling: 42.93828465440253. Distance: 1.4234257719559642
Total norm for 4 adversaries is: 42.93828465440253. distance: 1.4234257719559642
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0976, Accuracy: 9664/9900 (97.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5336/5503 (96.9653%), train_poison_data_count: 430
Global model norm: 42.96075493800999.
Norm before scaling: 42.93190465725927. Distance: 1.3402087545767325
Total norm for 4 adversaries is: 42.93190465725927. distance: 1.3402087545767325
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0301, Accuracy: 9823/9900 (99.2222%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5576/6235 (89.4306%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5626/6235 (90.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2548, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5078/5422 (93.6555%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5014/5422 (92.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8015, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4116/4587 (89.7319%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4097/4587 (89.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0515, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4817/5399 (89.2202%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4747/5399 (87.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3350, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3608/3910 (92.2762%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3527/3910 (90.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1460, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5332/5907 (90.2658%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5208/5907 (88.1666%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.5599, Accuracy: 4794/10000 (47.9400%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4825/5361 (90.0019%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4764/5361 (88.8640%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1131, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4485/5018 (89.3782%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4444/5018 (88.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1670, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 6247/6947 (89.9237%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6088/6947 (87.6350%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2731, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3281/3589 (91.4182%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3096/3589 (86.2636%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2164, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4998/5559 (89.9083%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4921/5559 (88.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1414, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6241/6812 (91.6177%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 6141/6812 (90.1497%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2579, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4979/5346 (93.1351%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4936/5346 (92.3307%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1042, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4345/4903 (88.6192%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4372/4903 (89.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1022, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4219/4397 (95.9518%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0020, Accuracy: 4246/4397 (96.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7530, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4684/5035 (93.0288%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4692/5035 (93.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9236, Accuracy: 5590/10000 (55.9000%)
time spent on training: 271.3387916088104
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1554, Accuracy: 6860/10000 (68.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0683, Accuracy: 9731/9900 (98.2929%)
Done in 412.26455950737 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 42.97476236345365.
Norm before scaling: 42.94686658662509. Distance: 1.2748299691013774
Total norm for 4 adversaries is: 42.94686658662509. distance: 1.2748299691013774
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0305, Accuracy: 9823/9900 (99.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 42.97476236345365.
Norm before scaling: 42.94084747458925. Distance: 1.2950500148703235
Total norm for 4 adversaries is: 42.94084747458925. distance: 1.2950500148703235
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0452, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4922/5123 (96.0765%), train_poison_data_count: 403
Global model norm: 42.97476236345365.
Norm before scaling: 42.952246830782904. Distance: 1.3815390116194786
Total norm for 4 adversaries is: 42.952246830782904. distance: 1.3815390116194786
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0787, Accuracy: 9688/9900 (97.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5336/5503 (96.9653%), train_poison_data_count: 430
Global model norm: 42.97476236345365.
Norm before scaling: 42.94808736146247. Distance: 1.363167044766435
Total norm for 4 adversaries is: 42.94808736146247. distance: 1.363167044766435
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0283, Accuracy: 9839/9900 (99.3838%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5389/5871 (91.7902%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5310/5871 (90.4446%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1549, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4681/5193 (90.1406%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4466/5193 (86.0004%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4053, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5005/5559 (90.0342%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4933/5559 (88.7390%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1616, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4406/4843 (90.9767%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4414/4843 (91.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9829, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4316/4672 (92.3801%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4324/4672 (92.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9227, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4726/5075 (93.1232%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4660/5075 (91.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2700, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4389/4851 (90.4762%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4411/4851 (90.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0813, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4711/5209 (90.4396%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4702/5209 (90.2668%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2036, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5196/5696 (91.2219%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5099/5696 (89.5190%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1569, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4604/5122 (89.8868%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4335/5122 (84.6349%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2724, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4305/4741 (90.8036%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4093/4741 (86.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3364, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4285/4797 (89.3267%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4253/4797 (88.6596%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0244, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3968/4196 (94.5663%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3950/4196 (94.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9434, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3754/4111 (91.3160%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3736/4111 (90.8781%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0320, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4428/4869 (90.9427%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4083/4869 (83.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3657, Accuracy: 4812/10000 (48.1200%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5023/5645 (88.9814%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4951/5645 (87.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0666, Accuracy: 5183/10000 (51.8300%)
time spent on training: 260.32319831848145
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1562, Accuracy: 6860/10000 (68.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0567, Accuracy: 9760/9900 (98.5859%)
Done in 403.0931649208069 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 42.98974203134831.
Norm before scaling: 42.96060150009541. Distance: 1.254117811187152
Total norm for 4 adversaries is: 42.96060150009541. distance: 1.254117811187152
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0675, Accuracy: 9741/9900 (98.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5642/5777 (97.6631%), train_poison_data_count: 455
Global model norm: 42.98974203134831.
Norm before scaling: 42.95217435970573. Distance: 1.2325651687044603
Total norm for 4 adversaries is: 42.95217435970573. distance: 1.2325651687044603
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0240, Accuracy: 9840/9900 (99.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4933/5123 (96.2912%), train_poison_data_count: 403
Global model norm: 42.98974203134831.
Norm before scaling: 42.965785409093975. Distance: 1.3950593947341885
Total norm for 4 adversaries is: 42.965785409093975. distance: 1.3950593947341885
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1060, Accuracy: 9632/9900 (97.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 42.98974203134831.
Norm before scaling: 42.959606981806175. Distance: 1.2696112974313227
Total norm for 4 adversaries is: 42.959606981806175. distance: 1.2696112974313227
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0862, Accuracy: 9675/9900 (97.7273%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4849/5353 (90.5847%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4739/5353 (88.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0887, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3230/3552 (90.9347%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3289/3552 (92.5957%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8919, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3581/3959 (90.4521%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3606/3959 (91.0836%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9466, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4529/5055 (89.5945%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4520/5055 (89.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2377, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4915/5702 (86.1978%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0131, Accuracy: 4321/5702 (75.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3889, Accuracy: 4744/10000 (47.4400%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3784/4108 (92.1130%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3812/4108 (92.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8815, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6189/6812 (90.8544%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 6152/6812 (90.3112%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0839, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4099/4485 (91.3935%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3980/4485 (88.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1084, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4695/5193 (90.4102%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4489/5193 (86.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2891, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4152/4397 (94.4280%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7363, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3790/4145 (91.4355%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3819/4145 (92.1351%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0651, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4969/5346 (92.9480%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4983/5346 (93.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0332, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3469/3774 (91.9184%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3514/3774 (93.1108%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8941, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5018/5461 (91.8879%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5041/5461 (92.3091%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0993, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5043/5652 (89.2251%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4936/5652 (87.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1393, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5534/5939 (93.1807%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5485/5939 (92.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0359, Accuracy: 5347/10000 (53.4700%)
time spent on training: 271.4737627506256
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1634, Accuracy: 6847/10000 (68.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0519, Accuracy: 9774/9900 (98.7273%)
Done in 408.4644672870636 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5308 (97.3625%), train_poison_data_count: 415
Global model norm: 43.00206662911679.
Norm before scaling: 42.97152121745503. Distance: 1.2140486099057362
Total norm for 4 adversaries is: 42.97152121745503. distance: 1.2140486099057362
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0391, Accuracy: 9802/9900 (99.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5627/5777 (97.4035%), train_poison_data_count: 455
Global model norm: 43.00206662911679.
Norm before scaling: 42.966711599377284. Distance: 1.2645858454587684
Total norm for 4 adversaries is: 42.966711599377284. distance: 1.2645858454587684
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0619, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4939/5123 (96.4084%), train_poison_data_count: 403
Global model norm: 43.00206662911679.
Norm before scaling: 42.97844634914038. Distance: 1.3776398373500447
Total norm for 4 adversaries is: 42.97844634914038. distance: 1.3776398373500447
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0758, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5368/5503 (97.5468%), train_poison_data_count: 430
Global model norm: 43.00206662911679.
Norm before scaling: 42.97238194877685. Distance: 1.2939355468381484
Total norm for 4 adversaries is: 42.97238194877685. distance: 1.2939355468381484
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0891, Accuracy: 9677/9900 (97.7475%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4113/4485 (91.7057%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3864/4485 (86.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2410, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4286/4605 (93.0727%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4278/4605 (92.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9272, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5234/5696 (91.8890%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5140/5696 (90.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1299, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3846/4161 (92.4297%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3814/4161 (91.6607%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2384, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3965/4196 (94.4948%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3957/4196 (94.3041%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8158, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4363/4818 (90.5562%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4237/4818 (87.9411%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9766, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4640/4993 (92.9301%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4608/4993 (92.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1635, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3657/3968 (92.1623%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3662/3968 (92.2883%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8681, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5338/6080 (87.7961%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5368/6080 (88.2895%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2210, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4593/5038 (91.1671%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4601/5038 (91.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9354, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5779/6664 (86.7197%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5640/6664 (84.6339%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.7018, Accuracy: 4568/10000 (45.6800%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3778/4111 (91.8998%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3800/4111 (92.4349%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0633, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4975/5526 (90.0290%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4841/5526 (87.6041%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1057, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4713/5068 (92.9953%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4604/5068 (90.8445%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1705, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3594/3959 (90.7805%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3680/3959 (92.9528%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8732, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4077/4368 (93.3379%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4053/4368 (92.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0196, Accuracy: 5466/10000 (54.6600%)
time spent on training: 265.3402650356293
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1637, Accuracy: 6834/10000 (68.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0482, Accuracy: 9785/9900 (98.8384%)
Done in 415.0268704891205 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5183/5308 (97.6451%), train_poison_data_count: 415
Global model norm: 43.0156278378132.
Norm before scaling: 42.984694484908665. Distance: 1.2320151164099746
Total norm for 4 adversaries is: 42.984694484908665. distance: 1.2320151164099746
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0700, Accuracy: 9716/9900 (98.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 43.0156278378132.
Norm before scaling: 42.979711669977206. Distance: 1.260344616220398
Total norm for 4 adversaries is: 42.979711669977206. distance: 1.260344616220398
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0705, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4935/5123 (96.3303%), train_poison_data_count: 403
Global model norm: 43.0156278378132.
Norm before scaling: 42.99211580609141. Distance: 1.408338267789845
Total norm for 4 adversaries is: 42.99211580609141. distance: 1.408338267789845
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0888, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 43.0156278378132.
Norm before scaling: 42.986473617435756. Distance: 1.3243730843328976
Total norm for 4 adversaries is: 42.986473617435756. distance: 1.3243730843328976
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1022, Accuracy: 9635/9900 (97.3232%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4273/4605 (92.7904%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4254/4605 (92.3779%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9627, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4729/5193 (91.0649%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4443/5193 (85.5575%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3174, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4734/5209 (90.8812%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4677/5209 (89.7869%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0820, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5475/5939 (92.1872%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5429/5939 (91.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0485, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5235/5696 (91.9066%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5121/5696 (89.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1863, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3769/4108 (91.7478%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3633/4108 (88.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1561, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4439/4889 (90.7957%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4451/4889 (91.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1158, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5009/5645 (88.7334%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4860/5645 (86.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3131, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4504/4911 (91.7125%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4499/4911 (91.6107%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0188, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4140/4587 (90.2551%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4139/4587 (90.2333%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1134, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3328/3589 (92.7278%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3121/3589 (86.9602%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1797, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4946/5298 (93.3560%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4910/5298 (92.6765%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9476, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4982/5497 (90.6313%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4904/5497 (89.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1538, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4398/4869 (90.3266%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4196/4869 (86.1779%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.4726, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3984/4196 (94.9476%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3961/4196 (94.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7831, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3648/3968 (91.9355%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3658/3968 (92.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7716, Accuracy: 5819/10000 (58.1900%)
time spent on training: 268.31997776031494
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1643, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0490, Accuracy: 9786/9900 (98.8485%)
Done in 407.5226323604584 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5184/5308 (97.6639%), train_poison_data_count: 415
Global model norm: 43.03033512780185.
Norm before scaling: 42.99955855741792. Distance: 1.2217225235733045
Total norm for 4 adversaries is: 42.99955855741792. distance: 1.2217225235733045
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0205, Accuracy: 9845/9900 (99.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 43.03033512780185.
Norm before scaling: 42.993651875160594. Distance: 1.2116329042190055
Total norm for 4 adversaries is: 42.993651875160594. distance: 1.2116329042190055
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0303, Accuracy: 9822/9900 (99.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4906/5123 (95.7642%), train_poison_data_count: 403
Global model norm: 43.03033512780185.
Norm before scaling: 43.00724695926984. Distance: 1.4117299858959211
Total norm for 4 adversaries is: 43.00724695926984. distance: 1.4117299858959211
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1828, Accuracy: 9463/9900 (95.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5374/5503 (97.6558%), train_poison_data_count: 430
Global model norm: 43.03033512780185.
Norm before scaling: 42.99853229235708. Distance: 1.2525159311709029
Total norm for 4 adversaries is: 42.99853229235708. distance: 1.2525159311709029
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0194, Accuracy: 9857/9900 (99.5657%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3867/4161 (92.9344%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3734/4161 (89.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1359, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4422/4748 (93.1340%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4406/4748 (92.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9581, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4863/5361 (90.7107%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4805/5361 (89.6288%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8653, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3791/4145 (91.4596%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3822/4145 (92.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9442, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4425/4714 (93.8693%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4353/4714 (92.3420%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9253, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3795/4175 (90.8982%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3734/4175 (89.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0925, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3568/3929 (90.8119%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3534/3929 (89.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9279, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4063/4368 (93.0174%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4051/4368 (92.7427%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0884, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5716/6419 (89.0481%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5501/6419 (85.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2016, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4260/4549 (93.6470%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4027/4549 (88.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2144, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4571/5122 (89.2425%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0143, Accuracy: 3827/5122 (74.7169%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.5886, Accuracy: 4456/10000 (44.5600%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4539/4911 (92.4252%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4548/4911 (92.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0762, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3713/4028 (92.1797%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3694/4028 (91.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8932, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5131/5727 (89.5932%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5052/5727 (88.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0312, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4657/4993 (93.2706%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4629/4993 (92.7098%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1186, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4409/4714 (93.5299%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4391/4714 (93.1481%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0975, Accuracy: 5424/10000 (54.2400%)
time spent on training: 265.7503938674927
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1612, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0477, Accuracy: 9790/9900 (98.8889%)
Done in 398.3312945365906 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 43.04314015104497.
Norm before scaling: 43.00953745973095. Distance: 1.131178894758887
Total norm for 4 adversaries is: 43.00953745973095. distance: 1.131178894758887
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0262, Accuracy: 9839/9900 (99.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5661/5777 (97.9920%), train_poison_data_count: 455
Global model norm: 43.04314015104497.
Norm before scaling: 43.00732785262806. Distance: 1.2417773643321692
Total norm for 4 adversaries is: 43.00732785262806. distance: 1.2417773643321692
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0593, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4951/5123 (96.6426%), train_poison_data_count: 403
Global model norm: 43.04314015104497.
Norm before scaling: 43.016717544243775. Distance: 1.3231188051477862
Total norm for 4 adversaries is: 43.016717544243775. distance: 1.3231188051477862
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0813, Accuracy: 9695/9900 (97.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 43.04314015104497.
Norm before scaling: 43.01452675223511. Distance: 1.310173925327183
Total norm for 4 adversaries is: 43.01452675223511. distance: 1.310173925327183
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1043, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4938/5461 (90.4230%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4921/5461 (90.1117%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2197, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3972/4364 (91.0174%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3877/4364 (88.8405%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1375, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4431/4714 (93.9966%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4462/4714 (94.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8359, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4328/4757 (90.9817%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4265/4757 (89.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2274, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4990/5346 (93.3408%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4865/5346 (91.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1554, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4284/4605 (93.0293%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4310/4605 (93.5939%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0044, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5519/6068 (90.9525%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5450/6068 (89.8154%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2179, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4489/5050 (88.8911%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4454/5050 (88.1980%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9847, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5044/5615 (89.8308%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5019/5615 (89.3856%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1127, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4890/5427 (90.1050%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4862/5427 (89.5891%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1880, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4380/4731 (92.5808%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4316/4731 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0312, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3909/4249 (91.9981%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3861/4249 (90.8684%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0044, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4605/5123 (89.8887%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4129/5123 (80.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1814, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4638/5038 (92.0603%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4567/5038 (90.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0034, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4703/4993 (94.1919%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4634/4993 (92.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1144, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4582/4979 (92.0265%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4553/4979 (91.4441%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1571, Accuracy: 5204/10000 (52.0400%)
time spent on training: 268.60180282592773
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1595, Accuracy: 6860/10000 (68.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0478, Accuracy: 9789/9900 (98.8788%)
Done in 406.2042899131775 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5186/5308 (97.7016%), train_poison_data_count: 415
Global model norm: 43.05723417776695.
Norm before scaling: 43.024560346025034. Distance: 1.187322954732938
Total norm for 4 adversaries is: 43.024560346025034. distance: 1.187322954732938
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0296, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5648/5777 (97.7670%), train_poison_data_count: 455
Global model norm: 43.05723417776695.
Norm before scaling: 43.01925299130248. Distance: 1.2201132852300483
Total norm for 4 adversaries is: 43.01925299130248. distance: 1.2201132852300483
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0391, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.05723417776695.
Norm before scaling: 43.031947842925376. Distance: 1.3527832251553757
Total norm for 4 adversaries is: 43.031947842925376. distance: 1.3527832251553757
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0650, Accuracy: 9723/9900 (98.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5362/5503 (97.4378%), train_poison_data_count: 430
Global model norm: 43.05723417776695.
Norm before scaling: 43.02598319030243. Distance: 1.2799163017624284
Total norm for 4 adversaries is: 43.02598319030243. distance: 1.2799163017624284
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0588, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4849/5427 (89.3495%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4815/5427 (88.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0489, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3961/4196 (94.3994%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3953/4196 (94.2088%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0300, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3691/4028 (91.6336%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3715/4028 (92.2294%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8596, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3513/3774 (93.0843%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3545/3774 (93.9322%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8536, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4911/5298 (92.6954%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4858/5298 (91.6950%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0685, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6268/6947 (90.2260%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0069, Accuracy: 6004/6947 (86.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.4602, Accuracy: 4701/10000 (47.0100%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3791/4175 (90.8024%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3787/4175 (90.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0549, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5394/5871 (91.8753%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5324/5871 (90.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1679, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4058/4527 (89.6399%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4015/4527 (88.6901%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0479, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4171/4397 (94.8601%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4186/4397 (95.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8394, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5077/5422 (93.6370%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4989/5422 (92.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1184, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4882/5362 (91.0481%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4755/5362 (88.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2316, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5005/5652 (88.5527%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5016/5652 (88.7473%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2420, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4526/4911 (92.1605%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4513/4911 (91.8957%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0306, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5795/6664 (86.9598%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5598/6664 (84.0036%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2036, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4555/5055 (90.1088%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4512/5055 (89.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1831, Accuracy: 5298/10000 (52.9800%)
time spent on training: 274.1951153278351
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1610, Accuracy: 6848/10000 (68.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0451, Accuracy: 9795/9900 (98.9394%)
Done in 408.5996196269989 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 43.0702777809129.
Norm before scaling: 43.03833711836533. Distance: 1.2041048790854314
Total norm for 4 adversaries is: 43.03833711836533. distance: 1.2041048790854314
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0181, Accuracy: 9857/9900 (99.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5648/5777 (97.7670%), train_poison_data_count: 455
Global model norm: 43.0702777809129.
Norm before scaling: 43.034313616432875. Distance: 1.2771297357207616
Total norm for 4 adversaries is: 43.034313616432875. distance: 1.2771297357207616
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0356, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.0702777809129.
Norm before scaling: 43.04560172799307. Distance: 1.394456236288325
Total norm for 4 adversaries is: 43.04560172799307. distance: 1.394456236288325
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0872, Accuracy: 9691/9900 (97.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.0702777809129.
Norm before scaling: 43.04018777458894. Distance: 1.3134619956644618
Total norm for 4 adversaries is: 43.04018777458894. distance: 1.3134619956644618
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0293, Accuracy: 9816/9900 (99.1515%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3863/4161 (92.8383%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3801/4161 (91.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1593, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4102/4368 (93.9103%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4065/4368 (93.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9985, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4294/4818 (89.1241%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4256/4818 (88.3354%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0128, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3806/4111 (92.5809%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3804/4111 (92.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1072, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4818/5353 (90.0056%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4775/5353 (89.2023%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9178, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4995/5346 (93.4343%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4995/5346 (93.4343%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1815, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4829/5504 (87.7362%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4736/5504 (86.0465%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3621, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3485/3774 (92.3423%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3505/3774 (92.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9060, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3827/4175 (91.6647%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3743/4175 (89.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1867, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5070/5422 (93.5079%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5003/5422 (92.2722%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9268, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5553/6068 (91.5129%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5489/6068 (90.4581%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1855, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4505/4929 (91.3978%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4443/4929 (90.1400%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1457, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4393/4757 (92.3481%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4253/4757 (89.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1951, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4587/5055 (90.7418%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4510/5055 (89.2186%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0501, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4448/4843 (91.8439%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4441/4843 (91.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9112, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4705/5035 (93.4459%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4685/5035 (93.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0058, Accuracy: 5585/10000 (55.8500%)
time spent on training: 275.87127566337585
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1645, Accuracy: 6831/10000 (68.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0409, Accuracy: 9806/9900 (99.0505%)
Done in 412.66683411598206 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5199/5308 (97.9465%), train_poison_data_count: 415
Global model norm: 43.08416176644484.
Norm before scaling: 43.050558485779256. Distance: 1.1719195548170729
Total norm for 4 adversaries is: 43.050558485779256. distance: 1.1719195548170729
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0527, Accuracy: 9767/9900 (98.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 43.08416176644484.
Norm before scaling: 43.04506149764381. Distance: 1.1933120243649171
Total norm for 4 adversaries is: 43.04506149764381. distance: 1.1933120243649171
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0359, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4940/5123 (96.4279%), train_poison_data_count: 403
Global model norm: 43.08416176644484.
Norm before scaling: 43.0578975792515. Distance: 1.3542834549451588
Total norm for 4 adversaries is: 43.0578975792515. distance: 1.3542834549451588
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0424, Accuracy: 9805/9900 (99.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5368/5503 (97.5468%), train_poison_data_count: 430
Global model norm: 43.08416176644484.
Norm before scaling: 43.0526326117775. Distance: 1.2809034669761128
Total norm for 4 adversaries is: 43.0526326117775. distance: 1.2809034669761128
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0277, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4350/4818 (90.2864%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4220/4818 (87.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0429, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4031/4527 (89.0435%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3985/4527 (88.0274%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0873, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4666/5068 (92.0679%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4566/5068 (90.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2008, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4685/5035 (93.0487%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4693/5035 (93.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0159, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4717/4993 (94.4723%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4623/4993 (92.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1209, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4509/5055 (89.1988%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4504/5055 (89.0999%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1458, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4406/4748 (92.7970%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4350/4748 (91.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0765, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3970/4313 (92.0473%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3958/4313 (91.7691%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9307, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4314/4894 (88.1488%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4276/4894 (87.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2191, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4870/5353 (90.9770%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4777/5353 (89.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0323, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5116/5727 (89.3312%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5028/5727 (87.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3799, Accuracy: 4870/10000 (48.7000%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3889/4249 (91.5274%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3926/4249 (92.3982%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1013, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4143/4587 (90.3205%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4091/4587 (89.1868%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0973, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3662/3968 (92.2883%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3645/3968 (91.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0208, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4936/5559 (88.7929%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4927/5559 (88.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1486, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4898/5298 (92.4500%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4902/5298 (92.5255%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1154, Accuracy: 5339/10000 (53.3900%)
time spent on training: 260.9056758880615
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.1677, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0380, Accuracy: 9814/9900 (99.1313%)
Done in 401.2681038379669 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5205/5308 (98.0595%), train_poison_data_count: 415
Global model norm: 43.09831318751785.
Norm before scaling: 43.06381670927825. Distance: 1.147571262980816
Total norm for 4 adversaries is: 43.06381670927825. distance: 1.147571262980816
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0592, Accuracy: 9758/9900 (98.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5659/5777 (97.9574%), train_poison_data_count: 455
Global model norm: 43.09831318751785.
Norm before scaling: 43.059444058838594. Distance: 1.2158670316858418
Total norm for 4 adversaries is: 43.059444058838594. distance: 1.2158670316858418
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0384, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4953/5123 (96.6816%), train_poison_data_count: 403
Global model norm: 43.09831318751785.
Norm before scaling: 43.07126265843837. Distance: 1.351361739402228
Total norm for 4 adversaries is: 43.07126265843837. distance: 1.351361739402228
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0541, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 43.09831318751785.
Norm before scaling: 43.0651262919205. Distance: 1.2472215290440534
Total norm for 4 adversaries is: 43.0651262919205. distance: 1.2472215290440534
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0330, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4353/4818 (90.3487%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4260/4818 (88.4184%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0463, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4993/5298 (94.2431%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4940/5298 (93.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0689, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4852/5353 (90.6408%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4742/5353 (88.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1266, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3529/3774 (93.5082%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3464/3774 (91.7859%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9611, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3613/3910 (92.4041%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3551/3910 (90.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1386, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4146/4537 (91.3820%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4142/4537 (91.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8997, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5877/6664 (88.1903%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0088, Accuracy: 5542/6664 (83.1633%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2813, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4687/5209 (89.9789%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4676/5209 (89.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1992, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4587/5123 (89.5374%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0126, Accuracy: 3958/5123 (77.2594%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3543, Accuracy: 4741/10000 (47.4100%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3829/4145 (92.3764%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3763/4145 (90.7841%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0233, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5008/5526 (90.6261%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4936/5526 (89.3232%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1427, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6216/6812 (91.2507%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 6139/6812 (90.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2432, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5380/5907 (91.0784%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5302/5907 (89.7579%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.6158, Accuracy: 4751/10000 (47.5100%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3837/4175 (91.9042%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3817/4175 (91.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0168, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4708/5075 (92.7685%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4635/5075 (91.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3806, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3793/4111 (92.2647%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3713/4111 (90.3187%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0760, Accuracy: 5283/10000 (52.8300%)
time spent on training: 264.763135433197
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.1684, Accuracy: 6824/10000 (68.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0345, Accuracy: 9825/9900 (99.2424%)
Done in 397.9436490535736 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5199/5308 (97.9465%), train_poison_data_count: 415
Global model norm: 43.11162326504159.
Norm before scaling: 43.07715019753077. Distance: 1.1768963364233516
Total norm for 4 adversaries is: 43.07715019753077. distance: 1.1768963364233516
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0235, Accuracy: 9850/9900 (99.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 43.11162326504159.
Norm before scaling: 43.07401877872554. Distance: 1.2489908913554344
Total norm for 4 adversaries is: 43.07401877872554. distance: 1.2489908913554344
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0317, Accuracy: 9816/9900 (99.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.11162326504159.
Norm before scaling: 43.083004348256345. Distance: 1.305215648722971
Total norm for 4 adversaries is: 43.083004348256345. distance: 1.305215648722971
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0547, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5357/5503 (97.3469%), train_poison_data_count: 430
Global model norm: 43.11162326504159.
Norm before scaling: 43.08266434190062. Distance: 1.3330361164148257
Total norm for 4 adversaries is: 43.08266434190062. distance: 1.3330361164148257
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0488, Accuracy: 9778/9900 (98.7677%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4377/4714 (92.8511%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4364/4714 (92.5753%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1006, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4975/5652 (88.0219%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4950/5652 (87.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2929, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4652/5086 (91.4668%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4608/5086 (90.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2156, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4265/4737 (90.0359%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4280/4737 (90.3525%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2417, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6274/6812 (92.1022%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6215/6812 (91.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1491, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4691/5075 (92.4335%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4695/5075 (92.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0149, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5365/5907 (90.8244%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5246/5907 (88.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3585, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4463/4830 (92.4017%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4500/4830 (93.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2080, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4278/4549 (94.0426%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3907/4549 (85.8870%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2243, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5176/5696 (90.8708%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5128/5696 (90.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2079, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3591/3959 (90.7047%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3601/3959 (90.9573%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9370, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4331/4672 (92.7012%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4344/4672 (92.9795%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9481, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4398/4732 (92.9417%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4395/4732 (92.8783%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8655, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4498/4929 (91.2558%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4412/4929 (89.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3322, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5610/6068 (92.4522%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5512/6068 (90.8372%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1619, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3571/3995 (89.3867%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3568/3995 (89.3116%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1762, Accuracy: 5257/10000 (52.5700%)
time spent on training: 268.1854090690613
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.1718, Accuracy: 6821/10000 (68.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0310, Accuracy: 9831/9900 (99.3030%)
Done in 403.3991000652313 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5172/5308 (97.4378%), train_poison_data_count: 415
Global model norm: 43.12574727613424.
Norm before scaling: 43.09435335418812. Distance: 1.2250727943278648
Total norm for 4 adversaries is: 43.09435335418812. distance: 1.2250727943278648
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0467, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5656/5777 (97.9055%), train_poison_data_count: 455
Global model norm: 43.12574727613424.
Norm before scaling: 43.08903476514863. Distance: 1.2424931659932694
Total norm for 4 adversaries is: 43.08903476514863. distance: 1.2424931659932694
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0434, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4934/5123 (96.3108%), train_poison_data_count: 403
Global model norm: 43.12574727613424.
Norm before scaling: 43.10085941174781. Distance: 1.3916571140913228
Total norm for 4 adversaries is: 43.10085941174781. distance: 1.3916571140913228
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0114, Accuracy: 9864/9900 (99.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 43.12574727613424.
Norm before scaling: 43.09151355010709. Distance: 1.1939755111911456
Total norm for 4 adversaries is: 43.09151355010709. distance: 1.1939755111911456
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0316, Accuracy: 9818/9900 (99.1717%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4643/4993 (92.9902%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4603/4993 (92.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0851, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3815/4175 (91.3772%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3716/4175 (89.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0281, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4107/4368 (94.0247%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4017/4368 (91.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1531, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4482/4911 (91.2645%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4457/4911 (90.7554%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1453, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3624/3910 (92.6854%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3407/3910 (87.1355%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.3055, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3296/3589 (91.8362%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3205/3589 (89.3006%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2296, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4392/4731 (92.8345%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4386/4731 (92.7077%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9796, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3981/4196 (94.8761%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3951/4196 (94.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8346, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4669/5035 (92.7309%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4600/5035 (91.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0994, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4291/4672 (91.8450%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4337/4672 (92.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8323, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4525/4979 (90.8817%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4531/4979 (91.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1641, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4284/4605 (93.0293%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4313/4605 (93.6591%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0111, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4930/5702 (86.4609%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4655/5702 (81.6380%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2230, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5011/5346 (93.7336%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5042/5346 (94.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1093, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5396/5871 (91.9094%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5291/5871 (90.1209%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1547, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5022/5645 (88.9637%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4956/5645 (87.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1046, Accuracy: 5272/10000 (52.7200%)
time spent on training: 268.62540650367737
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.1693, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0295, Accuracy: 9834/9900 (99.3333%)
Done in 408.6731243133545 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5217/5308 (98.2856%), train_poison_data_count: 415
Global model norm: 43.13922574469276.
Norm before scaling: 43.10380480051906. Distance: 1.1179676666361147
Total norm for 4 adversaries is: 43.10380480051906. distance: 1.1179676666361147
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0303, Accuracy: 9829/9900 (99.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 43.13922574469276.
Norm before scaling: 43.10084100243506. Distance: 1.2088801473082558
Total norm for 4 adversaries is: 43.10084100243506. distance: 1.2088801473082558
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0624, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.13922574469276.
Norm before scaling: 43.1117549293222. Distance: 1.3285660852743775
Total norm for 4 adversaries is: 43.1117549293222. distance: 1.3285660852743775
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0404, Accuracy: 9808/9900 (99.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 43.13922574469276.
Norm before scaling: 43.104892277805895. Distance: 1.2036072891426655
Total norm for 4 adversaries is: 43.104892277805895. distance: 1.2036072891426655
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0630, Accuracy: 9739/9900 (98.3737%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5816/6664 (87.2749%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0087, Accuracy: 5548/6664 (83.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2914, Accuracy: 4868/10000 (48.6800%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4802/5504 (87.2456%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4802/5504 (87.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0967, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4712/5075 (92.8473%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4641/5075 (91.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1676, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4343/4894 (88.7413%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4308/4894 (88.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2087, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4994/5346 (93.4156%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4942/5346 (92.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0830, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3593/3910 (91.8926%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3453/3910 (88.3120%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1376, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5349/6080 (87.9770%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5297/6080 (87.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4510, Accuracy: 4775/10000 (47.7500%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4020/4313 (93.2066%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3969/4313 (92.0241%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9485, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4289/4605 (93.1379%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4286/4605 (93.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8952, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4502/4929 (91.3370%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4446/4929 (90.2009%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0570, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5015/5645 (88.8397%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4842/5645 (85.7750%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3213, Accuracy: 5054/10000 (50.5400%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4890/5353 (91.3506%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4780/5353 (89.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9892, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5684/6419 (88.5496%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5427/6419 (84.5459%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.4652, Accuracy: 4892/10000 (48.9200%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4996/5298 (94.2997%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4937/5298 (93.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0122, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4706/5209 (90.3436%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4685/5209 (89.9405%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0292, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4357/4714 (92.4268%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4302/4714 (91.2601%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2273, Accuracy: 5193/10000 (51.9300%)
time spent on training: 263.53700399398804
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.1713, Accuracy: 6819/10000 (68.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0278, Accuracy: 9840/9900 (99.3939%)
Done in 396.66266775131226 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 43.153630668157575.
Norm before scaling: 43.116086884621005. Distance: 1.0849221511898703
Total norm for 4 adversaries is: 43.116086884621005. distance: 1.0849221511898703
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0716, Accuracy: 9731/9900 (98.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 43.153630668157575.
Norm before scaling: 43.115131343662284. Distance: 1.2305374852918682
Total norm for 4 adversaries is: 43.115131343662284. distance: 1.2305374852918682
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0487, Accuracy: 9782/9900 (98.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4922/5123 (96.0765%), train_poison_data_count: 403
Global model norm: 43.153630668157575.
Norm before scaling: 43.13006367463564. Distance: 1.4282337573019432
Total norm for 4 adversaries is: 43.13006367463564. distance: 1.4282337573019432
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0720, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5371/5503 (97.6013%), train_poison_data_count: 430
Global model norm: 43.153630668157575.
Norm before scaling: 43.11958610718205. Distance: 1.2061529822197676
Total norm for 4 adversaries is: 43.11958610718205. distance: 1.2061529822197676
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0298, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4353/4714 (92.3420%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4330/4714 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9307, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4201/4537 (92.5942%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4220/4537 (93.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7999, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5593/6235 (89.7033%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5501/6235 (88.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2857, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4004/4527 (88.4471%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3944/4527 (87.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0480, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4656/5035 (92.4727%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4681/5035 (92.9692%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9917, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3770/4145 (90.9530%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3804/4145 (91.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0974, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3826/4175 (91.6407%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3775/4175 (90.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0533, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4599/5123 (89.7716%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0143, Accuracy: 3803/5123 (74.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3138, Accuracy: 4786/10000 (47.8600%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3874/4130 (93.8015%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3819/4130 (92.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0461, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4721/5209 (90.6316%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4669/5209 (89.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0689, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3808/4111 (92.6295%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3806/4111 (92.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9478, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4615/5038 (91.6038%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4583/5038 (90.9686%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8874, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3713/4028 (92.1797%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3747/4028 (93.0238%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9096, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4516/5050 (89.4257%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4526/5050 (89.6238%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2726, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4465/4889 (91.3275%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4352/4889 (89.0162%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1875, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4006/4364 (91.7965%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3965/4364 (90.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9537, Accuracy: 5486/10000 (54.8600%)
time spent on training: 261.52490997314453
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.1636, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0293, Accuracy: 9834/9900 (99.3333%)
Done in 405.28569412231445 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5215/5308 (98.2479%), train_poison_data_count: 415
Global model norm: 43.16659282741835.
Norm before scaling: 43.13080944792032. Distance: 1.1193002849885565
Total norm for 4 adversaries is: 43.13080944792032. distance: 1.1193002849885565
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0347, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 43.16659282741835.
Norm before scaling: 43.12541751383037. Distance: 1.1872776224823283
Total norm for 4 adversaries is: 43.12541751383037. distance: 1.1872776224823283
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0366, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4964/5123 (96.8963%), train_poison_data_count: 403
Global model norm: 43.16659282741835.
Norm before scaling: 43.13891589334536. Distance: 1.3232137191356463
Total norm for 4 adversaries is: 43.13891589334536. distance: 1.3232137191356463
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1144, Accuracy: 9615/9900 (97.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5376/5503 (97.6922%), train_poison_data_count: 430
Global model norm: 43.16659282741835.
Norm before scaling: 43.13545078306024. Distance: 1.2584754192056888
Total norm for 4 adversaries is: 43.13545078306024. distance: 1.2584754192056888
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0640, Accuracy: 9741/9900 (98.3939%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4763/5193 (91.7196%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4449/5193 (85.6730%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3131, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3499/3774 (92.7133%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3489/3774 (92.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9706, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4629/5086 (91.0145%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4643/5086 (91.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0628, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5550/6235 (89.0136%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5469/6235 (87.7145%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3248, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4845/5504 (88.0269%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4828/5504 (87.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1102, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5091/5422 (93.8952%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5021/5422 (92.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9779, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4218/4537 (92.9689%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4134/4537 (91.1175%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9545, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4899/5362 (91.3652%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4842/5362 (90.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0960, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4584/5038 (90.9885%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4597/5038 (91.2465%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9778, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4502/4911 (91.6718%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4527/4911 (92.1808%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0680, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4587/4979 (92.1269%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4514/4979 (90.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1548, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4311/4741 (90.9302%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3837/4741 (80.9323%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.8456, Accuracy: 4201/10000 (42.0100%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4702/5068 (92.7782%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4560/5068 (89.9763%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1353, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3245/3552 (91.3570%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3268/3552 (92.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8697, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4571/5055 (90.4253%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4556/5055 (90.1286%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0948, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3638/3959 (91.8919%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3626/3959 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0867, Accuracy: 5394/10000 (53.9400%)
time spent on training: 260.70108437538147
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.1644, Accuracy: 6827/10000 (68.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0275, Accuracy: 9842/9900 (99.4141%)
Done in 398.86469078063965 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5226/5308 (98.4552%), train_poison_data_count: 415
Global model norm: 43.180050065195765.
Norm before scaling: 43.14175965096057. Distance: 1.0638963275502182
Total norm for 4 adversaries is: 43.14175965096057. distance: 1.0638963275502182
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0544, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5668/5777 (98.1132%), train_poison_data_count: 455
Global model norm: 43.180050065195765.
Norm before scaling: 43.14133097711014. Distance: 1.1950112256117402
Total norm for 4 adversaries is: 43.14133097711014. distance: 1.1950112256117402
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0713, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4954/5123 (96.7012%), train_poison_data_count: 403
Global model norm: 43.180050065195765.
Norm before scaling: 43.15168303813233. Distance: 1.333701912282085
Total norm for 4 adversaries is: 43.15168303813233. distance: 1.333701912282085
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0386, Accuracy: 9795/9900 (98.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5399/5503 (98.1101%), train_poison_data_count: 430
Global model norm: 43.180050065195765.
Norm before scaling: 43.14494273937996. Distance: 1.1710029918068863
Total norm for 4 adversaries is: 43.14494273937996. distance: 1.1710029918068863
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0130, Accuracy: 9872/9900 (99.7172%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3543/3929 (90.1756%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3508/3929 (89.2848%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9379, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4336/4797 (90.3898%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4287/4797 (89.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0973, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4677/5224 (89.5291%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4666/5224 (89.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.3723, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4015/4313 (93.0907%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4036/4313 (93.5776%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8499, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3802/4108 (92.5511%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3796/4108 (92.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0159, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4703/5209 (90.2860%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4648/5209 (89.2302%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2424, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3607/3910 (92.2506%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3629/3910 (92.8133%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9421, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3803/4086 (93.0739%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3814/4086 (93.3431%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9775, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4493/5122 (87.7196%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4287/5122 (83.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.4683, Accuracy: 4711/10000 (47.1100%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4866/5362 (90.7497%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4748/5362 (88.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2760, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4398/4731 (92.9613%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4341/4731 (91.7565%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1379, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3629/3968 (91.4567%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3650/3968 (91.9859%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8096, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4379/4818 (90.8883%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4235/4818 (87.8995%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2702, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3850/4161 (92.5258%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3779/4161 (90.8195%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0335, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4498/4911 (91.5903%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4485/4911 (91.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0519, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4691/5068 (92.5612%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4691/5068 (92.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1581, Accuracy: 5213/10000 (52.1300%)
time spent on training: 268.4082410335541
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.1710, Accuracy: 6822/10000 (68.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0240, Accuracy: 9846/9900 (99.4545%)
Done in 402.255658864975 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 43.19250830222181.
Norm before scaling: 43.15371411584625. Distance: 1.037785828525357
Total norm for 4 adversaries is: 43.15371411584625. distance: 1.037785828525357
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0570, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 43.19250830222181.
Norm before scaling: 43.15414973844853. Distance: 1.224306205931575
Total norm for 4 adversaries is: 43.15414973844853. distance: 1.224306205931575
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0610, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4950/5123 (96.6231%), train_poison_data_count: 403
Global model norm: 43.19250830222181.
Norm before scaling: 43.16341133558607. Distance: 1.3044432451411259
Total norm for 4 adversaries is: 43.16341133558607. distance: 1.3044432451411259
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1037, Accuracy: 9635/9900 (97.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5377/5503 (97.7103%), train_poison_data_count: 430
Global model norm: 43.19250830222181.
Norm before scaling: 43.15828369122057. Distance: 1.2351196553879347
Total norm for 4 adversaries is: 43.15828369122057. distance: 1.2351196553879347
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0718, Accuracy: 9723/9900 (98.2121%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4383/4818 (90.9714%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4207/4818 (87.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1295, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5394/6080 (88.7171%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5307/6080 (87.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2007, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4787/5399 (88.6646%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4738/5399 (87.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2472, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5539/6235 (88.8372%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5451/6235 (87.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2676, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5257/5696 (92.2928%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5144/5696 (90.3090%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3461, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4315/4605 (93.7025%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4320/4605 (93.8111%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9580, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4112/4485 (91.6834%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4024/4485 (89.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1310, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5064/5615 (90.1870%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5028/5615 (89.5459%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1483, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3252/3552 (91.5541%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3272/3552 (92.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8284, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4027/4313 (93.3689%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4039/4313 (93.6471%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7977, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3581/3995 (89.6370%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3546/3995 (88.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.4032, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4309/4549 (94.7241%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4018/4549 (88.3271%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2396, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4989/5346 (93.3221%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4971/5346 (92.9854%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1217, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4840/5361 (90.2817%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4763/5361 (88.8454%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1919, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3836/4161 (92.1894%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3773/4161 (90.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1718, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4397/4714 (93.2754%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4395/4714 (93.2329%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0739, Accuracy: 5378/10000 (53.7800%)
time spent on training: 263.7466745376587
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.1743, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0240, Accuracy: 9847/9900 (99.4646%)
Done in 396.68155241012573 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 43.20509432672552.
Norm before scaling: 43.165899989169695. Distance: 1.0542031765572417
Total norm for 4 adversaries is: 43.165899989169695. distance: 1.0542031765572417
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0859, Accuracy: 9680/9900 (97.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5653/5777 (97.8536%), train_poison_data_count: 455
Global model norm: 43.20509432672552.
Norm before scaling: 43.1655606357661. Distance: 1.2340107633903392
Total norm for 4 adversaries is: 43.1655606357661. distance: 1.2340107633903392
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0727, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4974/5123 (97.0915%), train_poison_data_count: 403
Global model norm: 43.20509432672552.
Norm before scaling: 43.175253781101276. Distance: 1.3074343883324744
Total norm for 4 adversaries is: 43.175253781101276. distance: 1.3074343883324744
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0955, Accuracy: 9657/9900 (97.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 43.20509432672552.
Norm before scaling: 43.16997484960612. Distance: 1.2105290862429274
Total norm for 4 adversaries is: 43.16997484960612. distance: 1.2105290862429274
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0385, Accuracy: 9810/9900 (99.0909%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5119/5727 (89.3836%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4993/5727 (87.1835%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1395, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5768/6664 (86.5546%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5707/6664 (85.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2030, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3999/4364 (91.6361%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3911/4364 (89.6196%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9035, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4942/5454 (90.6124%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4798/5454 (87.9721%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1197, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4458/5050 (88.2772%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4392/5050 (86.9703%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0527, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4684/4993 (93.8113%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4594/4993 (92.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1470, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4323/4818 (89.7260%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4214/4818 (87.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0990, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4686/5035 (93.0685%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4669/5035 (92.7309%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9195, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6288/6812 (92.3077%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6211/6812 (91.1773%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2210, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4450/4843 (91.8852%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4440/4843 (91.6787%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1053, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3309/3552 (93.1588%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3331/3552 (93.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7863, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4613/5123 (90.0449%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4433/5123 (86.5313%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.4576, Accuracy: 4896/10000 (48.9600%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4416/4903 (90.0673%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4332/4903 (88.3541%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1076, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5071/5422 (93.5264%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5018/5422 (92.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0461, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4715/5209 (90.5164%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4719/5209 (90.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2257, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5222/5696 (91.6784%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5145/5696 (90.3265%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1599, Accuracy: 5196/10000 (51.9600%)
time spent on training: 279.6575367450714
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.1729, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0261, Accuracy: 9843/9900 (99.4242%)
Done in 435.6924982070923 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5214/5308 (98.2291%), train_poison_data_count: 415
Global model norm: 43.219283822625115.
Norm before scaling: 43.18157662210022. Distance: 1.1012889982456286
Total norm for 4 adversaries is: 43.18157662210022. distance: 1.1012889982456286
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0819, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 43.219283822625115.
Norm before scaling: 43.178684599127585. Distance: 1.1863378057753728
Total norm for 4 adversaries is: 43.178684599127585. distance: 1.1863378057753728
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0599, Accuracy: 9755/9900 (98.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4963/5123 (96.8768%), train_poison_data_count: 403
Global model norm: 43.219283822625115.
Norm before scaling: 43.19022043937218. Distance: 1.3095492845592238
Total norm for 4 adversaries is: 43.19022043937218. distance: 1.3095492845592238
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1079, Accuracy: 9625/9900 (97.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 43.219283822625115.
Norm before scaling: 43.18640329649484. Distance: 1.2638467611667443
Total norm for 4 adversaries is: 43.18640329649484. distance: 1.2638467611667443
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0349, Accuracy: 9816/9900 (99.1515%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4336/4818 (89.9958%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4248/4818 (88.1694%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9454, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4405/4851 (90.8060%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4382/4851 (90.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0199, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4216/4587 (91.9119%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4126/4587 (89.9499%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0412, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4100/4485 (91.4158%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3919/4485 (87.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2652, Accuracy: 4933/10000 (49.3300%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5240/5696 (91.9944%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5132/5696 (90.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1211, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4307/4672 (92.1875%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4327/4672 (92.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8692, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6232/6947 (89.7078%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5985/6947 (86.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3309, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5028/5645 (89.0700%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4934/5645 (87.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2287, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4858/5702 (85.1982%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0121, Accuracy: 4401/5702 (77.1834%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3617, Accuracy: 4785/10000 (47.8500%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4282/4741 (90.3185%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4086/4741 (86.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2207, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3801/4145 (91.7008%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3742/4145 (90.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1364, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4641/5038 (92.1199%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4599/5038 (91.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0575, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5348/6080 (87.9605%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5254/6080 (86.4145%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0903, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4358/4894 (89.0478%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4186/4894 (85.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1337, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4442/4732 (93.8715%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4478/4732 (94.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8569, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3927/4249 (92.4217%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3857/4249 (90.7743%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1370, Accuracy: 5311/10000 (53.1100%)
time spent on training: 257.5753507614136
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.1650, Accuracy: 6837/10000 (68.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0297, Accuracy: 9838/9900 (99.3737%)
Done in 392.32946705818176 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5217/5308 (98.2856%), train_poison_data_count: 415
Global model norm: 43.233420661675325.
Norm before scaling: 43.197653077977655. Distance: 1.122308372164092
Total norm for 4 adversaries is: 43.197653077977655. distance: 1.122308372164092
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0482, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5644/5777 (97.6978%), train_poison_data_count: 455
Global model norm: 43.233420661675325.
Norm before scaling: 43.19450496057412. Distance: 1.2509170506159342
Total norm for 4 adversaries is: 43.19450496057412. distance: 1.2509170506159342
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0563, Accuracy: 9763/9900 (98.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4966/5123 (96.9354%), train_poison_data_count: 403
Global model norm: 43.233420661675325.
Norm before scaling: 43.20341178702282. Distance: 1.276270050578793
Total norm for 4 adversaries is: 43.20341178702282. distance: 1.276270050578793
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0276, Accuracy: 9829/9900 (99.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5387/5503 (97.8921%), train_poison_data_count: 430
Global model norm: 43.233420661675325.
Norm before scaling: 43.19857994853896. Distance: 1.201775574363017
Total norm for 4 adversaries is: 43.19857994853896. distance: 1.201775574363017
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0447, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5822/6664 (87.3649%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5698/6664 (85.5042%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4208, Accuracy: 4728/10000 (47.2800%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4426/4757 (93.0418%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4289/4757 (90.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2666, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4575/5055 (90.5045%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4554/5055 (90.0890%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1207, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5093/5422 (93.9321%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5025/5422 (92.6780%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8747, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4376/4869 (89.8747%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4090/4869 (84.0008%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1941, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3806/4111 (92.5809%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3751/4111 (91.2430%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1360, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3881/4130 (93.9709%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3789/4130 (91.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1158, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4011/4313 (92.9979%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3986/4313 (92.4183%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8284, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4858/5353 (90.7528%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4783/5353 (89.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3468, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4612/5122 (90.0430%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4275/5122 (83.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.6325, Accuracy: 4576/10000 (45.7600%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4671/5068 (92.1665%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4661/5068 (91.9692%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1109, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4849/5504 (88.0996%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4813/5504 (87.4455%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1750, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3572/3929 (90.9137%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3589/3929 (91.3464%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0580, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4614/5123 (90.0644%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4231/5123 (82.5883%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.5425, Accuracy: 4702/10000 (47.0200%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3880/4161 (93.2468%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3746/4161 (90.0264%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1075, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4965/5454 (91.0341%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4839/5454 (88.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1172, Accuracy: 5329/10000 (53.2900%)
time spent on training: 268.2116539478302
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.1615, Accuracy: 6841/10000 (68.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0282, Accuracy: 9841/9900 (99.4040%)
Done in 405.54675817489624 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5246/5308 (98.8320%), train_poison_data_count: 415
Global model norm: 43.24747384692689.
Norm before scaling: 43.20694914133099. Distance: 0.9874066791622228
Total norm for 4 adversaries is: 43.20694914133099. distance: 0.9874066791622228
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0689, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5663/5777 (98.0267%), train_poison_data_count: 455
Global model norm: 43.24747384692689.
Norm before scaling: 43.20763567094869. Distance: 1.2049480844133023
Total norm for 4 adversaries is: 43.20763567094869. distance: 1.2049480844133023
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0537, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4966/5123 (96.9354%), train_poison_data_count: 403
Global model norm: 43.24747384692689.
Norm before scaling: 43.217851807369485. Distance: 1.2941448475279174
Total norm for 4 adversaries is: 43.217851807369485. distance: 1.2941448475279174
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0943, Accuracy: 9656/9900 (97.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5405/5503 (98.2192%), train_poison_data_count: 430
Global model norm: 43.24747384692689.
Norm before scaling: 43.21153144931701. Distance: 1.1788754225960594
Total norm for 4 adversaries is: 43.21153144931701. distance: 1.1788754225960594
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0735, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3676/3968 (92.6411%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3636/3968 (91.6331%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9143, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4073/4368 (93.2463%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3966/4368 (90.7967%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1812, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4565/4956 (92.1106%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4500/4956 (90.7990%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1040, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4384/4714 (92.9996%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4310/4714 (91.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1471, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5389/5871 (91.7902%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5295/5871 (90.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0929, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4638/5038 (92.0603%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4606/5038 (91.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9890, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5046/5615 (89.8664%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5000/5615 (89.0472%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.4188, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3781/4175 (90.5629%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3702/4175 (88.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0472, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4814/5399 (89.1647%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4729/5399 (87.5903%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2625, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5800/6664 (87.0348%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5665/6664 (85.0090%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3029, Accuracy: 4939/10000 (49.3900%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4441/4732 (93.8504%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4415/4732 (93.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0630, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4519/4830 (93.5611%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4459/4830 (92.3188%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1004, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4856/5427 (89.4785%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4759/5427 (87.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2251, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5020/5497 (91.3225%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4888/5497 (88.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2484, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4963/5489 (90.4172%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4918/5489 (89.5974%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1709, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4579/5055 (90.5836%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4565/5055 (90.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2253, Accuracy: 5263/10000 (52.6300%)
time spent on training: 274.9096930027008
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.1644, Accuracy: 6843/10000 (68.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0274, Accuracy: 9842/9900 (99.4141%)
Done in 410.84270334243774 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5226/5308 (98.4552%), train_poison_data_count: 415
Global model norm: 43.26090874664953.
Norm before scaling: 43.22258264369015. Distance: 1.0870245562905645
Total norm for 4 adversaries is: 43.22258264369015. distance: 1.0870245562905645
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0479, Accuracy: 9794/9900 (98.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5668/5777 (98.1132%), train_poison_data_count: 455
Global model norm: 43.26090874664953.
Norm before scaling: 43.21955355588848. Distance: 1.1831726231489337
Total norm for 4 adversaries is: 43.21955355588848. distance: 1.1831726231489337
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0299, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 43.26090874664953.
Norm before scaling: 43.23217406080149. Distance: 1.3209687357111517
Total norm for 4 adversaries is: 43.23217406080149. distance: 1.3209687357111517
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0106, Accuracy: 9870/9900 (99.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 43.26090874664953.
Norm before scaling: 43.224126055273665. Distance: 1.199270638700812
Total norm for 4 adversaries is: 43.224126055273665. distance: 1.199270638700812
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0183, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4424/4731 (93.5109%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4344/4731 (91.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0110, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4054/4485 (90.3902%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3805/4485 (84.8384%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.3769, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4364/4903 (89.0067%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4322/4903 (88.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2757, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4707/5224 (90.1034%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4755/5224 (91.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1170, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4797/5361 (89.4796%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4741/5361 (88.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1002, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4995/5645 (88.4854%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4922/5645 (87.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2397, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4647/5038 (92.2390%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4612/5038 (91.5443%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9268, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4595/5086 (90.3460%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4595/5086 (90.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2040, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4455/4889 (91.1229%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4454/4889 (91.1025%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1298, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4759/5209 (91.3611%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4653/5209 (89.3262%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1026, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4217/4736 (89.0414%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4227/4736 (89.2525%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0740, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4573/4956 (92.2720%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4463/4956 (90.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1848, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4420/4748 (93.0918%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4339/4748 (91.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9648, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4474/5018 (89.1590%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4361/5018 (86.9071%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1448, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4323/4605 (93.8762%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4311/4605 (93.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9881, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4877/5353 (91.1078%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4716/5353 (88.1001%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0764, Accuracy: 5297/10000 (52.9700%)
time spent on training: 262.4279327392578
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.1650, Accuracy: 6835/10000 (68.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0243, Accuracy: 9848/9900 (99.4747%)
Done in 402.4495270252228 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5245/5308 (98.8131%), train_poison_data_count: 415
Global model norm: 43.27465822998346.
Norm before scaling: 43.23469263752129. Distance: 1.0264691593463056
Total norm for 4 adversaries is: 43.23469263752129. distance: 1.0264691593463056
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0533, Accuracy: 9775/9900 (98.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5663/5777 (98.0267%), train_poison_data_count: 455
Global model norm: 43.27465822998346.
Norm before scaling: 43.23538437338175. Distance: 1.2433444699069054
Total norm for 4 adversaries is: 43.23538437338175. distance: 1.2433444699069054
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0631, Accuracy: 9748/9900 (98.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4985/5123 (97.3063%), train_poison_data_count: 403
Global model norm: 43.27465822998346.
Norm before scaling: 43.2437111576643. Distance: 1.259851449807828
Total norm for 4 adversaries is: 43.2437111576643. distance: 1.259851449807828
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0620, Accuracy: 9745/9900 (98.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 43.27465822998346.
Norm before scaling: 43.23608456820602. Distance: 1.1446009279464968
Total norm for 4 adversaries is: 43.23608456820602. distance: 1.1446009279464968
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0624, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4697/5068 (92.6796%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4524/5068 (89.2660%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3508, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4703/5193 (90.5642%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4564/5193 (87.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3071, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4510/4911 (91.8347%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4478/4911 (91.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0366, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4986/5559 (89.6924%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4870/5559 (87.6057%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1715, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3774/4145 (91.0495%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3786/4145 (91.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0521, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4268/4549 (93.8228%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4049/4549 (89.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1664, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3554/3929 (90.4556%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3519/3929 (89.5648%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0366, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4416/4714 (93.6784%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4385/4714 (93.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9236, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4425/4851 (91.2183%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4430/4851 (91.3214%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0047, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4229/4736 (89.2948%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4195/4736 (88.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0914, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4385/4894 (89.5995%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4270/4894 (87.2497%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2809, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4323/4605 (93.8762%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4305/4605 (93.4853%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2025, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3317/3589 (92.4213%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3043/3589 (84.7868%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4202, Accuracy: 4886/10000 (48.8600%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5438/5939 (91.5642%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5404/5939 (90.9917%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0369, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3498/3774 (92.6868%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3513/3774 (93.0843%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0134, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3258/3552 (91.7230%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3290/3552 (92.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8861, Accuracy: 5775/10000 (57.7500%)
time spent on training: 264.55137395858765
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.1683, Accuracy: 6835/10000 (68.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0246, Accuracy: 9850/9900 (99.4949%)
Done in 399.7158691883087 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 43.28611068148405.
Norm before scaling: 43.247094205582904. Distance: 1.056469746591137
Total norm for 4 adversaries is: 43.247094205582904. distance: 1.056469746591137
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0688, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 43.28611068148405.
Norm before scaling: 43.24760086373289. Distance: 1.232502591592722
Total norm for 4 adversaries is: 43.24760086373289. distance: 1.232502591592722
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0263, Accuracy: 9843/9900 (99.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4943/5123 (96.4864%), train_poison_data_count: 403
Global model norm: 43.28611068148405.
Norm before scaling: 43.25595916090276. Distance: 1.2937873945498706
Total norm for 4 adversaries is: 43.25595916090276. distance: 1.2937873945498706
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1245, Accuracy: 9588/9900 (96.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5412/5503 (98.3464%), train_poison_data_count: 430
Global model norm: 43.28611068148405.
Norm before scaling: 43.24852525258448. Distance: 1.1439922743216322
Total norm for 4 adversaries is: 43.24852525258448. distance: 1.1439922743216322
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0625, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4317/4741 (91.0567%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3992/4741 (84.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4604, Accuracy: 4900/10000 (49.0000%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4352/4818 (90.3279%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4308/4818 (89.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2462, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5609/6419 (87.3812%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5559/6419 (86.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3065, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4492/4830 (93.0021%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4514/4830 (93.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2014, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4987/5497 (90.7222%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4945/5497 (89.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2733, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4434/5018 (88.3619%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4395/5018 (87.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.3139, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5595/6235 (89.7354%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5440/6235 (87.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2669, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4324/4797 (90.1397%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4280/4797 (89.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1391, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4572/4979 (91.8257%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4559/4979 (91.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0236, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3793/4086 (92.8292%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3777/4086 (92.4376%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0432, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5514/6068 (90.8701%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5537/6068 (91.2492%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1113, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3937/4196 (93.8275%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3959/4196 (94.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8905, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5050/5652 (89.3489%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4953/5652 (87.6327%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1347, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3794/4111 (92.2890%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3743/4111 (91.0484%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9968, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4477/4889 (91.5729%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4441/4889 (90.8366%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1306, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4040/4368 (92.4908%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3958/4368 (90.6136%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1703, Accuracy: 5296/10000 (52.9600%)
time spent on training: 269.4530019760132
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.1710, Accuracy: 6826/10000 (68.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0238, Accuracy: 9852/9900 (99.5152%)
Done in 407.1718897819519 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 43.29965058994053.
Norm before scaling: 43.261430762303306. Distance: 1.0786225097040423
Total norm for 4 adversaries is: 43.261430762303306. distance: 1.0786225097040423
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0167, Accuracy: 9863/9900 (99.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5666/5777 (98.0786%), train_poison_data_count: 455
Global model norm: 43.29965058994053.
Norm before scaling: 43.25980261699003. Distance: 1.2132182638567617
Total norm for 4 adversaries is: 43.25980261699003. distance: 1.2132182638567617
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0434, Accuracy: 9793/9900 (98.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4966/5123 (96.9354%), train_poison_data_count: 403
Global model norm: 43.29965058994053.
Norm before scaling: 43.267825648258835. Distance: 1.2446939863667579
Total norm for 4 adversaries is: 43.267825648258835. distance: 1.2446939863667579
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0780, Accuracy: 9716/9900 (98.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5409/5503 (98.2918%), train_poison_data_count: 430
Global model norm: 43.29965058994053.
Norm before scaling: 43.262260330977995. Distance: 1.1432962361722485
Total norm for 4 adversaries is: 43.262260330977995. distance: 1.1432962361722485
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0318, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4382/4731 (92.6231%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4365/4731 (92.2638%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1634, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4991/5346 (93.3595%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4880/5346 (91.2832%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2447, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4797/5399 (88.8498%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4672/5399 (86.5345%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2565, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4403/4818 (91.3865%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4314/4818 (89.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2156, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5120/5652 (90.5874%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5024/5652 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2952, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4408/4714 (93.5087%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4374/4714 (92.7874%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0050, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5098/5422 (94.0243%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4983/5422 (91.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0094, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3842/4130 (93.0266%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3760/4130 (91.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1666, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4387/4732 (92.7092%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4381/4732 (92.5824%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9524, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5056/5645 (89.5660%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4847/5645 (85.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3191, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4954/5702 (86.8818%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0123, Accuracy: 4368/5702 (76.6047%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2442, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4299/4736 (90.7728%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4298/4736 (90.7517%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9564, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3997/4527 (88.2925%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3954/4527 (87.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3744, Accuracy: 4834/10000 (48.3400%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3804/4111 (92.5322%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3673/4111 (89.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0690, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4871/5362 (90.8430%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4782/5362 (89.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3572, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5466/5939 (92.0357%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5362/5939 (90.2846%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2249, Accuracy: 5136/10000 (51.3600%)
time spent on training: 275.1695866584778
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.1724, Accuracy: 6829/10000 (68.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0218, Accuracy: 9852/9900 (99.5152%)
Done in 413.98431158065796 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5236/5308 (98.6436%), train_poison_data_count: 415
Global model norm: 43.3136202844837.
Norm before scaling: 43.27415047819397. Distance: 1.0472881014502504
Total norm for 4 adversaries is: 43.27415047819397. distance: 1.0472881014502504
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0751, Accuracy: 9716/9900 (98.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 43.3136202844837.
Norm before scaling: 43.27051000546229. Distance: 1.1586253022355975
Total norm for 4 adversaries is: 43.27051000546229. distance: 1.1586253022355975
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0458, Accuracy: 9794/9900 (98.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 43.3136202844837.
Norm before scaling: 43.282770167346904. Distance: 1.2604110602051861
Total norm for 4 adversaries is: 43.282770167346904. distance: 1.2604110602051861
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0291, Accuracy: 9831/9900 (99.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5424/5503 (98.5644%), train_poison_data_count: 430
Global model norm: 43.3136202844837.
Norm before scaling: 43.27469631112751. Distance: 1.1215526425833762
Total norm for 4 adversaries is: 43.27469631112751. distance: 1.1215526425833762
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0530, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4723/5075 (93.0640%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4534/5075 (89.3399%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3278, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4648/5086 (91.3881%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4597/5086 (90.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2402, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4949/5497 (90.0309%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4876/5497 (88.7029%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0701, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4411/4748 (92.9023%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4301/4748 (90.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2066, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5046/5652 (89.2781%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4929/5652 (87.2081%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3184, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4573/4979 (91.8458%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4554/4979 (91.4641%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0250, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3984/4364 (91.2924%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3922/4364 (89.8717%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0988, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4470/4889 (91.4297%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4470/4889 (91.4297%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0115, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4896/5427 (90.2156%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4784/5427 (88.1518%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0967, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3633/3910 (92.9156%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3561/3910 (91.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1117, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3679/3968 (92.7167%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3636/3968 (91.6331%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8455, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4778/5193 (92.0085%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4535/5193 (87.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2546, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5351/5907 (90.5874%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5279/5907 (89.3685%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2973, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4430/4869 (90.9838%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0112, Accuracy: 3860/4869 (79.2771%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.6768, Accuracy: 4545/10000 (45.4500%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4383/4894 (89.5586%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4253/4894 (86.9023%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3045, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5131/5727 (89.5932%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4989/5727 (87.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1644, Accuracy: 5178/10000 (51.7800%)
time spent on training: 268.2368767261505
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.1735, Accuracy: 6836/10000 (68.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0210, Accuracy: 9854/9900 (99.5354%)
Done in 401.9892303943634 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5237/5308 (98.6624%), train_poison_data_count: 415
Global model norm: 43.32678674006128.
Norm before scaling: 43.286869276465495. Distance: 1.0435115816015577
Total norm for 4 adversaries is: 43.286869276465495. distance: 1.0435115816015577
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0220, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 43.32678674006128.
Norm before scaling: 43.283141034952195. Distance: 1.1385798474349462
Total norm for 4 adversaries is: 43.283141034952195. distance: 1.1385798474349462
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0499, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 43.32678674006128.
Norm before scaling: 43.29422188280441. Distance: 1.2280487968739933
Total norm for 4 adversaries is: 43.29422188280441. distance: 1.2280487968739933
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0463, Accuracy: 9789/9900 (98.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5421/5503 (98.5099%), train_poison_data_count: 430
Global model norm: 43.32678674006128.
Norm before scaling: 43.28672122458572. Distance: 1.100467326856476
Total norm for 4 adversaries is: 43.28672122458572. distance: 1.100467326856476
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0415, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4475/4843 (92.4014%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4392/4843 (90.6876%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1202, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4412/4757 (92.7475%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4322/4757 (90.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0550, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4491/4830 (92.9814%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4481/4830 (92.7743%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1292, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4545/4979 (91.2834%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4525/4979 (90.8817%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0291, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4180/4537 (92.1314%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4142/4537 (91.2938%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0266, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6230/6812 (91.4563%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 6181/6812 (90.7369%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1563, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3737/4028 (92.7756%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3674/4028 (91.2115%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0696, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4128/4485 (92.0401%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3959/4485 (88.2720%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2600, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4890/5427 (90.1050%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4810/5427 (88.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2157, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4592/5123 (89.6350%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4089/5123 (79.8165%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4469, Accuracy: 4782/10000 (47.8200%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3953/4249 (93.0337%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3871/4249 (91.1038%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1943, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3592/3995 (89.9124%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3542/3995 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0603, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4373/4737 (92.3158%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4304/4737 (90.8592%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0400, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4672/5038 (92.7352%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4607/5038 (91.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9113, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4259/4736 (89.9282%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4178/4736 (88.2179%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2242, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5393/5871 (91.8583%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5325/5871 (90.7001%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1550, Accuracy: 5288/10000 (52.8800%)
time spent on training: 266.85094475746155
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.1765, Accuracy: 6832/10000 (68.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0184, Accuracy: 9865/9900 (99.6465%)
Done in 423.2283675670624 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5256/5308 (99.0203%), train_poison_data_count: 415
Global model norm: 43.3399928526615.
Norm before scaling: 43.29721332419241. Distance: 0.9532444050522391
Total norm for 4 adversaries is: 43.29721332419241. distance: 0.9532444050522391
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0544, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 43.3399928526615.
Norm before scaling: 43.2997577193532. Distance: 1.2252750321535755
Total norm for 4 adversaries is: 43.2997577193532. distance: 1.2252750321535755
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0345, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4980/5123 (97.2087%), train_poison_data_count: 403
Global model norm: 43.3399928526615.
Norm before scaling: 43.30847801040952. Distance: 1.251888755536127
Total norm for 4 adversaries is: 43.30847801040952. distance: 1.251888755536127
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0460, Accuracy: 9786/9900 (98.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5421/5503 (98.5099%), train_poison_data_count: 430
Global model norm: 43.3399928526615.
Norm before scaling: 43.299374307600424. Distance: 1.0745736385547613
Total norm for 4 adversaries is: 43.299374307600424. distance: 1.0745736385547613
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0142, Accuracy: 9867/9900 (99.6667%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3962/4196 (94.4233%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3962/4196 (94.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9549, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3803/4145 (91.7491%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3744/4145 (90.3257%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1039, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4942/5298 (93.2805%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4925/5298 (92.9596%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1875, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4311/4737 (91.0070%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4324/4737 (91.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1488, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4657/5193 (89.6784%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4375/5193 (84.2480%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.6566, Accuracy: 4460/10000 (44.6000%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4418/4818 (91.6978%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4205/4818 (87.2769%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2730, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3824/4111 (93.0187%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3826/4111 (93.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1295, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6240/6812 (91.6031%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6188/6812 (90.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2298, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4663/5035 (92.6117%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4604/5035 (91.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0442, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4870/5427 (89.7365%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4701/5427 (86.6224%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1293, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4318/4672 (92.4229%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4324/4672 (92.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0357, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4828/5361 (90.0578%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4751/5361 (88.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1761, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4099/4368 (93.8416%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4113/4368 (94.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0453, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4455/4843 (91.9884%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4402/4843 (90.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0407, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4865/5353 (90.8836%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4674/5353 (87.3155%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2262, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4418/4714 (93.7208%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4361/4714 (92.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9402, Accuracy: 5596/10000 (55.9600%)
time spent on training: 268.5423309803009
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.1784, Accuracy: 6820/10000 (68.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0174, Accuracy: 9870/9900 (99.6970%)
Done in 418.1290428638458 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5246/5308 (98.8320%), train_poison_data_count: 415
Global model norm: 43.3526346112249.
Norm before scaling: 43.31011419069381. Distance: 0.9860052505647399
Total norm for 4 adversaries is: 43.31011419069381. distance: 0.9860052505647399
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0455, Accuracy: 9785/9900 (98.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 43.3526346112249.
Norm before scaling: 43.31063843176625. Distance: 1.1602960881172615
Total norm for 4 adversaries is: 43.31063843176625. distance: 1.1602960881172615
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0524, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4992/5123 (97.4429%), train_poison_data_count: 403
Global model norm: 43.3526346112249.
Norm before scaling: 43.319970833864545. Distance: 1.2358377698551593
Total norm for 4 adversaries is: 43.319970833864545. distance: 1.2358377698551593
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0765, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 43.3526346112249.
Norm before scaling: 43.31321585808135. Distance: 1.1444914618857345
Total norm for 4 adversaries is: 43.31321585808135. distance: 1.1444914618857345
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0163, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4264/4549 (93.7349%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3933/4549 (86.4586%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2010, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5022/5652 (88.8535%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4948/5652 (87.5442%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2690, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3520/3774 (93.2697%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3536/3774 (93.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8753, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5161/5727 (90.1170%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5047/5727 (88.1264%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2887, Accuracy: 4974/10000 (49.7400%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5508/6068 (90.7713%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5462/6068 (90.0132%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2824, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 6233/6947 (89.7222%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6014/6947 (86.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3431, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6228/6812 (91.4269%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 6093/6812 (89.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2367, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4382/4903 (89.3739%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4384/4903 (89.4146%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.4275, Accuracy: 4924/10000 (49.2400%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5413/5871 (92.1989%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5296/5871 (90.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1994, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4846/5427 (89.2943%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4810/5427 (88.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0624, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3834/4108 (93.3301%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3832/4108 (93.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9577, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5858/6664 (87.9052%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0089, Accuracy: 5471/6664 (82.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2352, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4573/4979 (91.8458%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4555/4979 (91.4842%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2067, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4802/5399 (88.9424%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4695/5399 (86.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3286, Accuracy: 4868/10000 (48.6800%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4366/4894 (89.2113%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4244/4894 (86.7184%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1800, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3677/3968 (92.6663%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3615/3968 (91.1038%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0170, Accuracy: 5326/10000 (53.2600%)
time spent on training: 269.4585192203522
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.1814, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0182, Accuracy: 9869/9900 (99.6869%)
Done in 411.24190616607666 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5241/5308 (98.7378%), train_poison_data_count: 415
Global model norm: 43.36737679543446.
Norm before scaling: 43.325634394699. Distance: 1.0357569265279016
Total norm for 4 adversaries is: 43.325634394699. distance: 1.0357569265279016
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0300, Accuracy: 9829/9900 (99.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5694/5777 (98.5633%), train_poison_data_count: 455
Global model norm: 43.36737679543446.
Norm before scaling: 43.32430732820492. Distance: 1.147512517540834
Total norm for 4 adversaries is: 43.32430732820492. distance: 1.147512517540834
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0282, Accuracy: 9829/9900 (99.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 43.36737679543446.
Norm before scaling: 43.3359748230865. Distance: 1.2733451950226442
Total norm for 4 adversaries is: 43.3359748230865. distance: 1.2733451950226442
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1218, Accuracy: 9620/9900 (97.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 43.36737679543446.
Norm before scaling: 43.3299815911281. Distance: 1.151261522978896
Total norm for 4 adversaries is: 43.3299815911281. distance: 1.151261522978896
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0144, Accuracy: 9867/9900 (99.6667%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6206/6812 (91.1039%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0053, Accuracy: 6117/6812 (89.7974%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2575, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5054/5652 (89.4197%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4976/5652 (88.0396%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3538, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4577/4956 (92.3527%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4465/4956 (90.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1357, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5465/5939 (92.0189%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5381/5939 (90.6045%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0699, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4764/5399 (88.2386%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4641/5399 (85.9604%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2825, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6195/6947 (89.1752%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5963/6947 (85.8356%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4166, Accuracy: 4789/10000 (47.8900%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4316/4741 (91.0356%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4027/4741 (84.9399%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4785, Accuracy: 4834/10000 (48.3400%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3847/4108 (93.6465%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3756/4108 (91.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1030, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3513/3774 (93.0843%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3557/3774 (94.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9002, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4502/4889 (92.0843%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4400/4889 (89.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3134, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4340/4605 (94.2454%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4309/4605 (93.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0304, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4661/5038 (92.5169%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4626/5038 (91.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9409, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4601/5122 (89.8282%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4242/5122 (82.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3147, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4945/5298 (93.3371%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4893/5298 (92.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0924, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4954/5461 (90.7160%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4892/5461 (89.5807%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4849, Accuracy: 4913/10000 (49.1300%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4480/4830 (92.7536%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4435/4830 (91.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2269, Accuracy: 5264/10000 (52.6400%)
time spent on training: 263.304482460022
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.1872, Accuracy: 6791/10000 (67.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0151, Accuracy: 9870/9900 (99.6970%)
Done in 399.74914479255676 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 43.38082521222654.
Norm before scaling: 43.34108003672728. Distance: 1.076530382981162
Total norm for 4 adversaries is: 43.34108003672728. distance: 1.076530382981162
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0277, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5691/5777 (98.5113%), train_poison_data_count: 455
Global model norm: 43.38082521222654.
Norm before scaling: 43.33692831141531. Distance: 1.133694167523583
Total norm for 4 adversaries is: 43.33692831141531. distance: 1.133694167523583
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0278, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 43.38082521222654.
Norm before scaling: 43.34852482486789. Distance: 1.2645055270362695
Total norm for 4 adversaries is: 43.34852482486789. distance: 1.2645055270362695
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1184, Accuracy: 9624/9900 (97.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5411/5503 (98.3282%), train_poison_data_count: 430
Global model norm: 43.38082521222654.
Norm before scaling: 43.340970192943594. Distance: 1.111349524642246
Total norm for 4 adversaries is: 43.340970192943594. distance: 1.111349524642246
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0421, Accuracy: 9803/9900 (99.0202%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5343/6080 (87.8783%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5276/6080 (86.7763%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2877, Accuracy: 4856/10000 (48.5600%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4988/5559 (89.7284%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4781/5559 (86.0047%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1353, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5439/5871 (92.6418%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5352/5871 (91.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2305, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3958/4249 (93.1513%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3890/4249 (91.5510%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0141, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3601/3995 (90.1377%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3555/3995 (88.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2118, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4956/5454 (90.8691%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4742/5454 (86.9454%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2055, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3851/4161 (92.5499%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3829/4161 (92.0211%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1260, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4471/4732 (94.4844%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4417/4732 (93.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9219, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4370/4851 (90.0845%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4382/4851 (90.3319%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0730, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4574/5122 (89.3011%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0109, Accuracy: 4120/5122 (80.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 3.0614, Accuracy: 4159/10000 (41.5900%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5421/5939 (91.2780%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5354/5939 (90.1499%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2584, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4394/4672 (94.0497%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4309/4672 (92.2303%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9123, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 6255/6812 (91.8233%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 6164/6812 (90.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0798, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5033/5461 (92.1626%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5052/5461 (92.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1973, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4376/4894 (89.4156%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4271/4894 (87.2701%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1949, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3822/4175 (91.5449%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3810/4175 (91.2575%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0279, Accuracy: 5480/10000 (54.8000%)
time spent on training: 268.9862370491028
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.1863, Accuracy: 6805/10000 (68.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0153, Accuracy: 9868/9900 (99.6768%)
Done in 410.607581615448 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5252/5308 (98.9450%), train_poison_data_count: 415
Global model norm: 43.39377717439377.
Norm before scaling: 43.349133080918556. Distance: 0.9579716946854175
Total norm for 4 adversaries is: 43.349133080918556. distance: 0.9579716946854175
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0433, Accuracy: 9793/9900 (98.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5699/5777 (98.6498%), train_poison_data_count: 455
Global model norm: 43.39377717439377.
Norm before scaling: 43.35103664192689. Distance: 1.1292416823314964
Total norm for 4 adversaries is: 43.35103664192689. distance: 1.1292416823314964
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0539, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4992/5123 (97.4429%), train_poison_data_count: 403
Global model norm: 43.39377717439377.
Norm before scaling: 43.360468736205306. Distance: 1.2325044776572085
Total norm for 4 adversaries is: 43.360468736205306. distance: 1.2325044776572085
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0516, Accuracy: 9774/9900 (98.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5410/5503 (98.3100%), train_poison_data_count: 430
Global model norm: 43.39377717439377.
Norm before scaling: 43.35510677190318. Distance: 1.1496541332432872
Total norm for 4 adversaries is: 43.35510677190318. distance: 1.1496541332432872
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0534, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4708/5224 (90.1225%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4687/5224 (89.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1300, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4319/4797 (90.0354%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4242/4797 (88.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0825, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4993/5298 (94.2431%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4954/5298 (93.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0522, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3642/3910 (93.1458%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3453/3910 (88.3120%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1825, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4186/4587 (91.2579%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4182/4587 (91.1707%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0217, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4380/4731 (92.5808%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4363/4731 (92.2215%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1437, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6305/6812 (92.5573%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 6090/6812 (89.4011%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.3336, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4946/5702 (86.7415%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4806/5702 (84.2862%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.3078, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4525/4911 (92.1401%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4505/4911 (91.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0303, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3779/4111 (91.9241%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3748/4111 (91.1700%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2697, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3829/4145 (92.3764%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3833/4145 (92.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0912, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4177/4397 (94.9966%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4194/4397 (95.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8819, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4519/4979 (90.7612%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4503/4979 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0746, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4881/5353 (91.1825%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4678/5353 (87.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0470, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4096/4368 (93.7729%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4074/4368 (93.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0322, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4998/5346 (93.4905%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4929/5346 (92.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1267, Accuracy: 5229/10000 (52.2900%)
time spent on training: 271.8834729194641
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.1792, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0163, Accuracy: 9868/9900 (99.6768%)
Done in 412.45427560806274 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5259/5308 (99.0769%), train_poison_data_count: 415
Global model norm: 43.406143133417764.
Norm before scaling: 43.36223667358428. Distance: 0.9513359163361066
Total norm for 4 adversaries is: 43.36223667358428. distance: 0.9513359163361066
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0812, Accuracy: 9716/9900 (98.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5686/5777 (98.4248%), train_poison_data_count: 455
Global model norm: 43.406143133417764.
Norm before scaling: 43.36223245088979. Distance: 1.1199625402385007
Total norm for 4 adversaries is: 43.36223245088979. distance: 1.1199625402385007
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0646, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 43.406143133417764.
Norm before scaling: 43.37466087538538. Distance: 1.2844516016631673
Total norm for 4 adversaries is: 43.37466087538538. distance: 1.2844516016631673
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1120, Accuracy: 9657/9900 (97.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5414/5503 (98.3827%), train_poison_data_count: 430
Global model norm: 43.406143133417764.
Norm before scaling: 43.3677187917825. Distance: 1.1475034795139059
Total norm for 4 adversaries is: 43.3677187917825. distance: 1.1475034795139059
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0396, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4970/5489 (90.5447%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4899/5489 (89.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3027, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4446/4748 (93.6394%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4389/4748 (92.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0813, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5028/5645 (89.0700%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4917/5645 (87.1036%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2571, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4480/5018 (89.2786%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4378/5018 (87.2459%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2063, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3518/3774 (93.2167%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3517/3774 (93.1902%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0631, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4523/4830 (93.6439%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4469/4830 (92.5259%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2276, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4116/4485 (91.7726%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3777/4485 (84.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4350, Accuracy: 4858/10000 (48.5800%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4312/4605 (93.6374%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4265/4605 (92.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9974, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5562/6068 (91.6612%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5457/6068 (89.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2128, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6284/6947 (90.4563%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6058/6947 (87.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1886, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4855/5362 (90.5446%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4782/5362 (89.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1912, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4720/5224 (90.3522%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4674/5224 (89.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1242, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4135/4368 (94.6658%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4055/4368 (92.8342%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0166, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3967/4249 (93.3631%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3890/4249 (91.5510%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8653, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4901/5454 (89.8607%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4697/5454 (86.1203%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2056, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5436/5939 (91.5306%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5377/5939 (90.5371%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1189, Accuracy: 5238/10000 (52.3800%)
time spent on training: 264.98314571380615
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.1767, Accuracy: 6822/10000 (68.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0182, Accuracy: 9866/9900 (99.6566%)
Done in 400.52341961860657 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 43.41905099444036.
Norm before scaling: 43.379224060350886. Distance: 1.0547634521263078
Total norm for 4 adversaries is: 43.379224060350886. distance: 1.0547634521263078
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0475, Accuracy: 9781/9900 (98.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5693/5777 (98.5460%), train_poison_data_count: 455
Global model norm: 43.41905099444036.
Norm before scaling: 43.3757274907472. Distance: 1.1421674984956238
Total norm for 4 adversaries is: 43.3757274907472. distance: 1.1421674984956238
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0230, Accuracy: 9838/9900 (99.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 43.41905099444036.
Norm before scaling: 43.38477296691346. Distance: 1.1946110381280166
Total norm for 4 adversaries is: 43.38477296691346. distance: 1.1946110381280166
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0573, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5408/5503 (98.2737%), train_poison_data_count: 430
Global model norm: 43.41905099444036.
Norm before scaling: 43.380884304574465. Distance: 1.1690918488783897
Total norm for 4 adversaries is: 43.380884304574465. distance: 1.1690918488783897
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0426, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4147/4397 (94.3143%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4159/4397 (94.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8748, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3549/3774 (94.0382%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3579/3774 (94.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8367, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4387/4894 (89.6404%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4241/4894 (86.6571%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3243, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4768/5361 (88.9386%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4717/5361 (87.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1924, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5032/5526 (91.0604%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4830/5526 (87.4050%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1693, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5015/5298 (94.6584%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4931/5298 (93.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1113, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4839/5353 (90.3979%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4749/5353 (88.7166%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1081, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4365/4797 (90.9944%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4278/4797 (89.1807%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2358, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5425/5871 (92.4033%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5243/5871 (89.3034%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1781, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6307/6947 (90.7874%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6074/6947 (87.4334%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3053, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4357/4757 (91.5913%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4302/4757 (90.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0323, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4971/5559 (89.4226%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4848/5559 (87.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3531, Accuracy: 4899/10000 (48.9900%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4568/4956 (92.1711%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4463/4956 (90.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3547, Accuracy: 4936/10000 (49.3600%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4742/5193 (91.3152%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4507/5193 (86.7899%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.5169, Accuracy: 4816/10000 (48.1600%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3943/4249 (92.7983%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3836/4249 (90.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2130, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4783/5399 (88.5905%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4643/5399 (85.9974%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3307, Accuracy: 4880/10000 (48.8000%)
time spent on training: 270.56682300567627
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.1782, Accuracy: 6813/10000 (68.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0187, Accuracy: 9863/9900 (99.6263%)
Done in 411.1189467906952 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5243/5308 (98.7754%), train_poison_data_count: 415
Global model norm: 43.432051985238246.
Norm before scaling: 43.39005952548349. Distance: 1.0332901166266946
Total norm for 4 adversaries is: 43.39005952548349. distance: 1.0332901166266946
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0131, Accuracy: 9865/9900 (99.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 43.432051985238246.
Norm before scaling: 43.38987806568126. Distance: 1.1784480575294967
Total norm for 4 adversaries is: 43.38987806568126. distance: 1.1784480575294967
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0231, Accuracy: 9838/9900 (99.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 43.432051985238246.
Norm before scaling: 43.40086556551537. Distance: 1.2970128273399468
Total norm for 4 adversaries is: 43.40086556551537. distance: 1.2970128273399468
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0300, Accuracy: 9820/9900 (99.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5406/5503 (98.2373%), train_poison_data_count: 430
Global model norm: 43.432051985238246.
Norm before scaling: 43.39215680812533. Distance: 1.124480657442538
Total norm for 4 adversaries is: 43.39215680812533. distance: 1.124480657442538
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0387, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3973/4249 (93.5044%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3927/4249 (92.4217%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9782, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3589/3959 (90.6542%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3616/3959 (91.3362%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9809, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4491/4843 (92.7318%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4386/4843 (90.5637%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1551, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5202/5696 (91.3272%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5124/5696 (89.9579%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0842, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4637/5086 (91.1718%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4640/5086 (91.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0932, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5034/5645 (89.1763%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4782/5645 (84.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2141, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5084/5422 (93.7661%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4964/5422 (91.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1147, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4901/5362 (91.4025%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4749/5362 (88.5677%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1859, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5388/6080 (88.6184%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5253/6080 (86.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2698, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4273/4736 (90.2238%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4264/4736 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0738, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3836/4086 (93.8815%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3823/4086 (93.5634%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9841, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3679/3968 (92.7167%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3653/3968 (92.0615%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9575, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4482/5050 (88.7525%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4466/5050 (88.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0679, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3302/3589 (92.0033%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3254/3589 (90.6659%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1033, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5325/5907 (90.1473%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5300/5907 (89.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.4818, Accuracy: 4850/10000 (48.5000%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4642/4993 (92.9702%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4598/4993 (92.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0615, Accuracy: 5526/10000 (55.2600%)
time spent on training: 274.4283254146576
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.1805, Accuracy: 6819/10000 (68.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0162, Accuracy: 9868/9900 (99.6768%)
Done in 420.0905451774597 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 69, 7, 17, 81, 55, 66, 54, 73, 78, 3, 79, 38, 84, 90, 5, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5249/5308 (98.8885%), train_poison_data_count: 415
Global model norm: 43.44528931958562.
Norm before scaling: 43.4034474774722. Distance: 1.0037312633433095
Total norm for 4 adversaries is: 43.4034474774722. distance: 1.0037312633433095
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0340, Accuracy: 9825/9900 (99.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5700/5777 (98.6671%), train_poison_data_count: 455
Global model norm: 43.44528931958562.
Norm before scaling: 43.400047084237855. Distance: 1.1141654802961365
Total norm for 4 adversaries is: 43.400047084237855. distance: 1.1141654802961365
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0375, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4989/5123 (97.3843%), train_poison_data_count: 403
Global model norm: 43.44528931958562.
Norm before scaling: 43.40970193032529. Distance: 1.1843623822428353
Total norm for 4 adversaries is: 43.40970193032529. distance: 1.1843623822428353
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0724, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5415/5503 (98.4009%), train_poison_data_count: 430
Global model norm: 43.44528931958562.
Norm before scaling: 43.40691369183025. Distance: 1.1647458726785653
Total norm for 4 adversaries is: 43.40691369183025. distance: 1.1647458726785653
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0285, Accuracy: 9835/9900 (99.3434%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3938/4364 (90.2383%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3929/4364 (90.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9576, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4397/4869 (90.3060%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4148/4869 (85.1920%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3058, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4399/4903 (89.7206%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4360/4903 (88.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2253, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4728/5035 (93.9027%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4712/5035 (93.5849%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9601, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4379/4731 (92.5597%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4366/4731 (92.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1365, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4471/4843 (92.3188%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4432/4843 (91.5135%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0940, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5052/5645 (89.4951%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4870/5645 (86.2710%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1205, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4299/4605 (93.3550%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4318/4605 (93.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0891, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4115/4368 (94.2079%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4093/4368 (93.7042%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9763, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4986/5346 (93.2660%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4931/5346 (92.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0576, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3828/4111 (93.1160%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3790/4111 (92.1917%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0823, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5570/6235 (89.3344%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5499/6235 (88.1957%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2668, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4714/5209 (90.4972%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4634/5209 (88.9614%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3356, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4403/4748 (92.7338%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4321/4748 (91.0067%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3400, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4675/4993 (93.6311%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4613/4993 (92.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2785, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4550/4911 (92.6492%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4504/4911 (91.7125%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2160, Accuracy: 5156/10000 (51.5600%)
time spent on training: 268.89254927635193
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.1785, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0164, Accuracy: 9870/9900 (99.6970%)
Done in 406.23303174972534 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 96, 52, 20, 2, 65, 42, 1, 45, 48, 32, 68, 12, 39, 33, 4, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5233/5308 (98.5870%), train_poison_data_count: 415
Global model norm: 43.458004378149376.
Norm before scaling: 43.41609044098383. Distance: 1.0249924240762744
Total norm for 4 adversaries is: 43.41609044098383. distance: 1.0249924240762744
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0399, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5700/5777 (98.6671%), train_poison_data_count: 455
Global model norm: 43.458004378149376.
Norm before scaling: 43.41516118481106. Distance: 1.1687846316342239
Total norm for 4 adversaries is: 43.41516118481106. distance: 1.1687846316342239
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0301, Accuracy: 9833/9900 (99.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 43.458004378149376.
Norm before scaling: 43.424451446143074. Distance: 1.2284517741629468
Total norm for 4 adversaries is: 43.424451446143074. distance: 1.2284517741629468
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1407, Accuracy: 9566/9900 (96.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5415/5503 (98.4009%), train_poison_data_count: 430
Global model norm: 43.458004378149376.
Norm before scaling: 43.417265689595624. Distance: 1.1070059074133962
Total norm for 4 adversaries is: 43.417265689595624. distance: 1.1070059074133962
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0402, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4618/5086 (90.7983%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4630/5086 (91.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0315, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3856/4130 (93.3656%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3834/4130 (92.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1090, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4381/4714 (92.9359%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4436/4714 (94.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8583, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3644/3968 (91.8347%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3626/3968 (91.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1444, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4902/5497 (89.1759%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4845/5497 (88.1390%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1753, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5405/5907 (91.5016%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5263/5907 (89.0977%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4222, Accuracy: 4945/10000 (49.4500%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5105/5422 (94.1534%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4968/5422 (91.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9158, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4972/5489 (90.5812%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4871/5489 (88.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2644, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4498/4830 (93.1263%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4484/4830 (92.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2609, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5322/6080 (87.5329%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5342/6080 (87.8618%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2251, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3341/3589 (93.0900%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3027/3589 (84.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3085, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5033/5526 (91.0785%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4877/5526 (88.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1580, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3817/4175 (91.4251%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3725/4175 (89.2216%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2024, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4391/4818 (91.1374%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4325/4818 (89.7675%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0616, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3734/4028 (92.7011%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3742/4028 (92.8997%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9105, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4814/5399 (89.1647%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4622/5399 (85.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3808, Accuracy: 4872/10000 (48.7200%)
time spent on training: 276.6860258579254
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.1766, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0174, Accuracy: 9869/9900 (99.6869%)
Done in 412.48147988319397 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 27, 65, 15, 35, 94, 34, 49, 50, 42, 4, 93, 68, 90, 96, 92, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5259/5308 (99.0769%), train_poison_data_count: 415
Global model norm: 43.47097406244194.
Norm before scaling: 43.42701790117602. Distance: 0.9737983647040337
Total norm for 4 adversaries is: 43.42701790117602. distance: 0.9737983647040337
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0204, Accuracy: 9846/9900 (99.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5687/5777 (98.4421%), train_poison_data_count: 455
Global model norm: 43.47097406244194.
Norm before scaling: 43.42756181274744. Distance: 1.1484918386877678
Total norm for 4 adversaries is: 43.42756181274744. distance: 1.1484918386877678
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0251, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4981/5123 (97.2282%), train_poison_data_count: 403
Global model norm: 43.47097406244194.
Norm before scaling: 43.43767142502145. Distance: 1.2510507935321558
Total norm for 4 adversaries is: 43.43767142502145. distance: 1.2510507935321558
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0849, Accuracy: 9701/9900 (97.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5432/5503 (98.7098%), train_poison_data_count: 430
Global model norm: 43.47097406244194.
Norm before scaling: 43.42789068620677. Distance: 1.0507574255982925
Total norm for 4 adversaries is: 43.42789068620677. distance: 1.0507574255982925
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0123, Accuracy: 9871/9900 (99.7071%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4198/4587 (91.5195%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4125/4587 (89.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0398, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4926/5497 (89.6125%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4868/5497 (88.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1429, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5501/6068 (90.6559%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5438/6068 (89.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2494, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5129/5615 (91.3446%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5053/5615 (89.9911%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.5488, Accuracy: 4758/10000 (47.5800%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4662/5224 (89.2420%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4653/5224 (89.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3967, Accuracy: 4956/10000 (49.5600%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4529/4911 (92.2215%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4460/4911 (90.8165%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2959, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5011/5652 (88.6589%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4932/5652 (87.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3678, Accuracy: 4958/10000 (49.5800%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4400/4757 (92.4953%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4254/4757 (89.4261%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2587, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5355/5907 (90.6552%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5304/5907 (89.7918%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4668, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3674/4028 (91.2115%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3679/4028 (91.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1155, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4584/5055 (90.6825%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4453/5055 (88.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3686, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3342/3589 (93.1179%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3320/3589 (92.5049%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9467, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4460/4748 (93.9343%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4270/4748 (89.9326%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0109, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4652/5086 (91.4668%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4636/5086 (91.1522%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1524, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6234/6812 (91.5150%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 6126/6812 (89.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1487, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4064/4364 (93.1256%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3921/4364 (89.8488%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1910, Accuracy: 5219/10000 (52.1900%)
time spent on training: 265.21316933631897
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.1729, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0166, Accuracy: 9871/9900 (99.7071%)
Done in 406.945636510849 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 0, 83, 23, 90, 88, 51, 9, 6, 70, 7, 75, 87, 85, 89, 84, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5247/5308 (98.8508%), train_poison_data_count: 415
Global model norm: 43.48483257484729.
Norm before scaling: 43.44055885138119. Distance: 0.9802482934658195
Total norm for 4 adversaries is: 43.44055885138119. distance: 0.9802482934658195
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0404, Accuracy: 9800/9900 (98.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 43.48483257484729.
Norm before scaling: 43.440995812567415. Distance: 1.1833124613376305
Total norm for 4 adversaries is: 43.440995812567415. distance: 1.1833124613376305
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0687, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 43.48483257484729.
Norm before scaling: 43.45067105845072. Distance: 1.2204417688964475
Total norm for 4 adversaries is: 43.45067105845072. distance: 1.2204417688964475
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0437, Accuracy: 9790/9900 (98.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5424/5503 (98.5644%), train_poison_data_count: 430
Global model norm: 43.48483257484729.
Norm before scaling: 43.4433870785805. Distance: 1.081427505564268
Total norm for 4 adversaries is: 43.4433870785805. distance: 1.081427505564268
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0336, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4903/5454 (89.8973%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4742/5454 (86.9454%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3353, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3245/3552 (91.3570%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3267/3552 (91.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1673, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4212/4549 (92.5918%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4030/4549 (88.5909%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1608, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4479/4748 (94.3345%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4337/4748 (91.3437%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0842, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4871/5362 (90.8430%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4759/5362 (88.7542%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1431, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3770/4108 (91.7722%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3777/4108 (91.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1054, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5144/5727 (89.8202%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4978/5727 (86.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1413, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4519/4929 (91.6819%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4420/4929 (89.6734%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2447, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5408/5871 (92.1138%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5293/5871 (90.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1838, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4450/4869 (91.3945%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3889/4869 (79.8727%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.5485, Accuracy: 4540/10000 (45.4000%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4344/4672 (92.9795%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4311/4672 (92.2731%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1789, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3556/3995 (89.0113%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3509/3995 (87.8348%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1858, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6199/6947 (89.2328%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 6010/6947 (86.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.4512, Accuracy: 4828/10000 (48.2800%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4295/4737 (90.6692%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4242/4737 (89.5503%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2540, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4715/5209 (90.5164%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4570/5209 (87.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3146, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3714/3968 (93.5988%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3692/3968 (93.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0521, Accuracy: 5379/10000 (53.7900%)
time spent on training: 266.4981110095978
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.1807, Accuracy: 6797/10000 (67.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0152, Accuracy: 9872/9900 (99.7172%)
Done in 422.7203130722046 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 27, 69, 59, 16, 44, 4, 1, 35, 8, 7, 23, 66, 88, 42, 52, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5242/5308 (98.7566%), train_poison_data_count: 415
Global model norm: 43.49803279944824.
Norm before scaling: 43.45455628485996. Distance: 0.9957653027737047
Total norm for 4 adversaries is: 43.45455628485996. distance: 0.9957653027737047
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0351, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5698/5777 (98.6325%), train_poison_data_count: 455
Global model norm: 43.49803279944824.
Norm before scaling: 43.45320787253874. Distance: 1.139421062783427
Total norm for 4 adversaries is: 43.45320787253874. distance: 1.139421062783427
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0282, Accuracy: 9832/9900 (99.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 43.49803279944824.
Norm before scaling: 43.464672256615486. Distance: 1.2148542986347441
Total norm for 4 adversaries is: 43.464672256615486. distance: 1.2148542986347441
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1022, Accuracy: 9658/9900 (97.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5428/5503 (98.6371%), train_poison_data_count: 430
Global model norm: 43.49803279944824.
Norm before scaling: 43.4556363891311. Distance: 1.079908913020794
Total norm for 4 adversaries is: 43.4556363891311. distance: 1.079908913020794
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0380, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4132/4587 (90.0807%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4073/4587 (88.7944%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3283, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4013/4364 (91.9569%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3954/4364 (90.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9761, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4165/4397 (94.7237%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4184/4397 (95.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9339, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4826/5353 (90.1551%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4681/5353 (87.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1660, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4714/5075 (92.8867%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4569/5075 (90.0296%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1398, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3725/4028 (92.4777%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3725/4028 (92.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9795, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5097/5422 (94.0059%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5027/5422 (92.7149%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0916, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5115/5615 (91.0953%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5022/5615 (89.4390%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3008, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4490/4889 (91.8388%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4354/4889 (89.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0516, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4422/4869 (90.8195%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4087/4869 (83.9392%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2624, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4240/4549 (93.2073%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3792/4549 (83.3590%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.6079, Accuracy: 4690/10000 (46.9000%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4439/4843 (91.6581%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4404/4843 (90.9354%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0673, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4839/5362 (90.2462%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4765/5362 (88.8661%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2978, Accuracy: 4886/10000 (48.8600%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5424/5907 (91.8233%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5318/5907 (90.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.4961, Accuracy: 4913/10000 (49.1300%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3851/4130 (93.2446%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3777/4130 (91.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0128, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4992/5454 (91.5292%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4845/5454 (88.8339%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1317, Accuracy: 5404/10000 (54.0400%)
time spent on training: 262.3936562538147
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.1747, Accuracy: 6807/10000 (68.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0153, Accuracy: 9872/9900 (99.7172%)
Done in 411.39218497276306 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 54, 63, 3, 38, 67, 73, 20, 32, 49, 0, 75, 56, 10, 2, 42, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5239/5308 (98.7001%), train_poison_data_count: 415
Global model norm: 43.511008787916964.
Norm before scaling: 43.467109961872325. Distance: 0.9875669649813985
Total norm for 4 adversaries is: 43.467109961872325. distance: 0.9875669649813985
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0096, Accuracy: 9873/9900 (99.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5694/5777 (98.5633%), train_poison_data_count: 455
Global model norm: 43.511008787916964.
Norm before scaling: 43.46546003230971. Distance: 1.1097092460751081
Total norm for 4 adversaries is: 43.46546003230971. distance: 1.1097092460751081
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0294, Accuracy: 9822/9900 (99.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 43.511008787916964.
Norm before scaling: 43.47703068593375. Distance: 1.240915474889532
Total norm for 4 adversaries is: 43.47703068593375. distance: 1.240915474889532
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0791, Accuracy: 9713/9900 (98.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5436/5503 (98.7825%), train_poison_data_count: 430
Global model norm: 43.511008787916964.
Norm before scaling: 43.46809848541226. Distance: 1.0577255010398146
Total norm for 4 adversaries is: 43.46809848541226. distance: 1.0577255010398146
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0435, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5059/5645 (89.6191%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4766/5645 (84.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3647, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3648/3910 (93.2992%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3283/3910 (83.9642%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.6647, Accuracy: 4623/10000 (46.2300%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5027/5346 (94.0329%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4956/5346 (92.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0927, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5565/6235 (89.2542%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5432/6235 (87.1211%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4720, Accuracy: 4822/10000 (48.2200%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4914/5559 (88.3972%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4824/5559 (86.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2180, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4328/4605 (93.9848%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4284/4605 (93.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1850, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4462/4714 (94.6542%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4433/4714 (94.0390%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8945, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5404/6080 (88.8816%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5199/6080 (85.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3825, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5071/5652 (89.7205%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4903/5652 (86.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3244, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4989/5454 (91.4741%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4676/5454 (85.7352%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1030, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4365/4672 (93.4289%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4385/4672 (93.8570%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8921, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4863/5427 (89.6075%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4703/5427 (86.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2936, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4683/5068 (92.4033%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4560/5068 (89.9763%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2514, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3705/3968 (93.3720%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3682/3968 (92.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9612, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5318/5907 (90.0288%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5245/5907 (88.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.4089, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4429/4851 (91.3008%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4398/4851 (90.6617%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0993, Accuracy: 5331/10000 (53.3100%)
time spent on training: 265.2696146965027
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.1750, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0131, Accuracy: 9873/9900 (99.7273%)
Done in 401.9935567378998 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 92, 39, 50, 63, 32, 3, 4, 22, 47, 68, 64, 51, 16, 62, 87, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5256/5308 (99.0203%), train_poison_data_count: 415
Global model norm: 43.52390097469076.
Norm before scaling: 43.47740410798177. Distance: 0.9162653926165312
Total norm for 4 adversaries is: 43.47740410798177. distance: 0.9162653926165312
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0403, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5707/5777 (98.7883%), train_poison_data_count: 455
Global model norm: 43.52390097469076.
Norm before scaling: 43.47669937646917. Distance: 1.080582899130657
Total norm for 4 adversaries is: 43.47669937646917. distance: 1.080582899130657
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0393, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 43.52390097469076.
Norm before scaling: 43.48842422981301. Distance: 1.1678947501837287
Total norm for 4 adversaries is: 43.48842422981301. distance: 1.1678947501837287
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0497, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5426/5503 (98.6008%), train_poison_data_count: 430
Global model norm: 43.52390097469076.
Norm before scaling: 43.483500541423034. Distance: 1.124423568126156
Total norm for 4 adversaries is: 43.483500541423034. distance: 1.124423568126156
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0695, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6302/6812 (92.5132%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6241/6812 (91.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2299, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3848/4175 (92.1677%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3710/4175 (88.8623%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2468, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4408/4757 (92.6634%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4319/4757 (90.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1906, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3670/3910 (93.8619%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3410/3910 (87.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3315, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5413/6080 (89.0296%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5260/6080 (86.5132%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.4719, Accuracy: 4762/10000 (47.6200%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4983/5346 (93.2099%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4941/5346 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2027, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3735/4028 (92.7259%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3684/4028 (91.4598%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0007, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5261/5696 (92.3631%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5131/5696 (90.0808%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1288, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4657/5123 (90.9038%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4036/5123 (78.7820%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2930, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3335/3589 (92.9228%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3188/3589 (88.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0162, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4418/4894 (90.2738%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4242/4894 (86.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2570, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3845/4108 (93.5979%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3701/4108 (90.0925%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1412, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4904/5353 (91.6122%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4781/5353 (89.3144%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1680, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4814/5504 (87.4637%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4815/5504 (87.4818%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2280, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3589/3995 (89.8373%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3529/3995 (88.3354%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2158, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5062/5615 (90.1514%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4954/5615 (88.2280%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3239, Accuracy: 4986/10000 (49.8600%)
time spent on training: 275.0022177696228
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.1731, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0136, Accuracy: 9874/9900 (99.7374%)
Done in 415.17947340011597 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 34, 96, 45, 52, 66, 63, 32, 29, 57, 44, 77, 79, 94, 64, 51, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5242/5308 (98.7566%), train_poison_data_count: 415
Global model norm: 43.536492135459625.
Norm before scaling: 43.493449803174386. Distance: 1.0051148853777474
Total norm for 4 adversaries is: 43.493449803174386. distance: 1.0051148853777474
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0383, Accuracy: 9816/9900 (99.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5698/5777 (98.6325%), train_poison_data_count: 455
Global model norm: 43.536492135459625.
Norm before scaling: 43.48956524450722. Distance: 1.0959575174166172
Total norm for 4 adversaries is: 43.48956524450722. distance: 1.0959575174166172
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0594, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5004/5123 (97.6771%), train_poison_data_count: 403
Global model norm: 43.536492135459625.
Norm before scaling: 43.50086009611261. Distance: 1.1809751039379348
Total norm for 4 adversaries is: 43.50086009611261. distance: 1.1809751039379348
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0525, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5422/5503 (98.5281%), train_poison_data_count: 430
Global model norm: 43.536492135459625.
Norm before scaling: 43.493202818443365. Distance: 1.0713774680257304
Total norm for 4 adversaries is: 43.493202818443365. distance: 1.0713774680257304
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0381, Accuracy: 9812/9900 (99.1111%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4553/4911 (92.7102%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4537/4911 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1770, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4681/5086 (92.0370%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4651/5086 (91.4471%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0500, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4938/5489 (89.9617%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4878/5489 (88.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3099, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3864/4130 (93.5593%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3826/4130 (92.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0343, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4444/4843 (91.7613%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4397/4843 (90.7908%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1218, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3632/3910 (92.8900%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3525/3910 (90.1535%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2053, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5418/6080 (89.1118%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5272/6080 (86.7105%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3054, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4464/4732 (94.3364%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4446/4732 (93.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0553, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4607/4956 (92.9580%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4495/4956 (90.6981%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2852, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4713/5075 (92.8670%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4541/5075 (89.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3285, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4520/5050 (89.5050%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4410/5050 (87.3267%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.3249, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3814/4111 (92.7755%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3764/4111 (91.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1704, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4718/5224 (90.3139%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4690/5224 (89.7779%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1513, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4424/4894 (90.3964%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4234/4894 (86.5141%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2885, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3830/4108 (93.2327%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3780/4108 (92.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9233, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5828/6664 (87.4550%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5651/6664 (84.7989%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2707, Accuracy: 4872/10000 (48.7200%)
time spent on training: 261.68187737464905
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.1718, Accuracy: 6812/10000 (68.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0142, Accuracy: 9871/9900 (99.7071%)
Done in 398.29605770111084 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 69, 1, 68, 16, 44, 2, 45, 27, 14, 83, 87, 12, 50, 43, 37, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5240/5308 (98.7189%), train_poison_data_count: 415
Global model norm: 43.548527451155714.
Norm before scaling: 43.50499056546918. Distance: 1.0105734569119063
Total norm for 4 adversaries is: 43.50499056546918. distance: 1.0105734569119063
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0495, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5684/5777 (98.3902%), train_poison_data_count: 455
Global model norm: 43.548527451155714.
Norm before scaling: 43.502794899437205. Distance: 1.129869624187022
Total norm for 4 adversaries is: 43.502794899437205. distance: 1.129869624187022
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0395, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5003/5123 (97.6576%), train_poison_data_count: 403
Global model norm: 43.548527451155714.
Norm before scaling: 43.5152995948336. Distance: 1.2375223138512141
Total norm for 4 adversaries is: 43.5152995948336. distance: 1.2375223138512141
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0755, Accuracy: 9715/9900 (98.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5420/5503 (98.4917%), train_poison_data_count: 430
Global model norm: 43.548527451155714.
Norm before scaling: 43.50722960980522. Distance: 1.1141895002442488
Total norm for 4 adversaries is: 43.50722960980522. distance: 1.1141895002442488
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0160, Accuracy: 9865/9900 (99.6465%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4035/4364 (92.4610%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3955/4364 (90.6279%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0930, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5061/5422 (93.3419%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4993/5422 (92.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0130, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3324/3589 (92.6163%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3106/3589 (86.5422%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.5696, Accuracy: 4735/10000 (47.3500%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4817/5353 (89.9869%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4719/5353 (88.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2505, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4684/5075 (92.2956%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4608/5075 (90.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2946, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3684/3968 (92.8427%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3656/3968 (92.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0298, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4977/5489 (90.6723%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4926/5489 (89.7431%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0880, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4175/4587 (91.0181%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4094/4587 (89.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0916, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3962/4196 (94.4233%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3939/4196 (93.8751%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9817, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3251/3552 (91.5259%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3267/3552 (91.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9748, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3580/3995 (89.6120%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3476/3995 (87.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3665, Accuracy: 4901/10000 (49.0100%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5001/5526 (90.4995%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4861/5526 (87.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2193, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4370/4757 (91.8646%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4388/4757 (92.2430%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0977, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4543/4979 (91.2432%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4500/4979 (90.3796%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3730, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4349/4741 (91.7317%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4211/4741 (88.8209%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2879, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4696/5193 (90.4294%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4497/5193 (86.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4104, Accuracy: 4977/10000 (49.7700%)
time spent on training: 265.1036367416382
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.1726, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0134, Accuracy: 9873/9900 (99.7273%)
Done in 402.458233833313 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 63, 26, 6, 29, 91, 4, 39, 1, 80, 62, 89, 20, 33, 74, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5260/5308 (99.0957%), train_poison_data_count: 415
Global model norm: 43.56148979953151.
Norm before scaling: 43.515058344604974. Distance: 0.9243499378987816
Total norm for 4 adversaries is: 43.515058344604974. distance: 0.9243499378987816
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0303, Accuracy: 9830/9900 (99.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5700/5777 (98.6671%), train_poison_data_count: 455
Global model norm: 43.56148979953151.
Norm before scaling: 43.516094869545825. Distance: 1.1224947160796117
Total norm for 4 adversaries is: 43.516094869545825. distance: 1.1224947160796117
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0328, Accuracy: 9820/9900 (99.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 43.56148979953151.
Norm before scaling: 43.52530469092089. Distance: 1.1873366092909425
Total norm for 4 adversaries is: 43.52530469092089. distance: 1.1873366092909425
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1470, Accuracy: 9538/9900 (96.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5423/5503 (98.5462%), train_poison_data_count: 430
Global model norm: 43.56148979953151.
Norm before scaling: 43.51922813853019. Distance: 1.1026942614381736
Total norm for 4 adversaries is: 43.51922813853019. distance: 1.1026942614381736
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0306, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3639/3910 (93.0691%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3455/3910 (88.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1983, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3825/4086 (93.6123%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3818/4086 (93.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3704, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4552/4929 (92.3514%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4421/4929 (89.6936%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2734, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4450/4732 (94.0406%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4456/4732 (94.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9693, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4093/4527 (90.4131%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3950/4527 (87.2543%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2125, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3748/4028 (93.0487%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3707/4028 (92.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0612, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3814/4175 (91.3533%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3701/4175 (88.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0898, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5126/5422 (94.5408%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5055/5422 (93.2313%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1004, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4962/5461 (90.8625%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4890/5461 (89.5440%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3714, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4825/5504 (87.6635%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4750/5504 (86.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1933, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4335/4737 (91.5136%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4291/4737 (90.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2775, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4391/4714 (93.1481%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4387/4714 (93.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0732, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4389/4818 (91.0959%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4222/4818 (87.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1034, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4379/4797 (91.2862%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4325/4797 (90.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1927, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4618/5055 (91.3551%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4511/5055 (89.2384%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.4144, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4959/5497 (90.2128%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4897/5497 (89.0850%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1935, Accuracy: 5247/10000 (52.4700%)
time spent on training: 264.19553899765015
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.1710, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0144, Accuracy: 9871/9900 (99.7071%)
Done in 399.536908864975 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 4, 98, 5, 17, 65, 46, 15, 48, 68, 94, 2, 93, 43, 10, 26, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5263/5308 (99.1522%), train_poison_data_count: 415
Global model norm: 43.57372271820985.
Norm before scaling: 43.5277796647045. Distance: 0.9339916386914164
Total norm for 4 adversaries is: 43.5277796647045. distance: 0.9339916386914164
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0475, Accuracy: 9798/9900 (98.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5706/5777 (98.7710%), train_poison_data_count: 455
Global model norm: 43.57372271820985.
Norm before scaling: 43.52528646113013. Distance: 1.0288161253506354
Total norm for 4 adversaries is: 43.52528646113013. distance: 1.0288161253506354
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0639, Accuracy: 9743/9900 (98.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4995/5123 (97.5015%), train_poison_data_count: 403
Global model norm: 43.57372271820985.
Norm before scaling: 43.54029260441557. Distance: 1.2452836228376563
Total norm for 4 adversaries is: 43.54029260441557. distance: 1.2452836228376563
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0447, Accuracy: 9786/9900 (98.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5429/5503 (98.6553%), train_poison_data_count: 430
Global model norm: 43.57372271820985.
Norm before scaling: 43.53068354800152. Distance: 1.0317299621795466
Total norm for 4 adversaries is: 43.53068354800152. distance: 1.0317299621795466
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0333, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3708/4028 (92.0556%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3702/4028 (91.9067%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0186, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3897/4161 (93.6554%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3769/4161 (90.5792%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0074, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4693/4993 (93.9916%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4584/4993 (91.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2949, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4387/4903 (89.4758%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4308/4903 (87.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3082, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4971/5497 (90.4311%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4815/5497 (87.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2053, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4817/5399 (89.2202%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4661/5399 (86.3308%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3029, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5600/6068 (92.2874%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5439/6068 (89.6341%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2142, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4555/4830 (94.3064%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4497/4830 (93.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1571, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3338/3589 (93.0064%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3185/3589 (88.7434%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2921, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4709/5224 (90.1417%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4649/5224 (88.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2497, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3649/3968 (91.9607%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3676/3968 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8672, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4609/5055 (91.1771%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4544/5055 (89.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2387, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4531/4979 (91.0022%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4509/4979 (90.5604%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0745, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4695/5068 (92.6401%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4625/5068 (91.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1933, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3841/4086 (94.0039%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3815/4086 (93.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9903, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4872/5362 (90.8616%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4781/5362 (89.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3968, Accuracy: 4879/10000 (48.7900%)
time spent on training: 261.7623438835144
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.1652, Accuracy: 6824/10000 (68.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0152, Accuracy: 9869/9900 (99.6869%)
Done in 399.4056851863861 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 7, 81, 4, 44, 5, 99, 83, 55, 94, 14, 32, 74, 20, 49, 23, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5255/5308 (99.0015%), train_poison_data_count: 415
Global model norm: 43.58660335685152.
Norm before scaling: 43.539047780591446. Distance: 0.9169434685810881
Total norm for 4 adversaries is: 43.539047780591446. distance: 0.9169434685810881
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0469, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5683/5777 (98.3729%), train_poison_data_count: 455
Global model norm: 43.58660335685152.
Norm before scaling: 43.53988327438275. Distance: 1.100672044068141
Total norm for 4 adversaries is: 43.53988327438275. distance: 1.100672044068141
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0363, Accuracy: 9802/9900 (99.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 43.58660335685152.
Norm before scaling: 43.55115106158576. Distance: 1.2061917740599695
Total norm for 4 adversaries is: 43.55115106158576. distance: 1.2061917740599695
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0289, Accuracy: 9825/9900 (99.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5439/5503 (98.8370%), train_poison_data_count: 430
Global model norm: 43.58660335685152.
Norm before scaling: 43.541756067990356. Distance: 1.0353395695577332
Total norm for 4 adversaries is: 43.541756067990356. distance: 1.0353395695577332
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0612, Accuracy: 9757/9900 (98.5556%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4404/4869 (90.4498%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4202/4869 (86.3011%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2104, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4727/5035 (93.8828%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4658/5035 (92.5124%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9830, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3765/4028 (93.4707%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3718/4028 (92.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0561, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4738/5075 (93.3596%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4595/5075 (90.5419%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2037, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4679/4993 (93.7112%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4627/4993 (92.6697%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0244, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4426/4851 (91.2389%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4411/4851 (90.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0670, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3283/3552 (92.4268%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3286/3552 (92.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8203, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4390/4731 (92.7922%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4320/4731 (91.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0989, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4719/5224 (90.3331%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4635/5224 (88.7251%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2337, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4000/4196 (95.3289%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3951/4196 (94.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9262, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5441/6080 (89.4901%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5265/6080 (86.5954%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3933, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4359/4797 (90.8693%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4287/4797 (89.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1540, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4405/4714 (93.4451%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4378/4714 (92.8723%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0005, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5047/5652 (89.2958%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4932/5652 (87.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3320, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4268/4549 (93.8228%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4078/4549 (89.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1771, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4861/5504 (88.3176%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4729/5504 (85.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.5714, Accuracy: 4512/10000 (45.1200%)
time spent on training: 266.3083338737488
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.1644, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0158, Accuracy: 9869/9900 (99.6869%)
Done in 401.861533164978 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 0, 97, 90, 3, 15, 93, 69, 88, 79, 65, 44, 84, 6, 78, 24, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5250/5308 (98.9073%), train_poison_data_count: 415
Global model norm: 43.598736833945374.
Norm before scaling: 43.55455787536765. Distance: 1.0060783666343145
Total norm for 4 adversaries is: 43.55455787536765. distance: 1.0060783666343145
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0083, Accuracy: 9874/9900 (99.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5692/5777 (98.5286%), train_poison_data_count: 455
Global model norm: 43.598736833945374.
Norm before scaling: 43.55212786761256. Distance: 1.0917510703754003
Total norm for 4 adversaries is: 43.55212786761256. distance: 1.0917510703754003
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0582, Accuracy: 9762/9900 (98.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 43.598736833945374.
Norm before scaling: 43.56241313208699. Distance: 1.2138302614053655
Total norm for 4 adversaries is: 43.56241313208699. distance: 1.2138302614053655
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2207, Accuracy: 9335/9900 (94.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5438/5503 (98.8188%), train_poison_data_count: 430
Global model norm: 43.598736833945374.
Norm before scaling: 43.55269684352221. Distance: 1.005544728073876
Total norm for 4 adversaries is: 43.55269684352221. distance: 1.005544728073876
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0518, Accuracy: 9757/9900 (98.5556%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4993/5454 (91.5475%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4855/5454 (89.0172%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0459, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4265/4736 (90.0549%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4218/4736 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0265, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4486/4748 (94.4819%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4391/4748 (92.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9689, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4994/5346 (93.4156%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4876/5346 (91.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2067, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5490/6068 (90.4746%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5416/6068 (89.2551%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3053, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4627/5055 (91.5331%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4564/5055 (90.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0733, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4024/4364 (92.2090%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3939/4364 (90.2612%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2524, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4948/5362 (92.2790%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4760/5362 (88.7728%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1805, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3828/4111 (93.1160%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3773/4111 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1276, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4933/5497 (89.7399%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4826/5497 (87.7933%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0579, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4758/5075 (93.7537%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4640/5075 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0076, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4727/5209 (90.7468%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4608/5209 (88.4623%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.3643, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4535/4929 (92.0065%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4470/4929 (90.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2687, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4059/4368 (92.9258%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3917/4368 (89.6749%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2590, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4021/4313 (93.2298%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3920/4313 (90.8880%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0472, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3737/4028 (92.7756%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3640/4028 (90.3674%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1896, Accuracy: 5293/10000 (52.9300%)
time spent on training: 265.68359303474426
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.1661, Accuracy: 6822/10000 (68.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0172, Accuracy: 9868/9900 (99.6768%)
Done in 408.59876894950867 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 38, 89, 81, 43, 21, 40, 78, 9, 14, 83, 85, 20, 65, 97, 3, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5266/5308 (99.2087%), train_poison_data_count: 415
Global model norm: 43.611335778653206.
Norm before scaling: 43.56508494168882. Distance: 0.9280447350419618
Total norm for 4 adversaries is: 43.56508494168882. distance: 0.9280447350419618
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0394, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5703/5777 (98.7191%), train_poison_data_count: 455
Global model norm: 43.611335778653206.
Norm before scaling: 43.563012797376345. Distance: 1.0692294690504756
Total norm for 4 adversaries is: 43.563012797376345. distance: 1.0692294690504756
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0145, Accuracy: 9865/9900 (99.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5028/5123 (98.1456%), train_poison_data_count: 403
Global model norm: 43.611335778653206.
Norm before scaling: 43.57403648129741. Distance: 1.1367502634196232
Total norm for 4 adversaries is: 43.57403648129741. distance: 1.1367502634196232
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0733, Accuracy: 9725/9900 (98.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5429/5503 (98.6553%), train_poison_data_count: 430
Global model norm: 43.611335778653206.
Norm before scaling: 43.570318803791906. Distance: 1.1177022854990073
Total norm for 4 adversaries is: 43.570318803791906. distance: 1.1177022854990073
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0364, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5544/6235 (88.9174%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5443/6235 (87.2975%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3382, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4309/4737 (90.9647%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4265/4737 (90.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3312, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4729/5035 (93.9225%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4700/5035 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0029, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4556/4979 (91.5043%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4454/4979 (89.4557%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0592, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4617/5038 (91.6435%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4566/5038 (90.6312%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1327, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5432/5939 (91.4632%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5328/5939 (89.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3387, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4123/4368 (94.3910%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3997/4368 (91.5064%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2733, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5192/5727 (90.6583%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4971/5727 (86.7994%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2858, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3996/4196 (95.2336%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3922/4196 (93.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9159, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3291/3552 (92.6520%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3307/3552 (93.1025%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9020, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6289/6947 (90.5283%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5993/6947 (86.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2948, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4408/4714 (93.5087%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4355/4714 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9291, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4934/5497 (89.7580%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4840/5497 (88.0480%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2533, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4285/4736 (90.4772%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4168/4736 (88.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1086, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5046/5346 (94.3883%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4953/5346 (92.6487%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1157, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4533/4956 (91.4649%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4446/4956 (89.7094%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0900, Accuracy: 5330/10000 (53.3000%)
time spent on training: 271.3044958114624
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.1663, Accuracy: 6831/10000 (68.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0165, Accuracy: 9868/9900 (99.6768%)
Done in 412.0487551689148 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 79, 41, 44, 27, 24, 6, 29, 62, 19, 17, 51, 10, 22, 55, 2, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5259/5308 (99.0769%), train_poison_data_count: 415
Global model norm: 43.623155964786925.
Norm before scaling: 43.578466743012825. Distance: 0.9869366572073714
Total norm for 4 adversaries is: 43.578466743012825. distance: 0.9869366572073714
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0295, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5705/5777 (98.7537%), train_poison_data_count: 455
Global model norm: 43.623155964786925.
Norm before scaling: 43.5751822576689. Distance: 1.06963889650994
Total norm for 4 adversaries is: 43.5751822576689. distance: 1.06963889650994
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0616, Accuracy: 9752/9900 (98.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5016/5123 (97.9114%), train_poison_data_count: 403
Global model norm: 43.623155964786925.
Norm before scaling: 43.587278305465745. Distance: 1.2010176396785734
Total norm for 4 adversaries is: 43.587278305465745. distance: 1.2010176396785734
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0214, Accuracy: 9845/9900 (99.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5445/5503 (98.9460%), train_poison_data_count: 430
Global model norm: 43.623155964786925.
Norm before scaling: 43.577168385430774. Distance: 0.9768969764116776
Total norm for 4 adversaries is: 43.577168385430774. distance: 0.9768969764116776
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0437, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3841/4111 (93.4323%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3738/4111 (90.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1377, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4370/4714 (92.7026%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4330/4714 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1993, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4748/5075 (93.5567%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4634/5075 (91.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1922, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4199/4587 (91.5413%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4098/4587 (89.3394%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1143, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4031/4313 (93.4616%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4013/4313 (93.0443%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0193, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4521/4929 (91.7225%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4425/4929 (89.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0750, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4462/4732 (94.2942%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4463/4732 (94.3153%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8795, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4837/5504 (87.8815%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4745/5504 (86.2100%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3213, Accuracy: 5022/10000 (50.2200%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4799/5361 (89.5169%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4698/5361 (87.6329%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.4285, Accuracy: 4873/10000 (48.7300%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4367/4903 (89.0679%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4321/4903 (88.1297%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2088, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3827/4108 (93.1597%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3745/4108 (91.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1579, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4712/5068 (92.9755%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4482/5068 (88.4373%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3591, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5199/5696 (91.2746%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5144/5696 (90.3090%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1600, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4423/4731 (93.4897%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4358/4731 (92.1158%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0094, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3661/3968 (92.2631%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3586/3968 (90.3730%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9047, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3973/4249 (93.5044%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3840/4249 (90.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1000, Accuracy: 5395/10000 (53.9500%)
time spent on training: 259.6871700286865
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.1657, Accuracy: 6836/10000 (68.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0163, Accuracy: 9869/9900 (99.6869%)
Done in 398.06428837776184 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 11, 83, 23, 59, 10, 86, 19, 48, 50, 12, 38, 98, 74, 21, 63, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5264/5308 (99.1711%), train_poison_data_count: 415
Global model norm: 43.6353422218769.
Norm before scaling: 43.58880180250571. Distance: 0.9457079162854445
Total norm for 4 adversaries is: 43.58880180250571. distance: 0.9457079162854445
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0219, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5715/5777 (98.9268%), train_poison_data_count: 455
Global model norm: 43.6353422218769.
Norm before scaling: 43.5864885305283. Distance: 1.0482309584267604
Total norm for 4 adversaries is: 43.5864885305283. distance: 1.0482309584267604
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0451, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5007/5123 (97.7357%), train_poison_data_count: 403
Global model norm: 43.6353422218769.
Norm before scaling: 43.59776387211203. Distance: 1.1530774900165157
Total norm for 4 adversaries is: 43.59776387211203. distance: 1.1530774900165157
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0666, Accuracy: 9745/9900 (98.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5433/5503 (98.7280%), train_poison_data_count: 430
Global model norm: 43.6353422218769.
Norm before scaling: 43.58959713642264. Distance: 1.0089950129723153
Total norm for 4 adversaries is: 43.58959713642264. distance: 1.0089950129723153
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0341, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4923/5702 (86.3381%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4449/5702 (78.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4296, Accuracy: 4737/10000 (47.3700%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3279/3552 (92.3142%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3303/3552 (92.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8999, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4284/4549 (94.1745%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   2,  Average loss: 0.0100, Accuracy: 3704/4549 (81.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3982, Accuracy: 4863/10000 (48.6300%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4202/4397 (95.5652%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4151/4397 (94.4053%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0078, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4769/5068 (94.1002%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4584/5068 (90.4499%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2519, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3591/3929 (91.3973%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3563/3929 (90.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9609, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4799/5361 (89.5169%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4697/5361 (87.6143%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1908, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4539/4830 (93.9752%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4494/4830 (93.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0887, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4398/4757 (92.4532%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4284/4757 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1763, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5081/5526 (91.9472%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4846/5526 (87.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2475, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5577/6235 (89.4467%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5414/6235 (86.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3069, Accuracy: 4913/10000 (49.1300%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3877/4161 (93.1747%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3763/4161 (90.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0836, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4396/4797 (91.6406%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4292/4797 (89.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4229, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4640/5038 (92.1000%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4640/5038 (92.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8289, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3660/3910 (93.6061%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3468/3910 (88.6957%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3004, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4883/5504 (88.7173%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4753/5504 (86.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3656, Accuracy: 4907/10000 (49.0700%)
time spent on training: 262.86386609077454
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.1649, Accuracy: 6831/10000 (68.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0152, Accuracy: 9870/9900 (99.6970%)
Done in 399.18454360961914 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 7, 2, 12, 90, 33, 98, 27, 94, 1, 52, 14, 48, 96, 37, 20, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5257/5308 (99.0392%), train_poison_data_count: 415
Global model norm: 43.64678673381925.
Norm before scaling: 43.5993737971982. Distance: 0.9212493713252538
Total norm for 4 adversaries is: 43.5993737971982. distance: 0.9212493713252538
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0145, Accuracy: 9863/9900 (99.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5706/5777 (98.7710%), train_poison_data_count: 455
Global model norm: 43.64678673381925.
Norm before scaling: 43.59788986839343. Distance: 1.0712761543490796
Total norm for 4 adversaries is: 43.59788986839343. distance: 1.0712761543490796
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0424, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 43.64678673381925.
Norm before scaling: 43.61030851517864. Distance: 1.2466532249457012
Total norm for 4 adversaries is: 43.61030851517864. distance: 1.2466532249457012
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0776, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5445/5503 (98.9460%), train_poison_data_count: 430
Global model norm: 43.64678673381925.
Norm before scaling: 43.59984416408862. Distance: 0.9969082363411768
Total norm for 4 adversaries is: 43.59984416408862. distance: 0.9969082363411768
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0538, Accuracy: 9773/9900 (98.7172%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4433/4869 (91.0454%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4105/4869 (84.3089%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2964, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3707/3968 (93.4224%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3714/3968 (93.5988%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8938, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5082/5526 (91.9653%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4826/5526 (87.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3837, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4461/4748 (93.9553%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4304/4748 (90.6487%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3070, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4377/4818 (90.8468%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4293/4818 (89.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0010, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3890/4161 (93.4871%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3754/4161 (90.2187%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1994, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4202/4587 (91.6067%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4106/4587 (89.5138%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2215, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4680/5224 (89.5865%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4652/5224 (89.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3020, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5129/5422 (94.5961%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5043/5422 (93.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9812, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3871/4130 (93.7288%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3793/4130 (91.8402%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2447, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3985/4196 (94.9714%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3951/4196 (94.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9626, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4538/4830 (93.9545%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4448/4830 (92.0911%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1522, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4656/5086 (91.5454%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4613/5086 (90.7000%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2627, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4311/4741 (90.9302%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4093/4741 (86.3320%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.6309, Accuracy: 4692/10000 (46.9200%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4451/4714 (94.4209%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4428/4714 (93.9330%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0913, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4585/5122 (89.5158%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4113/5122 (80.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.5060, Accuracy: 4606/10000 (46.0600%)
time spent on training: 260.3603310585022
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.1671, Accuracy: 6833/10000 (68.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0144, Accuracy: 9873/9900 (99.7273%)
Done in 403.1012661457062 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 76, 60, 40, 20, 6, 79, 62, 50, 11, 68, 14, 94, 19, 35, 31, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5267/5308 (99.2276%), train_poison_data_count: 415
Global model norm: 43.65882379895057.
Norm before scaling: 43.610700389658525. Distance: 0.9139950067104113
Total norm for 4 adversaries is: 43.610700389658525. distance: 0.9139950067104113
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0163, Accuracy: 9861/9900 (99.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5709/5777 (98.8229%), train_poison_data_count: 455
Global model norm: 43.65882379895057.
Norm before scaling: 43.608981714009474. Distance: 1.0335263646218262
Total norm for 4 adversaries is: 43.608981714009474. distance: 1.0335263646218262
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0058, Accuracy: 9881/9900 (99.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5006/5123 (97.7162%), train_poison_data_count: 403
Global model norm: 43.65882379895057.
Norm before scaling: 43.62219614019622. Distance: 1.1874966872319643
Total norm for 4 adversaries is: 43.62219614019622. distance: 1.1874966872319643
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0301, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5432/5503 (98.7098%), train_poison_data_count: 430
Global model norm: 43.65882379895057.
Norm before scaling: 43.61559432541731. Distance: 1.0897752200221178
Total norm for 4 adversaries is: 43.61559432541731. distance: 1.0897752200221178
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0397, Accuracy: 9808/9900 (99.0707%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3628/3959 (91.6393%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3631/3959 (91.7151%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9751, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3818/4145 (92.1110%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3807/4145 (91.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0354, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5440/5939 (91.5979%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5336/5939 (89.8468%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1372, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4458/4714 (94.5694%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4411/4714 (93.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9402, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4524/4929 (91.7833%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4314/4929 (87.5228%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3218, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3835/4111 (93.2863%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3741/4111 (90.9998%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0547, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4844/5504 (88.0087%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4762/5504 (86.5189%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3145, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4400/4757 (92.4953%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4260/4757 (89.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1743, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4955/5702 (86.8993%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4510/5702 (79.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4130, Accuracy: 4731/10000 (47.3100%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3349/3589 (93.3129%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3327/3589 (92.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0410, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4013/4196 (95.6387%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3951/4196 (94.1611%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9081, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4697/5224 (89.9119%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4662/5224 (89.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2725, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4851/5361 (90.4868%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4634/5361 (86.4391%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1678, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5056/5615 (90.0445%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5017/5615 (89.3500%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4300, Accuracy: 4901/10000 (49.0100%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4170/4537 (91.9110%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4123/4537 (90.8750%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1095, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4453/4732 (94.1040%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4457/4732 (94.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8542, Accuracy: 5787/10000 (57.8700%)
time spent on training: 266.4058675765991
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.1779, Accuracy: 6797/10000 (67.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0122, Accuracy: 9873/9900 (99.7273%)
Done in 409.07579588890076 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 97, 47, 16, 70, 11, 17, 62, 21, 9, 1, 10, 20, 30, 84, 83, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5262/5308 (99.1334%), train_poison_data_count: 415
Global model norm: 43.66979534404329.
Norm before scaling: 43.621667248233706. Distance: 0.8919670634347155
Total norm for 4 adversaries is: 43.621667248233706. distance: 0.8919670634347155
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0289, Accuracy: 9822/9900 (99.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5703/5777 (98.7191%), train_poison_data_count: 455
Global model norm: 43.66979534404329.
Norm before scaling: 43.623591096966244. Distance: 1.1251691055358062
Total norm for 4 adversaries is: 43.623591096966244. distance: 1.1251691055358062
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0233, Accuracy: 9842/9900 (99.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4991/5123 (97.4234%), train_poison_data_count: 403
Global model norm: 43.66979534404329.
Norm before scaling: 43.632473280910574. Distance: 1.1980169281949646
Total norm for 4 adversaries is: 43.632473280910574. distance: 1.1980169281949646
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0346, Accuracy: 9811/9900 (99.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5438/5503 (98.8188%), train_poison_data_count: 430
Global model norm: 43.66979534404329.
Norm before scaling: 43.62477894374509. Distance: 1.0197654835057874
Total norm for 4 adversaries is: 43.62477894374509. distance: 1.0197654835057874
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0302, Accuracy: 9826/9900 (99.2525%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4269/4736 (90.1394%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4202/4736 (88.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1357, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4662/5123 (91.0014%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4225/5123 (82.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4537, Accuracy: 4782/10000 (47.8200%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4880/5353 (91.1638%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4734/5353 (88.4364%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2215, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5410/5871 (92.1478%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5282/5871 (89.9676%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1802, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4919/5702 (86.2680%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   2,  Average loss: 0.0132, Accuracy: 4268/5702 (74.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3134, Accuracy: 4772/10000 (47.7200%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4401/4903 (89.7614%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4310/4903 (87.9054%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2938, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4852/5504 (88.1541%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4707/5504 (85.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2152, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4635/5038 (92.0008%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4573/5038 (90.7701%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1686, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5152/5727 (89.9598%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4995/5727 (87.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2290, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5108/5422 (94.2088%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5049/5422 (93.1206%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0004, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4748/5068 (93.6859%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4649/5068 (91.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2004, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4424/4714 (93.8481%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4386/4714 (93.0420%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0586, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3564/3774 (94.4356%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3553/3774 (94.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9511, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4716/5209 (90.5356%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4594/5209 (88.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4677, Accuracy: 4917/10000 (49.1700%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3269/3552 (92.0327%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3268/3552 (92.0045%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9252, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3661/3910 (93.6317%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3531/3910 (90.3069%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2617, Accuracy: 5215/10000 (52.1500%)
time spent on training: 266.65385246276855
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.1763, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0111, Accuracy: 9878/9900 (99.7778%)
Done in 409.3177616596222 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 82, 6, 27, 91, 61, 74, 8, 42, 9, 15, 85, 19, 89, 48, 96, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5263/5308 (99.1522%), train_poison_data_count: 415
Global model norm: 43.68186938411204.
Norm before scaling: 43.63574646022026. Distance: 0.9711582644232067
Total norm for 4 adversaries is: 43.63574646022026. distance: 0.9711582644232067
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0193, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5707/5777 (98.7883%), train_poison_data_count: 455
Global model norm: 43.68186938411204.
Norm before scaling: 43.63257259893763. Distance: 1.061855681784195
Total norm for 4 adversaries is: 43.63257259893763. distance: 1.061855681784195
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0525, Accuracy: 9781/9900 (98.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 43.68186938411204.
Norm before scaling: 43.644311516329076. Distance: 1.16869997335659
Total norm for 4 adversaries is: 43.644311516329076. distance: 1.16869997335659
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0481, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5445/5503 (98.9460%), train_poison_data_count: 430
Global model norm: 43.68186938411204.
Norm before scaling: 43.635754852672136. Distance: 1.0139476716987412
Total norm for 4 adversaries is: 43.635754852672136. distance: 1.0139476716987412
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0259, Accuracy: 9840/9900 (99.3939%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4892/5298 (92.3367%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4842/5298 (91.3930%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1143, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4540/4929 (92.1079%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4471/4929 (90.7081%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2000, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4207/4587 (91.7157%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4113/4587 (89.6664%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1155, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4047/4527 (89.3970%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4002/4527 (88.4029%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9755, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4076/4485 (90.8807%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3999/4485 (89.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2270, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4410/4797 (91.9325%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4309/4797 (89.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1229, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4468/4889 (91.3888%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4425/4889 (90.5093%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0493, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5341/5907 (90.4181%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5246/5907 (88.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5758, Accuracy: 4701/10000 (47.0100%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5176/5727 (90.3789%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5090/5727 (88.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0397, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5539/6068 (91.2821%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5406/6068 (89.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3380, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6292/6947 (90.5715%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5989/6947 (86.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2414, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4770/5361 (88.9759%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4749/5361 (88.5842%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2746, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4312/4737 (91.0281%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4277/4737 (90.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2539, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4531/4830 (93.8095%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4471/4830 (92.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1144, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4708/5086 (92.5678%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4662/5086 (91.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1795, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4854/5362 (90.5259%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4791/5362 (89.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2576, Accuracy: 5069/10000 (50.6900%)
time spent on training: 273.6382188796997
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.1786, Accuracy: 6806/10000 (68.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0113, Accuracy: 9878/9900 (99.7778%)
Done in 411.7667393684387 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 74, 51, 9, 80, 78, 64, 90, 42, 14, 6, 57, 0, 46, 43, 18, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5264/5308 (99.1711%), train_poison_data_count: 415
Global model norm: 43.6959934519173.
Norm before scaling: 43.64716010190053. Distance: 0.8888868470135389
Total norm for 4 adversaries is: 43.64716010190053. distance: 0.8888868470135389
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0341, Accuracy: 9819/9900 (99.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5708/5777 (98.8056%), train_poison_data_count: 455
Global model norm: 43.6959934519173.
Norm before scaling: 43.64682309190012. Distance: 1.0556790247588208
Total norm for 4 adversaries is: 43.64682309190012. distance: 1.0556790247588208
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0330, Accuracy: 9818/9900 (99.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 43.6959934519173.
Norm before scaling: 43.658449132602755. Distance: 1.1832791656310562
Total norm for 4 adversaries is: 43.658449132602755. distance: 1.1832791656310562
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0117, Accuracy: 9876/9900 (99.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5440/5503 (98.8552%), train_poison_data_count: 430
Global model norm: 43.6959934519173.
Norm before scaling: 43.64955125995355. Distance: 0.9998903512445109
Total norm for 4 adversaries is: 43.64955125995355. distance: 0.9998903512445109
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0515, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4395/4797 (91.6198%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4300/4797 (89.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1825, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3814/4108 (92.8432%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3738/4108 (90.9932%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0268, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5123/5727 (89.4535%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5036/5727 (87.9343%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1548, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4947/5461 (90.5878%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4891/5461 (89.5624%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3483, Accuracy: 4957/10000 (49.5700%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4097/4368 (93.7958%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3990/4368 (91.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0686, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4404/4894 (89.9877%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4319/4894 (88.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2860, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4462/4748 (93.9764%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4279/4748 (90.1222%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1948, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5360/5907 (90.7398%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5274/5907 (89.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.5378, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3972/4196 (94.6616%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3911/4196 (93.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7980, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4599/4929 (93.3049%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4367/4929 (88.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3384, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4609/4956 (92.9984%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4480/4956 (90.3955%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2479, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4985/5454 (91.4008%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4829/5454 (88.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3038, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4870/5399 (90.2019%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4655/5399 (86.2197%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4659, Accuracy: 4752/10000 (47.5200%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4616/4979 (92.7094%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4496/4979 (90.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1814, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3977/4249 (93.5985%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3893/4249 (91.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9884, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4551/5050 (90.1188%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4414/5050 (87.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3834, Accuracy: 4869/10000 (48.6900%)
time spent on training: 259.9809534549713
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.1789, Accuracy: 6800/10000 (68.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0114, Accuracy: 9877/9900 (99.7677%)
Done in 399.4108498096466 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 27, 87, 60, 89, 4, 98, 25, 54, 90, 2, 44, 35, 74, 78, 92, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5267/5308 (99.2276%), train_poison_data_count: 415
Global model norm: 43.708449856603096.
Norm before scaling: 43.659683562183545. Distance: 0.8709797463848806
Total norm for 4 adversaries is: 43.659683562183545. distance: 0.8709797463848806
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0401, Accuracy: 9808/9900 (99.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5705/5777 (98.7537%), train_poison_data_count: 455
Global model norm: 43.708449856603096.
Norm before scaling: 43.66013929973054. Distance: 1.0841254615039386
Total norm for 4 adversaries is: 43.66013929973054. distance: 1.0841254615039386
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0130, Accuracy: 9866/9900 (99.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 43.708449856603096.
Norm before scaling: 43.66945711106334. Distance: 1.1617414132365873
Total norm for 4 adversaries is: 43.66945711106334. distance: 1.1617414132365873
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0821, Accuracy: 9707/9900 (98.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5452/5503 (99.0732%), train_poison_data_count: 430
Global model norm: 43.708449856603096.
Norm before scaling: 43.66203489320699. Distance: 0.9978547032550059
Total norm for 4 adversaries is: 43.66203489320699. distance: 0.9978547032550059
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0108, Accuracy: 9871/9900 (99.7071%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4235/4587 (92.3261%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4149/4587 (90.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1997, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3587/3995 (89.7872%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3507/3995 (87.7847%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1414, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3819/4145 (92.1351%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3781/4145 (91.2183%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.5350, Accuracy: 4843/10000 (48.4300%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4289/4737 (90.5425%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4308/4737 (90.9436%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.5195, Accuracy: 4901/10000 (49.0100%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3740/4028 (92.8500%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3741/4028 (92.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9945, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3916/4161 (94.1120%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3808/4161 (91.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1049, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5717/6419 (89.0637%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 5366/6419 (83.5956%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3494, Accuracy: 4890/10000 (48.9000%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5044/5645 (89.3534%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4735/5645 (83.8795%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3020, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4437/4748 (93.4499%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4306/4748 (90.6908%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1648, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3710/3968 (93.4980%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3672/3968 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8697, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4746/5075 (93.5172%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4588/5075 (90.4039%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1554, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5134/5615 (91.4337%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5042/5615 (89.7952%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2610, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4408/4797 (91.8908%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4279/4797 (89.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2719, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4127/4368 (94.4826%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4045/4368 (92.6053%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1155, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6298/6812 (92.4545%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 6077/6812 (89.2102%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1926, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4708/5068 (92.8966%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4575/5068 (90.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1684, Accuracy: 5168/10000 (51.6800%)
time spent on training: 257.82469391822815
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.1818, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0116, Accuracy: 9878/9900 (99.7778%)
Done in 389.70036935806274 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 95, 8, 67, 7, 31, 90, 40, 65, 34, 20, 2, 82, 51, 83, 86, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5260/5308 (99.0957%), train_poison_data_count: 415
Global model norm: 43.7207016853501.
Norm before scaling: 43.673188710115674. Distance: 0.9263846447027828
Total norm for 4 adversaries is: 43.673188710115674. distance: 0.9263846447027828
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0220, Accuracy: 9851/9900 (99.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5713/5777 (98.8922%), train_poison_data_count: 455
Global model norm: 43.7207016853501.
Norm before scaling: 43.66976599335131. Distance: 1.0334625206967476
Total norm for 4 adversaries is: 43.66976599335131. distance: 1.0334625206967476
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0124, Accuracy: 9869/9900 (99.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5033/5123 (98.2432%), train_poison_data_count: 403
Global model norm: 43.7207016853501.
Norm before scaling: 43.68203985013463. Distance: 1.141660977555925
Total norm for 4 adversaries is: 43.68203985013463. distance: 1.141660977555925
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0413, Accuracy: 9797/9900 (98.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5430/5503 (98.6735%), train_poison_data_count: 430
Global model norm: 43.7207016853501.
Norm before scaling: 43.67486013947984. Distance: 1.0046408967263487
Total norm for 4 adversaries is: 43.67486013947984. distance: 1.0046408967263487
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0379, Accuracy: 9814/9900 (99.1313%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4440/5018 (88.4815%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4409/5018 (87.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2483, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4489/4889 (91.8184%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4359/4889 (89.1593%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0887, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4938/5559 (88.8289%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4779/5559 (85.9687%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2878, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4382/4869 (89.9979%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3960/4869 (81.3309%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.5129, Accuracy: 4671/10000 (46.7100%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4215/4537 (92.9028%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4168/4537 (91.8669%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8983, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4521/4748 (95.2190%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4335/4748 (91.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0767, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5435/5939 (91.5137%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5350/5939 (90.0825%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1704, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4936/5497 (89.7944%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4899/5497 (89.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1652, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4496/4911 (91.5496%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4469/4911 (90.9998%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0512, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4424/4714 (93.8481%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4356/4714 (92.4056%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9982, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3668/3968 (92.4395%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3649/3968 (91.9607%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1001, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4918/5298 (92.8275%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4930/5298 (93.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0506, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3822/4108 (93.0380%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3772/4108 (91.8208%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0996, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3260/3552 (91.7793%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3315/3552 (93.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9319, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3557/3929 (90.5319%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3547/3929 (90.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1015, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6261/6812 (91.9113%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 6147/6812 (90.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2171, Accuracy: 5233/10000 (52.3300%)
time spent on training: 262.1806254386902
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.1808, Accuracy: 6787/10000 (67.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0116, Accuracy: 9878/9900 (99.7778%)
Done in 412.0059654712677 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 93, 42, 22, 44, 28, 6, 70, 27, 35, 41, 8, 24, 26, 60, 31, 12].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5260/5308 (99.0957%), train_poison_data_count: 415
Global model norm: 43.73247975082422.
Norm before scaling: 43.68494745091337. Distance: 0.9167209341862902
Total norm for 4 adversaries is: 43.68494745091337. distance: 0.9167209341862902
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0238, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5693/5777 (98.5460%), train_poison_data_count: 455
Global model norm: 43.73247975082422.
Norm before scaling: 43.68371233804211. Distance: 1.0751680930258316
Total norm for 4 adversaries is: 43.68371233804211. distance: 1.0751680930258316
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0290, Accuracy: 9829/9900 (99.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 43.73247975082422.
Norm before scaling: 43.69487738362831. Distance: 1.2014244744402864
Total norm for 4 adversaries is: 43.69487738362831. distance: 1.2014244744402864
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0405, Accuracy: 9794/9900 (98.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5435/5503 (98.7643%), train_poison_data_count: 430
Global model norm: 43.73247975082422.
Norm before scaling: 43.68702917977701. Distance: 1.0545660443485771
Total norm for 4 adversaries is: 43.68702917977701. distance: 1.0545660443485771
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0363, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/5055 (90.7023%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4544/5055 (89.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2038, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5361/5907 (90.7567%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5199/5907 (88.0142%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.6998, Accuracy: 4568/10000 (45.6800%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5178/5696 (90.9059%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5031/5696 (88.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2826, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4730/5075 (93.2020%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4589/5075 (90.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3324, Accuracy: 4992/10000 (49.9200%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4613/5122 (90.0625%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   2,  Average loss: 0.0111, Accuracy: 4048/5122 (79.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.5236, Accuracy: 4659/10000 (46.5900%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4580/4929 (92.9195%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4418/4929 (89.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2596, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5401/5871 (91.9945%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5280/5871 (89.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2982, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4215/4587 (91.8901%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4132/4587 (90.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1489, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5119/5615 (91.1665%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4961/5615 (88.3526%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3406, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4393/4714 (93.1905%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4337/4714 (92.0025%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2170, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4492/4889 (91.8797%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4407/4889 (90.1411%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1488, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4036/4313 (93.5776%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4009/4313 (92.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8823, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3840/4086 (93.9794%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3804/4086 (93.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0367, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3823/4145 (92.2316%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3789/4145 (91.4113%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1553, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4198/4537 (92.5281%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4135/4537 (91.1395%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9930, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5022/5526 (90.8795%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4867/5526 (88.0746%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2908, Accuracy: 5038/10000 (50.3800%)
time spent on training: 258.8022472858429
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.1863, Accuracy: 6783/10000 (67.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0102, Accuracy: 9882/9900 (99.8182%)
Done in 406.14743423461914 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 90, 84, 56, 79, 2, 19, 51, 77, 98, 18, 60, 16, 88, 63, 69, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5269/5308 (99.2653%), train_poison_data_count: 415
Global model norm: 43.74496064727056.
Norm before scaling: 43.697524332763976. Distance: 0.916596153466038
Total norm for 4 adversaries is: 43.697524332763976. distance: 0.916596153466038
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0350, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5704/5777 (98.7364%), train_poison_data_count: 455
Global model norm: 43.74496064727056.
Norm before scaling: 43.695637263007306. Distance: 1.0710266403888409
Total norm for 4 adversaries is: 43.695637263007306. distance: 1.0710266403888409
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0470, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5022/5123 (98.0285%), train_poison_data_count: 403
Global model norm: 43.74496064727056.
Norm before scaling: 43.706261618760074. Distance: 1.1388804537504695
Total norm for 4 adversaries is: 43.706261618760074. distance: 1.1388804537504695
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0777, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5452/5503 (99.0732%), train_poison_data_count: 430
Global model norm: 43.74496064727056.
Norm before scaling: 43.69713184014127. Distance: 0.9950786130127808
Total norm for 4 adversaries is: 43.69713184014127. distance: 0.9950786130127808
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0289, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4488/4748 (94.5240%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4391/4748 (92.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1169, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4728/5209 (90.7660%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4655/5209 (89.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1742, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4921/5427 (90.6762%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4717/5427 (86.9173%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2757, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3849/4111 (93.6269%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3725/4111 (90.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3362, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3757/3968 (94.6825%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3711/3968 (93.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8245, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4834/5361 (90.1697%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4695/5361 (87.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2367, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3843/4108 (93.5492%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3670/4108 (89.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2614, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4566/5050 (90.4158%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4467/5050 (88.4554%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1385, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3849/4161 (92.5018%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3722/4161 (89.4497%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3004, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3932/4249 (92.5394%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3766/4249 (88.6326%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2543, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3850/4145 (92.8830%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3806/4145 (91.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3190, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4902/5353 (91.5748%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4678/5353 (87.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3738, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4834/5362 (90.1529%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4743/5362 (88.4558%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2887, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3661/3910 (93.6317%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3561/3910 (91.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1051, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4059/4364 (93.0110%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3928/4364 (90.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2541, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5206/5727 (90.9027%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4921/5727 (85.9263%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3395, Accuracy: 4934/10000 (49.3400%)
time spent on training: 266.077654838562
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.1920, Accuracy: 6770/10000 (67.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0116, Accuracy: 9877/9900 (99.7677%)
Done in 402.5728714466095 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 37, 97, 49, 32, 82, 55, 2, 63, 31, 12, 87, 60, 93, 0, 66, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5258/5308 (99.0580%), train_poison_data_count: 415
Global model norm: 43.75605984817989.
Norm before scaling: 43.70941197628378. Distance: 0.9601944632565448
Total norm for 4 adversaries is: 43.70941197628378. distance: 0.9601944632565448
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0445, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5715/5777 (98.9268%), train_poison_data_count: 455
Global model norm: 43.75605984817989.
Norm before scaling: 43.705380427589375. Distance: 1.0086554616993628
Total norm for 4 adversaries is: 43.705380427589375. distance: 1.0086554616993628
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0295, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 43.75605984817989.
Norm before scaling: 43.71673679692796. Distance: 1.1473125215686144
Total norm for 4 adversaries is: 43.71673679692796. distance: 1.1473125215686144
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0464, Accuracy: 9785/9900 (98.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5443/5503 (98.9097%), train_poison_data_count: 430
Global model norm: 43.75605984817989.
Norm before scaling: 43.708603462036656. Distance: 0.988607902974207
Total norm for 4 adversaries is: 43.708603462036656. distance: 0.988607902974207
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0201, Accuracy: 9855/9900 (99.5455%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4362/4741 (92.0059%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4198/4741 (88.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3863, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4215/4736 (88.9992%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4117/4736 (86.9299%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.5014, Accuracy: 4785/10000 (47.8500%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5061/5652 (89.5435%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4925/5652 (87.1373%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1797, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5371/6080 (88.3388%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5318/6080 (87.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.5050, Accuracy: 4751/10000 (47.5100%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4984/5298 (94.0732%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4913/5298 (92.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0053, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4434/4731 (93.7223%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4374/4731 (92.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0196, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3720/3968 (93.7500%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3635/3968 (91.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9612, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3680/3910 (94.1176%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3313/3910 (84.7315%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3915, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4205/4537 (92.6824%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4122/4537 (90.8530%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0220, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5005/5526 (90.5718%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4827/5526 (87.3507%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3727, Accuracy: 4956/10000 (49.5600%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3634/3995 (90.9637%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3538/3995 (88.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3195, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3824/4145 (92.2557%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3804/4145 (91.7732%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1675, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4620/5055 (91.3947%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4492/5055 (88.8625%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2125, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4972/5454 (91.1624%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4845/5454 (88.8339%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3266, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4432/4843 (91.5135%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4433/4843 (91.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0375, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3883/4130 (94.0194%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3808/4130 (92.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0789, Accuracy: 5469/10000 (54.6900%)
time spent on training: 266.9261977672577
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.1906, Accuracy: 6771/10000 (67.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0115, Accuracy: 9875/9900 (99.7475%)
Done in 403.9025375843048 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 59, 98, 38, 39, 7, 3, 32, 76, 35, 66, 73, 20, 74, 49, 62, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5269/5308 (99.2653%), train_poison_data_count: 415
Global model norm: 43.76823280788248.
Norm before scaling: 43.71909902022942. Distance: 0.8828981408633984
Total norm for 4 adversaries is: 43.71909902022942. distance: 0.8828981408633984
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0244, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5717/5777 (98.9614%), train_poison_data_count: 455
Global model norm: 43.76823280788248.
Norm before scaling: 43.71767918854811. Distance: 1.0270230913324223
Total norm for 4 adversaries is: 43.71767918854811. distance: 1.0270230913324223
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0413, Accuracy: 9802/9900 (99.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5023/5123 (98.0480%), train_poison_data_count: 403
Global model norm: 43.76823280788248.
Norm before scaling: 43.72943434043453. Distance: 1.1417258711358265
Total norm for 4 adversaries is: 43.72943434043453. distance: 1.1417258711358265
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0292, Accuracy: 9818/9900 (99.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5435/5503 (98.7643%), train_poison_data_count: 430
Global model norm: 43.76823280788248.
Norm before scaling: 43.723834251362554. Distance: 1.0684937108470172
Total norm for 4 adversaries is: 43.723834251362554. distance: 1.0684937108470172
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0348, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4184/4397 (95.1558%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4223/4397 (96.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7963, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3871/4161 (93.0305%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3766/4161 (90.5071%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3275, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5560/6235 (89.1740%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5468/6235 (87.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.5833, Accuracy: 4725/10000 (47.2500%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3861/4175 (92.4790%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3711/4175 (88.8862%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0797, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4424/4869 (90.8605%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4234/4869 (86.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1637, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4989/5346 (93.3221%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4890/5346 (91.4703%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3069, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5404/6080 (88.8816%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5185/6080 (85.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2422, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3601/3959 (90.9573%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3550/3959 (89.6691%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2454, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5099/5615 (90.8103%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5027/5615 (89.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3488, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4447/4843 (91.8233%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4414/4843 (91.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0719, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4341/4605 (94.2671%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4302/4605 (93.4202%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0385, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4444/4714 (94.2724%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4415/4714 (93.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9629, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4339/4797 (90.4524%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4245/4797 (88.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1863, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5045/5652 (89.2604%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4983/5652 (88.1635%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.4550, Accuracy: 4863/10000 (48.6300%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4851/5504 (88.1359%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4690/5504 (85.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2997, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4699/5075 (92.5911%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4541/5075 (89.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1127, Accuracy: 5330/10000 (53.3000%)
time spent on training: 268.0391571521759
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.1849, Accuracy: 6781/10000 (67.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0121, Accuracy: 9874/9900 (99.7374%)
Done in 407.8652102947235 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 32, 2, 40, 91, 74, 50, 6, 92, 53, 87, 69, 86, 52, 37, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5263/5308 (99.1522%), train_poison_data_count: 415
Global model norm: 43.7800162098638.
Norm before scaling: 43.731283663968036. Distance: 0.921827832324601
Total norm for 4 adversaries is: 43.731283663968036. distance: 0.921827832324601
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0102, Accuracy: 9871/9900 (99.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5715/5777 (98.9268%), train_poison_data_count: 455
Global model norm: 43.7800162098638.
Norm before scaling: 43.729391072306136. Distance: 1.032025363625222
Total norm for 4 adversaries is: 43.729391072306136. distance: 1.032025363625222
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0370, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5019/5123 (97.9699%), train_poison_data_count: 403
Global model norm: 43.7800162098638.
Norm before scaling: 43.74208075647808. Distance: 1.1622163611139251
Total norm for 4 adversaries is: 43.74208075647808. distance: 1.1622163611139251
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1618, Accuracy: 9489/9900 (95.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5432/5503 (98.7098%), train_poison_data_count: 430
Global model norm: 43.7800162098638.
Norm before scaling: 43.734835541519416. Distance: 1.0579531938082145
Total norm for 4 adversaries is: 43.734835541519416. distance: 1.0579531938082145
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0171, Accuracy: 9861/9900 (99.6061%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3884/4175 (93.0299%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3733/4175 (89.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1020, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5369/6080 (88.3059%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5214/6080 (85.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.7177, Accuracy: 4596/10000 (45.9600%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3708/3968 (93.4476%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3689/3968 (92.9688%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8673, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5455/5939 (91.8505%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5273/5939 (88.7860%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2303, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4019/4527 (88.7784%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3908/4527 (86.3265%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2250, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4448/4797 (92.7246%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4355/4797 (90.7859%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0648, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4386/4757 (92.2010%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4302/4757 (90.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1465, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4534/4929 (91.9862%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4391/4929 (89.0850%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.4247, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6330/6812 (92.9243%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 6164/6812 (90.4874%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3116, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5842/6664 (87.6651%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   2,  Average loss: 0.0094, Accuracy: 5478/6664 (82.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3223, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3631/3995 (90.8886%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3513/3995 (87.9349%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2071, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3995/4364 (91.5445%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3952/4364 (90.5591%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0690, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3555/3929 (90.4810%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3547/3929 (90.2774%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1515, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3860/4130 (93.4625%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3731/4130 (90.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2116, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4321/4741 (91.1411%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3918/4741 (82.6408%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.8277, Accuracy: 4392/10000 (43.9200%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5420/5871 (92.3182%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5194/5871 (88.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.5331, Accuracy: 4827/10000 (48.2700%)
time spent on training: 261.43156385421753
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.1897, Accuracy: 6766/10000 (67.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0126, Accuracy: 9875/9900 (99.7475%)
Done in 391.89188742637634 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 30, 23, 34, 24, 2, 67, 21, 72, 83, 87, 29, 15, 42, 37, 70, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5256/5308 (99.0203%), train_poison_data_count: 415
Global model norm: 43.792316309752756.
Norm before scaling: 43.7426305177155. Distance: 0.9006754327507926
Total norm for 4 adversaries is: 43.7426305177155. distance: 0.9006754327507926
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0312, Accuracy: 9827/9900 (99.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5714/5777 (98.9095%), train_poison_data_count: 455
Global model norm: 43.792316309752756.
Norm before scaling: 43.74199424519731. Distance: 1.025730040551054
Total norm for 4 adversaries is: 43.74199424519731. distance: 1.025730040551054
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0199, Accuracy: 9853/9900 (99.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 43.792316309752756.
Norm before scaling: 43.7541878575997. Distance: 1.1857929508538227
Total norm for 4 adversaries is: 43.7541878575997. distance: 1.1857929508538227
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0327, Accuracy: 9826/9900 (99.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5440/5503 (98.8552%), train_poison_data_count: 430
Global model norm: 43.792316309752756.
Norm before scaling: 43.744549046584794. Distance: 1.00995715333683
Total norm for 4 adversaries is: 43.744549046584794. distance: 1.00995715333683
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0123, Accuracy: 9873/9900 (99.7273%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3550/3774 (94.0647%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3537/3774 (93.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0183, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4267/4549 (93.8008%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4132/4549 (90.8332%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2997, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4538/4911 (92.4048%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4442/4911 (90.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2259, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4024/4313 (93.2993%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3977/4313 (92.2096%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9849, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3747/3968 (94.4304%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3675/3968 (92.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8798, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5033/5559 (90.5379%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4873/5559 (87.6597%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1714, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4679/5038 (92.8742%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4594/5038 (91.1870%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1099, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4718/5193 (90.8531%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4500/5193 (86.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.4543, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3252/3552 (91.5541%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3240/3552 (91.2162%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0002, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3619/3995 (90.5882%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3479/3995 (87.0839%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2755, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4448/4732 (93.9983%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4462/4732 (94.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9077, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5557/6068 (91.5788%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5467/6068 (90.0956%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2840, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5300/5907 (89.7241%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5228/5907 (88.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.5537, Accuracy: 4697/10000 (46.9700%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4368/4741 (92.1325%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4066/4741 (85.7625%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 3.2388, Accuracy: 4113/10000 (41.1300%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5407/5871 (92.0967%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5281/5871 (89.9506%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1701, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3831/4111 (93.1890%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3670/4111 (89.2727%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3353, Accuracy: 4996/10000 (49.9600%)
time spent on training: 271.818913936615
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.1895, Accuracy: 6774/10000 (67.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0110, Accuracy: 9880/9900 (99.7980%)
Done in 401.46660447120667 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 51, 97, 20, 54, 5, 34, 74, 14, 77, 50, 56, 10, 16, 39, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5265/5308 (99.1899%), train_poison_data_count: 415
Global model norm: 43.80316524129563.
Norm before scaling: 43.75449614173596. Distance: 0.8920215231839048
Total norm for 4 adversaries is: 43.75449614173596. distance: 0.8920215231839048
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0196, Accuracy: 9849/9900 (99.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5714/5777 (98.9095%), train_poison_data_count: 455
Global model norm: 43.80316524129563.
Norm before scaling: 43.752098163973805. Distance: 1.0188595835717853
Total norm for 4 adversaries is: 43.752098163973805. distance: 1.0188595835717853
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0153, Accuracy: 9868/9900 (99.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5012/5123 (97.8333%), train_poison_data_count: 403
Global model norm: 43.80316524129563.
Norm before scaling: 43.76342706905076. Distance: 1.1446884099450063
Total norm for 4 adversaries is: 43.76342706905076. distance: 1.1446884099450063
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0344, Accuracy: 9817/9900 (99.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5434/5503 (98.7461%), train_poison_data_count: 430
Global model norm: 43.80316524129563.
Norm before scaling: 43.75628024120509. Distance: 1.0079534860808503
Total norm for 4 adversaries is: 43.75628024120509. distance: 1.0079534860808503
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0376, Accuracy: 9816/9900 (99.1515%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4362/4672 (93.3647%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4353/4672 (93.1721%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0014, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3851/4108 (93.7439%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3825/4108 (93.1110%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0340, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4262/4736 (89.9916%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4188/4736 (88.4291%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0039, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4421/4714 (93.7845%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4425/4714 (93.8693%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8126, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5018/5645 (88.8928%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4762/5645 (84.3578%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2116, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4665/4993 (93.4308%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4494/4993 (90.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3752, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4583/4911 (93.3211%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4507/4911 (91.7736%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1932, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4345/4797 (90.5774%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4331/4797 (90.2856%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1616, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3983/4196 (94.9237%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3914/4196 (93.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9125, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4553/5050 (90.1584%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4430/5050 (87.7228%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2358, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4432/4757 (93.1680%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4260/4757 (89.5522%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1181, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4839/5427 (89.1653%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4772/5427 (87.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2583, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4712/5068 (92.9755%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4645/5068 (91.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2308, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4879/5353 (91.1452%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4691/5353 (87.6331%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1867, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3848/4175 (92.1677%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0817, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3795/4111 (92.3133%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3769/4111 (91.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0660, Accuracy: 5388/10000 (53.8800%)
time spent on training: 267.8696527481079
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.1911, Accuracy: 6772/10000 (67.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0109, Accuracy: 9880/9900 (99.7980%)
Done in 398.62711119651794 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 31, 8, 83, 64, 23, 74, 90, 97, 86, 76, 0, 62, 33, 32, 54, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5267/5308 (99.2276%), train_poison_data_count: 415
Global model norm: 43.81503954613858.
Norm before scaling: 43.7651522310238. Distance: 0.8692116354747678
Total norm for 4 adversaries is: 43.7651522310238. distance: 0.8692116354747678
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0345, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5703/5777 (98.7191%), train_poison_data_count: 455
Global model norm: 43.81503954613858.
Norm before scaling: 43.76523032890593. Distance: 1.0435114673629635
Total norm for 4 adversaries is: 43.76523032890593. distance: 1.0435114673629635
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0487, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5021/5123 (98.0090%), train_poison_data_count: 403
Global model norm: 43.81503954613858.
Norm before scaling: 43.77472655049158. Distance: 1.124517231247344
Total norm for 4 adversaries is: 43.77472655049158. distance: 1.124517231247344
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0513, Accuracy: 9780/9900 (98.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5415/5503 (98.4009%), train_poison_data_count: 430
Global model norm: 43.81503954613858.
Norm before scaling: 43.76990479118829. Distance: 1.0883753465446218
Total norm for 4 adversaries is: 43.76990479118829. distance: 1.0883753465446218
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0148, Accuracy: 9864/9900 (99.6364%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4265/4537 (94.0048%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4181/4537 (92.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1786, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4474/4889 (91.5116%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4503/4889 (92.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1601, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3297/3552 (92.8209%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3331/3552 (93.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8835, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4441/4894 (90.7438%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4288/4894 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1063, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4275/4549 (93.9767%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3949/4549 (86.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3390, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4416/4797 (92.0575%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4343/4797 (90.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3774, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4503/4748 (94.8399%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4349/4748 (91.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0667, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4248/4736 (89.6959%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4182/4736 (88.3024%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2326, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3609/3929 (91.8554%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3522/3929 (89.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0494, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3620/3959 (91.4372%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3619/3959 (91.4120%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0658, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4923/5454 (90.2640%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4778/5454 (87.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1602, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4862/5504 (88.3358%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4628/5504 (84.0843%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3433, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4405/4818 (91.4280%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4247/4818 (88.1486%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3092, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5351/6080 (88.0099%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5327/6080 (87.6151%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2856, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5075/5645 (89.9026%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4821/5645 (85.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3123, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4408/4869 (90.5319%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4021/4869 (82.5837%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.6829, Accuracy: 4641/10000 (46.4100%)
time spent on training: 265.16801285743713
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.1876, Accuracy: 6780/10000 (67.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0109, Accuracy: 9879/9900 (99.7879%)
Done in 395.9792764186859 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 93, 25, 55, 21, 42, 88, 17, 23, 2, 68, 12, 52, 5, 44, 72, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5270/5308 (99.2841%), train_poison_data_count: 415
Global model norm: 43.826721234203966.
Norm before scaling: 43.77678588500845. Distance: 0.8594259073611467
Total norm for 4 adversaries is: 43.77678588500845. distance: 0.8594259073611467
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0240, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5697/5777 (98.6152%), train_poison_data_count: 455
Global model norm: 43.826721234203966.
Norm before scaling: 43.778479848569006. Distance: 1.0988679218916955
Total norm for 4 adversaries is: 43.778479848569006. distance: 1.0988679218916955
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0223, Accuracy: 9849/9900 (99.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5035/5123 (98.2823%), train_poison_data_count: 403
Global model norm: 43.826721234203966.
Norm before scaling: 43.784627758263376. Distance: 1.084853420200733
Total norm for 4 adversaries is: 43.784627758263376. distance: 1.084853420200733
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0327, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5448/5503 (99.0005%), train_poison_data_count: 430
Global model norm: 43.826721234203966.
Norm before scaling: 43.77796260409597. Distance: 0.9473887569980401
Total norm for 4 adversaries is: 43.77796260409597. distance: 0.9473887569980401
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0400, Accuracy: 9807/9900 (99.0606%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4584/5055 (90.6825%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4521/5055 (89.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1650, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5756/6419 (89.6713%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5476/6419 (85.3092%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.4282, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4427/4731 (93.5743%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4339/4731 (91.7142%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0421, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4606/5038 (91.4252%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4607/5038 (91.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0522, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5309/5907 (89.8764%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5278/5907 (89.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.4264, Accuracy: 4913/10000 (49.1300%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4876/5362 (90.9362%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4768/5362 (88.9220%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2145, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4400/4903 (89.7410%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4302/4903 (87.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2184, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4262/4549 (93.6909%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4001/4549 (87.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2074, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3722/3968 (93.8004%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3700/3968 (93.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9260, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3354/3589 (93.4522%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3102/3589 (86.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1247, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5078/5526 (91.8929%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4768/5526 (86.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2944, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3881/4130 (93.9709%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3834/4130 (92.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9585, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4651/4993 (93.1504%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4544/4993 (91.0074%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3378, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4729/5075 (93.1823%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4433/5075 (87.3498%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3840, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4708/5193 (90.6605%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4452/5193 (85.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.5250, Accuracy: 4862/10000 (48.6200%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4692/5035 (93.1877%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4662/5035 (92.5919%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1382, Accuracy: 5300/10000 (53.0000%)
time spent on training: 279.75214433670044
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.1899, Accuracy: 6772/10000 (67.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0112, Accuracy: 9880/9900 (99.7980%)
Done in 410.5395438671112 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 32, 54, 57, 25, 67, 38, 0, 98, 43, 94, 42, 26, 70, 90, 56, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5279/5308 (99.4537%), train_poison_data_count: 415
Global model norm: 43.83919479187546.
Norm before scaling: 43.78890011678188. Distance: 0.8536112925950694
Total norm for 4 adversaries is: 43.78890011678188. distance: 0.8536112925950694
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0209, Accuracy: 9850/9900 (99.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5714/5777 (98.9095%), train_poison_data_count: 455
Global model norm: 43.83919479187546.
Norm before scaling: 43.78811676610305. Distance: 1.0242640528200198
Total norm for 4 adversaries is: 43.78811676610305. distance: 1.0242640528200198
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0288, Accuracy: 9836/9900 (99.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5035/5123 (98.2823%), train_poison_data_count: 403
Global model norm: 43.83919479187546.
Norm before scaling: 43.797730659675736. Distance: 1.141388363342296
Total norm for 4 adversaries is: 43.797730659675736. distance: 1.141388363342296
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0301, Accuracy: 9824/9900 (99.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5441/5503 (98.8733%), train_poison_data_count: 430
Global model norm: 43.83919479187546.
Norm before scaling: 43.79256857618653. Distance: 1.0126045502736916
Total norm for 4 adversaries is: 43.79256857618653. distance: 1.0126045502736916
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0274, Accuracy: 9841/9900 (99.4040%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5466/6080 (89.9013%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5235/6080 (86.1020%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4716, Accuracy: 4839/10000 (48.3900%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5074/5645 (89.8849%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4847/5645 (85.8636%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3448, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4615/4956 (93.1195%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4484/4956 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3691, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5739/6419 (89.4064%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5453/6419 (84.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4507, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5043/5559 (90.7178%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4817/5559 (86.6523%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1867, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5661/6235 (90.7939%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5464/6235 (87.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3636, Accuracy: 4948/10000 (49.4800%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4971/5454 (91.1441%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4765/5454 (87.3671%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1204, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3906/4161 (93.8717%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3736/4161 (89.7861%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1225, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4573/4979 (91.8458%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4462/4979 (89.6164%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1847, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4704/5224 (90.0459%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4687/5224 (89.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1604, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5387/5907 (91.1969%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5336/5907 (90.3335%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.6496, Accuracy: 4677/10000 (46.7700%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3873/4086 (94.7871%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3812/4086 (93.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9620, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5401/5871 (91.9945%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5278/5871 (89.8995%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3103, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4482/4748 (94.3976%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4300/4748 (90.5644%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1756, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4888/5427 (90.0682%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4820/5427 (88.8152%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2875, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4006/4196 (95.4719%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3964/4196 (94.4709%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9064, Accuracy: 5694/10000 (56.9400%)
time spent on training: 269.6021611690521
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.1902, Accuracy: 6753/10000 (67.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0103, Accuracy: 9883/9900 (99.8283%)
Done in 399.4067339897156 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 12, 96, 75, 78, 54, 4, 5, 33, 35, 83, 57, 40, 6, 38, 18, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5256/5308 (99.0203%), train_poison_data_count: 415
Global model norm: 43.85190559170077.
Norm before scaling: 43.803542849990315. Distance: 0.951827463677535
Total norm for 4 adversaries is: 43.803542849990315. distance: 0.951827463677535
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0218, Accuracy: 9845/9900 (99.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5727/5777 (99.1345%), train_poison_data_count: 455
Global model norm: 43.85190559170077.
Norm before scaling: 43.800176304849934. Distance: 1.0318158071396664
Total norm for 4 adversaries is: 43.800176304849934. distance: 1.0318158071396664
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0140, Accuracy: 9866/9900 (99.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5022/5123 (98.0285%), train_poison_data_count: 403
Global model norm: 43.85190559170077.
Norm before scaling: 43.81205002666575. Distance: 1.1339964894571748
Total norm for 4 adversaries is: 43.81205002666575. distance: 1.1339964894571748
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0295, Accuracy: 9827/9900 (99.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5455/5503 (99.1277%), train_poison_data_count: 430
Global model norm: 43.85190559170077.
Norm before scaling: 43.80350244183534. Distance: 0.9615953566151092
Total norm for 4 adversaries is: 43.80350244183534. distance: 0.9615953566151092
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0483, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5008/5526 (90.6261%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4728/5526 (85.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4088, Accuracy: 4968/10000 (49.6800%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4716/5086 (92.7251%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4637/5086 (91.1718%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1142, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4365/4672 (93.4289%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4299/4672 (92.0163%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0147, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4073/4368 (93.2463%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4010/4368 (91.8040%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2913, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5048/5645 (89.4243%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4733/5645 (83.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.5812, Accuracy: 4696/10000 (46.9600%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3761/4028 (93.3714%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3719/4028 (92.3287%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9701, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4679/4993 (93.7112%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4566/4993 (91.4480%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2345, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4411/4818 (91.5525%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4295/4818 (89.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0969, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5069/5615 (90.2760%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4915/5615 (87.5334%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.5190, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3266/3552 (91.9482%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3308/3552 (93.1306%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9864, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4581/4956 (92.4334%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4507/4956 (90.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1446, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5483/5939 (92.3219%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5386/5939 (90.6887%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2203, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4559/4929 (92.4934%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4440/4929 (90.0791%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3420, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5608/6235 (89.9439%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5429/6235 (87.0730%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2953, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3965/4249 (93.3161%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3884/4249 (91.4097%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0060, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4154/4485 (92.6198%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3753/4485 (83.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4469, Accuracy: 4685/10000 (46.8500%)
time spent on training: 272.5924813747406
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.1939, Accuracy: 6750/10000 (67.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0105, Accuracy: 9883/9900 (99.8283%)
Done in 403.7449495792389 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 65, 4, 57, 0, 72, 62, 24, 77, 78, 41, 19, 61, 52, 59, 2, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5268/5308 (99.2464%), train_poison_data_count: 415
Global model norm: 43.8641034367796.
Norm before scaling: 43.81328012857517. Distance: 0.8636628425225895
Total norm for 4 adversaries is: 43.81328012857517. distance: 0.8636628425225895
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0365, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5721/5777 (99.0306%), train_poison_data_count: 455
Global model norm: 43.8641034367796.
Norm before scaling: 43.81197201224298. Distance: 1.0064961908214365
Total norm for 4 adversaries is: 43.81197201224298. distance: 1.0064961908214365
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0419, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5028/5123 (98.1456%), train_poison_data_count: 403
Global model norm: 43.8641034367796.
Norm before scaling: 43.82446090967278. Distance: 1.1296952602177974
Total norm for 4 adversaries is: 43.82446090967278. distance: 1.1296952602177974
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0223, Accuracy: 9839/9900 (99.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5456/5503 (99.1459%), train_poison_data_count: 430
Global model norm: 43.8641034367796.
Norm before scaling: 43.8152652145381. Distance: 0.9791685807770762
Total norm for 4 adversaries is: 43.8152652145381. distance: 0.9791685807770762
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0255, Accuracy: 9842/9900 (99.4141%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4988/5497 (90.7404%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4830/5497 (87.8661%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2478, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3800/4028 (94.3396%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3745/4028 (92.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0372, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4637/4956 (93.5634%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4474/4956 (90.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2789, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4933/5454 (90.4474%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4750/5454 (87.0920%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3976, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4734/5193 (91.1612%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4409/5193 (84.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.5381, Accuracy: 4775/10000 (47.7500%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4913/5504 (89.2624%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4782/5504 (86.8823%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3071, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4021/4313 (93.2298%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3994/4313 (92.6038%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0481, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4537/5050 (89.8416%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4426/5050 (87.6436%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1876, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4115/4368 (94.2079%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4016/4368 (91.9414%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0281, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4421/4714 (93.7845%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4312/4714 (91.4722%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1845, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4788/5361 (89.3117%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4770/5361 (88.9759%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2195, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4080/4485 (90.9699%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3626/4485 (80.8473%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4742, Accuracy: 4710/10000 (47.1000%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3875/4130 (93.8257%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3799/4130 (91.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9844, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4166/4397 (94.7464%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4145/4397 (94.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0007, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3716/3968 (93.6492%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3702/3968 (93.2964%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8496, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4346/4605 (94.3757%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4279/4605 (92.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9467, Accuracy: 5584/10000 (55.8400%)
time spent on training: 265.67476534843445
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.1941, Accuracy: 6747/10000 (67.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0120, Accuracy: 9881/9900 (99.8081%)
Done in 395.7711043357849 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 19, 85, 76, 57, 46, 62, 22, 25, 89, 95, 48, 51, 45, 96, 41, 17].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5269/5308 (99.2653%), train_poison_data_count: 415
Global model norm: 43.87510572458772.
Norm before scaling: 43.826257480265895. Distance: 0.9089748262396469
Total norm for 4 adversaries is: 43.826257480265895. distance: 0.9089748262396469
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0337, Accuracy: 9823/9900 (99.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5718/5777 (98.9787%), train_poison_data_count: 455
Global model norm: 43.87510572458772.
Norm before scaling: 43.82300270869455. Distance: 1.0012384732615154
Total norm for 4 adversaries is: 43.82300270869455. distance: 1.0012384732615154
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0217, Accuracy: 9847/9900 (99.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5026/5123 (98.1066%), train_poison_data_count: 403
Global model norm: 43.87510572458772.
Norm before scaling: 43.833299605401315. Distance: 1.1032341252024847
Total norm for 4 adversaries is: 43.833299605401315. distance: 1.1032341252024847
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0410, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5447/5503 (98.9824%), train_poison_data_count: 430
Global model norm: 43.87510572458772.
Norm before scaling: 43.82541630444385. Distance: 0.9783951919361106
Total norm for 4 adversaries is: 43.82541630444385. distance: 0.9783951919361106
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0277, Accuracy: 9839/9900 (99.3838%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4829/5361 (90.0765%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4695/5361 (87.5769%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2967, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6253/6947 (90.0101%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6027/6947 (86.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5275, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3602/3959 (90.9826%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3630/3959 (91.6898%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1507, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4607/4956 (92.9580%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4516/4956 (91.1219%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3288, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4782/5399 (88.5720%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4594/5399 (85.0898%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4752, Accuracy: 4751/10000 (47.5100%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4844/5504 (88.0087%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4696/5504 (85.3198%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3617, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5243/5696 (92.0471%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5012/5696 (87.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2534, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5732/6419 (89.2974%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5516/6419 (85.9324%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3802, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4363/4737 (92.1047%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4262/4737 (89.9726%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.5155, Accuracy: 4817/10000 (48.1700%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4529/5018 (90.2551%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4354/5018 (86.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4110, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4553/4830 (94.2650%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4449/4830 (92.1118%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1769, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3855/4108 (93.8413%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3765/4108 (91.6504%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0866, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4901/5489 (89.2877%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4835/5489 (88.0853%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4042, Accuracy: 4882/10000 (48.8200%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4704/5086 (92.4892%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4665/5086 (91.7224%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9828, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4393/4714 (93.1905%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4325/4714 (91.7480%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1067, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4394/4903 (89.6186%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4291/4903 (87.5178%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.8894, Accuracy: 4461/10000 (44.6100%)
time spent on training: 272.7739715576172
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.1976, Accuracy: 6742/10000 (67.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0108, Accuracy: 9881/9900 (99.8081%)
Done in 402.3806142807007 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 2, 27, 99, 74, 8, 3, 67, 72, 7, 24, 17, 10, 20, 59, 16, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5276/5308 (99.3971%), train_poison_data_count: 415
Global model norm: 43.887088512294106.
Norm before scaling: 43.835485678699854. Distance: 0.8382117805243835
Total norm for 4 adversaries is: 43.835485678699854. distance: 0.8382117805243835
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0227, Accuracy: 9842/9900 (99.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5725/5777 (99.0999%), train_poison_data_count: 455
Global model norm: 43.887088512294106.
Norm before scaling: 43.833044788489055. Distance: 0.9886883285521882
Total norm for 4 adversaries is: 43.833044788489055. distance: 0.9886883285521882
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0206, Accuracy: 9843/9900 (99.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5034/5123 (98.2627%), train_poison_data_count: 403
Global model norm: 43.887088512294106.
Norm before scaling: 43.84540100686873. Distance: 1.1175282632210697
Total norm for 4 adversaries is: 43.84540100686873. distance: 1.1175282632210697
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0400, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5463/5503 (99.2731%), train_poison_data_count: 430
Global model norm: 43.887088512294106.
Norm before scaling: 43.8367067690031. Distance: 0.9249109611959639
Total norm for 4 adversaries is: 43.8367067690031. distance: 0.9249109611959639
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0358, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3731/3968 (94.0272%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3694/3968 (93.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9089, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4240/4587 (92.4351%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4197/4587 (91.4977%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1107, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4371/4851 (90.1051%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4252/4851 (87.6520%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2157, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4463/4797 (93.0373%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4321/4797 (90.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3470, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4501/4889 (92.0638%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4306/4889 (88.0753%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1920, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5009/5346 (93.6962%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4887/5346 (91.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2620, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4980/5559 (89.5845%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4862/5559 (87.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.4814, Accuracy: 4846/10000 (48.4600%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4660/5193 (89.7362%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4443/5193 (85.5575%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.5515, Accuracy: 4825/10000 (48.2500%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4462/4869 (91.6410%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4181/4869 (85.8698%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2914, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4012/4313 (93.0211%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3980/4313 (92.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9724, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4444/4903 (90.6384%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4375/4903 (89.2311%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.4484, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4787/5068 (94.4554%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4552/5068 (89.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.4229, Accuracy: 4932/10000 (49.3200%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4449/4714 (94.3784%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4394/4714 (93.2117%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0690, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4180/4397 (95.0648%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4192/4397 (95.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8331, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4914/5353 (91.7990%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4674/5353 (87.3155%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.5011, Accuracy: 4784/10000 (47.8400%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4434/4818 (92.0299%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4228/4818 (87.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1691, Accuracy: 5242/10000 (52.4200%)
time spent on training: 267.3945252895355
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.2007, Accuracy: 6730/10000 (67.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0106, Accuracy: 9881/9900 (99.8081%)
Done in 398.6445233821869 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 44, 6, 40, 60, 96, 93, 0, 47, 5, 94, 78, 63, 23, 45, 26, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5271/5308 (99.3029%), train_poison_data_count: 415
Global model norm: 43.89862728536124.
Norm before scaling: 43.84749878173284. Distance: 0.8496130581479971
Total norm for 4 adversaries is: 43.84749878173284. distance: 0.8496130581479971
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0400, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5720/5777 (99.0133%), train_poison_data_count: 455
Global model norm: 43.89862728536124.
Norm before scaling: 43.846381001778525. Distance: 1.00047434047297
Total norm for 4 adversaries is: 43.846381001778525. distance: 1.00047434047297
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0211, Accuracy: 9856/9900 (99.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5023/5123 (98.0480%), train_poison_data_count: 403
Global model norm: 43.89862728536124.
Norm before scaling: 43.858208815098116. Distance: 1.1511135452865415
Total norm for 4 adversaries is: 43.858208815098116. distance: 1.1511135452865415
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0216, Accuracy: 9847/9900 (99.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5449/5503 (99.0187%), train_poison_data_count: 430
Global model norm: 43.89862728536124.
Norm before scaling: 43.849341734030766. Distance: 0.9601012522230474
Total norm for 4 adversaries is: 43.849341734030766. distance: 0.9601012522230474
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0302, Accuracy: 9834/9900 (99.3333%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4707/5075 (92.7488%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4644/5075 (91.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2251, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4533/4929 (91.9659%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4373/4929 (88.7198%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2820, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5467/5939 (92.0525%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5377/5939 (90.5371%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2164, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3838/4145 (92.5935%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3831/4145 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1568, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4690/5086 (92.2139%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4619/5086 (90.8179%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1902, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4642/5055 (91.8299%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4496/5055 (88.9416%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2608, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4962/5454 (90.9791%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4766/5454 (87.3854%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2387, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4678/5123 (91.3137%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4044/5123 (78.9381%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3953, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4669/4993 (93.5109%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4532/4993 (90.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2648, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4730/5224 (90.5436%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4666/5224 (89.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2356, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4125/4368 (94.4368%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4121/4368 (94.3452%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0577, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3682/3910 (94.1688%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3510/3910 (89.7698%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1647, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4305/4549 (94.6362%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3960/4549 (87.0521%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.4555, Accuracy: 4824/10000 (48.2400%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4930/5489 (89.8160%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4957/5489 (90.3079%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1986, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3847/4086 (94.1508%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3813/4086 (93.3186%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0637, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4714/5193 (90.7760%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4487/5193 (86.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3632, Accuracy: 5008/10000 (50.0800%)
time spent on training: 255.26594948768616
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.2026, Accuracy: 6731/10000 (67.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0097, Accuracy: 9882/9900 (99.8182%)
Done in 385.7249343395233 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 27, 56, 90, 39, 16, 69, 88, 23, 98, 84, 48, 3, 35, 81, 55, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5281/5308 (99.4913%), train_poison_data_count: 415
Global model norm: 43.91072180296986.
Norm before scaling: 43.85891019971027. Distance: 0.8365217288558935
Total norm for 4 adversaries is: 43.85891019971027. distance: 0.8365217288558935
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0314, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5726/5777 (99.1172%), train_poison_data_count: 455
Global model norm: 43.91072180296986.
Norm before scaling: 43.85776487737448. Distance: 0.9823520097101639
Total norm for 4 adversaries is: 43.85776487737448. distance: 0.9823520097101639
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0157, Accuracy: 9863/9900 (99.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5031/5123 (98.2042%), train_poison_data_count: 403
Global model norm: 43.91072180296986.
Norm before scaling: 43.86832214138124. Distance: 1.0944919794240986
Total norm for 4 adversaries is: 43.86832214138124. distance: 1.0944919794240986
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0424, Accuracy: 9795/9900 (98.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5448/5503 (99.0005%), train_poison_data_count: 430
Global model norm: 43.91072180296986.
Norm before scaling: 43.86085982301376. Distance: 0.9711793157516335
Total norm for 4 adversaries is: 43.86085982301376. distance: 0.9711793157516335
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0145, Accuracy: 9865/9900 (99.6465%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4230/4587 (92.2171%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4144/4587 (90.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2888, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4944/5427 (91.1001%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4746/5427 (87.4516%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3028, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4472/4748 (94.1870%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4344/4748 (91.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0694, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3863/4175 (92.5269%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3652/4175 (87.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1743, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4919/5353 (91.8924%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4701/5353 (87.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.5055, Accuracy: 4768/10000 (47.6800%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4026/4364 (92.2548%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3796/4364 (86.9844%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3705, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4950/5362 (92.3163%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4805/5362 (89.6121%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4292, Accuracy: 4971/10000 (49.7100%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4285/4549 (94.1965%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3861/4549 (84.8758%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2581, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3907/4161 (93.8957%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3810/4161 (91.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2005, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4742/5209 (91.0347%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4614/5209 (88.5775%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4517, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4554/4830 (94.2857%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4462/4830 (92.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2292, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4999/5346 (93.5092%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4943/5346 (92.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2056, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5162/5615 (91.9323%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5041/5615 (89.7774%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2051, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4709/5035 (93.5253%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4601/5035 (91.3803%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3318, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4469/4731 (94.4621%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4352/4731 (91.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0511, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4985/5702 (87.4255%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0125, Accuracy: 4371/5702 (76.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4941, Accuracy: 4666/10000 (46.6600%)
time spent on training: 268.82940793037415
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.2044, Accuracy: 6728/10000 (67.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0093, Accuracy: 9882/9900 (99.8182%)
Done in 399.3588285446167 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 97, 21, 14, 37, 95, 9, 28, 17, 73, 23, 0, 68, 19, 50, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5278/5308 (99.4348%), train_poison_data_count: 415
Global model norm: 43.92291026216771.
Norm before scaling: 43.8703756911341. Distance: 0.80217985505465
Total norm for 4 adversaries is: 43.8703756911341. distance: 0.80217985505465
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0188, Accuracy: 9851/9900 (99.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5730/5777 (99.1864%), train_poison_data_count: 455
Global model norm: 43.92291026216771.
Norm before scaling: 43.87083202246967. Distance: 0.9980965021564209
Total norm for 4 adversaries is: 43.87083202246967. distance: 0.9980965021564209
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0129, Accuracy: 9865/9900 (99.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5029/5123 (98.1651%), train_poison_data_count: 403
Global model norm: 43.92291026216771.
Norm before scaling: 43.88159616994208. Distance: 1.1101429390159616
Total norm for 4 adversaries is: 43.88159616994208. distance: 1.1101429390159616
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0405, Accuracy: 9799/9900 (98.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5452/5503 (99.0732%), train_poison_data_count: 430
Global model norm: 43.92291026216771.
Norm before scaling: 43.87380640737563. Distance: 0.9762727536469494
Total norm for 4 adversaries is: 43.87380640737563. distance: 0.9762727536469494
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0257, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4266/4736 (90.0760%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4201/4736 (88.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0873, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4642/5038 (92.1397%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4524/5038 (89.7975%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1170, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4000/4196 (95.3289%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3970/4196 (94.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9613, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4350/4741 (91.7528%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4161/4741 (87.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.5251, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4449/5018 (88.6608%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4324/5018 (86.1698%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2233, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5188/5727 (90.5884%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4977/5727 (86.9041%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3057, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4607/5122 (89.9453%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   2,  Average loss: 0.0102, Accuracy: 4169/5122 (81.3940%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.5027, Accuracy: 4708/10000 (47.0800%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4450/4903 (90.7608%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4360/4903 (88.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1732, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4340/4605 (94.2454%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4305/4605 (93.4853%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0558, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4268/4549 (93.8228%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3767/4549 (82.8094%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3424, Accuracy: 4894/10000 (48.9400%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5008/5454 (91.8225%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4846/5454 (88.8522%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.4746, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3347/3589 (93.2572%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3119/3589 (86.9044%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1884, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4820/5361 (89.9086%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4682/5361 (87.3345%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3631, Accuracy: 4981/10000 (49.8100%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4412/4757 (92.7475%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4318/4757 (90.7715%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1118, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4447/4731 (93.9970%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4367/4731 (92.3061%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1669, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5598/6235 (89.7835%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5429/6235 (87.0730%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.4433, Accuracy: 4852/10000 (48.5200%)
time spent on training: 272.5707516670227
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.2043, Accuracy: 6733/10000 (67.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0083, Accuracy: 9884/9900 (99.8384%)
Done in 403.5778181552887 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 89, 53, 72, 87, 21, 48, 39, 95, 70, 57, 16, 55, 17, 7, 74, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5270/5308 (99.2841%), train_poison_data_count: 415
Global model norm: 43.93527315880786.
Norm before scaling: 43.885391787070645. Distance: 0.8874495263589456
Total norm for 4 adversaries is: 43.885391787070645. distance: 0.8874495263589456
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0259, Accuracy: 9841/9900 (99.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5729/5777 (99.1691%), train_poison_data_count: 455
Global model norm: 43.93527315880786.
Norm before scaling: 43.88149046099192. Distance: 0.9712411782393074
Total norm for 4 adversaries is: 43.88149046099192. distance: 0.9712411782393074
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0264, Accuracy: 9836/9900 (99.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 43.93527315880786.
Norm before scaling: 43.896666825608044. Distance: 1.204461729908843
Total norm for 4 adversaries is: 43.896666825608044. distance: 1.204461729908843
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0452, Accuracy: 9785/9900 (98.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5446/5503 (98.9642%), train_poison_data_count: 430
Global model norm: 43.93527315880786.
Norm before scaling: 43.88516230690192. Distance: 0.9473448415451393
Total norm for 4 adversaries is: 43.88516230690192. distance: 0.9473448415451393
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0491, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4356/4737 (91.9569%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4363/4737 (92.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2155, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5844/6664 (87.6951%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5592/6664 (83.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2856, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4702/5193 (90.5450%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4505/5193 (86.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3559, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3645/3995 (91.2390%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3534/3995 (88.4606%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3784, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4669/5038 (92.6757%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4580/5038 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1309, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4575/4830 (94.7205%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4492/4830 (93.0021%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1601, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3862/4175 (92.5030%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3671/4175 (87.9281%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2173, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4512/5018 (89.9163%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4392/5018 (87.5249%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2017, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5469/5871 (93.1528%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5259/5871 (89.5759%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.5093, Accuracy: 4934/10000 (49.3400%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4624/4956 (93.3010%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4481/4956 (90.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4461, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4930/5353 (92.0979%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4731/5353 (88.3803%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1298, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4448/4731 (94.0182%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4388/4731 (92.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0544, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4398/4903 (89.7002%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4360/4903 (88.9251%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2130, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4408/4869 (90.5319%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3906/4869 (80.2218%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.5606, Accuracy: 4759/10000 (47.5900%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4425/4797 (92.2452%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4335/4797 (90.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.2167, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3669/3910 (93.8363%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   2,  Average loss: 0.0099, Accuracy: 3191/3910 (81.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4950, Accuracy: 4793/10000 (47.9300%)
time spent on training: 267.63179206848145
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.2021, Accuracy: 6740/10000 (67.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0079, Accuracy: 9886/9900 (99.8586%)
Done in 397.81068301200867 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 77, 41, 51, 7, 32, 44, 67, 5, 85, 49, 55, 64, 35, 95, 4, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5257/5308 (99.0392%), train_poison_data_count: 415
Global model norm: 43.94787700850506.
Norm before scaling: 43.897616477684466. Distance: 0.8953851347481111
Total norm for 4 adversaries is: 43.897616477684466. distance: 0.8953851347481111
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0196, Accuracy: 9847/9900 (99.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5725/5777 (99.0999%), train_poison_data_count: 455
Global model norm: 43.94787700850506.
Norm before scaling: 43.895333384868486. Distance: 0.9991415034209806
Total norm for 4 adversaries is: 43.895333384868486. distance: 0.9991415034209806
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0348, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5026/5123 (98.1066%), train_poison_data_count: 403
Global model norm: 43.94787700850506.
Norm before scaling: 43.906224977750874. Distance: 1.1229848297229046
Total norm for 4 adversaries is: 43.906224977750874. distance: 1.1229848297229046
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0536, Accuracy: 9773/9900 (98.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5443/5503 (98.9097%), train_poison_data_count: 430
Global model norm: 43.94787700850506.
Norm before scaling: 43.898548034431045. Distance: 0.9611537969043031
Total norm for 4 adversaries is: 43.898548034431045. distance: 0.9611537969043031
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0194, Accuracy: 9857/9900 (99.5657%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4524/5050 (89.5842%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4454/5050 (88.1980%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1677, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4415/4714 (93.6572%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4348/4714 (92.2359%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3076, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3827/4108 (93.1597%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3678/4108 (89.5326%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1429, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4392/4869 (90.2033%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4248/4869 (87.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3734, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5320/6080 (87.5000%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5255/6080 (86.4309%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.4868, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4764/5075 (93.8719%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4609/5075 (90.8177%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0779, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5057/5559 (90.9696%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4853/5559 (87.2999%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2797, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4648/4993 (93.0903%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4572/4993 (91.5682%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1436, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6202/6947 (89.2759%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5951/6947 (85.6629%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3296, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5047/5652 (89.2958%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4879/5652 (86.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.6331, Accuracy: 4549/10000 (45.4900%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4428/4731 (93.5954%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4377/4731 (92.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0257, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4395/4894 (89.8038%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4209/4894 (86.0033%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3555, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5102/5615 (90.8638%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5079/5615 (90.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1233, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4530/5018 (90.2750%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4412/5018 (87.9235%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3081, Accuracy: 4911/10000 (49.1100%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3745/4028 (92.9742%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3705/4028 (91.9811%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0008, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4647/5123 (90.7086%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4320/5123 (84.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3525, Accuracy: 4925/10000 (49.2500%)
time spent on training: 263.73194789886475
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.1969, Accuracy: 6753/10000 (67.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0083, Accuracy: 9882/9900 (99.8182%)
Done in 394.41500997543335 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 17, 70, 42, 31, 21, 82, 84, 28, 86, 67, 5, 85, 95, 74, 38, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5264/5308 (99.1711%), train_poison_data_count: 415
Global model norm: 43.96091181468061.
Norm before scaling: 43.90869655105353. Distance: 0.8392537018140617
Total norm for 4 adversaries is: 43.90869655105353. distance: 0.8392537018140617
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0344, Accuracy: 9814/9900 (99.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5719/5777 (98.9960%), train_poison_data_count: 455
Global model norm: 43.96091181468061.
Norm before scaling: 43.90774852869793. Distance: 1.008946335415523
Total norm for 4 adversaries is: 43.90774852869793. distance: 1.008946335415523
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0234, Accuracy: 9844/9900 (99.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5037/5123 (98.3213%), train_poison_data_count: 403
Global model norm: 43.96091181468061.
Norm before scaling: 43.9193694255984. Distance: 1.0889960379550343
Total norm for 4 adversaries is: 43.9193694255984. distance: 1.0889960379550343
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0091, Accuracy: 9878/9900 (99.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5449/5503 (99.0187%), train_poison_data_count: 430
Global model norm: 43.96091181468061.
Norm before scaling: 43.90932623787414. Distance: 0.915299711284594
Total norm for 4 adversaries is: 43.90932623787414. distance: 0.915299711284594
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0265, Accuracy: 9837/9900 (99.3636%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4433/4903 (90.4140%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4384/4903 (89.4146%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2400, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5410/5871 (92.1478%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5205/5871 (88.6561%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1225, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5325/5907 (90.1473%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5197/5907 (87.9804%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.8200, Accuracy: 4450/10000 (44.5000%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4188/4537 (92.3077%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4153/4537 (91.5363%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0350, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4582/5038 (90.9488%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4518/5038 (89.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0782, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4939/5298 (93.2239%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4883/5298 (92.1669%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2523, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4763/5209 (91.4379%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4617/5209 (88.6351%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2764, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4613/5122 (90.0625%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4069/5122 (79.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3615, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3583/3929 (91.1937%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3556/3929 (90.5065%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1833, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4998/5559 (89.9083%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4753/5559 (85.5010%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4358, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4651/4993 (93.1504%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4594/4993 (92.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1678, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6269/6947 (90.2404%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5973/6947 (85.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3012, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4466/5018 (88.9996%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4315/5018 (85.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.5675, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4416/4797 (92.0575%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4302/4797 (89.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0058, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5618/6235 (90.1043%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5404/6235 (86.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3897, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5000/5461 (91.5583%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4874/5461 (89.2511%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4421, Accuracy: 4836/10000 (48.3600%)
time spent on training: 273.2558226585388
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.1982, Accuracy: 6749/10000 (67.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0082, Accuracy: 9884/9900 (99.8384%)
Done in 403.7864601612091 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 87, 92, 52, 89, 22, 93, 78, 49, 39, 82, 35, 94, 38, 61, 32, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5262/5308 (99.1334%), train_poison_data_count: 415
Global model norm: 43.97330983152238.
Norm before scaling: 43.92112459337619. Distance: 0.8515122425052692
Total norm for 4 adversaries is: 43.92112459337619. distance: 0.8515122425052692
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0460, Accuracy: 9795/9900 (98.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5727/5777 (99.1345%), train_poison_data_count: 455
Global model norm: 43.97330983152238.
Norm before scaling: 43.91934441082383. Distance: 0.9701703641666252
Total norm for 4 adversaries is: 43.91934441082383. distance: 0.9701703641666252
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0358, Accuracy: 9819/9900 (99.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5032/5123 (98.2237%), train_poison_data_count: 403
Global model norm: 43.97330983152238.
Norm before scaling: 43.93108867030059. Distance: 1.083930101840222
Total norm for 4 adversaries is: 43.93108867030059. distance: 1.083930101840222
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0349, Accuracy: 9816/9900 (99.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5449/5503 (99.0187%), train_poison_data_count: 430
Global model norm: 43.97330983152238.
Norm before scaling: 43.92348416209147. Distance: 0.9607789753979856
Total norm for 4 adversaries is: 43.92348416209147. distance: 0.9607789753979856
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0431, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3624/3995 (90.7134%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3496/3995 (87.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3718, Accuracy: 4980/10000 (49.8000%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6196/6812 (90.9571%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5987/6812 (87.8890%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4660, Accuracy: 4833/10000 (48.3300%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3893/4130 (94.2615%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3819/4130 (92.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1050, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4354/4737 (91.9147%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4280/4737 (90.3525%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4368, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5188/5696 (91.0815%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4982/5696 (87.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3253, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4611/5055 (91.2166%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4478/5055 (88.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3347, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4158/4368 (95.1923%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4111/4368 (94.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0471, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5141/5652 (90.9590%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4883/5652 (86.3942%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3372, Accuracy: 4882/10000 (48.8200%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3835/4175 (91.8563%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3739/4175 (89.5569%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2886, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4974/5298 (93.8845%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4873/5298 (91.9781%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2318, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5119/5615 (91.1665%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4950/5615 (88.1567%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2767, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4746/5224 (90.8499%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4718/5224 (90.3139%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2899, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5642/6235 (90.4892%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5406/6235 (86.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4124, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4144/4485 (92.3969%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3725/4485 (83.0546%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.5470, Accuracy: 4547/10000 (45.4700%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5366/6080 (88.2566%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5211/6080 (85.7072%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2804, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3859/4108 (93.9387%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3745/4108 (91.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2566, Accuracy: 5200/10000 (52.0000%)
time spent on training: 270.21949434280396
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.2032, Accuracy: 6740/10000 (67.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0083, Accuracy: 9883/9900 (99.8283%)
Done in 400.3247983455658 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 8, 12, 68, 28, 34, 90, 64, 6, 54, 43, 77, 76, 83, 84, 52, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5276/5308 (99.3971%), train_poison_data_count: 415
Global model norm: 43.985086861468595.
Norm before scaling: 43.93252244431581. Distance: 0.8336460401013711
Total norm for 4 adversaries is: 43.93252244431581. distance: 0.8336460401013711
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0283, Accuracy: 9828/9900 (99.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5715/5777 (98.9268%), train_poison_data_count: 455
Global model norm: 43.985086861468595.
Norm before scaling: 43.933164293101946. Distance: 1.0196454798989425
Total norm for 4 adversaries is: 43.933164293101946. distance: 1.0196454798989425
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0309, Accuracy: 9827/9900 (99.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5026/5123 (98.1066%), train_poison_data_count: 403
Global model norm: 43.985086861468595.
Norm before scaling: 43.94392706149437. Distance: 1.1289009173310198
Total norm for 4 adversaries is: 43.94392706149437. distance: 1.1289009173310198
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0327, Accuracy: 9814/9900 (99.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5429/5503 (98.6553%), train_poison_data_count: 430
Global model norm: 43.985086861468595.
Norm before scaling: 43.93719716734188. Distance: 1.0469116090664872
Total norm for 4 adversaries is: 43.93719716734188. distance: 1.0469116090664872
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0248, Accuracy: 9839/9900 (99.3838%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4478/4889 (91.5934%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4370/4889 (89.3843%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1405, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5011/5526 (90.6804%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4779/5526 (86.4821%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4491, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3337/3589 (92.9785%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3214/3589 (89.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1312, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4608/5122 (89.9649%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   2,  Average loss: 0.0139, Accuracy: 3860/5122 (75.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.6515, Accuracy: 4376/10000 (43.7600%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4527/4911 (92.1808%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4545/4911 (92.5473%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2747, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4459/4748 (93.9132%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4299/4748 (90.5434%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2099, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4427/4894 (90.4577%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4315/4894 (88.1692%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4047, Accuracy: 5019/10000 (50.1900%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4611/4929 (93.5484%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4470/4929 (90.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1889, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5113/5645 (90.5757%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4967/5645 (87.9894%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2958, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4585/4979 (92.0868%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4523/4979 (90.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2457, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4552/5050 (90.1386%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4437/5050 (87.8614%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1257, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3655/3959 (92.3213%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3567/3959 (90.0985%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1618, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3289/3552 (92.5957%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3298/3552 (92.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0405, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4705/5209 (90.3244%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4554/5209 (87.4256%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1508, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3892/4130 (94.2373%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3732/4130 (90.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2335, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3825/4086 (93.6123%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3779/4086 (92.4865%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0612, Accuracy: 5462/10000 (54.6200%)
time spent on training: 250.49827027320862
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.2039, Accuracy: 6745/10000 (67.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0079, Accuracy: 9884/9900 (99.8384%)
Done in 380.81188583374023 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 90, 6, 39, 89, 88, 7, 3, 94, 74, 66, 25, 96, 31, 98, 78, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5269/5308 (99.2653%), train_poison_data_count: 415
Global model norm: 43.99613519514384.
Norm before scaling: 43.94608124327612. Distance: 0.9026726457725555
Total norm for 4 adversaries is: 43.94608124327612. distance: 0.9026726457725555
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0180, Accuracy: 9856/9900 (99.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5733/5777 (99.2384%), train_poison_data_count: 455
Global model norm: 43.99613519514384.
Norm before scaling: 43.94061294315673. Distance: 0.9272422690008828
Total norm for 4 adversaries is: 43.94061294315673. distance: 0.9272422690008828
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0151, Accuracy: 9862/9900 (99.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5037/5123 (98.3213%), train_poison_data_count: 403
Global model norm: 43.99613519514384.
Norm before scaling: 43.95187937045824. Distance: 1.0655954373641465
Total norm for 4 adversaries is: 43.95187937045824. distance: 1.0655954373641465
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0790, Accuracy: 9711/9900 (98.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5462/5503 (99.2550%), train_poison_data_count: 430
Global model norm: 43.99613519514384.
Norm before scaling: 43.9445812439159. Distance: 0.9098929814405171
Total norm for 4 adversaries is: 43.9445812439159. distance: 0.9098929814405171
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0339, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4505/4748 (94.8821%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4288/4748 (90.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2490, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4561/4929 (92.5340%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4384/4929 (88.9430%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1431, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3850/4175 (92.2156%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3822/4175 (91.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0847, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4362/4737 (92.0836%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4247/4737 (89.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4884, Accuracy: 4902/10000 (49.0200%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4919/5362 (91.7382%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4762/5362 (88.8101%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2501, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4417/4869 (90.7168%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3932/4869 (80.7558%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5452, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5005/5346 (93.6214%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4906/5346 (91.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3047, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4697/5224 (89.9119%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4671/5224 (89.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1926, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4389/4797 (91.4947%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4251/4797 (88.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1831, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4471/4843 (92.3188%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4344/4843 (89.6965%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.3555, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5726/6419 (89.2039%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5455/6419 (84.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5249, Accuracy: 4745/10000 (47.4500%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4689/5086 (92.1943%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4599/5086 (90.4247%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1616, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4212/4537 (92.8367%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4137/4537 (91.1836%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9839, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3919/4161 (94.1841%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3818/4161 (91.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1145, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4126/4368 (94.4597%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4070/4368 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2333, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4577/4911 (93.1989%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4493/4911 (91.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2855, Accuracy: 5098/10000 (50.9800%)
time spent on training: 267.0193543434143
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.2075, Accuracy: 6735/10000 (67.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0078, Accuracy: 9884/9900 (99.8384%)
Done in 397.76969051361084 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 44, 82, 1, 10, 89, 11, 87, 28, 22, 78, 31, 79, 27, 46, 35, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5272/5308 (99.3218%), train_poison_data_count: 415
Global model norm: 44.00833189712134.
Norm before scaling: 43.95696303897. Distance: 0.8761764519444794
Total norm for 4 adversaries is: 43.95696303897. distance: 0.8761764519444794
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0156, Accuracy: 9861/9900 (99.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5729/5777 (99.1691%), train_poison_data_count: 455
Global model norm: 44.00833189712134.
Norm before scaling: 43.9543344905575. Distance: 0.9623176463891913
Total norm for 4 adversaries is: 43.9543344905575. distance: 0.9623176463891913
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0424, Accuracy: 9798/9900 (98.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5016/5123 (97.9114%), train_poison_data_count: 403
Global model norm: 44.00833189712134.
Norm before scaling: 43.96814198673427. Distance: 1.1538398470461708
Total norm for 4 adversaries is: 43.96814198673427. distance: 1.1538398470461708
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0378, Accuracy: 9817/9900 (99.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5451/5503 (99.0551%), train_poison_data_count: 430
Global model norm: 44.00833189712134.
Norm before scaling: 43.95854592415023. Distance: 0.9487518920678533
Total norm for 4 adversaries is: 43.95854592415023. distance: 0.9487518920678533
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0377, Accuracy: 9814/9900 (99.1313%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4752/5075 (93.6355%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4592/5075 (90.4828%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2529, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4980/5298 (93.9977%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4892/5298 (92.3367%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1899, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5118/5422 (94.3932%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4975/5422 (91.7558%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0244, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4768/5068 (94.0805%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4487/5068 (88.5359%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2532, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4340/4737 (91.6192%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4253/4737 (89.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2673, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4969/5702 (87.1449%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4523/5702 (79.3230%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.6100, Accuracy: 4684/10000 (46.8400%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3646/3995 (91.2641%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3516/3995 (88.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4417, Accuracy: 4918/10000 (49.1800%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4554/5122 (88.9106%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0119, Accuracy: 4033/5122 (78.7388%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.5491, Accuracy: 4535/10000 (45.3500%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5185/5696 (91.0288%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5104/5696 (89.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1036, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4152/4368 (95.0549%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4028/4368 (92.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2001, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4237/4537 (93.3877%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4180/4537 (92.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9665, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3827/4111 (93.0917%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3662/4111 (89.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1937, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4182/4587 (91.1707%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4161/4587 (90.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1302, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4792/5399 (88.7572%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4627/5399 (85.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2677, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5162/5615 (91.9323%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5002/5615 (89.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3667, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4378/4714 (92.8723%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4345/4714 (92.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1410, Accuracy: 5281/10000 (52.8100%)
time spent on training: 263.302983045578
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.2061, Accuracy: 6730/10000 (67.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0080, Accuracy: 9884/9900 (99.8384%)
Done in 393.08701944351196 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 50, 45, 74, 0, 54, 55, 59, 96, 81, 75, 98, 14, 62, 25, 73, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5272/5308 (99.3218%), train_poison_data_count: 415
Global model norm: 44.02054601750968.
Norm before scaling: 43.96765057260849. Distance: 0.8167644609234249
Total norm for 4 adversaries is: 43.96765057260849. distance: 0.8167644609234249
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0292, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5699/5777 (98.6498%), train_poison_data_count: 455
Global model norm: 44.02054601750968.
Norm before scaling: 43.970933503441366. Distance: 1.1120124412876649
Total norm for 4 adversaries is: 43.970933503441366. distance: 1.1120124412876649
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0368, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5031/5123 (98.2042%), train_poison_data_count: 403
Global model norm: 44.02054601750968.
Norm before scaling: 43.97892256391478. Distance: 1.123359225415255
Total norm for 4 adversaries is: 43.97892256391478. distance: 1.123359225415255
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0289, Accuracy: 9833/9900 (99.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5454/5503 (99.1096%), train_poison_data_count: 430
Global model norm: 44.02054601750968.
Norm before scaling: 43.96978832285016. Distance: 0.9489981626547099
Total norm for 4 adversaries is: 43.96978832285016. distance: 0.9489981626547099
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0196, Accuracy: 9854/9900 (99.5354%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4406/4757 (92.6214%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4221/4757 (88.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2955, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5016/5489 (91.3828%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4967/5489 (90.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3042, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4434/4797 (92.4328%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4325/4797 (90.1605%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2566, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4970/5454 (91.1258%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4743/5454 (86.9637%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2618, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5091/5645 (90.1860%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4860/5645 (86.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3277, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4462/4731 (94.3141%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4382/4731 (92.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0054, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4176/4397 (94.9738%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4180/4397 (95.0648%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0101, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4733/5086 (93.0594%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4655/5086 (91.5258%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1761, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4683/5035 (93.0089%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4633/5035 (92.0159%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1795, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4402/4672 (94.2209%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4345/4672 (93.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9745, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3897/4161 (93.6554%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3739/4161 (89.8582%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2916, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4019/4196 (95.7817%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3962/4196 (94.4233%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9311, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4876/5504 (88.5901%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4658/5504 (84.6294%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3100, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5713/6419 (89.0014%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5405/6419 (84.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3587, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4298/4605 (93.3333%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4315/4605 (93.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0911, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4486/4732 (94.8014%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4438/4732 (93.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9952, Accuracy: 5571/10000 (55.7100%)
time spent on training: 270.50379753112793
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.2042, Accuracy: 6740/10000 (67.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0084, Accuracy: 9883/9900 (99.8283%)
Done in 401.12406373023987 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 1, 41, 43, 84, 99, 94, 23, 2, 40, 82, 59, 28, 14, 56, 63, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5280/5308 (99.4725%), train_poison_data_count: 415
Global model norm: 44.03165476215662.
Norm before scaling: 43.97892395174222. Distance: 0.8279127532746187
Total norm for 4 adversaries is: 43.97892395174222. distance: 0.8279127532746187
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0240, Accuracy: 9838/9900 (99.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5724/5777 (99.0826%), train_poison_data_count: 455
Global model norm: 44.03165476215662.
Norm before scaling: 43.976954580549204. Distance: 0.9726308796342981
Total norm for 4 adversaries is: 43.976954580549204. distance: 0.9726308796342981
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0261, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5017/5123 (97.9309%), train_poison_data_count: 403
Global model norm: 44.03165476215662.
Norm before scaling: 43.989325875894316. Distance: 1.1254296012360154
Total norm for 4 adversaries is: 43.989325875894316. distance: 1.1254296012360154
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0283, Accuracy: 9832/9900 (99.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5446/5503 (98.9642%), train_poison_data_count: 430
Global model norm: 44.03165476215662.
Norm before scaling: 43.98113470524535. Distance: 0.9508656786354818
Total norm for 4 adversaries is: 43.98113470524535. distance: 0.9508656786354818
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0393, Accuracy: 9804/9900 (99.0303%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5090/5422 (93.8768%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5013/5422 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9381, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4419/4714 (93.7420%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4360/4714 (92.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1240, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4629/4979 (92.9705%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4487/4979 (90.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1285, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4724/5209 (90.6892%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4562/5209 (87.5792%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2148, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4394/4851 (90.5793%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4326/4851 (89.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1651, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4746/5224 (90.8499%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4602/5224 (88.0934%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2828, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4226/4549 (92.8995%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3900/4549 (85.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2364, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3783/3968 (95.3377%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3710/3968 (93.4980%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9265, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5439/5939 (91.5811%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5281/5939 (88.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.4363, Accuracy: 4912/10000 (49.1200%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4909/5298 (92.6576%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4880/5298 (92.1102%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1615, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4168/4397 (94.7919%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4181/4397 (95.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8970, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4566/5122 (89.1449%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0129, Accuracy: 3936/5122 (76.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.7120, Accuracy: 4427/10000 (44.2700%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4019/4196 (95.7817%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3914/4196 (93.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1087, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4890/5427 (90.1050%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4808/5427 (88.5941%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1555, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3671/3910 (93.8875%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3112/3910 (79.5908%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.5313, Accuracy: 4743/10000 (47.4300%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3860/4086 (94.4689%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3830/4086 (93.7347%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2199, Accuracy: 5378/10000 (53.7800%)
time spent on training: 266.08723545074463
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.2010, Accuracy: 6744/10000 (67.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0083, Accuracy: 9883/9900 (99.8283%)
Done in 396.0589437484741 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 27, 20, 75, 69, 86, 64, 19, 23, 31, 10, 76, 80, 97, 26, 52, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5281/5308 (99.4913%), train_poison_data_count: 415
Global model norm: 44.04284939701123.
Norm before scaling: 43.988754222492766. Distance: 0.7944941389180964
Total norm for 4 adversaries is: 43.988754222492766. distance: 0.7944941389180964
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0106, Accuracy: 9871/9900 (99.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5724/5777 (99.0826%), train_poison_data_count: 455
Global model norm: 44.04284939701123.
Norm before scaling: 43.989331425890924. Distance: 0.9863350140925873
Total norm for 4 adversaries is: 43.989331425890924. distance: 0.9863350140925873
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0144, Accuracy: 9862/9900 (99.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5042/5123 (98.4189%), train_poison_data_count: 403
Global model norm: 44.04284939701123.
Norm before scaling: 44.00133304310578. Distance: 1.115680238013407
Total norm for 4 adversaries is: 44.00133304310578. distance: 1.115680238013407
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0132, Accuracy: 9863/9900 (99.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5446/5503 (98.9642%), train_poison_data_count: 430
Global model norm: 44.04284939701123.
Norm before scaling: 43.99275009074648. Distance: 0.9740324587162288
Total norm for 4 adversaries is: 43.99275009074648. distance: 0.9740324587162288
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0269, Accuracy: 9842/9900 (99.4141%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4220/4587 (91.9991%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4143/4587 (90.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2120, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4453/4714 (94.4633%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4391/4714 (93.1481%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9568, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4371/4672 (93.5574%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4345/4672 (93.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0841, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3978/4364 (91.1549%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3786/4364 (86.7553%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4263, Accuracy: 4934/10000 (49.3400%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3621/3929 (92.1609%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3520/3929 (89.5902%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0453, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4402/4894 (89.9469%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4200/4894 (85.8194%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3208, Accuracy: 4895/10000 (48.9500%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4821/5361 (89.9273%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4688/5361 (87.4464%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2791, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4283/4549 (94.1526%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3776/4549 (83.0073%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2734, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4196/4537 (92.4840%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4097/4537 (90.3020%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0440, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4758/5068 (93.8832%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4642/5068 (91.5943%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1761, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3618/3959 (91.3867%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3573/3959 (90.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2196, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4998/5461 (91.5217%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4860/5461 (88.9947%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.7767, Accuracy: 4675/10000 (46.7500%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4225/4736 (89.2103%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4183/4736 (88.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.4153, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3829/4086 (93.7102%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3798/4086 (92.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1144, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3848/4130 (93.1719%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3806/4130 (92.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0916, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4146/4368 (94.9176%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4099/4368 (93.8416%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0226, Accuracy: 5526/10000 (55.2600%)
time spent on training: 253.99069237709045
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.2019, Accuracy: 6743/10000 (67.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0081, Accuracy: 9883/9900 (99.8283%)
Done in 384.5651104450226 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 46, 98, 55, 51, 80, 4, 97, 11, 35, 61, 86, 6, 83, 73, 84, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5272/5308 (99.3218%), train_poison_data_count: 415
Global model norm: 44.053996852406875.
Norm before scaling: 44.0020737592808. Distance: 0.867606603025369
Total norm for 4 adversaries is: 44.0020737592808. distance: 0.867606603025369
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0131, Accuracy: 9864/9900 (99.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5720/5777 (99.0133%), train_poison_data_count: 455
Global model norm: 44.053996852406875.
Norm before scaling: 44.00089054940394. Distance: 1.0005053197136888
Total norm for 4 adversaries is: 44.00089054940394. distance: 1.0005053197136888
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0348, Accuracy: 9813/9900 (99.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5030/5123 (98.1847%), train_poison_data_count: 403
Global model norm: 44.053996852406875.
Norm before scaling: 44.01116246902597. Distance: 1.100921227765026
Total norm for 4 adversaries is: 44.01116246902597. distance: 1.100921227765026
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0369, Accuracy: 9806/9900 (99.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5471/5503 (99.4185%), train_poison_data_count: 430
Global model norm: 44.053996852406875.
Norm before scaling: 44.00063115447536. Distance: 0.8640525444795485
Total norm for 4 adversaries is: 44.00063115447536. distance: 0.8640525444795485
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0388, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4768/5399 (88.3127%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4608/5399 (85.3491%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4600, Accuracy: 4742/10000 (47.4200%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3899/4161 (93.7034%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3803/4161 (91.3963%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2322, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4452/4731 (94.1027%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4357/4731 (92.0947%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0600, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3870/4108 (94.2064%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3780/4108 (92.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1914, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4958/5461 (90.7892%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4826/5461 (88.3721%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2681, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3751/4028 (93.1231%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3748/4028 (93.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9953, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4279/4736 (90.3505%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4187/4736 (88.4079%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1887, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5033/5702 (88.2673%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   2,  Average loss: 0.0127, Accuracy: 4334/5702 (76.0084%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3252, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5108/5615 (90.9706%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4979/5615 (88.6732%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.3490, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4114/4485 (91.7280%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3865/4485 (86.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5132, Accuracy: 4661/10000 (46.6100%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3582/3929 (91.1682%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3518/3929 (89.5393%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0039, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4622/4929 (93.7716%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4484/4929 (90.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1972, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3288/3552 (92.5676%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3334/3552 (93.8626%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9235, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4351/4605 (94.4843%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4277/4605 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1588, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4764/5209 (91.4571%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4601/5209 (88.3279%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1634, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4427/4869 (90.9222%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3876/4869 (79.6057%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5872, Accuracy: 4621/10000 (46.2100%)
time spent on training: 261.94825291633606
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.1986, Accuracy: 6753/10000 (67.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0077, Accuracy: 9885/9900 (99.8485%)
Done in 393.05831265449524 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 14, 5, 1, 61, 91, 75, 59, 44, 12, 38, 53, 74, 20, 89, 0, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5275/5308 (99.3783%), train_poison_data_count: 415
Global model norm: 44.064556966615044.
Norm before scaling: 44.01285989273476. Distance: 0.8646867452769127
Total norm for 4 adversaries is: 44.01285989273476. distance: 0.8646867452769127
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0192, Accuracy: 9854/9900 (99.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5733/5777 (99.2384%), train_poison_data_count: 455
Global model norm: 44.064556966615044.
Norm before scaling: 44.00841649794105. Distance: 0.9360072331250939
Total norm for 4 adversaries is: 44.00841649794105. distance: 0.9360072331250939
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0073, Accuracy: 9877/9900 (99.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5026/5123 (98.1066%), train_poison_data_count: 403
Global model norm: 44.064556966615044.
Norm before scaling: 44.02300285388807. Distance: 1.1548119443080824
Total norm for 4 adversaries is: 44.02300285388807. distance: 1.1548119443080824
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0415, Accuracy: 9807/9900 (99.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5459/5503 (99.2004%), train_poison_data_count: 430
Global model norm: 44.064556966615044.
Norm before scaling: 44.01331058656077. Distance: 0.932631886950584
Total norm for 4 adversaries is: 44.01331058656077. distance: 0.932631886950584
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0204, Accuracy: 9856/9900 (99.5556%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3965/4196 (94.4948%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3854/4196 (91.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9814, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4677/4993 (93.6711%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4598/4993 (92.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1196, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5136/5422 (94.7252%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4963/5422 (91.5345%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0639, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4157/4485 (92.6867%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3725/4485 (83.0546%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4858, Accuracy: 4685/10000 (46.8500%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4107/4527 (90.7223%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3981/4527 (87.9390%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.5755, Accuracy: 4690/10000 (46.9000%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4378/4672 (93.7072%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4287/4672 (91.7594%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9157, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4202/4397 (95.5652%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4140/4397 (94.1551%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8909, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4723/5075 (93.0640%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4559/5075 (89.8325%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2780, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5046/5526 (91.3138%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4808/5526 (87.0069%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3588, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5556/6235 (89.1099%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5400/6235 (86.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4200, Accuracy: 4899/10000 (48.9900%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5932/6664 (89.0156%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5620/6664 (84.3337%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2404, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4403/4797 (91.7865%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4277/4797 (89.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2282, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4492/4714 (95.2906%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4400/4714 (93.3390%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0845, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4357/4737 (91.9780%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4309/4737 (90.9647%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2283, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4967/5454 (91.0708%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4787/5454 (87.7704%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3819, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4428/4869 (90.9427%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4138/4869 (84.9867%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3844, Accuracy: 4970/10000 (49.7000%)
time spent on training: 259.24400568008423
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.2019, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0079, Accuracy: 9884/9900 (99.8384%)
Done in 389.1684629917145 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 17, 26, 15, 18, 38, 29, 82, 21, 84, 80, 85, 11, 12, 88, 89, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5261/5308 (99.1145%), train_poison_data_count: 415
Global model norm: 44.07642039640852.
Norm before scaling: 44.02478023129772. Distance: 0.8862559249206403
Total norm for 4 adversaries is: 44.02478023129772. distance: 0.8862559249206403
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0308, Accuracy: 9827/9900 (99.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5720/5777 (99.0133%), train_poison_data_count: 455
Global model norm: 44.07642039640852.
Norm before scaling: 44.02229715137972. Distance: 1.0083507904138918
Total norm for 4 adversaries is: 44.02229715137972. distance: 1.0083507904138918
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0260, Accuracy: 9843/9900 (99.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5033/5123 (98.2432%), train_poison_data_count: 403
Global model norm: 44.07642039640852.
Norm before scaling: 44.032544671349335. Distance: 1.0937796997397626
Total norm for 4 adversaries is: 44.032544671349335. distance: 1.0937796997397626
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0181, Accuracy: 9859/9900 (99.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5444/5503 (98.9279%), train_poison_data_count: 430
Global model norm: 44.07642039640852.
Norm before scaling: 44.02519614388802. Distance: 0.9628098397866667
Total norm for 4 adversaries is: 44.02519614388802. distance: 0.9628098397866667
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0247, Accuracy: 9841/9900 (99.4040%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4447/4903 (90.6996%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4349/4903 (88.7008%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2180, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3885/4086 (95.0808%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3848/4086 (94.1752%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0091, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5550/6068 (91.4634%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5491/6068 (90.4911%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3364, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3956/4249 (93.1043%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3868/4249 (91.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0294, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5587/6235 (89.6071%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5450/6235 (87.4098%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.6570, Accuracy: 4723/10000 (47.2300%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4459/4732 (94.2308%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4415/4732 (93.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8967, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4951/5298 (93.4504%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4901/5298 (92.5066%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1618, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4646/5038 (92.2191%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4550/5038 (90.3136%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2812, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4757/5209 (91.3227%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4608/5209 (88.4623%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3265, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5026/5461 (92.0344%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4949/5461 (90.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2151, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0053, Accuracy: 6249/6947 (89.9525%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5934/6947 (85.4182%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.4922, Accuracy: 4866/10000 (48.6600%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5042/5702 (88.4251%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   2,  Average loss: 0.0117, Accuracy: 4407/5702 (77.2887%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3807, Accuracy: 4912/10000 (49.1200%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5003/5526 (90.5356%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4794/5526 (86.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.4466, Accuracy: 4838/10000 (48.3800%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4874/5362 (90.8989%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4777/5362 (89.0899%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3766, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4279/4737 (90.3314%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4234/4737 (89.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.5985, Accuracy: 4797/10000 (47.9700%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5162/5727 (90.1345%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4989/5727 (87.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0768, Accuracy: 5374/10000 (53.7400%)
time spent on training: 261.4103696346283
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.2024, Accuracy: 6738/10000 (67.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0074, Accuracy: 9886/9900 (99.8586%)
Done in 392.14951825141907 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 7, 34, 31, 64, 77, 29, 99, 0, 33, 46, 72, 22, 88, 80, 11, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5284/5308 (99.5479%), train_poison_data_count: 415
Global model norm: 44.08886760929921.
Norm before scaling: 44.03493846554191. Distance: 0.7901783597574882
Total norm for 4 adversaries is: 44.03493846554191. distance: 0.7901783597574882
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0305, Accuracy: 9829/9900 (99.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5725/5777 (99.0999%), train_poison_data_count: 455
Global model norm: 44.08886760929921.
Norm before scaling: 44.0345545246855. Distance: 0.9683605764980949
Total norm for 4 adversaries is: 44.0345545246855. distance: 0.9683605764980949
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0212, Accuracy: 9853/9900 (99.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5013/5123 (97.8528%), train_poison_data_count: 403
Global model norm: 44.08886760929921.
Norm before scaling: 44.04724359104381. Distance: 1.13159898675406
Total norm for 4 adversaries is: 44.04724359104381. distance: 1.13159898675406
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1035, Accuracy: 9654/9900 (97.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5443/5503 (98.9097%), train_poison_data_count: 430
Global model norm: 44.08886760929921.
Norm before scaling: 44.03693573563418. Distance: 0.9527527441777528
Total norm for 4 adversaries is: 44.03693573563418. distance: 0.9527527441777528
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0073, Accuracy: 9883/9900 (99.8283%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4452/4869 (91.4356%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4113/4869 (84.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.5338, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4536/4911 (92.3641%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4520/4911 (92.0383%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1147, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4221/4537 (93.0350%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4144/4537 (91.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0476, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4412/4894 (90.1512%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4175/4894 (85.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4712, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4562/5050 (90.3366%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4429/5050 (87.7030%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1858, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4483/4732 (94.7380%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4445/4732 (93.9349%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9090, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4464/4851 (92.0223%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4394/4851 (90.5793%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9814, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4964/5454 (91.0158%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4822/5454 (88.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1352, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4434/4818 (92.0299%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4230/4818 (87.7958%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1075, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4805/5399 (88.9980%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4593/5399 (85.0713%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3232, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4766/5193 (91.7774%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4091/5193 (78.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4850, Accuracy: 4633/10000 (46.3300%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5267/5696 (92.4684%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5081/5696 (89.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2293, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4906/5362 (91.4957%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4755/5362 (88.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.5111, Accuracy: 4786/10000 (47.8600%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5041/5461 (92.3091%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4882/5461 (89.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3234, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4949/5702 (86.7941%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4637/5702 (81.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4897, Accuracy: 4744/10000 (47.4400%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4591/4830 (95.0518%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4460/4830 (92.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2492, Accuracy: 5235/10000 (52.3500%)
time spent on training: 265.9786596298218
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.2116, Accuracy: 6728/10000 (67.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0070, Accuracy: 9886/9900 (99.8586%)
Done in 395.86705589294434 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 31, 7, 49, 8, 57, 89, 19, 42, 51, 98, 15, 35, 76, 48, 75, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5285/5308 (99.5667%), train_poison_data_count: 415
Global model norm: 44.10172511595351.
Norm before scaling: 44.04596875176263. Distance: 0.7768406605822709
Total norm for 4 adversaries is: 44.04596875176263. distance: 0.7768406605822709
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0164, Accuracy: 9863/9900 (99.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5721/5777 (99.0306%), train_poison_data_count: 455
Global model norm: 44.10172511595351.
Norm before scaling: 44.04616690855105. Distance: 0.9807989164897167
Total norm for 4 adversaries is: 44.04616690855105. distance: 0.9807989164897167
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0029, Accuracy: 9891/9900 (99.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5025/5123 (98.0871%), train_poison_data_count: 403
Global model norm: 44.10172511595351.
Norm before scaling: 44.0586018887416. Distance: 1.1041163067159654
Total norm for 4 adversaries is: 44.0586018887416. distance: 1.1041163067159654
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0172, Accuracy: 9854/9900 (99.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5448/5503 (99.0005%), train_poison_data_count: 430
Global model norm: 44.10172511595351.
Norm before scaling: 44.04924446003586. Distance: 0.944937166466368
Total norm for 4 adversaries is: 44.04924446003586. distance: 0.944937166466368
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0558, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4222/4537 (93.0571%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4139/4537 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1250, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4445/4869 (91.2918%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3759/4869 (77.2027%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.5440, Accuracy: 4625/10000 (46.2500%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5045/5652 (89.2604%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4955/5652 (87.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.6081, Accuracy: 4717/10000 (47.1700%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4497/4889 (91.9820%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4380/4889 (89.5889%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2612, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4956 (92.4334%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4444/4956 (89.6691%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4400, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4290/4737 (90.5636%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4259/4737 (89.9092%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2927, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4848/5361 (90.4309%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4685/5361 (87.3904%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2823, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5337/5907 (90.3504%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5213/5907 (88.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4961, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3850/4108 (93.7196%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3757/4108 (91.4557%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0913, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3874/4161 (93.1026%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3775/4161 (90.7234%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2692, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5596/6068 (92.2215%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5418/6068 (89.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4009, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5077/5615 (90.4185%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4965/5615 (88.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3957, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3582/3959 (90.4774%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3529/3959 (89.1387%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1246, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4554/4830 (94.2857%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4497/4830 (93.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0748, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4391/4672 (93.9854%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4352/4672 (93.1507%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1203, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5012/5559 (90.1601%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4720/5559 (84.9074%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1858, Accuracy: 5188/10000 (51.8800%)
time spent on training: 268.6295757293701
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.2139, Accuracy: 6723/10000 (67.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0058, Accuracy: 9889/9900 (99.8889%)
Done in 398.1745173931122 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 21, 78, 19, 42, 25, 70, 73, 31, 96, 99, 88, 18, 0, 54, 32, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5280/5308 (99.4725%), train_poison_data_count: 415
Global model norm: 44.11348861663162.
Norm before scaling: 44.05932917447436. Distance: 0.8029409546503502
Total norm for 4 adversaries is: 44.05932917447436. distance: 0.8029409546503502
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0273, Accuracy: 9835/9900 (99.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5731/5777 (99.2037%), train_poison_data_count: 455
Global model norm: 44.11348861663162.
Norm before scaling: 44.05701428617809. Distance: 0.9244620021605651
Total norm for 4 adversaries is: 44.05701428617809. distance: 0.9244620021605651
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0118, Accuracy: 9869/9900 (99.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5036/5123 (98.3018%), train_poison_data_count: 403
Global model norm: 44.11348861663162.
Norm before scaling: 44.07066773810912. Distance: 1.109761345441194
Total norm for 4 adversaries is: 44.07066773810912. distance: 1.109761345441194
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0769, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5458/5503 (99.1823%), train_poison_data_count: 430
Global model norm: 44.11348861663162.
Norm before scaling: 44.06013679389653. Distance: 0.8949936916619156
Total norm for 4 adversaries is: 44.06013679389653. distance: 0.8949936916619156
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0198, Accuracy: 9851/9900 (99.5051%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4637/5038 (92.0405%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4570/5038 (90.7106%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0031, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4157/4368 (95.1694%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4102/4368 (93.9103%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0155, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4788/5361 (89.3117%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4645/5361 (86.6443%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2874, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5406/5907 (91.5185%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5302/5907 (89.7579%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4854, Accuracy: 4836/10000 (48.3600%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5787/6419 (90.1542%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5482/6419 (85.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4800, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5377/5871 (91.5858%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5240/5871 (89.2523%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4058, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4379/4605 (95.0923%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4311/4605 (93.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1455, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4254/4537 (93.7624%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4190/4537 (92.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1071, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4709/5086 (92.5875%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4607/5086 (90.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1002, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4467/4851 (92.0841%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4391/4851 (90.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0996, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4917/5362 (91.7009%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4778/5362 (89.1085%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4180, Accuracy: 4827/10000 (48.2700%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3972/4249 (93.4808%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3811/4249 (89.6917%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1247, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4990/5454 (91.4925%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4688/5454 (85.9553%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.5432, Accuracy: 4892/10000 (48.9200%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5088/5645 (90.1329%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4862/5645 (86.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3486, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5361/6080 (88.1743%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5219/6080 (85.8388%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4332, Accuracy: 4856/10000 (48.5600%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5036/5489 (91.7471%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4952/5489 (90.2168%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4640, Accuracy: 4887/10000 (48.8700%)
time spent on training: 267.3830761909485
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.2137, Accuracy: 6729/10000 (67.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0054, Accuracy: 9890/9900 (99.8990%)
Done in 397.1792588233948 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 84, 48, 20, 55, 59, 40, 92, 0, 16, 85, 82, 90, 52, 6, 15, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5276/5308 (99.3971%), train_poison_data_count: 415
Global model norm: 44.12500414969881.
Norm before scaling: 44.07102782059958. Distance: 0.81883495414222
Total norm for 4 adversaries is: 44.07102782059958. distance: 0.81883495414222
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0167, Accuracy: 9862/9900 (99.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5730/5777 (99.1864%), train_poison_data_count: 455
Global model norm: 44.12500414969881.
Norm before scaling: 44.06981460785049. Distance: 0.9768628078292926
Total norm for 4 adversaries is: 44.06981460785049. distance: 0.9768628078292926
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0157, Accuracy: 9862/9900 (99.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5045/5123 (98.4775%), train_poison_data_count: 403
Global model norm: 44.12500414969881.
Norm before scaling: 44.080261546499614. Distance: 1.0585244919759367
Total norm for 4 adversaries is: 44.080261546499614. distance: 1.0585244919759367
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0488, Accuracy: 9777/9900 (98.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5450/5503 (99.0369%), train_poison_data_count: 430
Global model norm: 44.12500414969881.
Norm before scaling: 44.0720443452926. Distance: 0.9202175110789734
Total norm for 4 adversaries is: 44.0720443452926. distance: 0.9202175110789734
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0296, Accuracy: 9829/9900 (99.2828%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4746/5209 (91.1115%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4610/5209 (88.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3286, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4585/4830 (94.9275%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4461/4830 (92.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2878, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4470/4714 (94.8239%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4424/4714 (93.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0489, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4478/4731 (94.6523%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4429/4731 (93.6166%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1551, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4208/4397 (95.7016%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4180/4397 (95.0648%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0181, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5512/5939 (92.8102%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5322/5939 (89.6110%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3932, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6285/6812 (92.2637%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   2,  Average loss: 0.0057, Accuracy: 6046/6812 (88.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.5815, Accuracy: 4797/10000 (47.9700%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4933/5454 (90.4474%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4817/5454 (88.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1525, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4901/5353 (91.5561%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4705/5353 (87.8946%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.5017, Accuracy: 4807/10000 (48.0700%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 6247/6947 (89.9237%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0077, Accuracy: 5908/6947 (85.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4065, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5018/5298 (94.7150%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4957/5298 (93.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0818, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4500/4748 (94.7767%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4291/4748 (90.3749%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1809, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3897/4130 (94.3584%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3772/4130 (91.3317%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2223, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4572/4929 (92.7572%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4431/4929 (89.8965%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2936, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5563/6068 (91.6777%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5461/6068 (89.9967%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3800, Accuracy: 4852/10000 (48.5200%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4300/4736 (90.7939%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4199/4736 (88.6613%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0975, Accuracy: 5363/10000 (53.6300%)
time spent on training: 266.9220681190491
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.2200, Accuracy: 6719/10000 (67.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0060, Accuracy: 9889/9900 (99.8889%)
Done in 396.9981515407562 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 57, 62, 61, 67, 3, 82, 69, 93, 42, 76, 7, 94, 14, 21, 32, 25].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5276/5308 (99.3971%), train_poison_data_count: 415
Global model norm: 44.135808642101345.
Norm before scaling: 44.08200615445675. Distance: 0.8241018420286438
Total norm for 4 adversaries is: 44.08200615445675. distance: 0.8241018420286438
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0244, Accuracy: 9841/9900 (99.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5715/5777 (98.9268%), train_poison_data_count: 455
Global model norm: 44.135808642101345.
Norm before scaling: 44.0827344386205. Distance: 1.0555497212555474
Total norm for 4 adversaries is: 44.0827344386205. distance: 1.0555497212555474
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0099, Accuracy: 9874/9900 (99.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5029/5123 (98.1651%), train_poison_data_count: 403
Global model norm: 44.135808642101345.
Norm before scaling: 44.093626804842074. Distance: 1.1233108873605653
Total norm for 4 adversaries is: 44.093626804842074. distance: 1.1233108873605653
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0406, Accuracy: 9810/9900 (99.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5468/5503 (99.3640%), train_poison_data_count: 430
Global model norm: 44.135808642101345.
Norm before scaling: 44.082699824626495. Distance: 0.8891849922846781
Total norm for 4 adversaries is: 44.082699824626495. distance: 0.8891849922846781
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0205, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4640/4956 (93.6239%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4458/4956 (89.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4724, Accuracy: 4887/10000 (48.8700%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4907/5504 (89.1533%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4722/5504 (85.7922%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3813, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4110/4485 (91.6388%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3811/4485 (84.9721%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3069, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5038/5559 (90.6278%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4836/5559 (86.9941%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2607, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4961/5346 (92.7984%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4948/5346 (92.5552%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5406, Accuracy: 4897/10000 (48.9700%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4966/5298 (93.7335%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4870/5298 (91.9215%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1507, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4042/4364 (92.6214%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3879/4364 (88.8863%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1833, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4604/5055 (91.0781%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4469/5055 (88.4075%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4073, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5354/5907 (90.6382%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5180/5907 (87.6926%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5787, Accuracy: 4773/10000 (47.7300%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3571/3959 (90.1995%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3562/3959 (89.9722%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3004, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4482/4869 (92.0518%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3885/4869 (79.7905%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5160, Accuracy: 4700/10000 (47.0000%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4761/5224 (91.1371%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4623/5224 (88.4954%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5582, Accuracy: 4841/10000 (48.4100%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4004/4196 (95.4242%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3954/4196 (94.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9227, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4638/5038 (92.0603%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4575/5038 (90.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1028, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5350/6080 (87.9934%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5232/6080 (86.0526%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3379, Accuracy: 4880/10000 (48.8000%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5720/6419 (89.1105%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5413/6419 (84.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3753, Accuracy: 4989/10000 (49.8900%)
time spent on training: 280.22424602508545
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.2201, Accuracy: 6707/10000 (67.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0060, Accuracy: 9889/9900 (99.8889%)
Done in 410.4723381996155 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 19, 16, 82, 89, 45, 31, 91, 9, 44, 66, 11, 76, 92, 37, 54, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5289/5308 (99.6420%), train_poison_data_count: 415
Global model norm: 44.14825570105021.
Norm before scaling: 44.094147267434344. Distance: 0.7952953089446793
Total norm for 4 adversaries is: 44.094147267434344. distance: 0.7952953089446793
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0297, Accuracy: 9827/9900 (99.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5731/5777 (99.2037%), train_poison_data_count: 455
Global model norm: 44.14825570105021.
Norm before scaling: 44.09186881396401. Distance: 0.961807198567064
Total norm for 4 adversaries is: 44.09186881396401. distance: 0.961807198567064
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0260, Accuracy: 9834/9900 (99.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5046/5123 (98.4970%), train_poison_data_count: 403
Global model norm: 44.14825570105021.
Norm before scaling: 44.103610033292625. Distance: 1.06269116645373
Total norm for 4 adversaries is: 44.103610033292625. distance: 1.06269116645373
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0261, Accuracy: 9837/9900 (99.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5460/5503 (99.2186%), train_poison_data_count: 430
Global model norm: 44.14825570105021.
Norm before scaling: 44.09397977881306. Distance: 0.874771088220861
Total norm for 4 adversaries is: 44.09397977881306. distance: 0.874771088220861
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0448, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4855/5361 (90.5615%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4710/5361 (87.8567%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3441, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4872/5353 (91.0144%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4656/5353 (86.9793%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2212, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5002/5298 (94.4130%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4930/5298 (93.0540%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1728, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4330/4737 (91.4081%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4316/4737 (91.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2641, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4975/5489 (90.6358%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4848/5489 (88.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3617, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4255/4537 (93.7844%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4113/4537 (90.6546%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3803, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4042/4527 (89.2865%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3920/4527 (86.5916%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2138, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5197/5727 (90.7456%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5059/5727 (88.3360%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1933, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4706/5075 (92.7291%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4549/5075 (89.6355%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2212, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4493/4843 (92.7731%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4419/4843 (91.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1946, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4956/5702 (86.9169%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4504/5702 (78.9898%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.4375, Accuracy: 4784/10000 (47.8400%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3638/3959 (91.8919%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3591/3959 (90.7047%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1980, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6302/6812 (92.5132%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   2,  Average loss: 0.0053, Accuracy: 6116/6812 (89.7827%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1335, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4293/4741 (90.5505%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3804/4741 (80.2362%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.6030, Accuracy: 4691/10000 (46.9100%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4998/5645 (88.5385%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4835/5645 (85.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2730, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3670/3910 (93.8619%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3421/3910 (87.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3732, Accuracy: 5024/10000 (50.2400%)
time spent on training: 270.20657563209534
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.2222, Accuracy: 6712/10000 (67.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0066, Accuracy: 9889/9900 (99.8889%)
Done in 400.69416427612305 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 42, 74, 66, 6, 50, 49, 10, 11, 1, 96, 61, 52, 79, 72, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5273/5308 (99.3406%), train_poison_data_count: 415
Global model norm: 44.16038689264183.
Norm before scaling: 44.10580069869991. Distance: 0.8157013035302586
Total norm for 4 adversaries is: 44.10580069869991. distance: 0.8157013035302586
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0164, Accuracy: 9858/9900 (99.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5724/5777 (99.0826%), train_poison_data_count: 455
Global model norm: 44.16038689264183.
Norm before scaling: 44.10426184719496. Distance: 0.9435773325220042
Total norm for 4 adversaries is: 44.10426184719496. distance: 0.9435773325220042
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0701, Accuracy: 9732/9900 (98.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5044/5123 (98.4579%), train_poison_data_count: 403
Global model norm: 44.16038689264183.
Norm before scaling: 44.11581160972078. Distance: 1.0586562472542558
Total norm for 4 adversaries is: 44.11581160972078. distance: 1.0586562472542558
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0936, Accuracy: 9687/9900 (97.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5452/5503 (99.0732%), train_poison_data_count: 430
Global model norm: 44.16038689264183.
Norm before scaling: 44.10837870819585. Distance: 0.9261667921553476
Total norm for 4 adversaries is: 44.10837870819585. distance: 0.9261667921553476
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0253, Accuracy: 9838/9900 (99.3737%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5391/5907 (91.2646%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5229/5907 (88.5221%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4093, Accuracy: 4850/10000 (48.5000%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4389/4797 (91.4947%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4335/4797 (90.3690%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0786, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4500/4843 (92.9176%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4448/4843 (91.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1548, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/4929 (93.0209%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1833, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4403/4757 (92.5583%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4240/4757 (89.1318%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4893, Accuracy: 4795/10000 (47.9500%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5037/5652 (89.1189%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4934/5652 (87.2965%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.5022, Accuracy: 4705/10000 (47.0500%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4755/5068 (93.8240%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4536/5068 (89.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3536, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4950/5702 (86.8116%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   2,  Average loss: 0.0123, Accuracy: 4373/5702 (76.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4739, Accuracy: 4728/10000 (47.2800%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5141/5422 (94.8174%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5014/5422 (92.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1236, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4673/5086 (91.8797%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4603/5086 (90.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2023, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4133/4485 (92.1516%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3835/4485 (85.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4101, Accuracy: 4899/10000 (48.9900%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3907/4130 (94.6005%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3816/4130 (92.3971%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2028, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3820/4111 (92.9214%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3568/4111 (86.7915%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4241, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4773/5193 (91.9122%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4463/5193 (85.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.6219, Accuracy: 4652/10000 (46.5200%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4400/4731 (93.0036%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4328/4731 (91.4817%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3331, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5636/6235 (90.3929%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5368/6235 (86.0946%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.5522, Accuracy: 4643/10000 (46.4300%)
time spent on training: 265.2522678375244
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.2177, Accuracy: 6721/10000 (67.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0077, Accuracy: 9886/9900 (99.8586%)
Done in 395.12895369529724 sec.
Saving all the graphs.
This run has a label: Oct.25_17.34.28. Visdom environment: cifar100_CerP
