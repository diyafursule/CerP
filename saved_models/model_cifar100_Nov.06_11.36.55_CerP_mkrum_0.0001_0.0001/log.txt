current path: saved_models/model_cifar100_Nov.06_11.36.55_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43998807599532. Distance: 2.293720388611125
Total norm for 4 adversaries is: 42.43998807599532. distance: 2.293720388611125
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4303, Accuracy: 8857/9900 (89.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43529081142251. Distance: 2.2510809950693256
Total norm for 4 adversaries is: 42.43529081142251. distance: 2.2510809950693256
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7353, Accuracy: 8295/9900 (83.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4173/4717 (88.4672%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43875412358968. Distance: 2.177565440651907
Total norm for 4 adversaries is: 42.43875412358968. distance: 2.177565440651907
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4295, Accuracy: 8882/9900 (89.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44036487016223. Distance: 2.3036522560682693
Total norm for 4 adversaries is: 42.44036487016223. distance: 2.3036522560682693
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6009, Accuracy: 8509/9900 (85.9495%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3691/4356 (84.7337%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3502, Accuracy: 4735/10000 (47.3500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3928/4465 (87.9731%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4081/4465 (91.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0265, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4159/4647 (89.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9699, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5055 (87.9921%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4538/5055 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0736, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4438/5116 (86.7475%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4463/5116 (87.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0628, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3631/4126 (88.0029%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3763/4126 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9680, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3215/3472 (92.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0613, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4440/4986 (89.0493%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4435/4986 (88.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0327, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8242, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4064/4618 (88.0035%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0312, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4430/5083 (87.1533%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4443/5083 (87.4090%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1156, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3973/4511 (88.0736%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4013/4511 (88.9603%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1382, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3407/3797 (89.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9825, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5005/5582 (89.6632%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5075/5582 (90.9172%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1145, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3153/3616 (87.1958%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3194/3616 (88.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0776, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4831/5455 (88.5610%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4877/5455 (89.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9602, Accuracy: 5325/10000 (53.2500%)
time spent on training: 233.0863072872162
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1503, Accuracy: 6973/10000 (69.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.9329, Accuracy: 62/9900 (0.6263%)
Done in 257.03412890434265 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4382/4885 (89.7032%), train_poison_data_count: 385
Global model norm: 42.46504766790566.
Norm before scaling: 42.47198065342609. Distance: 2.1651449973378387
Total norm for 4 adversaries is: 42.47198065342609. distance: 2.1651449973378387
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1964, Accuracy: 9383/9900 (94.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.46504766790566.
Norm before scaling: 42.46789918205867. Distance: 2.2101621312871886
Total norm for 4 adversaries is: 42.46789918205867. distance: 2.2101621312871886
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4588, Accuracy: 8771/9900 (88.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4172/4717 (88.4460%), train_poison_data_count: 370
Global model norm: 42.46504766790566.
Norm before scaling: 42.47346080844925. Distance: 2.2168834518129543
Total norm for 4 adversaries is: 42.47346080844925. distance: 2.2168834518129543
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2009, Accuracy: 9402/9900 (94.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 42.46504766790566.
Norm before scaling: 42.47559329062544. Distance: 2.3554514414592607
Total norm for 4 adversaries is: 42.47559329062544. distance: 2.3554514414592607
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1808, Accuracy: 9398/9900 (94.9293%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3592/4025 (89.2422%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3706/4025 (92.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9631, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3344/3797 (88.0695%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3389/3797 (89.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1043, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3920/4625 (84.7568%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4028/4625 (87.0919%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3364, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3857/4481 (86.0745%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3879/4481 (86.5655%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1440, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3833/4315 (88.8297%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3968/4315 (91.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0558, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3698/4235 (87.3200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3805/4235 (89.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9613, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3372/3828 (88.0878%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3457/3828 (90.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9363, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3815/4416 (86.3904%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3964/4416 (89.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9280, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3148/3638 (86.5311%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3266/3638 (89.7746%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0117, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4537/5265 (86.1728%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4507/5265 (85.6030%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0299, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3348/3781 (88.5480%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3324/3781 (87.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2232, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3951/4441 (88.9664%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4026/4441 (90.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2399, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3973/4433 (89.6233%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4029/4433 (90.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8868, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4419/5083 (86.9368%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4463/5083 (87.8025%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9620, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4301/4928 (87.2768%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4420/4928 (89.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8835, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4147/4793 (86.5220%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4338/4793 (90.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0682, Accuracy: 5393/10000 (53.9300%)
time spent on training: 229.91408371925354
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1528, Accuracy: 7008/10000 (70.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.5389, Accuracy: 77/9900 (0.7778%)
Done in 253.75662851333618 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 42.50107851342937.
Norm before scaling: 42.50268833409247. Distance: 2.1065534016585734
Total norm for 4 adversaries is: 42.50268833409247. distance: 2.1065534016585734
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1918, Accuracy: 9390/9900 (94.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.50107851342937.
Norm before scaling: 42.5046657020769. Distance: 2.199954843057675
Total norm for 4 adversaries is: 42.5046657020769. distance: 2.199954843057675
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0803, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 42.50107851342937.
Norm before scaling: 42.50410280058635. Distance: 2.084948473140436
Total norm for 4 adversaries is: 42.50410280058635. distance: 2.084948473140436
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2019, Accuracy: 9360/9900 (94.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4461/5066 (88.0576%), train_poison_data_count: 400
Global model norm: 42.50107851342937.
Norm before scaling: 42.50786634461762. Distance: 2.256818295075189
Total norm for 4 adversaries is: 42.50786634461762. distance: 2.256818295075189
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1593, Accuracy: 9483/9900 (95.7879%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3119/3616 (86.2555%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3270/3616 (90.4314%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8172, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3389/3837 (88.3242%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3517/3837 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9416, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4156/4679 (88.8224%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4267/4679 (91.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0378, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3118/3638 (85.7064%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3271/3638 (89.9120%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0641, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3612/4046 (89.2734%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3643/4046 (90.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0281, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3974/4518 (87.9593%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4088/4518 (90.4825%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1240, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3368/3797 (88.7016%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3395/3797 (89.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1202, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4431/5025 (88.1791%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4458/5025 (88.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3738, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3880/4362 (88.9500%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3894/4362 (89.2710%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0457, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3981/4558 (87.3409%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4030/4558 (88.4160%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1204, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3211/3672 (87.4455%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3276/3672 (89.2157%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1240, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4314/4874 (88.5105%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4368/4874 (89.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1890, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3601/4025 (89.4658%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3695/4025 (91.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9893, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4095/4663 (87.8190%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4231/4663 (90.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0911, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3449/3911 (88.1872%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3465/3911 (88.5963%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9832, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4422/5017 (88.1403%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4556/5017 (90.8112%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8679, Accuracy: 5618/10000 (56.1800%)
time spent on training: 229.08381414413452
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.2155, Accuracy: 6832/10000 (68.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.5535, Accuracy: 54/9900 (0.5455%)
Done in 253.04978775978088 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 42.53092423874142.
Norm before scaling: 42.53541722788199. Distance: 2.1196528083878947
Total norm for 4 adversaries is: 42.53541722788199. distance: 2.1196528083878947
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5443, Accuracy: 8672/9900 (87.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.53092423874142.
Norm before scaling: 42.531363370073. Distance: 2.166696425991603
Total norm for 4 adversaries is: 42.531363370073. distance: 2.166696425991603
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1132, Accuracy: 9596/9900 (96.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 42.53092423874142.
Norm before scaling: 42.533497254186315. Distance: 2.096215006946253
Total norm for 4 adversaries is: 42.533497254186315. distance: 2.096215006946253
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1686, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.53092423874142.
Norm before scaling: 42.53716206154331. Distance: 2.270727265940183
Total norm for 4 adversaries is: 42.53716206154331. distance: 2.270727265940183
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2941, Accuracy: 9139/9900 (92.3131%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5286/6124 (86.3161%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5280/6124 (86.2182%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2821, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3865/4356 (88.7282%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3629/4356 (83.3104%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2944, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3518/4158 (84.6080%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3600/4158 (86.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0983, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4852/5455 (88.9459%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4865/5455 (89.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0010, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3911/4511 (86.6992%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4042/4511 (89.6032%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0659, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4488/5232 (85.7798%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4527/5232 (86.5252%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1681, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4455/5244 (84.9542%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4529/5244 (86.3654%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0704, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4357/4918 (88.5929%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4378/4918 (89.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1440, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3598/4126 (87.2031%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3738/4126 (90.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8307, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4345/4928 (88.1696%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4404/4928 (89.3669%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2358, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3718/4223 (88.0417%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3856/4223 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9498, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4522/5195 (87.0452%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4649/5195 (89.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1131, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4118/4679 (88.0103%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4138/4679 (88.4377%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0036, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3178/3646 (87.1640%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3280/3646 (89.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8765, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3157/3616 (87.3064%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3247/3616 (89.7954%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8913, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4042/4716 (85.7082%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4119/4716 (87.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9098, Accuracy: 5537/10000 (55.3700%)
time spent on training: 236.06350898742676
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2164, Accuracy: 6842/10000 (68.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.8000, Accuracy: 37/9900 (0.3737%)
Done in 260.22074365615845 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.57000639342139.
Norm before scaling: 42.574419276812364. Distance: 2.124546563632744
Total norm for 4 adversaries is: 42.574419276812364. distance: 2.124546563632744
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1210, Accuracy: 9590/9900 (96.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 42.57000639342139.
Norm before scaling: 42.56604186346054. Distance: 2.1561864207748904
Total norm for 4 adversaries is: 42.56604186346054. distance: 2.1561864207748904
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1158, Accuracy: 9609/9900 (97.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4198/4717 (88.9972%), train_poison_data_count: 370
Global model norm: 42.57000639342139.
Norm before scaling: 42.57257848047922. Distance: 2.1028373850351842
Total norm for 4 adversaries is: 42.57257848047922. distance: 2.1028373850351842
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1848, Accuracy: 9420/9900 (95.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 42.57000639342139.
Norm before scaling: 42.57908685840165. Distance: 2.2925146325828956
Total norm for 4 adversaries is: 42.57908685840165. distance: 2.2925146325828956
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2143, Accuracy: 9346/9900 (94.4040%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5247/6124 (85.6793%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5338/6124 (87.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0032, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3912/4433 (88.2472%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4009/4433 (90.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0100, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3365/3781 (88.9976%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3275/3781 (86.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2614, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3547/3969 (89.3676%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3581/3969 (90.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9100, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4442/5025 (88.3980%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4546/5025 (90.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1351, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4148/4679 (88.6514%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4163/4679 (88.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0238, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4163/4707 (88.4427%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4275/4707 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9121, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4380/4986 (87.8460%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4428/4986 (88.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9868, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3866/4315 (89.5944%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3952/4315 (91.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8018, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3805/4416 (86.1639%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3901/4416 (88.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9423, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4235/4804 (88.1557%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4069/4804 (84.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1645, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4157/4793 (86.7306%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4254/4793 (88.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9528, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4515/5232 (86.2959%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4576/5232 (87.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9114, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4102/4662 (87.9880%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4238/4662 (90.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0843, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4214/4956 (85.0282%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4335/4956 (87.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1922, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3826/4368 (87.5916%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3869/4368 (88.5760%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0416, Accuracy: 5299/10000 (52.9900%)
time spent on training: 235.91058349609375
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2246, Accuracy: 6856/10000 (68.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.8721, Accuracy: 41/9900 (0.4141%)
Done in 259.9628071784973 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4365/4885 (89.3552%), train_poison_data_count: 385
Global model norm: 42.60796975818095.
Norm before scaling: 42.61200343699017. Distance: 2.1456360463925614
Total norm for 4 adversaries is: 42.61200343699017. distance: 2.1456360463925614
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2298, Accuracy: 9324/9900 (94.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 42.60796975818095.
Norm before scaling: 42.60761163613771. Distance: 2.1683852886726185
Total norm for 4 adversaries is: 42.60761163613771. distance: 2.1683852886726185
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2125, Accuracy: 9344/9900 (94.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 42.60796975818095.
Norm before scaling: 42.60696414384258. Distance: 2.0593496596031993
Total norm for 4 adversaries is: 42.60696414384258. distance: 2.0593496596031993
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1865, Accuracy: 9406/9900 (95.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 42.60796975818095.
Norm before scaling: 42.616984847135036. Distance: 2.2723976719881103
Total norm for 4 adversaries is: 42.616984847135036. distance: 2.2723976719881103
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1574, Accuracy: 9492/9900 (95.8788%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5289/6124 (86.3651%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5347/6124 (87.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0232, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5064/5902 (85.8014%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5110/5902 (86.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0829, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4171/4707 (88.6127%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4243/4707 (90.1423%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8403, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4061/4647 (87.3897%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4141/4647 (89.1113%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8696, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2925/3297 (88.7170%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3017/3297 (91.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7959, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5533/6263 (88.3442%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5625/6263 (89.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3972, Accuracy: 4952/10000 (49.5200%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4129/4663 (88.5481%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4234/4663 (90.7999%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1693, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4303/4956 (86.8241%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4321/4956 (87.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0488, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3612/4046 (89.2734%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3708/4046 (91.6461%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9717, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3701/4184 (88.4560%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3775/4184 (90.2247%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7922, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4846/5591 (86.6750%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4895/5591 (87.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2406, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4079/4634 (88.0233%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4184/4634 (90.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9492, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3344/3828 (87.3563%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3469/3828 (90.6217%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8846, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3096/3638 (85.1017%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3244/3638 (89.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8409, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3343/3781 (88.4158%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3363/3781 (88.9447%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3252, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3381/3837 (88.1157%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3526/3837 (91.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9570, Accuracy: 5554/10000 (55.5400%)
time spent on training: 234.61847233772278
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1960, Accuracy: 6911/10000 (69.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.7975, Accuracy: 54/9900 (0.5455%)
Done in 258.4672644138336 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 42.65233498517402.
Norm before scaling: 42.65435120544928. Distance: 2.090098827161004
Total norm for 4 adversaries is: 42.65435120544928. distance: 2.090098827161004
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2072, Accuracy: 9404/9900 (94.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 42.65233498517402.
Norm before scaling: 42.65423673133552. Distance: 2.1628437673058314
Total norm for 4 adversaries is: 42.65423673133552. distance: 2.1628437673058314
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1608, Accuracy: 9499/9900 (95.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4200/4717 (89.0396%), train_poison_data_count: 370
Global model norm: 42.65233498517402.
Norm before scaling: 42.653195002781594. Distance: 2.0619259815787574
Total norm for 4 adversaries is: 42.653195002781594. distance: 2.0619259815787574
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1217, Accuracy: 9583/9900 (96.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 42.65233498517402.
Norm before scaling: 42.65675652171793. Distance: 2.2179576909782854
Total norm for 4 adversaries is: 42.65675652171793. distance: 2.2179576909782854
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1860, Accuracy: 9428/9900 (95.2323%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3894/4501 (86.5141%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3935/4501 (87.4250%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0332, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3654/4175 (87.5210%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3724/4175 (89.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9127, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3138/3616 (86.7810%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3246/3616 (89.7677%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8849, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4059/4634 (87.5917%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4173/4634 (90.0518%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9756, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3944/4558 (86.5292%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3979/4558 (87.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1427, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4548/5167 (88.0201%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4598/5167 (88.9878%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2541, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3937/4356 (90.3811%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3909/4356 (89.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0824, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4107/4716 (87.0865%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4186/4716 (88.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9816, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5307/6124 (86.6590%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5326/6124 (86.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1136, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4400/5055 (87.0425%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4549/5055 (89.9901%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9780, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4491/5025 (89.3731%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4585/5025 (91.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2633, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4331/4918 (88.0643%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4401/4918 (89.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2550, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3702/4223 (87.6628%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3807/4223 (90.1492%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9144, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3957/4481 (88.3062%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3909/4481 (87.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0197, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3178/3638 (87.3557%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3300/3638 (90.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9889, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3566/4013 (88.8612%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3686/4013 (91.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8573, Accuracy: 5658/10000 (56.5800%)
time spent on training: 233.32418155670166
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1831, Accuracy: 6960/10000 (69.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 10.1811, Accuracy: 37/9900 (0.3737%)
Done in 257.24179458618164 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4409/4885 (90.2559%), train_poison_data_count: 385
Global model norm: 42.69710011696857.
Norm before scaling: 42.699195700581555. Distance: 2.0826133501177955
Total norm for 4 adversaries is: 42.699195700581555. distance: 2.0826133501177955
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2317, Accuracy: 9344/9900 (94.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 42.69710011696857.
Norm before scaling: 42.6974489115531. Distance: 2.1608841344018357
Total norm for 4 adversaries is: 42.6974489115531. distance: 2.1608841344018357
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2637, Accuracy: 9284/9900 (93.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4222/4717 (89.5060%), train_poison_data_count: 370
Global model norm: 42.69710011696857.
Norm before scaling: 42.69866252296435. Distance: 2.0436627757273347
Total norm for 4 adversaries is: 42.69866252296435. distance: 2.0436627757273347
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2875, Accuracy: 9197/9900 (92.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.69710011696857.
Norm before scaling: 42.70307783339876. Distance: 2.2482440242274335
Total norm for 4 adversaries is: 42.70307783339876. distance: 2.2482440242274335
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1202, Accuracy: 9580/9900 (96.7677%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3178/3646 (87.1640%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3313/3646 (90.8667%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8013, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3909/4501 (86.8474%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4036/4501 (89.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0140, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4027/4651 (86.5835%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4159/4651 (89.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9666, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4571/5167 (88.4653%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4690/5167 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0442, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4817/5455 (88.3043%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4855/5455 (89.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0951, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4871/5591 (87.1222%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4901/5591 (87.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0387, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4195/4679 (89.6559%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4211/4679 (89.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1023, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4460/5017 (88.8977%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4527/5017 (90.2332%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9145, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4191/4793 (87.4400%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4293/4793 (89.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0696, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3986/4456 (89.4524%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4055/4456 (91.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9462, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4801/5424 (88.5140%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4935/5424 (90.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1156, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3627/4175 (86.8743%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3646/4175 (87.3293%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0211, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4463/5116 (87.2361%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4564/5116 (89.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9910, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3255/3704 (87.8780%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3338/3704 (90.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9081, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4463/5232 (85.3020%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4654/5232 (88.9526%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0790, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3082/3472 (88.7673%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3164/3472 (91.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9995, Accuracy: 5532/10000 (55.3200%)
time spent on training: 235.56465816497803
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2161, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 10.0690, Accuracy: 57/9900 (0.5758%)
Done in 259.34909653663635 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.72962296476459.
Norm before scaling: 42.731746948441334. Distance: 2.079283083279277
Total norm for 4 adversaries is: 42.731746948441334. distance: 2.079283083279277
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3095, Accuracy: 9125/9900 (92.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.72962296476459.
Norm before scaling: 42.729620107956876. Distance: 2.178690692665634
Total norm for 4 adversaries is: 42.729620107956876. distance: 2.178690692665634
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2297, Accuracy: 9342/9900 (94.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4224/4717 (89.5484%), train_poison_data_count: 370
Global model norm: 42.72962296476459.
Norm before scaling: 42.72964296241325. Distance: 2.0405185221864532
Total norm for 4 adversaries is: 42.72964296241325. distance: 2.0405185221864532
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1542, Accuracy: 9520/9900 (96.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4481/5066 (88.4524%), train_poison_data_count: 400
Global model norm: 42.72962296476459.
Norm before scaling: 42.73635735804322. Distance: 2.2324032920404386
Total norm for 4 adversaries is: 42.73635735804322. distance: 2.2324032920404386
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3066, Accuracy: 9097/9900 (91.8889%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3216/3590 (89.5822%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3346/3590 (93.2033%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9307, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3840/4368 (87.9121%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3864/4368 (88.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8888, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3255/3704 (87.8780%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3327/3704 (89.8218%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9298, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4318/4928 (87.6218%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4400/4928 (89.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0474, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3970/4356 (91.1387%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3945/4356 (90.5647%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1488, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3501/3911 (89.5167%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3444/3911 (88.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1837, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4054/4651 (87.1641%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4189/4651 (90.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1411, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3695/4184 (88.3126%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3792/4184 (90.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8207, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3897/4346 (89.6687%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4027/4346 (92.6599%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8858, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4156/4793 (86.7098%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4349/4793 (90.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0096, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3364/3804 (88.4332%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3477/3804 (91.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0586, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4441/4986 (89.0694%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4495/4986 (90.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9325, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5437/6124 (88.7818%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5442/6124 (88.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0759, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4153/4707 (88.2303%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4239/4707 (90.0574%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8568, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3777/4235 (89.1854%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3685/4235 (87.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0852, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3606/4046 (89.1251%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3716/4046 (91.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9977, Accuracy: 5407/10000 (54.0700%)
time spent on training: 228.29517912864685
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2998, Accuracy: 6679/10000 (66.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 10.0939, Accuracy: 44/9900 (0.4444%)
Done in 252.15928196907043 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.760660905717415.
Norm before scaling: 42.762883258385564. Distance: 2.1136084001915663
Total norm for 4 adversaries is: 42.762883258385564. distance: 2.1136084001915663
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1123, Accuracy: 9601/9900 (96.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.760660905717415.
Norm before scaling: 42.76374961635146. Distance: 2.180954978250808
Total norm for 4 adversaries is: 42.76374961635146. distance: 2.180954978250808
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1037, Accuracy: 9635/9900 (97.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.760660905717415.
Norm before scaling: 42.758879514596146. Distance: 2.0150353803912515
Total norm for 4 adversaries is: 42.758879514596146. distance: 2.0150353803912515
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.4006, Accuracy: 8963/9900 (90.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 42.760660905717415.
Norm before scaling: 42.76795127487404. Distance: 2.2711986516208817
Total norm for 4 adversaries is: 42.76795127487404. distance: 2.2711986516208817
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2362, Accuracy: 9288/9900 (93.8182%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4426/4986 (88.7686%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4493/4986 (90.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9834, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4037/4634 (87.1170%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4133/4634 (89.1886%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9823, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4122/4716 (87.4046%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4235/4716 (89.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1070, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5403/6124 (88.2266%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5461/6124 (89.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9792, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4367/4918 (88.7963%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4508/4918 (91.6633%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9125, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3330/3797 (87.7008%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3427/3797 (90.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9810, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4952/5582 (88.7137%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4992/5582 (89.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1971, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4278/4956 (86.3196%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4337/4956 (87.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0428, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3932/4433 (88.6984%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4019/4433 (90.6610%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9279, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3817/4354 (87.6665%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3532/4354 (81.1208%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2733, Accuracy: 4960/10000 (49.6000%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4276/4928 (86.7695%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4414/4928 (89.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8567, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3522/3911 (90.0537%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3524/3911 (90.1048%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9275, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3888/4481 (86.7663%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0501, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4559/5197 (87.7237%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4605/5197 (88.6088%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0140, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4813/5455 (88.2310%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4894/5455 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0746, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3759/4361 (86.1958%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3764/4361 (86.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2664, Accuracy: 5038/10000 (50.3800%)
time spent on training: 238.17715549468994
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.3067, Accuracy: 6677/10000 (66.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 10.1237, Accuracy: 63/9900 (0.6364%)
Done in 261.895302772522 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 42.80258353448495.
Norm before scaling: 42.80532273324049. Distance: 2.1058395710309172
Total norm for 4 adversaries is: 42.80532273324049. distance: 2.1058395710309172
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2041, Accuracy: 9413/9900 (95.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.80258353448495.
Norm before scaling: 42.80326942006737. Distance: 2.180356924428111
Total norm for 4 adversaries is: 42.80326942006737. distance: 2.180356924428111
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1622, Accuracy: 9479/9900 (95.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4217/4717 (89.4000%), train_poison_data_count: 370
Global model norm: 42.80258353448495.
Norm before scaling: 42.80212151804292. Distance: 2.067770149082053
Total norm for 4 adversaries is: 42.80212151804292. distance: 2.067770149082053
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1329, Accuracy: 9558/9900 (96.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4459/5066 (88.0182%), train_poison_data_count: 400
Global model norm: 42.80258353448495.
Norm before scaling: 42.80859499754766. Distance: 2.2783652054688175
Total norm for 4 adversaries is: 42.80859499754766. distance: 2.2783652054688175
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2213, Accuracy: 9359/9900 (94.5354%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4267/4928 (86.5869%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4385/4928 (88.9813%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0889, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3695/4184 (88.3126%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3751/4184 (89.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9351, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4180/4707 (88.8039%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4208/4707 (89.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1549, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3353/3828 (87.5914%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8523, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3935/4503 (87.3862%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3994/4503 (88.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0463, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4104/4662 (88.0309%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4226/4662 (90.6478%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8740, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3714/4235 (87.6978%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3815/4235 (90.0826%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9784, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4393/5244 (83.7719%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4489/5244 (85.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9969, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4200/4793 (87.6278%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4345/4793 (90.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9919, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3969/4481 (88.5740%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3976/4481 (88.7302%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1009, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3912/4346 (90.0138%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4014/4346 (92.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7440, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3805/4361 (87.2506%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3794/4361 (86.9984%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0925, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4484/5055 (88.7043%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8503, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4495/5195 (86.5255%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4546/5195 (87.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2012, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3882/4315 (89.9652%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3982/4315 (92.2827%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0322, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4165/4663 (89.3202%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4268/4663 (91.5291%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1435, Accuracy: 5252/10000 (52.5200%)
time spent on training: 233.34128832817078
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.2803, Accuracy: 6689/10000 (66.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.9624, Accuracy: 64/9900 (0.6465%)
Done in 257.19789600372314 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 42.844633242172236.
Norm before scaling: 42.845213038021384. Distance: 2.051833923467835
Total norm for 4 adversaries is: 42.845213038021384. distance: 2.051833923467835
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1818, Accuracy: 9458/9900 (95.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 42.844633242172236.
Norm before scaling: 42.84678571256469. Distance: 2.173065737337806
Total norm for 4 adversaries is: 42.84678571256469. distance: 2.173065737337806
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3561, Accuracy: 9075/9900 (91.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 42.844633242172236.
Norm before scaling: 42.84208746090476. Distance: 1.9865001202652168
Total norm for 4 adversaries is: 42.84208746090476. distance: 1.9865001202652168
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1662, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4499/5066 (88.8077%), train_poison_data_count: 400
Global model norm: 42.844633242172236.
Norm before scaling: 42.84995082999294. Distance: 2.2363401720813614
Total norm for 4 adversaries is: 42.84995082999294. distance: 2.2363401720813614
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1128, Accuracy: 9583/9900 (96.7980%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3902/4315 (90.4287%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3964/4315 (91.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9290, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3219/3590 (89.6657%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3168/3590 (88.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1607, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4229/4679 (90.3826%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4255/4679 (90.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9213, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4564/5167 (88.3298%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4659/5167 (90.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0142, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3330/3775 (88.2119%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3518/3775 (93.1921%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7890, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3363/3828 (87.8527%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3486/3828 (91.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9334, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3742/4235 (88.3589%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3873/4235 (91.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8533, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4090/4647 (88.0138%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4205/4647 (90.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9400, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4309/4918 (87.6169%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4467/4918 (90.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9898, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4045/4433 (91.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8938, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3938/4481 (87.8822%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3976/4481 (88.7302%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1294, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3747/4295 (87.2410%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3600/4295 (83.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1528, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3990/4503 (88.6076%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4039/4503 (89.6958%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0336, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3884/4354 (89.2053%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3726/4354 (85.5765%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4349, Accuracy: 4801/10000 (48.0100%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4429/4986 (88.8287%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4460/4986 (89.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0818, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5508/6263 (87.9451%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5720/6263 (91.3300%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9997, Accuracy: 5443/10000 (54.4300%)
time spent on training: 232.04513955116272
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.3545, Accuracy: 6615/10000 (66.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.9261, Accuracy: 94/9900 (0.9495%)
Done in 255.87258553504944 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4395/4885 (89.9693%), train_poison_data_count: 385
Global model norm: 42.88120200450965.
Norm before scaling: 42.88197487909401. Distance: 2.1212369473560972
Total norm for 4 adversaries is: 42.88197487909401. distance: 2.1212369473560972
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1539, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4701/5305 (88.6145%), train_poison_data_count: 415
Global model norm: 42.88120200450965.
Norm before scaling: 42.884615073018175. Distance: 2.2936224712291566
Total norm for 4 adversaries is: 42.884615073018175. distance: 2.2936224712291566
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0628, Accuracy: 9750/9900 (98.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4241/4717 (89.9088%), train_poison_data_count: 370
Global model norm: 42.88120200450965.
Norm before scaling: 42.88103262497739. Distance: 2.028277173086321
Total norm for 4 adversaries is: 42.88103262497739. distance: 2.028277173086321
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1885, Accuracy: 9441/9900 (95.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 42.88120200450965.
Norm before scaling: 42.884326154056566. Distance: 2.2152924797928177
Total norm for 4 adversaries is: 42.884326154056566. distance: 2.2152924797928177
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0773, Accuracy: 9701/9900 (97.9899%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3693/4223 (87.4497%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3859/4223 (91.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9663, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4853/5455 (88.9643%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4828/5455 (88.5060%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2253, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4974/5582 (89.1078%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5105/5582 (91.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0338, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3942/4465 (88.2867%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4064/4465 (91.0190%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8320, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4906/5591 (87.7482%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4948/5591 (88.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2867, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3521/3911 (90.0281%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3328/3911 (85.0933%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0922, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4010/4356 (92.0569%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3431/4356 (78.7649%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.4330, Accuracy: 4757/10000 (47.5700%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4390/5037 (87.1551%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4546/5037 (90.2521%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8739, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4229/4679 (90.3826%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4337/4679 (92.6907%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0084, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3927/4362 (90.0275%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3853/4362 (88.3310%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2559, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4054/4518 (89.7300%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4134/4518 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0139, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4497/5083 (88.4714%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4538/5083 (89.2780%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0474, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3543/4013 (88.2881%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3698/4013 (92.1505%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7469, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4552/5197 (87.5890%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4640/5197 (89.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0589, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2906/3297 (88.1407%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3039/3297 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8725, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3955/4441 (89.0565%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4040/4441 (90.9705%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0934, Accuracy: 5422/10000 (54.2200%)
time spent on training: 235.25408554077148
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.4351, Accuracy: 6500/10000 (65.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.9108, Accuracy: 62/9900 (0.6263%)
Done in 258.8089451789856 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4366/4885 (89.3756%), train_poison_data_count: 385
Global model norm: 42.92287181450803.
Norm before scaling: 42.923339641009996. Distance: 2.1042961861308505
Total norm for 4 adversaries is: 42.923339641009996. distance: 2.1042961861308505
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2180, Accuracy: 9378/9900 (94.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 42.92287181450803.
Norm before scaling: 42.9213844051868. Distance: 2.18736408356353
Total norm for 4 adversaries is: 42.9213844051868. distance: 2.18736408356353
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2358, Accuracy: 9335/9900 (94.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 42.92287181450803.
Norm before scaling: 42.921237936662834. Distance: 2.030255235495908
Total norm for 4 adversaries is: 42.921237936662834. distance: 2.030255235495908
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3749, Accuracy: 8975/9900 (90.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4450/5066 (87.8405%), train_poison_data_count: 400
Global model norm: 42.92287181450803.
Norm before scaling: 42.92611663379081. Distance: 2.272019825848862
Total norm for 4 adversaries is: 42.92611663379081. distance: 2.272019825848862
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2672, Accuracy: 9235/9900 (93.2828%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3950/4501 (87.7583%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4043/4501 (89.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0689, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3914/4511 (86.7657%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4089/4511 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9081, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3978/4354 (91.3643%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3573/4354 (82.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4529, Accuracy: 4625/10000 (46.2500%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3864/4346 (88.9093%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4017/4346 (92.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8513, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4140/4707 (87.9541%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4254/4707 (90.3760%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9301, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4871/5591 (87.1222%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4930/5591 (88.1774%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0189, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4053/4647 (87.2176%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4201/4647 (90.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8401, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4026/4538 (88.7175%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4170/4538 (91.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9167, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4276/4934 (86.6640%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4376/4934 (88.6907%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0225, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4350/4804 (90.5495%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4311/4804 (89.7377%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1180, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5569/6263 (88.9190%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5709/6263 (91.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1681, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3954/4481 (88.2392%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3978/4481 (88.7748%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0909, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4361/5063 (86.1347%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4454/5063 (87.9716%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9279, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3670/4223 (86.9050%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3881/4223 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0098, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3975/4441 (89.5069%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4048/4441 (91.1506%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1438, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3332/3756 (88.7114%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3463/3756 (92.1991%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9603, Accuracy: 5590/10000 (55.9000%)
time spent on training: 235.64520049095154
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.4286, Accuracy: 6527/10000 (65.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 10.0916, Accuracy: 84/9900 (0.8485%)
Done in 260.16771602630615 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4377/4885 (89.6008%), train_poison_data_count: 385
Global model norm: 42.96334625112143.
Norm before scaling: 42.967221563725175. Distance: 2.177015300460408
Total norm for 4 adversaries is: 42.967221563725175. distance: 2.177015300460408
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1445, Accuracy: 9537/9900 (96.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4708/5305 (88.7465%), train_poison_data_count: 415
Global model norm: 42.96334625112143.
Norm before scaling: 42.96321697330534. Distance: 2.2859983799846044
Total norm for 4 adversaries is: 42.96321697330534. distance: 2.2859983799846044
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0670, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4214/4717 (89.3364%), train_poison_data_count: 370
Global model norm: 42.96334625112143.
Norm before scaling: 42.965853595562514. Distance: 2.0792326305783506
Total norm for 4 adversaries is: 42.965853595562514. distance: 2.0792326305783506
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2470, Accuracy: 9277/9900 (93.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.96334625112143.
Norm before scaling: 42.96951135689118. Distance: 2.3100210770144978
Total norm for 4 adversaries is: 42.96951135689118. distance: 2.3100210770144978
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1731, Accuracy: 9431/9900 (95.2626%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4528/5244 (86.3463%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4647/5244 (88.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9590, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4299/4928 (87.2362%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4506/4928 (91.4367%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8293, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3367/3804 (88.5121%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0295, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3555/4013 (88.5871%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3652/4013 (91.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9294, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3520/4158 (84.6561%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3621/4158 (87.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9156, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4981/5582 (89.2332%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5033/5582 (90.1648%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0610, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4812/5455 (88.2126%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4926/5455 (90.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9874, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4057/4354 (93.1787%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3908/4354 (89.7565%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2016, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3910/4433 (88.2021%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3994/4433 (90.0970%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0033, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3156/3646 (86.5606%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3333/3646 (91.4152%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8950, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4004/4518 (88.6233%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4061/4518 (89.8849%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1016, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3738/4235 (88.2645%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3756/4235 (88.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2933, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3916/4362 (89.7753%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3925/4362 (89.9817%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9564, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4766/5392 (88.3902%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4758/5392 (88.2418%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1302, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4834/5591 (86.4604%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4865/5591 (87.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0822, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3304/3756 (87.9659%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3425/3756 (91.1874%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0369, Accuracy: 5530/10000 (55.3000%)
time spent on training: 234.84723734855652
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.4191, Accuracy: 6510/10000 (65.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 10.4296, Accuracy: 78/9900 (0.7879%)
Done in 258.6526424884796 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4375/4885 (89.5599%), train_poison_data_count: 385
Global model norm: 42.99372427632244.
Norm before scaling: 42.99739528130236. Distance: 2.1403249265755893
Total norm for 4 adversaries is: 42.99739528130236. distance: 2.1403249265755893
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1267, Accuracy: 9568/9900 (96.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4709/5305 (88.7653%), train_poison_data_count: 415
Global model norm: 42.99372427632244.
Norm before scaling: 42.99557543324589. Distance: 2.29465257728473
Total norm for 4 adversaries is: 42.99557543324589. distance: 2.29465257728473
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0285, Accuracy: 9820/9900 (99.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4172/4717 (88.4460%), train_poison_data_count: 370
Global model norm: 42.99372427632244.
Norm before scaling: 42.99714260809592. Distance: 2.15908328789639
Total norm for 4 adversaries is: 42.99714260809592. distance: 2.15908328789639
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1280, Accuracy: 9583/9900 (96.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4440/5066 (87.6431%), train_poison_data_count: 400
Global model norm: 42.99372427632244.
Norm before scaling: 43.00218301598914. Distance: 2.3924955143582536
Total norm for 4 adversaries is: 43.00218301598914. distance: 2.3924955143582536
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0884, Accuracy: 9672/9900 (97.6970%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4086/4634 (88.1744%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4189/4634 (90.3971%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8963, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3998/4503 (88.7853%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4003/4503 (88.8963%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0253, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4264/4928 (86.5260%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4509/4928 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7939, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3321/3804 (87.3028%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3441/3804 (90.4574%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9492, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3161/3590 (88.0501%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3109/3590 (86.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2101, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4235/4647 (91.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8747, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3921/4625 (84.7784%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4025/4625 (87.0270%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0410, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4047/4356 (92.9063%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4066/4356 (93.3425%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0372, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3345/3797 (88.0959%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8968, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3966/4456 (89.0036%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4072/4456 (91.3824%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0103, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3527/4025 (87.6273%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3683/4025 (91.5031%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8326, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3077/3472 (88.6233%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3128/3472 (90.0922%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9508, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2857/3297 (86.6545%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3018/3297 (91.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8391, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3834/4416 (86.8207%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3974/4416 (89.9909%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0040, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3956/4356 (90.8173%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4081/4356 (93.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9924, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3142/3638 (86.3661%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8154, Accuracy: 5670/10000 (56.7000%)
time spent on training: 231.90461659431458
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.4244, Accuracy: 6488/10000 (64.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 10.2968, Accuracy: 68/9900 (0.6869%)
Done in 256.6865029335022 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4349/4885 (89.0276%), train_poison_data_count: 385
Global model norm: 43.02854220556325.
Norm before scaling: 43.03270098997026. Distance: 2.1870703138953633
Total norm for 4 adversaries is: 43.03270098997026. distance: 2.1870703138953633
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1775, Accuracy: 9486/9900 (95.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4712/5305 (88.8219%), train_poison_data_count: 415
Global model norm: 43.02854220556325.
Norm before scaling: 43.03036633306545. Distance: 2.2286606924463994
Total norm for 4 adversaries is: 43.03036633306545. distance: 2.2286606924463994
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1334, Accuracy: 9550/9900 (96.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 43.02854220556325.
Norm before scaling: 43.024624183516266. Distance: 2.0506187156573974
Total norm for 4 adversaries is: 43.024624183516266. distance: 2.0506187156573974
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1177, Accuracy: 9583/9900 (96.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 43.02854220556325.
Norm before scaling: 43.03485823652147. Distance: 2.275006044819944
Total norm for 4 adversaries is: 43.03485823652147. distance: 2.275006044819944
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1259, Accuracy: 9591/9900 (96.8788%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3619/4175 (86.6826%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3678/4175 (88.0958%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9755, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4247/4956 (85.6941%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4416/4956 (89.1041%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1105, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4358/5037 (86.5198%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4584/5037 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9598, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4164/4793 (86.8767%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4288/4793 (89.4638%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0760, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3320/3804 (87.2766%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3429/3804 (90.1420%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0167, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4728/5392 (87.6855%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4829/5392 (89.5586%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9679, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3952/4465 (88.5106%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4064/4465 (91.0190%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9229, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4089/4596 (88.9687%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4186/4596 (91.0792%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0231, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5391/6124 (88.0307%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5475/6124 (89.4024%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8993, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2832/3271 (86.5790%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2933/3271 (89.6668%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0245, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3163/3590 (88.1058%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3238/3590 (90.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0177, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3844/4501 (85.4032%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4021/4501 (89.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0476, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4505/5232 (86.1047%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4584/5232 (87.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0420, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3203/3672 (87.2277%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3264/3672 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0738, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3720/4223 (88.0890%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3838/4223 (90.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0159, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4120/4354 (94.6256%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0128, Accuracy: 3359/4354 (77.1475%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.5549, Accuracy: 4622/10000 (46.2200%)
time spent on training: 236.03580379486084
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.4962, Accuracy: 6435/10000 (64.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.2483, Accuracy: 246/9900 (2.4848%)
Done in 260.82724809646606 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4389/4885 (89.8465%), train_poison_data_count: 385
Global model norm: 43.074822200645094.
Norm before scaling: 43.07821992871296. Distance: 2.1335130595953395
Total norm for 4 adversaries is: 43.07821992871296. distance: 2.1335130595953395
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.3387, Accuracy: 9084/9900 (91.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 43.074822200645094.
Norm before scaling: 43.075158018064776. Distance: 2.1903885434861885
Total norm for 4 adversaries is: 43.075158018064776. distance: 2.1903885434861885
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1002, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4174/4717 (88.4884%), train_poison_data_count: 370
Global model norm: 43.074822200645094.
Norm before scaling: 43.07748883054016. Distance: 2.1681077517375678
Total norm for 4 adversaries is: 43.07748883054016. distance: 2.1681077517375678
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0660, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4448/5066 (87.8010%), train_poison_data_count: 400
Global model norm: 43.074822200645094.
Norm before scaling: 43.08227049785097. Distance: 2.2977363891530476
Total norm for 4 adversaries is: 43.08227049785097. distance: 2.2977363891530476
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1391, Accuracy: 9554/9900 (96.5051%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4916/5582 (88.0688%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5029/5582 (90.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1203, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3986/4647 (85.7758%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4185/4647 (90.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9448, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3907/4465 (87.5028%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4086/4465 (91.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8520, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4406/5083 (86.6811%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4509/5083 (88.7075%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0375, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3755/4416 (85.0317%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3922/4416 (88.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9573, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4218/4956 (85.1090%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4389/4956 (88.5593%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1114, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3868/4362 (88.6749%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3813/4362 (87.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0571, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4013/4356 (92.1258%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3920/4356 (89.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1085, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3294/3781 (87.1198%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3442/3781 (91.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1473, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3151/3590 (87.7716%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3244/3590 (90.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9846, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4079/4651 (87.7016%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4193/4651 (90.1527%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9860, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4059/4662 (87.0656%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4267/4662 (91.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9133, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3052/3472 (87.9032%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3234/3472 (93.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8914, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4811/5424 (88.6984%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4999/5424 (92.1645%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1112, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2857/3271 (87.3433%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2950/3271 (90.1865%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8432, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4343/5037 (86.2220%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4528/5037 (89.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9222, Accuracy: 5514/10000 (55.1400%)
time spent on training: 232.925696849823
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.4707, Accuracy: 6400/10000 (64.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 9.0954, Accuracy: 235/9900 (2.3737%)
Done in 256.72717785835266 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4369/4885 (89.4371%), train_poison_data_count: 385
Global model norm: 43.106275656527814.
Norm before scaling: 43.10810498990082. Distance: 2.130581425931526
Total norm for 4 adversaries is: 43.10810498990082. distance: 2.130581425931526
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2270, Accuracy: 9312/9900 (94.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4718/5305 (88.9350%), train_poison_data_count: 415
Global model norm: 43.106275656527814.
Norm before scaling: 43.107446608735714. Distance: 2.2357068127429334
Total norm for 4 adversaries is: 43.107446608735714. distance: 2.2357068127429334
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1985, Accuracy: 9382/9900 (94.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4224/4717 (89.5484%), train_poison_data_count: 370
Global model norm: 43.106275656527814.
Norm before scaling: 43.1039619766668. Distance: 2.0326807705114764
Total norm for 4 adversaries is: 43.1039619766668. distance: 2.0326807705114764
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3178, Accuracy: 9136/9900 (92.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4436/5066 (87.5642%), train_poison_data_count: 400
Global model norm: 43.106275656527814.
Norm before scaling: 43.1135203244368. Distance: 2.3154091964838237
Total norm for 4 adversaries is: 43.1135203244368. distance: 2.3154091964838237
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.4154, Accuracy: 8874/9900 (89.6364%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4283/4989 (85.8489%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4447/4989 (89.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9062, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3554/4013 (88.5622%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3707/4013 (92.3748%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8606, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4446/5195 (85.5823%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4436/5195 (85.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0555, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3484/3969 (87.7803%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3551/3969 (89.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9156, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4087/4356 (93.8246%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4144/4356 (95.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9421, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3910/4441 (88.0432%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4005/4441 (90.1824%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0410, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4022/4518 (89.0217%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4124/4518 (91.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9846, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3451/3911 (88.2383%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3342/3911 (85.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0429, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3872/4362 (88.7666%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3908/4362 (89.5919%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1563, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3336/3804 (87.6972%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3447/3804 (90.6151%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9259, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3662/4223 (86.7156%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3874/4223 (91.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9908, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4059/4634 (87.5917%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4194/4634 (90.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8340, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4153/4354 (95.3836%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3686/4354 (84.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3780, Accuracy: 4934/10000 (49.3400%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4423/5244 (84.3440%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4616/5244 (88.0244%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8790, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4373/5037 (86.8176%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4595/5037 (91.2249%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9299, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3174/3704 (85.6911%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3330/3704 (89.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9401, Accuracy: 5489/10000 (54.8900%)
time spent on training: 230.8839111328125
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5881, Accuracy: 6252/10000 (62.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.7526, Accuracy: 287/9900 (2.8990%)
Done in 254.59512376785278 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4368/4885 (89.4166%), train_poison_data_count: 385
Global model norm: 43.14514503439596.
Norm before scaling: 43.14702081573463. Distance: 2.165408600623404
Total norm for 4 adversaries is: 43.14702081573463. distance: 2.165408600623404
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2021, Accuracy: 9398/9900 (94.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4702/5305 (88.6334%), train_poison_data_count: 415
Global model norm: 43.14514503439596.
Norm before scaling: 43.149473637523236. Distance: 2.2573989436616486
Total norm for 4 adversaries is: 43.149473637523236. distance: 2.2573989436616486
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1412, Accuracy: 9568/9900 (96.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4195/4717 (88.9336%), train_poison_data_count: 370
Global model norm: 43.14514503439596.
Norm before scaling: 43.14402886336069. Distance: 2.0938409813998304
Total norm for 4 adversaries is: 43.14402886336069. distance: 2.0938409813998304
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1664, Accuracy: 9446/9900 (95.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 43.14514503439596.
Norm before scaling: 43.15071272631615. Distance: 2.28408877227283
Total norm for 4 adversaries is: 43.15071272631615. distance: 2.28408877227283
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2763, Accuracy: 9219/9900 (93.1212%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3778/4416 (85.5525%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3910/4416 (88.5417%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9138, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4504/5197 (86.6654%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4643/5197 (89.3400%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0213, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4249/4918 (86.3969%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4441/4918 (90.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1086, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5539/6263 (88.4400%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5648/6263 (90.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0828, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3107/3646 (85.2167%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3304/3646 (90.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8367, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4138/4707 (87.9116%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4236/4707 (89.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0147, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4337/5063 (85.6607%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4286/5063 (84.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1757, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3652/4295 (85.0291%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3827/4295 (89.1036%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0217, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4136/4793 (86.2925%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4320/4793 (90.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1527, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4010/4538 (88.3649%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4159/4538 (91.6483%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9106, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4421/5083 (86.9762%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4525/5083 (89.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9087, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3111/3638 (85.5140%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3230/3638 (88.7850%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8559, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5320/6124 (86.8713%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5431/6124 (88.6839%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9760, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3990/4618 (86.4010%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4073/4618 (88.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0472, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3496/3969 (88.0826%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3539/3969 (89.1660%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9372, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3471/4158 (83.4776%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3652/4158 (87.8307%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8962, Accuracy: 5490/10000 (54.9000%)
time spent on training: 237.003187417984
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.4889, Accuracy: 6385/10000 (63.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.0632, Accuracy: 251/9900 (2.5354%)
Done in 260.83090806007385 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4337/4885 (88.7820%), train_poison_data_count: 385
Global model norm: 43.184109456723924.
Norm before scaling: 43.18939513976854. Distance: 2.152347073145688
Total norm for 4 adversaries is: 43.18939513976854. distance: 2.152347073145688
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2847, Accuracy: 9211/9900 (93.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4681/5305 (88.2375%), train_poison_data_count: 415
Global model norm: 43.184109456723924.
Norm before scaling: 43.18661811690052. Distance: 2.2699858691073973
Total norm for 4 adversaries is: 43.18661811690052. distance: 2.2699858691073973
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1789, Accuracy: 9430/9900 (95.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4189/4717 (88.8064%), train_poison_data_count: 370
Global model norm: 43.184109456723924.
Norm before scaling: 43.1811342088475. Distance: 2.071468735761195
Total norm for 4 adversaries is: 43.1811342088475. distance: 2.071468735761195
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2651, Accuracy: 9171/9900 (92.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4453/5066 (87.8997%), train_poison_data_count: 400
Global model norm: 43.184109456723924.
Norm before scaling: 43.18939090017507. Distance: 2.278220791366071
Total norm for 4 adversaries is: 43.18939090017507. distance: 2.278220791366071
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2966, Accuracy: 9159/9900 (92.5152%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4020/4716 (85.2417%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4225/4716 (89.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0520, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3913/4481 (87.3243%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3954/4481 (88.2392%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9538, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3792/4361 (86.9525%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3719/4361 (85.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0146, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4156/4793 (86.7098%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4345/4793 (90.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0504, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3727/4295 (86.7753%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3745/4295 (87.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0727, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4438/5244 (84.6301%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4625/5244 (88.1960%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9470, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4285/4989 (85.8890%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4457/4989 (89.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9443, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4517/5197 (86.9155%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4604/5197 (88.5896%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9943, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3899/4356 (89.5087%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3707/4356 (85.1010%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3152, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4016/4647 (86.4213%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4159/4647 (89.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9248, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3562/4013 (88.7615%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7572, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3980/4538 (87.7038%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4169/4538 (91.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8620, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4098/4707 (87.0618%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4223/4707 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9357, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5489/6263 (87.6417%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5701/6263 (91.0267%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0129, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3730/4235 (88.0756%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3739/4235 (88.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0268, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3340/3861 (86.5061%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3489/3861 (90.3652%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9513, Accuracy: 5582/10000 (55.8200%)
time spent on training: 233.60096192359924
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.4788, Accuracy: 6428/10000 (64.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.5600, Accuracy: 363/9900 (3.6667%)
Done in 257.85350942611694 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4325/4885 (88.5363%), train_poison_data_count: 385
Global model norm: 43.21554551343113.
Norm before scaling: 43.21865679219884. Distance: 2.190394312402434
Total norm for 4 adversaries is: 43.21865679219884. distance: 2.190394312402434
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1228, Accuracy: 9589/9900 (96.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4715/5305 (88.8784%), train_poison_data_count: 415
Global model norm: 43.21554551343113.
Norm before scaling: 43.21831926529753. Distance: 2.2237702646774187
Total norm for 4 adversaries is: 43.21831926529753. distance: 2.2237702646774187
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2238, Accuracy: 9377/9900 (94.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 43.21554551343113.
Norm before scaling: 43.21560906880175. Distance: 2.090369726998202
Total norm for 4 adversaries is: 43.21560906880175. distance: 2.090369726998202
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1337, Accuracy: 9587/9900 (96.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4431/5066 (87.4655%), train_poison_data_count: 400
Global model norm: 43.21554551343113.
Norm before scaling: 43.22166899714121. Distance: 2.318896237103629
Total norm for 4 adversaries is: 43.22166899714121. distance: 2.318896237103629
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1235, Accuracy: 9595/9900 (96.9192%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4450/5055 (88.0317%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4547/5055 (89.9505%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9708, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3331/3828 (87.0167%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3507/3828 (91.6144%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8993, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3762/4361 (86.2646%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3897/4361 (89.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0623, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3530/4013 (87.9641%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3687/4013 (91.8764%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9533, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3993/4518 (88.3798%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4145/4518 (91.7441%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8723, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3949/4558 (86.6389%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4081/4558 (89.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0443, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3596/4126 (87.1546%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3781/4126 (91.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9113, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4239/4679 (90.5963%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3990/4679 (85.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0740, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3746/4235 (88.4534%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3769/4235 (88.9965%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0443, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4316/5037 (85.6859%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4567/5037 (90.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9332, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3158/3672 (86.0022%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3329/3672 (90.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8329, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4292/4928 (87.0942%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4416/4928 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0111, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4062/4356 (93.2507%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3952/4356 (90.7254%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9909, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3940/4456 (88.4201%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4101/4456 (92.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0188, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4166/4793 (86.9184%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4367/4793 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9158, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4400/5025 (87.5622%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4551/5025 (90.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0172, Accuracy: 5438/10000 (54.3800%)
time spent on training: 232.2921862602234
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.4768, Accuracy: 6389/10000 (63.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 8.7332, Accuracy: 306/9900 (3.0909%)
Done in 256.3284411430359 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 43.25170612828831.
Norm before scaling: 43.257168390770794. Distance: 2.146689407788929
Total norm for 4 adversaries is: 43.257168390770794. distance: 2.146689407788929
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0642, Accuracy: 9734/9900 (98.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4707/5305 (88.7276%), train_poison_data_count: 415
Global model norm: 43.25170612828831.
Norm before scaling: 43.25281528725544. Distance: 2.25208059117247
Total norm for 4 adversaries is: 43.25281528725544. distance: 2.25208059117247
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1263, Accuracy: 9556/9900 (96.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4237/4717 (89.8240%), train_poison_data_count: 370
Global model norm: 43.25170612828831.
Norm before scaling: 43.249682474900176. Distance: 2.0473797590746696
Total norm for 4 adversaries is: 43.249682474900176. distance: 2.0473797590746696
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1948, Accuracy: 9388/9900 (94.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4436/5066 (87.5642%), train_poison_data_count: 400
Global model norm: 43.25170612828831.
Norm before scaling: 43.25699625042607. Distance: 2.2809728166631986
Total norm for 4 adversaries is: 43.25699625042607. distance: 2.2809728166631986
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2443, Accuracy: 9294/9900 (93.8788%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3878/4346 (89.2315%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4036/4346 (92.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9608, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3678/4184 (87.9063%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3766/4184 (90.0096%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9033, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4035/4356 (92.6309%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3747/4356 (86.0193%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0573, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3178/3646 (87.1640%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3335/3646 (91.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8154, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4460/5083 (87.7435%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4518/5083 (88.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1070, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3991/4356 (91.6208%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3881/4356 (89.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1467, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3930/4558 (86.2220%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4097/4558 (89.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1276, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3628/4175 (86.8982%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3707/4175 (88.7904%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8254, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3018/3472 (86.9240%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3138/3472 (90.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0828, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3917/4501 (87.0251%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4056/4501 (90.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9617, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4794/5424 (88.3850%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4923/5424 (90.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1336, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3927/4481 (87.6367%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4012/4481 (89.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0362, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4759/5455 (87.2411%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4967/5455 (91.0541%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0977, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4501/5232 (86.0283%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4652/5232 (88.9144%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0709, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5449/6391 (85.2605%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5561/6391 (87.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0385, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3362/3775 (89.0596%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3524/3775 (93.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9365, Accuracy: 5533/10000 (55.3300%)
time spent on training: 233.24489998817444
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.4729, Accuracy: 6401/10000 (64.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.0297, Accuracy: 226/9900 (2.2828%)
Done in 257.12446665763855 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4363/4885 (89.3142%), train_poison_data_count: 385
Global model norm: 43.28628975621929.
Norm before scaling: 43.28500237569663. Distance: 2.1897929571863677
Total norm for 4 adversaries is: 43.28500237569663. distance: 2.1897929571863677
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1123, Accuracy: 9599/9900 (96.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4723/5305 (89.0292%), train_poison_data_count: 415
Global model norm: 43.28628975621929.
Norm before scaling: 43.28117243900993. Distance: 2.199274905963216
Total norm for 4 adversaries is: 43.28117243900993. distance: 2.199274905963216
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0884, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4200/4717 (89.0396%), train_poison_data_count: 370
Global model norm: 43.28628975621929.
Norm before scaling: 43.28267568725896. Distance: 2.0593975893671694
Total norm for 4 adversaries is: 43.28267568725896. distance: 2.0593975893671694
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1397, Accuracy: 9544/9900 (96.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4431/5066 (87.4655%), train_poison_data_count: 400
Global model norm: 43.28628975621929.
Norm before scaling: 43.291551684660426. Distance: 2.317104806794234
Total norm for 4 adversaries is: 43.291551684660426. distance: 2.317104806794234
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1406, Accuracy: 9532/9900 (96.2828%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3570/4025 (88.6957%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3730/4025 (92.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8436, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3724/4223 (88.1838%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3850/4223 (91.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0489, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3145/3638 (86.4486%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3348/3638 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8612, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4399/5063 (86.8852%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4351/5063 (85.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1892, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4235/4874 (86.8896%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4278/4874 (87.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3196, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4300/4804 (89.5087%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4153/4804 (86.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2071, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3497/4158 (84.1029%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3637/4158 (87.4699%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9388, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3967/4518 (87.8043%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4170/4518 (92.2975%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9485, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3748/4235 (88.5006%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3762/4235 (88.8312%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0583, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4224/4934 (85.6101%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4173/4934 (84.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1540, Accuracy: 5047/10000 (50.4700%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5437/6391 (85.0728%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5625/6391 (88.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0957, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3709/4295 (86.3562%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3829/4295 (89.1502%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1230, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3338/3756 (88.8711%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3487/3756 (92.8381%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9093, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3920/4481 (87.4805%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3988/4481 (88.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9473, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3613/4175 (86.5389%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3693/4175 (88.4551%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8961, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3144/3590 (87.5766%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3114/3590 (86.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0595, Accuracy: 5337/10000 (53.3700%)
time spent on training: 232.2027280330658
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.5042, Accuracy: 6341/10000 (63.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 9.2085, Accuracy: 180/9900 (1.8182%)
Done in 256.0445673465729 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4366/4885 (89.3756%), train_poison_data_count: 385
Global model norm: 43.32662896353408.
Norm before scaling: 43.32691070692959. Distance: 2.156698318536117
Total norm for 4 adversaries is: 43.32691070692959. distance: 2.156698318536117
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1992, Accuracy: 9404/9900 (94.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4727/5305 (89.1046%), train_poison_data_count: 415
Global model norm: 43.32662896353408.
Norm before scaling: 43.32664023330508. Distance: 2.196480436964336
Total norm for 4 adversaries is: 43.32664023330508. distance: 2.196480436964336
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2585, Accuracy: 9271/9900 (93.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4197/4717 (88.9760%), train_poison_data_count: 370
Global model norm: 43.32662896353408.
Norm before scaling: 43.32882792208396. Distance: 2.080589611225764
Total norm for 4 adversaries is: 43.32882792208396. distance: 2.080589611225764
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1122, Accuracy: 9628/9900 (97.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4421/5066 (87.2681%), train_poison_data_count: 400
Global model norm: 43.32662896353408.
Norm before scaling: 43.33385087706766. Distance: 2.31348542533391
Total norm for 4 adversaries is: 43.33385087706766. distance: 2.31348542533391
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1685, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3377/3828 (88.2184%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3522/3828 (92.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8200, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3464/3911 (88.5707%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3345/3911 (85.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1336, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3934/4362 (90.1880%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3977/4362 (91.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9296, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4589/5197 (88.3009%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4633/5197 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3025, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4317/4679 (92.2633%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4389/4679 (93.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9470, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4120/4793 (85.9587%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4314/4793 (90.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0752, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4406/5116 (86.1220%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4601/5116 (89.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1201, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4025/4625 (87.0270%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4133/4625 (89.3622%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0205, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4096/4618 (88.6964%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4132/4618 (89.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9257, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2865/3271 (87.5879%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3009/3271 (91.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8181, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3647/4175 (87.3533%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9377, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3084/3616 (85.2876%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3297/3616 (91.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8621, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3889/4481 (86.7887%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4012/4481 (89.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0156, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3832/4368 (87.7289%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3921/4368 (89.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9376, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4943/5740 (86.1150%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5185/5740 (90.3310%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0713, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4038/4647 (86.8948%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4197/4647 (90.3163%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9150, Accuracy: 5585/10000 (55.8500%)
time spent on training: 231.7955391407013
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.5115, Accuracy: 6364/10000 (63.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 7.7102, Accuracy: 471/9900 (4.7576%)
Done in 255.67515468597412 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4384/4885 (89.7441%), train_poison_data_count: 385
Global model norm: 43.36101066734665.
Norm before scaling: 43.360084453655354. Distance: 2.0856365315338867
Total norm for 4 adversaries is: 43.360084453655354. distance: 2.0856365315338867
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.3097, Accuracy: 9107/9900 (91.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4762/5305 (89.7644%), train_poison_data_count: 415
Global model norm: 43.36101066734665.
Norm before scaling: 43.35616260622589. Distance: 2.1430239635201085
Total norm for 4 adversaries is: 43.35616260622589. distance: 2.1430239635201085
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1981, Accuracy: 9389/9900 (94.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4215/4717 (89.3576%), train_poison_data_count: 370
Global model norm: 43.36101066734665.
Norm before scaling: 43.359258164257. Distance: 2.02520380289684
Total norm for 4 adversaries is: 43.359258164257. distance: 2.02520380289684
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1262, Accuracy: 9563/9900 (96.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4451/5066 (87.8602%), train_poison_data_count: 400
Global model norm: 43.36101066734665.
Norm before scaling: 43.367473905782774. Distance: 2.2737775725233775
Total norm for 4 adversaries is: 43.367473905782774. distance: 2.2737775725233775
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1428, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4817/5591 (86.1563%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4997/5591 (89.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1889, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4228/4956 (85.3107%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4334/4956 (87.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0731, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3918/4511 (86.8544%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4093/4511 (90.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9246, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3565/4013 (88.8363%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3671/4013 (91.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8961, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3166/3590 (88.1894%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3301/3590 (91.9499%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9507, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4158/4793 (86.7515%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4337/4793 (90.4861%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0499, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3332/3804 (87.5920%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9522, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3359/3837 (87.5424%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3532/3837 (92.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9139, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3813/4361 (87.4341%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3844/4361 (88.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0207, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4461/5063 (88.1098%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4381/5063 (86.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1577, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3785/4368 (86.6529%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3904/4368 (89.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9994, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4338/4679 (92.7121%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4097/4679 (87.5614%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1020, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4581/5265 (87.0085%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4663/5265 (88.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1239, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4102/4767 (86.0499%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4211/4767 (88.3365%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1468, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5173/5902 (87.6483%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5001/5902 (84.7340%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2042, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3679/4223 (87.1182%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3848/4223 (91.1201%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9641, Accuracy: 5528/10000 (55.2800%)
time spent on training: 235.1472945213318
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.4640, Accuracy: 6435/10000 (64.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.0936, Accuracy: 412/9900 (4.1616%)
Done in 259.0195450782776 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 43.408951106111886.
Norm before scaling: 43.40504492342667. Distance: 2.0338419882539585
Total norm for 4 adversaries is: 43.40504492342667. distance: 2.0338419882539585
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3143, Accuracy: 9096/9900 (91.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4727/5305 (89.1046%), train_poison_data_count: 415
Global model norm: 43.408951106111886.
Norm before scaling: 43.40789093145609. Distance: 2.193385571589163
Total norm for 4 adversaries is: 43.40789093145609. distance: 2.193385571589163
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2221, Accuracy: 9302/9900 (93.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.408951106111886.
Norm before scaling: 43.40341091552094. Distance: 2.0246765584836974
Total norm for 4 adversaries is: 43.40341091552094. distance: 2.0246765584836974
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1962, Accuracy: 9408/9900 (95.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4445/5066 (87.7418%), train_poison_data_count: 400
Global model norm: 43.408951106111886.
Norm before scaling: 43.41292301568307. Distance: 2.2654507274030515
Total norm for 4 adversaries is: 43.41292301568307. distance: 2.2654507274030515
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1468, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3365/3797 (88.6226%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3437/3797 (90.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9111, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3382/3861 (87.5939%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3466/3861 (89.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8631, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4139/4707 (87.9329%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4231/4707 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9402, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4014/4518 (88.8446%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4174/4518 (92.3860%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0156, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3563/4013 (88.7864%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3687/4013 (91.8764%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0050, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4598/5167 (88.9878%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4672/5167 (90.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2147, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3476/3969 (87.5787%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3592/3969 (90.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9212, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3938/4441 (88.6737%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4084/4441 (91.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9894, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3985/4558 (87.4287%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4056/4558 (88.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0712, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3911/4465 (87.5924%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4145/4465 (92.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7964, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3165/3638 (86.9984%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8584, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4021/4538 (88.6073%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4189/4538 (92.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8788, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5043/5740 (87.8571%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5243/5740 (91.3415%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2129, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3375/3837 (87.9593%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8356, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3802/4361 (87.1818%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3649/4361 (83.6735%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0660, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4125/4793 (86.0630%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4296/4793 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0220, Accuracy: 5465/10000 (54.6500%)
time spent on training: 231.10631394386292
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.4319, Accuracy: 6517/10000 (65.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.3491, Accuracy: 337/9900 (3.4040%)
Done in 255.43192791938782 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 43.442454191399854.
Norm before scaling: 43.44011064546941. Distance: 2.0783506572075816
Total norm for 4 adversaries is: 43.44011064546941. distance: 2.0783506572075816
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2234, Accuracy: 9306/9900 (94.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4728/5305 (89.1235%), train_poison_data_count: 415
Global model norm: 43.442454191399854.
Norm before scaling: 43.43978326957689. Distance: 2.1739586365106573
Total norm for 4 adversaries is: 43.43978326957689. distance: 2.1739586365106573
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1189, Accuracy: 9602/9900 (96.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.442454191399854.
Norm before scaling: 43.438548211273414. Distance: 1.9979592879293473
Total norm for 4 adversaries is: 43.438548211273414. distance: 1.9979592879293473
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2160, Accuracy: 9378/9900 (94.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 43.442454191399854.
Norm before scaling: 43.44455315938639. Distance: 2.2154993234132747
Total norm for 4 adversaries is: 43.44455315938639. distance: 2.2154993234132747
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2720, Accuracy: 9211/9900 (93.0404%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4110/4767 (86.2177%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4227/4767 (88.6721%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0653, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3953/4441 (89.0115%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4084/4441 (91.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0655, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4122/4356 (94.6281%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4164/4356 (95.5923%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0341, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5446/6391 (85.2136%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5614/6391 (87.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1282, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3671/4184 (87.7390%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3744/4184 (89.4837%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9275, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3897/4346 (89.6687%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4015/4346 (92.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7529, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4348/5037 (86.3212%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4574/5037 (90.8080%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9967, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4083/4634 (88.1096%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4242/4634 (91.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8531, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4372/4934 (88.6096%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4349/4934 (88.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1077, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4814/5424 (88.7537%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4918/5424 (90.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0884, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3345/3781 (88.4687%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3368/3781 (89.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0352, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3389/3861 (87.7752%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3460/3861 (89.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0438, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4483/5055 (88.6845%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4617/5055 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9771, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3963/4433 (89.3977%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4054/4433 (91.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7948, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4577/5167 (88.5814%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4701/5167 (90.9812%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1918, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3196/3590 (89.0251%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3183/3590 (88.6630%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0106, Accuracy: 5508/10000 (55.0800%)
time spent on training: 232.5182580947876
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.6799, Accuracy: 6115/10000 (61.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 6.2337, Accuracy: 1134/9900 (11.4545%)
Done in 256.4408485889435 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 43.466353108341885.
Norm before scaling: 43.46700464909058. Distance: 2.153726843002617
Total norm for 4 adversaries is: 43.46700464909058. distance: 2.153726843002617
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1815, Accuracy: 9424/9900 (95.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4730/5305 (89.1612%), train_poison_data_count: 415
Global model norm: 43.466353108341885.
Norm before scaling: 43.46493765857789. Distance: 2.1572139630828304
Total norm for 4 adversaries is: 43.46493765857789. distance: 2.1572139630828304
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2530, Accuracy: 9273/9900 (93.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4211/4717 (89.2728%), train_poison_data_count: 370
Global model norm: 43.466353108341885.
Norm before scaling: 43.465085103412314. Distance: 2.0701410186573486
Total norm for 4 adversaries is: 43.465085103412314. distance: 2.0701410186573486
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1703, Accuracy: 9441/9900 (95.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 43.466353108341885.
Norm before scaling: 43.471294183273976. Distance: 2.2665487576652796
Total norm for 4 adversaries is: 43.471294183273976. distance: 2.2665487576652796
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1815, Accuracy: 9450/9900 (95.4545%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3825/4368 (87.5687%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3938/4368 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0431, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3338/3828 (87.1996%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3485/3828 (91.0397%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8397, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4177/4356 (95.8907%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3822/4356 (87.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1897, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3379/3861 (87.5162%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3489/3861 (90.3652%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9113, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3062/3472 (88.1912%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3187/3472 (91.7915%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9289, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4052/4538 (89.2904%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4187/4538 (92.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8745, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4774/5392 (88.5386%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4853/5392 (90.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9548, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3718/4295 (86.5658%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3739/4295 (87.0547%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0678, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3734/4235 (88.1700%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3830/4235 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9114, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3976/4456 (89.2280%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4088/4456 (91.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9538, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4534/5265 (86.1159%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4531/5265 (86.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1320, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3952/4441 (88.9890%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4085/4441 (91.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0580, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3564/4013 (88.8114%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3698/4013 (92.1505%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8228, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3899/4465 (87.3236%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4086/4465 (91.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8506, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5509/6263 (87.9610%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5655/6263 (90.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9478, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4392/4986 (88.0866%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4491/4986 (90.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8272, Accuracy: 5800/10000 (58.0000%)
time spent on training: 235.0012435913086
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Client 7 misclassified the most to class 2 with 1 misclassifications.
Client 7 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {7: 1})
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(7, 1)]
Top 2 clients: [(7, 1)]
Client 7 misclassification ratio: 1.0000
Client 7 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.5798, Accuracy: 6261/10000 (62.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 5.8140, Accuracy: 1314/9900 (13.2727%)
Done in 258.9011752605438 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 43.48720037757877.
Norm before scaling: 43.488097217622375. Distance: 2.0679156554193563
Total norm for 4 adversaries is: 43.488097217622375. distance: 2.0679156554193563
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1344, Accuracy: 9554/9900 (96.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 43.48720037757877.
Norm before scaling: 43.48625579834823. Distance: 2.108749296847386
Total norm for 4 adversaries is: 43.48625579834823. distance: 2.108749296847386
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1672, Accuracy: 9511/9900 (96.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 43.48720037757877.
Norm before scaling: 43.47986917456744. Distance: 1.945452949325568
Total norm for 4 adversaries is: 43.47986917456744. distance: 1.945452949325568
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1502, Accuracy: 9501/9900 (95.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4498/5066 (88.7880%), train_poison_data_count: 400
Global model norm: 43.48720037757877.
Norm before scaling: 43.48860948884705. Distance: 2.2001197825681458
Total norm for 4 adversaries is: 43.48860948884705. distance: 2.2001197825681458
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1498, Accuracy: 9495/9900 (95.9091%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3540/4158 (85.1371%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3669/4158 (88.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8956, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4583/5167 (88.6975%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4647/5167 (89.9361%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1646, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3348/3828 (87.4608%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3442/3828 (89.9164%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8864, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4135/4663 (88.6768%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4243/4663 (90.9929%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0430, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3953/4433 (89.1721%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4089/4433 (92.2400%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9075, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3707/4184 (88.5994%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8520, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4087/4716 (86.6624%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4204/4716 (89.1433%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0721, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3734/4223 (88.4206%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3872/4223 (91.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8911, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4294/4679 (91.7717%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4213/4679 (90.0406%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0958, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3199/3704 (86.3661%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3354/3704 (90.5508%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8511, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3384/3837 (88.1939%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3536/3837 (92.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8849, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3414/3861 (88.4227%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3498/3861 (90.5983%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0126, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4817/5424 (88.8090%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4947/5424 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1132, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4035/4576 (88.1774%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4196/4576 (91.6958%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8283, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3555/4025 (88.3230%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3729/4025 (92.6460%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8443, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3366/3775 (89.1656%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3537/3775 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7943, Accuracy: 5810/10000 (58.1000%)
time spent on training: 228.95747184753418
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.5236, Accuracy: 6290/10000 (62.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 6.1475, Accuracy: 1064/9900 (10.7475%)
Done in 252.72853660583496 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4419/4885 (90.4606%), train_poison_data_count: 385
Global model norm: 43.5157624548996.
Norm before scaling: 43.51247183369528. Distance: 2.0168196811897503
Total norm for 4 adversaries is: 43.51247183369528. distance: 2.0168196811897503
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1823, Accuracy: 9432/9900 (95.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 43.5157624548996.
Norm before scaling: 43.51457864540917. Distance: 2.1722658752430286
Total norm for 4 adversaries is: 43.51457864540917. distance: 2.1722658752430286
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2995, Accuracy: 9133/9900 (92.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 43.5157624548996.
Norm before scaling: 43.510233059125014. Distance: 1.928880221506843
Total norm for 4 adversaries is: 43.510233059125014. distance: 1.928880221506843
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3129, Accuracy: 9123/9900 (92.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4516/5066 (89.1433%), train_poison_data_count: 400
Global model norm: 43.5157624548996.
Norm before scaling: 43.514330377959254. Distance: 2.1911314113666123
Total norm for 4 adversaries is: 43.514330377959254. distance: 2.1911314113666123
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0527, Accuracy: 9751/9900 (98.4949%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4076/4576 (89.0734%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4215/4576 (92.1110%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8813, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3238/3672 (88.1808%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3342/3672 (91.0131%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9088, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4111/4618 (89.0212%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4070/4618 (88.1334%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9837, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4083/4538 (89.9736%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7796, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4447/5025 (88.4975%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4622/5025 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0516, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3207/3590 (89.3315%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3180/3590 (88.5794%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9316, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4118/4707 (87.4867%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4284/4707 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1409, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4315/4918 (87.7389%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4449/4918 (90.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9823, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3836/4336 (88.4686%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3963/4336 (91.3976%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9096, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5296/5902 (89.7323%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5254/5902 (89.0207%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2066, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3986/4441 (89.7546%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4127/4441 (92.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0345, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4481/5232 (85.6460%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4680/5232 (89.4495%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0462, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4267/4804 (88.8218%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4334/4804 (90.2165%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0337, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3527/3969 (88.8637%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3631/3969 (91.4840%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9748, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4830/5392 (89.5772%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4895/5392 (90.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9733, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3352/3828 (87.5653%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3503/3828 (91.5099%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8905, Accuracy: 5684/10000 (56.8400%)
time spent on training: 232.8195059299469
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.5136, Accuracy: 6366/10000 (63.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 5.9075, Accuracy: 1191/9900 (12.0303%)
Done in 256.68357276916504 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 43.545043074581834.
Norm before scaling: 43.54214855943463. Distance: 1.9971744724708906
Total norm for 4 adversaries is: 43.54214855943463. distance: 1.9971744724708906
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1461, Accuracy: 9531/9900 (96.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4717/5305 (88.9161%), train_poison_data_count: 415
Global model norm: 43.545043074581834.
Norm before scaling: 43.54506830437647. Distance: 2.1911290175295384
Total norm for 4 adversaries is: 43.54506830437647. distance: 2.1911290175295384
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2093, Accuracy: 9376/9900 (94.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4238/4717 (89.8452%), train_poison_data_count: 370
Global model norm: 43.545043074581834.
Norm before scaling: 43.53825572888816. Distance: 1.9559174373808794
Total norm for 4 adversaries is: 43.53825572888816. distance: 1.9559174373808794
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2966, Accuracy: 9159/9900 (92.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 43.545043074581834.
Norm before scaling: 43.54415862087589. Distance: 2.1905572507996136
Total norm for 4 adversaries is: 43.54415862087589. distance: 2.1905572507996136
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0757, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4478/5232 (85.5887%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4632/5232 (88.5321%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0104, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4276/4956 (86.2793%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4417/4956 (89.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2959, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4428/5063 (87.4580%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4500/5063 (88.8801%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0432, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3579/4025 (88.9193%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3755/4025 (93.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8698, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3990/4441 (89.8446%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4110/4441 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0539, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4036/4625 (87.2649%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4083/4625 (88.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0397, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4807/5591 (85.9775%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4849/5591 (86.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2796, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5012/5582 (89.7886%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5113/5582 (91.5980%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1338, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5317/5902 (90.0881%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5319/5902 (90.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1805, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4072/4538 (89.7312%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4212/4538 (92.8162%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8407, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4460/5025 (88.7562%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4605/5025 (91.6418%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9840, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3706/4223 (87.7575%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3871/4223 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8667, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3899/4361 (89.4061%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3862/4361 (88.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0673, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4135/4354 (94.9701%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3838/4354 (88.1488%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0953, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3252/3672 (88.5621%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3314/3672 (90.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0025, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3998/4356 (91.7815%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3953/4356 (90.7484%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2691, Accuracy: 5079/10000 (50.7900%)
time spent on training: 234.94366216659546
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Client 3 misclassified the most to class 2 with 1 misclassifications.
Client 3 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {3: 1})
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(3, 1)]
Top 2 clients: [(3, 1)]
Client 3 misclassification ratio: 1.0000
Client 3 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.4599, Accuracy: 6442/10000 (64.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 5.7139, Accuracy: 1294/9900 (13.0707%)
Done in 258.67958331108093 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 43.56780702070911.
Norm before scaling: 43.56642708939921. Distance: 1.99888204084765
Total norm for 4 adversaries is: 43.56642708939921. distance: 1.99888204084765
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0966, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 43.56780702070911.
Norm before scaling: 43.561388918309156. Distance: 2.0374480539264628
Total norm for 4 adversaries is: 43.561388918309156. distance: 2.0374480539264628
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1438, Accuracy: 9543/9900 (96.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 43.56780702070911.
Norm before scaling: 43.562190357131236. Distance: 1.8933595160343974
Total norm for 4 adversaries is: 43.562190357131236. distance: 1.8933595160343974
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.3526, Accuracy: 9077/9900 (91.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 43.56780702070911.
Norm before scaling: 43.56917430040131. Distance: 2.2018459205320595
Total norm for 4 adversaries is: 43.56917430040131. distance: 2.2018459205320595
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1471, Accuracy: 9534/9900 (96.3030%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3417/3828 (89.2633%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3517/3828 (91.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8061, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3799/4235 (89.7048%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3812/4235 (90.0118%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0507, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3235/3704 (87.3380%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3309/3704 (89.3359%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9159, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3609/4046 (89.1992%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3736/4046 (92.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8242, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4361/4928 (88.4943%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4420/4928 (89.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8832, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5074/5740 (88.3972%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5177/5740 (90.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1228, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4471/5083 (87.9599%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4539/5083 (89.2977%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8232, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4052/4576 (88.5490%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4112/4576 (89.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8894, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4102/4647 (88.2720%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4255/4647 (91.5645%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9334, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4876/5424 (89.8968%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4954/5424 (91.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0667, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3954/4503 (87.8081%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4073/4503 (90.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9709, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5497/6391 (86.0116%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5614/6391 (87.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0611, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3961/4511 (87.8076%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4053/4511 (89.8470%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9961, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4077/4456 (91.4946%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4094/4456 (91.8761%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9835, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4383/4804 (91.2365%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4234/4804 (88.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0475, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3365/3804 (88.4595%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3459/3804 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9661, Accuracy: 5529/10000 (55.2900%)
time spent on training: 234.10196208953857
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.4944, Accuracy: 6350/10000 (63.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 5.7806, Accuracy: 1231/9900 (12.4343%)
Done in 257.937707901001 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 43.61300118164665.
Norm before scaling: 43.6103574996812. Distance: 2.004645436203155
Total norm for 4 adversaries is: 43.6103574996812. distance: 2.004645436203155
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1851, Accuracy: 9419/9900 (95.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 43.61300118164665.
Norm before scaling: 43.60916506130047. Distance: 2.101571916183308
Total norm for 4 adversaries is: 43.60916506130047. distance: 2.101571916183308
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1901, Accuracy: 9423/9900 (95.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 43.61300118164665.
Norm before scaling: 43.60779063764725. Distance: 1.919956831744805
Total norm for 4 adversaries is: 43.60779063764725. distance: 1.919956831744805
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1948, Accuracy: 9400/9900 (94.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 43.61300118164665.
Norm before scaling: 43.61082774810632. Distance: 2.1031474550133895
Total norm for 4 adversaries is: 43.61082774810632. distance: 2.1031474550133895
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1017, Accuracy: 9631/9900 (97.2828%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4478/4928 (90.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8728, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4374/5037 (86.8374%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4572/5037 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9778, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4850/5392 (89.9481%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4851/5392 (89.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9775, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3991/4501 (88.6692%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4046/4501 (89.8911%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9745, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3346/3804 (87.9600%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3460/3804 (90.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9801, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3401/3837 (88.6370%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3545/3837 (92.3899%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8852, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4470/5063 (88.2876%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4381/5063 (86.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1121, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4033/4481 (90.0022%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4056/4481 (90.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0079, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4046/4518 (89.5529%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4136/4518 (91.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8859, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3168/3638 (87.0808%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3291/3638 (90.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8793, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4182/4663 (89.6848%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4321/4663 (92.6657%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8974, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4045/4625 (87.4595%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4077/4625 (88.1514%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9909, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4572/5197 (87.9738%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4661/5197 (89.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1380, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4510/5083 (88.7271%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4589/5083 (90.2813%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0639, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3373/3828 (88.1139%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3536/3828 (92.3720%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8633, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3190/3704 (86.1231%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3371/3704 (91.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.7956, Accuracy: 5804/10000 (58.0400%)
time spent on training: 232.2988612651825
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.4676, Accuracy: 6453/10000 (64.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 6.4610, Accuracy: 940/9900 (9.4949%)
Done in 255.87039613723755 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 43.64903808093169.
Norm before scaling: 43.64477720356054. Distance: 2.035401195934567
Total norm for 4 adversaries is: 43.64477720356054. distance: 2.035401195934567
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1526, Accuracy: 9497/9900 (95.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 43.64903808093169.
Norm before scaling: 43.64574072683095. Distance: 2.087883202563689
Total norm for 4 adversaries is: 43.64574072683095. distance: 2.087883202563689
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0994, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 43.64903808093169.
Norm before scaling: 43.643841628680846. Distance: 1.9513992009129892
Total norm for 4 adversaries is: 43.643841628680846. distance: 1.9513992009129892
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1815, Accuracy: 9442/9900 (95.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 43.64903808093169.
Norm before scaling: 43.646762961211536. Distance: 2.156669354778582
Total norm for 4 adversaries is: 43.646762961211536. distance: 2.156669354778582
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1871, Accuracy: 9451/9900 (95.4646%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3448/3861 (89.3033%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3515/3861 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8709, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3744/4184 (89.4837%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3841/4184 (91.8021%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8898, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4399/5037 (87.3337%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/5037 (90.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9544, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4562/5197 (87.7814%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4597/5197 (88.4549%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1040, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4453/5025 (88.6169%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4571/5025 (90.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9997, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4508/5116 (88.1157%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4501/5116 (87.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0362, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4062/4481 (90.6494%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4060/4481 (90.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0450, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4092/4576 (89.4231%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4184/4576 (91.4336%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9073, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4564/5232 (87.2324%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4704/5232 (89.9083%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0716, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4104/4354 (94.2582%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3999/4354 (91.8466%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1634, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2927/3271 (89.4833%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2924/3271 (89.3916%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0107, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4798/5455 (87.9560%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4866/5455 (89.2026%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0857, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3667/4126 (88.8754%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3821/4126 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8435, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3489/3797 (91.8883%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9333, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3242/3704 (87.5270%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3395/3704 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8874, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4444/4934 (90.0689%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4385/4934 (88.8731%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0552, Accuracy: 5348/10000 (53.4800%)
time spent on training: 231.63874530792236
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.5223, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 6.9092, Accuracy: 670/9900 (6.7677%)
Done in 255.52124524116516 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 43.67851302414037.
Norm before scaling: 43.67257518445858. Distance: 1.9490824252295604
Total norm for 4 adversaries is: 43.67257518445858. distance: 1.9490824252295604
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2916, Accuracy: 9172/9900 (92.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 43.67851302414037.
Norm before scaling: 43.674393375509524. Distance: 2.1286769918487445
Total norm for 4 adversaries is: 43.674393375509524. distance: 2.1286769918487445
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2095, Accuracy: 9379/9900 (94.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4242/4717 (89.9300%), train_poison_data_count: 370
Global model norm: 43.67851302414037.
Norm before scaling: 43.670997307817174. Distance: 1.9813489293570938
Total norm for 4 adversaries is: 43.670997307817174. distance: 1.9813489293570938
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2145, Accuracy: 9348/9900 (94.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 43.67851302414037.
Norm before scaling: 43.67571259972469. Distance: 2.1605107325274298
Total norm for 4 adversaries is: 43.67571259972469. distance: 2.1605107325274298
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1554, Accuracy: 9501/9900 (95.9697%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4079/4618 (88.3283%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4090/4618 (88.5665%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9151, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4016/4625 (86.8324%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4098/4625 (88.6054%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0540, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5069/5740 (88.3101%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5121/5740 (89.2160%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3057, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3886/4416 (87.9982%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4019/4416 (91.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9327, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3690/4126 (89.4329%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3796/4126 (92.0019%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8353, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3296/3616 (91.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8349, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3510/4158 (84.4156%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3674/4158 (88.3598%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0807, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3926/4346 (90.3359%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4031/4346 (92.7520%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0085, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4235/4874 (86.8896%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4355/4874 (89.3517%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3438, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4650/5265 (88.3191%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4669/5265 (88.6800%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0301, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3621/4025 (89.9627%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3745/4025 (93.0435%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8406, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4114/4651 (88.4541%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4220/4651 (90.7332%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0203, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3382/3837 (88.1418%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3501/3837 (91.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9106, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3154/3638 (86.6960%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3287/3638 (90.3518%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0055, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3108/3472 (89.5161%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3187/3472 (91.7915%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9585, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4029/4456 (90.4174%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4141/4456 (92.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8619, Accuracy: 5709/10000 (57.0900%)
time spent on training: 230.09641861915588
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.5873, Accuracy: 6280/10000 (62.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 6.7746, Accuracy: 645/9900 (6.5152%)
Done in 253.89963388442993 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 43.711125306790464.
Norm before scaling: 43.70979598040281. Distance: 2.073736849623012
Total norm for 4 adversaries is: 43.70979598040281. distance: 2.073736849623012
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1489, Accuracy: 9517/9900 (96.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 43.711125306790464.
Norm before scaling: 43.70618062253181. Distance: 2.118628767928144
Total norm for 4 adversaries is: 43.70618062253181. distance: 2.118628767928144
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1080, Accuracy: 9608/9900 (97.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 43.711125306790464.
Norm before scaling: 43.70425482316839. Distance: 1.9334217341809752
Total norm for 4 adversaries is: 43.70425482316839. distance: 1.9334217341809752
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2336, Accuracy: 9305/9900 (93.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4513/5066 (89.0841%), train_poison_data_count: 400
Global model norm: 43.711125306790464.
Norm before scaling: 43.712450403889505. Distance: 2.2260007986322634
Total norm for 4 adversaries is: 43.712450403889505. distance: 2.2260007986322634
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2655, Accuracy: 9223/9900 (93.1616%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4849/5424 (89.3990%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4935/5424 (90.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1374, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4412/4986 (88.4878%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4515/4986 (90.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9443, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4562/5167 (88.2911%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4693/5167 (90.8264%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0402, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4084/4716 (86.5988%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4210/4716 (89.2706%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0578, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3854/4368 (88.2326%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3855/4368 (88.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0369, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4012/4356 (92.1028%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3864/4356 (88.7052%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2658, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4417/4804 (91.9442%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4281/4804 (89.1132%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1970, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4040/4481 (90.1584%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4070/4481 (90.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1128, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3593/4025 (89.2671%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3711/4025 (92.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8933, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4452/5017 (88.7383%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4541/5017 (90.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9921, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3166/3616 (87.5553%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3328/3616 (92.0354%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8105, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3688/4184 (88.1453%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3786/4184 (90.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8996, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4515/5195 (86.9105%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4569/5195 (87.9500%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0980, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3935/4361 (90.2316%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3986/4361 (91.4011%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0651, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3394/3756 (90.3621%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3514/3756 (93.5570%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8791, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4887/5591 (87.4083%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4904/5591 (87.7124%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0563, Accuracy: 5471/10000 (54.7100%)
time spent on training: 234.46477031707764
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.5571, Accuracy: 6299/10000 (62.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 7.0548, Accuracy: 580/9900 (5.8586%)
Done in 258.3370954990387 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 43.739227189299854.
Norm before scaling: 43.733139887436195. Distance: 2.01229938905143
Total norm for 4 adversaries is: 43.733139887436195. distance: 2.01229938905143
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.3282, Accuracy: 9063/9900 (91.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 43.739227189299854.
Norm before scaling: 43.73343296815021. Distance: 2.1420400355895786
Total norm for 4 adversaries is: 43.73343296815021. distance: 2.1420400355895786
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2590, Accuracy: 9268/9900 (93.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.739227189299854.
Norm before scaling: 43.73246439869142. Distance: 1.9556287053122794
Total norm for 4 adversaries is: 43.73246439869142. distance: 1.9556287053122794
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0993, Accuracy: 9635/9900 (97.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 43.739227189299854.
Norm before scaling: 43.737764751181416. Distance: 2.149225707685939
Total norm for 4 adversaries is: 43.737764751181416. distance: 2.149225707685939
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2317, Accuracy: 9322/9900 (94.1616%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3669/4175 (87.8802%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3795/4175 (90.8982%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9789, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4878/5455 (89.4225%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4916/5455 (90.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0152, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3231/3704 (87.2300%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3406/3704 (91.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8055, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4366/4989 (87.5125%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4467/4989 (89.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9906, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4293/4928 (87.1144%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4416/4928 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8789, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3358/3804 (88.2755%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3488/3804 (91.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0708, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3866/4336 (89.1605%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3943/4336 (90.9363%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9009, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3596/4046 (88.8779%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3624/4046 (89.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9842, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4202/4793 (87.6695%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4324/4793 (90.2149%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8693, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3363/3756 (89.5367%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3492/3756 (92.9712%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1934, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5645/6391 (88.3273%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5659/6391 (88.5464%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1547, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3245/3672 (88.3715%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3343/3672 (91.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8567, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4028/4558 (88.3721%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4091/4558 (89.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0621, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4049/4576 (88.4834%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4163/4576 (90.9747%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9298, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3987/4456 (89.4749%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9433, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4142/4356 (95.0872%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3960/4356 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0348, Accuracy: 5503/10000 (55.0300%)
time spent on training: 232.1080527305603
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.5488, Accuracy: 6362/10000 (63.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 7.0014, Accuracy: 597/9900 (6.0303%)
Done in 255.90931010246277 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 43.78332854407528.
Norm before scaling: 43.77997856826223. Distance: 2.034421235246195
Total norm for 4 adversaries is: 43.77997856826223. distance: 2.034421235246195
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1930, Accuracy: 9421/9900 (95.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 43.78332854407528.
Norm before scaling: 43.77747044936827. Distance: 2.1042669543045216
Total norm for 4 adversaries is: 43.77747044936827. distance: 2.1042669543045216
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2382, Accuracy: 9327/9900 (94.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 43.78332854407528.
Norm before scaling: 43.775372107213435. Distance: 2.0191587477195623
Total norm for 4 adversaries is: 43.775372107213435. distance: 2.0191587477195623
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1051, Accuracy: 9614/9900 (97.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4544/5066 (89.6960%), train_poison_data_count: 400
Global model norm: 43.78332854407528.
Norm before scaling: 43.78343170197561. Distance: 2.1605864332761
Total norm for 4 adversaries is: 43.78343170197561. distance: 2.1605864332761
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1765, Accuracy: 9460/9900 (95.5556%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4485/5116 (87.6661%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4536/5116 (88.6630%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0217, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5038/5582 (90.2544%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5107/5582 (91.4905%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1039, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4279/4928 (86.8304%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4457/4928 (90.4424%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9643, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3729/4126 (90.3781%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3821/4126 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7957, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3558/4158 (85.5700%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3654/4158 (87.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8412, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4600/5063 (90.8552%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4479/5063 (88.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1248, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5451/6124 (89.0105%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5513/6124 (90.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0530, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4158/4354 (95.4984%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3990/4354 (91.6399%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1946, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4442/5025 (88.3980%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4548/5025 (90.5075%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0846, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4390/4679 (93.8235%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4225/4679 (90.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0963, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4208/4793 (87.7947%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4356/4793 (90.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8927, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4065/4518 (89.9734%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4125/4518 (91.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8748, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4558/5167 (88.2137%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4649/5167 (89.9748%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0642, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3994/4433 (90.0970%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4060/4433 (91.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8508, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4021/4503 (89.2960%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4082/4503 (90.6507%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0371, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4182/4707 (88.8464%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4265/4707 (90.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8601, Accuracy: 5720/10000 (57.2000%)
time spent on training: 236.25425386428833
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.6802, Accuracy: 6146/10000 (61.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 7.1191, Accuracy: 576/9900 (5.8182%)
Done in 260.03629207611084 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 43.811527606006564.
Norm before scaling: 43.806945361598345. Distance: 2.043138661074893
Total norm for 4 adversaries is: 43.806945361598345. distance: 2.043138661074893
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2400, Accuracy: 9314/9900 (94.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 43.811527606006564.
Norm before scaling: 43.80515357229315. Distance: 2.1150913348666247
Total norm for 4 adversaries is: 43.80515357229315. distance: 2.1150913348666247
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1765, Accuracy: 9444/9900 (95.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 43.811527606006564.
Norm before scaling: 43.80584744652034. Distance: 2.0161748328390288
Total norm for 4 adversaries is: 43.80584744652034. distance: 2.0161748328390288
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1366, Accuracy: 9510/9900 (96.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 43.811527606006564.
Norm before scaling: 43.80933476440837. Distance: 2.1852472967574723
Total norm for 4 adversaries is: 43.80933476440837. distance: 2.1852472967574723
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0901, Accuracy: 9679/9900 (97.7677%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3236/3704 (87.3650%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3380/3704 (91.2527%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8382, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4746/5392 (88.0193%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4773/5392 (88.5200%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1900, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3945/4362 (90.4402%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4048/4362 (92.8015%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9129, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4091/4538 (90.1498%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4187/4538 (92.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9692, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3708/4184 (88.6233%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3823/4184 (91.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7862, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3354/3756 (89.2971%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3470/3756 (92.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8843, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4353/4679 (93.0327%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4353/4679 (93.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8926, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3145/3472 (90.5818%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1049, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5746/6391 (89.9077%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5733/6391 (89.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0390, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4672/5265 (88.7369%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4617/5265 (87.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1258, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5299/5902 (89.7831%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5261/5902 (89.1393%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1189, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5401/6124 (88.1940%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5440/6124 (88.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9861, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4478/5083 (88.0976%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4561/5083 (89.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0106, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3952/4465 (88.5106%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4111/4465 (92.0717%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9240, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3350/3804 (88.0652%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3431/3804 (90.1945%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0030, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4456/4918 (90.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0865, Accuracy: 5309/10000 (53.0900%)
time spent on training: 234.08627438545227
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.6234, Accuracy: 6218/10000 (62.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 7.5231, Accuracy: 476/9900 (4.8081%)
Done in 257.821515083313 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4435/4885 (90.7881%), train_poison_data_count: 385
Global model norm: 43.85110666407477.
Norm before scaling: 43.84813630722733. Distance: 2.0594476018446435
Total norm for 4 adversaries is: 43.84813630722733. distance: 2.0594476018446435
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.4139, Accuracy: 8943/9900 (90.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 43.85110666407477.
Norm before scaling: 43.847905240105966. Distance: 2.1577026339218075
Total norm for 4 adversaries is: 43.847905240105966. distance: 2.1577026339218075
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1439, Accuracy: 9539/9900 (96.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 43.85110666407477.
Norm before scaling: 43.84736793474253. Distance: 1.9647174286477873
Total norm for 4 adversaries is: 43.84736793474253. distance: 1.9647174286477873
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1593, Accuracy: 9495/9900 (95.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 43.85110666407477.
Norm before scaling: 43.85486038396286. Distance: 2.2109446171622418
Total norm for 4 adversaries is: 43.85486038396286. distance: 2.2109446171622418
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2417, Accuracy: 9294/9900 (93.8788%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4067/4538 (89.6210%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4185/4538 (92.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9188, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4320/4989 (86.5905%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4414/4989 (88.4746%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9205, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4194/4793 (87.5026%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4342/4793 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9378, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3502/4158 (84.2232%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3609/4158 (86.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9253, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3399/3861 (88.0342%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3506/3861 (90.8055%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0220, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4550/5232 (86.9648%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4659/5232 (89.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1622, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4153/4663 (89.0628%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4332/4663 (92.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9316, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4639/5197 (89.2630%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4644/5197 (89.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9866, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4599/5167 (89.0072%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4656/5167 (90.1103%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0909, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3886/4416 (87.9982%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8859, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4219/4354 (96.8994%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3892/4354 (89.3891%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1329, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4867/5455 (89.2209%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0014, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4013/4456 (90.0583%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4110/4456 (92.2352%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8461, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2885/3271 (88.1993%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2935/3271 (89.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9918, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2962/3297 (89.8392%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3031/3297 (91.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7704, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4946/5591 (88.4636%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4981/5591 (89.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1317, Accuracy: 5167/10000 (51.6700%)
time spent on training: 233.8184084892273
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.6991, Accuracy: 6064/10000 (60.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 7.2546, Accuracy: 677/9900 (6.8384%)
Done in 257.67811489105225 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 43.8810982229251.
Norm before scaling: 43.87873776591218. Distance: 2.081290222329166
Total norm for 4 adversaries is: 43.87873776591218. distance: 2.081290222329166
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1488, Accuracy: 9514/9900 (96.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 43.8810982229251.
Norm before scaling: 43.87681119391968. Distance: 2.1302056223161108
Total norm for 4 adversaries is: 43.87681119391968. distance: 2.1302056223161108
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.3850, Accuracy: 9003/9900 (90.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 43.8810982229251.
Norm before scaling: 43.87823422240875. Distance: 2.041254378230579
Total norm for 4 adversaries is: 43.87823422240875. distance: 2.041254378230579
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1796, Accuracy: 9456/9900 (95.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 43.8810982229251.
Norm before scaling: 43.88360041908808. Distance: 2.2297823997356554
Total norm for 4 adversaries is: 43.88360041908808. distance: 2.2297823997356554
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1910, Accuracy: 9407/9900 (95.0202%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4566/5167 (88.3685%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4678/5167 (90.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2557, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3368/3775 (89.2185%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3523/3775 (93.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8598, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4518/5195 (86.9682%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4667/5195 (89.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2230, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3640/4126 (88.2210%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3817/4126 (92.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8663, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3487/3911 (89.1588%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3387/3911 (86.6019%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2391, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3971/4433 (89.5782%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4094/4433 (92.3528%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7955, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2852/3271 (87.1905%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2893/3271 (88.4439%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8976, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3203/3590 (89.2201%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3233/3590 (90.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0888, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4273/4918 (86.8849%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4490/4918 (91.2973%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1030, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4390/4986 (88.0465%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4488/4986 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9798, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3132/3616 (86.6150%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3306/3616 (91.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8824, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3764/4295 (87.6368%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3878/4295 (90.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0045, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4078/4356 (93.6180%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4011/4356 (92.0799%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8987, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4196/4793 (87.5443%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4312/4793 (89.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8921, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3882/4315 (89.9652%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3964/4315 (91.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8095, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4360/4804 (90.7577%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4489/4804 (93.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9218, Accuracy: 5694/10000 (56.9400%)
time spent on training: 229.13067197799683
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.6991, Accuracy: 6105/10000 (61.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 7.3822, Accuracy: 636/9900 (6.4242%)
Done in 253.40246152877808 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 43.90759701003133.
Norm before scaling: 43.90473195774289. Distance: 2.061746286177248
Total norm for 4 adversaries is: 43.90473195774289. distance: 2.061746286177248
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1932, Accuracy: 9413/9900 (95.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4777/5305 (90.0471%), train_poison_data_count: 415
Global model norm: 43.90759701003133.
Norm before scaling: 43.90257157633964. Distance: 2.182814784994274
Total norm for 4 adversaries is: 43.90257157633964. distance: 2.182814784994274
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0944, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 43.90759701003133.
Norm before scaling: 43.90342656624665. Distance: 2.0077920756804075
Total norm for 4 adversaries is: 43.90342656624665. distance: 2.0077920756804075
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1638, Accuracy: 9472/9900 (95.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4483/5066 (88.4919%), train_poison_data_count: 400
Global model norm: 43.90759701003133.
Norm before scaling: 43.909551421697394. Distance: 2.243860770123825
Total norm for 4 adversaries is: 43.909551421697394. distance: 2.243860770123825
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1546, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3995/4503 (88.7186%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4019/4503 (89.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9562, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4340/4934 (87.9611%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4411/4934 (89.4001%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1610, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4469/4804 (93.0266%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4307/4804 (89.6545%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2745, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3980/4456 (89.3178%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4084/4456 (91.6517%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9521, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4083/4651 (87.7876%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4209/4651 (90.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0891, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3711/4184 (88.6950%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3779/4184 (90.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9675, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4267/4928 (86.5869%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4435/4928 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9691, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3362/3775 (89.0596%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9203, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4497/5083 (88.4714%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4501/5083 (88.5501%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9684, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4815/5455 (88.2676%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4899/5455 (89.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9819, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3161/3638 (86.8884%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3638 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8129, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3438/3911 (87.9059%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3537/3911 (90.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0618, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3368/3837 (87.7769%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3539/3837 (92.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8713, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3970/4501 (88.2026%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4076/4501 (90.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1350, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4588/5197 (88.2817%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4661/5197 (89.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0778, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3391/3861 (87.8270%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3445/3861 (89.2256%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9178, Accuracy: 5578/10000 (55.7800%)
time spent on training: 229.2755959033966
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7027, Accuracy: 6117/10000 (61.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 7.5774, Accuracy: 545/9900 (5.5051%)
Done in 253.09546661376953 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4433/4885 (90.7472%), train_poison_data_count: 385
Global model norm: 43.93967950008639.
Norm before scaling: 43.93723606339644. Distance: 2.0712700698607667
Total norm for 4 adversaries is: 43.93723606339644. distance: 2.0712700698607667
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1611, Accuracy: 9480/9900 (95.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 43.93967950008639.
Norm before scaling: 43.938104269937924. Distance: 2.1787108280689687
Total norm for 4 adversaries is: 43.938104269937924. distance: 2.1787108280689687
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1509, Accuracy: 9543/9900 (96.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 43.93967950008639.
Norm before scaling: 43.93304064763643. Distance: 1.9566265609092581
Total norm for 4 adversaries is: 43.93304064763643. distance: 1.9566265609092581
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1597, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4505/5066 (88.9262%), train_poison_data_count: 400
Global model norm: 43.93967950008639.
Norm before scaling: 43.94169637899819. Distance: 2.2568058290870785
Total norm for 4 adversaries is: 43.94169637899819. distance: 2.2568058290870785
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0966, Accuracy: 9614/9900 (97.1111%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2870/3271 (87.7408%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2926/3271 (89.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0034, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3888/4511 (86.1893%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4044/4511 (89.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1088, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3148/3638 (86.5311%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3279/3638 (90.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9244, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5035/5582 (90.2006%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5119/5582 (91.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9549, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3961/4456 (88.8914%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4130/4456 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0640, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5413/5902 (91.7147%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5294/5902 (89.6984%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0307, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3833/4416 (86.7980%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3995/4416 (90.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8396, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4478/4934 (90.7580%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4440/4934 (89.9878%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2095, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4070/4596 (88.5553%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4253/4596 (92.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9205, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3381/3837 (88.1157%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3514/3837 (91.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8494, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5761/6391 (90.1424%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5793/6391 (90.6431%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0856, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3848/4368 (88.0952%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3908/4368 (89.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0731, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3343/3804 (87.8812%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8679, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5554/6263 (88.6795%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5615/6263 (89.6535%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1972, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4209/4793 (87.8156%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4349/4793 (90.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9785, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4816/5424 (88.7906%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4926/5424 (90.8186%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2813, Accuracy: 5031/10000 (50.3100%)
time spent on training: 235.58344864845276
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.6804, Accuracy: 6157/10000 (61.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 7.9088, Accuracy: 455/9900 (4.5960%)
Done in 259.3007426261902 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 43.97331260753148.
Norm before scaling: 43.96990908875566. Distance: 2.1042087160447536
Total norm for 4 adversaries is: 43.96990908875566. distance: 2.1042087160447536
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3456, Accuracy: 9005/9900 (90.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 43.97331260753148.
Norm before scaling: 43.96992296987297. Distance: 2.184636994505039
Total norm for 4 adversaries is: 43.96992296987297. distance: 2.184636994505039
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1839, Accuracy: 9463/9900 (95.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 43.97331260753148.
Norm before scaling: 43.96704809694841. Distance: 2.038677427683028
Total norm for 4 adversaries is: 43.96704809694841. distance: 2.038677427683028
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1308, Accuracy: 9556/9900 (96.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 43.97331260753148.
Norm before scaling: 43.974407729453844. Distance: 2.281338311145167
Total norm for 4 adversaries is: 43.974407729453844. distance: 2.281338311145167
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2886, Accuracy: 9172/9900 (92.6465%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4484/5055 (88.7043%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4615/5055 (91.2957%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9074, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3703/4184 (88.5038%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3785/4184 (90.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9576, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3420/3861 (88.5781%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3486/3861 (90.2875%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9400, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4433/4804 (92.2773%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4228/4804 (88.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1754, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3091/3472 (89.0265%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3140/3472 (90.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9692, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3483/3969 (87.7551%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3587/3969 (90.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0356, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4333/4989 (86.8511%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4401/4989 (88.2141%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0697, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5039/5582 (90.2723%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5076/5582 (90.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1397, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4181/4793 (87.2314%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9834, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4097/4662 (87.8807%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4237/4662 (90.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9923, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4519/4934 (91.5890%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4401/4934 (89.1974%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1537, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4986 (88.0064%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4455/4986 (89.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9607, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3966/4433 (89.4654%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4015/4433 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8422, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4117/4716 (87.2986%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4221/4716 (89.5038%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0794, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4087/4596 (88.9252%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4220/4596 (91.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0585, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4215/4354 (96.8075%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3981/4354 (91.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9785, Accuracy: 5542/10000 (55.4200%)
time spent on training: 232.39284491539001
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7061, Accuracy: 6174/10000 (61.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 8.0502, Accuracy: 349/9900 (3.5253%)
Done in 256.24930119514465 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 44.00628062419045.
Norm before scaling: 44.004453953815144. Distance: 2.096158023606622
Total norm for 4 adversaries is: 44.004453953815144. distance: 2.096158023606622
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0824, Accuracy: 9697/9900 (97.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4734/5305 (89.2366%), train_poison_data_count: 415
Global model norm: 44.00628062419045.
Norm before scaling: 44.00346360879235. Distance: 2.2264990011162
Total norm for 4 adversaries is: 44.00346360879235. distance: 2.2264990011162
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1493, Accuracy: 9550/9900 (96.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4240/4717 (89.8876%), train_poison_data_count: 370
Global model norm: 44.00628062419045.
Norm before scaling: 44.001341365828694. Distance: 2.03658111540344
Total norm for 4 adversaries is: 44.001341365828694. distance: 2.03658111540344
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2349, Accuracy: 9296/9900 (93.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4503/5066 (88.8867%), train_poison_data_count: 400
Global model norm: 44.00628062419045.
Norm before scaling: 44.007239006337784. Distance: 2.2385147265882224
Total norm for 4 adversaries is: 44.007239006337784. distance: 2.2385147265882224
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.3204, Accuracy: 9151/9900 (92.4343%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4489/5116 (87.7443%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4584/5116 (89.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9259, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4095/4662 (87.8378%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4258/4662 (91.3342%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9816, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5359/5902 (90.7997%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5377/5902 (91.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2309, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4496/5063 (88.8011%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4602/5063 (90.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9673, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4201/4354 (96.4860%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3704/4354 (85.0712%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.4983, Accuracy: 4712/10000 (47.1200%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4526/5195 (87.1222%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4607/5195 (88.6814%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0987, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4090/4356 (93.8935%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3939/4356 (90.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1516, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3756/4295 (87.4505%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3815/4295 (88.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1391, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5591/6263 (89.2703%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5655/6263 (90.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0271, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3945/4511 (87.4529%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4081/4511 (90.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9857, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4174/4663 (89.5132%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4328/4663 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0579, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3878/4336 (89.4373%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3991/4336 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9647, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4248/4928 (86.2013%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4421/4928 (89.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0377, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3622/4046 (89.5205%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3744/4046 (92.5358%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0173, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3214/3672 (87.5272%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3327/3672 (90.6046%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9199, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4014/4356 (92.1488%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4113/4356 (94.4215%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9385, Accuracy: 5597/10000 (55.9700%)
time spent on training: 236.62952828407288
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8292, Accuracy: 5954/10000 (59.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 7.8384, Accuracy: 467/9900 (4.7172%)
Done in 260.41061305999756 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 44.04835211694928.
Norm before scaling: 44.04874009442552. Distance: 2.1126346974063117
Total norm for 4 adversaries is: 44.04874009442552. distance: 2.1126346974063117
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2041, Accuracy: 9403/9900 (94.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4725/5305 (89.0669%), train_poison_data_count: 415
Global model norm: 44.04835211694928.
Norm before scaling: 44.048421398892096. Distance: 2.2957736118900707
Total norm for 4 adversaries is: 44.048421398892096. distance: 2.2957736118900707
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1943, Accuracy: 9439/9900 (95.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 44.04835211694928.
Norm before scaling: 44.04380975499707. Distance: 2.088396772906242
Total norm for 4 adversaries is: 44.04380975499707. distance: 2.088396772906242
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1983, Accuracy: 9407/9900 (95.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4482/5066 (88.4722%), train_poison_data_count: 400
Global model norm: 44.04835211694928.
Norm before scaling: 44.05155005785835. Distance: 2.315728897461464
Total norm for 4 adversaries is: 44.05155005785835. distance: 2.315728897461464
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1937, Accuracy: 9401/9900 (94.9596%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4365/5037 (86.6587%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4602/5037 (91.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9830, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4060/4647 (87.3682%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4164/4647 (89.6062%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9392, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4163/4663 (89.2773%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4257/4663 (91.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0027, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3846/4336 (88.6993%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3946/4336 (91.0055%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9405, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3372/3756 (89.7764%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3466/3756 (92.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9140, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4104/4625 (88.7351%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4170/4625 (90.1622%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9585, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3875/4362 (88.8354%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4031/4362 (92.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0153, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4289/4874 (87.9975%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4359/4874 (89.4337%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0419, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4093/4767 (85.8611%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4268/4767 (89.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1147, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3328/3775 (88.1589%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3524/3775 (93.3510%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8698, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4098/4662 (87.9022%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4199/4662 (90.0686%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9055, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5385/6124 (87.9327%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5462/6124 (89.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9726, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3924/4511 (86.9874%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4066/4511 (90.1352%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9339, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3512/3911 (89.7980%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3500/3911 (89.4912%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8900, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4861/5591 (86.9433%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4991/5591 (89.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1197, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3613/4126 (87.5667%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3763/4126 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9645, Accuracy: 5394/10000 (53.9400%)
time spent on training: 232.729674577713
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.7350, Accuracy: 6101/10000 (61.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 8.0237, Accuracy: 427/9900 (4.3131%)
Done in 256.4518961906433 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 44.08330902695061.
Norm before scaling: 44.08152016346391. Distance: 2.1308733610119033
Total norm for 4 adversaries is: 44.08152016346391. distance: 2.1308733610119033
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1159, Accuracy: 9641/9900 (97.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4722/5305 (89.0104%), train_poison_data_count: 415
Global model norm: 44.08330902695061.
Norm before scaling: 44.084024828924. Distance: 2.3224702300595674
Total norm for 4 adversaries is: 44.084024828924. distance: 2.3224702300595674
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1101, Accuracy: 9616/9900 (97.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 44.08330902695061.
Norm before scaling: 44.078005915294646. Distance: 2.080214174504708
Total norm for 4 adversaries is: 44.078005915294646. distance: 2.080214174504708
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0732, Accuracy: 9698/9900 (97.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4498/5066 (88.7880%), train_poison_data_count: 400
Global model norm: 44.08330902695061.
Norm before scaling: 44.08542455509672. Distance: 2.2755423433860704
Total norm for 4 adversaries is: 44.08542455509672. distance: 2.2755423433860704
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2080, Accuracy: 9354/9900 (94.4848%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4451/5025 (88.5771%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4564/5025 (90.8259%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1256, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4475/5116 (87.4707%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4548/5116 (88.8976%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2977, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4587/5167 (88.7749%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4708/5167 (91.1167%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1058, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3989/4558 (87.5165%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4015/4558 (88.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9393, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4075/4651 (87.6156%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4191/4651 (90.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9014, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3869/4336 (89.2297%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3951/4336 (91.1208%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9544, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4481/5055 (88.6449%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4610/5055 (91.1968%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9838, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3362/3775 (89.0596%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3511/3775 (93.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8474, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4567/5265 (86.7426%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4645/5265 (88.2241%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0245, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3600/4025 (89.4410%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3744/4025 (93.0186%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9136, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4335/4989 (86.8912%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4430/4989 (88.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9855, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4207/4793 (87.7738%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9146, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3320/3804 (87.2766%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3458/3804 (90.9043%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9807, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3329/3797 (87.6745%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3404/3797 (89.6497%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9908, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3944/4433 (88.9691%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4068/4433 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8942, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4151/4707 (88.1878%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4301/4707 (91.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8164, Accuracy: 5712/10000 (57.1200%)
time spent on training: 233.49469256401062
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7282, Accuracy: 6116/10000 (61.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 7.8680, Accuracy: 449/9900 (4.5354%)
Done in 257.29054284095764 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 44.119682531935226.
Norm before scaling: 44.11676346196959. Distance: 2.0624243982504025
Total norm for 4 adversaries is: 44.11676346196959. distance: 2.0624243982504025
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1824, Accuracy: 9461/9900 (95.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 44.119682531935226.
Norm before scaling: 44.11643834032772. Distance: 2.232930710308171
Total norm for 4 adversaries is: 44.11643834032772. distance: 2.232930710308171
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1192, Accuracy: 9599/9900 (96.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 44.119682531935226.
Norm before scaling: 44.1148417507681. Distance: 1.989629262290876
Total norm for 4 adversaries is: 44.1148417507681. distance: 1.989629262290876
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.3100, Accuracy: 9133/9900 (92.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 44.119682531935226.
Norm before scaling: 44.12405109195692. Distance: 2.281719002784089
Total norm for 4 adversaries is: 44.12405109195692. distance: 2.281719002784089
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1255, Accuracy: 9574/9900 (96.7071%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4761/5392 (88.2975%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4809/5392 (89.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0207, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4173/4663 (89.4917%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4297/4663 (92.1510%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0209, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3349/3797 (88.2012%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3379/3797 (88.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0632, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5013/5582 (89.8065%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5082/5582 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0993, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4553/5167 (88.1169%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4684/5167 (90.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1342, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3335/3781 (88.2042%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3349/3781 (88.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1607, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3503/3969 (88.2590%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3625/3969 (91.3328%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0038, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3373/3837 (87.9072%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3530/3837 (91.9990%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9085, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5347/5902 (90.5964%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5355/5902 (90.7320%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0728, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4817/5455 (88.3043%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4923/5455 (90.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0107, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4368/5037 (86.7183%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4483/5037 (89.0014%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9321, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4436/5017 (88.4194%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4568/5017 (91.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8877, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4371/4986 (87.6655%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4470/4986 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9564, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4606/5197 (88.6281%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4596/5197 (88.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3086, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3874/4361 (88.8328%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3742/4361 (85.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2386, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5624/6263 (89.7972%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5746/6263 (91.7452%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1395, Accuracy: 5327/10000 (53.2700%)
time spent on training: 239.34719681739807
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7163, Accuracy: 6126/10000 (61.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 8.3953, Accuracy: 314/9900 (3.1717%)
Done in 263.1705174446106 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 44.15203807096919.
Norm before scaling: 44.146676852832734. Distance: 2.082359187939885
Total norm for 4 adversaries is: 44.146676852832734. distance: 2.082359187939885
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0941, Accuracy: 9667/9900 (97.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 44.15203807096919.
Norm before scaling: 44.148852938896525. Distance: 2.236347101789026
Total norm for 4 adversaries is: 44.148852938896525. distance: 2.236347101789026
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0876, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4258/4717 (90.2692%), train_poison_data_count: 370
Global model norm: 44.15203807096919.
Norm before scaling: 44.143846674465856. Distance: 1.9769505055878838
Total norm for 4 adversaries is: 44.143846674465856. distance: 1.9769505055878838
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1046, Accuracy: 9623/9900 (97.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 44.15203807096919.
Norm before scaling: 44.14817275071034. Distance: 2.2236271298167947
Total norm for 4 adversaries is: 44.14817275071034. distance: 2.2236271298167947
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1928, Accuracy: 9411/9900 (95.0606%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4474/5017 (89.1768%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4596/5017 (91.6085%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7650, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4307/4928 (87.3985%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4446/4928 (90.2192%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9405, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3713/4184 (88.7428%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9122, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4191/4793 (87.4400%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0193, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5066/5740 (88.2578%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5143/5740 (89.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0549, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3393/3756 (90.3355%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3509/3756 (93.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8854, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3772/4235 (89.0673%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3883/4235 (91.6883%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9506, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3687/4223 (87.3076%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3849/4223 (91.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8733, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4515/5063 (89.1764%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4456/5063 (88.0111%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1051, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4430/4989 (88.7953%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9899, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4310/4928 (87.4594%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4451/4928 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9053, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5359/5902 (90.7997%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5306/5902 (89.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0367, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4009/4456 (89.9686%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4118/4456 (92.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8854, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5402/6124 (88.2103%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5462/6124 (89.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8772, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3397/3828 (88.7409%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3497/3828 (91.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9676, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3167/3616 (87.5830%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7690, Accuracy: 5904/10000 (59.0400%)
time spent on training: 234.13270545005798
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.6896, Accuracy: 6157/10000 (61.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 8.4899, Accuracy: 325/9900 (3.2828%)
Done in 257.8825852870941 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 44.18682593191663.
Norm before scaling: 44.18199665163402. Distance: 2.0635670300432913
Total norm for 4 adversaries is: 44.18199665163402. distance: 2.0635670300432913
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2136, Accuracy: 9399/9900 (94.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4725/5305 (89.0669%), train_poison_data_count: 415
Global model norm: 44.18682593191663.
Norm before scaling: 44.18424559267421. Distance: 2.2590291794052906
Total norm for 4 adversaries is: 44.18424559267421. distance: 2.2590291794052906
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2154, Accuracy: 9354/9900 (94.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 44.18682593191663.
Norm before scaling: 44.179642600551894. Distance: 2.011132134397344
Total norm for 4 adversaries is: 44.179642600551894. distance: 2.011132134397344
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1540, Accuracy: 9492/9900 (95.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4526/5066 (89.3407%), train_poison_data_count: 400
Global model norm: 44.18682593191663.
Norm before scaling: 44.18640739676414. Distance: 2.1916046868711576
Total norm for 4 adversaries is: 44.18640739676414. distance: 2.1916046868711576
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2157, Accuracy: 9347/9900 (94.4141%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3702/4223 (87.6628%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3859/4223 (91.3805%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0034, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3919/4362 (89.8441%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3958/4362 (90.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0209, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5663/6391 (88.6090%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5732/6391 (89.6886%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0238, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4160/4793 (86.7932%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4291/4793 (89.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2711, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3364/3756 (89.5634%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3497/3756 (93.1044%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9030, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4144/4618 (89.7358%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4151/4618 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9988, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3568/4025 (88.6460%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3736/4025 (92.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9241, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3180/3638 (87.4107%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3300/3638 (90.7092%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8106, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3903/4315 (90.4519%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3997/4315 (92.6304%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8704, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3832/4295 (89.2200%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3804/4295 (88.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9516, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4342/4928 (88.1088%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8160, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4361/4986 (87.4649%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4520/4986 (90.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9475, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3661/4126 (88.7300%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3755/4126 (91.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8186, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4389/4918 (89.2436%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4400/4918 (89.4673%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2362, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4515/5195 (86.9105%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4558/5195 (87.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1687, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5071/5740 (88.3449%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5241/5740 (91.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0447, Accuracy: 5441/10000 (54.4100%)
time spent on training: 233.4497106075287
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.6779, Accuracy: 6184/10000 (61.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 8.8037, Accuracy: 281/9900 (2.8384%)
Done in 257.2626693248749 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 44.222810657192234.
Norm before scaling: 44.21456335083145. Distance: 2.0460852344243974
Total norm for 4 adversaries is: 44.21456335083145. distance: 2.0460852344243974
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1398, Accuracy: 9539/9900 (96.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4757/5305 (89.6701%), train_poison_data_count: 415
Global model norm: 44.222810657192234.
Norm before scaling: 44.21815784718352. Distance: 2.2268517021954013
Total norm for 4 adversaries is: 44.21815784718352. distance: 2.2268517021954013
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2225, Accuracy: 9369/9900 (94.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 44.222810657192234.
Norm before scaling: 44.21377511767402. Distance: 1.9728108260523622
Total norm for 4 adversaries is: 44.21377511767402. distance: 1.9728108260523622
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.3924, Accuracy: 8972/9900 (90.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 44.222810657192234.
Norm before scaling: 44.22312947614701. Distance: 2.254007267795547
Total norm for 4 adversaries is: 44.22312947614701. distance: 2.254007267795547
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2109, Accuracy: 9370/9900 (94.6465%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2927/3297 (88.7777%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3054/3297 (92.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7488, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3387/3828 (88.4796%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3489/3828 (91.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9398, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4585/5063 (90.5590%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4491/5063 (88.7024%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8988, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3958/4501 (87.9360%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4037/4501 (89.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0675, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4198/4793 (87.5861%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4368/4793 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9649, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3736/4223 (88.4679%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3892/4223 (92.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0137, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3428/3756 (91.2673%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3490/3756 (92.9180%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8150, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3165/3638 (86.9984%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3321/3638 (91.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9077, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3193/3646 (87.5754%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3354/3646 (91.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8925, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4342/4874 (89.0849%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4316/4874 (88.5515%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0909, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5642/6263 (90.0846%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5736/6263 (91.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9903, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4389/5037 (87.1352%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4513/5037 (89.5970%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0704, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3939/4362 (90.3026%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4027/4362 (92.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8948, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4070/4356 (93.4343%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4082/4356 (93.7098%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9742, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4507/5116 (88.0962%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4547/5116 (88.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9404, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3918/4346 (90.1519%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4058/4346 (93.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8281, Accuracy: 5806/10000 (58.0600%)
time spent on training: 230.6072006225586
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.6730, Accuracy: 6188/10000 (61.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 8.5793, Accuracy: 322/9900 (3.2525%)
Done in 254.3779375553131 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 44.25604792929789.
Norm before scaling: 44.2500703455479. Distance: 2.100124051199363
Total norm for 4 adversaries is: 44.2500703455479. distance: 2.100124051199363
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1785, Accuracy: 9474/9900 (95.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 44.25604792929789.
Norm before scaling: 44.252650984326635. Distance: 2.206826961818801
Total norm for 4 adversaries is: 44.252650984326635. distance: 2.206826961818801
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2182, Accuracy: 9371/9900 (94.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4281/4717 (90.7568%), train_poison_data_count: 370
Global model norm: 44.25604792929789.
Norm before scaling: 44.24790061668887. Distance: 1.9890879135725832
Total norm for 4 adversaries is: 44.24790061668887. distance: 1.9890879135725832
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2289, Accuracy: 9305/9900 (93.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 44.25604792929789.
Norm before scaling: 44.25670439367421. Distance: 2.219463931992647
Total norm for 4 adversaries is: 44.25670439367421. distance: 2.219463931992647
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2060, Accuracy: 9352/9900 (94.4646%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4077/4518 (90.2390%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4154/4518 (91.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8700, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4041/4558 (88.6573%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4072/4558 (89.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0380, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3370/3804 (88.5910%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3454/3804 (90.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9775, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3366/3775 (89.1656%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3535/3775 (93.6424%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7529, Accuracy: 5922/10000 (59.2200%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4440/5083 (87.3500%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4549/5083 (89.4944%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0723, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4380/4928 (88.8799%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4503/4928 (91.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8825, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4592/5244 (87.5667%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4635/5244 (88.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0463, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4357/4989 (87.3321%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4508/4989 (90.3588%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8777, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4432/4986 (88.8889%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4482/4986 (89.8917%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8634, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3694/4175 (88.4790%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3777/4175 (90.4671%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9221, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4621/5232 (88.3219%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4653/5232 (88.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0721, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4687/5063 (92.5736%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4602/5063 (90.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0596, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4021/4441 (90.5427%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4097/4441 (92.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9996, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3207/3646 (87.9594%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3345/3646 (91.7444%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8430, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4597/5167 (88.9685%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4738/5167 (91.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1329, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4046/4538 (89.1582%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4164/4538 (91.7585%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8361, Accuracy: 5674/10000 (56.7400%)
time spent on training: 231.89943528175354
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.5891, Accuracy: 6348/10000 (63.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 8.6039, Accuracy: 395/9900 (3.9899%)
Done in 256.0041515827179 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 44.28982252060003.
Norm before scaling: 44.2813947267395. Distance: 2.026799652647053
Total norm for 4 adversaries is: 44.2813947267395. distance: 2.026799652647053
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.2257, Accuracy: 9367/9900 (94.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 44.28982252060003.
Norm before scaling: 44.281966737318704. Distance: 2.1546454610174512
Total norm for 4 adversaries is: 44.281966737318704. distance: 2.1546454610174512
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1607, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 44.28982252060003.
Norm before scaling: 44.28391427455981. Distance: 2.066544930143843
Total norm for 4 adversaries is: 44.28391427455981. distance: 2.066544930143843
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1187, Accuracy: 9614/9900 (97.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 44.28982252060003.
Norm before scaling: 44.28866215752204. Distance: 2.2463577248073188
Total norm for 4 adversaries is: 44.28866215752204. distance: 2.2463577248073188
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0735, Accuracy: 9694/9900 (97.9192%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4103/4356 (94.1919%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4084/4356 (93.7557%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9319, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4305/4928 (87.3580%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4429/4928 (89.8742%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0122, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4447/5037 (88.2867%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4534/5037 (90.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9981, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4470/4804 (93.0475%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4559/4804 (94.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7873, Accuracy: 5979/10000 (59.7900%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3428/3775 (90.8079%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3570/3775 (94.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7188, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4599/5167 (89.0072%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4668/5167 (90.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1800, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3783/4235 (89.3270%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3901/4235 (92.1133%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0440, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4349/4956 (87.7522%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4386/4956 (88.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9593, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5074/5740 (88.3972%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5277/5740 (91.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0737, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4345/4679 (92.8617%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4398/4679 (93.9944%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0433, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3263/3704 (88.0940%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3373/3704 (91.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8277, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3135/3472 (90.2938%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3214/3472 (92.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8292, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4132/4651 (88.8411%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4204/4651 (90.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0482, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4115/4634 (88.8002%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4202/4634 (90.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8154, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5350/5902 (90.6472%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5329/5902 (90.2914%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9245, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3379/3837 (88.0636%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3538/3837 (92.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8374, Accuracy: 5750/10000 (57.5000%)
time spent on training: 234.2004132270813
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.5674, Accuracy: 6347/10000 (63.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 8.4360, Accuracy: 432/9900 (4.3636%)
Done in 258.0078685283661 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 44.320689145455816.
Norm before scaling: 44.312501377380094. Distance: 1.9956105462950757
Total norm for 4 adversaries is: 44.312501377380094. distance: 1.9956105462950757
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.3501, Accuracy: 9061/9900 (91.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 44.320689145455816.
Norm before scaling: 44.314316727127675. Distance: 2.191002031604795
Total norm for 4 adversaries is: 44.314316727127675. distance: 2.191002031604795
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1472, Accuracy: 9536/9900 (96.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 44.320689145455816.
Norm before scaling: 44.31004544065742. Distance: 1.9810017427208604
Total norm for 4 adversaries is: 44.31004544065742. distance: 1.9810017427208604
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2848, Accuracy: 9218/9900 (93.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 44.320689145455816.
Norm before scaling: 44.31984771371837. Distance: 2.2621606055867804
Total norm for 4 adversaries is: 44.31984771371837. distance: 2.2621606055867804
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0927, Accuracy: 9680/9900 (97.7778%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3558/3969 (89.6447%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3615/3969 (91.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9327, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4193/4707 (89.0801%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4304/4707 (91.4383%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8319, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3463/3861 (89.6918%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3544/3861 (91.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8171, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4129/4596 (89.8390%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4197/4596 (91.3185%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9291, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4034/4503 (89.5847%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4077/4503 (90.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9705, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4413/4928 (89.5495%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4523/4928 (91.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9345, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4489/5025 (89.3333%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4534/5025 (90.2289%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0073, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4077/4576 (89.0953%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4177/4576 (91.2806%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9629, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4364/4918 (88.7353%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4496/4918 (91.4193%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9073, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3919/4315 (90.8227%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3941/4315 (91.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9784, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3235/3590 (90.1114%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3255/3590 (90.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9119, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4002/4456 (89.8115%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4106/4456 (92.1454%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8816, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4216/4354 (96.8305%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3993/4354 (91.7088%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1342, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4017/4501 (89.2468%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4083/4501 (90.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8584, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3525/3911 (90.1304%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3533/3911 (90.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0566, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4063/4558 (89.1400%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4112/4558 (90.2150%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0406, Accuracy: 5389/10000 (53.8900%)
time spent on training: 230.41398811340332
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.5538, Accuracy: 6386/10000 (63.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 8.3275, Accuracy: 437/9900 (4.4141%)
Done in 254.23970532417297 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 44.346171038119934.
Norm before scaling: 44.34030471332276. Distance: 2.0250852496251883
Total norm for 4 adversaries is: 44.34030471332276. distance: 2.0250852496251883
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1954, Accuracy: 9414/9900 (95.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 44.346171038119934.
Norm before scaling: 44.340592404315316. Distance: 2.206004107985904
Total norm for 4 adversaries is: 44.340592404315316. distance: 2.206004107985904
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1475, Accuracy: 9541/9900 (96.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4292/4717 (90.9900%), train_poison_data_count: 370
Global model norm: 44.346171038119934.
Norm before scaling: 44.338172438162694. Distance: 1.9855520407072718
Total norm for 4 adversaries is: 44.338172438162694. distance: 1.9855520407072718
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1331, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 44.346171038119934.
Norm before scaling: 44.34455656859841. Distance: 2.225432420351166
Total norm for 4 adversaries is: 44.34455656859841. distance: 2.225432420351166
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1927, Accuracy: 9395/9900 (94.8990%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4495/5116 (87.8616%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4586/5116 (89.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1342, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4814/5392 (89.2804%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4796/5392 (88.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0276, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4150/4767 (87.0568%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4252/4767 (89.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0606, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4164/4618 (90.1689%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4093/4618 (88.6314%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1174, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3618/4046 (89.4217%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3701/4046 (91.4731%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9384, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4104/4625 (88.7351%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4203/4625 (90.8757%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8735, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3219/3638 (88.4827%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3377/3638 (92.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8589, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3873/4416 (87.7038%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3955/4416 (89.5607%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0407, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4310/4874 (88.4284%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4326/4874 (88.7567%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2636, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3221/3646 (88.3434%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3336/3646 (91.4975%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7802, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4684/5063 (92.5143%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4573/5063 (90.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0327, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3686/4126 (89.3359%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3808/4126 (92.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8572, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4525/4934 (91.7106%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4546/4934 (92.1362%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1227, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4037/4511 (89.4924%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8853, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4072/4518 (90.1284%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4171/4518 (92.3196%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9006, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2984/3297 (90.5065%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3049/3297 (92.4780%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7847, Accuracy: 5791/10000 (57.9100%)
time spent on training: 229.1169090270996
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.5856, Accuracy: 6334/10000 (63.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 9.0135, Accuracy: 256/9900 (2.5859%)
Done in 252.7221336364746 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 44.37467264403902.
Norm before scaling: 44.36905770072202. Distance: 2.0803517049768643
Total norm for 4 adversaries is: 44.36905770072202. distance: 2.0803517049768643
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0729, Accuracy: 9709/9900 (98.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 44.37467264403902.
Norm before scaling: 44.3694304933553. Distance: 2.2187266818688305
Total norm for 4 adversaries is: 44.3694304933553. distance: 2.2187266818688305
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1096, Accuracy: 9647/9900 (97.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 44.37467264403902.
Norm before scaling: 44.36466511473052. Distance: 1.9963528638504227
Total norm for 4 adversaries is: 44.36466511473052. distance: 1.9963528638504227
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2163, Accuracy: 9353/9900 (94.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 44.37467264403902.
Norm before scaling: 44.371917531583954. Distance: 2.2410665760628237
Total norm for 4 adversaries is: 44.371917531583954. distance: 2.2410665760628237
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1907, Accuracy: 9443/9900 (95.3838%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5446/6124 (88.9288%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5484/6124 (89.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9863, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4459/5025 (88.7363%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0197, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3114/3472 (89.6889%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3152/3472 (90.7834%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0479, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4464/5037 (88.6242%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4534/5037 (90.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8798, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5050/5582 (90.4694%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5120/5582 (91.7234%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0284, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4511/5116 (88.1744%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4616/5116 (90.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0769, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4054/4518 (89.7300%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9244, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4313/4928 (87.5203%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4434/4928 (89.9756%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9372, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4028/4558 (88.3721%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4020/4558 (88.1966%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0673, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2934/3297 (88.9900%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3057/3297 (92.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8264, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3408/3756 (90.7348%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3527/3756 (93.9031%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9213, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4152/4651 (89.2711%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4231/4651 (90.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9493, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3951/4441 (88.9664%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4107/4441 (92.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0543, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3214/3638 (88.3452%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3318/3638 (91.2040%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8312, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4132/4596 (89.9043%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4230/4596 (92.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9977, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2892/3271 (88.4133%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2948/3271 (90.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9273, Accuracy: 5560/10000 (55.6000%)
time spent on training: 231.63554191589355
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.5829, Accuracy: 6316/10000 (63.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 8.7302, Accuracy: 331/9900 (3.3434%)
Done in 255.5045931339264 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 44.413117706529704.
Norm before scaling: 44.40473255676133. Distance: 2.032259294208715
Total norm for 4 adversaries is: 44.40473255676133. distance: 2.032259294208715
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2694, Accuracy: 9202/9900 (92.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 44.413117706529704.
Norm before scaling: 44.40735781077698. Distance: 2.2247764517963438
Total norm for 4 adversaries is: 44.40735781077698. distance: 2.2247764517963438
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0776, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4259/4717 (90.2904%), train_poison_data_count: 370
Global model norm: 44.413117706529704.
Norm before scaling: 44.40386935033084. Distance: 2.017015672334409
Total norm for 4 adversaries is: 44.40386935033084. distance: 2.017015672334409
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2438, Accuracy: 9294/9900 (93.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4582/5066 (90.4461%), train_poison_data_count: 400
Global model norm: 44.413117706529704.
Norm before scaling: 44.405481663391654. Distance: 2.1745680983093103
Total norm for 4 adversaries is: 44.405481663391654. distance: 2.1745680983093103
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2431, Accuracy: 9272/9900 (93.6566%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4446/4989 (89.1161%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4486/4989 (89.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0029, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4027/4465 (90.1904%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4136/4465 (92.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8204, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3908/4315 (90.5678%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4010/4315 (92.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8224, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4121/4767 (86.4485%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4278/4767 (89.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2418, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5745/6391 (89.8920%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5782/6391 (90.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9931, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3263/3672 (88.8617%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3326/3672 (90.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9541, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3558/3969 (89.6447%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3588/3969 (90.4006%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8256, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3214/3590 (89.5265%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3152/3590 (87.7994%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1920, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5388/5902 (91.2911%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5334/5902 (90.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2354, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3652/4013 (91.0042%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3751/4013 (93.4712%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7392, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4457/4804 (92.7769%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4080/4804 (84.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3735, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3669/4175 (87.8802%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3787/4175 (90.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9394, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3192/3616 (88.2743%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3320/3616 (91.8142%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7579, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3970/4361 (91.0342%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3949/4361 (90.5526%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9447, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4851/5424 (89.4358%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4968/5424 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3283, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3424/3837 (89.2364%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3566/3837 (92.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9546, Accuracy: 5651/10000 (56.5100%)
time spent on training: 231.5926444530487
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7616, Accuracy: 6079/10000 (60.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 9.5365, Accuracy: 157/9900 (1.5859%)
Done in 255.22423815727234 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4480/4885 (91.7093%), train_poison_data_count: 385
Global model norm: 44.44788386282087.
Norm before scaling: 44.43769091687188. Distance: 2.0066906358970784
Total norm for 4 adversaries is: 44.43769091687188. distance: 2.0066906358970784
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1757, Accuracy: 9451/9900 (95.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 44.44788386282087.
Norm before scaling: 44.44228228925834. Distance: 2.223546498482617
Total norm for 4 adversaries is: 44.44228228925834. distance: 2.223546498482617
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2617, Accuracy: 9257/9900 (93.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 44.44788386282087.
Norm before scaling: 44.43721705694029. Distance: 1.9719221807720695
Total norm for 4 adversaries is: 44.43721705694029. distance: 1.9719221807720695
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3570, Accuracy: 9014/9900 (91.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4535/5066 (89.5184%), train_poison_data_count: 400
Global model norm: 44.44788386282087.
Norm before scaling: 44.442041950988674. Distance: 2.2065596625246746
Total norm for 4 adversaries is: 44.442041950988674. distance: 2.2065596625246746
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1245, Accuracy: 9570/9900 (96.6667%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3824/4416 (86.5942%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3992/4416 (90.3986%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9133, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5081/5740 (88.5192%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5235/5740 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0516, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4443/5037 (88.2073%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4599/5037 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9006, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4548/5116 (88.8976%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4608/5116 (90.0704%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8966, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4395/4918 (89.3656%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4473/4918 (90.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0060, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3421/3837 (89.1582%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3546/3837 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8269, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4155/4651 (89.3356%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4225/4651 (90.8407%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9166, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3471/3861 (89.8990%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3558/3861 (92.1523%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8682, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3724/4223 (88.1838%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3901/4223 (92.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8565, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4173/4662 (89.5109%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4292/4662 (92.0635%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8747, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5677/6263 (90.6435%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5740/6263 (91.6494%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9647, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3378/3781 (89.3414%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3271/3781 (86.5115%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1479, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3405/3804 (89.5110%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3481/3804 (91.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9838, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3445/3828 (89.9948%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3563/3828 (93.0773%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7575, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3905/4315 (90.4983%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4018/4315 (93.1170%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8573, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4451/4956 (89.8103%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4484/4956 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9096, Accuracy: 5634/10000 (56.3400%)
time spent on training: 231.86237335205078
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7157, Accuracy: 6139/10000 (61.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 10.0353, Accuracy: 121/9900 (1.2222%)
Done in 255.55236673355103 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4457/4885 (91.2385%), train_poison_data_count: 385
Global model norm: 44.47572333105233.
Norm before scaling: 44.46613935151246. Distance: 2.056729886254441
Total norm for 4 adversaries is: 44.46613935151246. distance: 2.056729886254441
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1142, Accuracy: 9611/9900 (97.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 44.47572333105233.
Norm before scaling: 44.47002781676033. Distance: 2.2000898732988254
Total norm for 4 adversaries is: 44.47002781676033. distance: 2.2000898732988254
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1086, Accuracy: 9635/9900 (97.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 44.47572333105233.
Norm before scaling: 44.46922352391947. Distance: 2.02468244629406
Total norm for 4 adversaries is: 44.46922352391947. distance: 2.02468244629406
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1257, Accuracy: 9605/9900 (97.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 44.47572333105233.
Norm before scaling: 44.47039564549868. Distance: 2.174903569330988
Total norm for 4 adversaries is: 44.47039564549868. distance: 2.174903569330988
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2216, Accuracy: 9354/9900 (94.4848%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4164/4662 (89.3179%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4286/4662 (91.9348%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9645, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3212/3616 (88.8274%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3305/3616 (91.3993%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0033, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3417/3828 (89.2633%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3572/3828 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8181, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2927/3297 (88.7777%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3023/3297 (91.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7493, Accuracy: 5972/10000 (59.7200%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3927/4361 (90.0482%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3892/4361 (89.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0021, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4082/4576 (89.2045%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4191/4576 (91.5865%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9673, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3791/4295 (88.2654%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3759/4295 (87.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0332, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4595/5083 (90.3994%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4640/5083 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9796, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4532/5116 (88.5848%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4599/5116 (89.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9435, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3636/4046 (89.8665%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3761/4046 (92.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7801, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5354/5902 (90.7150%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5298/5902 (89.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0458, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4684/5197 (90.1289%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4694/5197 (90.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0768, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4049/4465 (90.6831%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4169/4465 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7858, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3253/3704 (87.8240%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3395/3704 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7799, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3457/3861 (89.5364%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3562/3861 (92.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8617, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3690/4126 (89.4329%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3823/4126 (92.6563%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8019, Accuracy: 5747/10000 (57.4700%)
time spent on training: 230.09512042999268
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7172, Accuracy: 6157/10000 (61.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 9.6619, Accuracy: 130/9900 (1.3131%)
Done in 253.94536924362183 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 44.504194083430214.
Norm before scaling: 44.4925421133805. Distance: 2.0281551552809813
Total norm for 4 adversaries is: 44.4925421133805. distance: 2.0281551552809813
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2798, Accuracy: 9207/9900 (93.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 44.504194083430214.
Norm before scaling: 44.49593583310798. Distance: 2.2044220481374923
Total norm for 4 adversaries is: 44.49593583310798. distance: 2.2044220481374923
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2267, Accuracy: 9327/9900 (94.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 44.504194083430214.
Norm before scaling: 44.49633499654775. Distance: 1.9732501354055576
Total norm for 4 adversaries is: 44.49633499654775. distance: 1.9732501354055576
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2285, Accuracy: 9332/9900 (94.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 44.504194083430214.
Norm before scaling: 44.50107393147594. Distance: 2.2027486926170057
Total norm for 4 adversaries is: 44.50107393147594. distance: 2.2027486926170057
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.3033, Accuracy: 9193/9900 (92.8586%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4017/4511 (89.0490%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4099/4511 (90.8668%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8847, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5093/5740 (88.7282%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5195/5740 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0494, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4192/4662 (89.9185%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4296/4662 (92.1493%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8953, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3792/4235 (89.5396%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3911/4235 (92.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9674, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4805/5265 (91.2631%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4806/5265 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9550, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4013/4433 (90.5256%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4064/4433 (91.6761%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9053, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4184/4596 (91.0357%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4269/4596 (92.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9959, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4579/5055 (90.5836%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4673/5055 (92.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8627, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4453/5037 (88.4058%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4548/5037 (90.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0141, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4118/4538 (90.7448%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4236/4538 (93.3451%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7600, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3422/3756 (91.1076%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3503/3756 (93.2641%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8890, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3645/4025 (90.5590%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3726/4025 (92.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8829, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4575/5244 (87.2426%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4611/5244 (87.9291%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9815, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4217/4663 (90.4353%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4308/4663 (92.3869%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9393, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3417/3837 (89.0539%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3555/3837 (92.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8928, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4063/4481 (90.6717%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4027/4481 (89.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0288, Accuracy: 5580/10000 (55.8000%)
time spent on training: 232.33785581588745
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7266, Accuracy: 6131/10000 (61.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.5120, Accuracy: 137/9900 (1.3838%)
Done in 256.11033940315247 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 44.54032939239238.
Norm before scaling: 44.535443881460864. Distance: 2.125185116951235
Total norm for 4 adversaries is: 44.535443881460864. distance: 2.125185116951235
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1871, Accuracy: 9462/9900 (95.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 44.54032939239238.
Norm before scaling: 44.531398026069766. Distance: 2.1911836398881266
Total norm for 4 adversaries is: 44.531398026069766. distance: 2.1911836398881266
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1990, Accuracy: 9402/9900 (94.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4267/4717 (90.4600%), train_poison_data_count: 370
Global model norm: 44.54032939239238.
Norm before scaling: 44.53245064170902. Distance: 2.01031706041115
Total norm for 4 adversaries is: 44.53245064170902. distance: 2.01031706041115
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1352, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4526/5066 (89.3407%), train_poison_data_count: 400
Global model norm: 44.54032939239238.
Norm before scaling: 44.533108513848994. Distance: 2.2386900310482347
Total norm for 4 adversaries is: 44.533108513848994. distance: 2.2386900310482347
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1600, Accuracy: 9477/9900 (95.7273%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3973/4362 (91.0821%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3897/4362 (89.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1148, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5004/5591 (89.5010%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5056/5591 (90.4310%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0827, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3902/4315 (90.4287%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3979/4315 (92.2132%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9700, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3475/3781 (91.9069%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3522/3781 (93.1500%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9113, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3627/4158 (87.2294%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3734/4158 (89.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.7926, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4010/4511 (88.8938%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4097/4511 (90.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8982, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4237/4793 (88.3997%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9259, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4915/5424 (90.6158%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4985/5424 (91.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3215, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4232/4618 (91.6414%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4292/4618 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8280, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3901/4368 (89.3086%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3950/4368 (90.4304%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1375, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4510/4934 (91.4066%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4203/4934 (85.1844%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3153, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4641/5232 (88.7041%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4677/5232 (89.3922%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9998, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5408/5902 (91.6300%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5388/5902 (91.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2775, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4834/5392 (89.6513%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4880/5392 (90.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0344, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4542/5017 (90.5322%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4570/5017 (91.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9282, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4641/5195 (89.3359%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4668/5195 (89.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9939, Accuracy: 5571/10000 (55.7100%)
time spent on training: 237.62947368621826
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8147, Accuracy: 5998/10000 (59.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 8.9140, Accuracy: 221/9900 (2.2323%)
Done in 261.40511178970337 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 44.579113531801525.
Norm before scaling: 44.57078426021145. Distance: 2.0484287101737424
Total norm for 4 adversaries is: 44.57078426021145. distance: 2.0484287101737424
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2865, Accuracy: 9203/9900 (92.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 44.579113531801525.
Norm before scaling: 44.571731873762346. Distance: 2.199461359495006
Total norm for 4 adversaries is: 44.571731873762346. distance: 2.199461359495006
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2264, Accuracy: 9365/9900 (94.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 44.579113531801525.
Norm before scaling: 44.566870348019584. Distance: 1.9760039373350877
Total norm for 4 adversaries is: 44.566870348019584. distance: 1.9760039373350877
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.4804, Accuracy: 8781/9900 (88.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4590/5066 (90.6040%), train_poison_data_count: 400
Global model norm: 44.579113531801525.
Norm before scaling: 44.57129641223359. Distance: 2.1700621799051154
Total norm for 4 adversaries is: 44.57129641223359. distance: 2.1700621799051154
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2400, Accuracy: 9264/9900 (93.5758%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4771/5265 (90.6173%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4778/5265 (90.7502%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9290, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3707/4126 (89.8449%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3783/4126 (91.6869%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7914, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4009/4501 (89.0691%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4045/4501 (89.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0618, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5535/6124 (90.3821%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5516/6124 (90.0718%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0233, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2930/3271 (89.5751%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2944/3271 (90.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9322, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4186/4663 (89.7705%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4312/4663 (92.4727%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9566, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3639/4025 (90.4099%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3739/4025 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7903, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4132/4651 (88.8411%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4241/4651 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0559, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4521/4804 (94.1091%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4496/4804 (93.5887%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9113, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3208/3616 (88.7168%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3311/3616 (91.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8074, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3559/3911 (90.9997%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3398/3911 (86.8832%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1453, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4659/5197 (89.6479%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4725/5197 (90.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0207, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4133/4538 (91.0754%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8598, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5678/6391 (88.8437%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5767/6391 (90.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9428, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3265/3704 (88.1479%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3370/3704 (90.9827%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7781, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3805/4235 (89.8465%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3754/4235 (88.6423%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0569, Accuracy: 5453/10000 (54.5300%)
time spent on training: 233.13304018974304
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7938, Accuracy: 5995/10000 (59.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 8.4042, Accuracy: 260/9900 (2.6263%)
Done in 256.85014128685 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 44.606742479241575.
Norm before scaling: 44.60195866547651. Distance: 2.1064126017033087
Total norm for 4 adversaries is: 44.60195866547651. distance: 2.1064126017033087
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1379, Accuracy: 9540/9900 (96.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 44.606742479241575.
Norm before scaling: 44.5965310975809. Distance: 2.1690294025304837
Total norm for 4 adversaries is: 44.5965310975809. distance: 2.1690294025304837
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0695, Accuracy: 9719/9900 (98.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4259/4717 (90.2904%), train_poison_data_count: 370
Global model norm: 44.606742479241575.
Norm before scaling: 44.59717844432888. Distance: 2.0200357600153325
Total norm for 4 adversaries is: 44.59717844432888. distance: 2.0200357600153325
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1937, Accuracy: 9444/9900 (95.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 44.606742479241575.
Norm before scaling: 44.59989090294602. Distance: 2.196742125137921
Total norm for 4 adversaries is: 44.59989090294602. distance: 2.196742125137921
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1616, Accuracy: 9477/9900 (95.7273%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4526/5116 (88.4676%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4632/5116 (90.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8759, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5074/5582 (90.8993%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5191/5582 (92.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1399, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3850/4235 (90.9091%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3816/4235 (90.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0628, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4131/4625 (89.3189%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4188/4625 (90.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1517, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4010/4481 (89.4890%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4053/4481 (90.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9941, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4670/5232 (89.2584%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4737/5232 (90.5390%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9359, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4196/4662 (90.0043%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4343/4662 (93.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9047, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4075/4441 (91.7586%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4167/4441 (93.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0168, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4097/4518 (90.6817%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4209/4518 (93.1607%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8697, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4384/4928 (88.9610%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4503/4928 (91.3758%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8860, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4120/4634 (88.9081%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4239/4634 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9647, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4622/4934 (93.6765%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4607/4934 (93.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8793, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3451/3861 (89.3810%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3541/3861 (91.7120%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8892, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3189/3616 (88.1914%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3297/3616 (91.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8141, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3896/4416 (88.2246%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3983/4416 (90.1947%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0223, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3383/3797 (89.0967%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3484/3797 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9097, Accuracy: 5719/10000 (57.1900%)
time spent on training: 233.423259973526
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.7398, Accuracy: 6048/10000 (60.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 8.7976, Accuracy: 213/9900 (2.1515%)
Done in 257.15886902809143 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4463/4885 (91.3613%), train_poison_data_count: 385
Global model norm: 44.63572311859989.
Norm before scaling: 44.629446283658254. Distance: 2.0867760505078508
Total norm for 4 adversaries is: 44.629446283658254. distance: 2.0867760505078508
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1891, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 44.63572311859989.
Norm before scaling: 44.62485638763656. Distance: 2.142728454267887
Total norm for 4 adversaries is: 44.62485638763656. distance: 2.142728454267887
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1062, Accuracy: 9630/9900 (97.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 44.63572311859989.
Norm before scaling: 44.622654273519665. Distance: 1.9542923147425495
Total norm for 4 adversaries is: 44.622654273519665. distance: 1.9542923147425495
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3236, Accuracy: 9090/9900 (91.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 44.63572311859989.
Norm before scaling: 44.62674382753505. Distance: 2.1550961046850015
Total norm for 4 adversaries is: 44.62674382753505. distance: 2.1550961046850015
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3289, Accuracy: 9105/9900 (91.9697%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5666/6263 (90.4678%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0777, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3934/4295 (91.5949%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3885/4295 (90.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9227, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4379/4989 (87.7731%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4498/4989 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8003, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3779/4223 (89.4861%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3883/4223 (91.9489%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8701, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5546/6124 (90.5617%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5605/6124 (91.5251%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0063, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4129/4481 (92.1446%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4073/4481 (90.8949%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9988, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4268/4618 (92.4210%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4219/4618 (91.3599%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8709, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4075/4441 (91.7586%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4115/4441 (92.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9643, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3625/4013 (90.3314%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3726/4013 (92.8482%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8628, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3985/4511 (88.3396%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4125/4511 (91.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8699, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3868/4416 (87.5906%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4026/4416 (91.1685%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8801, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4956 (89.3462%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4471/4956 (90.2139%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9711, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4094/4538 (90.2160%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4213/4538 (92.8383%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8573, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4714/5265 (89.5347%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4836/5265 (91.8519%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8863, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4671/5197 (89.8788%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4635/5197 (89.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1929, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4198/4716 (89.0161%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4276/4716 (90.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9900, Accuracy: 5492/10000 (54.9200%)
time spent on training: 236.27669405937195
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7293, Accuracy: 6117/10000 (61.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 8.6265, Accuracy: 217/9900 (2.1919%)
Done in 260.1169044971466 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 44.66677567957391.
Norm before scaling: 44.656124256296025. Distance: 2.040345471618639
Total norm for 4 adversaries is: 44.656124256296025. distance: 2.040345471618639
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2596, Accuracy: 9260/9900 (93.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4775/5305 (90.0094%), train_poison_data_count: 415
Global model norm: 44.66677567957391.
Norm before scaling: 44.6618835013776. Distance: 2.250822764539804
Total norm for 4 adversaries is: 44.6618835013776. distance: 2.250822764539804
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1426, Accuracy: 9538/9900 (96.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 44.66677567957391.
Norm before scaling: 44.657071425702696. Distance: 1.9872961095676358
Total norm for 4 adversaries is: 44.657071425702696. distance: 1.9872961095676358
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1363, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4547/5066 (89.7552%), train_poison_data_count: 400
Global model norm: 44.66677567957391.
Norm before scaling: 44.65898893804863. Distance: 2.1718460190849704
Total norm for 4 adversaries is: 44.65898893804863. distance: 2.1718460190849704
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2451, Accuracy: 9289/9900 (93.8283%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3229/3616 (89.2976%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3318/3616 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8744, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3928/4315 (91.0313%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4004/4315 (92.7926%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8566, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4898/5455 (89.7892%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4880/5455 (89.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0240, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4531/4804 (94.3172%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4412/4804 (91.8401%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0093, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3976/4362 (91.1508%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3971/4362 (91.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0104, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5642/6263 (90.0846%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5740/6263 (91.6494%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9657, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4167/4538 (91.8246%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4225/4538 (93.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8723, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4162/4634 (89.8144%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4251/4634 (91.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8992, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4523/5116 (88.4089%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4625/5116 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8768, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4124/4716 (87.4470%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4264/4716 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0555, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3639/4046 (89.9407%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3717/4046 (91.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8612, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4059/4518 (89.8406%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4143/4518 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9099, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4651/5063 (91.8625%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4584/5063 (90.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1373, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5160/5740 (89.8955%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5232/5740 (91.1498%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9839, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5085/5582 (91.0964%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5121/5582 (91.7413%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0936, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4021/4433 (90.7061%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4069/4433 (91.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9305, Accuracy: 5566/10000 (55.6600%)
time spent on training: 233.39102029800415
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7087, Accuracy: 6119/10000 (61.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 8.4215, Accuracy: 264/9900 (2.6667%)
Done in 257.34455609321594 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 44.6988963287441.
Norm before scaling: 44.688617228167004. Distance: 2.0449553362159087
Total norm for 4 adversaries is: 44.688617228167004. distance: 2.0449553362159087
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1141, Accuracy: 9621/9900 (97.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 44.6988963287441.
Norm before scaling: 44.69106874954505. Distance: 2.1905272109643144
Total norm for 4 adversaries is: 44.69106874954505. distance: 2.1905272109643144
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1239, Accuracy: 9574/9900 (96.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 44.6988963287441.
Norm before scaling: 44.686344499921056. Distance: 1.9931181286047133
Total norm for 4 adversaries is: 44.686344499921056. distance: 1.9931181286047133
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2253, Accuracy: 9352/9900 (94.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 44.6988963287441.
Norm before scaling: 44.690943103808095. Distance: 2.166252928135869
Total norm for 4 adversaries is: 44.690943103808095. distance: 2.166252928135869
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2224, Accuracy: 9302/9900 (93.9596%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4755/5197 (91.4951%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4625/5197 (88.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1361, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3625/4025 (90.0621%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3755/4025 (93.2919%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8426, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4134/4481 (92.2562%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4125/4481 (92.0553%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9483, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4136/4651 (88.9271%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4284/4651 (92.1092%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8335, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5375/5902 (91.0708%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5310/5902 (89.9695%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0545, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3675/4126 (89.0693%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3795/4126 (91.9777%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7864, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3910/4368 (89.5147%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0667, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5792/6391 (90.6274%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5766/6391 (90.2206%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1118, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3726/4175 (89.2455%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3790/4175 (90.7784%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8882, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4140/4596 (90.0783%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4241/4596 (92.2759%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8878, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4171/4634 (90.0086%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4242/4634 (91.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9022, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3808/4223 (90.1729%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3892/4223 (92.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9737, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3618/3911 (92.5083%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3410/3911 (87.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9706, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3988/4433 (89.9617%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4103/4433 (92.5558%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8308, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3915/4336 (90.2906%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3987/4336 (91.9511%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0301, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3215/3638 (88.3727%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3334/3638 (91.6438%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8610, Accuracy: 5622/10000 (56.2200%)
time spent on training: 229.47945189476013
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7323, Accuracy: 6073/10000 (60.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 8.0756, Accuracy: 300/9900 (3.0303%)
Done in 253.1553339958191 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4466/4885 (91.4227%), train_poison_data_count: 385
Global model norm: 44.72767670555405.
Norm before scaling: 44.722223452192225. Distance: 2.048925988375633
Total norm for 4 adversaries is: 44.722223452192225. distance: 2.048925988375633
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.3401, Accuracy: 9089/9900 (91.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 44.72767670555405.
Norm before scaling: 44.72118076246492. Distance: 2.2156025227642693
Total norm for 4 adversaries is: 44.72118076246492. distance: 2.2156025227642693
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1148, Accuracy: 9609/9900 (97.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 44.72767670555405.
Norm before scaling: 44.714573311239924. Distance: 1.977607300134413
Total norm for 4 adversaries is: 44.714573311239924. distance: 1.977607300134413
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1406, Accuracy: 9518/9900 (96.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4576/5066 (90.3277%), train_poison_data_count: 400
Global model norm: 44.72767670555405.
Norm before scaling: 44.71984051561664. Distance: 2.1578617430087865
Total norm for 4 adversaries is: 44.71984051561664. distance: 2.1578617430087865
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2603, Accuracy: 9243/9900 (93.3636%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3391/3756 (90.2822%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3517/3756 (93.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8679, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4918/5424 (90.6711%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4997/5424 (92.1276%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0096, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4018/4433 (90.6384%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4057/4433 (91.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9052, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3989/4501 (88.6248%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4078/4501 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9630, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3665/4025 (91.0559%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3785/4025 (94.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8081, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3806/4235 (89.8701%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3853/4235 (90.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8981, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5614/6124 (91.6721%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5568/6124 (90.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9269, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4182/4634 (90.2460%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4233/4634 (91.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9591, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4213/4716 (89.3342%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0543, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4181/4767 (87.7072%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4235/4767 (88.8399%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0526, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3421/3804 (89.9317%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3503/3804 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9920, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3147/3472 (90.6394%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3264/3472 (94.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8849, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4866/5392 (90.2448%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4879/5392 (90.4859%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0364, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5146/5740 (89.6516%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5186/5740 (90.3484%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0935, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4161/4596 (90.5352%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4279/4596 (93.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9204, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3212/3616 (88.8274%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3338/3616 (92.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8218, Accuracy: 5796/10000 (57.9600%)
time spent on training: 231.62192487716675
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7214, Accuracy: 6071/10000 (60.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 8.6557, Accuracy: 210/9900 (2.1212%)
Done in 255.288969039917 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 44.75950683540244.
Norm before scaling: 44.747891339110886. Distance: 2.0461571286331246
Total norm for 4 adversaries is: 44.747891339110886. distance: 2.0461571286331246
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1011, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 44.75950683540244.
Norm before scaling: 44.75283957907727. Distance: 2.2156939884523466
Total norm for 4 adversaries is: 44.75283957907727. distance: 2.2156939884523466
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0906, Accuracy: 9675/9900 (97.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 44.75950683540244.
Norm before scaling: 44.74936986724646. Distance: 2.0213255004370376
Total norm for 4 adversaries is: 44.74936986724646. distance: 2.0213255004370376
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0503, Accuracy: 9784/9900 (98.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4546/5066 (89.7355%), train_poison_data_count: 400
Global model norm: 44.75950683540244.
Norm before scaling: 44.75297459780258. Distance: 2.1877630892991826
Total norm for 4 adversaries is: 44.75297459780258. distance: 2.1877630892991826
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.2268, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4673/5063 (92.2971%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4640/5063 (91.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9537, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4508/4804 (93.8385%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4441/4804 (92.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9636, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4042/4558 (88.6792%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4099/4558 (89.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1224, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3413/3756 (90.8679%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3541/3756 (94.2758%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8495, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4924/5424 (90.7817%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5015/5424 (92.4594%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0516, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4148/4511 (91.9530%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8203, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4649/5167 (89.9748%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4724/5167 (91.4264%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0604, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4053/4356 (93.0441%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4131/4356 (94.8347%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0149, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4706/5244 (89.7407%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4745/5244 (90.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9067, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4287/4793 (89.4429%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4420/4793 (92.2178%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9366, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3433/3828 (89.6813%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3562/3828 (93.0512%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7509, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3688/4046 (91.1518%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3778/4046 (93.3762%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8708, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3645/4013 (90.8298%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3747/4013 (93.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7800, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2929/3271 (89.5445%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2970/3271 (90.7979%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7982, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4018/4362 (92.1137%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4037/4362 (92.5493%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8365, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3985/4346 (91.6935%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4097/4346 (94.2706%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7657, Accuracy: 5925/10000 (59.2500%)
time spent on training: 231.76207995414734
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8013, Accuracy: 5988/10000 (59.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 8.2700, Accuracy: 228/9900 (2.3030%)
Done in 255.7047529220581 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 44.78086700595119.
Norm before scaling: 44.77284109596673. Distance: 2.068829620765291
Total norm for 4 adversaries is: 44.77284109596673. distance: 2.068829620765291
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1214, Accuracy: 9599/9900 (96.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4796/5305 (90.4053%), train_poison_data_count: 415
Global model norm: 44.78086700595119.
Norm before scaling: 44.769796926017825. Distance: 2.188976443530357
Total norm for 4 adversaries is: 44.769796926017825. distance: 2.188976443530357
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1336, Accuracy: 9558/9900 (96.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 44.78086700595119.
Norm before scaling: 44.7693974741152. Distance: 2.059058699680329
Total norm for 4 adversaries is: 44.7693974741152. distance: 2.059058699680329
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0824, Accuracy: 9677/9900 (97.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4547/5066 (89.7552%), train_poison_data_count: 400
Global model norm: 44.78086700595119.
Norm before scaling: 44.77768298555306. Distance: 2.2269291090728367
Total norm for 4 adversaries is: 44.77768298555306. distance: 2.2269291090728367
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.3081, Accuracy: 9114/9900 (92.0606%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3721/4126 (90.1842%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3814/4126 (92.4382%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7536, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4992/5455 (91.5124%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5059/5455 (92.7406%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8859, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4034/4558 (88.5037%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4038/4558 (88.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0786, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3830/4235 (90.4368%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3895/4235 (91.9717%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8849, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3398/3804 (89.3270%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3535/3804 (92.9285%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8445, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5714/6391 (89.4070%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5721/6391 (89.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0474, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3909/4336 (90.1522%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3981/4336 (91.8127%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9947, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4155/4663 (89.1057%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4367/4663 (93.6522%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8982, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4045/4511 (89.6697%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4131/4511 (91.5761%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9061, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4027/4503 (89.4293%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4057/4503 (90.0955%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9014, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4612/5063 (91.0922%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4600/5063 (90.8552%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0059, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3904/4315 (90.4751%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4029/4315 (93.3720%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8333, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3214/3638 (88.3452%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3354/3638 (92.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9173, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4055/4441 (91.3083%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4177/4441 (94.0554%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9894, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4370/4679 (93.3960%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4215/4679 (90.0834%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0479, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4732/5265 (89.8765%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4691/5265 (89.0978%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0546, Accuracy: 5413/10000 (54.1300%)
time spent on training: 233.99216866493225
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Client 13 misclassified the most to class 13 with 1 misclassifications.
Client 13 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {13: 1})
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(13, 1)]
Top 2 clients: [(13, 1)]
Client 13 misclassification ratio: 1.0000
Client 13 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7520, Accuracy: 6056/10000 (60.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 7.4973, Accuracy: 357/9900 (3.6061%)
Done in 257.8404006958008 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 44.799493623324025.
Norm before scaling: 44.79058804418346. Distance: 2.0296752694387687
Total norm for 4 adversaries is: 44.79058804418346. distance: 2.0296752694387687
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1028, Accuracy: 9661/9900 (97.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 44.799493623324025.
Norm before scaling: 44.788148783851014. Distance: 2.1446821093696484
Total norm for 4 adversaries is: 44.788148783851014. distance: 2.1446821093696484
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1378, Accuracy: 9549/9900 (96.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 44.799493623324025.
Norm before scaling: 44.78742515649272. Distance: 1.880682218929291
Total norm for 4 adversaries is: 44.78742515649272. distance: 1.880682218929291
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.3104, Accuracy: 9146/9900 (92.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4586/5066 (90.5251%), train_poison_data_count: 400
Global model norm: 44.799493623324025.
Norm before scaling: 44.792565246558354. Distance: 2.1362255022263694
Total norm for 4 adversaries is: 44.792565246558354. distance: 2.1362255022263694
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1048, Accuracy: 9639/9900 (97.3636%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3946/4336 (91.0055%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4020/4336 (92.7122%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1334, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3447/3828 (90.0470%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3540/3828 (92.4765%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8297, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3267/3672 (88.9706%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3314/3672 (90.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9534, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4129/4651 (88.7766%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4210/4651 (90.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0241, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3980/4361 (91.2635%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3992/4361 (91.5386%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9992, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4539/5025 (90.3284%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4617/5025 (91.8806%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0174, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5580/6124 (91.1169%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5591/6124 (91.2965%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9738, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3280/3704 (88.5529%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3405/3704 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7858, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4573/4934 (92.6834%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4240/4934 (85.9343%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2886, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4547/5017 (90.6319%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4619/5017 (92.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9042, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5053/5582 (90.5231%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5165/5582 (92.5296%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0456, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4658/5167 (90.1490%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4705/5167 (91.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2716, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3475/3861 (90.0026%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3485/3861 (90.2616%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9757, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3274/3646 (89.7970%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3346/3646 (91.7718%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.6964, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4032/4558 (88.4599%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4039/4558 (88.6134%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1232, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4593/5116 (89.7772%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4615/5116 (90.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9383, Accuracy: 5596/10000 (55.9600%)
time spent on training: 234.7515423297882
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
Client 11 misclassified the most to class 13 with 1 misclassifications.
Client 11 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {11: 1})
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(11, 1)]
Top 2 clients: [(11, 1)]
Client 11 misclassification ratio: 1.0000
Client 11 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7265, Accuracy: 6090/10000 (60.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 6.6797, Accuracy: 625/9900 (6.3131%)
Done in 258.5678722858429 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 44.818853334928285.
Norm before scaling: 44.80786755824458. Distance: 1.999893662486804
Total norm for 4 adversaries is: 44.80786755824458. distance: 1.999893662486804
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0088, Accuracy: 9873/9900 (99.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 44.818853334928285.
Norm before scaling: 44.807503862006755. Distance: 2.0996124409497963
Total norm for 4 adversaries is: 44.807503862006755. distance: 2.0996124409497963
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1060, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 44.818853334928285.
Norm before scaling: 44.80583790480391. Distance: 1.8985460038437145
Total norm for 4 adversaries is: 44.80583790480391. distance: 1.8985460038437145
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0706, Accuracy: 9704/9900 (98.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4573/5066 (90.2685%), train_poison_data_count: 400
Global model norm: 44.818853334928285.
Norm before scaling: 44.813333543502985. Distance: 2.1324442451227488
Total norm for 4 adversaries is: 44.813333543502985. distance: 2.1324442451227488
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1390, Accuracy: 9546/9900 (96.4242%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4030/4511 (89.3372%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4174/4511 (92.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0333, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3967/4346 (91.2793%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4087/4346 (94.0405%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7606, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4470/4804 (93.0475%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4145/4804 (86.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.5352, Accuracy: 4812/10000 (48.1200%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4657/5232 (89.0099%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4670/5232 (89.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8714, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4269/4618 (92.4426%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4228/4618 (91.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9303, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3283/3590 (91.4485%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3242/3590 (90.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0469, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5731/6391 (89.6730%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5711/6391 (89.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9884, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4178/4354 (95.9577%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3900/4354 (89.5728%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2332, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4539/5055 (89.7923%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4618/5055 (91.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9232, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3477/3837 (90.6177%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3580/3837 (93.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9023, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4046/4503 (89.8512%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4095/4503 (90.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8925, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4187/4576 (91.4991%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4210/4576 (92.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8325, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4241/4793 (88.4832%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4363/4793 (91.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9133, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4179/4634 (90.1813%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4252/4634 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8890, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3635/4158 (87.4218%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3712/4158 (89.2737%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0305, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5134/5740 (89.4425%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5207/5740 (90.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1002, Accuracy: 5432/10000 (54.3200%)
time spent on training: 235.22459506988525
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Client 6 misclassified the most to class 13 with 1 misclassifications.
Client 6 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {6: 1})
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(6, 1)]
Top 2 clients: [(6, 1)]
Client 6 misclassification ratio: 1.0000
Client 6 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7053, Accuracy: 6115/10000 (61.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 6.0016, Accuracy: 951/9900 (9.6061%)
Done in 259.0081934928894 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4501/4885 (92.1392%), train_poison_data_count: 385
Global model norm: 44.838486461566276.
Norm before scaling: 44.827508219441135. Distance: 1.9167496483572233
Total norm for 4 adversaries is: 44.827508219441135. distance: 1.9167496483572233
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1134, Accuracy: 9611/9900 (97.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4857/5305 (91.5551%), train_poison_data_count: 415
Global model norm: 44.838486461566276.
Norm before scaling: 44.82546856236907. Distance: 2.00674172433202
Total norm for 4 adversaries is: 44.82546856236907. distance: 2.00674172433202
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0947, Accuracy: 9668/9900 (97.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4341/4717 (92.0288%), train_poison_data_count: 370
Global model norm: 44.838486461566276.
Norm before scaling: 44.82569186713338. Distance: 1.8392555932741204
Total norm for 4 adversaries is: 44.82569186713338. distance: 1.8392555932741204
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2049, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4627/5066 (91.3344%), train_poison_data_count: 400
Global model norm: 44.838486461566276.
Norm before scaling: 44.830466782681675. Distance: 2.0189608389999254
Total norm for 4 adversaries is: 44.830466782681675. distance: 2.0189608389999254
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.2144, Accuracy: 9341/9900 (94.3535%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3811/4184 (91.0851%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3831/4184 (91.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8579, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5696/6263 (90.9468%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5746/6263 (91.7452%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0965, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4083/4456 (91.6293%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4155/4456 (93.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8116, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4202/4538 (92.5959%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9596, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3844/4235 (90.7674%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3732/4235 (88.1228%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0668, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3804/4223 (90.0781%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3917/4223 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8728, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4996/5455 (91.5857%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4918/5455 (90.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9397, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4454/5037 (88.4257%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4619/5037 (91.7014%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8241, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3441/3756 (91.6134%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3536/3756 (94.1427%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9708, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4824/5265 (91.6239%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4805/5265 (91.2631%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8481, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4546/5055 (89.9308%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4660/5055 (92.1860%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9797, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4534/4804 (94.3797%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4292/4804 (89.3422%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1805, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4709/5063 (93.0081%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4642/5063 (91.6848%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8823, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3939/4295 (91.7113%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3957/4295 (92.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8974, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2969/3271 (90.7673%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2929/3271 (89.5445%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0583, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4088/4356 (93.8476%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4166/4356 (95.6382%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9080, Accuracy: 5730/10000 (57.3000%)
time spent on training: 233.05499744415283
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Client 19 misclassified the most to class 13 with 1 misclassifications.
Client 19 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {19: 1})
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(19, 1)]
Top 2 clients: [(19, 1)]
Client 19 misclassification ratio: 1.0000
Client 19 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.6898, Accuracy: 6131/10000 (61.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 5.4186, Accuracy: 1307/9900 (13.2020%)
Done in 256.93036937713623 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4539/4885 (92.9171%), train_poison_data_count: 385
Global model norm: 44.85731502149343.
Norm before scaling: 44.84507565549282. Distance: 1.8435589319570869
Total norm for 4 adversaries is: 44.84507565549282. distance: 1.8435589319570869
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1349, Accuracy: 9560/9900 (96.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4902/5305 (92.4034%), train_poison_data_count: 415
Global model norm: 44.85731502149343.
Norm before scaling: 44.84392965991886. Distance: 1.9430353402513234
Total norm for 4 adversaries is: 44.84392965991886. distance: 1.9430353402513234
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1001, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4717 (92.4316%), train_poison_data_count: 370
Global model norm: 44.85731502149343.
Norm before scaling: 44.839601288927625. Distance: 1.7386922628989574
Total norm for 4 adversaries is: 44.839601288927625. distance: 1.7386922628989574
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2499, Accuracy: 9273/9900 (93.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4674/5066 (92.2621%), train_poison_data_count: 400
Global model norm: 44.85731502149343.
Norm before scaling: 44.84550165350687. Distance: 1.9131438873066549
Total norm for 4 adversaries is: 44.84550165350687. distance: 1.9131438873066549
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2059, Accuracy: 9399/9900 (94.9394%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4106/4503 (91.1837%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4080/4503 (90.6063%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0452, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4096/4456 (91.9210%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4160/4456 (93.3573%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1044, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4832/5265 (91.7759%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4840/5265 (91.9278%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9542, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4304/4793 (89.7976%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4403/4793 (91.8631%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9801, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4430/4928 (89.8945%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4490/4928 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8010, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3246/3638 (89.2248%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8250, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4235/4663 (90.8214%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4329/4663 (92.8372%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8686, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4357/4928 (88.4131%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9092, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4047/4465 (90.6383%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4125/4465 (92.3852%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8994, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3718/3911 (95.0652%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3623/3911 (92.6362%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8505, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4097/4518 (90.6817%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9939, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3839/4235 (90.6494%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3913/4235 (92.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0408, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4640/4934 (94.0413%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4317/4934 (87.4949%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0455, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4200/4647 (90.3809%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4290/4647 (92.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9047, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4240/4651 (91.1632%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4294/4651 (92.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0518, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4467/4989 (89.5370%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4520/4989 (90.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8759, Accuracy: 5748/10000 (57.4800%)
time spent on training: 233.21941447257996
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7629, Accuracy: 6009/10000 (60.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 5.2427, Accuracy: 1509/9900 (15.2424%)
Done in 256.86230850219727 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4524/4885 (92.6100%), train_poison_data_count: 385
Global model norm: 44.892166806972014.
Norm before scaling: 44.87837839824708. Distance: 1.868977347231071
Total norm for 4 adversaries is: 44.87837839824708. distance: 1.868977347231071
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0739, Accuracy: 9708/9900 (98.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 44.892166806972014.
Norm before scaling: 44.879554793653675. Distance: 2.0009858562650202
Total norm for 4 adversaries is: 44.879554793653675. distance: 2.0009858562650202
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1757, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4363/4717 (92.4952%), train_poison_data_count: 370
Global model norm: 44.892166806972014.
Norm before scaling: 44.873918695624994. Distance: 1.7673525165714452
Total norm for 4 adversaries is: 44.873918695624994. distance: 1.7673525165714452
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1377, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 44.892166806972014.
Norm before scaling: 44.88425326778034. Distance: 2.011626898881588
Total norm for 4 adversaries is: 44.88425326778034. distance: 2.011626898881588
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0776, Accuracy: 9701/9900 (97.9899%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4174/4538 (91.9788%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4238/4538 (93.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7751, Accuracy: 5927/10000 (59.2700%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4023/4362 (92.2283%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3956/4362 (90.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0318, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4683/5244 (89.3021%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4742/5244 (90.4272%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9109, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3685/4046 (91.0776%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3693/4046 (91.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0300, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3658/4013 (91.1538%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3730/4013 (92.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8236, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4069/4465 (91.1310%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4140/4465 (92.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7528, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4658/5232 (89.0291%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4694/5232 (89.7171%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0310, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4387/4928 (89.0219%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4481/4928 (90.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8411, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4720/5063 (93.2254%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4740/5063 (93.6204%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9423, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5425/5902 (91.9180%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5420/5902 (91.8333%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9068, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4093/4456 (91.8537%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4169/4456 (93.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7789, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4187/4596 (91.1010%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4297/4596 (93.4943%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8825, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4044/4441 (91.0606%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4133/4441 (93.0646%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0084, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5183/5740 (90.2962%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5259/5740 (91.6202%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1630, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3191/3472 (91.9067%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3213/3472 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9298, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3496/3861 (90.5465%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3564/3861 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9037, Accuracy: 5573/10000 (55.7300%)
time spent on training: 234.81687784194946
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7882, Accuracy: 5976/10000 (59.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 5.5735, Accuracy: 1289/9900 (13.0202%)
Done in 258.53953313827515 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 44.92442384073362.
Norm before scaling: 44.911653728458944. Distance: 1.818275195671663
Total norm for 4 adversaries is: 44.911653728458944. distance: 1.818275195671663
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1787, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4885/5305 (92.0829%), train_poison_data_count: 415
Global model norm: 44.92442384073362.
Norm before scaling: 44.911705370614406. Distance: 1.9523920743959977
Total norm for 4 adversaries is: 44.911705370614406. distance: 1.9523920743959977
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.3120, Accuracy: 9151/9900 (92.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4338/4717 (91.9652%), train_poison_data_count: 370
Global model norm: 44.92442384073362.
Norm before scaling: 44.91135882343338. Distance: 1.828366190331985
Total norm for 4 adversaries is: 44.91135882343338. distance: 1.828366190331985
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0903, Accuracy: 9661/9900 (97.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4646/5066 (91.7094%), train_poison_data_count: 400
Global model norm: 44.92442384073362.
Norm before scaling: 44.91205599209972. Distance: 1.9723897319572075
Total norm for 4 adversaries is: 44.91205599209972. distance: 1.9723897319572075
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0809, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3478/3797 (91.5986%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3493/3797 (91.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9082, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2983/3297 (90.4762%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3086/3297 (93.6002%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7545, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3700/3911 (94.6050%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3548/3911 (90.7185%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9785, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2903/3271 (88.7496%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2908/3271 (88.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9362, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3710/4046 (91.6955%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3761/4046 (92.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8984, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5212/5740 (90.8014%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5240/5740 (91.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0455, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3610/3969 (90.9549%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3646/3969 (91.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8844, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3319/3704 (89.6058%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3369/3704 (90.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9124, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4243/4767 (89.0078%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4316/4767 (90.5391%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9404, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4483/4956 (90.4560%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4502/4956 (90.8394%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0329, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3283/3590 (91.4485%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3122/3590 (86.9638%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1717, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5436/5902 (92.1044%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5333/5902 (90.3592%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0436, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4425/4928 (89.7930%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4529/4928 (91.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8299, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3895/4235 (91.9717%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3940/4235 (93.0342%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8378, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4798/5265 (91.1301%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4793/5265 (91.0351%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8329, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4095/4356 (94.0083%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3865/4356 (88.7282%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1791, Accuracy: 5280/10000 (52.8000%)
time spent on training: 230.35018825531006
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9278, Accuracy: 5741/10000 (57.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 6.0878, Accuracy: 867/9900 (8.7576%)
Done in 254.0360827445984 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4526/4885 (92.6510%), train_poison_data_count: 385
Global model norm: 44.95380658589993.
Norm before scaling: 44.942324149959134. Distance: 1.8746224977034374
Total norm for 4 adversaries is: 44.942324149959134. distance: 1.8746224977034374
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1859, Accuracy: 9428/9900 (95.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 44.95380658589993.
Norm before scaling: 44.94032908992698. Distance: 2.0361516645185422
Total norm for 4 adversaries is: 44.94032908992698. distance: 2.0361516645185422
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1815, Accuracy: 9448/9900 (95.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4313/4717 (91.4352%), train_poison_data_count: 370
Global model norm: 44.95380658589993.
Norm before scaling: 44.94142645180989. Distance: 1.877641216305823
Total norm for 4 adversaries is: 44.94142645180989. distance: 1.877641216305823
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0773, Accuracy: 9705/9900 (98.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4638/5066 (91.5515%), train_poison_data_count: 400
Global model norm: 44.95380658589993.
Norm before scaling: 44.943152569558634. Distance: 2.012977221280955
Total norm for 4 adversaries is: 44.943152569558634. distance: 2.012977221280955
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0668, Accuracy: 9718/9900 (98.1616%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3705/4025 (92.0497%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3800/4025 (94.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8126, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5381/5902 (91.1725%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5402/5902 (91.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0737, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4293/4793 (89.5681%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4407/4793 (91.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8584, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4757/5265 (90.3514%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4825/5265 (91.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8876, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3914/4295 (91.1292%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3929/4295 (91.4785%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9501, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3333/3704 (89.9838%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3428/3704 (92.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7857, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4581/5116 (89.5426%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4611/5116 (90.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8913, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5149/5740 (89.7038%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5208/5740 (90.7317%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0852, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3470/3797 (91.3879%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3496/3797 (92.0727%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9254, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4221/4716 (89.5038%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1136, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4010/4433 (90.4579%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4111/4433 (92.7363%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8261, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3974/4416 (89.9909%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4056/4416 (91.8478%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8948, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3797/4223 (89.9124%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3906/4223 (92.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9034, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4609/5083 (90.6748%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4624/5083 (90.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8405, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4148/4576 (90.6469%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4213/4576 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0061, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4965/5392 (92.0809%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4876/5392 (90.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1188, Accuracy: 5398/10000 (53.9800%)
time spent on training: 233.81325507164001
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9530, Accuracy: 5664/10000 (56.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 5.6415, Accuracy: 1168/9900 (11.7980%)
Done in 257.706862449646 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4555/4885 (93.2446%), train_poison_data_count: 385
Global model norm: 44.98874913606873.
Norm before scaling: 44.97478948759099. Distance: 1.8800605511552366
Total norm for 4 adversaries is: 44.97478948759099. distance: 1.8800605511552366
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0810, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4856/5305 (91.5363%), train_poison_data_count: 415
Global model norm: 44.98874913606873.
Norm before scaling: 44.97480848694634. Distance: 1.9890774854408686
Total norm for 4 adversaries is: 44.97480848694634. distance: 1.9890774854408686
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1728, Accuracy: 9455/9900 (95.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4339/4717 (91.9864%), train_poison_data_count: 370
Global model norm: 44.98874913606873.
Norm before scaling: 44.97777907313302. Distance: 1.8803708401632522
Total norm for 4 adversaries is: 44.97777907313302. distance: 1.8803708401632522
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0293, Accuracy: 9829/9900 (99.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4631/5066 (91.4133%), train_poison_data_count: 400
Global model norm: 44.98874913606873.
Norm before scaling: 44.97784963743612. Distance: 2.0113475271872017
Total norm for 4 adversaries is: 44.97784963743612. distance: 2.0113475271872017
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2250, Accuracy: 9375/9900 (94.6970%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4818/5265 (91.5100%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4841/5265 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8722, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4056/4356 (93.1129%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3963/4356 (90.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0592, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3474/3756 (92.4920%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3554/3756 (94.6219%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7733, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3497/3837 (91.1389%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3601/3837 (93.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8734, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5205/5740 (90.6794%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5212/5740 (90.8014%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0049, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3783/4223 (89.5809%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3899/4223 (92.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8957, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4046/4465 (90.6159%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4132/4465 (92.5420%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9232, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5052/5591 (90.3595%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5071/5591 (90.6993%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0321, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5524/5902 (93.5954%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5311/5902 (89.9864%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9799, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4425/4918 (89.9756%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4521/4918 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0643, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3511/3861 (90.9350%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3578/3861 (92.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9211, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3895/4295 (90.6868%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3886/4295 (90.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9206, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3667/4158 (88.1914%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3745/4158 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9189, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5696/6263 (90.9468%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5695/6263 (90.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0516, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4165/4354 (95.6592%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3644/4354 (83.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5248, Accuracy: 4637/10000 (46.3700%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3463/3797 (91.2036%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3481/3797 (91.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8229, Accuracy: 5833/10000 (58.3300%)
time spent on training: 232.42773246765137
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1187, Accuracy: 5467/10000 (54.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 5.8813, Accuracy: 1072/9900 (10.8283%)
Done in 256.1876518726349 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4520/4885 (92.5281%), train_poison_data_count: 385
Global model norm: 45.02876549140213.
Norm before scaling: 45.015161291433245. Distance: 1.8922218325939264
Total norm for 4 adversaries is: 45.015161291433245. distance: 1.8922218325939264
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1578, Accuracy: 9497/9900 (95.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4853/5305 (91.4797%), train_poison_data_count: 415
Global model norm: 45.02876549140213.
Norm before scaling: 45.017411995943306. Distance: 2.05794762563837
Total norm for 4 adversaries is: 45.017411995943306. distance: 2.05794762563837
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1488, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4355/4717 (92.3256%), train_poison_data_count: 370
Global model norm: 45.02876549140213.
Norm before scaling: 45.01633682403187. Distance: 1.837047095503382
Total norm for 4 adversaries is: 45.01633682403187. distance: 1.837047095503382
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1654, Accuracy: 9476/9900 (95.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4619/5066 (91.1765%), train_poison_data_count: 400
Global model norm: 45.02876549140213.
Norm before scaling: 45.02026182297672. Distance: 2.0596307390228787
Total norm for 4 adversaries is: 45.02026182297672. distance: 2.0596307390228787
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2087, Accuracy: 9353/9900 (94.4747%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3452/3797 (90.9139%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3497/3797 (92.0990%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8780, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8707, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4640/4934 (94.0413%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4586/4934 (92.9469%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9409, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4936/5455 (90.4858%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4990/5455 (91.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8894, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5471/5902 (92.6974%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5339/5902 (90.4609%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2051, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5754/6391 (90.0329%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5801/6391 (90.7683%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0363, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3658/3911 (93.5311%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3514/3911 (89.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9672, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4690/5195 (90.2791%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4702/5195 (90.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0412, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3834/4235 (90.5313%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3916/4235 (92.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9470, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4580/5116 (89.5231%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4638/5116 (90.6568%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0280, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4136/4538 (91.1415%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4302/4538 (94.7995%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8902, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5075/5582 (90.9172%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5094/5582 (91.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1950, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4085/4558 (89.6226%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4140/4558 (90.8293%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0552, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3707/4046 (91.6214%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3783/4046 (93.4998%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7473, Accuracy: 5926/10000 (59.2600%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3443/3828 (89.9425%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3494/3828 (91.2748%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8116, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4573/5055 (90.4649%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4651/5055 (92.0079%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9213, Accuracy: 5685/10000 (56.8500%)
time spent on training: 237.66223859786987
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1419, Accuracy: 5445/10000 (54.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 6.2644, Accuracy: 879/9900 (8.8788%)
Done in 261.31888484954834 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4527/4885 (92.6714%), train_poison_data_count: 385
Global model norm: 45.066859781728056.
Norm before scaling: 45.054197776729836. Distance: 1.8253609391812278
Total norm for 4 adversaries is: 45.054197776729836. distance: 1.8253609391812278
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1167, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 45.066859781728056.
Norm before scaling: 45.05261545326406. Distance: 2.045744256011645
Total norm for 4 adversaries is: 45.05261545326406. distance: 2.045744256011645
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1121, Accuracy: 9622/9900 (97.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4356/4717 (92.3468%), train_poison_data_count: 370
Global model norm: 45.066859781728056.
Norm before scaling: 45.05185949486783. Distance: 1.8339317241094524
Total norm for 4 adversaries is: 45.05185949486783. distance: 1.8339317241094524
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1249, Accuracy: 9572/9900 (96.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 45.066859781728056.
Norm before scaling: 45.0539376725796. Distance: 2.0300951682647574
Total norm for 4 adversaries is: 45.0539376725796. distance: 2.0300951682647574
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1666, Accuracy: 9446/9900 (95.4141%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5095/5582 (91.2755%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5111/5582 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0528, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4001/4501 (88.8914%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4114/4501 (91.4019%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0170, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3653/3911 (93.4032%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3531/3911 (90.2838%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0458, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4255/4663 (91.2503%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4346/4663 (93.2018%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8722, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4785/5265 (90.8832%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4742/5265 (90.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9870, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3934/4416 (89.0851%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4035/4416 (91.3723%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9952, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4037/4433 (91.0670%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4118/4433 (92.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8001, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5630/6263 (89.8930%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5689/6263 (90.8351%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0767, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4998/5455 (91.6224%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4960/5455 (90.9258%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8686, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4179/4634 (90.1813%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4255/4634 (91.8213%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8826, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4248/4707 (90.2486%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4314/4707 (91.6507%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8935, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3749/4126 (90.8628%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8409, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4623/5116 (90.3636%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4640/5116 (90.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8788, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4667/5063 (92.1786%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4657/5063 (91.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9347, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4007/4361 (91.8826%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3956/4361 (90.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0711, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5548/6124 (90.5944%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5626/6124 (91.8681%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8239, Accuracy: 5752/10000 (57.5200%)
time spent on training: 238.58640503883362
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Client 18 misclassified the most to class 95 with 1 misclassifications.
Client 18 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {18: 1})
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(18, 1)]
Top 2 clients: [(18, 1)]
Client 18 misclassification ratio: 1.0000
Client 18 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0962, Accuracy: 5523/10000 (55.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 5.6421, Accuracy: 1200/9900 (12.1212%)
Done in 262.4043641090393 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 45.08659744903412.
Norm before scaling: 45.071735086536634. Distance: 1.8556296188487165
Total norm for 4 adversaries is: 45.071735086536634. distance: 1.8556296188487165
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0347, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4888/5305 (92.1395%), train_poison_data_count: 415
Global model norm: 45.08659744903412.
Norm before scaling: 45.07138841561171. Distance: 1.9615661099874555
Total norm for 4 adversaries is: 45.07138841561171. distance: 1.9615661099874555
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1232, Accuracy: 9591/9900 (96.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4344/4717 (92.0924%), train_poison_data_count: 370
Global model norm: 45.08659744903412.
Norm before scaling: 45.068698916990186. Distance: 1.7972716847288357
Total norm for 4 adversaries is: 45.068698916990186. distance: 1.7972716847288357
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1425, Accuracy: 9512/9900 (96.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 45.08659744903412.
Norm before scaling: 45.075045930370386. Distance: 1.9849412365534125
Total norm for 4 adversaries is: 45.075045930370386. distance: 1.9849412365534125
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1474, Accuracy: 9527/9900 (96.2323%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4108/4356 (94.3067%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3964/4356 (91.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0578, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3975/4362 (91.1279%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4047/4362 (92.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8955, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4339/4679 (92.7335%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4272/4679 (91.3016%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0724, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3669/4158 (88.2395%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3774/4158 (90.7648%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9346, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4224/4651 (90.8192%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4294/4651 (92.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9039, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3816/4175 (91.4012%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3830/4175 (91.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8853, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4281/4618 (92.7025%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4276/4618 (92.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8792, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4155/4625 (89.8378%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4160/4625 (89.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9411, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5081/5582 (91.0247%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5105/5582 (91.4547%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0516, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4357/4874 (89.3927%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4369/4874 (89.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1512, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4676/4934 (94.7710%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4433/4934 (89.8460%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0601, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4953/5424 (91.3164%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5018/5424 (92.5147%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2076, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4502/4804 (93.7136%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4358/4804 (90.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0151, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4488/4918 (91.2566%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4523/4918 (91.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0248, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3489/3861 (90.3652%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3535/3861 (91.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8647, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3833/4223 (90.7649%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3902/4223 (92.3988%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8352, Accuracy: 5831/10000 (58.3100%)
time spent on training: 233.09658765792847
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0747, Accuracy: 5590/10000 (55.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 5.9219, Accuracy: 1102/9900 (11.1313%)
Done in 256.7037663459778 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4554/4885 (93.2242%), train_poison_data_count: 385
Global model norm: 45.11471110628023.
Norm before scaling: 45.09848300048808. Distance: 1.8111828589253394
Total norm for 4 adversaries is: 45.09848300048808. distance: 1.8111828589253394
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0859, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 45.11471110628023.
Norm before scaling: 45.09866570573347. Distance: 1.9830567794881286
Total norm for 4 adversaries is: 45.09866570573347. distance: 1.9830567794881286
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0660, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4348/4717 (92.1772%), train_poison_data_count: 370
Global model norm: 45.11471110628023.
Norm before scaling: 45.098155482565886. Distance: 1.812435148986304
Total norm for 4 adversaries is: 45.098155482565886. distance: 1.812435148986304
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1102, Accuracy: 9629/9900 (97.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4620/5066 (91.1962%), train_poison_data_count: 400
Global model norm: 45.11471110628023.
Norm before scaling: 45.104754103901705. Distance: 2.028685608956645
Total norm for 4 adversaries is: 45.104754103901705. distance: 2.028685608956645
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1968, Accuracy: 9408/9900 (95.0303%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4168/4647 (89.6923%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4242/4647 (91.2847%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8125, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3425/3804 (90.0368%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3503/3804 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8829, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5079/5591 (90.8424%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5063/5591 (90.5563%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9943, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4210/4634 (90.8502%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4232/4634 (91.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8568, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4047/4433 (91.2926%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4110/4433 (92.7137%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8386, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3308/3704 (89.3089%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3375/3704 (91.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8241, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3474/3837 (90.5395%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3597/3837 (93.7451%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8035, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4975/5455 (91.2007%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5029/5455 (92.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9646, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5204/5740 (90.6620%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5237/5740 (91.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1388, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4478/4986 (89.8115%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4568/4986 (91.6165%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8323, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4077/4456 (91.4946%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4143/4456 (92.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9418, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4086/4356 (93.8017%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3951/4356 (90.7025%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0883, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3223/3590 (89.7772%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3294/3590 (91.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9835, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4062/4503 (90.2065%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4100/4503 (91.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8213, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4516/5037 (89.6565%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4607/5037 (91.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9103, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4662/5167 (90.2264%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4767/5167 (92.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0136, Accuracy: 5520/10000 (55.2000%)
time spent on training: 233.89557361602783
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1489, Accuracy: 5479/10000 (54.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 6.1703, Accuracy: 964/9900 (9.7374%)
Done in 257.49455761909485 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4534/4885 (92.8147%), train_poison_data_count: 385
Global model norm: 45.14559644007029.
Norm before scaling: 45.13250754505767. Distance: 1.9056637597325718
Total norm for 4 adversaries is: 45.13250754505767. distance: 1.9056637597325718
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1034, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4849/5305 (91.4043%), train_poison_data_count: 415
Global model norm: 45.14559644007029.
Norm before scaling: 45.131889514753034. Distance: 2.039488298528929
Total norm for 4 adversaries is: 45.131889514753034. distance: 2.039488298528929
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1589, Accuracy: 9492/9900 (95.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 45.14559644007029.
Norm before scaling: 45.129012925358644. Distance: 1.849827142320783
Total norm for 4 adversaries is: 45.129012925358644. distance: 1.849827142320783
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0943, Accuracy: 9660/9900 (97.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4594/5066 (90.6830%), train_poison_data_count: 400
Global model norm: 45.14559644007029.
Norm before scaling: 45.13821817744222. Distance: 2.0709822812871956
Total norm for 4 adversaries is: 45.13821817744222. distance: 2.0709822812871956
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0782, Accuracy: 9693/9900 (97.9091%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3236/3638 (88.9500%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3342/3638 (91.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9651, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4229/4716 (89.6735%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4291/4716 (90.9881%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9543, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4438/4956 (89.5480%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4489/4956 (90.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9942, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4950/5392 (91.8027%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4919/5392 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9946, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3777/4184 (90.2725%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3868/4184 (92.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8258, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4090/4481 (91.2743%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4025/4481 (89.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8849, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3295/3646 (90.3730%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3434/3646 (94.1854%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7164, Accuracy: 5994/10000 (59.9400%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4537/5025 (90.2886%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4561/5025 (90.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0126, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3239/3590 (90.2228%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3203/3590 (89.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0597, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4169/4596 (90.7093%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4306/4596 (93.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0093, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3939/4336 (90.8441%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4025/4336 (92.8275%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8842, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4348/4874 (89.2080%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4196/4874 (86.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2139, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4671/5167 (90.4006%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4711/5167 (91.1748%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9569, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4255/4618 (92.1395%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4288/4618 (92.8540%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9678, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4404/4928 (89.3669%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4462/4928 (90.5438%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0159, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4172/4647 (89.7784%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4253/4647 (91.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9245, Accuracy: 5629/10000 (56.2900%)
time spent on training: 233.40596270561218
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1736, Accuracy: 5475/10000 (54.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 6.2956, Accuracy: 888/9900 (8.9697%)
Done in 257.2127616405487 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4531/4885 (92.7533%), train_poison_data_count: 385
Global model norm: 45.178027836756556.
Norm before scaling: 45.16617537978504. Distance: 1.8596603431058536
Total norm for 4 adversaries is: 45.16617537978504. distance: 1.8596603431058536
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.3049, Accuracy: 9179/9900 (92.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4867/5305 (91.7436%), train_poison_data_count: 415
Global model norm: 45.178027836756556.
Norm before scaling: 45.16449562476108. Distance: 2.037289019935741
Total norm for 4 adversaries is: 45.16449562476108. distance: 2.037289019935741
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1831, Accuracy: 9465/9900 (95.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4717 (92.4316%), train_poison_data_count: 370
Global model norm: 45.178027836756556.
Norm before scaling: 45.16247253839464. Distance: 1.8170865661457045
Total norm for 4 adversaries is: 45.16247253839464. distance: 1.8170865661457045
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2060, Accuracy: 9380/9900 (94.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 45.178027836756556.
Norm before scaling: 45.170415706279755. Distance: 2.0481550567535476
Total norm for 4 adversaries is: 45.170415706279755. distance: 2.0481550567535476
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2385, Accuracy: 9321/9900 (94.1515%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3917/4368 (89.6749%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3944/4368 (90.2930%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9713, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4703/5195 (90.5294%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4559/5195 (87.7575%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1319, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3950/4315 (91.5411%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4016/4315 (93.0707%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8990, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3277/3646 (89.8793%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3388/3646 (92.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7605, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3247/3590 (90.4457%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3273/3590 (91.1699%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9316, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3783/4126 (91.6869%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3887/4126 (94.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7893, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3962/4361 (90.8507%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4018/4361 (92.1348%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8677, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3453/3837 (89.9922%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3595/3837 (93.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8403, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3844/4235 (90.7674%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3765/4235 (88.9020%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1187, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5536/5902 (93.7987%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5518/5902 (93.4937%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9218, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4061/4433 (91.6084%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4069/4433 (91.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8143, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3220/3638 (88.5102%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3342/3638 (91.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8085, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4743/5232 (90.6537%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4770/5232 (91.1697%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0068, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3928/4336 (90.5904%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4014/4336 (92.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9736, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4453/4989 (89.2564%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4570/4989 (91.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8293, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4131/4481 (92.1892%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4055/4481 (90.4932%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9720, Accuracy: 5598/10000 (55.9800%)
time spent on training: 229.88771653175354
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1634, Accuracy: 5476/10000 (54.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 6.3298, Accuracy: 826/9900 (8.3434%)
Done in 253.87019801139832 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4550/4885 (93.1423%), train_poison_data_count: 385
Global model norm: 45.211421475507024.
Norm before scaling: 45.19380601962024. Distance: 1.8062426319434024
Total norm for 4 adversaries is: 45.19380601962024. distance: 1.8062426319434024
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1103, Accuracy: 9608/9900 (97.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4899/5305 (92.3468%), train_poison_data_count: 415
Global model norm: 45.211421475507024.
Norm before scaling: 45.194103133128024. Distance: 1.9369409431391713
Total norm for 4 adversaries is: 45.194103133128024. distance: 1.9369409431391713
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0675, Accuracy: 9742/9900 (98.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4357/4717 (92.3680%), train_poison_data_count: 370
Global model norm: 45.211421475507024.
Norm before scaling: 45.19241361165472. Distance: 1.7830716238179196
Total norm for 4 adversaries is: 45.19241361165472. distance: 1.7830716238179196
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0662, Accuracy: 9724/9900 (98.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4621/5066 (91.2159%), train_poison_data_count: 400
Global model norm: 45.211421475507024.
Norm before scaling: 45.20233375128435. Distance: 2.0261151481058004
Total norm for 4 adversaries is: 45.20233375128435. distance: 2.0261151481058004
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1295, Accuracy: 9558/9900 (96.5455%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4606/5116 (90.0313%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4719/5116 (92.2400%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8695, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4014/4362 (92.0220%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3953/4362 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0029, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4075/4441 (91.7586%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4122/4441 (92.8169%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9306, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4270/4663 (91.5719%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4330/4663 (92.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9243, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4629/5083 (91.0683%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4673/5083 (91.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9471, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4236/4767 (88.8609%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4270/4767 (89.5742%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0158, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3461/3797 (91.1509%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3518/3797 (92.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9317, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4785/5195 (92.1078%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4822/5195 (92.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0174, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4244/4618 (91.9013%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4236/4618 (91.7280%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9795, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4051/4433 (91.3828%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4068/4433 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9297, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4567/5055 (90.3462%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4616/5055 (91.3155%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8605, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3701/4158 (89.0091%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3776/4158 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9247, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3473/3781 (91.8540%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3367/3781 (89.0505%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1451, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3763/4175 (90.1317%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8817, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4785/5265 (90.8832%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4755/5265 (90.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9727, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3500/3837 (91.2171%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3588/3837 (93.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7879, Accuracy: 5858/10000 (58.5800%)
time spent on training: 231.36937284469604
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1613, Accuracy: 5442/10000 (54.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 6.7034, Accuracy: 654/9900 (6.6061%)
Done in 255.12850499153137 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4529/4885 (92.7124%), train_poison_data_count: 385
Global model norm: 45.23532355438958.
Norm before scaling: 45.22072467828979. Distance: 1.916309890159546
Total norm for 4 adversaries is: 45.22072467828979. distance: 1.916309890159546
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0627, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 45.23532355438958.
Norm before scaling: 45.22126996045044. Distance: 2.0357957885794566
Total norm for 4 adversaries is: 45.22126996045044. distance: 2.0357957885794566
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1357, Accuracy: 9566/9900 (96.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4347/4717 (92.1560%), train_poison_data_count: 370
Global model norm: 45.23532355438958.
Norm before scaling: 45.21952206493618. Distance: 1.833492257714862
Total norm for 4 adversaries is: 45.21952206493618. distance: 1.833492257714862
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1334, Accuracy: 9537/9900 (96.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4631/5066 (91.4133%), train_poison_data_count: 400
Global model norm: 45.23532355438958.
Norm before scaling: 45.22637153937056. Distance: 2.045603000185739
Total norm for 4 adversaries is: 45.22637153937056. distance: 2.045603000185739
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0350, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3682/3911 (94.1447%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3533/3911 (90.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0111, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4820/5195 (92.7815%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4804/5195 (92.4735%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0344, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3468/3775 (91.8675%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3559/3775 (94.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7582, Accuracy: 5977/10000 (59.7700%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4343/4679 (92.8190%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4314/4679 (92.1992%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9906, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4013/4361 (92.0202%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3954/4361 (90.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9686, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3310/3672 (90.1416%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3408/3672 (92.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8611, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4130/4481 (92.1669%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4111/4481 (91.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9114, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3755/4126 (91.0082%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3868/4126 (93.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8544, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3617/3969 (91.1313%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3627/3969 (91.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8836, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4615/5116 (90.2072%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4639/5116 (90.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8263, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4685/5063 (92.5341%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4459/5063 (88.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9529, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3005/3297 (91.1435%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3065/3297 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7351, Accuracy: 6020/10000 (60.2000%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4451/5037 (88.3661%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4603/5037 (91.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9491, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4204/4596 (91.4708%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4287/4596 (93.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9733, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4053/4501 (90.0467%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4041/4501 (89.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9789, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4096/4465 (91.7357%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4223/4465 (94.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7833, Accuracy: 5906/10000 (59.0600%)
time spent on training: 230.70036101341248
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1634, Accuracy: 5471/10000 (54.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 6.5446, Accuracy: 741/9900 (7.4848%)
Done in 254.44012475013733 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4519/4885 (92.5077%), train_poison_data_count: 385
Global model norm: 45.26691672734073.
Norm before scaling: 45.25662503297169. Distance: 1.8960699066561666
Total norm for 4 adversaries is: 45.25662503297169. distance: 1.8960699066561666
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1039, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4852/5305 (91.4609%), train_poison_data_count: 415
Global model norm: 45.26691672734073.
Norm before scaling: 45.255281761842454. Distance: 2.065138083360221
Total norm for 4 adversaries is: 45.255281761842454. distance: 2.065138083360221
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1214, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4364/4717 (92.5164%), train_poison_data_count: 370
Global model norm: 45.26691672734073.
Norm before scaling: 45.253338263861124. Distance: 1.8394593568227682
Total norm for 4 adversaries is: 45.253338263861124. distance: 1.8394593568227682
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1970, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4643/5066 (91.6502%), train_poison_data_count: 400
Global model norm: 45.26691672734073.
Norm before scaling: 45.25591024506495. Distance: 2.006052514930123
Total norm for 4 adversaries is: 45.25591024506495. distance: 2.006052514930123
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1463, Accuracy: 9496/9900 (95.9192%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3972/4361 (91.0800%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4067/4361 (93.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8779, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3977/4346 (91.5094%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4079/4346 (93.8564%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7504, Accuracy: 5990/10000 (59.9000%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4980/5455 (91.2924%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5029/5455 (92.1907%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8503, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4052/4465 (90.7503%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4178/4465 (93.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7389, Accuracy: 5991/10000 (59.9100%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3949/4336 (91.0747%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4015/4336 (92.5969%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9980, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4106/4441 (92.4567%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4188/4441 (94.3031%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0211, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3985/4362 (91.3572%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4000/4362 (91.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0018, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3575/3969 (90.0731%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3675/3969 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9282, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3911/4295 (91.0594%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3986/4295 (92.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8884, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4554/5017 (90.7714%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4655/5017 (92.7845%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8820, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4712/5063 (93.0674%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4611/5063 (91.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0018, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2964/3271 (90.6145%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0061, Accuracy: 2908/3271 (88.9025%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9299, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5764/6263 (92.0326%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5781/6263 (92.3040%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0177, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4502/4874 (92.3677%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4428/4874 (90.8494%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0240, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3669/3911 (93.8123%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3510/3911 (89.7469%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9532, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4523/4804 (94.1507%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4464/4804 (92.9226%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9703, Accuracy: 5647/10000 (56.4700%)
time spent on training: 233.89768624305725
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1500, Accuracy: 5504/10000 (55.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 6.7015, Accuracy: 758/9900 (7.6566%)
Done in 257.93025517463684 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4518/4885 (92.4872%), train_poison_data_count: 385
Global model norm: 45.29524455930777.
Norm before scaling: 45.28233370856398. Distance: 1.9328996741974724
Total norm for 4 adversaries is: 45.28233370856398. distance: 1.9328996741974724
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0510, Accuracy: 9776/9900 (98.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4846/5305 (91.3478%), train_poison_data_count: 415
Global model norm: 45.29524455930777.
Norm before scaling: 45.28119069181761. Distance: 2.0490924966468578
Total norm for 4 adversaries is: 45.28119069181761. distance: 2.0490924966468578
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1868, Accuracy: 9445/9900 (95.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4320/4717 (91.5836%), train_poison_data_count: 370
Global model norm: 45.29524455930777.
Norm before scaling: 45.280438549492594. Distance: 1.8873932385093017
Total norm for 4 adversaries is: 45.280438549492594. distance: 1.8873932385093017
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1465, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4634/5066 (91.4726%), train_poison_data_count: 400
Global model norm: 45.29524455930777.
Norm before scaling: 45.284317744598404. Distance: 2.0453183610451857
Total norm for 4 adversaries is: 45.284317744598404. distance: 2.0453183610451857
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0620, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5490/5902 (93.0193%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5489/5902 (93.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9689, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4499/4918 (91.4803%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4556/4918 (92.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0440, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3680/4025 (91.4286%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7880, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3184/3472 (91.7051%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3189/3472 (91.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9956, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4269/4793 (89.0674%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4402/4793 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9191, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4633/4934 (93.8995%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4562/4934 (92.4605%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8856, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3683/3911 (94.1703%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3667/3911 (93.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8270, Accuracy: 5958/10000 (59.5800%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4959/5392 (91.9696%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4899/5392 (90.8568%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1158, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3299/3638 (90.6817%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7667, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5538/6124 (90.4311%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5598/6124 (91.4108%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8811, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3749/4175 (89.7964%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3767/4175 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9086, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4166/4625 (90.0757%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4183/4625 (90.4432%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9334, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4200/4354 (96.4630%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4008/4354 (92.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1825, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4063/4511 (90.0687%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4142/4511 (91.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9470, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3351/3704 (90.4698%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3408/3704 (92.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9138, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3521/3861 (91.1940%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3529/3861 (91.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8378, Accuracy: 5668/10000 (56.6800%)
time spent on training: 231.9742124080658
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3129, Accuracy: 5234/10000 (52.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 6.4330, Accuracy: 878/9900 (8.8687%)
Done in 255.86850690841675 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4532/4885 (92.7738%), train_poison_data_count: 385
Global model norm: 45.32082628242644.
Norm before scaling: 45.30554364706653. Distance: 1.8884982923803468
Total norm for 4 adversaries is: 45.30554364706653. distance: 1.8884982923803468
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0356, Accuracy: 9816/9900 (99.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4871/5305 (91.8190%), train_poison_data_count: 415
Global model norm: 45.32082628242644.
Norm before scaling: 45.305196070822. Distance: 2.0206130651657808
Total norm for 4 adversaries is: 45.305196070822. distance: 2.0206130651657808
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0955, Accuracy: 9685/9900 (97.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 45.32082628242644.
Norm before scaling: 45.30777992657553. Distance: 1.915380281184787
Total norm for 4 adversaries is: 45.30777992657553. distance: 1.915380281184787
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1829, Accuracy: 9453/9900 (95.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4641/5066 (91.6107%), train_poison_data_count: 400
Global model norm: 45.32082628242644.
Norm before scaling: 45.307241074137366. Distance: 1.9889372996731822
Total norm for 4 adversaries is: 45.307241074137366. distance: 1.9889372996731822
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1584, Accuracy: 9527/9900 (96.2323%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4577/5083 (90.0452%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4613/5083 (90.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9805, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3309/3646 (90.7570%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3349/3646 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9314, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4066/4503 (90.2954%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4070/4503 (90.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0145, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4054/4501 (90.0689%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4111/4501 (91.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9447, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3627/4013 (90.3813%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7588, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4016/4362 (92.0679%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3983/4362 (91.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1808, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3944/4315 (91.4021%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4054/4315 (93.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7871, Accuracy: 5956/10000 (59.5600%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4212/4651 (90.5612%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4258/4651 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8814, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3928/4416 (88.9493%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4030/4416 (91.2591%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2594, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3309/3704 (89.3359%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3392/3704 (91.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7753, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4218/4707 (89.6112%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4303/4707 (91.4170%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9881, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4200/4662 (90.0901%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4325/4662 (92.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8422, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4946/5424 (91.1873%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4963/5424 (91.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2753, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3900/4336 (89.9446%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4012/4336 (92.5277%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9456, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4133/4481 (92.2339%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4067/4481 (90.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0140, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3434/3828 (89.7074%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3546/3828 (92.6332%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8465, Accuracy: 5745/10000 (57.4500%)
time spent on training: 230.40295124053955
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.3188, Accuracy: 5241/10000 (52.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 6.5865, Accuracy: 826/9900 (8.3434%)
Done in 254.14264583587646 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4498/4885 (92.0778%), train_poison_data_count: 385
Global model norm: 45.34854170064347.
Norm before scaling: 45.333209168507196. Distance: 1.957297240434242
Total norm for 4 adversaries is: 45.333209168507196. distance: 1.957297240434242
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0683, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4862/5305 (91.6494%), train_poison_data_count: 415
Global model norm: 45.34854170064347.
Norm before scaling: 45.33521521159076. Distance: 2.0653054779436677
Total norm for 4 adversaries is: 45.33521521159076. distance: 2.0653054779436677
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0814, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.34854170064347.
Norm before scaling: 45.33674728403963. Distance: 1.9679522638966815
Total norm for 4 adversaries is: 45.33674728403963. distance: 1.9679522638966815
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0650, Accuracy: 9728/9900 (98.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4604/5066 (90.8804%), train_poison_data_count: 400
Global model norm: 45.34854170064347.
Norm before scaling: 45.336706896150936. Distance: 2.0927172718708498
Total norm for 4 adversaries is: 45.336706896150936. distance: 2.0927172718708498
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1054, Accuracy: 9628/9900 (97.2525%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3771/4184 (90.1291%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3845/4184 (91.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0182, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4498/5037 (89.2992%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4645/5037 (92.2176%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7919, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3661/4158 (88.0471%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3716/4158 (89.3699%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9151, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2945/3271 (90.0336%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3017/3271 (92.2348%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7535, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4464/4918 (90.7686%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4519/4918 (91.8869%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0746, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5479/5902 (92.8329%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5373/5902 (91.0369%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1460, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4243/4354 (97.4506%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3762/4354 (86.4033%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3809, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3639/3969 (91.6856%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3661/3969 (92.2399%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8754, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4064/4356 (93.2966%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3995/4356 (91.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2362, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3900/4295 (90.8033%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3833/4295 (89.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0462, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3794/4126 (91.9535%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3831/4126 (92.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8276, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4453/4928 (90.3612%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4509/4928 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9207, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4055/4511 (89.8914%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4150/4511 (91.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0792, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4208/4618 (91.1217%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4262/4618 (92.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9928, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3303/3704 (89.1739%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3371/3704 (91.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8905, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3215/3616 (88.9104%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3307/3616 (91.4546%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9714, Accuracy: 5750/10000 (57.5000%)
time spent on training: 229.28852534294128
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.3659, Accuracy: 5233/10000 (52.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 7.8931, Accuracy: 332/9900 (3.3535%)
Done in 252.9318618774414 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4545/4885 (93.0399%), train_poison_data_count: 385
Global model norm: 45.380799818728406.
Norm before scaling: 45.365036892585294. Distance: 1.8629289529944584
Total norm for 4 adversaries is: 45.365036892585294. distance: 1.8629289529944584
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1790, Accuracy: 9449/9900 (95.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4839/5305 (91.2158%), train_poison_data_count: 415
Global model norm: 45.380799818728406.
Norm before scaling: 45.36809628093568. Distance: 2.0561568079646086
Total norm for 4 adversaries is: 45.36809628093568. distance: 2.0561568079646086
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0635, Accuracy: 9751/9900 (98.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4339/4717 (91.9864%), train_poison_data_count: 370
Global model norm: 45.380799818728406.
Norm before scaling: 45.36830346160605. Distance: 1.9101820243859566
Total norm for 4 adversaries is: 45.36830346160605. distance: 1.9101820243859566
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2032, Accuracy: 9410/9900 (95.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 45.380799818728406.
Norm before scaling: 45.37305221370389. Distance: 2.101465726418183
Total norm for 4 adversaries is: 45.37305221370389. distance: 2.101465726418183
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2031, Accuracy: 9381/9900 (94.7576%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2935/3271 (89.7279%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3015/3271 (92.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9305, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4055/4456 (91.0009%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4174/4456 (93.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8288, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3645/4013 (90.8298%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3727/4013 (92.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7535, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3511/3781 (92.8590%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3576/3781 (94.5782%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0143, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3417/3775 (90.5166%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3570/3775 (94.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8474, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4749/5232 (90.7683%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4761/5232 (90.9977%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9641, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4437/4989 (88.9357%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4477/4989 (89.7374%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0742, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3241/3646 (88.8919%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3364/3646 (92.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8404, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3983/4315 (92.3059%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3986/4315 (92.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8624, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4455/4918 (90.5856%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4553/4918 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9952, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3903/4416 (88.3832%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3996/4416 (90.4891%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8096, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5678/6263 (90.6594%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5758/6263 (91.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0783, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5546/6124 (90.5617%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5573/6124 (91.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9603, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4226/4651 (90.8622%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4296/4651 (92.3672%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8681, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4086/4356 (93.8017%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3955/4356 (90.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2793, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4059/4356 (93.1818%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3989/4356 (91.5748%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1268, Accuracy: 5307/10000 (53.0700%)
time spent on training: 232.90884232521057
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.8163, Accuracy: 4636/10000 (46.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 8.5197, Accuracy: 168/9900 (1.6970%)
Done in 256.6025378704071 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 45.409164135667595.
Norm before scaling: 45.39712464221991. Distance: 2.0057166177823795
Total norm for 4 adversaries is: 45.39712464221991. distance: 2.0057166177823795
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0810, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4865/5305 (91.7059%), train_poison_data_count: 415
Global model norm: 45.409164135667595.
Norm before scaling: 45.39475024283507. Distance: 2.094198492040848
Total norm for 4 adversaries is: 45.39475024283507. distance: 2.094198492040848
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0981, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 45.409164135667595.
Norm before scaling: 45.39389779509191. Distance: 1.888753169301351
Total norm for 4 adversaries is: 45.39389779509191. distance: 1.888753169301351
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1374, Accuracy: 9552/9900 (96.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4623/5066 (91.2554%), train_poison_data_count: 400
Global model norm: 45.409164135667595.
Norm before scaling: 45.4000985165506. Distance: 2.072838275392023
Total norm for 4 adversaries is: 45.4000985165506. distance: 2.072838275392023
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0834, Accuracy: 9703/9900 (98.0101%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4185/4716 (88.7405%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4259/4716 (90.3096%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8956, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4136/4634 (89.2533%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4214/4634 (90.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9551, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3461/3828 (90.4127%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3521/3828 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8700, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4385/4989 (87.8934%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4533/4989 (90.8599%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9402, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4550/5116 (88.9367%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4621/5116 (90.3245%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0339, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4002/4362 (91.7469%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4031/4362 (92.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9763, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4501/5017 (89.7150%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4619/5017 (92.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8528, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4249/4354 (97.5884%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3959/4354 (90.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0761, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3211/3638 (88.2628%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3310/3638 (90.9841%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8465, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4722/5195 (90.8951%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4638/5195 (89.2782%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9822, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4147/4596 (90.2306%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4301/4596 (93.5814%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0267, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4323/4928 (87.7232%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4509/4928 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0455, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4666/5244 (88.9779%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4745/5244 (90.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8374, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5429/5902 (91.9858%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5421/5902 (91.8502%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0201, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4520/5025 (89.9502%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4662/5025 (92.7761%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9631, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5572/6124 (90.9863%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5604/6124 (91.5088%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9545, Accuracy: 5565/10000 (55.6500%)
time spent on training: 235.1721911430359
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.9832, Accuracy: 4356/10000 (43.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 8.4527, Accuracy: 185/9900 (1.8687%)
Done in 259.38735604286194 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 45.436839102827676.
Norm before scaling: 45.429872231997585. Distance: 2.051674261484517
Total norm for 4 adversaries is: 45.429872231997585. distance: 2.051674261484517
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0442, Accuracy: 9790/9900 (98.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4855/5305 (91.5174%), train_poison_data_count: 415
Global model norm: 45.436839102827676.
Norm before scaling: 45.423471334177826. Distance: 2.0893204934156326
Total norm for 4 adversaries is: 45.423471334177826. distance: 2.0893204934156326
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1822, Accuracy: 9455/9900 (95.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 45.436839102827676.
Norm before scaling: 45.42617207486231. Distance: 1.951494680895387
Total norm for 4 adversaries is: 45.42617207486231. distance: 1.951494680895387
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0834, Accuracy: 9688/9900 (97.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4620/5066 (91.1962%), train_poison_data_count: 400
Global model norm: 45.436839102827676.
Norm before scaling: 45.4274269912668. Distance: 2.081425619877872
Total norm for 4 adversaries is: 45.4274269912668. distance: 2.081425619877872
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0460, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4564/5116 (89.2103%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4644/5116 (90.7740%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1147, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4692/5197 (90.2829%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4718/5197 (90.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0260, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4147/4356 (95.2020%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3858/4356 (88.5675%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0890, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4274/4679 (91.3443%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4186/4679 (89.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1395, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4165/4647 (89.6277%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4283/4647 (92.1670%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8859, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3589/3911 (91.7668%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3418/3911 (87.3945%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2015, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3922/4315 (90.8922%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4045/4315 (93.7428%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8713, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3262/3646 (89.4679%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3348/3646 (91.8267%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8144, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4147/4634 (89.4907%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4256/4634 (91.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8819, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4581/5055 (90.6231%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4635/5055 (91.6914%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8729, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4014/4362 (92.0220%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3983/4362 (91.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9080, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4542/4934 (92.0551%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4331/4934 (87.7787%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0559, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4156/4767 (87.1827%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4286/4767 (89.9098%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1572, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3999/4433 (90.2098%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4074/4433 (91.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8394, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4307/4928 (87.3985%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4410/4928 (89.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0277, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3429/3837 (89.3667%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3549/3837 (92.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9220, Accuracy: 5664/10000 (56.6400%)
time spent on training: 233.46877074241638
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 3.0839, Accuracy: 4248/10000 (42.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 8.2731, Accuracy: 173/9900 (1.7475%)
Done in 256.95478796958923 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 45.465995406251146.
Norm before scaling: 45.45449733662226. Distance: 2.0376160851858014
Total norm for 4 adversaries is: 45.45449733662226. distance: 2.0376160851858014
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0745, Accuracy: 9704/9900 (98.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 45.465995406251146.
Norm before scaling: 45.45789980077033. Distance: 2.178783270209247
Total norm for 4 adversaries is: 45.45789980077033. distance: 2.178783270209247
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1437, Accuracy: 9521/9900 (96.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 45.465995406251146.
Norm before scaling: 45.45597167950681. Distance: 2.023144792867103
Total norm for 4 adversaries is: 45.45597167950681. distance: 2.023144792867103
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1297, Accuracy: 9578/9900 (96.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4597/5066 (90.7422%), train_poison_data_count: 400
Global model norm: 45.465995406251146.
Norm before scaling: 45.4602896982974. Distance: 2.1240318561255576
Total norm for 4 adversaries is: 45.4602896982974. distance: 2.1240318561255576
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1734, Accuracy: 9483/9900 (95.7879%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4485/4986 (89.9519%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4534/4986 (90.9346%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8868, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4166/4767 (87.3925%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4257/4767 (89.3014%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9720, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3938/4315 (91.2630%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4030/4315 (93.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7480, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3335/3672 (90.8224%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3379/3672 (92.0207%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9874, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4043/4558 (88.7012%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4027/4558 (88.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.3757, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3461/3828 (90.4127%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3572/3828 (93.3124%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9037, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4297/4679 (91.8359%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4246/4679 (90.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9607, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4391/4956 (88.5997%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4473/4956 (90.2542%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9745, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4133/4356 (94.8806%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4040/4356 (92.7456%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0981, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4138/4538 (91.1855%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4227/4538 (93.1468%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8017, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3627/4013 (90.3813%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3766/4013 (93.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.6980, Accuracy: 6044/10000 (60.4400%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4748/5265 (90.1804%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4819/5265 (91.5290%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9321, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4236/4663 (90.8428%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4336/4663 (92.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9368, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5667/6263 (90.4838%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5770/6263 (92.1284%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0033, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4707/5063 (92.9686%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4580/5063 (90.4602%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0940, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3911/4416 (88.5643%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4075/4416 (92.2781%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9281, Accuracy: 5686/10000 (56.8600%)
time spent on training: 234.8727149963379
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.8489, Accuracy: 4530/10000 (45.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 8.4715, Accuracy: 174/9900 (1.7576%)
Done in 258.6971356868744 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 45.49715875830187.
Norm before scaling: 45.48322632524132. Distance: 2.0119524477426247
Total norm for 4 adversaries is: 45.48322632524132. distance: 2.0119524477426247
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1180, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4853/5305 (91.4797%), train_poison_data_count: 415
Global model norm: 45.49715875830187.
Norm before scaling: 45.484273016031324. Distance: 2.088010065500253
Total norm for 4 adversaries is: 45.484273016031324. distance: 2.088010065500253
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0385, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 45.49715875830187.
Norm before scaling: 45.48283984870695. Distance: 1.9502938464873658
Total norm for 4 adversaries is: 45.48283984870695. distance: 1.9502938464873658
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1255, Accuracy: 9596/9900 (96.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4632/5066 (91.4331%), train_poison_data_count: 400
Global model norm: 45.49715875830187.
Norm before scaling: 45.48547533880321. Distance: 2.05825021037964
Total norm for 4 adversaries is: 45.48547533880321. distance: 2.05825021037964
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1331, Accuracy: 9569/9900 (96.6566%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5103/5740 (88.9024%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5270/5740 (91.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1213, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4197/4651 (90.2387%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4316/4651 (92.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9716, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4063/4503 (90.2287%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4080/4503 (90.6063%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0073, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4140/4767 (86.8471%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4197/4767 (88.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1735, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5052/5591 (90.3595%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5036/5591 (90.0733%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0418, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4004/4465 (89.6753%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4140/4465 (92.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8553, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4411/4956 (89.0032%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4489/4956 (90.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9773, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3292/3704 (88.8769%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3379/3704 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8236, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3675/4025 (91.3043%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3787/4025 (94.0870%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7367, Accuracy: 5968/10000 (59.6800%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4552/5083 (89.5534%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4576/5083 (90.0256%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1385, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5517/6124 (90.0882%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5520/6124 (90.1372%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8411, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3834/4295 (89.2666%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3823/4295 (89.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9631, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4484/4804 (93.3389%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4475/4804 (93.1515%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9976, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4279/4793 (89.2760%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4370/4793 (91.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0639, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3986/4433 (89.9165%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4091/4433 (92.2851%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9719, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3944/4361 (90.4380%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3819/4361 (87.5717%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2218, Accuracy: 5184/10000 (51.8400%)
time spent on training: 235.59693217277527
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.7026, Accuracy: 4667/10000 (46.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 8.7189, Accuracy: 132/9900 (1.3333%)
Done in 259.40651416778564 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4490/4885 (91.9140%), train_poison_data_count: 385
Global model norm: 45.52737307619176.
Norm before scaling: 45.51470508424997. Distance: 2.0068158596547336
Total norm for 4 adversaries is: 45.51470508424997. distance: 2.0068158596547336
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0341, Accuracy: 9810/9900 (99.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4825/5305 (90.9519%), train_poison_data_count: 415
Global model norm: 45.52737307619176.
Norm before scaling: 45.512527250403814. Distance: 2.115578916602798
Total norm for 4 adversaries is: 45.512527250403814. distance: 2.115578916602798
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0972, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 45.52737307619176.
Norm before scaling: 45.51497060120027. Distance: 1.9400339476574513
Total norm for 4 adversaries is: 45.51497060120027. distance: 1.9400339476574513
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2580, Accuracy: 9292/9900 (93.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4590/5066 (90.6040%), train_poison_data_count: 400
Global model norm: 45.52737307619176.
Norm before scaling: 45.51792336713363. Distance: 2.093395715602005
Total norm for 4 adversaries is: 45.51792336713363. distance: 2.093395715602005
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1056, Accuracy: 9629/9900 (97.2626%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4066/4558 (89.2058%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4126/4558 (90.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9851, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4163/4596 (90.5788%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4272/4596 (92.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8745, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4434/4874 (90.9725%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4233/4874 (86.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3678, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3675/4158 (88.3838%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3763/4158 (90.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8764, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4941/5455 (90.5775%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5000/5455 (91.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0201, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3979/4346 (91.5555%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4066/4346 (93.5573%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9046, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4326/4679 (92.4557%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4405/4679 (94.1440%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8530, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3970/4416 (89.9004%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8756, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3446/3828 (90.0209%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3573/3828 (93.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9279, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3807/4223 (90.1492%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3944/4223 (93.3933%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8313, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4736/5265 (89.9525%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4733/5265 (89.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0700, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5497/6124 (89.7616%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5511/6124 (89.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8888, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3946/4361 (90.4838%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3979/4361 (91.2405%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9230, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4415/4956 (89.0839%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4462/4956 (90.0323%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0972, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5157/5740 (89.8432%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5261/5740 (91.6551%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1652, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3629/4013 (90.4311%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3727/4013 (92.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8357, Accuracy: 5771/10000 (57.7100%)
time spent on training: 235.94691824913025
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.6732, Accuracy: 4728/10000 (47.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 8.6268, Accuracy: 135/9900 (1.3636%)
Done in 259.6913356781006 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 45.560190485019376.
Norm before scaling: 45.54602807960454. Distance: 2.011311728773114
Total norm for 4 adversaries is: 45.54602807960454. distance: 2.011311728773114
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1305, Accuracy: 9562/9900 (96.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 45.560190485019376.
Norm before scaling: 45.54384906329284. Distance: 2.0693449242519586
Total norm for 4 adversaries is: 45.54384906329284. distance: 2.0693449242519586
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1373, Accuracy: 9562/9900 (96.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4334/4717 (91.8804%), train_poison_data_count: 370
Global model norm: 45.560190485019376.
Norm before scaling: 45.54170478802918. Distance: 1.9028669887089165
Total norm for 4 adversaries is: 45.54170478802918. distance: 1.9028669887089165
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1197, Accuracy: 9605/9900 (97.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4603/5066 (90.8606%), train_poison_data_count: 400
Global model norm: 45.560190485019376.
Norm before scaling: 45.546180848055194. Distance: 2.080373250593722
Total norm for 4 adversaries is: 45.546180848055194. distance: 2.080373250593722
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2277, Accuracy: 9346/9900 (94.4040%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3744/4184 (89.4837%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3847/4184 (91.9455%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8569, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3249/3590 (90.5014%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3255/3590 (90.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0158, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3637/4158 (87.4699%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3702/4158 (89.0332%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9430, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3641/4025 (90.4596%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3762/4025 (93.4658%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9365, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3626/4046 (89.6194%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3710/4046 (91.6955%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9545, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4519/5025 (89.9303%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4598/5025 (91.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0246, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4808/5063 (94.9635%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4744/5063 (93.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8381, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4032/4356 (92.5620%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4130/4356 (94.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8922, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4174/4651 (89.7441%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4285/4651 (92.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0164, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3962/4356 (90.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0374, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4137/4576 (90.4065%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4214/4576 (92.0892%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9859, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4074/4456 (91.4273%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4149/4456 (93.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8716, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2963/3297 (89.8696%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3090/3297 (93.7216%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7105, Accuracy: 5984/10000 (59.8400%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4516/4804 (94.0050%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4360/4804 (90.7577%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1846, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3597/3969 (90.6274%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3619/3969 (91.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8800, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4686/5195 (90.2021%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4688/5195 (90.2406%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9453, Accuracy: 5657/10000 (56.5700%)
time spent on training: 230.59149026870728
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.8963, Accuracy: 4492/10000 (44.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 8.2135, Accuracy: 169/9900 (1.7071%)
Done in 254.24194765090942 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 45.586319755252504.
Norm before scaling: 45.572264578668076. Distance: 1.9819954850485118
Total norm for 4 adversaries is: 45.572264578668076. distance: 1.9819954850485118
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1756, Accuracy: 9461/9900 (95.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 45.586319755252504.
Norm before scaling: 45.57417170890904. Distance: 2.1060717679915735
Total norm for 4 adversaries is: 45.57417170890904. distance: 2.1060717679915735
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1268, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4348/4717 (92.1772%), train_poison_data_count: 370
Global model norm: 45.586319755252504.
Norm before scaling: 45.56986983862665. Distance: 1.8974980671185486
Total norm for 4 adversaries is: 45.56986983862665. distance: 1.8974980671185486
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0975, Accuracy: 9648/9900 (97.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4607/5066 (90.9396%), train_poison_data_count: 400
Global model norm: 45.586319755252504.
Norm before scaling: 45.57509845967834. Distance: 2.119412312473071
Total norm for 4 adversaries is: 45.57509845967834. distance: 2.119412312473071
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1606, Accuracy: 9523/9900 (96.1919%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3428/3837 (89.3406%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3578/3837 (93.2499%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8027, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5091/5582 (91.2039%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5155/5582 (92.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9845, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4968/5455 (91.0724%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4971/5455 (91.1274%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9906, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4308/4679 (92.0710%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4316/4679 (92.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9666, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4108/4518 (90.9252%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4161/4518 (92.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9391, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4229/4618 (91.5764%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4291/4618 (92.9190%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9052, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4162/4716 (88.2528%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4254/4716 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0510, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4634/5244 (88.3677%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4693/5244 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9645, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4528/4874 (92.9011%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4369/4874 (89.6389%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1651, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4389/4928 (89.0625%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4448/4928 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9673, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3727/4126 (90.3296%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3871/4126 (93.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7962, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3399/3828 (88.7931%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3544/3828 (92.5810%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9998, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3136/3472 (90.3226%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3194/3472 (91.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9265, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3253/3638 (89.4173%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8752, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3243/3590 (90.3343%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3232/3590 (90.0279%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9986, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3764/4223 (89.1309%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3854/4223 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9696, Accuracy: 5529/10000 (55.2900%)
time spent on training: 231.2143166065216
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.8033, Accuracy: 4577/10000 (45.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 8.3694, Accuracy: 159/9900 (1.6061%)
Done in 254.88416647911072 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4515/4885 (92.4258%), train_poison_data_count: 385
Global model norm: 45.614379650055255.
Norm before scaling: 45.60003865558257. Distance: 1.9573675845048526
Total norm for 4 adversaries is: 45.60003865558257. distance: 1.9573675845048526
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1541, Accuracy: 9544/9900 (96.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4849/5305 (91.4043%), train_poison_data_count: 415
Global model norm: 45.614379650055255.
Norm before scaling: 45.60044020055481. Distance: 2.0447724004438
Total norm for 4 adversaries is: 45.60044020055481. distance: 2.0447724004438
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1553, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.614379650055255.
Norm before scaling: 45.59879919779961. Distance: 1.918073352206633
Total norm for 4 adversaries is: 45.59879919779961. distance: 1.918073352206633
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1310, Accuracy: 9586/9900 (96.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4615/5066 (91.0975%), train_poison_data_count: 400
Global model norm: 45.614379650055255.
Norm before scaling: 45.60347576614227. Distance: 2.108275289327074
Total norm for 4 adversaries is: 45.60347576614227. distance: 2.108275289327074
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0984, Accuracy: 9632/9900 (97.2929%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4031/4441 (90.7678%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4107/4441 (92.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9039, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4520/5017 (90.0937%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4664/5017 (92.9639%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8590, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4448/4918 (90.4433%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4537/4918 (92.2529%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9435, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4707/5197 (90.5715%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4771/5197 (91.8030%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9729, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4136/4356 (94.9495%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3855/4356 (88.4986%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1598, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4953/5455 (90.7974%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4962/5455 (90.9624%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0662, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2970/3297 (90.0819%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3082/3297 (93.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7514, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4702/5195 (90.5101%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4752/5195 (91.4726%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9953, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3456/3828 (90.2821%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3527/3828 (92.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8581, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4085/4456 (91.6741%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4169/4456 (93.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9100, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3966/4361 (90.9424%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3939/4361 (90.3233%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1185, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3831/4235 (90.4604%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3897/4235 (92.0189%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9342, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4528/5025 (90.1095%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4615/5025 (91.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0223, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3243/3646 (88.9468%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3379/3646 (92.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8100, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3622/4158 (87.1092%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3726/4158 (89.6104%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0431, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4141/4538 (91.2517%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4275/4538 (94.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8289, Accuracy: 5811/10000 (58.1100%)
time spent on training: 232.7377634048462
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.8298, Accuracy: 4610/10000 (46.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 8.2591, Accuracy: 187/9900 (1.8889%)
Done in 256.41712045669556 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4505/4885 (92.2211%), train_poison_data_count: 385
Global model norm: 45.64289835146181.
Norm before scaling: 45.6272982083848. Distance: 1.9477058609367943
Total norm for 4 adversaries is: 45.6272982083848. distance: 1.9477058609367943
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2068, Accuracy: 9406/9900 (95.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 45.64289835146181.
Norm before scaling: 45.62723399924518. Distance: 2.0936936328189684
Total norm for 4 adversaries is: 45.62723399924518. distance: 2.0936936328189684
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1690, Accuracy: 9464/9900 (95.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 45.64289835146181.
Norm before scaling: 45.62724202539257. Distance: 1.9645586963563708
Total norm for 4 adversaries is: 45.62724202539257. distance: 1.9645586963563708
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0836, Accuracy: 9670/9900 (97.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 45.64289835146181.
Norm before scaling: 45.630353388842224. Distance: 2.1136404356260035
Total norm for 4 adversaries is: 45.630353388842224. distance: 2.1136404356260035
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1243, Accuracy: 9565/9900 (96.6162%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3889/4295 (90.5471%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3918/4295 (91.2224%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8714, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5114/5582 (91.6159%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5096/5582 (91.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1822, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3283/3672 (89.4063%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3382/3672 (92.1024%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9252, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4108/4518 (90.9252%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4173/4518 (92.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9953, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3431/3797 (90.3608%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3471/3797 (91.4143%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9086, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4027/4362 (92.3200%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3992/4362 (91.5177%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9625, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4544/4804 (94.5878%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4279/4804 (89.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1664, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4596/5116 (89.8358%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4663/5116 (91.1454%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0634, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4518/5025 (89.9104%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4637/5025 (92.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0463, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2975/3297 (90.2335%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3090/3297 (93.7216%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8008, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3335/3704 (90.0378%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3388/3704 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7877, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4907/5424 (90.4683%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5007/5424 (92.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0704, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3460/3861 (89.6141%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3542/3861 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8376, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4628/4874 (94.9528%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4594/4874 (94.2552%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0006, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4177/4647 (89.8859%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4264/4647 (91.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0098, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4024/4356 (92.3783%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3911/4356 (89.7842%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2034, Accuracy: 5162/10000 (51.6200%)
time spent on training: 229.99124836921692
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.8041, Accuracy: 4670/10000 (46.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 8.1561, Accuracy: 197/9900 (1.9899%)
Done in 253.72612690925598 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4500/4885 (92.1187%), train_poison_data_count: 385
Global model norm: 45.66913800386017.
Norm before scaling: 45.65715636934012. Distance: 1.9903916585989707
Total norm for 4 adversaries is: 45.65715636934012. distance: 1.9903916585989707
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2445, Accuracy: 9336/9900 (94.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4837/5305 (91.1781%), train_poison_data_count: 415
Global model norm: 45.66913800386017.
Norm before scaling: 45.65513506082174. Distance: 2.0786139121042324
Total norm for 4 adversaries is: 45.65513506082174. distance: 2.0786139121042324
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1685, Accuracy: 9503/9900 (95.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 45.66913800386017.
Norm before scaling: 45.654744691988206. Distance: 1.9749842437888236
Total norm for 4 adversaries is: 45.654744691988206. distance: 1.9749842437888236
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1185, Accuracy: 9595/9900 (96.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4585/5066 (90.5053%), train_poison_data_count: 400
Global model norm: 45.66913800386017.
Norm before scaling: 45.65958930721043. Distance: 2.1646233117747444
Total norm for 4 adversaries is: 45.65958930721043. distance: 2.1646233117747444
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0968, Accuracy: 9659/9900 (97.5657%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4055/4503 (90.0511%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4051/4503 (89.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9656, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3430/3861 (88.8371%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3527/3861 (91.3494%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8933, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3735/4184 (89.2686%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3868/4184 (92.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9162, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4062/4518 (89.9070%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4189/4518 (92.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9167, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4563/5083 (89.7698%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4593/5083 (90.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9377, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4577/4804 (95.2748%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4183/4804 (87.0733%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0518, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4096/4356 (94.0312%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3799/4356 (87.2130%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3158, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4650/5244 (88.6728%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4659/5244 (88.8444%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8957, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4333/4679 (92.6053%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4194/4679 (89.6345%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9785, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3910/4416 (88.5417%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4023/4416 (91.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8229, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4420/4918 (89.8739%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4536/4918 (92.2326%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0420, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3226/3616 (89.2146%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3334/3616 (92.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7980, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4097/4576 (89.5323%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4249/4576 (92.8540%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9076, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4411/4928 (89.5089%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4482/4928 (90.9497%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9705, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3682/4013 (91.7518%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3763/4013 (93.7702%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8335, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3898/4336 (89.8985%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4046/4336 (93.3118%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1057, Accuracy: 5470/10000 (54.7000%)
time spent on training: 230.92165088653564
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.8046, Accuracy: 4685/10000 (46.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 8.4130, Accuracy: 158/9900 (1.5960%)
Done in 254.6367208957672 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 45.70078252543932.
Norm before scaling: 45.687924822751306. Distance: 2.044536273674629
Total norm for 4 adversaries is: 45.687924822751306. distance: 2.044536273674629
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0640, Accuracy: 9741/9900 (98.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 45.70078252543932.
Norm before scaling: 45.68665568645291. Distance: 2.120701762416962
Total norm for 4 adversaries is: 45.68665568645291. distance: 2.120701762416962
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1336, Accuracy: 9590/9900 (96.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 45.70078252543932.
Norm before scaling: 45.68696562614987. Distance: 2.001634883241833
Total norm for 4 adversaries is: 45.68696562614987. distance: 2.001634883241833
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0388, Accuracy: 9796/9900 (98.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 45.70078252543932.
Norm before scaling: 45.69193773334772. Distance: 2.172062488394662
Total norm for 4 adversaries is: 45.69193773334772. distance: 2.172062488394662
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0913, Accuracy: 9676/9900 (97.7374%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5730/6263 (91.4897%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5798/6263 (92.5754%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9433, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3173/3472 (91.3882%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3223/3472 (92.8283%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9686, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3657/4158 (87.9509%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3800/4158 (91.3901%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9369, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3182/3638 (87.4656%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3326/3638 (91.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9075, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4555/4874 (93.4551%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4429/4874 (90.8699%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1122, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4177/4356 (95.8907%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3943/4356 (90.5188%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0245, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4065/4538 (89.5769%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4242/4538 (93.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8052, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4438/4928 (90.0568%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4512/4928 (91.5584%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8452, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4196/4618 (90.8618%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4277/4618 (92.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8615, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4227/4707 (89.8024%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4326/4707 (91.9057%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9084, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4324/4679 (92.4129%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4344/4679 (92.8404%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9960, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4145/4647 (89.1973%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4314/4647 (92.8341%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8797, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4140/4576 (90.4720%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4252/4576 (92.9196%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9841, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3639/4046 (89.9407%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3767/4046 (93.1043%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8822, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4118/4651 (88.5401%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4285/4651 (92.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0057, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4502/5055 (89.0603%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4643/5055 (91.8497%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0181, Accuracy: 5546/10000 (55.4600%)
time spent on training: 242.3970808982849
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.7940, Accuracy: 4692/10000 (46.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 8.6483, Accuracy: 118/9900 (1.1919%)
Done in 266.074604511261 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 45.72586506921575.
Norm before scaling: 45.712699317654064. Distance: 2.0695752252591815
Total norm for 4 adversaries is: 45.712699317654064. distance: 2.0695752252591815
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.3355, Accuracy: 9077/9900 (91.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 45.72586506921575.
Norm before scaling: 45.71611193687626. Distance: 2.181251538994801
Total norm for 4 adversaries is: 45.71611193687626. distance: 2.181251538994801
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1277, Accuracy: 9596/9900 (96.9293%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 45.72586506921575.
Norm before scaling: 45.71317197260408. Distance: 2.0033231782999636
Total norm for 4 adversaries is: 45.71317197260408. distance: 2.0033231782999636
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1595, Accuracy: 9503/9900 (95.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4599/5066 (90.7817%), train_poison_data_count: 400
Global model norm: 45.72586506921575.
Norm before scaling: 45.71462996216993. Distance: 2.1579815090543315
Total norm for 4 adversaries is: 45.71462996216993. distance: 2.1579815090543315
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0813, Accuracy: 9678/9900 (97.7576%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5167/5740 (90.0174%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5277/5740 (91.9338%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9465, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3723/4175 (89.1737%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3775/4175 (90.4192%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9306, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4399/4918 (89.4469%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4518/4918 (91.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9639, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3866/4235 (91.2869%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3892/4235 (91.9008%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9389, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4905/5455 (89.9175%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4980/5455 (91.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9253, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4179/4662 (89.6396%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4317/4662 (92.5997%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8390, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4044/4465 (90.5711%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4104/4465 (91.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9401, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4175/4651 (89.7656%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4231/4651 (90.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1158, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4204/4618 (91.0351%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4314/4618 (93.4171%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9018, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4469/5037 (88.7234%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4656/5037 (92.4360%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9952, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4202/4354 (96.5090%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4097/4354 (94.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2099, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4056/4441 (91.3308%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4144/4441 (93.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9560, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4112/4538 (90.6126%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4256/4538 (93.7858%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.7604, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4571/5116 (89.3471%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4628/5116 (90.4613%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8728, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5481/6124 (89.5003%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5462/6124 (89.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9866, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4006/4362 (91.8386%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0489, Accuracy: 5468/10000 (54.6800%)
time spent on training: 237.0479018688202
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.7247, Accuracy: 4741/10000 (47.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 7.7682, Accuracy: 295/9900 (2.9798%)
Done in 260.80932092666626 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4448/4885 (91.0542%), train_poison_data_count: 385
Global model norm: 45.748839316731576.
Norm before scaling: 45.738253059870466. Distance: 2.084684188307195
Total norm for 4 adversaries is: 45.738253059870466. distance: 2.084684188307195
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1030, Accuracy: 9646/9900 (97.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 45.748839316731576.
Norm before scaling: 45.736715754071696. Distance: 2.127569552404194
Total norm for 4 adversaries is: 45.736715754071696. distance: 2.127569552404194
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0987, Accuracy: 9654/9900 (97.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4317/4717 (91.5200%), train_poison_data_count: 370
Global model norm: 45.748839316731576.
Norm before scaling: 45.73333403325057. Distance: 1.9659135154918888
Total norm for 4 adversaries is: 45.73333403325057. distance: 1.9659135154918888
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0896, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4603/5066 (90.8606%), train_poison_data_count: 400
Global model norm: 45.748839316731576.
Norm before scaling: 45.7370146786905. Distance: 2.145263102296819
Total norm for 4 adversaries is: 45.7370146786905. distance: 2.145263102296819
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1922, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3978/4361 (91.2176%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3905/4361 (89.5437%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0339, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3411/3797 (89.8341%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3507/3797 (92.3624%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9065, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4401/4918 (89.4876%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4500/4918 (91.5006%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1252, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3216/3638 (88.4002%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8600, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3272/3590 (91.1421%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3266/3590 (90.9749%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1280, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4403/4986 (88.3073%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4554/4986 (91.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8149, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4863/5392 (90.1892%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4942/5392 (91.6543%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0456, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3381/3804 (88.8801%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3486/3804 (91.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9176, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4482/5025 (89.1940%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4597/5025 (91.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2100, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4259/4793 (88.8588%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4394/4793 (91.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0242, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4382/4956 (88.4181%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4431/4956 (89.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1461, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4504/5116 (88.0375%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4598/5116 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9465, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4555/5055 (90.1088%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4663/5055 (92.2453%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.7791, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4750/5063 (93.8179%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4538/5063 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9877, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4012/4433 (90.5030%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4049/4433 (91.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8156, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4200/4662 (90.0901%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4311/4662 (92.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9347, Accuracy: 5675/10000 (56.7500%)
time spent on training: 233.777352809906
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.8174, Accuracy: 4655/10000 (46.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 8.2016, Accuracy: 226/9900 (2.2828%)
Done in 257.489684343338 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 45.77417820807928.
Norm before scaling: 45.75980726508253. Distance: 2.0224800348416316
Total norm for 4 adversaries is: 45.75980726508253. distance: 2.0224800348416316
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2717, Accuracy: 9253/9900 (93.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 45.77417820807928.
Norm before scaling: 45.759937978849194. Distance: 2.164904268892562
Total norm for 4 adversaries is: 45.759937978849194. distance: 2.164904268892562
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0868, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 45.77417820807928.
Norm before scaling: 45.760388805098124. Distance: 1.9840369349587208
Total norm for 4 adversaries is: 45.760388805098124. distance: 1.9840369349587208
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1204, Accuracy: 9614/9900 (97.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4558/5066 (89.9724%), train_poison_data_count: 400
Global model norm: 45.77417820807928.
Norm before scaling: 45.764640758450184. Distance: 2.1742433218299126
Total norm for 4 adversaries is: 45.764640758450184. distance: 2.1742433218299126
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0834, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4581/4804 (95.3580%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4344/4804 (90.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9369, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4292/4793 (89.5473%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4380/4793 (91.3833%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9474, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3432/3781 (90.7696%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3389/3781 (89.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1810, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3726/4175 (89.2455%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3769/4175 (90.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8513, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3960/4362 (90.7840%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4027/4362 (92.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9030, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4570/5083 (89.9075%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4668/5083 (91.8355%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8665, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4540/4874 (93.1473%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4497/4874 (92.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0814, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3296/3646 (90.4004%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3389/3646 (92.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7385, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3406/3756 (90.6816%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3524/3756 (93.8232%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9009, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3785/4223 (89.6282%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3860/4223 (91.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0506, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4237/4356 (97.2681%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0014, Accuracy: 4288/4356 (98.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.6037, Accuracy: 6236/10000 (62.3600%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4512/5025 (89.7910%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4657/5025 (92.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9740, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5739/6391 (89.7982%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5790/6391 (90.5962%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0680, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4066/4518 (89.9956%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4176/4518 (92.4303%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0343, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4620/5167 (89.4136%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4747/5167 (91.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1163, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4301/4679 (91.9214%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4370/4679 (93.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0298, Accuracy: 5594/10000 (55.9400%)
time spent on training: 233.87169456481934
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.7995, Accuracy: 4694/10000 (46.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 7.9658, Accuracy: 272/9900 (2.7475%)
Done in 257.8428680896759 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4477/4885 (91.6479%), train_poison_data_count: 385
Global model norm: 45.79712022281669.
Norm before scaling: 45.78379365800468. Distance: 2.0228541649049108
Total norm for 4 adversaries is: 45.78379365800468. distance: 2.0228541649049108
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.2497, Accuracy: 9350/9900 (94.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4846/5305 (91.3478%), train_poison_data_count: 415
Global model norm: 45.79712022281669.
Norm before scaling: 45.78338305611. Distance: 2.1289574293231794
Total norm for 4 adversaries is: 45.78338305611. distance: 2.1289574293231794
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1390, Accuracy: 9595/9900 (96.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 45.79712022281669.
Norm before scaling: 45.77914617606334. Distance: 1.960511849092976
Total norm for 4 adversaries is: 45.77914617606334. distance: 1.960511849092976
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0613, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 45.79712022281669.
Norm before scaling: 45.786841062177736. Distance: 2.139341874753536
Total norm for 4 adversaries is: 45.786841062177736. distance: 2.139341874753536
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0579, Accuracy: 9741/9900 (98.3939%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4436/4956 (89.5077%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4498/4956 (90.7587%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1502, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3421/3797 (90.0974%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3514/3797 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9129, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4503/5017 (89.7548%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4671/5017 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8641, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4022/4433 (90.7286%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4150/4433 (93.6161%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8350, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3537/3781 (93.5467%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3589/3781 (94.9220%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8114, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4785/5265 (90.8832%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4795/5265 (91.0731%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0166, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4711/5197 (90.6485%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4738/5197 (91.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0893, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3235/3646 (88.7274%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3399/3646 (93.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8124, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4065/4356 (93.3196%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3873/4356 (88.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3035, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3386/3804 (89.0116%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3554/3804 (93.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9288, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3235/3590 (90.1114%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3202/3590 (89.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1082, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3669/4046 (90.6822%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3717/4046 (91.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8642, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4627/5244 (88.2342%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4747/5244 (90.5225%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8665, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4529/5025 (90.1294%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1847, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3429/3756 (91.2939%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3525/3756 (93.8498%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9737, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4867/5392 (90.2634%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4896/5392 (90.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9686, Accuracy: 5624/10000 (56.2400%)
time spent on training: 232.19925618171692
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.7855, Accuracy: 4749/10000 (47.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 8.0620, Accuracy: 271/9900 (2.7374%)
Done in 256.2805697917938 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4509/4885 (92.3030%), train_poison_data_count: 385
Global model norm: 45.82345537494963.
Norm before scaling: 45.808111253801165. Distance: 1.9720020984731346
Total norm for 4 adversaries is: 45.808111253801165. distance: 1.9720020984731346
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1531, Accuracy: 9507/9900 (96.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 45.82345537494963.
Norm before scaling: 45.813096858322076. Distance: 2.176822433778907
Total norm for 4 adversaries is: 45.813096858322076. distance: 2.176822433778907
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0802, Accuracy: 9696/9900 (97.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4270/4717 (90.5236%), train_poison_data_count: 370
Global model norm: 45.82345537494963.
Norm before scaling: 45.80826581302631. Distance: 1.9867435647282554
Total norm for 4 adversaries is: 45.80826581302631. distance: 1.9867435647282554
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0758, Accuracy: 9716/9900 (98.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 45.82345537494963.
Norm before scaling: 45.81004320663483. Distance: 2.1741077829294557
Total norm for 4 adversaries is: 45.81004320663483. distance: 2.1741077829294557
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1748, Accuracy: 9439/9900 (95.3434%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4218/4663 (90.4568%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4349/4663 (93.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9963, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4196/4618 (90.8618%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4306/4618 (93.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9403, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4189/4662 (89.8541%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4362/4662 (93.5650%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8751, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4015/4511 (89.0047%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4149/4511 (91.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9691, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3972/4362 (91.0591%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4016/4362 (92.0679%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1457, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4099/4558 (89.9298%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4141/4558 (90.8513%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0274, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3394/3828 (88.6625%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3548/3828 (92.6855%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8281, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4200/4716 (89.0585%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0077, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4042/4465 (90.5263%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4139/4465 (92.6988%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8672, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4469/4928 (90.6859%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0988, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4946/5455 (90.6691%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4871/5455 (89.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0350, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4189/4647 (90.1442%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4244/4647 (91.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8848, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5046/5591 (90.2522%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5097/5591 (91.1644%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9966, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3238/3616 (89.5465%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3316/3616 (91.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8533, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4459/4986 (89.4304%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4535/4986 (90.9547%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9935, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4648/5167 (89.9555%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4717/5167 (91.2909%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1246, Accuracy: 5445/10000 (54.4500%)
time spent on training: 234.66571044921875
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.7319, Accuracy: 4757/10000 (47.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 7.8287, Accuracy: 352/9900 (3.5556%)
Done in 258.475191116333 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4503/4885 (92.1801%), train_poison_data_count: 385
Global model norm: 45.85361707890393.
Norm before scaling: 45.839747716399195. Distance: 2.014668792311134
Total norm for 4 adversaries is: 45.839747716399195. distance: 2.014668792311134
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1584, Accuracy: 9491/9900 (95.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4842/5305 (91.2724%), train_poison_data_count: 415
Global model norm: 45.85361707890393.
Norm before scaling: 45.83958261136738. Distance: 2.1440732706630907
Total norm for 4 adversaries is: 45.83958261136738. distance: 2.1440732706630907
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1126, Accuracy: 9610/9900 (97.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 45.85361707890393.
Norm before scaling: 45.8376652190573. Distance: 1.9540221938334095
Total norm for 4 adversaries is: 45.8376652190573. distance: 1.9540221938334095
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1594, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4608/5066 (90.9593%), train_poison_data_count: 400
Global model norm: 45.85361707890393.
Norm before scaling: 45.840575895569856. Distance: 2.095099171041558
Total norm for 4 adversaries is: 45.840575895569856. distance: 2.095099171041558
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2424, Accuracy: 9281/9900 (93.7475%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3720/4175 (89.1018%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3728/4175 (89.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9060, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4187/4596 (91.1010%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4258/4596 (92.6458%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9029, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3250/3616 (89.8783%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3349/3616 (92.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8244, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4209/4356 (96.6253%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4181/4356 (95.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8367, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4652/5244 (88.7109%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4791/5244 (91.3616%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9988, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2958/3297 (89.7179%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3074/3297 (93.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7943, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3297/3646 (90.4279%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3362/3646 (92.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7256, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3425/3797 (90.2028%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3501/3797 (92.2044%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9406, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4103/4456 (92.0781%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4152/4456 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8378, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3442/3828 (89.9164%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3544/3828 (92.5810%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7946, Accuracy: 5959/10000 (59.5900%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5081/5582 (91.0247%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5124/5582 (91.7951%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0438, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3166/3472 (91.1866%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3242/3472 (93.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8971, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3974/4362 (91.1050%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4060/4362 (93.0766%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8786, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4930/5424 (90.8923%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5010/5424 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0564, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4350/4679 (92.9686%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4291/4679 (91.7076%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9681, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3176/3590 (88.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1112, Accuracy: 5399/10000 (53.9900%)
time spent on training: 227.40260243415833
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.7717, Accuracy: 4775/10000 (47.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 7.9607, Accuracy: 336/9900 (3.3939%)
Done in 251.43275904655457 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4499/4885 (92.0983%), train_poison_data_count: 385
Global model norm: 45.87626658673851.
Norm before scaling: 45.86059144468429. Distance: 1.998149790868096
Total norm for 4 adversaries is: 45.86059144468429. distance: 1.998149790868096
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.2632, Accuracy: 9237/9900 (93.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4835/5305 (91.1404%), train_poison_data_count: 415
Global model norm: 45.87626658673851.
Norm before scaling: 45.86034656125867. Distance: 2.1157765772287385
Total norm for 4 adversaries is: 45.86034656125867. distance: 2.1157765772287385
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1449, Accuracy: 9522/9900 (96.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 45.87626658673851.
Norm before scaling: 45.86445350926058. Distance: 2.0286389515229137
Total norm for 4 adversaries is: 45.86445350926058. distance: 2.0286389515229137
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1242, Accuracy: 9567/9900 (96.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4583/5066 (90.4659%), train_poison_data_count: 400
Global model norm: 45.87626658673851.
Norm before scaling: 45.864104845524345. Distance: 2.1483388427277035
Total norm for 4 adversaries is: 45.864104845524345. distance: 2.1483388427277035
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0496, Accuracy: 9763/9900 (98.6162%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3389/3804 (89.0904%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3503/3804 (92.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0318, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2983/3297 (90.4762%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3063/3297 (92.9026%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7938, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4242/4354 (97.4277%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3853/4354 (88.4933%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2258, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3979/4433 (89.7586%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4117/4433 (92.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7922, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3435/3775 (90.9934%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3551/3775 (94.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8110, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4690/5195 (90.2791%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4808/5195 (92.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0517, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4940/5392 (91.6172%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4930/5392 (91.4318%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0473, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4694/5244 (89.5118%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4726/5244 (90.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0932, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4183/4356 (96.0285%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4023/4356 (92.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9285, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3888/4416 (88.0435%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3975/4416 (90.0136%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8997, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4095/4481 (91.3859%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4143/4481 (92.4570%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0477, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4028/4441 (90.7003%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4157/4441 (93.6050%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9363, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3922/4336 (90.4520%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4036/4336 (93.0812%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9682, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3273/3646 (89.7696%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3359/3646 (92.1284%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7798, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4236/4647 (91.1556%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4275/4647 (91.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8670, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3220/3638 (88.5102%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9395, Accuracy: 5714/10000 (57.1400%)
time spent on training: 229.81125235557556
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.7462, Accuracy: 4851/10000 (48.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 7.6803, Accuracy: 425/9900 (4.2929%)
Done in 253.90898394584656 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 45.906183521905575.
Norm before scaling: 45.89364935131276. Distance: 2.057287855185024
Total norm for 4 adversaries is: 45.89364935131276. distance: 2.057287855185024
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.4076, Accuracy: 8886/9900 (89.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4843/5305 (91.2912%), train_poison_data_count: 415
Global model norm: 45.906183521905575.
Norm before scaling: 45.889566296946796. Distance: 2.125856563491535
Total norm for 4 adversaries is: 45.889566296946796. distance: 2.125856563491535
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0932, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4339/4717 (91.9864%), train_poison_data_count: 370
Global model norm: 45.906183521905575.
Norm before scaling: 45.8902100338746. Distance: 1.9464270527984975
Total norm for 4 adversaries is: 45.8902100338746. distance: 1.9464270527984975
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.2031, Accuracy: 9436/9900 (95.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4595/5066 (90.7027%), train_poison_data_count: 400
Global model norm: 45.906183521905575.
Norm before scaling: 45.895548446309036. Distance: 2.171246334725088
Total norm for 4 adversaries is: 45.895548446309036. distance: 2.171246334725088
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0438, Accuracy: 9775/9900 (98.7374%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4118/4538 (90.7448%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4219/4538 (92.9705%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8343, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5136/5740 (89.4774%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5241/5740 (91.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1088, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4540/4934 (92.0146%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4470/4934 (90.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0056, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3660/4013 (91.2036%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3759/4013 (93.6706%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7530, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4020/4511 (89.1155%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4156/4511 (92.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8870, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4011/4501 (89.1135%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4083/4501 (90.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0290, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4113/4518 (91.0359%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4147/4518 (91.7884%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9289, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3428/3804 (90.1157%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3539/3804 (93.0336%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8766, Accuracy: 5804/10000 (58.0400%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3526/3781 (93.2558%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3388/3781 (89.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1035, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4054/4441 (91.2857%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4094/4441 (92.1864%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0005, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4176/4662 (89.5753%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4288/4662 (91.9777%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9305, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3110/3472 (89.5737%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9902, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3664/3911 (93.6845%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3661/3911 (93.6078%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9448, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4143/4634 (89.4044%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4245/4634 (91.6055%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0092, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4198/4618 (90.9052%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4187/4618 (90.6670%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0899, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4727/5195 (90.9913%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4667/5195 (89.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0221, Accuracy: 5512/10000 (55.1200%)
time spent on training: 230.16757559776306
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.8738, Accuracy: 4684/10000 (46.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 7.5789, Accuracy: 450/9900 (4.5455%)
Done in 254.13223457336426 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4462/4885 (91.3408%), train_poison_data_count: 385
Global model norm: 45.92945560942482.
Norm before scaling: 45.91641469748999. Distance: 2.0688465614487015
Total norm for 4 adversaries is: 45.91641469748999. distance: 2.0688465614487015
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2500, Accuracy: 9265/9900 (93.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 45.92945560942482.
Norm before scaling: 45.91529278277691. Distance: 2.1451966412092776
Total norm for 4 adversaries is: 45.91529278277691. distance: 2.1451966412092776
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1551, Accuracy: 9526/9900 (96.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 45.92945560942482.
Norm before scaling: 45.91623923396411. Distance: 1.991364372594294
Total norm for 4 adversaries is: 45.91623923396411. distance: 1.991364372594294
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1386, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 45.92945560942482.
Norm before scaling: 45.91376672207776. Distance: 2.0786355904333407
Total norm for 4 adversaries is: 45.91376672207776. distance: 2.0786355904333407
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0493, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2956/3271 (90.3699%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2942/3271 (89.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9975, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4426/4928 (89.8133%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4493/4928 (91.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9349, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4545/4804 (94.6087%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4134/4804 (86.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4197, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4170/4618 (90.2988%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4203/4618 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9515, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3428/3756 (91.2673%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3569/3756 (95.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8579, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4176/4634 (90.1165%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4214/4634 (90.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9678, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3240/3638 (89.0599%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3341/3638 (91.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7496, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3275/3704 (88.4179%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3379/3704 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8816, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4194/4707 (89.1013%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4302/4707 (91.3958%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9294, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4112/4481 (91.7652%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4077/4481 (90.9842%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0111, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4250/4354 (97.6114%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4215/4354 (96.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9339, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3248/3646 (89.0839%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3362/3646 (92.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8103, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3805/4223 (90.1018%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3916/4223 (92.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8345, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4041/4511 (89.5810%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4139/4511 (91.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9483, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4056/4456 (91.0233%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4141/4456 (92.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0575, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3465/3861 (89.7436%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3525/3861 (91.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9360, Accuracy: 5620/10000 (56.2000%)
time spent on training: 225.56505417823792
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.8881, Accuracy: 4692/10000 (46.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 7.9863, Accuracy: 335/9900 (3.3838%)
Done in 249.4980607032776 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4493/4885 (91.9754%), train_poison_data_count: 385
Global model norm: 45.962604747297014.
Norm before scaling: 45.950051431554456. Distance: 2.040860256870551
Total norm for 4 adversaries is: 45.950051431554456. distance: 2.040860256870551
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2719, Accuracy: 9257/9900 (93.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 45.962604747297014.
Norm before scaling: 45.94714769013823. Distance: 2.157904943520399
Total norm for 4 adversaries is: 45.94714769013823. distance: 2.157904943520399
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1168, Accuracy: 9605/9900 (97.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4261/4717 (90.3328%), train_poison_data_count: 370
Global model norm: 45.962604747297014.
Norm before scaling: 45.94653397564391. Distance: 2.012315739317414
Total norm for 4 adversaries is: 45.94653397564391. distance: 2.012315739317414
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2225, Accuracy: 9346/9900 (94.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 45.962604747297014.
Norm before scaling: 45.952891235379575. Distance: 2.1735821059474993
Total norm for 4 adversaries is: 45.952891235379575. distance: 2.1735821059474993
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0848, Accuracy: 9685/9900 (97.8283%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3409/3804 (89.6162%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3515/3804 (92.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9387, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4024/4501 (89.4024%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4064/4501 (90.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0027, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4237/4663 (90.8643%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4311/4663 (92.4512%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9704, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5064/5591 (90.5741%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5056/5591 (90.4310%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0490, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4679/5244 (89.2258%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4756/5244 (90.6941%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8574, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3991/4433 (90.0293%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4099/4433 (92.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8571, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4220/4707 (89.6537%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4292/4707 (91.1833%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8700, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4064/4456 (91.2029%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4134/4456 (92.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7630, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4165/4356 (95.6152%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4058/4356 (93.1589%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8609, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4138/4576 (90.4283%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4246/4576 (92.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9528, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4341/4679 (92.7762%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4185/4679 (89.4422%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1599, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4189/4634 (90.3971%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4220/4634 (91.0660%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7856, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3629/4013 (90.4311%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3747/4013 (93.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8115, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4623/5232 (88.3601%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4729/5232 (90.3861%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9785, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3731/4126 (90.4266%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3873/4126 (93.8682%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8030, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3416/3756 (90.9478%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3511/3756 (93.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9226, Accuracy: 5703/10000 (57.0300%)
time spent on training: 231.2972092628479
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 3.0779, Accuracy: 4574/10000 (45.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 7.8772, Accuracy: 408/9900 (4.1212%)
Done in 255.182448387146 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 45.9913587331903.
Norm before scaling: 45.977451271146215. Distance: 2.032291438814584
Total norm for 4 adversaries is: 45.977451271146215. distance: 2.032291438814584
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1048, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4845/5305 (91.3289%), train_poison_data_count: 415
Global model norm: 45.9913587331903.
Norm before scaling: 45.97929115203659. Distance: 2.1768433531378277
Total norm for 4 adversaries is: 45.97929115203659. distance: 2.1768433531378277
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1087, Accuracy: 9634/9900 (97.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4333/4717 (91.8592%), train_poison_data_count: 370
Global model norm: 45.9913587331903.
Norm before scaling: 45.97397308447329. Distance: 1.9375919812426343
Total norm for 4 adversaries is: 45.97397308447329. distance: 1.9375919812426343
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1951, Accuracy: 9429/9900 (95.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4588/5066 (90.5645%), train_poison_data_count: 400
Global model norm: 45.9913587331903.
Norm before scaling: 45.97920885013546. Distance: 2.1481802491582345
Total norm for 4 adversaries is: 45.97920885013546. distance: 2.1481802491582345
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0896, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4624/5055 (91.4738%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4629/5055 (91.5727%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8091, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4122/4481 (91.9884%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4124/4481 (92.0330%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0524, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4272/4767 (89.6161%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4304/4767 (90.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0748, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4756/5265 (90.3324%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4758/5265 (90.3704%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0539, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4056/4558 (88.9864%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4087/4558 (89.6665%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1030, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5091/5591 (91.0571%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5138/5591 (91.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0499, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4688/5232 (89.6024%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4777/5232 (91.3035%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0313, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3506/3756 (93.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9000, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4015/4433 (90.5707%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4060/4433 (91.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9436, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4275/4793 (89.1926%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4411/4793 (92.0300%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9658, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3844/4235 (90.7674%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3890/4235 (91.8536%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9551, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4198/4707 (89.1863%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4337/4707 (92.1394%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8594, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3658/4025 (90.8820%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3758/4025 (93.3665%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8643, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3440/3837 (89.6534%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3588/3837 (93.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9271, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5721/6391 (89.5165%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5762/6391 (90.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0539, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4247/4354 (97.5425%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3874/4354 (88.9757%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3431, Accuracy: 5147/10000 (51.4700%)
time spent on training: 235.04633378982544
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.8938, Accuracy: 4780/10000 (47.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 8.1872, Accuracy: 386/9900 (3.8990%)
Done in 258.9631404876709 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 46.02132551702254.
Norm before scaling: 46.00748548555034. Distance: 2.077872583648226
Total norm for 4 adversaries is: 46.00748548555034. distance: 2.077872583648226
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1131, Accuracy: 9613/9900 (97.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4835/5305 (91.1404%), train_poison_data_count: 415
Global model norm: 46.02132551702254.
Norm before scaling: 46.00477906984909. Distance: 2.119212515881662
Total norm for 4 adversaries is: 46.00477906984909. distance: 2.119212515881662
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1195, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4296/4717 (91.0748%), train_poison_data_count: 370
Global model norm: 46.02132551702254.
Norm before scaling: 46.00432533163322. Distance: 1.9834469404727662
Total norm for 4 adversaries is: 46.00432533163322. distance: 1.9834469404727662
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1068, Accuracy: 9636/9900 (97.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 46.02132551702254.
Norm before scaling: 46.00791266014738. Distance: 2.1509025719647257
Total norm for 4 adversaries is: 46.00791266014738. distance: 2.1509025719647257
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0775, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4937/5424 (91.0214%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5027/5424 (92.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0250, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4123/4576 (90.1005%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4269/4576 (93.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9245, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4497/4934 (91.1431%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4343/4934 (88.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1681, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5045/5582 (90.3798%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5037/5582 (90.2365%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2030, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4423/4956 (89.2454%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4497/4956 (90.7385%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0046, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5345/5902 (90.5625%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5349/5902 (90.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0411, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2964/3297 (89.8999%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3101/3297 (94.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7451, Accuracy: 6000/10000 (60.0000%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3141/3472 (90.4666%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9681, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4431/4928 (89.9148%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4529/4928 (91.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9641, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4143/4481 (92.4570%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4107/4481 (91.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0303, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4545/5025 (90.4478%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4639/5025 (92.3184%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9708, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4457/4986 (89.3903%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4590/4986 (92.0578%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9087, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4385/4928 (88.9813%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4508/4928 (91.4773%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9123, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4604/4804 (95.8368%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4394/4804 (91.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1070, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3287/3646 (90.1536%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3395/3646 (93.1157%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7581, Accuracy: 5959/10000 (59.5900%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4212/4707 (89.4837%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4307/4707 (91.5020%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8500, Accuracy: 5821/10000 (58.2100%)
time spent on training: 235.4865379333496
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 3.0475, Accuracy: 4590/10000 (45.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 7.9864, Accuracy: 371/9900 (3.7475%)
Done in 259.4587519168854 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4489/4885 (91.8936%), train_poison_data_count: 385
Global model norm: 46.04884730251806.
Norm before scaling: 46.03644478070472. Distance: 2.0528058040542794
Total norm for 4 adversaries is: 46.03644478070472. distance: 2.0528058040542794
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1348, Accuracy: 9585/9900 (96.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4793/5305 (90.3487%), train_poison_data_count: 415
Global model norm: 46.04884730251806.
Norm before scaling: 46.0340476704132. Distance: 2.2083614155645246
Total norm for 4 adversaries is: 46.0340476704132. distance: 2.2083614155645246
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1906, Accuracy: 9433/9900 (95.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 46.04884730251806.
Norm before scaling: 46.03047563842894. Distance: 1.968475867668285
Total norm for 4 adversaries is: 46.03047563842894. distance: 1.968475867668285
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0960, Accuracy: 9666/9900 (97.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4589/5066 (90.5843%), train_poison_data_count: 400
Global model norm: 46.04884730251806.
Norm before scaling: 46.038160335000896. Distance: 2.1765022658361044
Total norm for 4 adversaries is: 46.038160335000896. distance: 2.1765022658361044
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1843, Accuracy: 9448/9900 (95.4343%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4527/5116 (88.4871%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4652/5116 (90.9304%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0076, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4160/4651 (89.4431%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4192/4651 (90.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1300, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5014/5591 (89.6798%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5002/5591 (89.4652%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3662, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4645/4804 (96.6903%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4548/4804 (94.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9049, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4067/4456 (91.2702%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9599, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4656/5063 (91.9613%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4468/5063 (88.2481%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1707, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3767/4223 (89.2020%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3953/4223 (93.6064%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8180, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4529/4934 (91.7916%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4396/4934 (89.0961%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1062, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3440/3828 (89.8642%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0524, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5368/5902 (90.9522%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5265/5902 (89.2070%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0000, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3897/4416 (88.2473%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9965, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4125/4538 (90.8991%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4244/4538 (93.5214%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8580, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4445/5025 (88.4577%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4637/5025 (92.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9050, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4100/4625 (88.6486%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4201/4625 (90.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0653, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4668/5197 (89.8211%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4726/5197 (90.9371%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0315, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3395/3804 (89.2482%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3484/3804 (91.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9736, Accuracy: 5686/10000 (56.8600%)
time spent on training: 235.45200085639954
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 3.1802, Accuracy: 4445/10000 (44.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 8.1388, Accuracy: 322/9900 (3.2525%)
Done in 259.4857032299042 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 46.08059399115994.
Norm before scaling: 46.06789529121664. Distance: 2.081997697570583
Total norm for 4 adversaries is: 46.06789529121664. distance: 2.081997697570583
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1196, Accuracy: 9613/9900 (97.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 46.08059399115994.
Norm before scaling: 46.06251060040584. Distance: 2.1490585261878543
Total norm for 4 adversaries is: 46.06251060040584. distance: 2.1490585261878543
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1959, Accuracy: 9460/9900 (95.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4303/4717 (91.2232%), train_poison_data_count: 370
Global model norm: 46.08059399115994.
Norm before scaling: 46.06452463325221. Distance: 1.9925176608692161
Total norm for 4 adversaries is: 46.06452463325221. distance: 1.9925176608692161
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1463, Accuracy: 9550/9900 (96.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4574/5066 (90.2882%), train_poison_data_count: 400
Global model norm: 46.08059399115994.
Norm before scaling: 46.067919139333014. Distance: 2.2184926273274166
Total norm for 4 adversaries is: 46.067919139333014. distance: 2.2184926273274166
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0556, Accuracy: 9757/9900 (98.5556%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4615/4804 (96.0658%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4477/4804 (93.1932%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9454, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3622/3911 (92.6106%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3719/3911 (95.0908%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8530, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3604/4013 (89.8081%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3724/4013 (92.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8866, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4671/5232 (89.2775%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4756/5232 (90.9021%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9618, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5030/5591 (89.9660%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4991/5591 (89.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9431, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3428/3837 (89.3406%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3551/3837 (92.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8520, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4901/5424 (90.3577%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5000/5424 (92.1829%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0464, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4627/5167 (89.5491%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4775/5167 (92.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1329, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4066/4456 (91.2478%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0072, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4540/4928 (92.1266%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9640, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3971/4433 (89.5782%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3948/4433 (89.0593%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8995, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2915/3297 (88.4137%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3054/3297 (92.6297%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7357, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4197/4716 (88.9949%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4264/4716 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9343, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4136/4596 (89.9913%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4243/4596 (92.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9926, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4284/4793 (89.3803%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4390/4793 (91.5919%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9269, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3872/4416 (87.6812%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4025/4416 (91.1458%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8879, Accuracy: 5634/10000 (56.3400%)
time spent on training: 233.01342129707336
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 3.1579, Accuracy: 4456/10000 (44.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 8.0114, Accuracy: 350/9900 (3.5354%)
Done in 256.922278881073 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 46.11185555425253.
Norm before scaling: 46.095246268087394. Distance: 2.0367159733316202
Total norm for 4 adversaries is: 46.095246268087394. distance: 2.0367159733316202
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1723, Accuracy: 9460/9900 (95.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 46.11185555425253.
Norm before scaling: 46.09946468812029. Distance: 2.217983919517075
Total norm for 4 adversaries is: 46.09946468812029. distance: 2.217983919517075
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1100, Accuracy: 9614/9900 (97.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 46.11185555425253.
Norm before scaling: 46.095161524997664. Distance: 1.9786252803861335
Total norm for 4 adversaries is: 46.095161524997664. distance: 1.9786252803861335
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0736, Accuracy: 9706/9900 (98.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 46.11185555425253.
Norm before scaling: 46.09858290341608. Distance: 2.168571429637648
Total norm for 4 adversaries is: 46.09858290341608. distance: 2.168571429637648
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0903, Accuracy: 9689/9900 (97.8687%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2924/3271 (89.3916%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 2994/3271 (91.5316%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9603, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4586/5116 (89.6403%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4620/5116 (90.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0037, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4015/4501 (89.2024%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4121/4501 (91.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9542, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4148/4356 (95.2250%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4095/4356 (94.0083%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9531, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3852/4368 (88.1868%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3903/4368 (89.3544%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9768, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3437/3837 (89.5752%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3552/3837 (92.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8424, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5133/5740 (89.4251%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5251/5740 (91.4808%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1419, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3293/3590 (91.7270%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3403/3590 (94.7911%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7917, Accuracy: 5956/10000 (59.5600%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2974/3297 (90.2032%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3057/3297 (92.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7393, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4146/4716 (87.9135%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4303/4716 (91.2426%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9287, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4544/5055 (89.8912%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4606/5055 (91.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0984, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3595/3911 (91.9202%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3539/3911 (90.4884%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1209, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3622/4158 (87.1092%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3789/4158 (91.1255%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9065, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4072/4456 (91.3824%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4152/4456 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9489, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4002/4511 (88.7165%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4127/4511 (91.4875%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9405, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3262/3672 (88.8344%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3350/3672 (91.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9798, Accuracy: 5610/10000 (56.1000%)
time spent on training: 227.06489968299866
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 3.0942, Accuracy: 4494/10000 (44.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 8.0632, Accuracy: 388/9900 (3.9192%)
Done in 250.9165542125702 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4459/4885 (91.2794%), train_poison_data_count: 385
Global model norm: 46.13586000200928.
Norm before scaling: 46.12274776428791. Distance: 2.0770074808190793
Total norm for 4 adversaries is: 46.12274776428791. distance: 2.0770074808190793
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1288, Accuracy: 9584/9900 (96.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4841/5305 (91.2535%), train_poison_data_count: 415
Global model norm: 46.13586000200928.
Norm before scaling: 46.118796161380885. Distance: 2.126035438041279
Total norm for 4 adversaries is: 46.118796161380885. distance: 2.126035438041279
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1720, Accuracy: 9503/9900 (95.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4332/4717 (91.8380%), train_poison_data_count: 370
Global model norm: 46.13586000200928.
Norm before scaling: 46.11636097959161. Distance: 1.9519544221645868
Total norm for 4 adversaries is: 46.11636097959161. distance: 1.9519544221645868
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1169, Accuracy: 9617/9900 (97.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4573/5066 (90.2685%), train_poison_data_count: 400
Global model norm: 46.13586000200928.
Norm before scaling: 46.12433836754463. Distance: 2.22435289466809
Total norm for 4 adversaries is: 46.12433836754463. distance: 2.22435289466809
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0628, Accuracy: 9748/9900 (98.4646%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4710/5063 (93.0278%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4470/5063 (88.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0629, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4594/5083 (90.3797%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4583/5083 (90.1633%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0531, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3409/3797 (89.7814%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3445/3797 (90.7295%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0022, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5409/6124 (88.3246%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5504/6124 (89.8759%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9099, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4665/5232 (89.1628%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4781/5232 (91.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9465, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3426/3861 (88.7335%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3556/3861 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9194, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4493/5037 (89.1999%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4626/5037 (91.8404%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9961, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4526/5116 (88.4676%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4672/5116 (91.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9338, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3901/4368 (89.3086%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3957/4368 (90.5907%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0338, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3280/3672 (89.3246%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3388/3672 (92.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0256, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5369/5902 (90.9692%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5279/5902 (89.4443%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0949, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3983/4361 (91.3323%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3909/4361 (89.6354%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9835, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3600/4158 (86.5801%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3748/4158 (90.1395%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9610, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4524/5025 (90.0299%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4652/5025 (92.5771%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1491, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4075/4456 (91.4497%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4147/4456 (93.0655%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9564, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3995/4433 (90.1196%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4042/4433 (91.1798%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.7992, Accuracy: 5916/10000 (59.1600%)
time spent on training: 234.50068831443787
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.9869, Accuracy: 4618/10000 (46.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 8.0231, Accuracy: 381/9900 (3.8485%)
Done in 258.21663451194763 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 46.16717668566056.
Norm before scaling: 46.1557236979134. Distance: 2.0662150592007404
Total norm for 4 adversaries is: 46.1557236979134. distance: 2.0662150592007404
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0755, Accuracy: 9718/9900 (98.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4834/5305 (91.1216%), train_poison_data_count: 415
Global model norm: 46.16717668566056.
Norm before scaling: 46.150582019115696. Distance: 2.139108719476178
Total norm for 4 adversaries is: 46.150582019115696. distance: 2.139108719476178
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1292, Accuracy: 9564/9900 (96.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4320/4717 (91.5836%), train_poison_data_count: 370
Global model norm: 46.16717668566056.
Norm before scaling: 46.14823580559445. Distance: 1.950427519565641
Total norm for 4 adversaries is: 46.14823580559445. distance: 1.950427519565641
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1392, Accuracy: 9584/9900 (96.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4586/5066 (90.5251%), train_poison_data_count: 400
Global model norm: 46.16717668566056.
Norm before scaling: 46.15317673417779. Distance: 2.142165360729358
Total norm for 4 adversaries is: 46.15317673417779. distance: 2.142165360729358
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0522, Accuracy: 9786/9900 (98.8485%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3622/4025 (89.9876%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3749/4025 (93.1429%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8772, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4466/4928 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2110, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3714/4175 (88.9581%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3811/4175 (91.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8262, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3934/4416 (89.0851%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4029/4416 (91.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0326, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3405/3797 (89.6761%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3486/3797 (91.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8480, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4708/5195 (90.6256%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4756/5195 (91.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8954, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4702/5232 (89.8700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4787/5232 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0006, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5021/5455 (92.0440%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5073/5455 (92.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9070, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4184/4716 (88.7193%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4241/4716 (89.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0967, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4379/4679 (93.5884%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4401/4679 (94.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8773, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5726/6263 (91.4258%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5757/6263 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1328, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4419/4918 (89.8536%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4553/4918 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9178, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4055/4456 (91.0009%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4166/4456 (93.4919%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8402, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5365/5902 (90.9014%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5423/5902 (91.8841%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9415, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4084/4481 (91.1404%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4095/4481 (91.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1390, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5180/5591 (92.6489%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5177/5591 (92.5952%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9632, Accuracy: 5680/10000 (56.8000%)
time spent on training: 238.4707794189453
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.9720, Accuracy: 4643/10000 (46.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 8.4072, Accuracy: 291/9900 (2.9394%)
Done in 262.29962706565857 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4493/4885 (91.9754%), train_poison_data_count: 385
Global model norm: 46.19332200704854.
Norm before scaling: 46.176260895751405. Distance: 2.022461055385378
Total norm for 4 adversaries is: 46.176260895751405. distance: 2.022461055385378
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0783, Accuracy: 9707/9900 (98.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4822/5305 (90.8954%), train_poison_data_count: 415
Global model norm: 46.19332200704854.
Norm before scaling: 46.17373092716653. Distance: 2.16625490922146
Total norm for 4 adversaries is: 46.17373092716653. distance: 2.16625490922146
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1589, Accuracy: 9511/9900 (96.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 46.19332200704854.
Norm before scaling: 46.17495230861776. Distance: 1.9291172188778842
Total norm for 4 adversaries is: 46.17495230861776. distance: 1.9291172188778842
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1341, Accuracy: 9582/9900 (96.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4617/5066 (91.1370%), train_poison_data_count: 400
Global model norm: 46.19332200704854.
Norm before scaling: 46.179364346061. Distance: 2.1133333718012057
Total norm for 4 adversaries is: 46.179364346061. distance: 2.1133333718012057
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0764, Accuracy: 9726/9900 (98.2424%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4009/4501 (89.0691%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4112/4501 (91.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8346, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4545/5083 (89.4157%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4637/5083 (91.2257%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0928, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3414/3804 (89.7476%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3490/3804 (91.7455%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9651, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3457/3756 (92.0394%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3538/3756 (94.1960%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8831, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3729/4175 (89.3174%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3717/4175 (89.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8742, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4603/4934 (93.2914%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4431/4934 (89.8054%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3245, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3953/4336 (91.1670%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4011/4336 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9976, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4097/4356 (94.0542%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4170/4356 (95.7300%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8574, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4631/5244 (88.3105%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4720/5244 (90.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0005, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4564/5017 (90.9707%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4607/5017 (91.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9250, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3453/3828 (90.2038%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3564/3828 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8763, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4148/4538 (91.4059%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4229/4538 (93.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0328, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3201/3638 (87.9879%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3327/3638 (91.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0333, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4250/4662 (91.1626%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4306/4662 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9590, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3410/3797 (89.8077%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3483/3797 (91.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1232, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4186/4634 (90.3323%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4244/4634 (91.5839%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9020, Accuracy: 5767/10000 (57.6700%)
time spent on training: 228.05732798576355
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 3.0217, Accuracy: 4565/10000 (45.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 8.5551, Accuracy: 293/9900 (2.9596%)
Done in 252.41895127296448 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 46.22428550353699.
Norm before scaling: 46.20872313481514. Distance: 2.068931378022614
Total norm for 4 adversaries is: 46.20872313481514. distance: 2.068931378022614
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0753, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 46.22428550353699.
Norm before scaling: 46.20833480096556. Distance: 2.174841083552657
Total norm for 4 adversaries is: 46.20833480096556. distance: 2.174841083552657
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1730, Accuracy: 9515/9900 (96.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 46.22428550353699.
Norm before scaling: 46.20555560904581. Distance: 1.9452353466008068
Total norm for 4 adversaries is: 46.20555560904581. distance: 1.9452353466008068
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.2374, Accuracy: 9314/9900 (94.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4627/5066 (91.3344%), train_poison_data_count: 400
Global model norm: 46.22428550353699.
Norm before scaling: 46.20610776219146. Distance: 2.113447877304815
Total norm for 4 adversaries is: 46.20610776219146. distance: 2.113447877304815
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0419, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3741/4175 (89.6048%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3740/4175 (89.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9302, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4029/4465 (90.2352%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4176/4465 (93.5274%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8810, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4480/4918 (91.0939%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4526/4918 (92.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9543, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4610/5037 (91.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8971, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3514/3781 (92.9384%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3418/3781 (90.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9812, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4205/4634 (90.7423%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4270/4634 (92.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8386, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4120/4576 (90.0350%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4226/4576 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9826, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3455/3861 (89.4846%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3492/3861 (90.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9702, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5501/6124 (89.8269%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5517/6124 (90.0882%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9250, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3811/4223 (90.2439%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9563, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4590/5083 (90.3010%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4619/5083 (90.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9783, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3793/4356 (87.0753%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4335, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4280/4793 (89.2969%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4425/4793 (92.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0275, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4553/5055 (90.0692%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4633/5055 (91.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9595, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3974/4362 (91.1050%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3949/4362 (90.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1764, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3997/4433 (90.1647%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4060/4433 (91.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9029, Accuracy: 5778/10000 (57.7800%)
time spent on training: 233.4083993434906
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 3.2158, Accuracy: 4449/10000 (44.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 8.2879, Accuracy: 339/9900 (3.4242%)
Done in 257.47127771377563 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4490/4885 (91.9140%), train_poison_data_count: 385
Global model norm: 46.252000590177175.
Norm before scaling: 46.233398097148076. Distance: 1.9840030471755286
Total norm for 4 adversaries is: 46.233398097148076. distance: 1.9840030471755286
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1545, Accuracy: 9523/9900 (96.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 46.252000590177175.
Norm before scaling: 46.23469974961987. Distance: 2.2046007124420623
Total norm for 4 adversaries is: 46.23469974961987. distance: 2.2046007124420623
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1260, Accuracy: 9595/9900 (96.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4314/4717 (91.4564%), train_poison_data_count: 370
Global model norm: 46.252000590177175.
Norm before scaling: 46.23614393371678. Distance: 2.005921181800934
Total norm for 4 adversaries is: 46.23614393371678. distance: 2.005921181800934
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2200, Accuracy: 9349/9900 (94.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 46.252000590177175.
Norm before scaling: 46.23740326767389. Distance: 2.1625790796539293
Total norm for 4 adversaries is: 46.23740326767389. distance: 2.1625790796539293
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0855, Accuracy: 9687/9900 (97.8485%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4559/5025 (90.7264%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4666/5025 (92.8557%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0950, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4021/4441 (90.5427%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4130/4441 (92.9971%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9610, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5159/5591 (92.2733%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5117/5591 (91.5221%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0787, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4182/4481 (93.3274%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4144/4481 (92.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0216, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4217/4767 (88.4623%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4356/4767 (91.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0142, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4557/5055 (90.1484%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4629/5055 (91.5727%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9191, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4105/4518 (90.8588%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4262/4518 (94.3338%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9054, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4121/4625 (89.1027%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4178/4625 (90.3351%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2920, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4275/4793 (89.1926%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4400/4793 (91.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9683, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4579/5083 (90.0846%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4611/5083 (90.7141%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0435, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4635/5244 (88.3867%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4717/5244 (89.9504%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0243, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5710/6263 (91.1704%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5722/6263 (91.3620%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9723, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3743/4175 (89.6527%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3835/4175 (91.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9318, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3880/4416 (87.8623%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4088/4416 (92.5725%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9125, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4753/5265 (90.2754%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4800/5265 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9226, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3642/4025 (90.4845%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8680, Accuracy: 5773/10000 (57.7300%)
time spent on training: 236.69230890274048
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 3.1312, Accuracy: 4505/10000 (45.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 8.4127, Accuracy: 324/9900 (3.2727%)
Done in 260.486567735672 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4508/4885 (92.2825%), train_poison_data_count: 385
Global model norm: 46.2803083758025.
Norm before scaling: 46.26206821012356. Distance: 2.0191974769893912
Total norm for 4 adversaries is: 46.26206821012356. distance: 2.0191974769893912
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0870, Accuracy: 9700/9900 (97.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 46.2803083758025.
Norm before scaling: 46.26316060643582. Distance: 2.2118305249470733
Total norm for 4 adversaries is: 46.26316060643582. distance: 2.2118305249470733
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1009, Accuracy: 9668/9900 (97.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 46.2803083758025.
Norm before scaling: 46.26130562832722. Distance: 2.008718798145219
Total norm for 4 adversaries is: 46.26130562832722. distance: 2.008718798145219
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0356, Accuracy: 9796/9900 (98.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4586/5066 (90.5251%), train_poison_data_count: 400
Global model norm: 46.2803083758025.
Norm before scaling: 46.26965640152977. Distance: 2.206596075044846
Total norm for 4 adversaries is: 46.26965640152977. distance: 2.206596075044846
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1561, Accuracy: 9501/9900 (95.9697%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3844/4295 (89.4994%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3838/4295 (89.3597%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9740, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3810/4223 (90.2202%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3926/4223 (92.9671%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8812, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4283/4793 (89.3595%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4349/4793 (90.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9539, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4207/4707 (89.3775%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4353/4707 (92.4793%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8754, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4991/5455 (91.4940%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4968/5455 (91.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0476, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4156/4651 (89.3571%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4289/4651 (92.2167%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0496, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3426/3837 (89.2885%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3568/3837 (92.9893%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9874, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4082/4441 (91.9162%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4135/4441 (93.1097%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8890, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3273/3638 (89.9670%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8743, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3837/4235 (90.6021%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3900/4235 (92.0897%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9203, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3975/4362 (91.1279%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4036/4362 (92.5264%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9233, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3458/3797 (91.0719%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3514/3797 (92.5467%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0715, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3643/4158 (87.6142%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3740/4158 (89.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8653, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3730/4126 (90.4023%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3821/4126 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8268, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4707/5195 (90.6064%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4646/5195 (89.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1507, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3664/4046 (90.5586%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3743/4046 (92.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9195, Accuracy: 5636/10000 (56.3600%)
time spent on training: 230.17607259750366
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 3.1887, Accuracy: 4387/10000 (43.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 8.6749, Accuracy: 257/9900 (2.5960%)
Done in 254.0286512374878 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 46.31068390079523.
Norm before scaling: 46.29320986167275. Distance: 2.022153822763308
Total norm for 4 adversaries is: 46.29320986167275. distance: 2.022153822763308
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0984, Accuracy: 9650/9900 (97.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4847/5305 (91.3666%), train_poison_data_count: 415
Global model norm: 46.31068390079523.
Norm before scaling: 46.29072320333201. Distance: 2.1143564813509363
Total norm for 4 adversaries is: 46.29072320333201. distance: 2.1143564813509363
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1639, Accuracy: 9468/9900 (95.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 46.31068390079523.
Norm before scaling: 46.29260073502568. Distance: 2.0278772376183993
Total norm for 4 adversaries is: 46.29260073502568. distance: 2.0278772376183993
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1290, Accuracy: 9584/9900 (96.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4602/5066 (90.8409%), train_poison_data_count: 400
Global model norm: 46.31068390079523.
Norm before scaling: 46.294462369637145. Distance: 2.1335569766160547
Total norm for 4 adversaries is: 46.294462369637145. distance: 2.1335569766160547
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.2563, Accuracy: 9277/9900 (93.7071%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3974/4361 (91.1259%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3930/4361 (90.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8769, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2976/3297 (90.2639%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3106/3297 (94.2069%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7930, Accuracy: 5947/10000 (59.4700%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4186/4716 (88.7617%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4265/4716 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9824, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4653/5167 (90.0523%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4820/5167 (93.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0158, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3924/4368 (89.8352%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3942/4368 (90.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9420, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4359/4679 (93.1609%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4324/4679 (92.4129%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0110, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4163/4356 (95.5693%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4059/4356 (93.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2415, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5337/5902 (90.4270%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5334/5902 (90.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0537, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3510/3861 (90.9091%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3535/3861 (91.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8359, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4159/4356 (95.4775%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4067/4356 (93.3655%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8581, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5710/6263 (91.1704%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5769/6263 (92.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1764, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3867/4235 (91.3105%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3894/4235 (91.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9783, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4667/5232 (89.2011%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4776/5232 (91.2844%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0478, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4561/5017 (90.9109%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4646/5017 (92.6051%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8130, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4608/4804 (95.9201%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4586/4804 (95.4621%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8382, Accuracy: 5954/10000 (59.5400%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4278/4793 (89.2552%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4426/4793 (92.3430%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0087, Accuracy: 5635/10000 (56.3500%)
time spent on training: 234.34183192253113
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 3.1967, Accuracy: 4413/10000 (44.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 8.7171, Accuracy: 248/9900 (2.5051%)
Done in 258.11538219451904 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 46.345638553057235.
Norm before scaling: 46.32945824388491. Distance: 2.045191298027185
Total norm for 4 adversaries is: 46.32945824388491. distance: 2.045191298027185
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0749, Accuracy: 9709/9900 (98.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4808/5305 (90.6315%), train_poison_data_count: 415
Global model norm: 46.345638553057235.
Norm before scaling: 46.32944243489366. Distance: 2.1623344269799674
Total norm for 4 adversaries is: 46.32944243489366. distance: 2.1623344269799674
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1083, Accuracy: 9658/9900 (97.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4323/4717 (91.6472%), train_poison_data_count: 370
Global model norm: 46.345638553057235.
Norm before scaling: 46.32686022725504. Distance: 1.9315539765860368
Total norm for 4 adversaries is: 46.32686022725504. distance: 1.9315539765860368
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1388, Accuracy: 9559/9900 (96.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4604/5066 (90.8804%), train_poison_data_count: 400
Global model norm: 46.345638553057235.
Norm before scaling: 46.32886540302115. Distance: 2.0969213125285076
Total norm for 4 adversaries is: 46.32886540302115. distance: 2.0969213125285076
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1581, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3458/3837 (90.1225%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3560/3837 (92.7808%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8718, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3479/3861 (90.1062%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3523/3861 (91.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8956, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3729/4175 (89.3174%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3714/4175 (88.9581%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9182, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4084/4441 (91.9613%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4125/4441 (92.8845%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0383, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3963/4336 (91.3976%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4041/4336 (93.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9667, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3658/4046 (90.4103%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3761/4046 (92.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9438, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4472/4956 (90.2341%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4462/4956 (90.0323%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0835, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4253/4618 (92.0961%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4263/4618 (92.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0103, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3244/3616 (89.7124%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3340/3616 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8003, Accuracy: 5992/10000 (59.9200%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4151/4576 (90.7124%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4221/4576 (92.2421%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8741, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3851/4223 (91.1911%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3921/4223 (92.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8688, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4079/4503 (90.5841%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4159/4503 (92.3606%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9164, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3317/3590 (92.3955%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3347/3590 (93.2312%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9232, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4255/4707 (90.3973%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4332/4707 (92.0331%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9504, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3682/4013 (91.7518%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3766/4013 (93.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8422, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3300/3704 (89.0929%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3374/3704 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9971, Accuracy: 5653/10000 (56.5300%)
time spent on training: 225.02200746536255
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 3.1765, Accuracy: 4400/10000 (44.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 9.1233, Accuracy: 212/9900 (2.1414%)
Done in 248.943706035614 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4496/4885 (92.0368%), train_poison_data_count: 385
Global model norm: 46.37159638369025.
Norm before scaling: 46.35245461491899. Distance: 1.9871208237081424
Total norm for 4 adversaries is: 46.35245461491899. distance: 1.9871208237081424
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0837, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4848/5305 (91.3855%), train_poison_data_count: 415
Global model norm: 46.37159638369025.
Norm before scaling: 46.3526573958414. Distance: 2.128220193893261
Total norm for 4 adversaries is: 46.3526573958414. distance: 2.128220193893261
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1059, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4348/4717 (92.1772%), train_poison_data_count: 370
Global model norm: 46.37159638369025.
Norm before scaling: 46.35122210919174. Distance: 1.9462993523937724
Total norm for 4 adversaries is: 46.35122210919174. distance: 1.9462993523937724
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0867, Accuracy: 9675/9900 (97.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4648/5066 (91.7489%), train_poison_data_count: 400
Global model norm: 46.37159638369025.
Norm before scaling: 46.35367128714699. Distance: 2.063308441780247
Total norm for 4 adversaries is: 46.35367128714699. distance: 2.063308441780247
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0770, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4211/4596 (91.6232%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4318/4596 (93.9513%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8522, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4146/4356 (95.1791%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4041/4356 (92.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1235, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3919/4295 (91.2456%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3942/4295 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9152, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4201/4634 (90.6560%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9102, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4228/4767 (88.6931%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4344/4767 (91.1265%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0298, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3846/4223 (91.0727%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3934/4223 (93.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8302, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3711/4046 (91.7202%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3746/4046 (92.5853%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9104, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4697/5083 (92.4061%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4691/5083 (92.2880%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9075, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3996/4362 (91.6094%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4129/4362 (94.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8041, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4255/4663 (91.2503%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4352/4663 (93.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9393, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3014/3297 (91.4164%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3074/3297 (93.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8040, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4063/4433 (91.6535%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4077/4433 (91.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9637, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4807/5265 (91.3010%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4817/5265 (91.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9089, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4539/4986 (91.0349%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4597/4986 (92.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9031, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4208/4647 (90.5530%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4272/4647 (91.9303%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8690, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4602/5017 (91.7281%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4629/5017 (92.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8474, Accuracy: 5842/10000 (58.4200%)
time spent on training: 232.6869044303894
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.9757, Accuracy: 4616/10000 (46.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 9.1920, Accuracy: 198/9900 (2.0000%)
Done in 256.7149739265442 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4519/4885 (92.5077%), train_poison_data_count: 385
Global model norm: 46.39310630363093.
Norm before scaling: 46.37412082219188. Distance: 1.9553429179411355
Total norm for 4 adversaries is: 46.37412082219188. distance: 1.9553429179411355
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1896, Accuracy: 9458/9900 (95.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4823/5305 (90.9142%), train_poison_data_count: 415
Global model norm: 46.39310630363093.
Norm before scaling: 46.374831536082155. Distance: 2.169724092302694
Total norm for 4 adversaries is: 46.374831536082155. distance: 2.169724092302694
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0434, Accuracy: 9803/9900 (99.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 46.39310630363093.
Norm before scaling: 46.3732258336505. Distance: 1.9820373462888483
Total norm for 4 adversaries is: 46.3732258336505. distance: 1.9820373462888483
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0630, Accuracy: 9742/9900 (98.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 46.39310630363093.
Norm before scaling: 46.37704520843933. Distance: 2.1283643680342132
Total norm for 4 adversaries is: 46.37704520843933. distance: 2.1283643680342132
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1973, Accuracy: 9416/9900 (95.1111%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3777/4184 (90.2725%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9587, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5860/6391 (91.6914%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5875/6391 (91.9261%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9937, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4648/4934 (94.2035%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4372/4934 (88.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1649, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4257/4618 (92.1828%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4311/4618 (93.3521%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9249, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3896/4235 (91.9953%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3942/4235 (93.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0747, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4061/4465 (90.9518%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4246/4465 (95.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8022, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4089/4503 (90.8061%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4115/4503 (91.3835%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7876, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4523/5025 (90.0100%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4603/5025 (91.6020%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0140, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5112/5582 (91.5801%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5123/5582 (91.7771%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0259, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3396/3804 (89.2744%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3512/3804 (92.3239%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9343, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3652/4158 (87.8307%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3770/4158 (90.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9144, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4177/4538 (92.0450%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4250/4538 (93.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8263, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3921/4368 (89.7665%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3960/4368 (90.6593%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8993, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4638/5083 (91.2453%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4655/5083 (91.5798%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8827, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4568/5116 (89.2885%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4665/5116 (91.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9350, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4184/4356 (96.0514%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4144/4356 (95.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9768, Accuracy: 5681/10000 (56.8100%)
time spent on training: 235.4905080795288
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 3.0478, Accuracy: 4512/10000 (45.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 8.8193, Accuracy: 219/9900 (2.2121%)
Done in 259.72395420074463 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4504/4885 (92.2006%), train_poison_data_count: 385
Global model norm: 46.42454132362941.
Norm before scaling: 46.40326431893693. Distance: 1.9811282291957675
Total norm for 4 adversaries is: 46.40326431893693. distance: 1.9811282291957675
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.1198, Accuracy: 9601/9900 (96.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4877/5305 (91.9321%), train_poison_data_count: 415
Global model norm: 46.42454132362941.
Norm before scaling: 46.40314857060483. Distance: 2.0759753818779574
Total norm for 4 adversaries is: 46.40314857060483. distance: 2.0759753818779574
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.2119, Accuracy: 9410/9900 (95.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 46.42454132362941.
Norm before scaling: 46.40543980774237. Distance: 2.002421701069681
Total norm for 4 adversaries is: 46.40543980774237. distance: 2.002421701069681
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0548, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4594/5066 (90.6830%), train_poison_data_count: 400
Global model norm: 46.42454132362941.
Norm before scaling: 46.40886987554211. Distance: 2.1562024539736457
Total norm for 4 adversaries is: 46.40886987554211. distance: 2.1562024539736457
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0549, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5658/6263 (90.3401%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5793/6263 (92.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0408, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4055/4433 (91.4730%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4082/4433 (92.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8823, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3334/3672 (90.7952%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3406/3672 (92.7560%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9125, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5027/5455 (92.1540%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5019/5455 (92.0073%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8911, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4539/5025 (90.3284%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4629/5025 (92.1194%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9711, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4203/4618 (91.0134%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4202/4618 (90.9918%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0332, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4260/4707 (90.5035%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4328/4707 (91.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8240, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4024/4362 (92.2513%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3993/4362 (91.5406%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0936, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4406/4989 (88.3143%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4499/4989 (90.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9537, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4631/5083 (91.1076%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4689/5083 (92.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9857, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4177/4647 (89.8859%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4323/4647 (93.0278%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9189, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3911/4368 (89.5375%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3944/4368 (90.2930%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0342, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4250/4354 (97.6114%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4127/4354 (94.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9432, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4227/4767 (88.6721%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4315/4767 (90.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1562, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4248/4662 (91.1197%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4303/4662 (92.2994%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9866, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4619/4804 (96.1490%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4595/4804 (95.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.7990, Accuracy: 6026/10000 (60.2600%)
time spent on training: 236.6887927055359
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 3.0078, Accuracy: 4532/10000 (45.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 8.9659, Accuracy: 185/9900 (1.8687%)
Done in 260.70395016670227 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4493/4885 (91.9754%), train_poison_data_count: 385
Global model norm: 46.44856551370828.
Norm before scaling: 46.431266931111466. Distance: 2.017588169482802
Total norm for 4 adversaries is: 46.431266931111466. distance: 2.017588169482802
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0743, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4835/5305 (91.1404%), train_poison_data_count: 415
Global model norm: 46.44856551370828.
Norm before scaling: 46.43211610781916. Distance: 2.1928920230958195
Total norm for 4 adversaries is: 46.43211610781916. distance: 2.1928920230958195
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.2162, Accuracy: 9408/9900 (95.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4329/4717 (91.7744%), train_poison_data_count: 370
Global model norm: 46.44856551370828.
Norm before scaling: 46.428821846422885. Distance: 1.951985263159108
Total norm for 4 adversaries is: 46.428821846422885. distance: 1.951985263159108
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0436, Accuracy: 9804/9900 (99.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4642/5066 (91.6305%), train_poison_data_count: 400
Global model norm: 46.44856551370828.
Norm before scaling: 46.433059911386145. Distance: 2.1172735330478956
Total norm for 4 adversaries is: 46.433059911386145. distance: 2.1172735330478956
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0986, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3860/4235 (91.1452%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3834/4235 (90.5313%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9822, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3412/3775 (90.3841%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3558/3775 (94.2517%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8610, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4494/4874 (92.2035%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4480/4874 (91.9163%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1013, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4760/5265 (90.4084%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4751/5265 (90.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9869, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4665/5083 (91.7765%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4647/5083 (91.4224%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9273, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4042/4511 (89.6032%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4167/4511 (92.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9578, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4149/4538 (91.4279%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4246/4538 (93.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8803, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4243/4716 (89.9703%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4312/4716 (91.4334%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9766, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4280/4663 (91.7864%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4380/4663 (93.9309%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8492, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4085/4441 (91.9838%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4124/4441 (92.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0751, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4295/4793 (89.6098%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4432/4793 (92.4682%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9442, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4257/4662 (91.3127%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4330/4662 (92.8786%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9653, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3312/3704 (89.4168%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3431/3704 (92.6296%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7318, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4463/4989 (89.4568%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4492/4989 (90.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9160, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4013/4346 (92.3378%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4114/4346 (94.6618%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7773, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3993/4362 (91.5406%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4033/4362 (92.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9097, Accuracy: 5712/10000 (57.1200%)
time spent on training: 237.02397084236145
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Client 13 misclassified the most to class 92 with 1 misclassifications.
Client 13 assigned a score of 1.
Current susp_pair_clients: defaultdict(<class 'int'>, {13: 1})
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: [(13, 1)]
Top 2 clients: [(13, 1)]
Client 13 misclassification ratio: 1.0000
Client 13 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.9942, Accuracy: 4526/10000 (45.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 7.9562, Accuracy: 328/9900 (3.3131%)
Done in 260.8532819747925 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4552/4885 (93.1832%), train_poison_data_count: 385
Global model norm: 46.46466756613298.
Norm before scaling: 46.443190789427085. Distance: 1.8988318642000894
Total norm for 4 adversaries is: 46.443190789427085. distance: 1.8988318642000894
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1415, Accuracy: 9543/9900 (96.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 46.46466756613298.
Norm before scaling: 46.44670479935848. Distance: 2.114820445129259
Total norm for 4 adversaries is: 46.44670479935848. distance: 2.114820445129259
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2189, Accuracy: 9401/9900 (94.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4357/4717 (92.3680%), train_poison_data_count: 370
Global model norm: 46.46466756613298.
Norm before scaling: 46.441006555023655. Distance: 1.8601662370781353
Total norm for 4 adversaries is: 46.441006555023655. distance: 1.8601662370781353
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1805, Accuracy: 9431/9900 (95.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4672/5066 (92.2227%), train_poison_data_count: 400
Global model norm: 46.46466756613298.
Norm before scaling: 46.44598730060677. Distance: 2.030438187572088
Total norm for 4 adversaries is: 46.44598730060677. distance: 2.030438187572088
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1885, Accuracy: 9469/9900 (95.6465%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3587/3969 (90.3754%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3630/3969 (91.4588%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9574, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4121/4558 (90.4125%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4177/4558 (91.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9125, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4433/4918 (90.1383%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4535/4918 (92.2123%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9798, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5523/5902 (93.5784%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5430/5902 (92.0027%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0040, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4786/5265 (90.9022%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4762/5265 (90.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0287, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4105/4511 (90.9998%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4165/4511 (92.3299%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9264, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4156/4625 (89.8595%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4160/4625 (89.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1188, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3937/4416 (89.1531%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4018/4416 (90.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0586, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3009/3297 (91.2648%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3104/3297 (94.1462%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6494, Accuracy: 6196/10000 (61.9600%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4585/5025 (91.2438%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4679/5025 (93.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0120, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4115/4441 (92.6593%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4168/4441 (93.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0201, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4200/4481 (93.7291%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4156/4481 (92.7472%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9893, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3457/3797 (91.0456%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3492/3797 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8404, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3346/3646 (91.7718%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3399/3646 (93.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8047, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3724/4025 (92.5217%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3767/4025 (93.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9073, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4471/4928 (90.7265%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9921, Accuracy: 5603/10000 (56.0300%)
time spent on training: 232.41260266304016
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 2 clients: []
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.8628, Accuracy: 4659/10000 (46.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 7.5961, Accuracy: 462/9900 (4.6667%)
Done in 256.12641525268555 sec.
Saving all the graphs.
This run has a label: Nov.06_11.36.55. Visdom environment: cifar100_CerP
