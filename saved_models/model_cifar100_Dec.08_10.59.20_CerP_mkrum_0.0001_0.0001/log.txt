current path: saved_models/model_cifar100_Dec.08_10.59.20_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43994205510447. Distance: 2.2934173716997543
Total norm for 4 adversaries is: 42.43994205510447. distance: 2.2934173716997543
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4406, Accuracy: 8831/9900 (89.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435352658761275. Distance: 2.251003995053827
Total norm for 4 adversaries is: 42.435352658761275. distance: 2.251003995053827
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7469, Accuracy: 8263/9900 (83.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4178/4717 (88.5732%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43865632629348. Distance: 2.1779931705812654
Total norm for 4 adversaries is: 42.43865632629348. distance: 2.1779931705812654
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4290, Accuracy: 8881/9900 (89.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4454/5066 (87.9195%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44030159198624. Distance: 2.3027765142388503
Total norm for 4 adversaries is: 42.44030159198624. distance: 2.3027765142388503
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5876, Accuracy: 8538/9900 (86.2424%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3835/4356 (88.0395%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3716/4356 (85.3076%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4284, Accuracy: 4715/10000 (47.1500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3941/4465 (88.2643%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4081/4465 (91.3998%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0123, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4168/4647 (89.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9883, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4448/5055 (87.9921%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4539/5055 (89.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1130, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4443/5116 (86.8452%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4441/5116 (86.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0299, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3630/4126 (87.9787%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3754/4126 (90.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9233, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3083/3472 (88.7961%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3221/3472 (92.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0582, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4428/4986 (88.8087%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4444/4986 (89.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0054, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3535/4013 (88.0887%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3683/4013 (91.7767%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8092, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4025/4618 (87.1589%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4110/4618 (88.9996%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0579, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4427/5083 (87.0942%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4457/5083 (87.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1297, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3970/4511 (88.0071%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4047/4511 (89.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1204, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3331/3797 (87.7272%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3391/3797 (89.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9665, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4997/5582 (89.5199%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5078/5582 (90.9710%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0879, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3150/3616 (87.1128%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3221/3616 (89.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0552, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4826/5455 (88.4693%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4822/5455 (88.3960%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9518, Accuracy: 5351/10000 (53.5100%)
time spent on training: 260.0442056655884
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1055, Accuracy: 7045/10000 (70.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0599, Accuracy: 118/9900 (1.1919%)
Done in 287.35113430023193 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.45470213531638.
Norm before scaling: 42.460573106762084. Distance: 2.110944488988187
Total norm for 4 adversaries is: 42.460573106762084. distance: 2.110944488988187
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2635, Accuracy: 9218/9900 (93.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 42.45470213531638.
Norm before scaling: 42.45805173611435. Distance: 2.1676984188861925
Total norm for 4 adversaries is: 42.45805173611435. distance: 2.1676984188861925
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5649, Accuracy: 8544/9900 (86.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.45470213531638.
Norm before scaling: 42.46190560648892. Distance: 2.165507140812609
Total norm for 4 adversaries is: 42.46190560648892. distance: 2.165507140812609
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2341, Accuracy: 9341/9900 (94.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 42.45470213531638.
Norm before scaling: 42.46467971664805. Distance: 2.2929244548931758
Total norm for 4 adversaries is: 42.46467971664805. distance: 2.2929244548931758
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2802, Accuracy: 9134/9900 (92.2626%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3598/4025 (89.3913%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3721/4025 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9321, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3339/3797 (87.9378%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3389/3797 (89.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0639, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3933/4625 (85.0378%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4001/4625 (86.5081%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1579, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3857/4481 (86.0745%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3886/4481 (86.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2317, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3860/4315 (89.4554%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3977/4315 (92.1669%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9916, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3709/4235 (87.5797%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3833/4235 (90.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9558, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3367/3828 (87.9572%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3476/3828 (90.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9502, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3825/4416 (86.6168%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9246, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3144/3638 (86.4211%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3282/3638 (90.2144%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9459, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4548/5265 (86.3818%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4522/5265 (85.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9583, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3356/3781 (88.7596%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3313/3781 (87.6223%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3253, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3991/4441 (89.8671%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4026/4441 (90.6553%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1581, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3971/4433 (89.5782%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4022/4433 (90.7286%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9945, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4439/5083 (87.3303%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4420/5083 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0346, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4320/4928 (87.6623%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4411/4928 (89.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9765, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4168/4793 (86.9602%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4381/4793 (91.4041%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0356, Accuracy: 5395/10000 (53.9500%)
time spent on training: 258.57897424697876
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0971, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0606, Accuracy: 230/9900 (2.3232%)
Done in 286.32144808769226 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 42.47719401889383.
Norm before scaling: 42.47774290823519. Distance: 2.019347782028325
Total norm for 4 adversaries is: 42.47774290823519. distance: 2.019347782028325
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2308, Accuracy: 9270/9900 (93.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 42.47719401889383.
Norm before scaling: 42.478288916773415. Distance: 2.093917839952464
Total norm for 4 adversaries is: 42.478288916773415. distance: 2.093917839952464
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0946, Accuracy: 9644/9900 (97.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.47719401889383.
Norm before scaling: 42.47869841857137. Distance: 1.9875344783263535
Total norm for 4 adversaries is: 42.47869841857137. distance: 1.9875344783263535
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2116, Accuracy: 9363/9900 (94.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 42.47719401889383.
Norm before scaling: 42.483557538567936. Distance: 2.1641758637740236
Total norm for 4 adversaries is: 42.483557538567936. distance: 2.1641758637740236
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1562, Accuracy: 9499/9900 (95.9495%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3161/3616 (87.4170%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3308/3616 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8213, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3410/3837 (88.8715%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3494/3837 (91.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9186, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4163/4679 (88.9720%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4299/4679 (91.8786%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0278, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3097/3638 (85.1292%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3274/3638 (89.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0742, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3640/4046 (89.9654%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3629/4046 (89.6935%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9772, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3981/4518 (88.1142%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4090/4518 (90.5268%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1219, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3382/3797 (89.0703%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3412/3797 (89.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0569, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4430/5025 (88.1592%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4465/5025 (88.8557%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2774, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3915/4362 (89.7524%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3940/4362 (90.3255%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9978, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3996/4558 (87.6700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4015/4558 (88.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1681, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3210/3672 (87.4183%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3250/3672 (88.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0810, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4327/4874 (88.7772%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4356/4874 (89.3722%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2406, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3609/4025 (89.6646%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3694/4025 (91.7764%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9371, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4087/4663 (87.6474%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4242/4663 (90.9715%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0816, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3465/3911 (88.5963%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3456/3911 (88.3661%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0232, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4446/5017 (88.6187%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4564/5017 (90.9707%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8469, Accuracy: 5675/10000 (56.7500%)
time spent on training: 254.50344944000244
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0923, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0689, Accuracy: 433/9900 (4.3737%)
Done in 281.87785148620605 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 42.49759873731103.
Norm before scaling: 42.499705594108974. Distance: 1.9710003540797425
Total norm for 4 adversaries is: 42.499705594108974. distance: 1.9710003540797425
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5356, Accuracy: 8674/9900 (87.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4832/5305 (91.0839%), train_poison_data_count: 415
Global model norm: 42.49759873731103.
Norm before scaling: 42.49558513374507. Distance: 2.017868449472418
Total norm for 4 adversaries is: 42.49558513374507. distance: 2.017868449472418
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0779, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.49759873731103.
Norm before scaling: 42.498977469316834. Distance: 1.955616026211927
Total norm for 4 adversaries is: 42.498977469316834. distance: 1.955616026211927
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1388, Accuracy: 9532/9900 (96.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4537/5066 (89.5578%), train_poison_data_count: 400
Global model norm: 42.49759873731103.
Norm before scaling: 42.50347096350264. Distance: 2.119048254575272
Total norm for 4 adversaries is: 42.50347096350264. distance: 2.119048254575272
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3367, Accuracy: 9047/9900 (91.3838%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5260/6124 (85.8916%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5288/6124 (86.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1430, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3883/4356 (89.1414%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3674/4356 (84.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3363, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3529/4158 (84.8725%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3592/4158 (86.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1008, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4895/5455 (89.7342%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4881/5455 (89.4775%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9639, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3936/4511 (87.2534%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4058/4511 (89.9579%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0205, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4533/5232 (86.6399%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4552/5232 (87.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1008, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4489/5244 (85.6026%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4522/5244 (86.2319%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1486, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4388/4918 (89.2233%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4392/4918 (89.3046%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1369, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3617/4126 (87.6636%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3727/4126 (90.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8706, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4372/4928 (88.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1380, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3739/4223 (88.5390%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3841/4223 (90.9543%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9390, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4521/5195 (87.0260%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4610/5195 (88.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0913, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4153/4679 (88.7583%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4135/4679 (88.3736%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0670, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3207/3646 (87.9594%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3287/3646 (90.1536%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8473, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3193/3616 (88.3020%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3220/3616 (89.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9103, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4077/4716 (86.4504%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4104/4716 (87.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0063, Accuracy: 5436/10000 (54.3600%)
time spent on training: 262.4690306186676
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0892, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4042, Accuracy: 700/9900 (7.0707%)
Done in 289.75507831573486 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 42.522637296117786.
Norm before scaling: 42.52566722635725. Distance: 1.961077316588559
Total norm for 4 adversaries is: 42.52566722635725. distance: 1.961077316588559
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1758, Accuracy: 9482/9900 (95.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4867/5305 (91.7436%), train_poison_data_count: 415
Global model norm: 42.522637296117786.
Norm before scaling: 42.51742376064415. Distance: 1.9819491720139488
Total norm for 4 adversaries is: 42.51742376064415. distance: 1.9819491720139488
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1391, Accuracy: 9549/9900 (96.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 42.522637296117786.
Norm before scaling: 42.523418123043534. Distance: 1.9220663456138887
Total norm for 4 adversaries is: 42.523418123043534. distance: 1.9220663456138887
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2021, Accuracy: 9362/9900 (94.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4559/5066 (89.9921%), train_poison_data_count: 400
Global model norm: 42.522637296117786.
Norm before scaling: 42.53014498472672. Distance: 2.080854530679726
Total norm for 4 adversaries is: 42.53014498472672. distance: 2.080854530679726
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2782, Accuracy: 9211/9900 (93.0404%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5267/6124 (86.0059%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5352/6124 (87.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0374, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4036/4433 (91.0444%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9477, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3377/3781 (89.3150%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3214/3781 (85.0040%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3889, Accuracy: 4904/10000 (49.0400%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3572/3969 (89.9975%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3585/3969 (90.3250%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9644, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4482/5025 (89.1940%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4511/5025 (89.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2946, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4178/4679 (89.2926%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4260/4679 (91.0451%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1661, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4152/4707 (88.2091%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4224/4707 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9127, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4447/4986 (89.1897%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4460/4986 (89.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9605, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3900/4315 (90.3824%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3963/4315 (91.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8880, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3917/4416 (88.7002%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0010, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4246/4804 (88.3847%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4049/4804 (84.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0680, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4173/4793 (87.0645%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4253/4793 (88.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0588, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4547/5232 (86.9075%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4540/5232 (86.7737%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0527, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4127/4662 (88.5242%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4229/4662 (90.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0375, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4253/4956 (85.8152%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4306/4956 (86.8846%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1970, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3834/4368 (87.7747%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3812/4368 (87.2711%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9727, Accuracy: 5397/10000 (53.9700%)
time spent on training: 260.37585830688477
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0891, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7520, Accuracy: 1052/9900 (10.6263%)
Done in 287.9225034713745 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4474/4885 (91.5865%), train_poison_data_count: 385
Global model norm: 42.54701558460064.
Norm before scaling: 42.547326877420424. Distance: 1.9221266915109925
Total norm for 4 adversaries is: 42.547326877420424. distance: 1.9221266915109925
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2844, Accuracy: 9186/9900 (92.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5305 (91.4232%), train_poison_data_count: 415
Global model norm: 42.54701558460064.
Norm before scaling: 42.5438924886515. Distance: 1.954392838013932
Total norm for 4 adversaries is: 42.5438924886515. distance: 1.954392838013932
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2122, Accuracy: 9360/9900 (94.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4313/4717 (91.4352%), train_poison_data_count: 370
Global model norm: 42.54701558460064.
Norm before scaling: 42.546952465041485. Distance: 1.8645995652612877
Total norm for 4 adversaries is: 42.546952465041485. distance: 1.8645995652612877
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2399, Accuracy: 9289/9900 (93.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4606/5066 (90.9199%), train_poison_data_count: 400
Global model norm: 42.54701558460064.
Norm before scaling: 42.551680434649114. Distance: 2.019405279897713
Total norm for 4 adversaries is: 42.551680434649114. distance: 2.019405279897713
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1100, Accuracy: 9608/9900 (97.0505%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5356/6124 (87.4592%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5330/6124 (87.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1901, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5162/5902 (87.4619%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5166/5902 (87.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1161, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4168/4707 (88.5490%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4230/4707 (89.8662%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9460, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4095/4647 (88.1214%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4165/4647 (89.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9128, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2984/3297 (90.5065%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7396, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5552/6263 (88.6476%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5632/6263 (89.9250%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2026, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4179/4663 (89.6204%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4257/4663 (91.2932%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1091, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4338/4956 (87.5303%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4331/4956 (87.3890%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2884, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3624/4046 (89.5699%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3710/4046 (91.6955%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9147, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3718/4184 (88.8623%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3780/4184 (90.3442%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8845, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4880/5591 (87.2831%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4873/5591 (87.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1566, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4107/4634 (88.6275%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4157/4634 (89.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9632, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3397/3828 (88.7409%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3505/3828 (91.5622%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9055, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3151/3638 (86.6135%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3268/3638 (89.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9069, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3399/3781 (89.8969%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3351/3781 (88.6273%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3335, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3427/3837 (89.3146%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3539/3837 (92.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8713, Accuracy: 5704/10000 (57.0400%)
time spent on training: 263.914347410202
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0860, Accuracy: 7082/10000 (70.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.2148, Accuracy: 1393/9900 (14.0707%)
Done in 291.5583384037018 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4483/4885 (91.7707%), train_poison_data_count: 385
Global model norm: 42.57052684498249.
Norm before scaling: 42.5687891140989. Distance: 1.8536207131118794
Total norm for 4 adversaries is: 42.5687891140989. distance: 1.8536207131118794
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2780, Accuracy: 9218/9900 (93.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4874/5305 (91.8756%), train_poison_data_count: 415
Global model norm: 42.57052684498249.
Norm before scaling: 42.56807220775185. Distance: 1.9418956976242725
Total norm for 4 adversaries is: 42.56807220775185. distance: 1.9418956976242725
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1581, Accuracy: 9520/9900 (96.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 42.57052684498249.
Norm before scaling: 42.57253116924398. Distance: 1.8858187406579077
Total norm for 4 adversaries is: 42.57253116924398. distance: 1.8858187406579077
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1500, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 42.57052684498249.
Norm before scaling: 42.572307515420164. Distance: 1.9504647410280587
Total norm for 4 adversaries is: 42.572307515420164. distance: 1.9504647410280587
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2450, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3914/4501 (86.9585%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3950/4501 (87.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0358, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3704/4175 (88.7186%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3738/4175 (89.5329%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9105, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3176/3616 (87.8319%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3240/3616 (89.6018%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8827, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4060/4634 (87.6133%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4103/4634 (88.5412%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0014, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4020/4558 (88.1966%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3967/4558 (87.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1653, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4564/5167 (88.3298%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4638/5167 (89.7620%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1672, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3900/4356 (89.5317%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3877/4356 (89.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1603, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4151/4716 (88.0195%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4188/4716 (88.8041%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0720, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5400/6124 (88.1777%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5356/6124 (87.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9930, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4466/5055 (88.3482%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4559/5055 (90.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9865, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4520/5025 (89.9502%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4571/5025 (90.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0791, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4378/4918 (89.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1984, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3762/4223 (89.0836%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3796/4223 (89.8887%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8913, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3926/4481 (87.6144%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3883/4481 (86.6548%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1246, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3205/3638 (88.0979%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9089, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3589/4013 (89.4343%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3677/4013 (91.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8051, Accuracy: 5742/10000 (57.4200%)
time spent on training: 263.6993706226349
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0864, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.7064, Accuracy: 1885/9900 (19.0404%)
Done in 291.0520763397217 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4511/4885 (92.3439%), train_poison_data_count: 385
Global model norm: 42.59370987709042.
Norm before scaling: 42.591626299771356. Distance: 1.8403680463360397
Total norm for 4 adversaries is: 42.591626299771356. distance: 1.8403680463360397
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2335, Accuracy: 9311/9900 (94.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4863/5305 (91.6682%), train_poison_data_count: 415
Global model norm: 42.59370987709042.
Norm before scaling: 42.590544346996055. Distance: 1.9226408882255948
Total norm for 4 adversaries is: 42.590544346996055. distance: 1.9226408882255948
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2331, Accuracy: 9347/9900 (94.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4328/4717 (91.7532%), train_poison_data_count: 370
Global model norm: 42.59370987709042.
Norm before scaling: 42.59279993667137. Distance: 1.7859015380229037
Total norm for 4 adversaries is: 42.59279993667137. distance: 1.7859015380229037
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4219, Accuracy: 8880/9900 (89.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4610/5066 (90.9988%), train_poison_data_count: 400
Global model norm: 42.59370987709042.
Norm before scaling: 42.594847633509325. Distance: 1.9548964134929996
Total norm for 4 adversaries is: 42.594847633509325. distance: 1.9548964134929996
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1423, Accuracy: 9542/9900 (96.3838%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3213/3646 (88.1240%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3311/3646 (90.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8224, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3959/4501 (87.9582%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4020/4501 (89.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0335, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4096/4651 (88.0671%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4194/4651 (90.1742%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0039, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4609/5167 (89.2007%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4665/5167 (90.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0559, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4905/5455 (89.9175%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4908/5455 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0984, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4905/5591 (87.7303%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4875/5591 (87.1937%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1982, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4225/4679 (90.2971%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4153/4679 (88.7583%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1563, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4487/5017 (89.4359%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4514/5017 (89.9741%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8631, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4264/4793 (88.9631%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4314/4793 (90.0063%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0686, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4044/4456 (90.7540%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4091/4456 (91.8088%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8517, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4821/5424 (88.8827%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4902/5424 (90.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2355, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3685/4175 (88.2635%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3690/4175 (88.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0122, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4564/5116 (89.2103%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4544/5116 (88.8194%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1086, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3303/3704 (89.1739%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3359/3704 (90.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9067, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4523/5232 (86.4488%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4669/5232 (89.2393%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2617, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3108/3472 (89.5161%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3172/3472 (91.3594%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1155, Accuracy: 5406/10000 (54.0600%)
time spent on training: 266.2041554450989
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0881, Accuracy: 7074/10000 (70.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.2332, Accuracy: 2426/9900 (24.5051%)
Done in 293.56350445747375 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4514/4885 (92.4053%), train_poison_data_count: 385
Global model norm: 42.61736723724701.
Norm before scaling: 42.61530343566807. Distance: 1.8066087544697342
Total norm for 4 adversaries is: 42.61530343566807. distance: 1.8066087544697342
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2103, Accuracy: 9386/9900 (94.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4881/5305 (92.0075%), train_poison_data_count: 415
Global model norm: 42.61736723724701.
Norm before scaling: 42.61151070692709. Distance: 1.8852226691435703
Total norm for 4 adversaries is: 42.61151070692709. distance: 1.8852226691435703
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1993, Accuracy: 9439/9900 (95.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4319/4717 (91.5624%), train_poison_data_count: 370
Global model norm: 42.61736723724701.
Norm before scaling: 42.61449135032442. Distance: 1.7882774662962715
Total norm for 4 adversaries is: 42.61449135032442. distance: 1.7882774662962715
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1478, Accuracy: 9540/9900 (96.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 42.61736723724701.
Norm before scaling: 42.61859888244949. Distance: 1.9211745807882592
Total norm for 4 adversaries is: 42.61859888244949. distance: 1.9211745807882592
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3476, Accuracy: 9038/9900 (91.2929%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3246/3590 (90.4178%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3334/3590 (92.8691%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9474, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3874/4368 (88.6905%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3855/4368 (88.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8677, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3306/3704 (89.2549%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3373/3704 (91.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9432, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4361/4928 (88.4943%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4379/4928 (88.8596%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1391, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3921/4356 (90.0138%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3842/4356 (88.2002%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0802, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3512/3911 (89.7980%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3370/3911 (86.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1509, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4156/4651 (89.3571%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4185/4651 (89.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1250, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3751/4184 (89.6511%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3760/4184 (89.8662%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9721, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3933/4346 (90.4970%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3999/4346 (92.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9057, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4227/4793 (88.1911%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4358/4793 (90.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9651, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3431/3804 (90.1945%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3499/3804 (91.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8822, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4504/4986 (90.3329%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4501/4986 (90.2728%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8521, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5393/6124 (88.0634%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5324/6124 (86.9366%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0455, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4188/4707 (88.9739%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4264/4707 (90.5885%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9095, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3829/4235 (90.4132%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3686/4235 (87.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1536, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3657/4046 (90.3856%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3700/4046 (91.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0733, Accuracy: 5291/10000 (52.9100%)
time spent on training: 254.62312364578247
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0906, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7964, Accuracy: 2972/9900 (30.0202%)
Done in 282.6315727233887 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4551/4885 (93.1627%), train_poison_data_count: 385
Global model norm: 42.639700315184555.
Norm before scaling: 42.633948497097066. Distance: 1.771245601758968
Total norm for 4 adversaries is: 42.633948497097066. distance: 1.771245601758968
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0663, Accuracy: 9733/9900 (98.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4903/5305 (92.4222%), train_poison_data_count: 415
Global model norm: 42.639700315184555.
Norm before scaling: 42.635397261071404. Distance: 1.8458929378051006
Total norm for 4 adversaries is: 42.635397261071404. distance: 1.8458929378051006
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0970, Accuracy: 9663/9900 (97.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4351/4717 (92.2408%), train_poison_data_count: 370
Global model norm: 42.639700315184555.
Norm before scaling: 42.63666274188946. Distance: 1.7477876439024567
Total norm for 4 adversaries is: 42.63666274188946. distance: 1.7477876439024567
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3388, Accuracy: 9128/9900 (92.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4622/5066 (91.2357%), train_poison_data_count: 400
Global model norm: 42.639700315184555.
Norm before scaling: 42.6410558447453. Distance: 1.9396650461698297
Total norm for 4 adversaries is: 42.6410558447453. distance: 1.9396650461698297
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1852, Accuracy: 9425/9900 (95.2020%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4451/4986 (89.2700%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4473/4986 (89.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0724, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4066/4634 (87.7428%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4157/4634 (89.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8978, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4158/4716 (88.1679%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4194/4716 (88.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1836, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5355/6124 (87.4428%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5417/6124 (88.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1856, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4419/4918 (89.8536%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4499/4918 (91.4803%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9555, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3408/3797 (89.7551%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3435/3797 (90.4662%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1072, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5011/5582 (89.7707%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1169, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4338/4956 (87.5303%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4289/4956 (86.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0912, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4024/4433 (90.7737%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4029/4433 (90.8865%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8726, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3879/4354 (89.0905%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0119, Accuracy: 3373/4354 (77.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3998, Accuracy: 4783/10000 (47.8300%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4348/4928 (88.2305%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4409/4928 (89.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8325, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3501/3911 (89.5167%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3453/3911 (88.2894%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9038, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3866/4481 (86.2754%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3847/4481 (85.8514%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1732, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4617/5197 (88.8397%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4609/5197 (88.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0106, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4842/5455 (88.7626%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4912/5455 (90.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1079, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3833/4361 (87.8927%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3786/4361 (86.8150%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0372, Accuracy: 5324/10000 (53.2400%)
time spent on training: 266.91116213798523
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0950, Accuracy: 7051/10000 (70.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.4123, Accuracy: 3478/9900 (35.1313%)
Done in 294.14549803733826 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 42.66530495695903.
Norm before scaling: 42.66478280041105. Distance: 1.7753837090117288
Total norm for 4 adversaries is: 42.66478280041105. distance: 1.7753837090117288
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1620, Accuracy: 9516/9900 (96.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4919/5305 (92.7238%), train_poison_data_count: 415
Global model norm: 42.66530495695903.
Norm before scaling: 42.658562208394926. Distance: 1.8338701011473195
Total norm for 4 adversaries is: 42.658562208394926. distance: 1.8338701011473195
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1401, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4363/4717 (92.4952%), train_poison_data_count: 370
Global model norm: 42.66530495695903.
Norm before scaling: 42.659326239808046. Distance: 1.7102615205543756
Total norm for 4 adversaries is: 42.659326239808046. distance: 1.7102615205543756
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0704, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 42.66530495695903.
Norm before scaling: 42.66801005473832. Distance: 1.9114263949380816
Total norm for 4 adversaries is: 42.66801005473832. distance: 1.9114263949380816
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1677, Accuracy: 9479/9900 (95.7475%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4339/4928 (88.0479%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4373/4928 (88.7378%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9459, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3783/4184 (90.4159%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3816/4184 (91.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8963, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4265/4707 (90.6097%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0049, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3442/3828 (89.9164%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3552/3828 (92.7900%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8721, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4024/4503 (89.3626%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4012/4503 (89.0962%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9751, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4201/4662 (90.1115%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4230/4662 (90.7336%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9755, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3794/4235 (89.5868%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3819/4235 (90.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9986, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4469/5244 (85.2212%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4494/5244 (85.6979%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0100, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4265/4793 (88.9839%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4345/4793 (90.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0102, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3980/4481 (88.8195%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3898/4481 (86.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2458, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3970/4346 (91.3484%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4035/4346 (92.8440%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7652, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3844/4361 (88.1449%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3708/4361 (85.0264%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2352, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4564/5055 (90.2868%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4575/5055 (90.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9749, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4583/5195 (88.2194%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4564/5195 (87.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1429, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3940/4315 (91.3094%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3984/4315 (92.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0135, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4229/4663 (90.6927%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4265/4663 (91.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0210, Accuracy: 5433/10000 (54.3300%)
time spent on training: 260.20018911361694
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.0996, Accuracy: 7049/10000 (70.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9971, Accuracy: 4035/9900 (40.7576%)
Done in 287.5680503845215 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4549/4885 (93.1218%), train_poison_data_count: 385
Global model norm: 42.688692447656734.
Norm before scaling: 42.68495485640989. Distance: 1.7000747103262603
Total norm for 4 adversaries is: 42.68495485640989. distance: 1.7000747103262603
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1740, Accuracy: 9489/9900 (95.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4918/5305 (92.7050%), train_poison_data_count: 415
Global model norm: 42.688692447656734.
Norm before scaling: 42.68391530748512. Distance: 1.8167701930840785
Total norm for 4 adversaries is: 42.68391530748512. distance: 1.8167701930840785
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2369, Accuracy: 9319/9900 (94.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.688692447656734.
Norm before scaling: 42.683214634366955. Distance: 1.67675482650251
Total norm for 4 adversaries is: 42.683214634366955. distance: 1.67675482650251
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1721, Accuracy: 9496/9900 (95.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4671/5066 (92.2029%), train_poison_data_count: 400
Global model norm: 42.688692447656734.
Norm before scaling: 42.68857806563279. Distance: 1.8409302048804927
Total norm for 4 adversaries is: 42.68857806563279. distance: 1.8409302048804927
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1539, Accuracy: 9497/9900 (95.9293%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3978/4315 (92.1900%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3969/4315 (91.9815%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8808, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3281/3590 (91.3928%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3177/3590 (88.4958%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1025, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4211/4679 (89.9979%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4257/4679 (90.9810%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9727, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4631/5167 (89.6265%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4668/5167 (90.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0446, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3385/3775 (89.6689%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7896, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3456/3828 (90.2821%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3515/3828 (91.8234%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8819, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3805/4235 (89.8465%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3868/4235 (91.3341%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9224, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4159/4647 (89.4986%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4193/4647 (90.2303%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9105, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4423/4918 (89.9349%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4458/4918 (90.6466%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0287, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4017/4433 (90.6158%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4013/4433 (90.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0252, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3989/4481 (89.0203%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3916/4481 (87.3912%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0059, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3828/4295 (89.1269%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3706/4295 (86.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0799, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4018/4503 (89.2294%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4029/4503 (89.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9481, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3864/4354 (88.7460%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3558/4354 (81.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4414, Accuracy: 4681/10000 (46.8100%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4498/4986 (90.2126%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4437/4986 (88.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0269, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5574/6263 (88.9989%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5696/6263 (90.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1285, Accuracy: 5314/10000 (53.1400%)
time spent on training: 261.9338343143463
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1100, Accuracy: 7011/10000 (70.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.7262, Accuracy: 4484/9900 (45.2929%)
Done in 289.0993344783783 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4534/4885 (92.8147%), train_poison_data_count: 385
Global model norm: 42.711681302971.
Norm before scaling: 42.707073946116495. Distance: 1.7380036207365506
Total norm for 4 adversaries is: 42.707073946116495. distance: 1.7380036207365506
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1602, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4894/5305 (92.2526%), train_poison_data_count: 415
Global model norm: 42.711681302971.
Norm before scaling: 42.707678475670505. Distance: 1.8770948152123912
Total norm for 4 adversaries is: 42.707678475670505. distance: 1.8770948152123912
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0890, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4383/4717 (92.9192%), train_poison_data_count: 370
Global model norm: 42.711681302971.
Norm before scaling: 42.703859648821556. Distance: 1.6507438687931804
Total norm for 4 adversaries is: 42.703859648821556. distance: 1.6507438687931804
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1609, Accuracy: 9524/9900 (96.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4680/5066 (92.3806%), train_poison_data_count: 400
Global model norm: 42.711681302971.
Norm before scaling: 42.70982355758816. Distance: 1.826016636742369
Total norm for 4 adversaries is: 42.70982355758816. distance: 1.826016636742369
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0616, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3760/4223 (89.0362%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3840/4223 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9362, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4947/5455 (90.6874%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4841/5455 (88.7443%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1451, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5109/5582 (91.5263%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5086/5582 (91.1143%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1443, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4026/4465 (90.1680%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4066/4465 (91.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8956, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4961/5591 (88.7319%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4946/5591 (88.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1568, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3541/3911 (90.5395%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3369/3911 (86.1417%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0581, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3921/4356 (90.0138%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0154, Accuracy: 3220/4356 (73.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.6464, Accuracy: 4375/10000 (43.7500%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4468/5037 (88.7036%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4529/5037 (89.9146%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9580, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4242/4679 (90.6604%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4215/4679 (90.0834%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1314, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4001/4362 (91.7240%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3950/4362 (90.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0527, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4115/4518 (91.0801%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8781, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4518/5083 (88.8845%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4496/5083 (88.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1263, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3602/4013 (89.7583%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3711/4013 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7728, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4624/5197 (88.9744%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4658/5197 (89.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0994, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2983/3297 (90.4762%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3045/3297 (92.3567%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7173, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4032/4441 (90.7904%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4020/4441 (90.5202%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0239, Accuracy: 5514/10000 (55.1400%)
time spent on training: 263.21067571640015
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1106, Accuracy: 7016/10000 (70.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.4515, Accuracy: 4922/9900 (49.7172%)
Done in 290.6549141407013 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4547/4885 (93.0809%), train_poison_data_count: 385
Global model norm: 42.73475062677694.
Norm before scaling: 42.729680100878795. Distance: 1.72457909908483
Total norm for 4 adversaries is: 42.729680100878795. distance: 1.72457909908483
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0840, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4923/5305 (92.7992%), train_poison_data_count: 415
Global model norm: 42.73475062677694.
Norm before scaling: 42.7267460626428. Distance: 1.7480570361305583
Total norm for 4 adversaries is: 42.7267460626428. distance: 1.7480570361305583
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2922, Accuracy: 9236/9900 (93.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4405/4717 (93.3856%), train_poison_data_count: 370
Global model norm: 42.73475062677694.
Norm before scaling: 42.727825994986134. Distance: 1.6563973271324186
Total norm for 4 adversaries is: 42.727825994986134. distance: 1.6563973271324186
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3051, Accuracy: 9122/9900 (92.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4659/5066 (91.9660%), train_poison_data_count: 400
Global model norm: 42.73475062677694.
Norm before scaling: 42.73370800439259. Distance: 1.8360122990081997
Total norm for 4 adversaries is: 42.73370800439259. distance: 1.8360122990081997
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1635, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4044/4501 (89.8467%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4037/4501 (89.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0302, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4089/4511 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9300, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3904/4354 (89.6647%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3465/4354 (79.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5256, Accuracy: 4622/10000 (46.2200%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3967/4346 (91.2793%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4026/4346 (92.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8632, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4250/4707 (90.2911%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4250/4707 (90.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9415, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4946/5591 (88.4636%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4952/5591 (88.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0306, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4142/4647 (89.1328%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4195/4647 (90.2733%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8589, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4110/4538 (90.5685%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4183/4538 (92.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8900, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4382/4934 (88.8123%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4379/4934 (88.7515%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2489, Accuracy: 5092/10000 (50.9200%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4329/4804 (90.1124%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4293/4804 (89.3630%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0138, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5690/6263 (90.8510%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5674/6263 (90.5956%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3581, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3977/4481 (88.7525%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3905/4481 (87.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0022, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4447/5063 (87.8333%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4471/5063 (88.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9943, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3759/4223 (89.0126%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9400, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4062/4441 (91.4659%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4100/4441 (92.3215%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0167, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3461/3756 (92.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8734, Accuracy: 5677/10000 (56.7700%)
time spent on training: 264.6570634841919
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1149, Accuracy: 7012/10000 (70.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.2217, Accuracy: 5314/9900 (53.6768%)
Done in 292.1139998435974 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4580/4885 (93.7564%), train_poison_data_count: 385
Global model norm: 42.75815865815479.
Norm before scaling: 42.75088517906676. Distance: 1.6726660594982161
Total norm for 4 adversaries is: 42.75088517906676. distance: 1.6726660594982161
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1341, Accuracy: 9578/9900 (96.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4933/5305 (92.9877%), train_poison_data_count: 415
Global model norm: 42.75815865815479.
Norm before scaling: 42.75470266075271. Distance: 1.8456568797943265
Total norm for 4 adversaries is: 42.75470266075271. distance: 1.8456568797943265
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0639, Accuracy: 9737/9900 (98.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 42.75815865815479.
Norm before scaling: 42.751476240044916. Distance: 1.6185116713948293
Total norm for 4 adversaries is: 42.751476240044916. distance: 1.6185116713948293
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2142, Accuracy: 9375/9900 (94.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4711/5066 (92.9925%), train_poison_data_count: 400
Global model norm: 42.75815865815479.
Norm before scaling: 42.752699738857864. Distance: 1.760446093010483
Total norm for 4 adversaries is: 42.752699738857864. distance: 1.760446093010483
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2266, Accuracy: 9329/9900 (94.2323%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4493/5244 (85.6789%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4584/5244 (87.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0778, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4437/4928 (90.0365%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4435/4928 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9143, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3434/3804 (90.2734%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3481/3804 (91.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9059, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3650/4013 (90.9544%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3676/4013 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9434, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3637/4158 (87.4699%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3644/4158 (87.6383%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9178, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5112/5582 (91.5801%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5046/5582 (90.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0592, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4908/5455 (89.9725%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4879/5455 (89.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9470, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3907/4354 (89.7336%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0111, Accuracy: 3490/4354 (80.1562%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.6120, Accuracy: 4448/10000 (44.4800%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4030/4433 (90.9091%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4061/4433 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9468, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3253/3646 (89.2211%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8419, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4092/4518 (90.5710%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4089/4518 (90.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9902, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3856/4235 (91.0508%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3767/4235 (88.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2691, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4009/4362 (91.9074%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3885/4362 (89.0646%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1349, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4872/5392 (90.3561%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4769/5392 (88.4458%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2348, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4927/5591 (88.1238%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4907/5591 (87.7661%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2038, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3414/3756 (90.8946%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3491/3756 (92.9446%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9848, Accuracy: 5607/10000 (56.0700%)
time spent on training: 263.11361932754517
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1203, Accuracy: 6995/10000 (69.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 2.0055, Accuracy: 5680/9900 (57.3737%)
Done in 290.6439118385315 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4555/4885 (93.2446%), train_poison_data_count: 385
Global model norm: 42.781408361193385.
Norm before scaling: 42.773439640410906. Distance: 1.6800614761276194
Total norm for 4 adversaries is: 42.773439640410906. distance: 1.6800614761276194
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0910, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4940/5305 (93.1197%), train_poison_data_count: 415
Global model norm: 42.781408361193385.
Norm before scaling: 42.772985870903376. Distance: 1.78129992498737
Total norm for 4 adversaries is: 42.772985870903376. distance: 1.78129992498737
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0184, Accuracy: 9849/9900 (99.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4387/4717 (93.0040%), train_poison_data_count: 370
Global model norm: 42.781408361193385.
Norm before scaling: 42.77395190900722. Distance: 1.6363821480166343
Total norm for 4 adversaries is: 42.77395190900722. distance: 1.6363821480166343
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1209, Accuracy: 9607/9900 (97.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4690/5066 (92.5780%), train_poison_data_count: 400
Global model norm: 42.781408361193385.
Norm before scaling: 42.776740026615954. Distance: 1.8011107567382774
Total norm for 4 adversaries is: 42.776740026615954. distance: 1.8011107567382774
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1380, Accuracy: 9553/9900 (96.4949%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4222/4634 (91.1092%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4136/4634 (89.2533%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1173, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4086/4503 (90.7395%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4049/4503 (89.9178%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9949, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4385/4928 (88.9813%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4532/4928 (91.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8003, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3422/3804 (89.9579%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3463/3804 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0160, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3283/3590 (91.4485%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3087/3590 (85.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2738, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4182/4647 (89.9935%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4258/4647 (91.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9102, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4034/4625 (87.2216%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4043/4625 (87.4162%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0582, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3956/4356 (90.8173%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3926/4356 (90.1286%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0603, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3451/3797 (90.8875%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3513/3797 (92.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9757, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4064/4456 (91.2029%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4088/4456 (91.7415%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9372, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3634/4025 (90.2857%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3725/4025 (92.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9377, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3161/3472 (91.0426%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3165/3472 (91.1578%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9943, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2956/3297 (89.6573%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8769, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3911/4416 (88.5643%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3987/4416 (90.2853%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1703, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3964/4356 (91.0009%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4051/4356 (92.9982%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0278, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3230/3638 (88.7850%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3347/3638 (92.0011%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8460, Accuracy: 5652/10000 (56.5200%)
time spent on training: 254.6430675983429
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1285, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7758, Accuracy: 6115/9900 (61.7677%)
Done in 281.92942667007446 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4555/4885 (93.2446%), train_poison_data_count: 385
Global model norm: 42.80146841221908.
Norm before scaling: 42.795651337928014. Distance: 1.6965932622717972
Total norm for 4 adversaries is: 42.795651337928014. distance: 1.6965932622717972
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1617, Accuracy: 9509/9900 (96.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4947/5305 (93.2516%), train_poison_data_count: 415
Global model norm: 42.80146841221908.
Norm before scaling: 42.791466662649285. Distance: 1.7410600375407188
Total norm for 4 adversaries is: 42.791466662649285. distance: 1.7410600375407188
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1078, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4382/4717 (92.8980%), train_poison_data_count: 370
Global model norm: 42.80146841221908.
Norm before scaling: 42.79231960512891. Distance: 1.6237056418946094
Total norm for 4 adversaries is: 42.79231960512891. distance: 1.6237056418946094
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1131, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4723/5066 (93.2294%), train_poison_data_count: 400
Global model norm: 42.80146841221908.
Norm before scaling: 42.79465298631069. Distance: 1.756506337094406
Total norm for 4 adversaries is: 42.79465298631069. distance: 1.756506337094406
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0846, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3735/4175 (89.4611%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3705/4175 (88.7425%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9528, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4358/4956 (87.9338%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4448/4956 (89.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0381, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4581/5037 (90.9470%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9543, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4301/4793 (89.7350%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4341/4793 (90.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0112, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3407/3804 (89.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0233, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4874/5392 (90.3932%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4875/5392 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0497, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4079/4465 (91.3550%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4078/4465 (91.3326%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9147, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4175/4596 (90.8399%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4238/4596 (92.2106%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0576, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5417/6124 (88.4553%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5428/6124 (88.6349%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0611, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2923/3271 (89.3611%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2988/3271 (91.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8530, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3254/3590 (90.6407%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3294/3590 (91.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9849, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3958/4501 (87.9360%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4021/4501 (89.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0453, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4660/5232 (89.0673%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4603/5232 (87.9778%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0320, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3274/3672 (89.1612%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3301/3672 (89.8965%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0000, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3827/4223 (90.6228%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3886/4223 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1314, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3925/4354 (90.1470%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0174, Accuracy: 3031/4354 (69.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.9832, Accuracy: 3943/10000 (39.4300%)
time spent on training: 259.33342146873474
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1355, Accuracy: 6995/10000 (69.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5879, Accuracy: 6478/9900 (65.4343%)
Done in 286.59432339668274 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4627/4885 (94.7185%), train_poison_data_count: 385
Global model norm: 42.82437534889957.
Norm before scaling: 42.811684526905154. Distance: 1.575059387056217
Total norm for 4 adversaries is: 42.811684526905154. distance: 1.575059387056217
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2791, Accuracy: 9224/9900 (93.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4967/5305 (93.6287%), train_poison_data_count: 415
Global model norm: 42.82437534889957.
Norm before scaling: 42.81148350754955. Distance: 1.702936634531255
Total norm for 4 adversaries is: 42.81148350754955. distance: 1.702936634531255
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0593, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4406/4717 (93.4068%), train_poison_data_count: 370
Global model norm: 42.82437534889957.
Norm before scaling: 42.816535792900005. Distance: 1.6477188062300852
Total norm for 4 adversaries is: 42.816535792900005. distance: 1.6477188062300852
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0783, Accuracy: 9702/9900 (98.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4734/5066 (93.4465%), train_poison_data_count: 400
Global model norm: 42.82437534889957.
Norm before scaling: 42.81618369188805. Distance: 1.6821461271115963
Total norm for 4 adversaries is: 42.81618369188805. distance: 1.6821461271115963
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1840, Accuracy: 9441/9900 (95.3636%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5105/5582 (91.4547%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5034/5582 (90.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1289, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4159/4647 (89.4986%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4210/4647 (90.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9625, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4043/4465 (90.5487%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4122/4465 (92.3180%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8242, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4557/5083 (89.6518%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4469/5083 (87.9205%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1994, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3868/4416 (87.5906%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3941/4416 (89.2437%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8517, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4397/4956 (88.7207%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4398/4956 (88.7409%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1944, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4023/4362 (92.2283%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3910/4362 (89.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0322, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3951/4356 (90.7025%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3827/4356 (87.8558%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2304, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3417/3781 (90.3729%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3446/3781 (91.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0459, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3287/3590 (91.5599%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3301/3590 (91.9499%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9696, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4206/4651 (90.4322%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4275/4651 (91.9157%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9521, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4218/4662 (90.4762%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4259/4662 (91.3556%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8923, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3157/3472 (90.9274%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3241/3472 (93.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8756, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4901/5424 (90.3577%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4968/5424 (91.5929%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1970, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2960/3271 (90.4922%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2921/3271 (89.2999%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9750, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4485/5037 (89.0411%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4544/5037 (90.2124%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9227, Accuracy: 5615/10000 (56.1500%)
time spent on training: 260.84353494644165
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1353, Accuracy: 6979/10000 (69.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.5131, Accuracy: 6602/9900 (66.6869%)
Done in 288.51960587501526 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4628/4885 (94.7390%), train_poison_data_count: 385
Global model norm: 42.8462372773634.
Norm before scaling: 42.83821935035787. Distance: 1.5991098371502666
Total norm for 4 adversaries is: 42.83821935035787. distance: 1.5991098371502666
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1752, Accuracy: 9481/9900 (95.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4968/5305 (93.6475%), train_poison_data_count: 415
Global model norm: 42.8462372773634.
Norm before scaling: 42.836787419755375. Distance: 1.7302099167802958
Total norm for 4 adversaries is: 42.836787419755375. distance: 1.7302099167802958
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1051, Accuracy: 9629/9900 (97.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4428/4717 (93.8732%), train_poison_data_count: 370
Global model norm: 42.8462372773634.
Norm before scaling: 42.83422407320022. Distance: 1.5775096184487174
Total norm for 4 adversaries is: 42.83422407320022. distance: 1.5775096184487174
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1947, Accuracy: 9421/9900 (95.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4701/5066 (92.7951%), train_poison_data_count: 400
Global model norm: 42.8462372773634.
Norm before scaling: 42.841245482048315. Distance: 1.7718142840496787
Total norm for 4 adversaries is: 42.841245482048315. distance: 1.7718142840496787
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2585, Accuracy: 9282/9900 (93.7576%)
