current path: saved_models/model_cifar100_Dec.03_01.06.30_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43994636956511. Distance: 2.2937587436436613
Total norm for 4 adversaries is: 42.43994636956511. distance: 2.2937587436436613
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4435, Accuracy: 8825/9900 (89.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43536416523296. Distance: 2.2507729792020896
Total norm for 4 adversaries is: 42.43536416523296. distance: 2.2507729792020896
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7397, Accuracy: 8288/9900 (83.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4178/4717 (88.5732%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438693719403936. Distance: 2.177244396427209
Total norm for 4 adversaries is: 42.438693719403936. distance: 2.177244396427209
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4317, Accuracy: 8878/9900 (89.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4457/5066 (87.9787%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44035911760467. Distance: 2.3041790934866238
Total norm for 4 adversaries is: 42.44035911760467. distance: 2.3041790934866238
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6136, Accuracy: 8480/9900 (85.6566%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3839/4356 (88.1313%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3675/4356 (84.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4470, Accuracy: 4677/10000 (46.7700%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3934/4465 (88.1075%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4087/4465 (91.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0186, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4147/4647 (89.2404%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9587, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4450/5055 (88.0317%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4525/5055 (89.5153%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1417, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4453/5116 (87.0407%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4463/5116 (87.2361%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9850, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3631/4126 (88.0029%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3752/4126 (90.9355%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9594, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3084/3472 (88.8249%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3213/3472 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0823, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4430/4986 (88.8488%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4418/4986 (88.6081%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0456, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3536/4013 (88.1136%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8163, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4076/4618 (88.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0782, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4427/5083 (87.0942%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4447/5083 (87.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1037, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3971/4511 (88.0293%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4025/4511 (89.2263%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1946, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3331/3797 (87.7272%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3383/3797 (89.0967%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9963, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4996/5582 (89.5020%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5016/5582 (89.8603%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1837, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3221/3616 (89.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0997, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4833/5455 (88.5976%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4851/5455 (88.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9527, Accuracy: 5359/10000 (53.5900%)
time spent on training: 233.56312704086304
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1342, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.6337, Accuracy: 74/9900 (0.7475%)
Done in 256.81498098373413 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.46677958315255.
Norm before scaling: 42.47389191186304. Distance: 2.169456617467997
Total norm for 4 adversaries is: 42.47389191186304. distance: 2.169456617467997
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2084, Accuracy: 9353/9900 (94.4747%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4753/5305 (89.5947%), train_poison_data_count: 415
Global model norm: 42.46677958315255.
Norm before scaling: 42.47034236345111. Distance: 2.2107122191915356
Total norm for 4 adversaries is: 42.47034236345111. distance: 2.2107122191915356
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4826, Accuracy: 8719/9900 (88.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4183/4717 (88.6792%), train_poison_data_count: 370
Global model norm: 42.46677958315255.
Norm before scaling: 42.475011323295284. Distance: 2.2192267322134858
Total norm for 4 adversaries is: 42.475011323295284. distance: 2.2192267322134858
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1870, Accuracy: 9439/9900 (95.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4475/5066 (88.3340%), train_poison_data_count: 400
Global model norm: 42.46677958315255.
Norm before scaling: 42.47646263437773. Distance: 2.3397409355998016
Total norm for 4 adversaries is: 42.47646263437773. distance: 2.3397409355998016
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2196, Accuracy: 9312/9900 (94.0606%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3581/4025 (88.9689%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3721/4025 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9341, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3324/3797 (87.5428%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3409/3797 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0335, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3950/4625 (85.4054%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4038/4625 (87.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2301, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3870/4481 (86.3647%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3864/4481 (86.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1147, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3839/4315 (88.9687%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3973/4315 (92.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9985, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3704/4235 (87.4616%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3838/4235 (90.6257%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9442, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3351/3828 (87.5392%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3473/3828 (90.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9369, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3824/4416 (86.5942%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3973/4416 (89.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9229, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3148/3638 (86.5311%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3269/3638 (89.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9657, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4524/5265 (85.9259%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4568/5265 (86.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9996, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3345/3781 (88.4687%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3307/3781 (87.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1496, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3971/4441 (89.4168%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4007/4441 (90.2274%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1485, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3959/4433 (89.3075%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4026/4433 (90.8189%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9506, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4407/5083 (86.7008%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4449/5083 (87.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0359, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4323/4928 (87.7232%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4378/4928 (88.8393%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0557, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4155/4793 (86.6889%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4340/4793 (90.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0938, Accuracy: 5358/10000 (53.5800%)
time spent on training: 228.95754885673523
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1492, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.3816, Accuracy: 81/9900 (0.8182%)
Done in 252.33339619636536 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.498173214415935.
Norm before scaling: 42.500841558763575. Distance: 2.1287661445081634
Total norm for 4 adversaries is: 42.500841558763575. distance: 2.1287661445081634
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2164, Accuracy: 9338/9900 (94.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 42.498173214415935.
Norm before scaling: 42.50206940044581. Distance: 2.197548375904594
Total norm for 4 adversaries is: 42.50206940044581. distance: 2.197548375904594
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0698, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4203/4717 (89.1032%), train_poison_data_count: 370
Global model norm: 42.498173214415935.
Norm before scaling: 42.50264525315601. Distance: 2.1043892040855297
Total norm for 4 adversaries is: 42.50264525315601. distance: 2.1043892040855297
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2032, Accuracy: 9352/9900 (94.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4495/5066 (88.7288%), train_poison_data_count: 400
Global model norm: 42.498173214415935.
Norm before scaling: 42.50400946160844. Distance: 2.2589841132548916
Total norm for 4 adversaries is: 42.50400946160844. distance: 2.2589841132548916
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1597, Accuracy: 9468/9900 (95.6364%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3110/3616 (86.0066%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3290/3616 (90.9845%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8762, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3397/3837 (88.5327%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3493/3837 (91.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9805, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4144/4679 (88.5659%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4289/4679 (91.6649%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9800, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3074/3638 (84.4970%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3250/3638 (89.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1382, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3604/4046 (89.0756%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3633/4046 (89.7924%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0317, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3965/4518 (87.7601%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4083/4518 (90.3718%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0665, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3363/3797 (88.5699%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3408/3797 (89.7551%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0720, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4404/5025 (87.6418%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4473/5025 (89.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3713, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3896/4362 (89.3168%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3965/4362 (90.8987%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0991, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3974/4558 (87.1874%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3988/4558 (87.4945%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0713, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3207/3672 (87.3366%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3275/3672 (89.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0368, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4303/4874 (88.2848%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4344/4874 (89.1260%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1464, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3590/4025 (89.1925%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3704/4025 (92.0248%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8743, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4082/4663 (87.5402%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4265/4663 (91.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0647, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3421/3911 (87.4712%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3488/3911 (89.1844%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0351, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4422/5017 (88.1403%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4546/5017 (90.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8334, Accuracy: 5655/10000 (56.5500%)
time spent on training: 230.3373670578003
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1352, Accuracy: 6971/10000 (69.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.1969, Accuracy: 84/9900 (0.8485%)
Done in 253.71132349967957 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4387/4885 (89.8055%), train_poison_data_count: 385
Global model norm: 42.529941199553754.
Norm before scaling: 42.53556645987567. Distance: 2.142145549605484
Total norm for 4 adversaries is: 42.53556645987567. distance: 2.142145549605484
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5413, Accuracy: 8667/9900 (87.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4782/5305 (90.1414%), train_poison_data_count: 415
Global model norm: 42.529941199553754.
Norm before scaling: 42.53035737950159. Distance: 2.1600468695818345
Total norm for 4 adversaries is: 42.53035737950159. distance: 2.1600468695818345
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0849, Accuracy: 9667/9900 (97.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4234/4717 (89.7604%), train_poison_data_count: 370
Global model norm: 42.529941199553754.
Norm before scaling: 42.53185272350301. Distance: 2.0811697088110233
Total norm for 4 adversaries is: 42.53185272350301. distance: 2.0811697088110233
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1536, Accuracy: 9498/9900 (95.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 42.529941199553754.
Norm before scaling: 42.536364268191164. Distance: 2.2675294435517848
Total norm for 4 adversaries is: 42.536364268191164. distance: 2.2675294435517848
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3052, Accuracy: 9112/9900 (92.0404%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5239/6124 (85.5487%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5343/6124 (87.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1584, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3635/4356 (83.4481%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2694, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3488/4158 (83.8865%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3593/4158 (86.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1054, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5003/5455 (91.7140%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4982/5455 (91.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8887, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3885/4511 (86.1228%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4050/4511 (89.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0510, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4515/5232 (86.2959%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4543/5232 (86.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0501, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4488/5244 (85.5835%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4502/5244 (85.8505%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1451, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4365/4918 (88.7556%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4410/4918 (89.6706%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1072, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3612/4126 (87.5424%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3703/4126 (89.7479%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8459, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4318/4928 (87.6218%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0591, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3736/4223 (88.4679%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3847/4223 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9773, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4537/5195 (87.3340%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4622/5195 (88.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1172, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4112/4679 (87.8820%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4147/4679 (88.6300%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9414, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3202/3646 (87.8223%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3300/3646 (90.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9134, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3167/3616 (87.5830%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3209/3616 (88.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9049, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4055/4716 (85.9839%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4112/4716 (87.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0377, Accuracy: 5332/10000 (53.3200%)
time spent on training: 234.5408980846405
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.1483, Accuracy: 6975/10000 (69.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 9.1877, Accuracy: 90/9900 (0.9091%)
Done in 257.9813406467438 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 42.56589847390308.
Norm before scaling: 42.57109747051102. Distance: 2.14240575077889
Total norm for 4 adversaries is: 42.57109747051102. distance: 2.14240575077889
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1220, Accuracy: 9588/9900 (96.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4807/5305 (90.6126%), train_poison_data_count: 415
Global model norm: 42.56589847390308.
Norm before scaling: 42.560576945818504. Distance: 2.121246276204803
Total norm for 4 adversaries is: 42.560576945818504. distance: 2.121246276204803
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1088, Accuracy: 9623/9900 (97.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4232/4717 (89.7180%), train_poison_data_count: 370
Global model norm: 42.56589847390308.
Norm before scaling: 42.567563196916. Distance: 2.0891114279838487
Total norm for 4 adversaries is: 42.567563196916. distance: 2.0891114279838487
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1815, Accuracy: 9445/9900 (95.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4489/5066 (88.6103%), train_poison_data_count: 400
Global model norm: 42.56589847390308.
Norm before scaling: 42.57554894730146. Distance: 2.28824629569715
Total norm for 4 adversaries is: 42.57554894730146. distance: 2.28824629569715
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2295, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5260/6124 (85.8916%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5351/6124 (87.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9528, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3956/4433 (89.2398%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3981/4433 (89.8037%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9961, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3367/3781 (89.0505%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3117/3781 (82.4385%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3368, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3540/3969 (89.1912%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3557/3969 (89.6196%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0358, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4427/5025 (88.0995%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4533/5025 (90.2090%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1026, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4147/4679 (88.6300%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4224/4679 (90.2757%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0348, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4138/4707 (87.9116%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4201/4707 (89.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9465, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4398/4986 (88.2070%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4471/4986 (89.6711%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9137, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3890/4315 (90.1506%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3934/4315 (91.1703%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8990, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3826/4416 (86.6395%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3916/4416 (88.6775%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9562, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4197/4804 (87.3647%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4139/4804 (86.1574%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1573, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4263/4793 (88.9422%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4315/4793 (90.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0203, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4504/5232 (86.0856%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4588/5232 (87.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9532, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4099/4662 (87.9236%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4205/4662 (90.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0543, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4209/4956 (84.9274%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4300/4956 (86.7635%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2398, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3807/4368 (87.1566%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3828/4368 (87.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9125, Accuracy: 5490/10000 (54.9000%)
time spent on training: 236.28662204742432
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.1507, Accuracy: 6962/10000 (69.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.0836, Accuracy: 104/9900 (1.0505%)
Done in 259.79344725608826 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 42.59570021443259.
Norm before scaling: 42.6011835498. Distance: 2.170168308991117
Total norm for 4 adversaries is: 42.6011835498. distance: 2.170168308991117
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2587, Accuracy: 9241/9900 (93.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 42.59570021443259.
Norm before scaling: 42.59325419282231. Distance: 2.1426720403015573
Total norm for 4 adversaries is: 42.59325419282231. distance: 2.1426720403015573
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1878, Accuracy: 9427/9900 (95.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 42.59570021443259.
Norm before scaling: 42.59425869789774. Distance: 2.0505872071517763
Total norm for 4 adversaries is: 42.59425869789774. distance: 2.0505872071517763
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1617, Accuracy: 9472/9900 (95.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4510/5066 (89.0249%), train_poison_data_count: 400
Global model norm: 42.59570021443259.
Norm before scaling: 42.60482534382842. Distance: 2.2390713720152537
Total norm for 4 adversaries is: 42.60482534382842. distance: 2.2390713720152537
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1596, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5283/6124 (86.2671%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5364/6124 (87.5898%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2333, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5094/5902 (86.3097%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5120/5902 (86.7503%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0109, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4161/4707 (88.4003%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4223/4707 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9825, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4046/4647 (87.0669%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4148/4647 (89.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9628, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2943/3297 (89.2630%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3040/3297 (92.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8081, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5550/6263 (88.6157%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5658/6263 (90.3401%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2527, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4169/4663 (89.4060%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4280/4663 (91.7864%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1863, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4295/4956 (86.6626%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4337/4956 (87.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2014, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3599/4046 (88.9521%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3690/4046 (91.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9534, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3667/4184 (87.6434%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3788/4184 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8800, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4868/5591 (87.0685%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4905/5591 (87.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1829, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4059/4634 (87.5917%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4140/4634 (89.3397%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9708, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3353/3828 (87.5914%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3498/3828 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9361, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3131/3638 (86.0638%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3269/3638 (89.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9060, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3359/3781 (88.8389%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3326/3781 (87.9661%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1234, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3395/3837 (88.4806%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3503/3837 (91.2953%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9260, Accuracy: 5577/10000 (55.7700%)
time spent on training: 235.67583966255188
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1627, Accuracy: 6933/10000 (69.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 9.1121, Accuracy: 91/9900 (0.9192%)
Done in 259.08659410476685 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4380/4885 (89.6622%), train_poison_data_count: 385
Global model norm: 42.61912017272148.
Norm before scaling: 42.62404633738889. Distance: 2.131237076974658
Total norm for 4 adversaries is: 42.62404633738889. distance: 2.131237076974658
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2822, Accuracy: 9244/9900 (93.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 42.61912017272148.
Norm before scaling: 42.621398594650344. Distance: 2.182742804340984
Total norm for 4 adversaries is: 42.621398594650344. distance: 2.182742804340984
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1617, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 42.61912017272148.
Norm before scaling: 42.62302821456598. Distance: 2.0987316479315066
Total norm for 4 adversaries is: 42.62302821456598. distance: 2.0987316479315066
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1993, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 42.61912017272148.
Norm before scaling: 42.6231356126356. Distance: 2.199692669989884
Total norm for 4 adversaries is: 42.6231356126356. distance: 2.199692669989884
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1957, Accuracy: 9406/9900 (95.0101%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3887/4501 (86.3586%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3927/4501 (87.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0819, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3660/4175 (87.6647%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3764/4175 (90.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9630, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3141/3616 (86.8639%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3225/3616 (89.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8968, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4019/4634 (86.7285%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4096/4634 (88.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9420, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4010/4558 (87.9772%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3993/4558 (87.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1784, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4545/5167 (87.9621%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4637/5167 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1507, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3872/4356 (88.8889%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3800/4356 (87.2360%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2616, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4207/4716 (89.2070%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4238/4716 (89.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9659, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5342/6124 (87.2306%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5303/6124 (86.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9386, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4432/5055 (87.6756%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4585/5055 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0983, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4476/5025 (89.0746%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4542/5025 (90.3881%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0414, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4347/4918 (88.3896%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4403/4918 (89.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1601, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3717/4223 (88.0180%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3766/4223 (89.1783%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0728, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3872/4481 (86.4093%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3825/4481 (85.3604%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0091, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3204/3638 (88.0704%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3279/3638 (90.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0212, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3561/4013 (88.7366%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3680/4013 (91.7020%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8706, Accuracy: 5672/10000 (56.7200%)
time spent on training: 233.00827813148499
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1546, Accuracy: 6964/10000 (69.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.3376, Accuracy: 73/9900 (0.7374%)
Done in 256.54959201812744 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4378/4885 (89.6213%), train_poison_data_count: 385
Global model norm: 42.64306830440397.
Norm before scaling: 42.64672655823437. Distance: 2.108750879709256
Total norm for 4 adversaries is: 42.64672655823437. distance: 2.108750879709256
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2845, Accuracy: 9189/9900 (92.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 42.64306830440397.
Norm before scaling: 42.64380112529912. Distance: 2.2070961731670513
Total norm for 4 adversaries is: 42.64380112529912. distance: 2.2070961731670513
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2538, Accuracy: 9294/9900 (93.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4227/4717 (89.6120%), train_poison_data_count: 370
Global model norm: 42.64306830440397.
Norm before scaling: 42.64526959176935. Distance: 2.053505677301971
Total norm for 4 adversaries is: 42.64526959176935. distance: 2.053505677301971
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3486, Accuracy: 9057/9900 (91.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 42.64306830440397.
Norm before scaling: 42.649138028914194. Distance: 2.2259141479963884
Total norm for 4 adversaries is: 42.649138028914194. distance: 2.2259141479963884
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1478, Accuracy: 9489/9900 (95.8485%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3186/3646 (87.3834%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3284/3646 (90.0713%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8457, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3906/4501 (86.7807%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4010/4501 (89.0913%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1501, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4101/4651 (88.1746%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4186/4651 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9698, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4573/5167 (88.5040%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4640/5167 (89.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0448, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4950/5455 (90.7424%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4900/5455 (89.8258%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0498, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4873/5591 (87.1579%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4875/5591 (87.1937%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0604, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4180/4679 (89.3353%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4104/4679 (87.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0391, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4542/5017 (90.5322%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4594/5017 (91.5687%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8864, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4332/4793 (90.3818%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4366/4793 (91.0912%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1012, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3997/4456 (89.6993%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4073/4456 (91.4048%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8867, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4806/5424 (88.6062%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4932/5424 (90.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2768, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3618/4175 (86.6587%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3667/4175 (87.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0036, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4543/5116 (88.7998%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4570/5116 (89.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9589, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3290/3704 (88.8229%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3355/3704 (90.5778%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9766, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4504/5232 (86.0856%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4594/5232 (87.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1566, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3073/3472 (88.5081%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0739, Accuracy: 5389/10000 (53.8900%)
time spent on training: 233.40655946731567
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1477, Accuracy: 6957/10000 (69.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.2594, Accuracy: 80/9900 (0.8081%)
Done in 256.6376705169678 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4404/4885 (90.1535%), train_poison_data_count: 385
Global model norm: 42.662546753655164.
Norm before scaling: 42.664921565925354. Distance: 2.095095643293432
Total norm for 4 adversaries is: 42.664921565925354. distance: 2.095095643293432
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3778, Accuracy: 8952/9900 (90.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.662546753655164.
Norm before scaling: 42.663382244851526. Distance: 2.1767034853303553
Total norm for 4 adversaries is: 42.663382244851526. distance: 2.1767034853303553
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1719, Accuracy: 9481/9900 (95.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4224/4717 (89.5484%), train_poison_data_count: 370
Global model norm: 42.662546753655164.
Norm before scaling: 42.66407322948959. Distance: 2.0528430855490925
Total norm for 4 adversaries is: 42.66407322948959. distance: 2.0528430855490925
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1744, Accuracy: 9467/9900 (95.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4490/5066 (88.6301%), train_poison_data_count: 400
Global model norm: 42.662546753655164.
Norm before scaling: 42.67010134541662. Distance: 2.228905873477448
Total norm for 4 adversaries is: 42.67010134541662. distance: 2.228905873477448
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3173, Accuracy: 9073/9900 (91.6465%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3213/3590 (89.4986%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3304/3590 (92.0334%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0675, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3916/4368 (89.6520%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3953/4368 (90.4991%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8593, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3282/3704 (88.6069%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3364/3704 (90.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9178, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4348/4928 (88.2305%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4339/4928 (88.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0519, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3864/4356 (88.7052%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3876/4356 (88.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0649, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3447/3911 (88.1360%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3315/3911 (84.7609%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1550, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4097/4651 (88.0886%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4155/4651 (89.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1683, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3721/4184 (88.9340%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3744/4184 (89.4837%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9324, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3909/4346 (89.9448%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3998/4346 (91.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8617, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4267/4793 (89.0257%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4368/4793 (91.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9927, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3383/3804 (88.9327%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3519/3804 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9062, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4437/4986 (88.9892%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4483/4986 (89.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9552, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5315/6124 (86.7897%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5339/6124 (87.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0696, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4121/4707 (87.5505%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4261/4707 (90.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0207, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3792/4235 (89.5396%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3683/4235 (86.9658%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0646, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3639/4046 (89.9407%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3676/4046 (90.8552%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0775, Accuracy: 5236/10000 (52.3600%)
time spent on training: 232.45318746566772
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1473, Accuracy: 6936/10000 (69.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.0477, Accuracy: 70/9900 (0.7071%)
Done in 255.8640627861023 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 42.68558257727002.
Norm before scaling: 42.68785173262851. Distance: 2.0975354264624215
Total norm for 4 adversaries is: 42.68785173262851. distance: 2.0975354264624215
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1272, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 42.68558257727002.
Norm before scaling: 42.69091997647158. Distance: 2.1955016791125077
Total norm for 4 adversaries is: 42.69091997647158. distance: 2.1955016791125077
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1072, Accuracy: 9630/9900 (97.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.68558257727002.
Norm before scaling: 42.68568695820357. Distance: 2.046476252496586
Total norm for 4 adversaries is: 42.68568695820357. distance: 2.046476252496586
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3878, Accuracy: 8973/9900 (90.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4499/5066 (88.8077%), train_poison_data_count: 400
Global model norm: 42.68558257727002.
Norm before scaling: 42.69345904600024. Distance: 2.2457646667891615
Total norm for 4 adversaries is: 42.69345904600024. distance: 2.2457646667891615
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3118, Accuracy: 9124/9900 (92.1616%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4403/4986 (88.3073%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4491/4986 (90.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0075, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4023/4634 (86.8148%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4138/4634 (89.2965%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9504, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4247/4716 (90.0551%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4261/4716 (90.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0021, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5269/6124 (86.0385%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5398/6124 (88.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0698, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4473/4918 (90.9516%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0668, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3379/3797 (88.9913%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3439/3797 (90.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9845, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4977/5582 (89.1616%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5011/5582 (89.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0651, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4296/4956 (86.6828%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4369/4956 (88.1558%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0578, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3970/4433 (89.5556%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4003/4433 (90.3000%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9001, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3822/4354 (87.7814%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3408/4354 (78.2729%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4873, Accuracy: 4576/10000 (45.7600%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4291/4928 (87.0739%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4390/4928 (89.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9179, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3447/3911 (88.1360%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3482/3911 (89.0309%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0015, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0087, Accuracy: 3818/4481 (85.2042%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3825/4481 (85.3604%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1176, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4583/5197 (88.1855%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4635/5197 (89.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9751, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4876/5455 (89.3859%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4912/5455 (90.0458%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9898, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3804/4361 (87.2277%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3762/4361 (86.2646%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1709, Accuracy: 5088/10000 (50.8800%)
time spent on training: 237.52864384651184
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1537, Accuracy: 6919/10000 (69.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.0294, Accuracy: 87/9900 (0.8788%)
Done in 261.0865070819855 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.72018445835938.
Norm before scaling: 42.72509897040907. Distance: 2.093153683593168
Total norm for 4 adversaries is: 42.72509897040907. distance: 2.093153683593168
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1774, Accuracy: 9474/9900 (95.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.72018445835938.
Norm before scaling: 42.72054449413069. Distance: 2.1310728474933094
Total norm for 4 adversaries is: 42.72054449413069. distance: 2.1310728474933094
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2170, Accuracy: 9356/9900 (94.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4235/4717 (89.7816%), train_poison_data_count: 370
Global model norm: 42.72018445835938.
Norm before scaling: 42.721078827340904. Distance: 2.0430687611828295
Total norm for 4 adversaries is: 42.721078827340904. distance: 2.0430687611828295
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1336, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4501/5066 (88.8472%), train_poison_data_count: 400
Global model norm: 42.72018445835938.
Norm before scaling: 42.72666178106037. Distance: 2.250092292588194
Total norm for 4 adversaries is: 42.72666178106037. distance: 2.250092292588194
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2448, Accuracy: 9289/9900 (93.8283%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4315/4928 (87.5609%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4389/4928 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9564, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3739/4184 (89.3642%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8661, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4204/4707 (89.3138%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4241/4707 (90.0999%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9706, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3394/3828 (88.6625%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8803, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3939/4503 (87.4750%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4034/4503 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9628, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4149/4662 (88.9961%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4233/4662 (90.7979%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9872, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3723/4235 (87.9103%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3802/4235 (89.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0104, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4400/5244 (83.9054%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4500/5244 (85.8124%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0822, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4266/4793 (89.0048%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4371/4793 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9966, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3917/4481 (87.4135%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3863/4481 (86.2084%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1064, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3904/4346 (89.8297%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3998/4346 (91.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7899, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3928/4361 (90.0711%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3808/4361 (87.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1786, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4521/5055 (89.4362%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4546/5055 (89.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0059, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4535/5195 (87.2955%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4541/5195 (87.4110%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1486, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3906/4315 (90.5214%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3980/4315 (92.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0099, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4158/4663 (89.1701%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4230/4663 (90.7141%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0801, Accuracy: 5276/10000 (52.7600%)
time spent on training: 234.24300169944763
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1560, Accuracy: 6946/10000 (69.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.3401, Accuracy: 45/9900 (0.4545%)
Done in 257.64246106147766 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.748455175852555.
Norm before scaling: 42.75379757438221. Distance: 2.0839764810285706
Total norm for 4 adversaries is: 42.75379757438221. distance: 2.0839764810285706
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2066, Accuracy: 9389/9900 (94.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 42.748455175852555.
Norm before scaling: 42.751884552759776. Distance: 2.164422951986947
Total norm for 4 adversaries is: 42.751884552759776. distance: 2.164422951986947
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3319, Accuracy: 9100/9900 (91.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 42.748455175852555.
Norm before scaling: 42.74813535315751. Distance: 2.009896706920894
Total norm for 4 adversaries is: 42.74813535315751. distance: 2.009896706920894
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1837, Accuracy: 9432/9900 (95.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4540/5066 (89.6171%), train_poison_data_count: 400
Global model norm: 42.748455175852555.
Norm before scaling: 42.753112322745. Distance: 2.187032595153905
Total norm for 4 adversaries is: 42.753112322745. distance: 2.187032595153905
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2141, Accuracy: 9331/9900 (94.2525%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3915/4315 (90.7300%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3968/4315 (91.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8949, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3236/3590 (90.1393%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3188/3590 (88.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1254, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4177/4679 (89.2712%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4220/4679 (90.1902%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0094, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4608/5167 (89.1813%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4659/5167 (90.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0802, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3362/3775 (89.0596%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3493/3775 (92.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8478, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3386/3828 (88.4535%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3488/3828 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8017, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3734/4235 (88.1700%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3837/4235 (90.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0054, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4090/4647 (88.0138%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4217/4647 (90.7467%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9615, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4350/4918 (88.4506%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4426/4918 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0474, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3958/4433 (89.2849%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4010/4433 (90.4579%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9923, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3905/4481 (87.1457%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3898/4481 (86.9895%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2442, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3785/4295 (88.1257%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3763/4295 (87.6135%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1828, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3970/4503 (88.1634%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3988/4503 (88.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0277, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3792/4354 (87.0923%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3665/4354 (84.1755%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2456, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4424/4986 (88.7284%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4425/4986 (88.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0592, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5578/6263 (89.0627%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5739/6263 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1286, Accuracy: 5200/10000 (52.0000%)
time spent on training: 232.93816447257996
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1460, Accuracy: 6930/10000 (69.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.3521, Accuracy: 64/9900 (0.6465%)
Done in 256.1405565738678 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 42.78557975487696.
Norm before scaling: 42.78793775338442. Distance: 2.1236612927623257
Total norm for 4 adversaries is: 42.78793775338442. distance: 2.1236612927623257
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1878, Accuracy: 9453/9900 (95.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 42.78557975487696.
Norm before scaling: 42.790093075730596. Distance: 2.257283713117411
Total norm for 4 adversaries is: 42.790093075730596. distance: 2.257283713117411
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0737, Accuracy: 9712/9900 (98.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.78557975487696.
Norm before scaling: 42.78688073564066. Distance: 2.0339574523046555
Total norm for 4 adversaries is: 42.78688073564066. distance: 2.0339574523046555
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1309, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4526/5066 (89.3407%), train_poison_data_count: 400
Global model norm: 42.78557975487696.
Norm before scaling: 42.78994758419099. Distance: 2.2111942425259548
Total norm for 4 adversaries is: 42.78994758419099. distance: 2.2111942425259548
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0759, Accuracy: 9699/9900 (97.9697%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3724/4223 (88.1838%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3876/4223 (91.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9614, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4954/5455 (90.8158%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4858/5455 (89.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1195, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5032/5582 (90.1469%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5029/5582 (90.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2221, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4005/4465 (89.6976%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4063/4465 (90.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8230, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4900/5591 (87.6409%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4924/5591 (88.0701%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3435, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3482/3911 (89.0309%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3341/3911 (85.4257%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0082, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3894/4356 (89.3939%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3684/4356 (84.5730%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3446, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4420/5037 (87.7506%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4496/5037 (89.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9818, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4165/4679 (89.0147%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4237/4679 (90.5535%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1187, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3967/4362 (90.9445%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3966/4362 (90.9216%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0573, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4066/4518 (89.9956%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4151/4518 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0333, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4459/5083 (87.7238%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4473/5083 (87.9992%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2541, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3634/4013 (90.5557%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3737/4013 (93.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8504, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4572/5197 (87.9738%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4646/5197 (89.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1644, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2937/3297 (89.0810%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3036/3297 (92.0837%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7951, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3989/4441 (89.8221%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4062/4441 (91.4659%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0452, Accuracy: 5446/10000 (54.4600%)
time spent on training: 235.24101567268372
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1562, Accuracy: 6931/10000 (69.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.4216, Accuracy: 55/9900 (0.5556%)
Done in 258.4994578361511 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.81247148721678.
Norm before scaling: 42.8128578338148. Distance: 2.0994322236312115
Total norm for 4 adversaries is: 42.8128578338148. distance: 2.0994322236312115
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2371, Accuracy: 9328/9900 (94.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 42.81247148721678.
Norm before scaling: 42.812159270998144. Distance: 2.156564993586727
Total norm for 4 adversaries is: 42.812159270998144. distance: 2.156564993586727
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2564, Accuracy: 9315/9900 (94.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 42.81247148721678.
Norm before scaling: 42.81177006677019. Distance: 2.0092402625109615
Total norm for 4 adversaries is: 42.81177006677019. distance: 2.0092402625109615
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.4147, Accuracy: 8886/9900 (89.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 42.81247148721678.
Norm before scaling: 42.815324097092414. Distance: 2.2113267535684007
Total norm for 4 adversaries is: 42.815324097092414. distance: 2.2113267535684007
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2175, Accuracy: 9332/9900 (94.2626%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3992/4501 (88.6914%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4058/4501 (90.1577%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1036, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3987/4511 (88.3840%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4069/4511 (90.2017%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9574, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3838/4354 (88.1488%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0106, Accuracy: 3510/4354 (80.6155%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5079, Accuracy: 4459/10000 (44.5900%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3923/4346 (90.2669%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4017/4346 (92.4298%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8834, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4194/4707 (89.1013%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4251/4707 (90.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9820, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4888/5591 (87.4262%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4899/5591 (87.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9555, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4073/4647 (87.6479%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4146/4647 (89.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9591, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4089/4538 (90.1058%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4200/4538 (92.5518%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8815, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4352/4934 (88.2043%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4367/4934 (88.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9976, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4294/4804 (89.3838%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4163/4804 (86.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1244, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5761/6263 (91.9847%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5701/6263 (91.0267%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1669, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3917/4481 (87.4135%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3932/4481 (87.7483%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1702, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4413/5063 (87.1618%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4395/5063 (86.8062%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0056, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3718/4223 (88.0417%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3878/4223 (91.8305%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8743, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4111/4441 (92.5692%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4160/4441 (93.6726%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8684, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3388/3756 (90.2023%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3492/3756 (92.9712%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9028, Accuracy: 5682/10000 (56.8200%)
time spent on training: 236.83522653579712
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1636, Accuracy: 6905/10000 (69.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.4171, Accuracy: 61/9900 (0.6162%)
Done in 260.33438777923584 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4418/4885 (90.4401%), train_poison_data_count: 385
Global model norm: 42.83414000309435.
Norm before scaling: 42.83767650468817. Distance: 2.1094344519254955
Total norm for 4 adversaries is: 42.83767650468817. distance: 2.1094344519254955
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1562, Accuracy: 9515/9900 (96.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4802/5305 (90.5184%), train_poison_data_count: 415
Global model norm: 42.83414000309435.
Norm before scaling: 42.83295587949774. Distance: 2.19431007821601
Total norm for 4 adversaries is: 42.83295587949774. distance: 2.19431007821601
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0655, Accuracy: 9729/9900 (98.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4246/4717 (90.0148%), train_poison_data_count: 370
Global model norm: 42.83414000309435.
Norm before scaling: 42.83570738470928. Distance: 2.0239137067078
Total norm for 4 adversaries is: 42.83570738470928. distance: 2.0239137067078
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3618, Accuracy: 9009/9900 (91.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4568/5066 (90.1698%), train_poison_data_count: 400
Global model norm: 42.83414000309435.
Norm before scaling: 42.836992594839245. Distance: 2.1579792994088813
Total norm for 4 adversaries is: 42.836992594839245. distance: 2.1579792994088813
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3379, Accuracy: 9074/9900 (91.6566%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4431/5244 (84.4966%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4512/5244 (86.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0622, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4344/4928 (88.1494%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4451/4928 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8587, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3374/3804 (88.6961%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3459/3804 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8805, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3679/4013 (91.6770%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3724/4013 (92.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.7831, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3576/4158 (86.0029%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3621/4158 (87.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9910, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5023/5582 (89.9857%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5013/5582 (89.8065%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1439, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4921/5455 (90.2108%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4936/5455 (90.4858%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9497, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3836/4354 (88.1029%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3608/4354 (82.8663%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.6624, Accuracy: 4617/10000 (46.1700%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3971/4433 (89.5782%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3998/4433 (90.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9274, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3201/3646 (87.7948%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3326/3646 (91.2233%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9190, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4055/4518 (89.7521%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4091/4518 (90.5489%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9791, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3808/4235 (89.9174%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3719/4235 (87.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3337, Accuracy: 4903/10000 (49.0300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3957/4362 (90.7153%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3888/4362 (89.1334%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0281, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4820/5392 (89.3917%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4711/5392 (87.3702%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2170, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4890/5591 (87.4620%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4888/5591 (87.4262%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2491, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3481/3756 (92.6784%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3511/3756 (93.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9646, Accuracy: 5612/10000 (56.1200%)
time spent on training: 233.0974841117859
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1738, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 9.4045, Accuracy: 74/9900 (0.7475%)
Done in 256.57594990730286 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.85404149050953.
Norm before scaling: 42.85965839087862. Distance: 2.1356872635255963
Total norm for 4 adversaries is: 42.85965839087862. distance: 2.1356872635255963
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1358, Accuracy: 9531/9900 (96.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 42.85404149050953.
Norm before scaling: 42.85486612721186. Distance: 2.2148932665044687
Total norm for 4 adversaries is: 42.85486612721186. distance: 2.2148932665044687
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0152, Accuracy: 9847/9900 (99.4646%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 42.85404149050953.
Norm before scaling: 42.856042524472265. Distance: 2.0384467938281614
Total norm for 4 adversaries is: 42.856042524472265. distance: 2.0384467938281614
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1402, Accuracy: 9542/9900 (96.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 42.85404149050953.
Norm before scaling: 42.86066519658497. Distance: 2.2805669101500055
Total norm for 4 adversaries is: 42.86066519658497. distance: 2.2805669101500055
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1118, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4124/4634 (88.9944%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4161/4634 (89.7928%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9571, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4025/4503 (89.3849%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3994/4503 (88.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0123, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4301/4928 (87.2768%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4432/4928 (89.9351%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7797, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3367/3804 (88.5121%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3427/3804 (90.0894%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0220, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3242/3590 (90.3064%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3093/3590 (86.1560%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3084, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4090/4647 (88.0138%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4238/4647 (91.1986%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8974, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3986/4625 (86.1838%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4054/4625 (87.6541%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1026, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3875/4356 (88.9578%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3877/4356 (89.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0576, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3382/3797 (89.0703%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3492/3797 (91.9673%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9446, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3974/4456 (89.1831%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9237, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3582/4025 (88.9938%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3697/4025 (91.8509%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8336, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3225/3472 (92.8859%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3219/3472 (92.7131%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9199, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2920/3297 (88.5654%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3014/3297 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9505, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3860/4416 (87.4094%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3958/4416 (89.6286%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9418, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3887/4356 (89.2332%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3940/4356 (90.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0965, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3162/3638 (86.9159%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8616, Accuracy: 5579/10000 (55.7900%)
time spent on training: 249.08856844902039
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1744, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 9.3117, Accuracy: 97/9900 (0.9798%)
Done in 275.8707525730133 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4885 (89.8260%), train_poison_data_count: 385
Global model norm: 42.87525054591518.
Norm before scaling: 42.883100717513855. Distance: 2.193036729107573
Total norm for 4 adversaries is: 42.883100717513855. distance: 2.193036729107573
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2138, Accuracy: 9394/9900 (94.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4795/5305 (90.3864%), train_poison_data_count: 415
Global model norm: 42.87525054591518.
Norm before scaling: 42.87868971004128. Distance: 2.1883298117422147
Total norm for 4 adversaries is: 42.87868971004128. distance: 2.1883298117422147
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2107, Accuracy: 9372/9900 (94.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.87525054591518.
Norm before scaling: 42.872191223139474. Distance: 2.0269699781139563
Total norm for 4 adversaries is: 42.872191223139474. distance: 2.0269699781139563
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1883, Accuracy: 9418/9900 (95.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 42.87525054591518.
Norm before scaling: 42.8811593038503. Distance: 2.2011766408278044
Total norm for 4 adversaries is: 42.8811593038503. distance: 2.2011766408278044
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1323, Accuracy: 9569/9900 (96.6566%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3695/4175 (88.5030%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3779/4175 (90.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8591, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4311/4956 (86.9855%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4396/4956 (88.7006%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9913, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4422/5037 (87.7904%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8896, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4295/4793 (89.6098%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1306, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3354/3804 (88.1703%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3401/3804 (89.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1329, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4819/5392 (89.3731%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4817/5392 (89.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0259, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4036/4465 (90.3919%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4116/4465 (92.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8972, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4123/4596 (89.7084%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4199/4596 (91.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9797, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5266/6124 (85.9895%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5386/6124 (87.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9928, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2916/3271 (89.1470%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0054, Accuracy: 2946/3271 (90.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9614, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3209/3590 (89.3872%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3197/3590 (89.0529%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0809, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3933/4501 (87.3806%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3952/4501 (87.8027%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0509, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4589/5232 (87.7102%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4594/5232 (87.8058%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0892, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3249/3672 (88.4804%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3280/3672 (89.3246%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1024, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3790/4223 (89.7466%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3836/4223 (90.8359%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0906, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3846/4354 (88.3326%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0149, Accuracy: 3175/4354 (72.9215%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.6298, Accuracy: 4393/10000 (43.9300%)
time spent on training: 260.7475619316101
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.2346, Accuracy: 6808/10000 (68.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 8.5253, Accuracy: 228/9900 (2.3030%)
Done in 287.78706645965576 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 42.92656025347608.
Norm before scaling: 42.92850245748374. Distance: 2.0648310810671813
Total norm for 4 adversaries is: 42.92850245748374. distance: 2.0648310810671813
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2703, Accuracy: 9262/9900 (93.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4790/5305 (90.2922%), train_poison_data_count: 415
Global model norm: 42.92656025347608.
Norm before scaling: 42.92575974411373. Distance: 2.146490706207963
Total norm for 4 adversaries is: 42.92575974411373. distance: 2.146490706207963
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1322, Accuracy: 9562/9900 (96.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.92656025347608.
Norm before scaling: 42.93049717730538. Distance: 2.144585391613635
Total norm for 4 adversaries is: 42.93049717730538. distance: 2.144585391613635
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0700, Accuracy: 9713/9900 (98.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4525/5066 (89.3210%), train_poison_data_count: 400
Global model norm: 42.92656025347608.
Norm before scaling: 42.933329150592606. Distance: 2.21344358937515
Total norm for 4 adversaries is: 42.933329150592606. distance: 2.21344358937515
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1200, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5014/5582 (89.8244%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5047/5582 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0601, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4041/4647 (86.9593%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4228/4647 (90.9834%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9762, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3988/4465 (89.3169%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4124/4465 (92.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8994, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4443/5083 (87.4090%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4409/5083 (86.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1109, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3783/4416 (85.6658%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3963/4416 (89.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9047, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4285/4956 (86.4609%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4339/4956 (87.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1077, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3951/4362 (90.5777%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3900/4362 (89.4085%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9209, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3836/4356 (88.0624%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3840/4356 (88.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2354, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3346/3781 (88.4951%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3421/3781 (90.4787%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0500, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3204/3590 (89.2479%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3272/3590 (91.1421%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9884, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4112/4651 (88.4111%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4213/4651 (90.5827%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9966, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4147/4662 (88.9532%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4247/4662 (91.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9626, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3168/3472 (91.2442%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3248/3472 (93.5484%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8824, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4836/5424 (89.1593%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4917/5424 (90.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0701, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2894/3271 (88.4745%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0062, Accuracy: 2868/3271 (87.6796%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0470, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4412/5037 (87.5918%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4548/5037 (90.2918%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9137, Accuracy: 5559/10000 (55.5900%)
time spent on training: 259.962167263031
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.2350, Accuracy: 6792/10000 (67.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 8.6867, Accuracy: 185/9900 (1.8687%)
Done in 286.8114104270935 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4437/4885 (90.8291%), train_poison_data_count: 385
Global model norm: 42.95618850479375.
Norm before scaling: 42.95828423680714. Distance: 2.100895658862546
Total norm for 4 adversaries is: 42.95828423680714. distance: 2.100895658862546
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2149, Accuracy: 9332/9900 (94.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.95618850479375.
Norm before scaling: 42.959547309976685. Distance: 2.1978927056571833
Total norm for 4 adversaries is: 42.959547309976685. distance: 2.1978927056571833
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1803, Accuracy: 9428/9900 (95.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 42.95618850479375.
Norm before scaling: 42.95005559240436. Distance: 1.9571017863645115
Total norm for 4 adversaries is: 42.95005559240436. distance: 1.9571017863645115
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3355, Accuracy: 9065/9900 (91.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 42.95618850479375.
Norm before scaling: 42.9619213323882. Distance: 2.2015015593000578
Total norm for 4 adversaries is: 42.9619213323882. distance: 2.2015015593000578
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.4622, Accuracy: 8787/9900 (88.7576%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4356/4989 (87.3121%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4481/4989 (89.8176%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8944, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3667/4013 (91.3780%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3755/4013 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7101, Accuracy: 5963/10000 (59.6300%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4580/5195 (88.1617%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4483/5195 (86.2945%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0551, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3522/3969 (88.7377%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3552/3969 (89.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9796, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3923/4356 (90.0597%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3806/4356 (87.3737%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1779, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4068/4441 (91.6010%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4099/4441 (92.2990%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9829, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4033/4518 (89.2652%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4153/4518 (91.9212%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9769, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3446/3911 (88.1105%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3199/3911 (81.7949%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2170, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3929/4362 (90.0734%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3844/4362 (88.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2445, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3373/3804 (88.6698%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3472/3804 (91.2723%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9580, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3760/4223 (89.0362%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3879/4223 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9172, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4115/4634 (88.8002%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4191/4634 (90.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8589, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3953/4354 (90.7901%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0120, Accuracy: 3395/4354 (77.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.5852, Accuracy: 4411/10000 (44.1100%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4427/5244 (84.4203%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4564/5244 (87.0328%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8902, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4519/5037 (89.7161%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4627/5037 (91.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9645, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3238/3704 (87.4190%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3348/3704 (90.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9072, Accuracy: 5480/10000 (54.8000%)
time spent on training: 260.1168532371521
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.2293, Accuracy: 6781/10000 (67.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.7385, Accuracy: 154/9900 (1.5556%)
Done in 287.1095435619354 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 42.980400409209054.
Norm before scaling: 42.98441475825133. Distance: 2.097641815192711
Total norm for 4 adversaries is: 42.98441475825133. distance: 2.097641815192711
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1610, Accuracy: 9494/9900 (95.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4770/5305 (89.9152%), train_poison_data_count: 415
Global model norm: 42.980400409209054.
Norm before scaling: 42.98500544793934. Distance: 2.219693050643423
Total norm for 4 adversaries is: 42.98500544793934. distance: 2.219693050643423
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1026, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 42.980400409209054.
Norm before scaling: 42.97796918144152. Distance: 1.9886188932369777
Total norm for 4 adversaries is: 42.97796918144152. distance: 1.9886188932369777
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1348, Accuracy: 9522/9900 (96.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 42.980400409209054.
Norm before scaling: 42.98451415371878. Distance: 2.1760463039506432
Total norm for 4 adversaries is: 42.98451415371878. distance: 2.1760463039506432
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2987, Accuracy: 9194/9900 (92.8687%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3862/4416 (87.4547%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3952/4416 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9432, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4564/5197 (87.8199%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4582/5197 (88.1662%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8932, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4342/4918 (88.2879%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4429/4918 (90.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2776, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5700/6263 (91.0107%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5694/6263 (90.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0757, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3191/3646 (87.5206%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3308/3646 (90.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8958, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4206/4707 (89.3563%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4253/4707 (90.3548%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9180, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4373/5063 (86.3717%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4280/5063 (84.5349%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1158, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3794/4295 (88.3353%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3885/4295 (90.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9589, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4302/4793 (89.7559%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0240, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4068/4538 (89.6430%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4233/4538 (93.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8566, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4481/5083 (88.1566%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4508/5083 (88.6878%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9235, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3272/3638 (89.9395%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3292/3638 (90.4893%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8318, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5355/6124 (87.4428%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5380/6124 (87.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0234, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4122/4618 (89.2594%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4066/4618 (88.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9114, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3546/3969 (89.3424%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3592/3969 (90.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8626, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3584/4158 (86.1953%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3644/4158 (87.6383%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0056, Accuracy: 5251/10000 (52.5100%)
time spent on training: 264.5730948448181
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.2150, Accuracy: 6851/10000 (68.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 8.7272, Accuracy: 151/9900 (1.5253%)
Done in 291.2841875553131 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 43.01263525979532.
Norm before scaling: 43.01602654870697. Distance: 2.0560416629147165
Total norm for 4 adversaries is: 43.01602654870697. distance: 2.0560416629147165
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3618, Accuracy: 9057/9900 (91.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4752/5305 (89.5759%), train_poison_data_count: 415
Global model norm: 43.01263525979532.
Norm before scaling: 43.01564060797029. Distance: 2.2106751195280463
Total norm for 4 adversaries is: 43.01564060797029. distance: 2.2106751195280463
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2181, Accuracy: 9328/9900 (94.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.01263525979532.
Norm before scaling: 43.00990074971111. Distance: 2.0036241358815188
Total norm for 4 adversaries is: 43.00990074971111. distance: 2.0036241358815188
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3003, Accuracy: 9115/9900 (92.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 43.01263525979532.
Norm before scaling: 43.01713752789404. Distance: 2.2232162226079226
Total norm for 4 adversaries is: 43.01713752789404. distance: 2.2232162226079226
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3361, Accuracy: 9076/9900 (91.6768%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4240/4716 (89.9067%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4276/4716 (90.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9455, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3887/4481 (86.7440%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3907/4481 (87.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0152, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3918/4361 (89.8418%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3822/4361 (87.6404%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0090, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4313/4793 (89.9854%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4400/4793 (91.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0197, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3851/4295 (89.6624%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3641/4295 (84.7730%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1185, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4479/5244 (85.4119%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4566/5244 (87.0709%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9960, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4395/4989 (88.0938%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4463/4989 (89.4568%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9782, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4576/5197 (88.0508%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4613/5197 (88.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1467, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3886/4356 (89.2103%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3667/4356 (84.1827%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2664, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4083/4647 (87.8631%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4202/4647 (90.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9923, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3703/4013 (92.2751%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8068, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4096/4538 (90.2600%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4190/4538 (92.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8510, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4221/4707 (89.6750%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4244/4707 (90.1636%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0029, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5694/6263 (90.9149%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5713/6263 (91.2183%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1302, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3804/4235 (89.8229%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3792/4235 (89.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8975, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3421/3861 (88.6040%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3482/3861 (90.1839%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9977, Accuracy: 5424/10000 (54.2400%)
time spent on training: 264.27171325683594
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.2059, Accuracy: 6874/10000 (68.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.4188, Accuracy: 197/9900 (1.9899%)
Done in 291.0977499485016 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 43.03930429116144.
Norm before scaling: 43.04389310225595. Distance: 2.1499642790554914
Total norm for 4 adversaries is: 43.04389310225595. distance: 2.1499642790554914
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1179, Accuracy: 9600/9900 (96.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 43.03930429116144.
Norm before scaling: 43.04231912143632. Distance: 2.1714512253777047
Total norm for 4 adversaries is: 43.04231912143632. distance: 2.1714512253777047
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2065, Accuracy: 9409/9900 (95.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4266/4717 (90.4388%), train_poison_data_count: 370
Global model norm: 43.03930429116144.
Norm before scaling: 43.038718601140125. Distance: 2.013283722668374
Total norm for 4 adversaries is: 43.038718601140125. distance: 2.013283722668374
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1928, Accuracy: 9411/9900 (95.0606%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4515/5066 (89.1236%), train_poison_data_count: 400
Global model norm: 43.03930429116144.
Norm before scaling: 43.04535926324187. Distance: 2.235669701278369
Total norm for 4 adversaries is: 43.04535926324187. distance: 2.235669701278369
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1560, Accuracy: 9511/9900 (96.0707%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4532/5055 (89.6538%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4583/5055 (90.6627%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9514, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3387/3828 (88.4796%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3529/3828 (92.1891%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9252, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3902/4361 (89.4749%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3917/4361 (89.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9714, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3668/4013 (91.4029%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3770/4013 (93.9447%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8420, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4041/4518 (89.4422%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4152/4518 (91.8991%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9002, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4033/4558 (88.4818%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4027/4558 (88.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1635, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3669/4126 (88.9239%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3796/4126 (92.0019%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8828, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4207/4679 (89.9124%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3994/4679 (85.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1168, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3836/4235 (90.5785%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3788/4235 (89.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0361, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4663/5037 (92.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.7889, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3252/3672 (88.5621%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3326/3672 (90.5773%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8935, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4396/4928 (89.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8463, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3893/4356 (89.3710%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3813/4356 (87.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1073, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4042/4456 (90.7092%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4109/4456 (92.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0154, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4278/4793 (89.2552%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4420/4793 (92.2178%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9361, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4502/5025 (89.5920%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4521/5025 (89.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0402, Accuracy: 5471/10000 (54.7100%)
time spent on training: 258.98459482192993
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1886, Accuracy: 6893/10000 (68.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 8.6686, Accuracy: 158/9900 (1.5960%)
Done in 286.97511863708496 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 43.06791398296126.
Norm before scaling: 43.07313598921389. Distance: 2.114667793679308
Total norm for 4 adversaries is: 43.07313598921389. distance: 2.114667793679308
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1505, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 43.06791398296126.
Norm before scaling: 43.069899411904395. Distance: 2.164318744348029
Total norm for 4 adversaries is: 43.069899411904395. distance: 2.164318744348029
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1405, Accuracy: 9517/9900 (96.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 43.06791398296126.
Norm before scaling: 43.06749732886594. Distance: 2.0002617664694324
Total norm for 4 adversaries is: 43.06749732886594. distance: 2.0002617664694324
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2792, Accuracy: 9204/9900 (92.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 43.06791398296126.
Norm before scaling: 43.073745300120905. Distance: 2.203175970258961
Total norm for 4 adversaries is: 43.073745300120905. distance: 2.203175970258961
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2906, Accuracy: 9193/9900 (92.8586%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3920/4346 (90.1979%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4020/4346 (92.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8670, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3751/4184 (89.6511%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3771/4184 (90.1291%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9646, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3868/4356 (88.7971%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3668/4356 (84.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3003, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3252/3646 (89.1936%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3335/3646 (91.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7962, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4492/5083 (88.3730%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4511/5083 (88.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0591, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3864/4356 (88.7052%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3894/4356 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1712, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4002/4558 (87.8017%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4092/4558 (89.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1024, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3681/4175 (88.1677%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3674/4175 (88.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8997, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3174/3472 (91.4171%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3208/3472 (92.3963%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0547, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4010/4501 (89.0913%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4066/4501 (90.3355%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0811, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4838/5424 (89.1962%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4965/5424 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1746, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3942/4481 (87.9714%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3951/4481 (88.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0282, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4908/5455 (89.9725%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4968/5455 (91.0724%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.4273, Accuracy: 4871/10000 (48.7100%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4609/5232 (88.0925%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4669/5232 (89.2393%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1371, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5515/6391 (86.2932%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5536/6391 (86.6218%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1388, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3429/3775 (90.8344%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3551/3775 (94.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8768, Accuracy: 5692/10000 (56.9200%)
time spent on training: 262.32884335517883
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for processed user 0 (original user 0).
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for processed user 1 (original user 1).
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for processed user 2 (original user 2).
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for processed user 3 (original user 3).
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for processed user 4 (original user 4).
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for processed user 5 (original user 5).
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for processed user 6 (original user 6).
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for processed user 7 (original user 7).
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for processed user 8 (original user 8).
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for processed user 9 (original user 9).
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for processed user 10 (original user 10).
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for processed user 11 (original user 11).
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for processed user 12 (original user 12).
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for processed user 13 (original user 13).
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for processed user 14 (original user 14).
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for processed user 15 (original user 15).
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for processed user 16 (original user 16).
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for processed user 17 (original user 17).
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for processed user 18 (original user 18).
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for processed user 19 (original user 19).
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Sorted clients with their scores: []
Top 3 clients: []
No non-suspicious updates to aggregate.
Accuracy of identifying adversarial clients: 0.00% (0/1 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1929, Accuracy: 6886/10000 (68.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 8.6732, Accuracy: 169/9900 (1.7071%)
Done in 285.98090076446533 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
