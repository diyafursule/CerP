current path: saved_models/model_cifar100_Dec.10_11.02.50_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4306/4885 (88.1474%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.44000677196797. Distance: 2.2941869459862128
Total norm for 4 adversaries is: 42.44000677196797. distance: 2.2941869459862128
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4576, Accuracy: 8790/9900 (88.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4744/5305 (89.4251%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435306632843336. Distance: 2.251174196516459
Total norm for 4 adversaries is: 42.435306632843336. distance: 2.251174196516459
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7323, Accuracy: 8300/9900 (83.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4180/4717 (88.6156%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.438647697109474. Distance: 2.1772356360304745
Total norm for 4 adversaries is: 42.438647697109474. distance: 2.1772356360304745
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4216, Accuracy: 8892/9900 (89.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4456/5066 (87.9589%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44036487016223. Distance: 2.304793946992234
Total norm for 4 adversaries is: 42.44036487016223. distance: 2.304793946992234
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6046, Accuracy: 8499/9900 (85.8485%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3840/4356 (88.1543%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3666/4356 (84.1598%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4460, Accuracy: 4661/10000 (46.6100%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3931/4465 (88.0403%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9858, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4041/4647 (86.9593%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4168/4647 (89.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9530, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4460/5055 (88.2295%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4516/5055 (89.3373%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0985, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4433/5116 (86.6497%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4438/5116 (86.7475%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9970, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3629/4126 (87.9544%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3758/4126 (91.0810%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9469, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3088/3472 (88.9401%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3224/3472 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0211, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4431/4986 (88.8688%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4454/4986 (89.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0968, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3543/4013 (88.2881%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3691/4013 (91.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8364, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4025/4618 (87.1589%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4080/4618 (88.3499%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0721, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4445/5083 (87.4484%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4431/5083 (87.1729%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1101, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3974/4511 (88.0958%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4016/4511 (89.0268%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1732, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3376/3797 (88.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9784, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4995/5582 (89.4841%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5068/5582 (90.7918%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0993, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3152/3616 (87.1681%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3226/3616 (89.2146%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0731, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4817/5455 (88.3043%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4867/5455 (89.2209%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9556, Accuracy: 5389/10000 (53.8900%)
time spent on training: 260.39313864707947
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1048, Accuracy: 7055/10000 (70.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0891, Accuracy: 115/9900 (1.1616%)
Done in 289.2330355644226 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4393/4885 (89.9284%), train_poison_data_count: 385
Global model norm: 42.45484158748858.
Norm before scaling: 42.46084478485738. Distance: 2.112033101689421
Total norm for 4 adversaries is: 42.46084478485738. distance: 2.112033101689421
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2743, Accuracy: 9194/9900 (92.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 42.45484158748858.
Norm before scaling: 42.45833061799754. Distance: 2.1685330592989494
Total norm for 4 adversaries is: 42.45833061799754. distance: 2.1685330592989494
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5580, Accuracy: 8541/9900 (86.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4188/4717 (88.7852%), train_poison_data_count: 370
Global model norm: 42.45484158748858.
Norm before scaling: 42.46219596226154. Distance: 2.166487564118132
Total norm for 4 adversaries is: 42.46219596226154. distance: 2.166487564118132
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2311, Accuracy: 9346/9900 (94.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 42.45484158748858.
Norm before scaling: 42.46467396738435. Distance: 2.2916472231878173
Total norm for 4 adversaries is: 42.46467396738435. distance: 2.2916472231878173
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2614, Accuracy: 9186/9900 (92.7879%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3599/4025 (89.4161%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3711/4025 (92.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9558, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3352/3797 (88.2802%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3395/3797 (89.4127%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0434, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3950/4625 (85.4054%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4009/4625 (86.6811%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0775, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3860/4481 (86.1415%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3894/4481 (86.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2579, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3861/4315 (89.4786%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3971/4315 (92.0278%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0273, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3705/4235 (87.4852%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3842/4235 (90.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9934, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3377/3828 (88.2184%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3465/3828 (90.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9557, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3821/4416 (86.5263%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3963/4416 (89.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8921, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3149/3638 (86.5585%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9361, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4539/5265 (86.2108%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4515/5265 (85.7550%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9846, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3358/3781 (88.8125%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3306/3781 (87.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2995, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3992/4441 (89.8897%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4033/4441 (90.8129%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1492, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3985/4433 (89.8940%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4022/4433 (90.7286%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9921, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4437/5083 (87.2910%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4429/5083 (87.1336%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1079, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4311/4928 (87.4797%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4406/4928 (89.4075%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9595, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4177/4793 (87.1479%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4369/4793 (91.1538%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0999, Accuracy: 5354/10000 (53.5400%)
time spent on training: 256.3332989215851
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0961, Accuracy: 7066/10000 (70.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.1042, Accuracy: 223/9900 (2.2525%)
Done in 285.01547145843506 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 42.47735351364816.
Norm before scaling: 42.477814751864884. Distance: 2.0171105876180078
Total norm for 4 adversaries is: 42.477814751864884. distance: 2.0171105876180078
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2427, Accuracy: 9250/9900 (93.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 42.47735351364816.
Norm before scaling: 42.478753018512826. Distance: 2.0971709814260957
Total norm for 4 adversaries is: 42.478753018512826. distance: 2.0971709814260957
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0845, Accuracy: 9669/9900 (97.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 42.47735351364816.
Norm before scaling: 42.478959922917284. Distance: 1.989172055807539
Total norm for 4 adversaries is: 42.478959922917284. distance: 1.989172055807539
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2189, Accuracy: 9327/9900 (94.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 42.47735351364816.
Norm before scaling: 42.48378884295897. Distance: 2.165193117792315
Total norm for 4 adversaries is: 42.48378884295897. distance: 2.165193117792315
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1595, Accuracy: 9488/9900 (95.8384%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3298/3616 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8132, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3505/3837 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9706, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4173/4679 (89.1857%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4265/4679 (91.1520%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0120, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3095/3638 (85.0742%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3263/3638 (89.6921%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0897, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3634/4046 (89.8171%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3636/4046 (89.8665%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9739, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3984/4518 (88.1806%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4081/4518 (90.3276%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1005, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3387/3797 (89.2020%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3388/3797 (89.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1006, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4437/5025 (88.2985%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4435/5025 (88.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.3453, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3914/4362 (89.7295%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3947/4362 (90.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0192, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3997/4558 (87.6920%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4023/4558 (88.2624%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2047, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3202/3672 (87.2004%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3246/3672 (88.3987%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0592, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4322/4874 (88.6746%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4346/4874 (89.1670%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1735, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3610/4025 (89.6894%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3709/4025 (92.1491%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9425, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4095/4663 (87.8190%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4224/4663 (90.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1146, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3454/3911 (88.3150%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3469/3911 (88.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9988, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4447/5017 (88.6386%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4562/5017 (90.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8624, Accuracy: 5676/10000 (56.7600%)
time spent on training: 258.0762252807617
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0909, Accuracy: 7061/10000 (70.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.1050, Accuracy: 419/9900 (4.2323%)
Done in 287.149840593338 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 42.49782852908487.
Norm before scaling: 42.4999540440928. Distance: 1.971455546652617
Total norm for 4 adversaries is: 42.4999540440928. distance: 1.971455546652617
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5358, Accuracy: 8681/9900 (87.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4836/5305 (91.1593%), train_poison_data_count: 415
Global model norm: 42.49782852908487.
Norm before scaling: 42.49600165015528. Distance: 2.0201426895657777
Total norm for 4 adversaries is: 42.49600165015528. distance: 2.0201426895657777
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0760, Accuracy: 9690/9900 (97.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 42.49782852908487.
Norm before scaling: 42.49921874281926. Distance: 1.9554008956761986
Total norm for 4 adversaries is: 42.49921874281926. distance: 1.9554008956761986
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1448, Accuracy: 9517/9900 (96.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4536/5066 (89.5381%), train_poison_data_count: 400
Global model norm: 42.49782852908487.
Norm before scaling: 42.50382134704552. Distance: 2.119040716250848
Total norm for 4 adversaries is: 42.50382134704552. distance: 2.119040716250848
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3540, Accuracy: 8999/9900 (90.8990%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5278/6124 (86.1855%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5319/6124 (86.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0816, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3886/4356 (89.2103%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3702/4356 (84.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4360, Accuracy: 4834/10000 (48.3400%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3530/4158 (84.8966%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3580/4158 (86.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0984, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4895/5455 (89.7342%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4923/5455 (90.2475%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9566, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3934/4511 (87.2090%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4052/4511 (89.8249%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0062, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4538/5232 (86.7355%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4525/5232 (86.4870%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1635, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4499/5244 (85.7933%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4538/5244 (86.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0865, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4387/4918 (89.2029%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4402/4918 (89.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0532, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3617/4126 (87.6636%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3725/4126 (90.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8498, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4359/4928 (88.4537%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4381/4928 (88.9002%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2043, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3740/4223 (88.5626%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3830/4223 (90.6938%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9189, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4530/5195 (87.1992%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4590/5195 (88.3542%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2321, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4165/4679 (89.0147%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4123/4679 (88.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0346, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3211/3646 (88.0691%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3279/3646 (89.9342%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8818, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3203/3616 (88.5785%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3219/3616 (89.0210%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8808, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4078/4716 (86.4716%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4088/4716 (86.6836%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9892, Accuracy: 5449/10000 (54.4900%)
time spent on training: 263.7225966453552
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0888, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4420, Accuracy: 691/9900 (6.9798%)
Done in 292.0974688529968 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4473/4885 (91.5660%), train_poison_data_count: 385
Global model norm: 42.52281527998749.
Norm before scaling: 42.52581792781518. Distance: 1.9577774787565347
Total norm for 4 adversaries is: 42.52581792781518. distance: 1.9577774787565347
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1766, Accuracy: 9476/9900 (95.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4865/5305 (91.7059%), train_poison_data_count: 415
Global model norm: 42.52281527998749.
Norm before scaling: 42.51772235041745. Distance: 1.984119428862462
Total norm for 4 adversaries is: 42.51772235041745. distance: 1.984119428862462
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1344, Accuracy: 9563/9900 (96.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4280/4717 (90.7356%), train_poison_data_count: 370
Global model norm: 42.52281527998749.
Norm before scaling: 42.52365495190589. Distance: 1.9206454678210456
Total norm for 4 adversaries is: 42.52365495190589. distance: 1.9206454678210456
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1856, Accuracy: 9403/9900 (94.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 42.52281527998749.
Norm before scaling: 42.5303961270826. Distance: 2.082132934606493
Total norm for 4 adversaries is: 42.5303961270826. distance: 2.082132934606493
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2743, Accuracy: 9219/9900 (93.1212%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5281/6124 (86.2345%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5362/6124 (87.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0479, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3962/4433 (89.3751%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4048/4433 (91.3151%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0028, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3386/3781 (89.5530%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3200/3781 (84.6337%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4541, Accuracy: 4739/10000 (47.3900%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3574/3969 (90.0479%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3571/3969 (89.9723%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0041, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4467/5025 (88.8955%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4529/5025 (90.1294%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2427, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4185/4679 (89.4422%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4234/4679 (90.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0877, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4162/4707 (88.4215%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4245/4707 (90.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9849, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4442/4986 (89.0895%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4421/4986 (88.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9826, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3897/4315 (90.3129%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3944/4315 (91.4021%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8663, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3870/4416 (87.6359%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3933/4416 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0486, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4245/4804 (88.3639%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4094/4804 (85.2206%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1150, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4178/4793 (87.1688%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4266/4793 (89.0048%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0400, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4556/5232 (87.0795%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4539/5232 (86.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0434, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4117/4662 (88.3097%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4220/4662 (90.5191%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0342, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4254/4956 (85.8354%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4323/4956 (87.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2742, Accuracy: 4995/10000 (49.9500%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3830/4368 (87.6832%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3808/4368 (87.1795%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9945, Accuracy: 5324/10000 (53.2400%)
time spent on training: 265.2757248878479
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0879, Accuracy: 7070/10000 (70.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7708, Accuracy: 1041/9900 (10.5152%)
Done in 293.9976809024811 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 42.54724941306062.
Norm before scaling: 42.54753201384012. Distance: 1.9243331943293633
Total norm for 4 adversaries is: 42.54753201384012. distance: 1.9243331943293633
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2772, Accuracy: 9216/9900 (93.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 42.54724941306062.
Norm before scaling: 42.54400582503515. Distance: 1.9532633007675244
Total norm for 4 adversaries is: 42.54400582503515. distance: 1.9532633007675244
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2185, Accuracy: 9354/9900 (94.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4312/4717 (91.4140%), train_poison_data_count: 370
Global model norm: 42.54724941306062.
Norm before scaling: 42.54729531788345. Distance: 1.8674072391702667
Total norm for 4 adversaries is: 42.54729531788345. distance: 1.8674072391702667
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2198, Accuracy: 9340/9900 (94.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4604/5066 (90.8804%), train_poison_data_count: 400
Global model norm: 42.54724941306062.
Norm before scaling: 42.55183678146647. Distance: 2.01756004480494
Total norm for 4 adversaries is: 42.55183678146647. distance: 2.01756004480494
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1133, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5343/6124 (87.2469%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5339/6124 (87.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1064, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5161/5902 (87.4449%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5146/5902 (87.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1603, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4172/4707 (88.6339%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4216/4707 (89.5687%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9405, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4089/4647 (87.9923%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4162/4647 (89.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9619, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2977/3297 (90.2942%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3030/3297 (91.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8020, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5567/6263 (88.8871%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5656/6263 (90.3082%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2867, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4188/4663 (89.8134%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4249/4663 (91.1216%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1816, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4343/4956 (87.6312%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4336/4956 (87.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.4596, Accuracy: 4737/10000 (47.3700%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3623/4046 (89.5452%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3724/4046 (92.0415%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9139, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3717/4184 (88.8384%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3745/4184 (89.5076%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8673, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4864/5591 (86.9970%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4873/5591 (87.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1842, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4098/4634 (88.4333%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4185/4634 (90.3107%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9291, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3405/3828 (88.9498%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3513/3828 (91.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9638, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3135/3638 (86.1737%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3255/3638 (89.4722%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8529, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3406/3781 (90.0820%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3389/3781 (89.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1886, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3425/3837 (89.2624%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3527/3837 (91.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9120, Accuracy: 5635/10000 (56.3500%)
time spent on training: 263.2100076675415
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [0, 1, 2, 3]
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0849, Accuracy: 7074/10000 (70.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.2130, Accuracy: 1405/9900 (14.1919%)
Done in 291.96489214897156 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4484/4885 (91.7912%), train_poison_data_count: 385
Global model norm: 42.57075050816141.
Norm before scaling: 42.56877764369239. Distance: 1.8529410079525
Total norm for 4 adversaries is: 42.56877764369239. distance: 1.8529410079525
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2861, Accuracy: 9208/9900 (93.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4880/5305 (91.9887%), train_poison_data_count: 415
Global model norm: 42.57075050816141.
Norm before scaling: 42.568169707724394. Distance: 1.938795517978009
Total norm for 4 adversaries is: 42.568169707724394. distance: 1.938795517978009
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1604, Accuracy: 9514/9900 (96.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.57075050816141.
Norm before scaling: 42.57249389368827. Distance: 1.8830326948766358
Total norm for 4 adversaries is: 42.57249389368827. distance: 1.8830326948766358
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1568, Accuracy: 9494/9900 (95.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 42.57075050816141.
Norm before scaling: 42.57267883747084. Distance: 1.9530982053826107
Total norm for 4 adversaries is: 42.57267883747084. distance: 1.9530982053826107
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2310, Accuracy: 9339/9900 (94.3333%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3922/4501 (87.1362%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3919/4501 (87.0695%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0970, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3721/4175 (89.1257%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3740/4175 (89.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9294, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3171/3616 (87.6936%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3227/3616 (89.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9031, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4053/4634 (87.4622%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4103/4634 (88.5412%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9966, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4028/4558 (88.3721%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3953/4558 (86.7266%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2105, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4569/5167 (88.4266%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4597/5167 (88.9685%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2055, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3903/4356 (89.6006%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3888/4356 (89.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1415, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4155/4716 (88.1043%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4171/4716 (88.4436%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0771, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5387/6124 (87.9654%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5340/6124 (87.1979%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1269, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4461/5055 (88.2493%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4578/5055 (90.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0373, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4509/5025 (89.7313%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4595/5025 (91.4428%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0558, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4373/4918 (88.9183%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4376/4918 (88.9793%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2453, Accuracy: 4987/10000 (49.8700%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3761/4223 (89.0599%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3816/4223 (90.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8882, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3917/4481 (87.4135%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3880/4481 (86.5878%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0353, Accuracy: 5461/10000 (54.6100%)
