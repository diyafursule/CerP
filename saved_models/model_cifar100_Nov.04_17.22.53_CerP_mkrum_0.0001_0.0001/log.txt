current path: saved_models/model_cifar100_Nov.04_17.22.53_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4309/4885 (88.2088%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439903224938995. Distance: 2.2937442956172682
Total norm for 4 adversaries is: 42.439903224938995. distance: 2.2937442956172682
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4498, Accuracy: 8810/9900 (88.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4745/5305 (89.4439%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43533252242832. Distance: 2.2504551744995145
Total norm for 4 adversaries is: 42.43533252242832. distance: 2.2504551744995145
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7270, Accuracy: 8299/9900 (83.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4177/4717 (88.5520%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43862468594352. Distance: 2.1775885426227597
Total norm for 4 adversaries is: 42.43862468594352. distance: 2.1775885426227597
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4279, Accuracy: 8882/9900 (89.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4454/5066 (87.9195%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44040801431903. Distance: 2.3057579528744236
Total norm for 4 adversaries is: 42.44040801431903. distance: 2.3057579528744236
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6055, Accuracy: 8499/9900 (85.8485%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3838/4356 (88.1084%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3648/4356 (83.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4079, Accuracy: 4639/10000 (46.3900%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3932/4465 (88.0627%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4091/4465 (91.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0098, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4046/4647 (87.0669%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4150/4647 (89.3049%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9115, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4445/5055 (87.9327%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4512/5055 (89.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1425, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4433/5116 (86.6497%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4437/5116 (86.7279%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0471, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3632/4126 (88.0271%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3764/4126 (91.2264%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9416, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3080/3472 (88.7097%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3224/3472 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1182, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4433/4986 (88.9089%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4461/4986 (89.4705%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0956, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3540/4013 (88.2133%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3679/4013 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8501, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4029/4618 (87.2456%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4086/4618 (88.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1012, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4423/5083 (87.0155%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4419/5083 (86.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1443, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3964/4511 (87.8741%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4034/4511 (89.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1636, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3331/3797 (87.7272%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3376/3797 (88.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9734, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4990/5582 (89.3945%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1120, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3153/3616 (87.1958%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3209/3616 (88.7445%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0311, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4832/5455 (88.5793%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4861/5455 (89.1109%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9195, Accuracy: 5377/10000 (53.7700%)
time spent on training: 236.66068029403687
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1554, Accuracy: 6956/10000 (69.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.8116, Accuracy: 66/9900 (0.6667%)
Done in 262.278240442276 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4375/4885 (89.5599%), train_poison_data_count: 385
Global model norm: 42.46526757475234.
Norm before scaling: 42.47225656973032. Distance: 2.163416025710051
Total norm for 4 adversaries is: 42.47225656973032. distance: 2.163416025710051
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1876, Accuracy: 9411/9900 (95.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 42.46526757475234.
Norm before scaling: 42.468025656074474. Distance: 2.207982221317586
Total norm for 4 adversaries is: 42.468025656074474. distance: 2.207982221317586
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.4398, Accuracy: 8812/9900 (89.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4170/4717 (88.4036%), train_poison_data_count: 370
Global model norm: 42.46526757475234.
Norm before scaling: 42.473174840770824. Distance: 2.214418723686529
Total norm for 4 adversaries is: 42.473174840770824. distance: 2.214418723686529
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1981, Accuracy: 9397/9900 (94.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4471/5066 (88.2550%), train_poison_data_count: 400
Global model norm: 42.46526757475234.
Norm before scaling: 42.475910854620736. Distance: 2.3599794131528715
Total norm for 4 adversaries is: 42.475910854620736. distance: 2.3599794131528715
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1876, Accuracy: 9380/9900 (94.7475%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3589/4025 (89.1677%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3696/4025 (91.8261%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8598, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3322/3797 (87.4901%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3401/3797 (89.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1087, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3938/4625 (85.1459%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4022/4625 (86.9622%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1208, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3853/4481 (85.9853%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3855/4481 (86.0299%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1735, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3837/4315 (88.9224%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3960/4315 (91.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0299, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3702/4235 (87.4144%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3787/4235 (89.4215%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0335, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3370/3828 (88.0355%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3473/3828 (90.7262%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8990, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3813/4416 (86.3451%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3979/4416 (90.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9016, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3273/3638 (89.9670%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9780, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4549/5265 (86.4008%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4512/5265 (85.6980%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1092, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3347/3781 (88.5216%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3327/3781 (87.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2081, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3958/4441 (89.1241%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4016/4441 (90.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1953, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3955/4433 (89.2172%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4015/4433 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9290, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4400/5083 (86.5631%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4459/5083 (87.7238%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0392, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4295/4928 (87.1550%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4412/4928 (89.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9091, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4162/4793 (86.8350%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4333/4793 (90.4027%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9500, Accuracy: 5541/10000 (55.4100%)
time spent on training: 238.31734204292297
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.1613, Accuracy: 6963/10000 (69.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 9.2973, Accuracy: 83/9900 (0.8384%)
Done in 273.7945272922516 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4403/4885 (90.1331%), train_poison_data_count: 385
Global model norm: 42.50171900245992.
Norm before scaling: 42.503281410545966. Distance: 2.109772256248547
Total norm for 4 adversaries is: 42.503281410545966. distance: 2.109772256248547
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2132, Accuracy: 9332/9900 (94.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4740/5305 (89.3497%), train_poison_data_count: 415
Global model norm: 42.50171900245992.
Norm before scaling: 42.50550573252981. Distance: 2.2086266616727817
Total norm for 4 adversaries is: 42.50550573252981. distance: 2.2086266616727817
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0804, Accuracy: 9677/9900 (97.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4202/4717 (89.0820%), train_poison_data_count: 370
Global model norm: 42.50171900245992.
Norm before scaling: 42.50456805643439. Distance: 2.089013849346732
Total norm for 4 adversaries is: 42.50456805643439. distance: 2.089013849346732
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1707, Accuracy: 9438/9900 (95.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4467/5066 (88.1761%), train_poison_data_count: 400
Global model norm: 42.50171900245992.
Norm before scaling: 42.50801854503454. Distance: 2.2589274362812173
Total norm for 4 adversaries is: 42.50801854503454. distance: 2.2589274362812173
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1446, Accuracy: 9525/9900 (96.2121%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3125/3616 (86.4215%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3276/3616 (90.5973%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8288, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3383/3837 (88.1678%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3512/3837 (91.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9444, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4149/4679 (88.6728%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4309/4679 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0284, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3106/3638 (85.3766%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3274/3638 (89.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1152, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3604/4046 (89.0756%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3649/4046 (90.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9275, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3983/4518 (88.1585%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4075/4518 (90.1948%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1507, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3362/3797 (88.5436%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3379/3797 (88.9913%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1838, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4432/5025 (88.1990%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4523/5025 (90.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2683, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3878/4362 (88.9042%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3902/4362 (89.4544%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0803, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3991/4558 (87.5603%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4010/4558 (87.9772%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1955, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3206/3672 (87.3094%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3285/3672 (89.4608%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0921, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4295/4874 (88.1206%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4340/4874 (89.0439%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1925, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3590/4025 (89.1925%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3700/4025 (91.9255%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9788, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4089/4663 (87.6903%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4247/4663 (91.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0791, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3447/3911 (88.1360%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3471/3911 (88.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9789, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4419/5017 (88.0805%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4575/5017 (91.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8619, Accuracy: 5658/10000 (56.5800%)
time spent on training: 231.124436378479
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.1980, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 9.1183, Accuracy: 76/9900 (0.7677%)
Done in 257.02480959892273 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4385/4885 (89.7646%), train_poison_data_count: 385
Global model norm: 42.530948635045455.
Norm before scaling: 42.535210598103305. Distance: 2.124086071274795
Total norm for 4 adversaries is: 42.535210598103305. distance: 2.124086071274795
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5799, Accuracy: 8608/9900 (86.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 42.530948635045455.
Norm before scaling: 42.53053963633441. Distance: 2.155458940993164
Total norm for 4 adversaries is: 42.53053963633441. distance: 2.155458940993164
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1081, Accuracy: 9615/9900 (97.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4210/4717 (89.2516%), train_poison_data_count: 370
Global model norm: 42.530948635045455.
Norm before scaling: 42.532581720517506. Distance: 2.087608439661272
Total norm for 4 adversaries is: 42.532581720517506. distance: 2.087608439661272
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1465, Accuracy: 9504/9900 (96.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 42.530948635045455.
Norm before scaling: 42.53767143616276. Distance: 2.266658889065283
Total norm for 4 adversaries is: 42.53767143616276. distance: 2.266658889065283
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2725, Accuracy: 9189/9900 (92.8182%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5264/6124 (85.9569%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5315/6124 (86.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0848, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3864/4356 (88.7052%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3589/4356 (82.3921%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2211, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3518/4158 (84.6080%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3610/4158 (86.8206%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0391, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4883/5455 (89.5142%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4901/5455 (89.8442%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9738, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3920/4511 (86.8987%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4022/4511 (89.1598%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0367, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4501/5232 (86.0283%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4550/5232 (86.9648%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0448, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4461/5244 (85.0686%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4515/5244 (86.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1032, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4352/4918 (88.4913%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4399/4918 (89.4469%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0854, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3584/4126 (86.8638%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3717/4126 (90.0873%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8469, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4355/4928 (88.3726%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4413/4928 (89.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1315, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3711/4223 (87.8759%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3861/4223 (91.4279%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9648, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4514/5195 (86.8912%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4606/5195 (88.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1780, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4124/4679 (88.1385%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4182/4679 (89.3781%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9963, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3175/3646 (87.0817%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3285/3646 (90.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8644, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3159/3616 (87.3617%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3213/3616 (88.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8755, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4049/4716 (85.8567%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4121/4716 (87.3834%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9395, Accuracy: 5539/10000 (55.3900%)
time spent on training: 234.86676716804504
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.2093, Accuracy: 6842/10000 (68.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 8.9345, Accuracy: 80/9900 (0.8081%)
Done in 258.18676948547363 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 42.57166952209459.
Norm before scaling: 42.575927408884034. Distance: 2.1177807641828323
Total norm for 4 adversaries is: 42.575927408884034. distance: 2.1177807641828323
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1761, Accuracy: 9453/9900 (95.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 42.57166952209459.
Norm before scaling: 42.56652221495858. Distance: 2.154087917676546
Total norm for 4 adversaries is: 42.56652221495858. distance: 2.154087917676546
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1119, Accuracy: 9612/9900 (97.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 42.57166952209459.
Norm before scaling: 42.57466442358941. Distance: 2.102757564376416
Total norm for 4 adversaries is: 42.57466442358941. distance: 2.102757564376416
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1659, Accuracy: 9467/9900 (95.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 42.57166952209459.
Norm before scaling: 42.58137315592054. Distance: 2.29483793064558
Total norm for 4 adversaries is: 42.58137315592054. distance: 2.29483793064558
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1839, Accuracy: 9420/9900 (95.1515%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5264/6124 (85.9569%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5348/6124 (87.3285%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9445, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3929/4433 (88.6307%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3979/4433 (89.7586%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9640, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3365/3781 (88.9976%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3270/3781 (86.4851%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2802, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3536/3969 (89.0905%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3578/3969 (90.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0298, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4441/5025 (88.3781%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4538/5025 (90.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0806, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4148/4679 (88.6514%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4207/4679 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9300, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4129/4707 (87.7204%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4262/4707 (90.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9284, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4412/4986 (88.4878%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4440/4986 (89.0493%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8978, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3857/4315 (89.3859%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3916/4315 (90.7532%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8727, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3817/4416 (86.4357%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3928/4416 (88.9493%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9361, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4259/4804 (88.6553%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4052/4804 (84.3464%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2329, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4137/4793 (86.3134%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4265/4793 (88.9839%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0913, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4494/5232 (85.8945%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4589/5232 (87.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9313, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4081/4662 (87.5375%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4222/4662 (90.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0176, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4179/4956 (84.3220%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4283/4956 (86.4205%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2005, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3815/4368 (87.3397%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3863/4368 (88.4386%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9711, Accuracy: 5369/10000 (53.6900%)
time spent on training: 272.65916299819946
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.2253, Accuracy: 6851/10000 (68.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 9.0364, Accuracy: 91/9900 (0.9192%)
Done in 299.40353441238403 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4373/4885 (89.5189%), train_poison_data_count: 385
Global model norm: 42.609161566663836.
Norm before scaling: 42.61263796178899. Distance: 2.1453073344547016
Total norm for 4 adversaries is: 42.61263796178899. distance: 2.1453073344547016
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2753, Accuracy: 9240/9900 (93.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4758/5305 (89.6890%), train_poison_data_count: 415
Global model norm: 42.609161566663836.
Norm before scaling: 42.608549909503196. Distance: 2.17153906110871
Total norm for 4 adversaries is: 42.608549909503196. distance: 2.17153906110871
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1859, Accuracy: 9425/9900 (95.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 42.609161566663836.
Norm before scaling: 42.60760877114922. Distance: 2.0490288504286407
Total norm for 4 adversaries is: 42.60760877114922. distance: 2.0490288504286407
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1706, Accuracy: 9452/9900 (95.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 42.609161566663836.
Norm before scaling: 42.618965504844496. Distance: 2.287304408148572
Total norm for 4 adversaries is: 42.618965504844496. distance: 2.287304408148572
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1760, Accuracy: 9461/9900 (95.5657%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5319/6124 (86.8550%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5318/6124 (86.8387%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0769, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5070/5902 (85.9031%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5072/5902 (85.9370%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1766, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4152/4707 (88.2091%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8463, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4061/4647 (87.3897%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4158/4647 (89.4771%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9416, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2918/3297 (88.5047%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3020/3297 (91.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7986, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5524/6263 (88.2005%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5653/6263 (90.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1685, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4136/4663 (88.6983%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4250/4663 (91.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2352, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4280/4956 (86.3600%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4331/4956 (87.3890%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2000, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3597/4046 (88.9026%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3690/4046 (91.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9675, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3679/4184 (87.9302%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3793/4184 (90.6549%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7786, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4838/5591 (86.5319%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4841/5591 (86.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1996, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4072/4634 (87.8722%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4192/4634 (90.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9959, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3339/3828 (87.2257%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3491/3828 (91.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9476, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3090/3638 (84.9368%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3271/3638 (89.9120%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9022, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3353/3781 (88.6802%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3415/3781 (90.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0958, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3370/3837 (87.8290%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3537/3837 (92.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8736, Accuracy: 5673/10000 (56.7300%)
time spent on training: 233.36298608779907
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.2168, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 8.9001, Accuracy: 130/9900 (1.3131%)
Done in 257.08056378364563 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 42.653780262751916.
Norm before scaling: 42.65607400375781. Distance: 2.0977015996538175
Total norm for 4 adversaries is: 42.65607400375781. distance: 2.0977015996538175
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2260, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 42.653780262751916.
Norm before scaling: 42.65432401787508. Distance: 2.15395719836682
Total norm for 4 adversaries is: 42.65432401787508. distance: 2.15395719836682
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1760, Accuracy: 9465/9900 (95.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4190/4717 (88.8276%), train_poison_data_count: 370
Global model norm: 42.653780262751916.
Norm before scaling: 42.655813585221736. Distance: 2.08382157008896
Total norm for 4 adversaries is: 42.655813585221736. distance: 2.08382157008896
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1306, Accuracy: 9576/9900 (96.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 42.653780262751916.
Norm before scaling: 42.65855648526155. Distance: 2.2306380600144786
Total norm for 4 adversaries is: 42.65855648526155. distance: 2.2306380600144786
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1651, Accuracy: 9482/9900 (95.7778%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3862/4501 (85.8032%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3941/4501 (87.5583%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1455, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3646/4175 (87.3293%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3729/4175 (89.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8872, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3122/3616 (86.3385%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3221/3616 (89.0763%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9160, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4045/4634 (87.2896%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4148/4634 (89.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9322, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3976/4558 (87.2312%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3990/4558 (87.5384%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1587, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4551/5167 (88.0782%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4617/5167 (89.3555%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1547, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3930/4356 (90.2204%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3916/4356 (89.8990%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0582, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4086/4716 (86.6412%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4164/4716 (88.2952%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8955, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5356/6124 (87.4592%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5315/6124 (86.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9562, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4377/5055 (86.5875%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4562/5055 (90.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0172, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4455/5025 (88.6567%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4556/5025 (90.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2144, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4348/4918 (88.4099%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4381/4918 (89.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2599, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3694/4223 (87.4734%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3812/4223 (90.2676%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9354, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3965/4481 (88.4847%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3964/4481 (88.4624%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9854, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3174/3638 (87.2457%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3274/3638 (89.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9819, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3575/4013 (89.0855%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3679/4013 (91.6770%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8518, Accuracy: 5637/10000 (56.3700%)
time spent on training: 232.27737498283386
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.2243, Accuracy: 6839/10000 (68.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 9.3475, Accuracy: 97/9900 (0.9798%)
Done in 255.7520673274994 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 42.698319456098034.
Norm before scaling: 42.70092669515499. Distance: 2.097271931994556
Total norm for 4 adversaries is: 42.70092669515499. distance: 2.097271931994556
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2343, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 42.698319456098034.
Norm before scaling: 42.69883691423134. Distance: 2.165847207651567
Total norm for 4 adversaries is: 42.69883691423134. distance: 2.165847207651567
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2471, Accuracy: 9321/9900 (94.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.698319456098034.
Norm before scaling: 42.70053218894057. Distance: 2.049968565723114
Total norm for 4 adversaries is: 42.70053218894057. distance: 2.049968565723114
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.3124, Accuracy: 9131/9900 (92.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4477/5066 (88.3735%), train_poison_data_count: 400
Global model norm: 42.698319456098034.
Norm before scaling: 42.70419695416365. Distance: 2.2497901818673576
Total norm for 4 adversaries is: 42.70419695416365. distance: 2.2497901818673576
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1432, Accuracy: 9517/9900 (96.1313%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3169/3646 (86.9172%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3307/3646 (90.7021%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8603, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3923/4501 (87.1584%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4027/4501 (89.4690%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0542, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4042/4651 (86.9060%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4170/4651 (89.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9925, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4562/5167 (88.2911%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4673/5167 (90.4393%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0187, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4836/5455 (88.6526%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4859/5455 (89.0742%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0614, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4855/5591 (86.8360%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4899/5591 (87.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1884, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4174/4679 (89.2071%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4196/4679 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0219, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4443/5017 (88.5589%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4529/5017 (90.2731%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9429, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4194/4793 (87.5026%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4282/4793 (89.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1016, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4004/4456 (89.8564%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4099/4456 (91.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9062, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4795/5424 (88.4034%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4951/5424 (91.2795%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1059, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3630/4175 (86.9461%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3673/4175 (87.9760%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9710, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4491/5116 (87.7834%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4569/5116 (89.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9886, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3272/3704 (88.3369%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3319/3704 (89.6058%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9329, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4457/5232 (85.1873%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4602/5232 (87.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1044, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3071/3472 (88.4505%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3182/3472 (91.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9693, Accuracy: 5631/10000 (56.3100%)
time spent on training: 246.7335660457611
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.2114, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 9.1911, Accuracy: 110/9900 (1.1111%)
Done in 270.42740297317505 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.737555583193604.
Norm before scaling: 42.73997192553257. Distance: 2.094678872016849
Total norm for 4 adversaries is: 42.73997192553257. distance: 2.094678872016849
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3262, Accuracy: 9092/9900 (91.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 42.737555583193604.
Norm before scaling: 42.7363987752061. Distance: 2.172879323031934
Total norm for 4 adversaries is: 42.7363987752061. distance: 2.172879323031934
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2205, Accuracy: 9366/9900 (94.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4225/4717 (89.5696%), train_poison_data_count: 370
Global model norm: 42.737555583193604.
Norm before scaling: 42.73715998694813. Distance: 2.0370125825293903
Total norm for 4 adversaries is: 42.73715998694813. distance: 2.0370125825293903
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1701, Accuracy: 9475/9900 (95.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 42.737555583193604.
Norm before scaling: 42.74333772556695. Distance: 2.231419242189065
Total norm for 4 adversaries is: 42.74333772556695. distance: 2.231419242189065
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3001, Accuracy: 9124/9900 (92.1616%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3220/3590 (89.6936%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3332/3590 (92.8134%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9535, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3830/4368 (87.6832%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3845/4368 (88.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9449, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3258/3704 (87.9590%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3390/3704 (91.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8958, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4310/4928 (87.4594%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4397/4928 (89.2248%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0769, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3956/4356 (90.8173%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3937/4356 (90.3811%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0875, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3540/3911 (90.5139%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3438/3911 (87.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0915, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4092/4651 (87.9811%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4155/4651 (89.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1108, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3705/4184 (88.5516%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3779/4184 (90.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8955, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3911/4346 (89.9908%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4005/4346 (92.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8362, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4155/4793 (86.6889%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9671, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3348/3804 (88.0126%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3476/3804 (91.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0465, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4452/4986 (89.2900%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4469/4986 (89.6310%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8622, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5462/6124 (89.1901%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5395/6124 (88.0960%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0786, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4142/4707 (87.9966%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4259/4707 (90.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8755, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3769/4235 (88.9965%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3724/4235 (87.9339%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0592, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3634/4046 (89.8171%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3718/4046 (91.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9605, Accuracy: 5459/10000 (54.5900%)
time spent on training: 229.12229228019714
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.2402, Accuracy: 6787/10000 (67.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 9.0571, Accuracy: 102/9900 (1.0303%)
Done in 258.97934222221375 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4394/4885 (89.9488%), train_poison_data_count: 385
Global model norm: 42.76852069343394.
Norm before scaling: 42.7711536205332. Distance: 2.1274787806742603
Total norm for 4 adversaries is: 42.7711536205332. distance: 2.1274787806742603
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1122, Accuracy: 9606/9900 (97.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4748/5305 (89.5005%), train_poison_data_count: 415
Global model norm: 42.76852069343394.
Norm before scaling: 42.771339132319376. Distance: 2.186219085596929
Total norm for 4 adversaries is: 42.771339132319376. distance: 2.186219085596929
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1063, Accuracy: 9647/9900 (97.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 42.76852069343394.
Norm before scaling: 42.767010790024386. Distance: 2.0166235527705383
Total norm for 4 adversaries is: 42.767010790024386. distance: 2.0166235527705383
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3932, Accuracy: 9002/9900 (90.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 42.76852069343394.
Norm before scaling: 42.774963585789585. Distance: 2.2570517555221707
Total norm for 4 adversaries is: 42.774963585789585. distance: 2.2570517555221707
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2696, Accuracy: 9203/9900 (92.9596%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4402/4986 (88.2872%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4503/4986 (90.3129%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9096, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4052/4634 (87.4407%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4159/4634 (89.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9211, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4118/4716 (87.3198%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4231/4716 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0381, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5421/6124 (88.5206%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5485/6124 (89.5656%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0886, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4339/4918 (88.2269%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4501/4918 (91.5209%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8998, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3344/3797 (88.0695%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3431/3797 (90.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9486, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4969/5582 (89.0183%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5033/5582 (90.1648%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0792, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4302/4956 (86.8039%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4363/4956 (88.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0580, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3932/4433 (88.6984%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4034/4433 (90.9993%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9072, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3838/4354 (88.1488%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3417/4354 (78.4796%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3720, Accuracy: 4822/10000 (48.2200%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4307/4928 (87.3985%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4412/4928 (89.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8099, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3521/3911 (90.0281%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3458/3911 (88.4173%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9840, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3897/4481 (86.9672%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3893/4481 (86.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0301, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4560/5197 (87.7429%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4668/5197 (89.8211%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0167, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4792/5455 (87.8460%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0233, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3807/4361 (87.2965%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3815/4361 (87.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1136, Accuracy: 5346/10000 (53.4600%)
time spent on training: 260.1864058971405
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.3017, Accuracy: 6661/10000 (66.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 9.5113, Accuracy: 63/9900 (0.6364%)
Done in 286.6865425109863 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4379/4885 (89.6418%), train_poison_data_count: 385
Global model norm: 42.812742357890656.
Norm before scaling: 42.815616332748554. Distance: 2.126449763598222
Total norm for 4 adversaries is: 42.815616332748554. distance: 2.126449763598222
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1967, Accuracy: 9451/9900 (95.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4761/5305 (89.7455%), train_poison_data_count: 415
Global model norm: 42.812742357890656.
Norm before scaling: 42.81236171282411. Distance: 2.1764982127754764
Total norm for 4 adversaries is: 42.81236171282411. distance: 2.1764982127754764
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2323, Accuracy: 9327/9900 (94.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.812742357890656.
Norm before scaling: 42.81220774307181. Distance: 2.0682827194172915
Total norm for 4 adversaries is: 42.81220774307181. distance: 2.0682827194172915
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1541, Accuracy: 9491/9900 (95.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 42.812742357890656.
Norm before scaling: 42.81773890163325. Distance: 2.269007295673287
Total norm for 4 adversaries is: 42.81773890163325. distance: 2.269007295673287
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2085, Accuracy: 9386/9900 (94.8081%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4271/4928 (86.6680%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4418/4928 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9248, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3728/4184 (89.1013%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3757/4184 (89.7945%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9424, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4169/4707 (88.5702%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4222/4707 (89.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0527, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3360/3828 (87.7743%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3499/3828 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8547, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3929/4503 (87.2529%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4035/4503 (89.6069%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0001, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4127/4662 (88.5242%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4243/4662 (91.0124%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8881, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3707/4235 (87.5325%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3805/4235 (89.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9833, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4393/5244 (83.7719%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4509/5244 (85.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0217, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4165/4793 (86.8976%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4342/4793 (90.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9226, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3993/4481 (89.1096%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3953/4481 (88.2169%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0920, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3890/4346 (89.5076%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4014/4346 (92.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7300, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3798/4361 (87.0901%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3755/4361 (86.1041%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2767, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4498/5055 (88.9812%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4581/5055 (90.6231%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0482, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4477/5195 (86.1790%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4499/5195 (86.6025%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0800, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3866/4315 (89.5944%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3989/4315 (92.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8967, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4176/4663 (89.5561%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4270/4663 (91.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2099, Accuracy: 5127/10000 (51.2700%)
time spent on training: 255.86636519432068
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.3304, Accuracy: 6634/10000 (66.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 9.4300, Accuracy: 72/9900 (0.7273%)
Done in 282.69018840789795 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 42.84680423103338.
Norm before scaling: 42.84888821987902. Distance: 2.0931254352103252
Total norm for 4 adversaries is: 42.84888821987902. distance: 2.0931254352103252
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1292, Accuracy: 9569/9900 (96.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 42.84680423103338.
Norm before scaling: 42.84765749641032. Distance: 2.177432079460308
Total norm for 4 adversaries is: 42.84765749641032. distance: 2.177432079460308
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3348, Accuracy: 9103/9900 (91.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.84680423103338.
Norm before scaling: 42.84385399558859. Distance: 2.008215719026596
Total norm for 4 adversaries is: 42.84385399558859. distance: 2.008215719026596
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1726, Accuracy: 9465/9900 (95.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.84680423103338.
Norm before scaling: 42.852607239999124. Distance: 2.2340634002022073
Total norm for 4 adversaries is: 42.852607239999124. distance: 2.2340634002022073
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1678, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3880/4315 (89.9189%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3980/4315 (92.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9169, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3203/3590 (89.2201%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3238/3590 (90.1950%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0518, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4126/4679 (88.1812%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4248/4679 (90.7886%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9221, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4544/5167 (87.9427%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4627/5167 (89.5491%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0606, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3374/3775 (89.3775%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3532/3775 (93.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8124, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3384/3828 (88.4013%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3467/3828 (90.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9130, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3730/4235 (88.0756%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3828/4235 (90.3896%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8883, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4091/4647 (88.0353%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4203/4647 (90.4454%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9066, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4286/4918 (87.1492%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4391/4918 (89.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1591, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3931/4433 (88.6758%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4025/4433 (90.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9593, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3961/4481 (88.3954%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3952/4481 (88.1946%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1297, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3735/4295 (86.9616%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3664/4295 (85.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1567, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3985/4503 (88.4966%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4015/4503 (89.1628%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9216, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3877/4354 (89.0446%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3806/4354 (87.4139%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.3664, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4401/4986 (88.2671%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4463/4986 (89.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9498, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5593/6263 (89.3023%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5700/6263 (91.0107%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0771, Accuracy: 5347/10000 (53.4700%)
time spent on training: 259.8457598686218
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.3892, Accuracy: 6573/10000 (65.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 9.3018, Accuracy: 112/9900 (1.1313%)
Done in 298.89158058166504 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 42.881072479045166.
Norm before scaling: 42.88193217920428. Distance: 2.1363798496878075
Total norm for 4 adversaries is: 42.88193217920428. distance: 2.1363798496878075
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1648, Accuracy: 9493/9900 (95.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4698/5305 (88.5580%), train_poison_data_count: 415
Global model norm: 42.881072479045166.
Norm before scaling: 42.88318896150113. Distance: 2.2998882432406327
Total norm for 4 adversaries is: 42.88318896150113. distance: 2.2998882432406327
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0498, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 42.881072479045166.
Norm before scaling: 42.881966339119465. Distance: 2.066611151821269
Total norm for 4 adversaries is: 42.881966339119465. distance: 2.066611151821269
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1783, Accuracy: 9473/9900 (95.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4479/5066 (88.4129%), train_poison_data_count: 400
Global model norm: 42.881072479045166.
Norm before scaling: 42.88563410169759. Distance: 2.248956438293177
Total norm for 4 adversaries is: 42.88563410169759. distance: 2.248956438293177
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0730, Accuracy: 9709/9900 (98.0707%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3704/4223 (87.7102%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3848/4223 (91.1201%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9943, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4837/5455 (88.6709%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4880/5455 (89.4592%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1970, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4996/5582 (89.5020%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5092/5582 (91.2218%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1433, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3972/4465 (88.9586%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4071/4465 (91.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8817, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5004/5591 (89.5010%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5034/5591 (90.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2229, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3502/3911 (89.5423%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3416/3911 (87.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0430, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4018/4356 (92.2406%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0130, Accuracy: 3364/4356 (77.2268%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3614, Accuracy: 4755/10000 (47.5500%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4394/5037 (87.2345%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4539/5037 (90.1132%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8901, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4145/4679 (88.5873%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4174/4679 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1905, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3907/4362 (89.5690%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3922/4362 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0886, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4077/4518 (90.2390%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4174/4518 (92.3860%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9820, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4477/5083 (88.0779%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4512/5083 (88.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0788, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3570/4013 (88.9609%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3727/4013 (92.8732%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8098, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4556/5197 (87.6660%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4666/5197 (89.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1048, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2905/3297 (88.1104%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3036/3297 (92.0837%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8945, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3948/4441 (88.8989%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4047/4441 (91.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9839, Accuracy: 5559/10000 (55.5900%)
time spent on training: 259.06253242492676
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.4657, Accuracy: 6454/10000 (64.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 9.2266, Accuracy: 109/9900 (1.1010%)
Done in 285.5643484592438 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4374/4885 (89.5394%), train_poison_data_count: 385
Global model norm: 42.92362687542404.
Norm before scaling: 42.92433926535372. Distance: 2.128323144412863
Total norm for 4 adversaries is: 42.92433926535372. distance: 2.128323144412863
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2530, Accuracy: 9310/9900 (94.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4720/5305 (88.9727%), train_poison_data_count: 415
Global model norm: 42.92362687542404.
Norm before scaling: 42.92270544336791. Distance: 2.19460287876912
Total norm for 4 adversaries is: 42.92270544336791. distance: 2.19460287876912
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2094, Accuracy: 9391/9900 (94.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4230/4717 (89.6756%), train_poison_data_count: 370
Global model norm: 42.92362687542404.
Norm before scaling: 42.92203426435687. Distance: 2.039533071187623
Total norm for 4 adversaries is: 42.92203426435687. distance: 2.039533071187623
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3424, Accuracy: 9051/9900 (91.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4466/5066 (88.1563%), train_poison_data_count: 400
Global model norm: 42.92362687542404.
Norm before scaling: 42.927399137144185. Distance: 2.2820933625081725
Total norm for 4 adversaries is: 42.927399137144185. distance: 2.2820933625081725
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2485, Accuracy: 9271/9900 (93.6465%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3952/4501 (87.8027%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4052/4501 (90.0244%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0027, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3891/4511 (86.2558%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4105/4511 (90.9998%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0493, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3979/4354 (91.3872%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3491/4354 (80.1791%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4964, Accuracy: 4626/10000 (46.2600%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3893/4346 (89.5766%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4034/4346 (92.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9757, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4138/4707 (87.9116%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4271/4707 (90.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8523, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4962/5591 (88.7498%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4964/5591 (88.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0553, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4072/4647 (87.6264%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4187/4647 (90.1011%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8951, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4023/4538 (88.6514%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4158/4538 (91.6263%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9553, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4324/4934 (87.6368%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4359/4934 (88.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0239, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4322/4804 (89.9667%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4228/4804 (88.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2188, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5562/6263 (88.8073%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5614/6263 (89.6376%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1019, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3930/4481 (87.7036%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3974/4481 (88.6856%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0410, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4355/5063 (86.0162%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4417/5063 (87.2408%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8595, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3684/4223 (87.2366%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3893/4223 (92.1857%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9336, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4001/4441 (90.0923%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4073/4441 (91.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9912, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3336/3756 (88.8179%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3468/3756 (92.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9235, Accuracy: 5605/10000 (56.0500%)
time spent on training: 258.665488243103
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.4915, Accuracy: 6455/10000 (64.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 9.8503, Accuracy: 89/9900 (0.8990%)
Done in 286.5761761665344 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4355/4885 (89.1505%), train_poison_data_count: 385
Global model norm: 42.96612776089585.
Norm before scaling: 42.970257075843314. Distance: 2.2005586218363797
Total norm for 4 adversaries is: 42.970257075843314. distance: 2.2005586218363797
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1116, Accuracy: 9610/9900 (97.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4710/5305 (88.7842%), train_poison_data_count: 415
Global model norm: 42.96612776089585.
Norm before scaling: 42.9652186048858. Distance: 2.2779878258451003
Total norm for 4 adversaries is: 42.9652186048858. distance: 2.2779878258451003
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0788, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4197/4717 (88.9760%), train_poison_data_count: 370
Global model norm: 42.96612776089585.
Norm before scaling: 42.96975567004949. Distance: 2.1026135620582584
Total norm for 4 adversaries is: 42.96975567004949. distance: 2.1026135620582584
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2353, Accuracy: 9301/9900 (93.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4464/5066 (88.1169%), train_poison_data_count: 400
Global model norm: 42.96612776089585.
Norm before scaling: 42.97118601049356. Distance: 2.2945074218510264
Total norm for 4 adversaries is: 42.97118601049356. distance: 2.2945074218510264
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2254, Accuracy: 9305/9900 (93.9899%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4373/5244 (83.3905%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4613/5244 (87.9672%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0241, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4294/4928 (87.1347%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4484/4928 (90.9903%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8588, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3371/3804 (88.6172%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3453/3804 (90.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9188, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3565/4013 (88.8363%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3690/4013 (91.9512%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8480, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3536/4158 (85.0409%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3652/4158 (87.8307%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9676, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4971/5582 (89.0541%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5011/5582 (89.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0284, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4784/5455 (87.6994%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4936/5455 (90.4858%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9444, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4041/4354 (92.8112%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3805/4354 (87.3909%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.3901, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3906/4433 (88.1119%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4015/4433 (90.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0113, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3136/3646 (86.0121%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3334/3646 (91.4427%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8301, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4021/4518 (88.9996%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4089/4518 (90.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0517, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3713/4235 (87.6741%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3713/4235 (87.6741%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2375, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3910/4362 (89.6378%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3958/4362 (90.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0658, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4762/5392 (88.3160%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4783/5392 (88.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0243, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4915/5591 (87.9091%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4911/5591 (87.8376%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0584, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3300/3756 (87.8594%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3443/3756 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9892, Accuracy: 5578/10000 (55.7800%)
time spent on training: 257.67302942276
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.4582, Accuracy: 6463/10000 (64.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 10.4069, Accuracy: 66/9900 (0.6667%)
Done in 284.26540446281433 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4358/4885 (89.2119%), train_poison_data_count: 385
Global model norm: 42.99918524391625.
Norm before scaling: 43.00322906434978. Distance: 2.173277148454693
Total norm for 4 adversaries is: 43.00322906434978. distance: 2.173277148454693
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1582, Accuracy: 9492/9900 (95.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4720/5305 (88.9727%), train_poison_data_count: 415
Global model norm: 42.99918524391625.
Norm before scaling: 42.99979844156976. Distance: 2.28189725707752
Total norm for 4 adversaries is: 42.99979844156976. distance: 2.28189725707752
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0200, Accuracy: 9841/9900 (99.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4156/4717 (88.1068%), train_poison_data_count: 370
Global model norm: 42.99918524391625.
Norm before scaling: 43.00180262845821. Distance: 2.157969355976356
Total norm for 4 adversaries is: 43.00180262845821. distance: 2.157969355976356
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1256, Accuracy: 9593/9900 (96.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4412/5066 (87.0904%), train_poison_data_count: 400
Global model norm: 42.99918524391625.
Norm before scaling: 43.00681268706157. Distance: 2.3882374528307513
Total norm for 4 adversaries is: 43.00681268706157. distance: 2.3882374528307513
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1037, Accuracy: 9638/9900 (97.3535%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4057/4634 (87.5486%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4167/4634 (89.9223%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9277, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3981/4503 (88.4077%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3997/4503 (88.7630%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0928, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4275/4928 (86.7492%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4450/4928 (90.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8155, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3315/3804 (87.1451%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3437/3804 (90.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0127, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3168/3590 (88.2451%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3022/3590 (84.1783%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2329, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4053/4647 (87.2176%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4273/4647 (91.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8919, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3918/4625 (84.7135%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4075/4625 (88.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1069, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4047/4356 (92.9063%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4119/4356 (94.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9398, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3340/3797 (87.9642%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3462/3797 (91.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8484, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3966/4456 (89.0036%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4051/4456 (90.9111%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9843, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3546/4025 (88.0994%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3677/4025 (91.3540%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8563, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3064/3472 (88.2488%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3154/3472 (90.8410%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0365, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2868/3297 (86.9882%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3003/3297 (91.0828%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8908, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3827/4416 (86.6621%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3987/4416 (90.2853%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9618, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3924/4356 (90.0826%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4083/4356 (93.7328%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9534, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3117/3638 (85.6789%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3324/3638 (91.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8468, Accuracy: 5579/10000 (55.7900%)
time spent on training: 244.26338577270508
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.4220, Accuracy: 6558/10000 (65.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 10.1035, Accuracy: 85/9900 (0.8586%)
Done in 267.7446472644806 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4333/4885 (88.7001%), train_poison_data_count: 385
Global model norm: 43.02744570601856.
Norm before scaling: 43.030014563329075. Distance: 2.2269030929536413
Total norm for 4 adversaries is: 43.030014563329075. distance: 2.2269030929536413
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1353, Accuracy: 9547/9900 (96.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4733/5305 (89.2177%), train_poison_data_count: 415
Global model norm: 43.02744570601856.
Norm before scaling: 43.02837907997465. Distance: 2.242903219692119
Total norm for 4 adversaries is: 43.02837907997465. distance: 2.242903219692119
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1654, Accuracy: 9496/9900 (95.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4193/4717 (88.8912%), train_poison_data_count: 370
Global model norm: 43.02744570601856.
Norm before scaling: 43.02524411156054. Distance: 2.0956509060144417
Total norm for 4 adversaries is: 43.02524411156054. distance: 2.0956509060144417
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0853, Accuracy: 9672/9900 (97.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4446/5066 (87.7615%), train_poison_data_count: 400
Global model norm: 43.02744570601856.
Norm before scaling: 43.03359028222169. Distance: 2.3027367563534655
Total norm for 4 adversaries is: 43.03359028222169. distance: 2.3027367563534655
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0998, Accuracy: 9644/9900 (97.4141%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3587/4175 (85.9162%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3735/4175 (89.4611%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8659, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4195/4956 (84.6449%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4399/4956 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1983, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4397/5037 (87.2940%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4562/5037 (90.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0109, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4157/4793 (86.7306%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4315/4793 (90.0271%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0588, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3327/3804 (87.4606%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3445/3804 (90.5626%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9485, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4737/5392 (87.8524%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4792/5392 (88.8724%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9581, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3922/4465 (87.8387%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4075/4465 (91.2654%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9268, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4093/4596 (89.0557%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4229/4596 (92.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0535, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5341/6124 (87.2142%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5438/6124 (88.7982%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9677, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2839/3271 (86.7930%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2967/3271 (90.7062%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9287, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3244/3590 (90.3621%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3275/3590 (91.2256%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0388, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3885/4501 (86.3142%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4030/4501 (89.5357%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0693, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4536/5232 (86.6972%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4639/5232 (88.6659%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1357, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3185/3672 (86.7375%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3279/3672 (89.2974%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9468, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3701/4223 (87.6391%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3844/4223 (91.0253%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9632, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4116/4354 (94.5338%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0118, Accuracy: 3432/4354 (78.8241%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.4568, Accuracy: 4725/10000 (47.2500%)
time spent on training: 231.93685507774353
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.5376, Accuracy: 6337/10000 (63.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 9.4704, Accuracy: 208/9900 (2.1010%)
Done in 256.04766726493835 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 43.07429225559385.
Norm before scaling: 43.07754692212783. Distance: 2.191195173518815
Total norm for 4 adversaries is: 43.07754692212783. distance: 2.191195173518815
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2871, Accuracy: 9224/9900 (93.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4726/5305 (89.0858%), train_poison_data_count: 415
Global model norm: 43.07429225559385.
Norm before scaling: 43.07513392998259. Distance: 2.212871770281822
Total norm for 4 adversaries is: 43.07513392998259. distance: 2.212871770281822
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1594, Accuracy: 9495/9900 (95.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4168/4717 (88.3612%), train_poison_data_count: 370
Global model norm: 43.07429225559385.
Norm before scaling: 43.076207961969125. Distance: 2.1897475549131338
Total norm for 4 adversaries is: 43.076207961969125. distance: 2.1897475549131338
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0810, Accuracy: 9680/9900 (97.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4448/5066 (87.8010%), train_poison_data_count: 400
Global model norm: 43.07429225559385.
Norm before scaling: 43.0807985092583. Distance: 2.3015282653624323
Total norm for 4 adversaries is: 43.0807985092583. distance: 2.3015282653624323
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1397, Accuracy: 9561/9900 (96.5758%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4943/5582 (88.5525%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5031/5582 (90.1290%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1827, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4010/4647 (86.2922%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4210/4647 (90.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8924, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3896/4465 (87.2564%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4120/4465 (92.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7948, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4397/5083 (86.5040%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4496/5083 (88.4517%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9744, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3749/4416 (84.8958%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3966/4416 (89.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9492, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4218/4956 (85.1090%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4332/4956 (87.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0813, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3884/4362 (89.0417%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3847/4362 (88.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1078, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3987/4356 (91.5289%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3931/4356 (90.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1257, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3292/3781 (87.0669%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3431/3781 (90.7432%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0783, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3224/3590 (89.8050%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3245/3590 (90.3900%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0221, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4071/4651 (87.5296%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4222/4651 (90.7762%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0010, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4058/4662 (87.0442%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4251/4662 (91.1840%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9439, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3022/3472 (87.0392%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3209/3472 (92.4251%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9477, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4784/5424 (88.2006%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4957/5424 (91.3901%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1834, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2820/3271 (86.2122%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2892/3271 (88.4133%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8678, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4340/5037 (86.1624%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4540/5037 (90.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9632, Accuracy: 5496/10000 (54.9600%)
time spent on training: 231.24650716781616
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.4739, Accuracy: 6466/10000 (64.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 8.9518, Accuracy: 284/9900 (2.8687%)
Done in 254.68256902694702 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4343/4885 (88.9048%), train_poison_data_count: 385
Global model norm: 43.10488802990112.
Norm before scaling: 43.10624167436848. Distance: 2.160199846100252
Total norm for 4 adversaries is: 43.10624167436848. distance: 2.160199846100252
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2222, Accuracy: 9319/9900 (94.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4701/5305 (88.6145%), train_poison_data_count: 415
Global model norm: 43.10488802990112.
Norm before scaling: 43.104936172797395. Distance: 2.262509117318851
Total norm for 4 adversaries is: 43.104936172797395. distance: 2.262509117318851
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2038, Accuracy: 9381/9900 (94.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4220/4717 (89.4636%), train_poison_data_count: 370
Global model norm: 43.10488802990112.
Norm before scaling: 43.101044920537454. Distance: 2.0394333542364333
Total norm for 4 adversaries is: 43.101044920537454. distance: 2.0394333542364333
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3235, Accuracy: 9145/9900 (92.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4409/5066 (87.0312%), train_poison_data_count: 400
Global model norm: 43.10488802990112.
Norm before scaling: 43.11329522996285. Distance: 2.351227289685374
Total norm for 4 adversaries is: 43.11329522996285. distance: 2.351227289685374
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3173, Accuracy: 9091/9900 (91.8283%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4262/4989 (85.4279%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4425/4989 (88.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9756, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3569/4013 (88.9360%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3716/4013 (92.5991%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8213, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4447/5195 (85.6015%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4475/5195 (86.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0531, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3462/3969 (87.2260%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3543/3969 (89.2668%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0187, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4092/4356 (93.9394%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4109/4356 (94.3297%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9864, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3925/4441 (88.3810%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4009/4441 (90.2725%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0462, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4020/4518 (88.9774%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4136/4518 (91.5449%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9854, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3443/3911 (88.0338%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3343/3911 (85.4769%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0353, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3850/4362 (88.2623%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3897/4362 (89.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1048, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3337/3804 (87.7234%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3461/3804 (90.9832%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0761, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3650/4223 (86.4314%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3851/4223 (91.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0035, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4051/4634 (87.4191%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4207/4634 (90.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7852, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4162/4354 (95.5903%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3741/4354 (85.9210%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3822, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0087, Accuracy: 4320/5244 (82.3799%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4543/5244 (86.6323%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9375, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4352/5037 (86.4006%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8969, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3147/3704 (84.9622%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3365/3704 (90.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9023, Accuracy: 5588/10000 (55.8800%)
time spent on training: 231.15234780311584
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.5122, Accuracy: 6383/10000 (63.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 8.4284, Accuracy: 404/9900 (4.0808%)
Done in 254.56270670890808 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4368/4885 (89.4166%), train_poison_data_count: 385
Global model norm: 43.13949173402849.
Norm before scaling: 43.14231140311243. Distance: 2.1809339890108106
Total norm for 4 adversaries is: 43.14231140311243. distance: 2.1809339890108106
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1495, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4695/5305 (88.5014%), train_poison_data_count: 415
Global model norm: 43.13949173402849.
Norm before scaling: 43.1429607639133. Distance: 2.295584595135377
Total norm for 4 adversaries is: 43.1429607639133. distance: 2.295584595135377
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1135, Accuracy: 9627/9900 (97.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4186/4717 (88.7428%), train_poison_data_count: 370
Global model norm: 43.13949173402849.
Norm before scaling: 43.13829901371721. Distance: 2.112361122396825
Total norm for 4 adversaries is: 43.13829901371721. distance: 2.112361122396825
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1523, Accuracy: 9496/9900 (95.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4455/5066 (87.9392%), train_poison_data_count: 400
Global model norm: 43.13949173402849.
Norm before scaling: 43.14478995650141. Distance: 2.2891362409464096
Total norm for 4 adversaries is: 43.14478995650141. distance: 2.2891362409464096
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2195, Accuracy: 9366/9900 (94.6061%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3795/4416 (85.9375%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3948/4416 (89.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9488, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4504/5197 (86.6654%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4577/5197 (88.0700%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0571, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4277/4918 (86.9662%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4413/4918 (89.7316%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2184, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5535/6263 (88.3762%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5643/6263 (90.1006%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1224, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3119/3646 (85.5458%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3300/3646 (90.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7683, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4111/4707 (87.3380%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4246/4707 (90.2061%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8920, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4322/5063 (85.3644%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4382/5063 (86.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0861, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3666/4295 (85.3551%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3847/4295 (89.5693%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9568, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4144/4793 (86.4594%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4317/4793 (90.0689%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1004, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3995/4538 (88.0344%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4194/4538 (92.4196%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9046, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4456/5083 (87.6648%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4547/5083 (89.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9597, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3107/3638 (85.4041%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3257/3638 (89.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8850, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5322/6124 (86.9040%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5462/6124 (89.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9608, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4012/4618 (86.8774%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4081/4618 (88.3716%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9630, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3483/3969 (87.7551%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3578/3969 (90.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9271, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3465/4158 (83.3333%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3655/4158 (87.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9105, Accuracy: 5475/10000 (54.7500%)
time spent on training: 235.53515148162842
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.4727, Accuracy: 6461/10000 (64.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 9.0226, Accuracy: 273/9900 (2.7576%)
Done in 258.9518942832947 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4349/4885 (89.0276%), train_poison_data_count: 385
Global model norm: 43.176554329288486.
Norm before scaling: 43.17979139326202. Distance: 2.136712166673188
Total norm for 4 adversaries is: 43.17979139326202. distance: 2.136712166673188
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2670, Accuracy: 9236/9900 (93.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4684/5305 (88.2941%), train_poison_data_count: 415
Global model norm: 43.176554329288486.
Norm before scaling: 43.1775466777511. Distance: 2.26726225526631
Total norm for 4 adversaries is: 43.1775466777511. distance: 2.26726225526631
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2598, Accuracy: 9240/9900 (93.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4171/4717 (88.4248%), train_poison_data_count: 370
Global model norm: 43.176554329288486.
Norm before scaling: 43.17448050181452. Distance: 2.112188652615064
Total norm for 4 adversaries is: 43.17448050181452. distance: 2.112188652615064
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1738, Accuracy: 9431/9900 (95.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4446/5066 (87.7615%), train_poison_data_count: 400
Global model norm: 43.176554329288486.
Norm before scaling: 43.181370257377054. Distance: 2.308024224840097
Total norm for 4 adversaries is: 43.181370257377054. distance: 2.308024224840097
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2418, Accuracy: 9302/9900 (93.9596%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4046/4716 (85.7930%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4153/4716 (88.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0642, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3910/4481 (87.2573%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3972/4481 (88.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9744, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3869/4361 (88.7182%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3889/4361 (89.1768%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9696, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4148/4793 (86.5429%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9732, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3741/4295 (87.1013%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3781/4295 (88.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1087, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4383/5244 (83.5812%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4553/5244 (86.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9888, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4300/4989 (86.1896%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4460/4989 (89.3967%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9902, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4513/5197 (86.8386%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4598/5197 (88.4741%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0618, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3887/4356 (89.2332%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3828/4356 (87.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2263, Accuracy: 4918/10000 (49.1800%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4028/4647 (86.6796%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4173/4647 (89.7999%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9834, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3581/4013 (89.2350%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3726/4013 (92.8482%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8380, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4000/4538 (88.1446%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4166/4538 (91.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8162, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4119/4707 (87.5080%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4231/4707 (89.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8778, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5510/6263 (87.9770%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5674/6263 (90.5956%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1623, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3728/4235 (88.0283%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3775/4235 (89.1381%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9504, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3377/3861 (87.4644%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3481/3861 (90.1580%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9879, Accuracy: 5493/10000 (54.9300%)
time spent on training: 232.48545026779175
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.4748, Accuracy: 6455/10000 (64.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 8.8354, Accuracy: 278/9900 (2.8081%)
Done in 255.8584270477295 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4327/4885 (88.5773%), train_poison_data_count: 385
Global model norm: 43.204636614604226.
Norm before scaling: 43.207552327399895. Distance: 2.215581000877141
Total norm for 4 adversaries is: 43.207552327399895. distance: 2.215581000877141
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1151, Accuracy: 9592/9900 (96.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4693/5305 (88.4637%), train_poison_data_count: 415
Global model norm: 43.204636614604226.
Norm before scaling: 43.20884766574506. Distance: 2.2636018335731687
Total norm for 4 adversaries is: 43.20884766574506. distance: 2.2636018335731687
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1753, Accuracy: 9488/9900 (95.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4191/4717 (88.8488%), train_poison_data_count: 370
Global model norm: 43.204636614604226.
Norm before scaling: 43.20499120065224. Distance: 2.10357456248677
Total norm for 4 adversaries is: 43.20499120065224. distance: 2.10357456248677
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1566, Accuracy: 9504/9900 (96.0000%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4435/5066 (87.5444%), train_poison_data_count: 400
Global model norm: 43.204636614604226.
Norm before scaling: 43.21010623974443. Distance: 2.3305311633917363
Total norm for 4 adversaries is: 43.21010623974443. distance: 2.3305311633917363
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0999, Accuracy: 9640/9900 (97.3737%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4440/5055 (87.8338%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4584/5055 (90.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8815, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3322/3828 (86.7816%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3526/3828 (92.1108%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9563, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3831/4361 (87.8468%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3883/4361 (89.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9930, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3544/4013 (88.3130%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9175, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4000/4518 (88.5347%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4149/4518 (91.8327%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8555, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3952/4558 (86.7047%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4080/4558 (89.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0900, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3626/4126 (87.8817%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3761/4126 (91.1537%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9253, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4146/4679 (88.6087%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3981/4679 (85.0823%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1187, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3750/4235 (88.5478%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3780/4235 (89.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9483, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4313/5037 (85.6264%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4613/5037 (91.5823%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9029, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3143/3672 (85.5937%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3342/3672 (91.0131%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8765, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4292/4928 (87.0942%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4412/4928 (89.5292%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0038, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4063/4356 (93.2736%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3946/4356 (90.5877%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0070, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3971/4456 (89.1158%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4098/4456 (91.9659%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0115, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4135/4793 (86.2716%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4332/4793 (90.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8944, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4406/5025 (87.6816%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4526/5025 (90.0697%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0126, Accuracy: 5465/10000 (54.6500%)
time spent on training: 228.71886610984802
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.5230, Accuracy: 6335/10000 (63.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 9.2170, Accuracy: 193/9900 (1.9495%)
Done in 252.20851826667786 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 43.24145423384616.
Norm before scaling: 43.24457070555577. Distance: 2.152561626726224
Total norm for 4 adversaries is: 43.24457070555577. distance: 2.152561626726224
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0847, Accuracy: 9682/9900 (97.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4712/5305 (88.8219%), train_poison_data_count: 415
Global model norm: 43.24145423384616.
Norm before scaling: 43.24200330245322. Distance: 2.2698229603902798
Total norm for 4 adversaries is: 43.24200330245322. distance: 2.2698229603902798
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0970, Accuracy: 9630/9900 (97.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.24145423384616.
Norm before scaling: 43.23979710533963. Distance: 2.065439845571947
Total norm for 4 adversaries is: 43.23979710533963. distance: 2.065439845571947
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2418, Accuracy: 9302/9900 (93.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4435/5066 (87.5444%), train_poison_data_count: 400
Global model norm: 43.24145423384616.
Norm before scaling: 43.24687404030276. Distance: 2.2943062463828063
Total norm for 4 adversaries is: 43.24687404030276. distance: 2.2943062463828063
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2439, Accuracy: 9295/9900 (93.8889%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3882/4346 (89.3235%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4039/4346 (92.9360%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9346, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3658/4184 (87.4283%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3759/4184 (89.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9963, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4033/4356 (92.5849%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3845/4356 (88.2691%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1025, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3178/3646 (87.1640%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3308/3646 (90.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7575, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4462/5083 (87.7828%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4532/5083 (89.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0456, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3989/4356 (91.5748%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3964/4356 (91.0009%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0965, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3957/4558 (86.8144%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4076/4558 (89.4252%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1239, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3612/4175 (86.5150%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3741/4175 (89.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8283, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3059/3472 (88.1048%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3160/3472 (91.0138%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0385, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3923/4501 (87.1584%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4041/4501 (89.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0842, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4797/5424 (88.4403%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4973/5424 (91.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2325, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3912/4481 (87.3019%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4017/4481 (89.6452%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0196, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4745/5455 (86.9844%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4891/5455 (89.6609%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0770, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4521/5232 (86.4106%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4662/5232 (89.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0098, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5463/6391 (85.4796%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5539/6391 (86.6688%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0761, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3357/3775 (88.9272%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3534/3775 (93.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8723, Accuracy: 5690/10000 (56.9000%)
time spent on training: 235.001202583313
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.5113, Accuracy: 6367/10000 (63.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 9.4640, Accuracy: 141/9900 (1.4242%)
Done in 258.36406421661377 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4376/4885 (89.5803%), train_poison_data_count: 385
Global model norm: 43.28890247105414.
Norm before scaling: 43.28470343848751. Distance: 2.156711363154834
Total norm for 4 adversaries is: 43.28470343848751. distance: 2.156711363154834
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1286, Accuracy: 9539/9900 (96.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4743/5305 (89.4062%), train_poison_data_count: 415
Global model norm: 43.28890247105414.
Norm before scaling: 43.28287169795779. Distance: 2.1920442519419914
Total norm for 4 adversaries is: 43.28287169795779. distance: 2.1920442519419914
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1071, Accuracy: 9614/9900 (97.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4209/4717 (89.2304%), train_poison_data_count: 370
Global model norm: 43.28890247105414.
Norm before scaling: 43.285394375134636. Distance: 2.062510981675014
Total norm for 4 adversaries is: 43.285394375134636. distance: 2.062510981675014
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1300, Accuracy: 9560/9900 (96.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4442/5066 (87.6826%), train_poison_data_count: 400
Global model norm: 43.28890247105414.
Norm before scaling: 43.29187454207992. Distance: 2.2934772505994765
Total norm for 4 adversaries is: 43.29187454207992. distance: 2.2934772505994765
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1245, Accuracy: 9552/9900 (96.4848%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3573/4025 (88.7702%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3724/4025 (92.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7824, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3707/4223 (87.7812%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3829/4223 (90.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0158, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3166/3638 (87.0258%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3329/3638 (91.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9061, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4410/5063 (87.1025%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4487/5063 (88.6233%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0858, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4240/4874 (86.9922%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4269/4874 (87.5872%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1509, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4339/4804 (90.3206%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4185/4804 (87.1149%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3794, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3540/4158 (85.1371%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3660/4158 (88.0231%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9103, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4003/4518 (88.6012%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4155/4518 (91.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9206, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3736/4235 (88.2172%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3707/4235 (87.5325%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0486, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4273/4934 (86.6032%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4118/4934 (83.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1701, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5553/6391 (86.8878%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5684/6391 (88.9376%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9791, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3723/4295 (86.6822%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3797/4295 (88.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0331, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3356/3756 (89.3504%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3477/3756 (92.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9122, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3960/4481 (88.3731%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3962/4481 (88.4178%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9671, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3636/4175 (87.0898%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3675/4175 (88.0240%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9479, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3227/3590 (89.8886%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3192/3590 (88.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0906, Accuracy: 5387/10000 (53.8700%)
time spent on training: 229.9194598197937
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.5437, Accuracy: 6313/10000 (63.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 9.6291, Accuracy: 105/9900 (1.0606%)
Done in 253.5905749797821 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4385/4885 (89.7646%), train_poison_data_count: 385
Global model norm: 43.329537875900115.
Norm before scaling: 43.331371869419705. Distance: 2.152153103618512
Total norm for 4 adversaries is: 43.331371869419705. distance: 2.152153103618512
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2064, Accuracy: 9378/9900 (94.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 43.329537875900115.
Norm before scaling: 43.32748545777553. Distance: 2.175242495994834
Total norm for 4 adversaries is: 43.32748545777553. distance: 2.175242495994834
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2746, Accuracy: 9224/9900 (93.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4199/4717 (89.0184%), train_poison_data_count: 370
Global model norm: 43.329537875900115.
Norm before scaling: 43.33041685022269. Distance: 2.065407408826359
Total norm for 4 adversaries is: 43.33041685022269. distance: 2.065407408826359
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1021, Accuracy: 9652/9900 (97.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4438/5066 (87.6036%), train_poison_data_count: 400
Global model norm: 43.329537875900115.
Norm before scaling: 43.33416356000554. Distance: 2.2901158952329537
Total norm for 4 adversaries is: 43.33416356000554. distance: 2.2901158952329537
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1431, Accuracy: 9517/9900 (96.1313%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3364/3828 (87.8788%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3536/3828 (92.3720%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7992, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3479/3911 (88.9542%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3346/3911 (85.5536%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0976, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3929/4362 (90.0734%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3936/4362 (90.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9602, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4605/5197 (88.6088%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4611/5197 (88.7243%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1742, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4287/4679 (91.6221%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4357/4679 (93.1182%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9139, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4131/4793 (86.1882%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4319/4793 (90.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9945, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4420/5116 (86.3956%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4592/5116 (89.7576%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0155, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3929/4625 (84.9514%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4044/4625 (87.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1458, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4109/4618 (88.9779%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4192/4618 (90.7752%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9281, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2878/3271 (87.9853%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2965/3271 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9671, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3673/4175 (87.9760%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3719/4175 (89.0778%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9566, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3123/3616 (86.3662%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3302/3616 (91.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7882, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3883/4481 (86.6548%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3989/4481 (89.0203%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0871, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3832/4368 (87.7289%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3961/4368 (90.6822%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8456, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4995/5740 (87.0209%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5206/5740 (90.6969%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1568, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4024/4647 (86.5935%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4190/4647 (90.1657%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9645, Accuracy: 5510/10000 (55.1000%)
time spent on training: 230.7394003868103
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.5821, Accuracy: 6288/10000 (62.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 8.2645, Accuracy: 304/9900 (3.0707%)
Done in 254.51961088180542 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 43.36474910389486.
Norm before scaling: 43.361396349280255. Distance: 2.0882111348869796
Total norm for 4 adversaries is: 43.361396349280255. distance: 2.0882111348869796
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2461, Accuracy: 9231/9900 (93.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 43.36474910389486.
Norm before scaling: 43.35808838181176. Distance: 2.135738168720499
Total norm for 4 adversaries is: 43.35808838181176. distance: 2.135738168720499
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2442, Accuracy: 9295/9900 (93.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4208/4717 (89.2092%), train_poison_data_count: 370
Global model norm: 43.36474910389486.
Norm before scaling: 43.36534305774168. Distance: 2.0673607855241896
Total norm for 4 adversaries is: 43.36534305774168. distance: 2.0673607855241896
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1669, Accuracy: 9451/9900 (95.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4468/5066 (88.1958%), train_poison_data_count: 400
Global model norm: 43.36474910389486.
Norm before scaling: 43.36895023777452. Distance: 2.2531051402069875
Total norm for 4 adversaries is: 43.36895023777452. distance: 2.2531051402069875
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1239, Accuracy: 9566/9900 (96.6263%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4895/5591 (87.5514%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4991/5591 (89.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9994, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4229/4956 (85.3309%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4331/4956 (87.3890%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0587, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3932/4511 (87.1647%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4104/4511 (90.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9726, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3564/4013 (88.8114%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3681/4013 (91.7269%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8726, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3264/3590 (90.9192%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3345/3590 (93.1755%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8763, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4182/4793 (87.2522%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4351/4793 (90.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9579, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3358/3804 (88.2755%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3450/3804 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9350, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3379/3837 (88.0636%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3542/3837 (92.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8921, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3901/4361 (89.4520%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3833/4361 (87.8927%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1219, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4464/5063 (88.1691%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4429/5063 (87.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1199, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3793/4368 (86.8361%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3931/4368 (89.9954%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9746, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4277/4679 (91.4084%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4177/4679 (89.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0509, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4617/5265 (87.6923%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4695/5265 (89.1738%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0869, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4101/4767 (86.0289%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4190/4767 (87.8960%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1930, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5179/5902 (87.7499%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4943/5902 (83.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1946, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3701/4223 (87.6391%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3849/4223 (91.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0152, Accuracy: 5447/10000 (54.4700%)
time spent on training: 232.93686747550964
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.5899, Accuracy: 6273/10000 (62.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 8.6642, Accuracy: 263/9900 (2.6566%)
Done in 256.62312173843384 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 43.413102973245586.
Norm before scaling: 43.41004781126787. Distance: 2.059756448292307
Total norm for 4 adversaries is: 43.41004781126787. distance: 2.059756448292307
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.3616, Accuracy: 8988/9900 (90.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 43.413102973245586.
Norm before scaling: 43.41128649236135. Distance: 2.1980295980888673
Total norm for 4 adversaries is: 43.41128649236135. distance: 2.1980295980888673
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2426, Accuracy: 9235/9900 (93.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4221/4717 (89.4848%), train_poison_data_count: 370
Global model norm: 43.413102973245586.
Norm before scaling: 43.4087247314696. Distance: 2.0298025989861257
Total norm for 4 adversaries is: 43.4087247314696. distance: 2.0298025989861257
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1751, Accuracy: 9452/9900 (95.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4443/5066 (87.7023%), train_poison_data_count: 400
Global model norm: 43.413102973245586.
Norm before scaling: 43.41681302583496. Distance: 2.2816123152120937
Total norm for 4 adversaries is: 43.41681302583496. distance: 2.2816123152120937
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1567, Accuracy: 9493/9900 (95.8889%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3371/3797 (88.7806%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3439/3797 (90.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9289, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3363/3861 (87.1018%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3446/3861 (89.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9889, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4153/4707 (88.2303%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4256/4707 (90.4185%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0021, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4032/4518 (89.2430%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4156/4518 (91.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9989, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3590/4013 (89.4593%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8582, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4610/5167 (89.2201%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4671/5167 (90.4006%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1653, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3500/3969 (88.1834%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3636/3969 (91.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9670, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3978/4441 (89.5744%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4117/4441 (92.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9545, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4000/4558 (87.7578%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4064/4558 (89.1619%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9984, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3948/4465 (88.4211%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4137/4465 (92.6540%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8584, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3159/3638 (86.8334%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8801, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4031/4538 (88.8277%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7887, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5032/5740 (87.6655%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5184/5740 (90.3136%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2520, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3353/3837 (87.3860%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3505/3837 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9148, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3882/4361 (89.0163%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3732/4361 (85.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9404, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4170/4793 (87.0019%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4318/4793 (90.0897%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9517, Accuracy: 5537/10000 (55.3700%)
time spent on training: 228.96328234672546
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.5211, Accuracy: 6393/10000 (63.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 8.8630, Accuracy: 212/9900 (2.1414%)
Done in 252.4090452194214 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4383/4885 (89.7236%), train_poison_data_count: 385
Global model norm: 43.44495917294736.
Norm before scaling: 43.443443275963695. Distance: 2.104107305111153
Total norm for 4 adversaries is: 43.443443275963695. distance: 2.104107305111153
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2066, Accuracy: 9354/9900 (94.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4741/5305 (89.3685%), train_poison_data_count: 415
Global model norm: 43.44495917294736.
Norm before scaling: 43.44256518354507. Distance: 2.1758364768013467
Total norm for 4 adversaries is: 43.44256518354507. distance: 2.1758364768013467
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1342, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4247/4717 (90.0360%), train_poison_data_count: 370
Global model norm: 43.44495917294736.
Norm before scaling: 43.44016965717042. Distance: 2.014549027328027
Total norm for 4 adversaries is: 43.44016965717042. distance: 2.014549027328027
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2059, Accuracy: 9388/9900 (94.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 43.44495917294736.
Norm before scaling: 43.446642192158386. Distance: 2.222420463726505
Total norm for 4 adversaries is: 43.446642192158386. distance: 2.222420463726505
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2616, Accuracy: 9223/9900 (93.1616%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4100/4767 (86.0080%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4238/4767 (88.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1507, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3953/4441 (89.0115%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4114/4441 (92.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9900, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4005/4356 (91.9421%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1171, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5570/6391 (87.1538%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5620/6391 (87.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0857, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3694/4184 (88.2887%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3783/4184 (90.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9910, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3907/4346 (89.8988%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4035/4346 (92.8440%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7313, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4358/5037 (86.5198%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0131, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4064/4634 (87.6996%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4225/4634 (91.1739%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9125, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4395/4934 (89.0758%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4413/4934 (89.4406%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0496, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4790/5424 (88.3112%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4933/5424 (90.9476%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0628, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3340/3781 (88.3364%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3335/3781 (88.2042%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9653, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3394/3861 (87.9047%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3510/3861 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9097, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4510/5055 (89.2186%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4650/5055 (91.9881%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8650, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3957/4433 (89.2624%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4052/4433 (91.4054%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7731, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4588/5167 (88.7943%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4709/5167 (91.1361%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1455, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3233/3590 (90.0557%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3194/3590 (88.9694%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9838, Accuracy: 5478/10000 (54.7800%)
time spent on training: 232.26524233818054
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.7203, Accuracy: 6074/10000 (60.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 6.7614, Accuracy: 836/9900 (8.4444%)
Done in 255.72790336608887 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4386/4885 (89.7851%), train_poison_data_count: 385
Global model norm: 43.47315027602526.
Norm before scaling: 43.472125363199694. Distance: 2.1534858345892625
Total norm for 4 adversaries is: 43.472125363199694. distance: 2.1534858345892625
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2683, Accuracy: 9215/9900 (93.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4755/5305 (89.6324%), train_poison_data_count: 415
Global model norm: 43.47315027602526.
Norm before scaling: 43.47056829185912. Distance: 2.138262816723559
Total norm for 4 adversaries is: 43.47056829185912. distance: 2.138262816723559
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2336, Accuracy: 9335/9900 (94.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4213/4717 (89.3152%), train_poison_data_count: 370
Global model norm: 43.47315027602526.
Norm before scaling: 43.47150899987902. Distance: 2.053566978876257
Total norm for 4 adversaries is: 43.47150899987902. distance: 2.053566978876257
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2010, Accuracy: 9366/9900 (94.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4467/5066 (88.1761%), train_poison_data_count: 400
Global model norm: 43.47315027602526.
Norm before scaling: 43.477154224409915. Distance: 2.2539922476350007
Total norm for 4 adversaries is: 43.477154224409915. distance: 2.2539922476350007
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1674, Accuracy: 9482/9900 (95.7778%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3810/4368 (87.2253%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3919/4368 (89.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9855, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3366/3828 (87.9310%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3513/3828 (91.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7649, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4158/4356 (95.4545%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3866/4356 (88.7511%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0829, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3375/3861 (87.4126%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3494/3861 (90.4947%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9312, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3047/3472 (87.7592%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9747, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4090/4538 (90.1278%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4185/4538 (92.2212%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9165, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4780/5392 (88.6499%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4827/5392 (89.5215%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9415, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3748/4295 (87.2643%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3730/4295 (86.8452%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0980, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3738/4235 (88.2645%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3829/4235 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9943, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3998/4456 (89.7217%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4097/4456 (91.9434%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9600, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4576/5265 (86.9136%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4605/5265 (87.4644%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9719, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3983/4441 (89.6870%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4082/4441 (91.9162%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0851, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3597/4013 (89.6337%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3695/4013 (92.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8490, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3932/4465 (88.0627%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4118/4465 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7681, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5554/6263 (88.6795%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5696/6263 (90.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9660, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4399/4986 (88.2270%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4519/4986 (90.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8240, Accuracy: 5846/10000 (58.4600%)
time spent on training: 231.61483144760132
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.6882, Accuracy: 6111/10000 (61.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 6.7384, Accuracy: 778/9900 (7.8586%)
Done in 254.87283992767334 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4344/4885 (88.9253%), train_poison_data_count: 385
Global model norm: 43.502556385911106.
Norm before scaling: 43.50620549981563. Distance: 2.165989097384614
Total norm for 4 adversaries is: 43.50620549981563. distance: 2.165989097384614
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1863, Accuracy: 9424/9900 (95.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 43.502556385911106.
Norm before scaling: 43.50365073132512. Distance: 2.2149014473856075
Total norm for 4 adversaries is: 43.50365073132512. distance: 2.2149014473856075
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1527, Accuracy: 9540/9900 (96.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4211/4717 (89.2728%), train_poison_data_count: 370
Global model norm: 43.502556385911106.
Norm before scaling: 43.49846637697055. Distance: 2.032482653516857
Total norm for 4 adversaries is: 43.49846637697055. distance: 2.032482653516857
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1563, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4448/5066 (87.8010%), train_poison_data_count: 400
Global model norm: 43.502556385911106.
Norm before scaling: 43.50540302966331. Distance: 2.273703333463338
Total norm for 4 adversaries is: 43.50540302966331. distance: 2.273703333463338
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1902, Accuracy: 9399/9900 (94.9394%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3548/4158 (85.3295%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3689/4158 (88.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0094, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4527/5167 (87.6137%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4653/5167 (90.0523%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1378, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3331/3828 (87.0167%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3467/3828 (90.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9032, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4111/4663 (88.1621%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4274/4663 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9932, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3938/4433 (88.8337%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4088/4433 (92.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9269, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3699/4184 (88.4082%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3784/4184 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8383, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4085/4716 (86.6200%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4190/4716 (88.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0315, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3741/4223 (88.5863%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3877/4223 (91.8068%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8529, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4249/4679 (90.8100%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4229/4679 (90.3826%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0003, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3192/3704 (86.1771%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3353/3704 (90.5238%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8604, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3338/3837 (86.9950%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3525/3837 (91.8686%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8157, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3388/3861 (87.7493%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3453/3861 (89.4328%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9150, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4804/5424 (88.5693%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4917/5424 (90.6527%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0535, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4057/4576 (88.6582%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4219/4576 (92.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8728, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3545/4025 (88.0745%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3723/4025 (92.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8841, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3383/3775 (89.6159%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3563/3775 (94.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8317, Accuracy: 5714/10000 (57.1400%)
time spent on training: 228.01391553878784
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.6342, Accuracy: 6189/10000 (61.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 7.0155, Accuracy: 642/9900 (6.4848%)
Done in 251.38897347450256 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4391/4885 (89.8874%), train_poison_data_count: 385
Global model norm: 43.53082936803238.
Norm before scaling: 43.52939498246056. Distance: 2.103045992904745
Total norm for 4 adversaries is: 43.52939498246056. distance: 2.103045992904745
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1971, Accuracy: 9393/9900 (94.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4725/5305 (89.0669%), train_poison_data_count: 415
Global model norm: 43.53082936803238.
Norm before scaling: 43.53051809775959. Distance: 2.259098834918241
Total norm for 4 adversaries is: 43.53051809775959. distance: 2.259098834918241
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3120, Accuracy: 9110/9900 (92.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 43.53082936803238.
Norm before scaling: 43.52848497140981. Distance: 2.0244651747497198
Total norm for 4 adversaries is: 43.52848497140981. distance: 2.0244651747497198
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2975, Accuracy: 9158/9900 (92.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 43.53082936803238.
Norm before scaling: 43.530651299274886. Distance: 2.250312465587733
Total norm for 4 adversaries is: 43.530651299274886. distance: 2.250312465587733
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0949, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4036/4576 (88.1993%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4216/4576 (92.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8653, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3219/3672 (87.6634%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3353/3672 (91.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0039, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4133/4618 (89.4976%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4153/4618 (89.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0500, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4037/4538 (88.9599%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4222/4538 (93.0366%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8563, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4447/5025 (88.4975%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4567/5025 (90.8856%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1142, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3225/3590 (89.8329%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3265/3590 (90.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8891, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4106/4707 (87.2318%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4291/4707 (91.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9756, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4328/4918 (88.0033%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4451/4918 (90.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9281, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3816/4336 (88.0074%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3935/4336 (90.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0294, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5277/5902 (89.4104%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5273/5902 (89.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1252, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3980/4441 (89.6195%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4091/4441 (92.1189%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0529, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4465/5232 (85.3402%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4672/5232 (89.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0450, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4274/4804 (88.9675%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4329/4804 (90.1124%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0417, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3511/3969 (88.4606%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3618/3969 (91.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9841, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4789/5392 (88.8168%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4841/5392 (89.7812%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9869, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3348/3828 (87.4608%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3508/3828 (91.6405%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8335, Accuracy: 5751/10000 (57.5100%)
time spent on training: 231.46541023254395
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.6346, Accuracy: 6205/10000 (62.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 6.8600, Accuracy: 676/9900 (6.8283%)
Done in 254.63174605369568 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4408/4885 (90.2354%), train_poison_data_count: 385
Global model norm: 43.56136650022801.
Norm before scaling: 43.55973135032515. Distance: 2.0924594374796275
Total norm for 4 adversaries is: 43.55973135032515. distance: 2.0924594374796275
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1069, Accuracy: 9636/9900 (97.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4685/5305 (88.3129%), train_poison_data_count: 415
Global model norm: 43.56136650022801.
Norm before scaling: 43.5625812633747. Distance: 2.2571058388411283
Total norm for 4 adversaries is: 43.5625812633747. distance: 2.2571058388411283
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2130, Accuracy: 9383/9900 (94.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4200/4717 (89.0396%), train_poison_data_count: 370
Global model norm: 43.56136650022801.
Norm before scaling: 43.55668927574802. Distance: 2.0418911894783203
Total norm for 4 adversaries is: 43.55668927574802. distance: 2.0418911894783203
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3147, Accuracy: 9127/9900 (92.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4496/5066 (88.7485%), train_poison_data_count: 400
Global model norm: 43.56136650022801.
Norm before scaling: 43.56249299452956. Distance: 2.258959416200957
Total norm for 4 adversaries is: 43.56249299452956. distance: 2.258959416200957
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0950, Accuracy: 9658/9900 (97.5556%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4498/5232 (85.9709%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4595/5232 (87.8249%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9936, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4282/4956 (86.4003%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4402/4956 (88.8216%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1269, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4422/5063 (87.3395%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4490/5063 (88.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0418, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3576/4025 (88.8447%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3738/4025 (92.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8681, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3972/4441 (89.4393%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4079/4441 (91.8487%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0625, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3961/4625 (85.6432%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4016/4625 (86.8324%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1497, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4892/5591 (87.4978%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4941/5591 (88.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1650, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5023/5582 (89.9857%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5085/5582 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2609, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5306/5902 (89.9017%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5310/5902 (89.9695%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0146, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4065/4538 (89.5769%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4187/4538 (92.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7801, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4447/5025 (88.4975%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4598/5025 (91.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9474, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3697/4223 (87.5444%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3872/4223 (91.6884%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8654, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3902/4361 (89.4749%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3855/4361 (88.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1136, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4132/4354 (94.9012%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3885/4354 (89.2283%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2132, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3216/3672 (87.5817%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3346/3672 (91.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0328, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3988/4356 (91.5519%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4032/4356 (92.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1369, Accuracy: 5229/10000 (52.2900%)
time spent on training: 251.55747818946838
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
Client 3 misclassified the most to class 2 with 1 misclassifications.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 3 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.5687, Accuracy: 6289/10000 (62.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 6.4870, Accuracy: 835/9900 (8.4343%)
Done in 278.3946166038513 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 43.58410651625559.
Norm before scaling: 43.582479221783466. Distance: 2.057613016132459
Total norm for 4 adversaries is: 43.582479221783466. distance: 2.057613016132459
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1114, Accuracy: 9632/9900 (97.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4766/5305 (89.8398%), train_poison_data_count: 415
Global model norm: 43.58410651625559.
Norm before scaling: 43.57985049470254. Distance: 2.123176353177162
Total norm for 4 adversaries is: 43.57985049470254. distance: 2.123176353177162
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1535, Accuracy: 9512/9900 (96.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.58410651625559.
Norm before scaling: 43.58077343825558. Distance: 1.9802748605896294
Total norm for 4 adversaries is: 43.58077343825558. distance: 1.9802748605896294
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.3380, Accuracy: 9093/9900 (91.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 43.58410651625559.
Norm before scaling: 43.58705985851047. Distance: 2.2527505169259223
Total norm for 4 adversaries is: 43.58705985851047. distance: 2.2527505169259223
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1392, Accuracy: 9552/9900 (96.4848%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3399/3828 (88.7931%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3515/3828 (91.8234%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8233, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3756/4235 (88.6895%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3771/4235 (89.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8584, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3243/3704 (87.5540%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3316/3704 (89.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8570, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3618/4046 (89.4217%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3761/4046 (92.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8908, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4381/4928 (88.9002%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4414/4928 (89.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7965, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5075/5740 (88.4146%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5131/5740 (89.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0747, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4455/5083 (87.6451%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4565/5083 (89.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9204, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4079/4576 (89.1390%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4135/4576 (90.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9174, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4095/4647 (88.1214%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4230/4647 (91.0265%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8807, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4847/5424 (89.3621%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4944/5424 (91.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2184, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3951/4503 (87.7415%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4022/4503 (89.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8750, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5589/6391 (87.4511%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5718/6391 (89.4696%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9817, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3977/4511 (88.1623%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4077/4511 (90.3791%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9569, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4028/4456 (90.3950%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8908, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4405/4804 (91.6944%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4347/4804 (90.4871%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0303, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3360/3804 (88.3281%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3475/3804 (91.3512%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9308, Accuracy: 5570/10000 (55.7000%)
time spent on training: 241.6737983226776
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.5844, Accuracy: 6289/10000 (62.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 6.7575, Accuracy: 749/9900 (7.5657%)
Done in 266.42372369766235 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 43.627982750824614.
Norm before scaling: 43.62712935795369. Distance: 2.0624339931213957
Total norm for 4 adversaries is: 43.62712935795369. distance: 2.0624339931213957
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1928, Accuracy: 9403/9900 (94.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 43.627982750824614.
Norm before scaling: 43.626389270948295. Distance: 2.1750797257116585
Total norm for 4 adversaries is: 43.626389270948295. distance: 2.1750797257116585
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1934, Accuracy: 9410/9900 (95.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4229/4717 (89.6544%), train_poison_data_count: 370
Global model norm: 43.627982750824614.
Norm before scaling: 43.62274601313588. Distance: 1.9852211417288963
Total norm for 4 adversaries is: 43.62274601313588. distance: 1.9852211417288963
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1694, Accuracy: 9465/9900 (95.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4527/5066 (89.3604%), train_poison_data_count: 400
Global model norm: 43.627982750824614.
Norm before scaling: 43.62764978969042. Distance: 2.1703558349677174
Total norm for 4 adversaries is: 43.62764978969042. distance: 2.1703558349677174
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1249, Accuracy: 9569/9900 (96.6566%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4373/4928 (88.7378%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8522, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4377/5037 (86.8970%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4559/5037 (90.5102%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9230, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4843/5392 (89.8182%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4877/5392 (90.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0863, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3984/4501 (88.5137%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4016/4501 (89.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0313, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3359/3804 (88.3018%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3480/3804 (91.4826%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9657, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3401/3837 (88.6370%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3547/3837 (92.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8109, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4475/5063 (88.3863%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4159/5063 (82.1450%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3396, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4031/4481 (89.9576%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4042/4481 (90.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9630, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4042/4518 (89.4644%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4146/4518 (91.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9210, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3162/3638 (86.9159%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3320/3638 (91.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8443, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4160/4663 (89.2130%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4274/4663 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9209, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3972/4625 (85.8811%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0593, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4597/5197 (88.4549%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4649/5197 (89.4555%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0903, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4486/5083 (88.2550%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4591/5083 (90.3207%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0696, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3395/3828 (88.6886%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3532/3828 (92.2675%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8176, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3191/3704 (86.1501%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3368/3704 (90.9287%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9136, Accuracy: 5576/10000 (55.7600%)
time spent on training: 231.97161173820496
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.5659, Accuracy: 6296/10000 (62.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 7.3374, Accuracy: 501/9900 (5.0606%)
Done in 255.2288339138031 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 43.66951441518228.
Norm before scaling: 43.66595722427827. Distance: 2.102922984789518
Total norm for 4 adversaries is: 43.66595722427827. distance: 2.102922984789518
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1543, Accuracy: 9506/9900 (96.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 43.66951441518228.
Norm before scaling: 43.666735777666766. Distance: 2.1493540525400103
Total norm for 4 adversaries is: 43.666735777666766. distance: 2.1493540525400103
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1300, Accuracy: 9569/9900 (96.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 43.66951441518228.
Norm before scaling: 43.66419739087234. Distance: 1.989909107106935
Total norm for 4 adversaries is: 43.66419739087234. distance: 1.989909107106935
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2171, Accuracy: 9367/9900 (94.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4489/5066 (88.6103%), train_poison_data_count: 400
Global model norm: 43.66951441518228.
Norm before scaling: 43.669162203310734. Distance: 2.2036616977044563
Total norm for 4 adversaries is: 43.669162203310734. distance: 2.2036616977044563
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1648, Accuracy: 9484/9900 (95.7980%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3526/3861 (91.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8969, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3751/4184 (89.6511%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3844/4184 (91.8738%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8615, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4386/5037 (87.0756%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4576/5037 (90.8477%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9060, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4572/5197 (87.9738%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4609/5197 (88.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1044, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4429/5025 (88.1393%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4561/5025 (90.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9392, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4491/5116 (87.7834%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4572/5116 (89.3667%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9979, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4059/4481 (90.5825%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4071/4481 (90.8503%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0476, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4080/4576 (89.1608%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4154/4576 (90.7780%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9508, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4557/5232 (87.0986%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4692/5232 (89.6789%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0983, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4086/4354 (93.8447%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4071/4354 (93.5002%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1092, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2910/3271 (88.9636%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2889/3271 (88.3216%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9604, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4816/5455 (88.2860%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4927/5455 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9634, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3658/4126 (88.6573%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3805/4126 (92.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9088, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3334/3797 (87.8062%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3446/3797 (90.7559%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9681, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3242/3704 (87.5270%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3374/3704 (91.0907%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8041, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4424/4934 (89.6636%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4378/4934 (88.7313%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0536, Accuracy: 5348/10000 (53.4800%)
time spent on training: 233.04064536094666
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7030, Accuracy: 6144/10000 (61.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 7.3140, Accuracy: 528/9900 (5.3333%)
Done in 256.41922903060913 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 43.69717514021215.
Norm before scaling: 43.69174134454646. Distance: 2.0087464531592416
Total norm for 4 adversaries is: 43.69174134454646. distance: 2.0087464531592416
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2316, Accuracy: 9297/9900 (93.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 43.69717514021215.
Norm before scaling: 43.695665199497334. Distance: 2.187619015317054
Total norm for 4 adversaries is: 43.695665199497334. distance: 2.187619015317054
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.3574, Accuracy: 9056/9900 (91.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4249/4717 (90.0784%), train_poison_data_count: 370
Global model norm: 43.69717514021215.
Norm before scaling: 43.69147592333515. Distance: 2.0253764991672303
Total norm for 4 adversaries is: 43.69147592333515. distance: 2.0253764991672303
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2619, Accuracy: 9260/9900 (93.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4504/5066 (88.9064%), train_poison_data_count: 400
Global model norm: 43.69717514021215.
Norm before scaling: 43.694943035493246. Distance: 2.2042067016350155
Total norm for 4 adversaries is: 43.694943035493246. distance: 2.2042067016350155
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1805, Accuracy: 9437/9900 (95.3232%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4125/4618 (89.3244%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4149/4618 (89.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8987, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3920/4625 (84.7568%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4019/4625 (86.8973%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1806, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5053/5740 (88.0314%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5129/5740 (89.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1834, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3833/4416 (86.7980%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3998/4416 (90.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9961, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3717/4126 (90.0873%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3809/4126 (92.3170%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8277, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3150/3616 (87.1128%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3318/3616 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8243, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3539/4158 (85.1130%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3684/4158 (88.6003%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8493, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3912/4346 (90.0138%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4051/4346 (93.2121%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8378, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4242/4874 (87.0332%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4362/4874 (89.4953%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3815, Accuracy: 5003/10000 (50.0300%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4625/5265 (87.8443%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4697/5265 (89.2118%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0307, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3605/4025 (89.5652%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3736/4025 (92.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9327, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4095/4651 (88.0456%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4216/4651 (90.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9592, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3358/3837 (87.5163%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3505/3837 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9613, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3137/3638 (86.2287%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3326/3638 (91.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8456, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3108/3472 (89.5161%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3210/3472 (92.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0530, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4028/4456 (90.3950%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4125/4456 (92.5718%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9343, Accuracy: 5616/10000 (56.1600%)
time spent on training: 228.42510795593262
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7786, Accuracy: 6022/10000 (60.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 7.3585, Accuracy: 440/9900 (4.4444%)
Done in 251.7813582420349 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4376/4885 (89.5803%), train_poison_data_count: 385
Global model norm: 43.73194940129584.
Norm before scaling: 43.73173446833975. Distance: 2.111657384276468
Total norm for 4 adversaries is: 43.73173446833975. distance: 2.111657384276468
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1583, Accuracy: 9491/9900 (95.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4786/5305 (90.2168%), train_poison_data_count: 415
Global model norm: 43.73194940129584.
Norm before scaling: 43.72749979453719. Distance: 2.1460415884149455
Total norm for 4 adversaries is: 43.72749979453719. distance: 2.1460415884149455
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1111, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 43.73194940129584.
Norm before scaling: 43.72724715271575. Distance: 1.9988995743372209
Total norm for 4 adversaries is: 43.72724715271575. distance: 1.9988995743372209
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2067, Accuracy: 9352/9900 (94.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 43.73194940129584.
Norm before scaling: 43.7334636717304. Distance: 2.2573779258799895
Total norm for 4 adversaries is: 43.7334636717304. distance: 2.2573779258799895
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1812, Accuracy: 9444/9900 (95.3939%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4864/5424 (89.6755%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4950/5424 (91.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1451, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4415/4986 (88.5479%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4510/4986 (90.4533%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8271, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4561/5167 (88.2717%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4702/5167 (91.0006%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2406, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4106/4716 (87.0653%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4261/4716 (90.3520%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8807, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3838/4368 (87.8663%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3905/4368 (89.4002%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0637, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4003/4356 (91.8962%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3882/4356 (89.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1347, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4404/4804 (91.6736%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4327/4804 (90.0708%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0291, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4077/4481 (90.9842%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4041/4481 (90.1808%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0722, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3604/4025 (89.5404%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3739/4025 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8721, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4458/5017 (88.8579%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4585/5017 (91.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0101, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3158/3616 (87.3341%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3338/3616 (92.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.7638, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3691/4184 (88.2170%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3773/4184 (90.1769%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8344, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4492/5195 (86.4678%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4595/5195 (88.4504%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0481, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3962/4361 (90.8507%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4033/4361 (92.4788%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9230, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3414/3756 (90.8946%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3507/3756 (93.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8199, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4959/5591 (88.6961%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4925/5591 (88.0880%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1206, Accuracy: 5390/10000 (53.9000%)
time spent on training: 234.82581162452698
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6994, Accuracy: 6108/10000 (61.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 7.3192, Accuracy: 464/9900 (4.6869%)
Done in 258.20823907852173 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 43.76003233188362.
Norm before scaling: 43.75594546655203. Distance: 2.075006310326966
Total norm for 4 adversaries is: 43.75594546655203. distance: 2.075006310326966
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.3676, Accuracy: 8953/9900 (90.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 43.76003233188362.
Norm before scaling: 43.75488672485266. Distance: 2.170596837531907
Total norm for 4 adversaries is: 43.75488672485266. distance: 2.170596837531907
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2124, Accuracy: 9371/9900 (94.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4218/4717 (89.4212%), train_poison_data_count: 370
Global model norm: 43.76003233188362.
Norm before scaling: 43.754931362701136. Distance: 2.0130248339088106
Total norm for 4 adversaries is: 43.754931362701136. distance: 2.0130248339088106
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1279, Accuracy: 9555/9900 (96.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4506/5066 (88.9459%), train_poison_data_count: 400
Global model norm: 43.76003233188362.
Norm before scaling: 43.75806426793309. Distance: 2.1975654092369483
Total norm for 4 adversaries is: 43.75806426793309. distance: 2.1975654092369483
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2796, Accuracy: 9212/9900 (93.0505%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3651/4175 (87.4491%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3741/4175 (89.6048%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0532, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4868/5455 (89.2392%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4951/5455 (90.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0068, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3224/3704 (87.0410%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3375/3704 (91.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8498, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4339/4989 (86.9713%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4449/4989 (89.1762%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9370, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4309/4928 (87.4391%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4452/4928 (90.3409%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9357, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3335/3804 (87.6709%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3479/3804 (91.4564%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9538, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3856/4336 (88.9299%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3949/4336 (91.0747%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9930, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3619/4046 (89.4464%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3672/4046 (90.7563%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8363, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4218/4793 (88.0033%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4362/4793 (91.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9330, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3351/3756 (89.2173%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3476/3756 (92.5453%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0676, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5756/6391 (90.0642%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5738/6391 (89.7825%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0886, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3212/3672 (87.4728%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3346/3672 (91.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8786, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4053/4558 (88.9206%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4144/4558 (90.9171%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9955, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4046/4576 (88.4178%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4149/4576 (90.6687%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9364, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4015/4456 (90.1032%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4146/4456 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0131, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4176/4356 (95.8678%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3972/4356 (91.1846%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9971, Accuracy: 5531/10000 (55.3100%)
time spent on training: 229.34284830093384
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.6099, Accuracy: 6240/10000 (62.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 7.3407, Accuracy: 495/9900 (5.0000%)
Done in 252.66897130012512 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 43.801597642719464.
Norm before scaling: 43.79836472894493. Distance: 2.0807711167735796
Total norm for 4 adversaries is: 43.79836472894493. distance: 2.0807711167735796
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1621, Accuracy: 9499/9900 (95.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4761/5305 (89.7455%), train_poison_data_count: 415
Global model norm: 43.801597642719464.
Norm before scaling: 43.796829011303004. Distance: 2.147445727229842
Total norm for 4 adversaries is: 43.796829011303004. distance: 2.147445727229842
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2673, Accuracy: 9245/9900 (93.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 43.801597642719464.
Norm before scaling: 43.79461731605124. Distance: 2.0475217074220486
Total norm for 4 adversaries is: 43.79461731605124. distance: 2.0475217074220486
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1515, Accuracy: 9495/9900 (95.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 43.801597642719464.
Norm before scaling: 43.80193624876217. Distance: 2.2024698568439924
Total norm for 4 adversaries is: 43.80193624876217. distance: 2.2024698568439924
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1650, Accuracy: 9474/9900 (95.6970%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4486/5116 (87.6857%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4574/5116 (89.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0028, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5038/5582 (90.2544%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5167/5582 (92.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0628, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4282/4928 (86.8912%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4453/4928 (90.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0134, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3704/4126 (89.7722%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3797/4126 (92.0262%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7966, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3547/4158 (85.3054%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3677/4158 (88.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8678, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4549/5063 (89.8479%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4521/5063 (89.2949%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0214, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5411/6124 (88.3573%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5479/6124 (89.4677%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0783, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4127/4354 (94.7864%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3997/4354 (91.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2188, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4466/5025 (88.8756%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4604/5025 (91.6219%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1016, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4315/4679 (92.2206%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4164/4679 (88.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1363, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4253/4793 (88.7336%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9286, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4067/4518 (90.0177%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9165, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4602/5167 (89.0652%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4656/5167 (90.1103%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0789, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4012/4433 (90.5030%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4051/4433 (91.3828%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8196, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4018/4503 (89.2294%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4080/4503 (90.6063%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0016, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4177/4707 (88.7402%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4316/4707 (91.6932%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8118, Accuracy: 5742/10000 (57.4200%)
time spent on training: 237.1800184249878
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.6513, Accuracy: 6163/10000 (61.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 7.6521, Accuracy: 457/9900 (4.6162%)
Done in 260.7459406852722 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4392/4885 (89.9079%), train_poison_data_count: 385
Global model norm: 43.82916526171885.
Norm before scaling: 43.82719751692435. Distance: 2.1151080177445536
Total norm for 4 adversaries is: 43.82719751692435. distance: 2.1151080177445536
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2381, Accuracy: 9298/9900 (93.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4746/5305 (89.4628%), train_poison_data_count: 415
Global model norm: 43.82916526171885.
Norm before scaling: 43.82350967232086. Distance: 2.165726115190484
Total norm for 4 adversaries is: 43.82350967232086. distance: 2.165726115190484
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1693, Accuracy: 9456/9900 (95.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 43.82916526171885.
Norm before scaling: 43.8255583584475. Distance: 2.0469143696267493
Total norm for 4 adversaries is: 43.8255583584475. distance: 2.0469143696267493
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1390, Accuracy: 9521/9900 (96.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 43.82916526171885.
Norm before scaling: 43.82655690153802. Distance: 2.196471210557651
Total norm for 4 adversaries is: 43.82655690153802. distance: 2.196471210557651
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2215, Accuracy: 9361/9900 (94.5556%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3235/3704 (87.3380%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3397/3704 (91.7117%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8698, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4724/5392 (87.6113%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4809/5392 (89.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0897, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3946/4362 (90.4631%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4033/4362 (92.4576%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8522, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4042/4538 (89.0701%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8577, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3697/4184 (88.3604%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3779/4184 (90.3203%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7989, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3363/3756 (89.5367%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3510/3756 (93.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8486, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4301/4679 (91.9214%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4235/4679 (90.5108%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9026, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3085/3472 (88.8537%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3183/3472 (91.6763%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0942, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5841/6391 (91.3941%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5838/6391 (91.3472%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0046, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4627/5265 (87.8822%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4593/5265 (87.2365%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0677, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5312/5902 (90.0034%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5327/5902 (90.2575%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9911, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5365/6124 (87.6061%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5449/6124 (88.9778%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0346, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4485/5083 (88.2353%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4569/5083 (89.8879%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9749, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3961/4465 (88.7122%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4107/4465 (91.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8476, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3358/3804 (88.2755%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3473/3804 (91.2986%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8980, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4346/4918 (88.3693%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4478/4918 (91.0533%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9947, Accuracy: 5459/10000 (54.5900%)
time spent on training: 235.45389080047607
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.6493, Accuracy: 6175/10000 (61.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 8.1286, Accuracy: 331/9900 (3.3434%)
Done in 258.6655902862549 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 43.86578567996147.
Norm before scaling: 43.862571412292255. Distance: 2.1021028979638294
Total norm for 4 adversaries is: 43.862571412292255. distance: 2.1021028979638294
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.3681, Accuracy: 9037/9900 (91.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4764/5305 (89.8021%), train_poison_data_count: 415
Global model norm: 43.86578567996147.
Norm before scaling: 43.86165439837512. Distance: 2.1718908076088406
Total norm for 4 adversaries is: 43.86165439837512. distance: 2.1718908076088406
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2414, Accuracy: 9314/9900 (94.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 43.86578567996147.
Norm before scaling: 43.863265769711845. Distance: 2.007647199542796
Total norm for 4 adversaries is: 43.863265769711845. distance: 2.007647199542796
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1582, Accuracy: 9528/9900 (96.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4517/5066 (89.1630%), train_poison_data_count: 400
Global model norm: 43.86578567996147.
Norm before scaling: 43.86873397207287. Distance: 2.234395807342748
Total norm for 4 adversaries is: 43.86873397207287. distance: 2.234395807342748
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2373, Accuracy: 9307/9900 (94.0101%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4068/4538 (89.6430%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4198/4538 (92.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8720, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4341/4989 (87.0114%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4421/4989 (88.6150%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8693, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4205/4793 (87.7321%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4371/4793 (91.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9254, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3536/4158 (85.0409%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3644/4158 (87.6383%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9656, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3434/3861 (88.9407%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0949, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4558/5232 (87.1177%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4642/5232 (88.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2004, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4156/4663 (89.1272%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4325/4663 (92.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9875, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4672/5197 (89.8980%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4703/5197 (90.4945%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0261, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4597/5167 (88.9685%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4663/5167 (90.2458%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1066, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3894/4416 (88.1793%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3977/4416 (90.0589%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8455, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4230/4354 (97.1520%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3882/4354 (89.1594%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2645, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4890/5455 (89.6425%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4892/5455 (89.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9839, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4038/4456 (90.6194%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4143/4456 (92.9758%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8126, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2887/3271 (88.2605%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2943/3271 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9372, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2972/3297 (90.1426%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3039/3297 (92.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7088, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5013/5591 (89.6620%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5027/5591 (89.9124%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0864, Accuracy: 5270/10000 (52.7000%)
time spent on training: 234.02582383155823
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7468, Accuracy: 6040/10000 (60.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 8.2150, Accuracy: 425/9900 (4.2929%)
Done in 257.66884183883667 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 43.89702833540885.
Norm before scaling: 43.893182274646165. Distance: 2.091281289495321
Total norm for 4 adversaries is: 43.893182274646165. distance: 2.091281289495321
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1474, Accuracy: 9502/9900 (95.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 43.89702833540885.
Norm before scaling: 43.89368842771205. Distance: 2.183077456013661
Total norm for 4 adversaries is: 43.89368842771205. distance: 2.183077456013661
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.4734, Accuracy: 8771/9900 (88.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 43.89702833540885.
Norm before scaling: 43.893808012474125. Distance: 2.073404673220914
Total norm for 4 adversaries is: 43.893808012474125. distance: 2.073404673220914
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1720, Accuracy: 9486/9900 (95.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4488/5066 (88.5906%), train_poison_data_count: 400
Global model norm: 43.89702833540885.
Norm before scaling: 43.900525093848536. Distance: 2.268744800235895
Total norm for 4 adversaries is: 43.900525093848536. distance: 2.268744800235895
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2011, Accuracy: 9397/9900 (94.9192%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4560/5167 (88.2524%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4669/5167 (90.3619%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0945, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3386/3775 (89.6954%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3536/3775 (93.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8683, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4517/5195 (86.9490%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4659/5195 (89.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0840, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3643/4126 (88.2937%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3827/4126 (92.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9161, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3494/3911 (89.3378%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3389/3911 (86.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2266, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3974/4433 (89.6458%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4076/4433 (91.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8526, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2864/3271 (87.5573%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0068, Accuracy: 2852/3271 (87.1905%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0371, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3253/3590 (90.6128%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3225/3590 (89.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0622, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4328/4918 (88.0033%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0485, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4375/4986 (87.7457%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4454/4986 (89.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8446, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3154/3616 (87.2235%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3293/3616 (91.0675%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9169, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3761/4295 (87.5669%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3873/4295 (90.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0359, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4116/4356 (94.4904%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4063/4356 (93.2736%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9019, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4235/4793 (88.3580%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4320/4793 (90.1314%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9958, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3875/4315 (89.8030%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3977/4315 (92.1669%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8937, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4381/4804 (91.1948%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4433/4804 (92.2773%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9576, Accuracy: 5635/10000 (56.3500%)
time spent on training: 228.93484544754028
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7822, Accuracy: 6020/10000 (60.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 7.8793, Accuracy: 498/9900 (5.0303%)
Done in 252.42071795463562 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4425/4885 (90.5834%), train_poison_data_count: 385
Global model norm: 43.924408222482775.
Norm before scaling: 43.92014626622816. Distance: 2.0937794925263677
Total norm for 4 adversaries is: 43.92014626622816. distance: 2.0937794925263677
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1402, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 43.924408222482775.
Norm before scaling: 43.9210314864751. Distance: 2.230036651925951
Total norm for 4 adversaries is: 43.9210314864751. distance: 2.230036651925951
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0712, Accuracy: 9713/9900 (98.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4233/4717 (89.7392%), train_poison_data_count: 370
Global model norm: 43.924408222482775.
Norm before scaling: 43.92018378769962. Distance: 2.0435556768491345
Total norm for 4 adversaries is: 43.92018378769962. distance: 2.0435556768491345
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0909, Accuracy: 9657/9900 (97.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 43.924408222482775.
Norm before scaling: 43.92643413948983. Distance: 2.2569358734228944
Total norm for 4 adversaries is: 43.92643413948983. distance: 2.2569358734228944
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1837, Accuracy: 9420/9900 (95.1515%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4003/4503 (88.8963%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4079/4503 (90.5841%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9946, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4345/4934 (88.0624%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4413/4934 (89.4406%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1908, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4485/4804 (93.3597%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4205/4804 (87.5312%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2581, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3974/4456 (89.1831%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4089/4456 (91.7639%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9413, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4062/4651 (87.3361%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4182/4651 (89.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0541, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3715/4184 (88.7906%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3799/4184 (90.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9903, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4266/4928 (86.5666%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4435/4928 (89.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9138, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3375/3775 (89.4040%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3543/3775 (93.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9219, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4466/5083 (87.8615%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4526/5083 (89.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1198, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4832/5455 (88.5793%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4927/5455 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9912, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3167/3638 (87.0533%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3302/3638 (90.7642%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8672, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3446/3911 (88.1105%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3534/3911 (90.3605%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0725, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3381/3837 (88.1157%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3539/3837 (92.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8436, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3988/4501 (88.6025%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4058/4501 (90.1577%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0567, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4607/5197 (88.6473%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4676/5197 (89.9750%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2531, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3399/3861 (88.0342%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3450/3861 (89.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9541, Accuracy: 5512/10000 (55.1200%)
time spent on training: 231.20841598510742
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9747, Accuracy: 5839/10000 (58.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 8.0317, Accuracy: 451/9900 (4.5556%)
Done in 254.77099466323853 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 43.95762952388783.
Norm before scaling: 43.9556217074392. Distance: 2.1039095680615776
Total norm for 4 adversaries is: 43.9556217074392. distance: 2.1039095680615776
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1838, Accuracy: 9405/9900 (95.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 43.95762952388783.
Norm before scaling: 43.95836264562609. Distance: 2.259406770981399
Total norm for 4 adversaries is: 43.95836264562609. distance: 2.259406770981399
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1924, Accuracy: 9433/9900 (95.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 43.95762952388783.
Norm before scaling: 43.951771053177566. Distance: 2.0072682158745514
Total norm for 4 adversaries is: 43.951771053177566. distance: 2.0072682158745514
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.2047, Accuracy: 9361/9900 (94.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4478/5066 (88.3932%), train_poison_data_count: 400
Global model norm: 43.95762952388783.
Norm before scaling: 43.960546665003356. Distance: 2.313064403219496
Total norm for 4 adversaries is: 43.960546665003356. distance: 2.313064403219496
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1040, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2836/3271 (86.7013%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2884/3271 (88.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0337, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3875/4511 (85.9011%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4043/4511 (89.6254%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0530, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3137/3638 (86.2287%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3299/3638 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8591, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5032/5582 (90.1469%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5089/5582 (91.1680%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0181, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3994/4456 (89.6320%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4079/4456 (91.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2132, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5253/5902 (89.0037%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5188/5902 (87.9024%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0413, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3805/4416 (86.1639%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3971/4416 (89.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9392, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4339/4934 (87.9408%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4282/4934 (86.7856%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.3097, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4032/4596 (87.7285%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4243/4596 (92.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9075, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3380/3837 (88.0897%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3518/3837 (91.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9029, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5805/6391 (90.8309%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5796/6391 (90.6900%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0688, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3817/4368 (87.3855%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0699, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3369/3804 (88.5647%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3526/3804 (92.6919%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8893, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5530/6263 (88.2963%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5644/6263 (90.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1650, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4169/4793 (86.9810%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4343/4793 (90.6113%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9632, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4845/5424 (89.3252%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4941/5424 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1490, Accuracy: 5259/10000 (52.5900%)
time spent on training: 233.65845465660095
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8465, Accuracy: 6008/10000 (60.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 8.5970, Accuracy: 281/9900 (2.8384%)
Done in 257.00281381607056 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4400/4885 (90.0716%), train_poison_data_count: 385
Global model norm: 43.99454117638133.
Norm before scaling: 43.98891378668962. Distance: 2.096456458081957
Total norm for 4 adversaries is: 43.98891378668962. distance: 2.096456458081957
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.3262, Accuracy: 9074/9900 (91.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 43.99454117638133.
Norm before scaling: 43.99101026772402. Distance: 2.209598526715085
Total norm for 4 adversaries is: 43.99101026772402. distance: 2.209598526715085
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1722, Accuracy: 9496/9900 (95.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4717 (89.9512%), train_poison_data_count: 370
Global model norm: 43.99454117638133.
Norm before scaling: 43.98773577302542. Distance: 2.0288997257848993
Total norm for 4 adversaries is: 43.98773577302542. distance: 2.0288997257848993
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1863, Accuracy: 9397/9900 (94.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4491/5066 (88.6498%), train_poison_data_count: 400
Global model norm: 43.99454117638133.
Norm before scaling: 43.995252873356975. Distance: 2.3062150451161463
Total norm for 4 adversaries is: 43.995252873356975. distance: 2.3062150451161463
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.2663, Accuracy: 9224/9900 (93.1717%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4442/5055 (87.8734%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4616/5055 (91.3155%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9499, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3673/4184 (87.7868%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3796/4184 (90.7266%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9144, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3410/3861 (88.3191%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3501/3861 (90.6760%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8565, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4493/4804 (93.5262%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4192/4804 (87.2606%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2614, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3098/3472 (89.2281%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9349, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3478/3969 (87.6291%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3580/3969 (90.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9161, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4349/4989 (87.1718%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4424/4989 (88.6751%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9573, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5028/5582 (90.0752%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5115/5582 (91.6338%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0314, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4197/4793 (87.5652%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4350/4793 (90.7574%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9913, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4152/4662 (89.0605%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4232/4662 (90.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0291, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4448/4934 (90.1500%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4372/4934 (88.6096%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2169, Accuracy: 5132/10000 (51.3200%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4388/4986 (88.0064%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4523/4986 (90.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9451, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3949/4433 (89.0819%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4046/4433 (91.2700%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8334, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4114/4716 (87.2349%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4238/4716 (89.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0401, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4076/4596 (88.6858%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4235/4596 (92.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9330, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4209/4354 (96.6697%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4067/4354 (93.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9858, Accuracy: 5613/10000 (56.1300%)
time spent on training: 233.14201021194458
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8764, Accuracy: 5978/10000 (59.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 8.4986, Accuracy: 312/9900 (3.1515%)
Done in 256.4999282360077 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4387/4885 (89.8055%), train_poison_data_count: 385
Global model norm: 44.02740180132141.
Norm before scaling: 44.02539162144813. Distance: 2.145036370384763
Total norm for 4 adversaries is: 44.02539162144813. distance: 2.145036370384763
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1025, Accuracy: 9647/9900 (97.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4699/5305 (88.5768%), train_poison_data_count: 415
Global model norm: 44.02740180132141.
Norm before scaling: 44.024138331821725. Distance: 2.264141044017755
Total norm for 4 adversaries is: 44.024138331821725. distance: 2.264141044017755
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1963, Accuracy: 9435/9900 (95.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4223/4717 (89.5272%), train_poison_data_count: 370
Global model norm: 44.02740180132141.
Norm before scaling: 44.02225971694249. Distance: 2.059029636164215
Total norm for 4 adversaries is: 44.02225971694249. distance: 2.059029636164215
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.2221, Accuracy: 9327/9900 (94.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4473/5066 (88.2945%), train_poison_data_count: 400
Global model norm: 44.02740180132141.
Norm before scaling: 44.029404958238565. Distance: 2.286728955172127
Total norm for 4 adversaries is: 44.029404958238565. distance: 2.286728955172127
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.4684, Accuracy: 8855/9900 (89.4444%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4466/5116 (87.2948%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4577/5116 (89.4644%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0025, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4098/4662 (87.9022%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4253/4662 (91.2269%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9835, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5264/5902 (89.1901%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5339/5902 (90.4609%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1045, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4469/5063 (88.2678%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4623/5063 (91.3095%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1441, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4158/4354 (95.4984%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3434/4354 (78.8700%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.7651, Accuracy: 4354/10000 (43.5400%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4523/5195 (87.0645%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4605/5195 (88.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9994, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4077/4356 (93.5950%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4065/4356 (93.3196%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0338, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3784/4295 (88.1024%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3852/4295 (89.6857%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0639, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5530/6263 (88.2963%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5661/6263 (90.3880%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0483, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3927/4511 (87.0539%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4048/4511 (89.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9511, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4185/4663 (89.7491%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4309/4663 (92.4083%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0438, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3884/4336 (89.5756%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4014/4336 (92.5738%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9476, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4222/4928 (85.6737%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4450/4928 (90.3003%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0821, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3605/4046 (89.1003%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3739/4046 (92.4123%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9373, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3193/3672 (86.9553%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3309/3672 (90.1144%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8923, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4010/4356 (92.0569%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3928/4356 (90.1745%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0628, Accuracy: 5365/10000 (53.6500%)
time spent on training: 231.34302687644958
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9223, Accuracy: 5911/10000 (59.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 8.5769, Accuracy: 229/9900 (2.3131%)
Done in 254.74892902374268 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4396/4885 (89.9898%), train_poison_data_count: 385
Global model norm: 44.07280187637694.
Norm before scaling: 44.072902971862284. Distance: 2.116766180367452
Total norm for 4 adversaries is: 44.072902971862284. distance: 2.116766180367452
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1734, Accuracy: 9464/9900 (95.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4723/5305 (89.0292%), train_poison_data_count: 415
Global model norm: 44.07280187637694.
Norm before scaling: 44.07183245583992. Distance: 2.323472052126765
Total norm for 4 adversaries is: 44.07183245583992. distance: 2.323472052126765
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1785, Accuracy: 9443/9900 (95.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4206/4717 (89.1668%), train_poison_data_count: 370
Global model norm: 44.07280187637694.
Norm before scaling: 44.06741716800946. Distance: 2.104920381322425
Total norm for 4 adversaries is: 44.06741716800946. distance: 2.104920381322425
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1738, Accuracy: 9440/9900 (95.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4432/5066 (87.4852%), train_poison_data_count: 400
Global model norm: 44.07280187637694.
Norm before scaling: 44.075473212061915. Distance: 2.3568374427669845
Total norm for 4 adversaries is: 44.075473212061915. distance: 2.3568374427669845
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.2149, Accuracy: 9359/9900 (94.5354%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4337/5037 (86.1028%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4627/5037 (91.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0028, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4091/4647 (88.0353%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4198/4647 (90.3379%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9694, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4143/4663 (88.8484%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4293/4663 (92.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0351, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3821/4336 (88.1227%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3948/4336 (91.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8748, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3348/3756 (89.1374%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3485/3756 (92.7849%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9275, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4021/4625 (86.9405%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4024/4625 (87.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2077, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3877/4362 (88.8812%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4063/4362 (93.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9413, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4253/4874 (87.2589%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4346/4874 (89.1670%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0111, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4092/4767 (85.8402%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4264/4767 (89.4483%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1119, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3353/3775 (88.8212%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3537/3775 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8002, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4117/4662 (88.3097%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4248/4662 (91.1197%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0203, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5404/6124 (88.2430%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5510/6124 (89.9739%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9261, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3908/4511 (86.6327%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4065/4511 (90.1131%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9666, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3519/3911 (89.9770%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3519/3911 (89.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9111, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4950/5591 (88.5351%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5001/5591 (89.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0530, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3617/4126 (87.6636%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3767/4126 (91.2991%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9343, Accuracy: 5573/10000 (55.7300%)
time spent on training: 234.40907382965088
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8525, Accuracy: 6024/10000 (60.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 8.9382, Accuracy: 187/9900 (1.8889%)
Done in 257.89705443382263 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4365/4885 (89.3552%), train_poison_data_count: 385
Global model norm: 44.10621031199504.
Norm before scaling: 44.10314919089891. Distance: 2.1477179414694145
Total norm for 4 adversaries is: 44.10314919089891. distance: 2.1477179414694145
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1373, Accuracy: 9575/9900 (96.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4692/5305 (88.4449%), train_poison_data_count: 415
Global model norm: 44.10621031199504.
Norm before scaling: 44.107035062359245. Distance: 2.340624136217923
Total norm for 4 adversaries is: 44.107035062359245. distance: 2.340624136217923
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1263, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4202/4717 (89.0820%), train_poison_data_count: 370
Global model norm: 44.10621031199504.
Norm before scaling: 44.09913149300675. Distance: 2.0953332409269527
Total norm for 4 adversaries is: 44.09913149300675. distance: 2.0953332409269527
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0569, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4486/5066 (88.5511%), train_poison_data_count: 400
Global model norm: 44.10621031199504.
Norm before scaling: 44.108436825835824. Distance: 2.284865871140532
Total norm for 4 adversaries is: 44.108436825835824. distance: 2.284865871140532
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.2344, Accuracy: 9293/9900 (93.8687%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4473/5025 (89.0149%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4609/5025 (91.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0801, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4445/5116 (86.8843%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4541/5116 (88.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2134, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4564/5167 (88.3298%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4677/5167 (90.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0189, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3981/4558 (87.3409%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4023/4558 (88.2624%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0539, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4070/4651 (87.5081%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4241/4651 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9359, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3876/4336 (89.3911%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3935/4336 (90.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0740, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4498/5055 (88.9812%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4611/5055 (91.2166%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0769, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3400/3775 (90.0662%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3542/3775 (93.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7861, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4704/5265 (89.3447%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4716/5265 (89.5726%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9827, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3572/4025 (88.7453%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3756/4025 (93.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9216, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4310/4989 (86.3901%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4458/4989 (89.3566%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8983, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4216/4793 (87.9616%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4355/4793 (90.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9886, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3341/3804 (87.8286%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9290, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3340/3797 (87.9642%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3439/3797 (90.5715%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9828, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3945/4433 (88.9917%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4074/4433 (91.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8574, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4163/4707 (88.4427%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4284/4707 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9178, Accuracy: 5615/10000 (56.1500%)
time spent on training: 230.52159023284912
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8471, Accuracy: 6028/10000 (60.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 8.3033, Accuracy: 304/9900 (3.0707%)
Done in 254.1721968650818 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 44.137277251367266.
Norm before scaling: 44.13362914694063. Distance: 2.1007024997805446
Total norm for 4 adversaries is: 44.13362914694063. distance: 2.1007024997805446
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1940, Accuracy: 9423/9900 (95.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 44.137277251367266.
Norm before scaling: 44.132098180845084. Distance: 2.2380053498286854
Total norm for 4 adversaries is: 44.132098180845084. distance: 2.2380053498286854
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1039, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 44.137277251367266.
Norm before scaling: 44.13018266969827. Distance: 1.9843987290773357
Total norm for 4 adversaries is: 44.13018266969827. distance: 1.9843987290773357
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.3559, Accuracy: 9031/9900 (91.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4485/5066 (88.5314%), train_poison_data_count: 400
Global model norm: 44.137277251367266.
Norm before scaling: 44.13791059131807. Distance: 2.2614883015557985
Total norm for 4 adversaries is: 44.13791059131807. distance: 2.2614883015557985
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1759, Accuracy: 9439/9900 (95.3434%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4790/5392 (88.8353%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4828/5392 (89.5401%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0089, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4148/4663 (88.9556%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4292/4663 (92.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0348, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3369/3797 (88.7279%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3409/3797 (89.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9742, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4991/5582 (89.4124%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5064/5582 (90.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0615, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4547/5167 (88.0008%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4689/5167 (90.7490%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9917, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3352/3781 (88.6538%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3318/3781 (87.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1064, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3500/3969 (88.1834%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3615/3969 (91.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9838, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3366/3837 (87.7248%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3526/3837 (91.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9593, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5284/5902 (89.5290%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5319/5902 (90.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0310, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4792/5455 (87.8460%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4907/5455 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9488, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4350/5037 (86.3609%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4503/5037 (89.3985%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9933, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4450/5017 (88.6984%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4588/5017 (91.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8359, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4389/4986 (88.0265%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4566/4986 (91.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9111, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4597/5197 (88.4549%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4651/5197 (89.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1978, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3907/4361 (89.5895%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3840/4361 (88.0532%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.2485, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5579/6263 (89.0787%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5738/6263 (91.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1264, Accuracy: 5273/10000 (52.7300%)
time spent on training: 237.06058311462402
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7746, Accuracy: 6055/10000 (60.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 8.5421, Accuracy: 245/9900 (2.4747%)
Done in 260.2797951698303 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4420/4885 (90.4811%), train_poison_data_count: 385
Global model norm: 44.17097407995295.
Norm before scaling: 44.16444462398811. Distance: 2.0759843398883504
Total norm for 4 adversaries is: 44.16444462398811. distance: 2.0759843398883504
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1243, Accuracy: 9589/9900 (96.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4747/5305 (89.4816%), train_poison_data_count: 415
Global model norm: 44.17097407995295.
Norm before scaling: 44.166093316345346. Distance: 2.227107038333109
Total norm for 4 adversaries is: 44.166093316345346. distance: 2.227107038333109
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1167, Accuracy: 9610/9900 (97.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 44.17097407995295.
Norm before scaling: 44.16275440858649. Distance: 2.0089091708745146
Total norm for 4 adversaries is: 44.16275440858649. distance: 2.0089091708745146
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1297, Accuracy: 9561/9900 (96.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4469/5066 (88.2156%), train_poison_data_count: 400
Global model norm: 44.17097407995295.
Norm before scaling: 44.16826153640686. Distance: 2.2570676003787398
Total norm for 4 adversaries is: 44.16826153640686. distance: 2.2570676003787398
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.2266, Accuracy: 9323/9900 (94.1717%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4502/5017 (89.7349%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4601/5017 (91.7082%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7690, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4311/4928 (87.4797%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4431/4928 (89.9148%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9660, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3733/4184 (89.2208%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3811/4184 (91.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9124, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4188/4793 (87.3774%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4387/4793 (91.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8954, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5059/5740 (88.1359%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5161/5740 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0808, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3360/3756 (89.4569%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3524/3756 (93.8232%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9130, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3785/4235 (89.3743%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3821/4235 (90.2243%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9571, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3695/4223 (87.4970%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3871/4223 (91.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7969, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4480/5063 (88.4851%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4415/5063 (87.2013%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0555, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4410/4989 (88.3945%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9234, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4333/4928 (87.9261%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4421/4928 (89.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9569, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5274/5902 (89.3595%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5236/5902 (88.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9942, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4036/4456 (90.5745%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4103/4456 (92.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9076, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5363/6124 (87.5735%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5472/6124 (89.3534%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9694, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3385/3828 (88.4274%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3515/3828 (91.8234%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8797, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3172/3616 (87.7212%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3326/3616 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7841, Accuracy: 5872/10000 (58.7200%)
time spent on training: 234.16040539741516
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7633, Accuracy: 6107/10000 (61.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 8.7516, Accuracy: 257/9900 (2.5960%)
Done in 257.35755443573 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4390/4885 (89.8669%), train_poison_data_count: 385
Global model norm: 44.20582297793188.
Norm before scaling: 44.20053456531239. Distance: 2.0768835044959935
Total norm for 4 adversaries is: 44.20053456531239. distance: 2.0768835044959935
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2233, Accuracy: 9387/9900 (94.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4736/5305 (89.2743%), train_poison_data_count: 415
Global model norm: 44.20582297793188.
Norm before scaling: 44.20113385847698. Distance: 2.2602916161421387
Total norm for 4 adversaries is: 44.20113385847698. distance: 2.2602916161421387
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2111, Accuracy: 9368/9900 (94.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4262/4717 (90.3540%), train_poison_data_count: 370
Global model norm: 44.20582297793188.
Norm before scaling: 44.19772578814152. Distance: 2.002473255602755
Total norm for 4 adversaries is: 44.19772578814152. distance: 2.002473255602755
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2547, Accuracy: 9252/9900 (93.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4520/5066 (89.2223%), train_poison_data_count: 400
Global model norm: 44.20582297793188.
Norm before scaling: 44.205534409855716. Distance: 2.217950703815223
Total norm for 4 adversaries is: 44.205534409855716. distance: 2.217950703815223
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.2281, Accuracy: 9323/9900 (94.1717%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3721/4223 (88.1127%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3842/4223 (90.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8990, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3896/4362 (89.3168%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3993/4362 (91.5406%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9599, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5751/6391 (89.9859%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5785/6391 (90.5179%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0482, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4145/4793 (86.4803%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0961, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3365/3756 (89.5900%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3482/3756 (92.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9962, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4155/4618 (89.9740%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4214/4618 (91.2516%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8935, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3553/4025 (88.2733%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3706/4025 (92.0745%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8271, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3173/3638 (87.2183%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7620, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3874/4315 (89.7798%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3989/4315 (92.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7988, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3807/4295 (88.6380%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3703/4295 (86.2165%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9746, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4352/4928 (88.3117%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4481/4928 (90.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8354, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4373/4986 (87.7056%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4499/4986 (90.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0228, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3641/4126 (88.2453%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3756/4126 (91.0325%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8246, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4387/4918 (89.2029%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4505/4918 (91.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1789, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4492/5195 (86.4678%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4548/5195 (87.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1141, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5046/5740 (87.9094%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5204/5740 (90.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1861, Accuracy: 5273/10000 (52.7300%)
time spent on training: 235.25026774406433
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7101, Accuracy: 6183/10000 (61.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 9.0389, Accuracy: 205/9900 (2.0707%)
Done in 258.5266258716583 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4422/4885 (90.5220%), train_poison_data_count: 385
Global model norm: 44.241421142709264.
Norm before scaling: 44.23447710602839. Distance: 2.0695137066383764
Total norm for 4 adversaries is: 44.23447710602839. distance: 2.0695137066383764
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0940, Accuracy: 9659/9900 (97.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4749/5305 (89.5193%), train_poison_data_count: 415
Global model norm: 44.241421142709264.
Norm before scaling: 44.234739269075895. Distance: 2.2067736990211313
Total norm for 4 adversaries is: 44.234739269075895. distance: 2.2067736990211313
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2219, Accuracy: 9365/9900 (94.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4248/4717 (90.0572%), train_poison_data_count: 370
Global model norm: 44.241421142709264.
Norm before scaling: 44.23193818349757. Distance: 1.9975874774479245
Total norm for 4 adversaries is: 44.23193818349757. distance: 1.9975874774479245
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.4166, Accuracy: 8926/9900 (90.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4518/5066 (89.1828%), train_poison_data_count: 400
Global model norm: 44.241421142709264.
Norm before scaling: 44.239697997457554. Distance: 2.22153910097771
Total norm for 4 adversaries is: 44.239697997457554. distance: 2.22153910097771
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.2182, Accuracy: 9361/9900 (94.5556%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2919/3297 (88.5350%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3030/3297 (91.9017%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7905, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3399/3828 (88.7931%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3478/3828 (90.8568%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9381, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4609/5063 (91.0330%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4498/5063 (88.8406%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8679, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3954/4501 (87.8471%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4106/4501 (91.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9756, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4222/4793 (88.0868%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4326/4793 (90.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9572, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3769/4223 (89.2493%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3920/4223 (92.8250%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8627, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3429/3756 (91.2939%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3506/3756 (93.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7964, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3201/3638 (87.9879%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8629, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3193/3646 (87.5754%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3323/3646 (91.1410%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7980, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4330/4874 (88.8387%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4282/4874 (87.8539%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0384, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5625/6263 (89.8132%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5731/6263 (91.5057%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9985, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4385/5037 (87.0558%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9425, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3971/4362 (91.0362%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3983/4362 (91.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9137, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4066/4356 (93.3425%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4129/4356 (94.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8751, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4530/5116 (88.5457%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4595/5116 (89.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8848, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3939/4346 (90.6351%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4053/4346 (93.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7983, Accuracy: 5811/10000 (58.1100%)
time spent on training: 228.80919814109802
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7016, Accuracy: 6182/10000 (61.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 9.0407, Accuracy: 203/9900 (2.0505%)
Done in 252.08868598937988 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 44.272611024357516.
Norm before scaling: 44.26494246958802. Distance: 2.082615639726167
Total norm for 4 adversaries is: 44.26494246958802. distance: 2.082615639726167
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2328, Accuracy: 9329/9900 (94.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 44.272611024357516.
Norm before scaling: 44.26708102970677. Distance: 2.1872414572380303
Total norm for 4 adversaries is: 44.26708102970677. distance: 2.1872414572380303
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2825, Accuracy: 9209/9900 (93.0202%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 44.272611024357516.
Norm before scaling: 44.263665626861076. Distance: 1.9561500011881598
Total norm for 4 adversaries is: 44.263665626861076. distance: 1.9561500011881598
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2875, Accuracy: 9160/9900 (92.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 44.272611024357516.
Norm before scaling: 44.270068774035266. Distance: 2.2033921749358654
Total norm for 4 adversaries is: 44.270068774035266. distance: 2.2033921749358654
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.2794, Accuracy: 9173/9900 (92.6566%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4077/4518 (90.2390%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4150/4518 (91.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8491, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4132/4558 (90.6538%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4144/4558 (90.9171%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9468, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3360/3804 (88.3281%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3476/3804 (91.3775%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0333, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3401/3775 (90.0927%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3557/3775 (94.2252%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8336, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4507/5083 (88.6681%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4551/5083 (89.5337%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0655, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4435/4928 (89.9959%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4522/4928 (91.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7779, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4503/5244 (85.8696%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4608/5244 (87.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0308, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4358/4989 (87.3522%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4506/4989 (90.3187%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8746, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4413/4986 (88.5078%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4509/4986 (90.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9371, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3722/4175 (89.1497%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3779/4175 (90.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0491, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4599/5232 (87.9014%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4690/5232 (89.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9525, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4580/5063 (90.4602%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4564/5063 (90.1442%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0151, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4040/4441 (90.9705%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4128/4441 (92.9520%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9865, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3232/3646 (88.6451%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3380/3646 (92.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7378, Accuracy: 5922/10000 (59.2200%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4602/5167 (89.0652%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4740/5167 (91.7360%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0603, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4081/4538 (89.9295%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4194/4538 (92.4196%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8187, Accuracy: 5753/10000 (57.5300%)
time spent on training: 230.2940366268158
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7216, Accuracy: 6151/10000 (61.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 9.0058, Accuracy: 186/9900 (1.8788%)
Done in 253.74904918670654 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4423/4885 (90.5425%), train_poison_data_count: 385
Global model norm: 44.30901646876951.
Norm before scaling: 44.300843076239815. Distance: 2.0462104941756625
Total norm for 4 adversaries is: 44.300843076239815. distance: 2.0462104941756625
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1871, Accuracy: 9450/9900 (95.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 44.30901646876951.
Norm before scaling: 44.30048899499093. Distance: 2.1481724801031366
Total norm for 4 adversaries is: 44.30048899499093. distance: 2.1481724801031366
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1323, Accuracy: 9581/9900 (96.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4219/4717 (89.4424%), train_poison_data_count: 370
Global model norm: 44.30901646876951.
Norm before scaling: 44.303276102761295. Distance: 2.0756854889833445
Total norm for 4 adversaries is: 44.303276102761295. distance: 2.0756854889833445
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1638, Accuracy: 9488/9900 (95.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4508/5066 (88.9854%), train_poison_data_count: 400
Global model norm: 44.30901646876951.
Norm before scaling: 44.3049747334632. Distance: 2.2021421580425993
Total norm for 4 adversaries is: 44.3049747334632. distance: 2.2021421580425993
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0982, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4107/4356 (94.2837%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4004/4356 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0245, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4338/4928 (88.0276%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4372/4928 (88.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0611, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4463/5037 (88.6043%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4565/5037 (90.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8608, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4518/4804 (94.0466%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4559/4804 (94.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9139, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3444/3775 (91.2318%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3543/3775 (93.8543%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7440, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4605/5167 (89.1233%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4668/5167 (90.3426%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1233, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3792/4235 (89.5396%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3921/4235 (92.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9523, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4362/4956 (88.0145%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4399/4956 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9617, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5110/5740 (89.0244%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5224/5740 (91.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0884, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4301/4679 (91.9214%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4338/4679 (92.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0065, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3272/3704 (88.3369%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3398/3704 (91.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7693, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3143/3472 (90.5242%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3161/3472 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9867, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4140/4651 (89.0131%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4243/4651 (91.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0179, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4120/4634 (88.9081%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4221/4634 (91.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9255, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5311/5902 (89.9864%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5250/5902 (88.9529%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0519, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3383/3837 (88.1678%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3535/3837 (92.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8912, Accuracy: 5680/10000 (56.8000%)
time spent on training: 232.80819582939148
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.6675, Accuracy: 6236/10000 (62.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 8.8929, Accuracy: 176/9900 (1.7778%)
Done in 256.0252294540405 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4464/4885 (91.3818%), train_poison_data_count: 385
Global model norm: 44.33548802084934.
Norm before scaling: 44.329142513436494. Distance: 2.0553623730149186
Total norm for 4 adversaries is: 44.329142513436494. distance: 2.0553623730149186
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2723, Accuracy: 9233/9900 (93.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4759/5305 (89.7078%), train_poison_data_count: 415
Global model norm: 44.33548802084934.
Norm before scaling: 44.3281979753541. Distance: 2.2015150965290613
Total norm for 4 adversaries is: 44.3281979753541. distance: 2.2015150965290613
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1194, Accuracy: 9617/9900 (97.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4253/4717 (90.1632%), train_poison_data_count: 370
Global model norm: 44.33548802084934.
Norm before scaling: 44.32552672372814. Distance: 2.0095785367168792
Total norm for 4 adversaries is: 44.32552672372814. distance: 2.0095785367168792
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.2945, Accuracy: 9242/9900 (93.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4519/5066 (89.2025%), train_poison_data_count: 400
Global model norm: 44.33548802084934.
Norm before scaling: 44.332390414275544. Distance: 2.2713252476775105
Total norm for 4 adversaries is: 44.332390414275544. distance: 2.2713252476775105
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1071, Accuracy: 9637/9900 (97.3434%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3552/3969 (89.4936%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3623/3969 (91.2824%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9698, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4174/4707 (88.6764%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4319/4707 (91.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8225, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3487/3861 (90.3134%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3493/3861 (90.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7527, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4120/4596 (89.6432%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4193/4596 (91.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0024, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4023/4503 (89.3404%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4102/4503 (91.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9500, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4388/4928 (89.0422%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4498/4928 (91.2744%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8049, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4453/5025 (88.6169%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4543/5025 (90.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9665, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4107/4576 (89.7509%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4225/4576 (92.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9414, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4356/4918 (88.5726%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4496/4918 (91.4193%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8835, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3926/4315 (90.9849%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3962/4315 (91.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9060, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3271/3590 (91.1142%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3297/3590 (91.8384%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9852, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4004/4456 (89.8564%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4127/4456 (92.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8430, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4189/4354 (96.2104%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4056/4354 (93.1557%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9493, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3987/4501 (88.5803%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4060/4501 (90.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8622, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3527/3911 (90.1815%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3577/3911 (91.4600%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9765, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4113/4558 (90.2369%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4177/4558 (91.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9642, Accuracy: 5500/10000 (55.0000%)
time spent on training: 233.49032831192017
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.6832, Accuracy: 6206/10000 (62.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 9.7702, Accuracy: 105/9900 (1.0606%)
Done in 256.8078474998474 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 44.359314459275346.
Norm before scaling: 44.35288016031907. Distance: 2.054888813324393
Total norm for 4 adversaries is: 44.35288016031907. distance: 2.054888813324393
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.2481, Accuracy: 9325/9900 (94.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4772/5305 (89.9529%), train_poison_data_count: 415
Global model norm: 44.359314459275346.
Norm before scaling: 44.352732914581345. Distance: 2.2026282217089763
Total norm for 4 adversaries is: 44.352732914581345. distance: 2.2026282217089763
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1474, Accuracy: 9523/9900 (96.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 44.359314459275346.
Norm before scaling: 44.35005763586658. Distance: 2.028389427686193
Total norm for 4 adversaries is: 44.35005763586658. distance: 2.028389427686193
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1742, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 44.359314459275346.
Norm before scaling: 44.35709778630064. Distance: 2.26242302189327
Total norm for 4 adversaries is: 44.35709778630064. distance: 2.26242302189327
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1644, Accuracy: 9465/9900 (95.6061%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4473/5116 (87.4316%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4512/5116 (88.1939%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9976, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4944/5392 (91.6914%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4875/5392 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9898, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4142/4767 (86.8890%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4223/4767 (88.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1190, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4151/4618 (89.8874%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4089/4618 (88.5448%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9868, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3628/4046 (89.6688%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3755/4046 (92.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8024, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4121/4625 (89.1027%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4216/4625 (91.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0437, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3235/3638 (88.9225%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3377/3638 (92.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8576, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3883/4416 (87.9303%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3961/4416 (89.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9226, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4375/4874 (89.7620%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4398/4874 (90.2339%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1156, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3246/3646 (89.0291%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3311/3646 (90.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8364, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4618/5063 (91.2107%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4550/5063 (89.8677%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9870, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3670/4126 (88.9481%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3822/4126 (92.6321%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7807, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4423/4934 (89.6433%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4490/4934 (91.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0692, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4030/4511 (89.3372%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4082/4511 (90.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0140, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4032/4518 (89.2430%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4173/4518 (92.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8843, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2968/3297 (90.0212%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3060/3297 (92.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8302, Accuracy: 5730/10000 (57.3000%)
time spent on training: 230.59204626083374
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.6839, Accuracy: 6193/10000 (61.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 9.3849, Accuracy: 138/9900 (1.3939%)
Done in 254.0512204170227 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4414/4885 (90.3582%), train_poison_data_count: 385
Global model norm: 44.39214842510864.
Norm before scaling: 44.38662782293996. Distance: 2.147436401171503
Total norm for 4 adversaries is: 44.38662782293996. distance: 2.147436401171503
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0991, Accuracy: 9654/9900 (97.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4750/5305 (89.5382%), train_poison_data_count: 415
Global model norm: 44.39214842510864.
Norm before scaling: 44.38668970148878. Distance: 2.223916713733134
Total norm for 4 adversaries is: 44.38668970148878. distance: 2.223916713733134
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1374, Accuracy: 9589/9900 (96.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 44.39214842510864.
Norm before scaling: 44.38183403581709. Distance: 2.017643826828332
Total norm for 4 adversaries is: 44.38183403581709. distance: 2.017643826828332
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.3365, Accuracy: 9073/9900 (91.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 44.39214842510864.
Norm before scaling: 44.386267550564696. Distance: 2.2335620815170927
Total norm for 4 adversaries is: 44.386267550564696. distance: 2.2335620815170927
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.2136, Accuracy: 9379/9900 (94.7374%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5450/6124 (88.9941%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5504/6124 (89.8759%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9614, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4459/5025 (88.7363%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4580/5025 (91.1443%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0285, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3131/3472 (90.1786%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3224/3472 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9001, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4469/5037 (88.7234%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4579/5037 (90.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9265, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5077/5582 (90.9531%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5147/5582 (92.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2037, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4516/5116 (88.2721%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4619/5116 (90.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9444, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4066/4518 (89.9956%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4157/4518 (92.0097%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9032, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4295/4928 (87.1550%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4476/4928 (90.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9448, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4098/4558 (89.9079%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4067/4558 (89.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1045, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2941/3297 (89.2023%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3023/3297 (91.6894%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9057, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3380/3756 (89.9894%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3509/3756 (93.4239%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9994, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4173/4651 (89.7226%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4232/4651 (90.9912%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9771, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3976/4441 (89.5294%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4122/4441 (92.8169%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1800, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3202/3638 (88.0154%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3325/3638 (91.3964%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8848, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4137/4596 (90.0131%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4210/4596 (91.6014%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1037, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2902/3271 (88.7190%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2964/3271 (90.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8748, Accuracy: 5646/10000 (56.4600%)
time spent on training: 230.47507643699646
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.6771, Accuracy: 6200/10000 (62.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 9.3336, Accuracy: 155/9900 (1.5657%)
Done in 253.8491234779358 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4421/4885 (90.5015%), train_poison_data_count: 385
Global model norm: 44.43010030909859.
Norm before scaling: 44.42206735800772. Distance: 2.1071210333592263
Total norm for 4 adversaries is: 44.42206735800772. distance: 2.1071210333592263
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.2285, Accuracy: 9314/9900 (94.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4769/5305 (89.8963%), train_poison_data_count: 415
Global model norm: 44.43010030909859.
Norm before scaling: 44.42383976045407. Distance: 2.246619015517542
Total norm for 4 adversaries is: 44.42383976045407. distance: 2.246619015517542
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0803, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4239/4717 (89.8664%), train_poison_data_count: 370
Global model norm: 44.43010030909859.
Norm before scaling: 44.420336105950675. Distance: 2.0444834475090943
Total norm for 4 adversaries is: 44.420336105950675. distance: 2.0444834475090943
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1867, Accuracy: 9399/9900 (94.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 44.43010030909859.
Norm before scaling: 44.41939488108277. Distance: 2.1654571556233977
Total norm for 4 adversaries is: 44.41939488108277. distance: 2.1654571556233977
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.3377, Accuracy: 9026/9900 (91.1717%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4443/4989 (89.0559%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4478/4989 (89.7575%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8579, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4029/4465 (90.2352%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4132/4465 (92.5420%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8647, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3891/4315 (90.1738%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3968/4315 (91.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7857, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4136/4767 (86.7632%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4226/4767 (88.6511%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2058, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5826/6391 (91.1594%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5820/6391 (91.0656%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0003, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3247/3672 (88.4259%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3312/3672 (90.1961%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8474, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3577/3969 (90.1235%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3621/3969 (91.2320%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8018, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3240/3590 (90.2507%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3151/3590 (87.7716%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9837, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5337/5902 (90.4270%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5263/5902 (89.1732%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0383, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3635/4013 (90.5806%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.6979, Accuracy: 5934/10000 (59.3400%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4501/4804 (93.6928%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4120/4804 (85.7619%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4953, Accuracy: 4863/10000 (48.6300%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3670/4175 (87.9042%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3753/4175 (89.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8954, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3191/3616 (88.2467%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3326/3616 (91.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8112, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3959/4361 (90.7819%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3955/4361 (90.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9584, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4871/5424 (89.8046%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4988/5424 (91.9617%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2285, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3419/3837 (89.1061%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3562/3837 (92.8329%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9153, Accuracy: 5625/10000 (56.2500%)
time spent on training: 231.020751953125
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9322, Accuracy: 5863/10000 (58.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 10.2550, Accuracy: 60/9900 (0.6061%)
Done in 254.39193201065063 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4443/4885 (90.9519%), train_poison_data_count: 385
Global model norm: 44.464468840387745.
Norm before scaling: 44.45662332456071. Distance: 2.0953161730296737
Total norm for 4 adversaries is: 44.45662332456071. distance: 2.0953161730296737
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1373, Accuracy: 9527/9900 (96.2323%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4756/5305 (89.6513%), train_poison_data_count: 415
Global model norm: 44.464468840387745.
Norm before scaling: 44.46188402282763. Distance: 2.291036542323788
Total norm for 4 adversaries is: 44.46188402282763. distance: 2.291036542323788
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2506, Accuracy: 9273/9900 (93.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 44.464468840387745.
Norm before scaling: 44.45423988057129. Distance: 2.010464590288755
Total norm for 4 adversaries is: 44.45423988057129. distance: 2.010464590288755
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.3354, Accuracy: 9038/9900 (91.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 44.464468840387745.
Norm before scaling: 44.45858654938043. Distance: 2.217505092335459
Total norm for 4 adversaries is: 44.45858654938043. distance: 2.217505092335459
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.2213, Accuracy: 9290/9900 (93.8384%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3832/4416 (86.7754%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4030/4416 (91.2591%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9331, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5059/5740 (88.1359%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5208/5740 (90.7317%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0802, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4438/5037 (88.1080%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4596/5037 (91.2448%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9692, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4500/5116 (87.9593%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4603/5116 (89.9726%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9313, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4371/4918 (88.8776%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4465/4918 (90.7889%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0328, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3390/3837 (88.3503%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3533/3837 (92.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8975, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4115/4651 (88.4756%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4265/4651 (91.7007%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0586, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3436/3861 (88.9925%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8791, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3755/4223 (88.9178%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3913/4223 (92.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8612, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4181/4662 (89.6825%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4298/4662 (92.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8866, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5655/6263 (90.2922%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5758/6263 (91.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0483, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3404/3781 (90.0291%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3314/3781 (87.6488%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1743, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3388/3804 (89.0641%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0335, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3431/3828 (89.6290%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3544/3828 (92.5810%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.7267, Accuracy: 5918/10000 (59.1800%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3885/4315 (90.0348%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3976/4315 (92.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8420, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4344/4956 (87.6513%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4457/4956 (89.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9408, Accuracy: 5576/10000 (55.7600%)
time spent on training: 232.2918975353241
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8700, Accuracy: 5985/10000 (59.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 10.2648, Accuracy: 71/9900 (0.7172%)
Done in 255.8215720653534 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4426/4885 (90.6039%), train_poison_data_count: 385
Global model norm: 44.4901413873238.
Norm before scaling: 44.481120358635025. Distance: 2.082718555023039
Total norm for 4 adversaries is: 44.481120358635025. distance: 2.082718555023039
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1437, Accuracy: 9556/9900 (96.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 44.4901413873238.
Norm before scaling: 44.4839208463821. Distance: 2.2318528886189535
Total norm for 4 adversaries is: 44.4839208463821. distance: 2.2318528886189535
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0803, Accuracy: 9699/9900 (97.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4259/4717 (90.2904%), train_poison_data_count: 370
Global model norm: 44.4901413873238.
Norm before scaling: 44.483393967492944. Distance: 2.050270583740774
Total norm for 4 adversaries is: 44.483393967492944. distance: 2.050270583740774
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1423, Accuracy: 9567/9900 (96.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4534/5066 (89.4986%), train_poison_data_count: 400
Global model norm: 44.4901413873238.
Norm before scaling: 44.4863699280465. Distance: 2.217301339042327
Total norm for 4 adversaries is: 44.4863699280465. distance: 2.217301339042327
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.2376, Accuracy: 9330/9900 (94.2424%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4131/4662 (88.6100%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4244/4662 (91.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9911, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3192/3616 (88.2743%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3281/3616 (90.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9078, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3409/3828 (89.0543%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3550/3828 (92.7377%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8397, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2917/3297 (88.4744%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3018/3297 (91.5378%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8680, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3905/4361 (89.5437%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3849/4361 (88.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9330, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4079/4576 (89.1390%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4220/4576 (92.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8867, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3783/4295 (88.0792%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3729/4295 (86.8219%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9458, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4491/5083 (88.3533%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4570/5083 (89.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0628, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4476/5116 (87.4902%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4577/5116 (89.4644%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9688, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3614/4046 (89.3228%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3761/4046 (92.9560%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9738, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5266/5902 (89.2240%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5276/5902 (89.3934%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0087, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4667/5197 (89.8018%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4665/5197 (89.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0644, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4025/4465 (90.1456%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4177/4465 (93.5498%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7755, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3229/3704 (87.1760%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3415/3704 (92.1976%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8185, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3452/3861 (89.4069%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3528/3861 (91.3753%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9819, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3683/4126 (89.2632%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3813/4126 (92.4140%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8400, Accuracy: 5732/10000 (57.3200%)
time spent on training: 228.62789797782898
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8828, Accuracy: 5930/10000 (59.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 10.0616, Accuracy: 78/9900 (0.7879%)
Done in 252.09838962554932 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 44.52904188604402.
Norm before scaling: 44.520009546270316. Distance: 2.1158523009227435
Total norm for 4 adversaries is: 44.520009546270316. distance: 2.1158523009227435
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2009, Accuracy: 9392/9900 (94.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 44.52904188604402.
Norm before scaling: 44.51835202466717. Distance: 2.2053116572528326
Total norm for 4 adversaries is: 44.51835202466717. distance: 2.2053116572528326
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2197, Accuracy: 9351/9900 (94.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4289/4717 (90.9264%), train_poison_data_count: 370
Global model norm: 44.52904188604402.
Norm before scaling: 44.52037422016043. Distance: 1.9960140802119961
Total norm for 4 adversaries is: 44.52037422016043. distance: 1.9960140802119961
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.4048, Accuracy: 8970/9900 (90.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4555/5066 (89.9131%), train_poison_data_count: 400
Global model norm: 44.52904188604402.
Norm before scaling: 44.52513938337953. Distance: 2.2088123257904835
Total norm for 4 adversaries is: 44.52513938337953. distance: 2.2088123257904835
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.2794, Accuracy: 9224/9900 (93.1717%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4012/4511 (88.9382%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4100/4511 (90.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9034, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5100/5740 (88.8502%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5228/5740 (91.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9906, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4209/4662 (90.2831%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4279/4662 (91.7846%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9211, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3767/4235 (88.9492%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3851/4235 (90.9327%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9481, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4757/5265 (90.3514%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4792/5265 (91.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1241, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3998/4433 (90.1872%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4062/4433 (91.6309%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7461, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4123/4596 (89.7084%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4276/4596 (93.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8947, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4571/5055 (90.4253%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4696/5055 (92.8981%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8690, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4435/5037 (88.0484%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4542/5037 (90.1727%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0761, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4106/4538 (90.4804%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4251/4538 (93.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.7885, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3419/3756 (91.0277%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3494/3756 (93.0245%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8906, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3651/4025 (90.7081%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4025 (92.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8611, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4612/5244 (87.9481%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4678/5244 (89.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0601, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4205/4663 (90.1780%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4274/4663 (91.6577%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9389, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3393/3837 (88.4285%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3546/3837 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8635, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4042/4481 (90.2031%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4030/4481 (89.9353%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1180, Accuracy: 5448/10000 (54.4800%)
time spent on training: 232.30643463134766
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8593, Accuracy: 5998/10000 (59.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 9.8382, Accuracy: 110/9900 (1.1111%)
Done in 255.95077514648438 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4406/4885 (90.1945%), train_poison_data_count: 385
Global model norm: 44.55857988104676.
Norm before scaling: 44.55374294873762. Distance: 2.166520688445678
Total norm for 4 adversaries is: 44.55374294873762. distance: 2.166520688445678
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.2279, Accuracy: 9376/9900 (94.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4803/5305 (90.5372%), train_poison_data_count: 415
Global model norm: 44.55857988104676.
Norm before scaling: 44.549411044525186. Distance: 2.206864882418706
Total norm for 4 adversaries is: 44.549411044525186. distance: 2.206864882418706
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1727, Accuracy: 9476/9900 (95.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4280/4717 (90.7356%), train_poison_data_count: 370
Global model norm: 44.55857988104676.
Norm before scaling: 44.55053447569751. Distance: 2.038778467967762
Total norm for 4 adversaries is: 44.55053447569751. distance: 2.038778467967762
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1109, Accuracy: 9612/9900 (97.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4528/5066 (89.3802%), train_poison_data_count: 400
Global model norm: 44.55857988104676.
Norm before scaling: 44.55430461325047. Distance: 2.275400893552473
Total norm for 4 adversaries is: 44.55430461325047. distance: 2.275400893552473
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1833, Accuracy: 9398/9900 (94.9293%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3972/4362 (91.0591%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3906/4362 (89.5461%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0559, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4932/5591 (88.2132%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4977/5591 (89.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9799, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3929/4315 (91.0545%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4019/4315 (93.1402%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8031, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3471/3781 (91.8011%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3485/3781 (92.1714%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9635, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3605/4158 (86.7003%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3707/4158 (89.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9207, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4000/4511 (88.6721%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4048/4511 (89.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0261, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4190/4793 (87.4192%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4360/4793 (90.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9169, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4896/5424 (90.2655%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5009/5424 (92.3488%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3322, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4166/4618 (90.2122%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4212/4618 (91.2083%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0744, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3911/4368 (89.5375%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3928/4368 (89.9267%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9536, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4463/4934 (90.4540%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0103, Accuracy: 4017/4934 (81.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3316, Accuracy: 4819/10000 (48.1900%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4632/5232 (88.5321%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4690/5232 (89.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9236, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5454/5902 (92.4094%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5443/5902 (92.2230%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0262, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4859/5392 (90.1150%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4924/5392 (91.3205%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0383, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4509/5017 (89.8744%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4546/5017 (90.6119%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9290, Accuracy: 5663/10000 (56.6300%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4621/5195 (88.9509%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4694/5195 (90.3561%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0616, Accuracy: 5439/10000 (54.3900%)
time spent on training: 236.6803081035614
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8258, Accuracy: 6034/10000 (60.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 9.7657, Accuracy: 124/9900 (1.2525%)
Done in 260.1040496826172 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 44.59899178635516.
Norm before scaling: 44.59032950485523. Distance: 2.117011143845611
Total norm for 4 adversaries is: 44.59032950485523. distance: 2.117011143845611
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2926, Accuracy: 9196/9900 (92.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 44.59899178635516.
Norm before scaling: 44.591115188016296. Distance: 2.215515895895816
Total norm for 4 adversaries is: 44.591115188016296. distance: 2.215515895895816
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1836, Accuracy: 9458/9900 (95.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4274/4717 (90.6084%), train_poison_data_count: 370
Global model norm: 44.59899178635516.
Norm before scaling: 44.58506068986281. Distance: 1.9979395982091253
Total norm for 4 adversaries is: 44.58506068986281. distance: 1.9979395982091253
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.4337, Accuracy: 8881/9900 (89.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 44.59899178635516.
Norm before scaling: 44.59186937607713. Distance: 2.1723787011808033
Total norm for 4 adversaries is: 44.59186937607713. distance: 2.1723787011808033
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.2267, Accuracy: 9310/9900 (94.0404%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4761/5265 (90.4274%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4778/5265 (90.7502%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8343, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3709/4126 (89.8934%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3817/4126 (92.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8237, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4033/4501 (89.6023%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4075/4501 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0202, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5541/6124 (90.4801%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5505/6124 (89.8922%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9627, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2926/3271 (89.4528%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3004/3271 (91.8374%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8071, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4173/4663 (89.4917%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4331/4663 (92.8801%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9804, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3624/4025 (90.0373%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3732/4025 (92.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8251, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4143/4651 (89.0776%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4240/4651 (91.1632%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0208, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4526/4804 (94.2132%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4480/4804 (93.2556%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9131, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3209/3616 (88.7445%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3327/3616 (92.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7710, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3536/3911 (90.4117%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3477/3911 (88.9031%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1961, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4613/5197 (88.7627%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4700/5197 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1170, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4118/4538 (90.7448%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7263, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5725/6391 (89.5791%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5778/6391 (90.4084%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0041, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3284/3704 (88.6609%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3398/3704 (91.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.7219, Accuracy: 5997/10000 (59.9700%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3784/4235 (89.3506%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3752/4235 (88.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1142, Accuracy: 5224/10000 (52.2400%)
time spent on training: 231.96501564979553
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9397, Accuracy: 5847/10000 (58.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 9.7399, Accuracy: 106/9900 (1.0707%)
Done in 255.21245861053467 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 44.62357890112931.
Norm before scaling: 44.619070476594565. Distance: 2.163138071641772
Total norm for 4 adversaries is: 44.619070476594565. distance: 2.163138071641772
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1534, Accuracy: 9503/9900 (95.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4783/5305 (90.1602%), train_poison_data_count: 415
Global model norm: 44.62357890112931.
Norm before scaling: 44.616253847918195. Distance: 2.223185658886129
Total norm for 4 adversaries is: 44.616253847918195. distance: 2.223185658886129
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0885, Accuracy: 9676/9900 (97.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4244/4717 (89.9724%), train_poison_data_count: 370
Global model norm: 44.62357890112931.
Norm before scaling: 44.614000690558875. Distance: 2.0480459809505964
Total norm for 4 adversaries is: 44.614000690558875. distance: 2.0480459809505964
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.2294, Accuracy: 9355/9900 (94.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4507/5066 (88.9657%), train_poison_data_count: 400
Global model norm: 44.62357890112931.
Norm before scaling: 44.617026762755465. Distance: 2.2527303024580623
Total norm for 4 adversaries is: 44.617026762755465. distance: 2.2527303024580623
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1457, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4523/5116 (88.4089%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4631/5116 (90.5199%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9605, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5086/5582 (91.1143%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5195/5582 (93.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0519, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3812/4235 (90.0118%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3799/4235 (89.7048%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0252, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4165/4625 (90.0541%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4178/4625 (90.3351%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1107, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4118/4481 (91.8991%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4080/4481 (91.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9330, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4613/5232 (88.1690%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4722/5232 (90.2523%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9344, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4186/4662 (89.7898%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4309/4662 (92.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9400, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4063/4441 (91.4884%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4117/4441 (92.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0431, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4042/4518 (89.4644%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4137/4518 (91.5671%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9819, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4398/4928 (89.2451%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4515/4928 (91.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8445, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4125/4634 (89.0160%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4259/4634 (91.9076%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8989, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4566/4934 (92.5415%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4531/4934 (91.8322%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0112, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3443/3861 (89.1738%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3534/3861 (91.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8655, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3193/3616 (88.3020%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3296/3616 (91.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8796, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3892/4416 (88.1341%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4053/4416 (91.7799%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9173, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3393/3797 (89.3600%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3479/3797 (91.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9794, Accuracy: 5671/10000 (56.7100%)
time spent on training: 231.66192770004272
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9012, Accuracy: 5925/10000 (59.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 9.6585, Accuracy: 125/9900 (1.2626%)
Done in 255.14691543579102 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4427/4885 (90.6244%), train_poison_data_count: 385
Global model norm: 44.65108601615279.
Norm before scaling: 44.64825636993006. Distance: 2.1665465492795932
Total norm for 4 adversaries is: 44.64825636993006. distance: 2.1665465492795932
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1933, Accuracy: 9408/9900 (95.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 44.65108601615279.
Norm before scaling: 44.64354673016513. Distance: 2.2206582473340277
Total norm for 4 adversaries is: 44.64354673016513. distance: 2.2206582473340277
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1088, Accuracy: 9627/9900 (97.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 44.65108601615279.
Norm before scaling: 44.6382896659009. Distance: 2.0326030039757494
Total norm for 4 adversaries is: 44.6382896659009. distance: 2.0326030039757494
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.3354, Accuracy: 9039/9900 (91.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 44.65108601615279.
Norm before scaling: 44.6428248604794. Distance: 2.1680227461955375
Total norm for 4 adversaries is: 44.6428248604794. distance: 2.1680227461955375
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.4166, Accuracy: 8876/9900 (89.6566%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5678/6263 (90.6594%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5743/6263 (91.6973%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0475, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3830/4295 (89.1735%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3829/4295 (89.1502%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9698, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4405/4989 (88.2942%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4456/4989 (89.3165%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8953, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3774/4223 (89.3677%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3916/4223 (92.7303%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8108, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5514/6124 (90.0392%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5509/6124 (89.9575%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0161, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4215/4481 (94.0638%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4135/4481 (92.2785%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9776, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4167/4618 (90.2339%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4164/4618 (90.1689%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0111, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4055/4441 (91.3083%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4103/4441 (92.3891%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0178, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3618/4013 (90.1570%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3748/4013 (93.3965%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7859, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3950/4511 (87.5637%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4115/4511 (91.2215%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8682, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3858/4416 (87.3641%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3980/4416 (90.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9270, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4316/4956 (87.0864%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4431/4956 (89.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1520, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4079/4538 (89.8854%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4203/4538 (92.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8867, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4667/5265 (88.6420%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4801/5265 (91.1871%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9147, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4639/5197 (89.2630%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4563/5197 (87.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2922, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4189/4716 (88.8253%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4285/4716 (90.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9830, Accuracy: 5442/10000 (54.4200%)
time spent on training: 236.78009557724
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8669, Accuracy: 5966/10000 (59.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 9.6863, Accuracy: 114/9900 (1.1515%)
Done in 260.3848419189453 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4410/4885 (90.2764%), train_poison_data_count: 385
Global model norm: 44.68394735659762.
Norm before scaling: 44.67716363194191. Distance: 2.148762293453678
Total norm for 4 adversaries is: 44.67716363194191. distance: 2.148762293453678
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2371, Accuracy: 9302/9900 (93.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 44.68394735659762.
Norm before scaling: 44.67852838263028. Distance: 2.2731136340407003
Total norm for 4 adversaries is: 44.67852838263028. distance: 2.2731136340407003
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1386, Accuracy: 9545/9900 (96.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4256/4717 (90.2268%), train_poison_data_count: 370
Global model norm: 44.68394735659762.
Norm before scaling: 44.675955949918546. Distance: 2.051497503269358
Total norm for 4 adversaries is: 44.675955949918546. distance: 2.051497503269358
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1300, Accuracy: 9571/9900 (96.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4514/5066 (89.1038%), train_poison_data_count: 400
Global model norm: 44.68394735659762.
Norm before scaling: 44.676874009817006. Distance: 2.2374874391682718
Total norm for 4 adversaries is: 44.676874009817006. distance: 2.2374874391682718
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.2773, Accuracy: 9192/9900 (92.8485%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3222/3616 (89.1040%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3327/3616 (92.0077%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9634, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3934/4315 (91.1703%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3959/4315 (91.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9217, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4889/5455 (89.6242%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4885/5455 (89.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9256, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4596/4804 (95.6703%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4568/4804 (95.0874%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8625, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3965/4362 (90.8987%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3999/4362 (91.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0146, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5636/6263 (89.9888%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5721/6263 (91.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0959, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4098/4538 (90.3041%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4182/4538 (92.1551%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8394, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4189/4634 (90.3971%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4264/4634 (92.0155%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9935, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4492/5116 (87.8030%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4601/5116 (89.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9611, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4119/4716 (87.3410%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4235/4716 (89.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0226, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3633/4046 (89.7924%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3699/4046 (91.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9935, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4044/4518 (89.5086%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4162/4518 (92.1204%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8377, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4644/5063 (91.7243%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4471/5063 (88.3073%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0868, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5141/5740 (89.5645%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5171/5740 (90.0871%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9529, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5061/5582 (90.6664%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5144/5582 (92.1534%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0560, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4074/4433 (91.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9120, Accuracy: 5553/10000 (55.5300%)
time spent on training: 235.238055229187
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8528, Accuracy: 5983/10000 (59.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 9.6370, Accuracy: 141/9900 (1.4242%)
Done in 258.861127614975 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4411/4885 (90.2968%), train_poison_data_count: 385
Global model norm: 44.71709848016053.
Norm before scaling: 44.7101505096298. Distance: 2.1340063756974423
Total norm for 4 adversaries is: 44.7101505096298. distance: 2.1340063756974423
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1754, Accuracy: 9477/9900 (95.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 44.71709848016053.
Norm before scaling: 44.71055731644233. Distance: 2.218374945949821
Total norm for 4 adversaries is: 44.71055731644233. distance: 2.218374945949821
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2414, Accuracy: 9275/9900 (93.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4263/4717 (90.3752%), train_poison_data_count: 370
Global model norm: 44.71709848016053.
Norm before scaling: 44.70470331013142. Distance: 2.054088780884867
Total norm for 4 adversaries is: 44.70470331013142. distance: 2.054088780884867
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.2328, Accuracy: 9320/9900 (94.1414%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 44.71709848016053.
Norm before scaling: 44.71051636290393. Distance: 2.2288286422230943
Total norm for 4 adversaries is: 44.71051636290393. distance: 2.2288286422230943
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.4060, Accuracy: 8862/9900 (89.5152%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4718/5197 (90.7831%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4656/5197 (89.5901%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9654, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3618/4025 (89.8882%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3726/4025 (92.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8572, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4210/4481 (93.9522%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4170/4481 (93.0596%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9238, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4116/4651 (88.4971%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4224/4651 (90.8192%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9680, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5376/5902 (91.0878%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5298/5902 (89.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9685, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3677/4126 (89.1178%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3806/4126 (92.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8104, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3901/4368 (89.3086%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3922/4368 (89.7894%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0823, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5760/6391 (90.1267%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5788/6391 (90.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1052, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3708/4175 (88.8144%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3751/4175 (89.8443%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8575, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4118/4596 (89.5997%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4218/4596 (91.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0228, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4154/4634 (89.6418%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4256/4634 (91.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8053, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3762/4223 (89.0836%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3873/4223 (91.7121%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8413, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3508/3911 (89.6957%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3412/3911 (87.2411%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0476, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3965/4433 (89.4428%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4071/4433 (91.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9527, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3841/4336 (88.5839%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3975/4336 (91.6744%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0449, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3223/3638 (88.5926%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3342/3638 (91.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8792, Accuracy: 5672/10000 (56.7200%)
time spent on training: 231.78758907318115
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7720, Accuracy: 6073/10000 (60.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 9.5475, Accuracy: 145/9900 (1.4646%)
Done in 255.1762936115265 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 44.7450296209674.
Norm before scaling: 44.74186351266493. Distance: 2.126547754644415
Total norm for 4 adversaries is: 44.74186351266493. distance: 2.126547754644415
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.2616, Accuracy: 9280/9900 (93.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4771/5305 (89.9340%), train_poison_data_count: 415
Global model norm: 44.7450296209674.
Norm before scaling: 44.7393479269612. Distance: 2.2385993984393715
Total norm for 4 adversaries is: 44.7393479269612. distance: 2.2385993984393715
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1554, Accuracy: 9505/9900 (96.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4306/4717 (91.2868%), train_poison_data_count: 370
Global model norm: 44.7450296209674.
Norm before scaling: 44.73112626825489. Distance: 1.9983173086665524
Total norm for 4 adversaries is: 44.73112626825489. distance: 1.9983173086665524
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1616, Accuracy: 9473/9900 (95.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4567/5066 (90.1500%), train_poison_data_count: 400
Global model norm: 44.7450296209674.
Norm before scaling: 44.73721829944141. Distance: 2.193784242889853
Total norm for 4 adversaries is: 44.73721829944141. distance: 2.193784242889853
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.3025, Accuracy: 9161/9900 (92.5354%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3393/3756 (90.3355%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3507/3756 (93.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8091, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4891/5424 (90.1733%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5010/5424 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1329, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3988/4433 (89.9617%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4057/4433 (91.5182%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9097, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3996/4501 (88.7803%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4040/4501 (89.7578%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0000, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3650/4025 (90.6832%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3782/4025 (93.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8146, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3818/4235 (90.1535%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3860/4235 (91.1452%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9294, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5613/6124 (91.6558%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5581/6124 (91.1332%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9446, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4173/4634 (90.0518%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4248/4634 (91.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9009, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4176/4716 (88.5496%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4241/4716 (89.9279%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0777, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4153/4767 (87.1198%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4191/4767 (87.9169%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2187, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3389/3804 (89.0904%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3493/3804 (91.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9819, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3146/3472 (90.6106%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3243/3472 (93.4044%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9578, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4908/5392 (91.0237%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4901/5392 (90.8939%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9974, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5125/5740 (89.2857%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5220/5740 (90.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0460, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4133/4596 (89.9260%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4234/4596 (92.1236%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9647, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3187/3616 (88.1361%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3300/3616 (91.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8058, Accuracy: 5837/10000 (58.3700%)
time spent on training: 232.27467608451843
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.7644, Accuracy: 6080/10000 (60.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 9.8186, Accuracy: 102/9900 (1.0303%)
Done in 255.60303497314453 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4413/4885 (90.3378%), train_poison_data_count: 385
Global model norm: 44.77527710079665.
Norm before scaling: 44.766348979747754. Distance: 2.124708604467951
Total norm for 4 adversaries is: 44.766348979747754. distance: 2.124708604467951
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1085, Accuracy: 9642/9900 (97.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 44.77527710079665.
Norm before scaling: 44.768327252645925. Distance: 2.2574679101836717
Total norm for 4 adversaries is: 44.768327252645925. distance: 2.2574679101836717
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0406, Accuracy: 9791/9900 (98.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 44.77527710079665.
Norm before scaling: 44.765892233059255. Distance: 2.0798797082962914
Total norm for 4 adversaries is: 44.765892233059255. distance: 2.0798797082962914
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0448, Accuracy: 9792/9900 (98.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4572/5066 (90.2487%), train_poison_data_count: 400
Global model norm: 44.77527710079665.
Norm before scaling: 44.769764206542064. Distance: 2.2208125239310443
Total norm for 4 adversaries is: 44.769764206542064. distance: 2.2208125239310443
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.2645, Accuracy: 9278/9900 (93.7172%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4773/5063 (94.2722%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4771/5063 (94.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8195, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4587/4804 (95.4829%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4453/4804 (92.6936%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9036, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4077/4558 (89.4471%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4126/4558 (90.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0272, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3409/3756 (90.7614%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3535/3756 (94.1161%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8998, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4944/5424 (91.1504%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5010/5424 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9988, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4122/4511 (91.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8511, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4638/5167 (89.7620%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4762/5167 (92.1618%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0856, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4051/4356 (92.9982%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4140/4356 (95.0413%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8679, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4614/5244 (87.9863%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4666/5244 (88.9779%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9065, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4254/4793 (88.7544%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4355/4793 (90.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9489, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3419/3828 (89.3156%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3549/3828 (92.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8123, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3662/4046 (90.5091%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3755/4046 (92.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9480, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3661/4013 (91.2285%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3721/4013 (92.7236%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7736, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2930/3271 (89.5751%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0046, Accuracy: 2998/3271 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8668, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3999/4362 (91.6781%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3984/4362 (91.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9313, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3974/4346 (91.4404%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4080/4346 (93.8794%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8416, Accuracy: 5800/10000 (58.0000%)
time spent on training: 230.10735416412354
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7662, Accuracy: 6069/10000 (60.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 9.3956, Accuracy: 142/9900 (1.4343%)
Done in 253.42848992347717 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 44.79464591593927.
Norm before scaling: 44.787152600784275. Distance: 2.1115583634798236
Total norm for 4 adversaries is: 44.787152600784275. distance: 2.1115583634798236
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.1227, Accuracy: 9594/9900 (96.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4789/5305 (90.2733%), train_poison_data_count: 415
Global model norm: 44.79464591593927.
Norm before scaling: 44.78630085350458. Distance: 2.21666910080549
Total norm for 4 adversaries is: 44.78630085350458. distance: 2.21666910080549
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2406, Accuracy: 9304/9900 (93.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 44.79464591593927.
Norm before scaling: 44.78472541904634. Distance: 2.0868737337806063
Total norm for 4 adversaries is: 44.78472541904634. distance: 2.0868737337806063
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0751, Accuracy: 9694/9900 (97.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4533/5066 (89.4789%), train_poison_data_count: 400
Global model norm: 44.79464591593927.
Norm before scaling: 44.790390455413956. Distance: 2.252805973487488
Total norm for 4 adversaries is: 44.790390455413956. distance: 2.252805973487488
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.2658, Accuracy: 9229/9900 (93.2222%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3710/4126 (89.9176%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3827/4126 (92.7533%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8042, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4885/5455 (89.5509%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4977/5455 (91.2374%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8955, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4131/4558 (90.6319%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4120/4558 (90.3905%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0611, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3835/4235 (90.5549%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3894/4235 (91.9481%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8659, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3386/3804 (89.0116%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3531/3804 (92.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8949, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5764/6391 (90.1893%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5713/6391 (89.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2000, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3908/4336 (90.1292%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3991/4336 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0431, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4165/4663 (89.3202%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4349/4663 (93.2661%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9561, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4165/4511 (92.3299%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8139, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4050/4503 (89.9400%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4087/4503 (90.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9747, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4719/5063 (93.2056%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4668/5063 (92.1983%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0515, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3931/4315 (91.1008%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4043/4315 (93.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8292, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3226/3638 (88.6751%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3346/3638 (91.9736%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8608, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4073/4441 (91.7136%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4153/4441 (93.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9771, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4327/4679 (92.4770%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4243/4679 (90.6818%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9947, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4699/5265 (89.2498%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4805/5265 (91.2631%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9642, Accuracy: 5533/10000 (55.3300%)
time spent on training: 232.91355419158936
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8091, Accuracy: 6031/10000 (60.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 9.5538, Accuracy: 131/9900 (1.3232%)
Done in 256.1620304584503 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4428/4885 (90.6448%), train_poison_data_count: 385
Global model norm: 44.83628122690164.
Norm before scaling: 44.826880537797855. Distance: 2.108004202301064
Total norm for 4 adversaries is: 44.826880537797855. distance: 2.108004202301064
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1583, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 44.83628122690164.
Norm before scaling: 44.82680428953753. Distance: 2.228401682663082
Total norm for 4 adversaries is: 44.82680428953753. distance: 2.228401682663082
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1577, Accuracy: 9515/9900 (96.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 44.83628122690164.
Norm before scaling: 44.82471149647466. Distance: 1.9673821071993487
Total norm for 4 adversaries is: 44.82471149647466. distance: 1.9673821071993487
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.3151, Accuracy: 9157/9900 (92.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4548/5066 (89.7750%), train_poison_data_count: 400
Global model norm: 44.83628122690164.
Norm before scaling: 44.830711845891706. Distance: 2.2265014640071707
Total norm for 4 adversaries is: 44.830711845891706. distance: 2.2265014640071707
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1671, Accuracy: 9486/9900 (95.8182%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3924/4336 (90.4982%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4011/4336 (92.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1516, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3433/3828 (89.6813%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7320, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3303/3672 (89.9510%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3316/3672 (90.3050%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9100, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4129/4651 (88.7766%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4231/4651 (90.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0091, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3972/4361 (91.0800%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3924/4361 (89.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1010, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4475/5025 (89.0547%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4592/5025 (91.3831%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0037, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5533/6124 (90.3494%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5600/6124 (91.4435%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9391, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3296/3704 (88.9849%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3416/3704 (92.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7946, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4531/4934 (91.8322%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4289/4934 (86.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0694, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4550/5017 (90.6916%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4619/5017 (92.0670%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8099, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5050/5582 (90.4694%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5167/5582 (92.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9134, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4667/5167 (90.3232%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4659/5167 (90.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2495, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3463/3861 (89.6918%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3469/3861 (89.8472%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2209, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3240/3646 (88.8645%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3347/3646 (91.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7473, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4088/4558 (89.6885%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4069/4558 (89.2716%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0531, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4581/5116 (89.5426%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4661/5116 (91.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8802, Accuracy: 5609/10000 (56.0900%)
time spent on training: 233.05334210395813
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8261, Accuracy: 6034/10000 (60.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 9.4395, Accuracy: 135/9900 (1.3636%)
Done in 256.694096326828 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4402/4885 (90.1126%), train_poison_data_count: 385
Global model norm: 44.87043658247112.
Norm before scaling: 44.85931785524051. Distance: 2.1594437981561407
Total norm for 4 adversaries is: 44.85931785524051. distance: 2.1594437981561407
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0406, Accuracy: 9795/9900 (98.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 44.87043658247112.
Norm before scaling: 44.85845115079697. Distance: 2.2117730708375856
Total norm for 4 adversaries is: 44.85845115079697. distance: 2.2117730708375856
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1682, Accuracy: 9475/9900 (95.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 44.87043658247112.
Norm before scaling: 44.85758034767856. Distance: 2.0327559537301907
Total norm for 4 adversaries is: 44.85758034767856. distance: 2.0327559537301907
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.1072, Accuracy: 9600/9900 (96.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 44.87043658247112.
Norm before scaling: 44.86724939596114. Distance: 2.2719672518841536
Total norm for 4 adversaries is: 44.86724939596114. distance: 2.2719672518841536
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2628, Accuracy: 9240/9900 (93.3333%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4018/4511 (89.0712%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4179/4511 (92.6402%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9304, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3964/4346 (91.2103%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4101/4346 (94.3626%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7958, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4544/4804 (94.5878%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4242/4804 (88.3014%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1616, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4613/5232 (88.1690%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4690/5232 (89.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0466, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4172/4618 (90.3421%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4236/4618 (91.7280%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8392, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3280/3590 (91.3649%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3275/3590 (91.2256%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0439, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5883/6391 (92.0513%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5810/6391 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9745, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4179/4354 (95.9807%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3895/4354 (89.4580%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2244, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4546/5055 (89.9308%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4662/5055 (92.2255%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8866, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3457/3837 (90.0964%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3576/3837 (93.1978%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8732, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4030/4503 (89.4959%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4116/4503 (91.4057%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8590, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4163/4576 (90.9747%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4226/4576 (92.3514%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8395, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4234/4793 (88.3372%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4357/4793 (90.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9675, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4186/4634 (90.3323%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4250/4634 (91.7134%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.7711, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3601/4158 (86.6041%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3709/4158 (89.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0157, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5123/5740 (89.2509%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5239/5740 (91.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0031, Accuracy: 5557/10000 (55.5700%)
time spent on training: 232.87761402130127
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0144, Accuracy: 5772/10000 (57.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 9.3231, Accuracy: 174/9900 (1.7576%)
Done in 256.0079917907715 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4424/4885 (90.5629%), train_poison_data_count: 385
Global model norm: 44.902253867080546.
Norm before scaling: 44.89523802655397. Distance: 2.151247053216382
Total norm for 4 adversaries is: 44.89523802655397. distance: 2.151247053216382
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1671, Accuracy: 9467/9900 (95.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 44.902253867080546.
Norm before scaling: 44.891447575564854. Distance: 2.2251868565995636
Total norm for 4 adversaries is: 44.891447575564854. distance: 2.2251868565995636
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1186, Accuracy: 9608/9900 (97.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4272/4717 (90.5660%), train_poison_data_count: 370
Global model norm: 44.902253867080546.
Norm before scaling: 44.89039929894531. Distance: 2.0416202799399694
Total norm for 4 adversaries is: 44.89039929894531. distance: 2.0416202799399694
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.3018, Accuracy: 9121/9900 (92.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 44.902253867080546.
Norm before scaling: 44.89872909140566. Distance: 2.22071998073116
Total norm for 4 adversaries is: 44.89872909140566. distance: 2.22071998073116
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.5017, Accuracy: 8743/9900 (88.3131%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3726/4184 (89.0535%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3790/4184 (90.5832%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8672, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5642/6263 (90.0846%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5727/6263 (91.4418%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9947, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4027/4456 (90.3725%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4129/4456 (92.6616%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9191, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4145/4538 (91.3398%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4188/4538 (92.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8754, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3760/4235 (88.7839%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3768/4235 (88.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0574, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3729/4223 (88.3022%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3870/4223 (91.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9326, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4846/5455 (88.8359%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4908/5455 (89.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0071, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4424/5037 (87.8301%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4614/5037 (91.6021%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9902, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3405/3756 (90.6550%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3522/3756 (93.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9166, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4743/5265 (90.0855%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4742/5265 (90.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9681, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4521/5055 (89.4362%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4603/5055 (91.0584%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9492, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4566/4804 (95.0458%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4308/4804 (89.6753%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1750, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4733/5063 (93.4821%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4598/5063 (90.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0290, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3817/4295 (88.8708%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3941/4295 (91.7579%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8560, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2951/3271 (90.2171%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0060, Accuracy: 2890/3271 (88.3522%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0405, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4077/4356 (93.5950%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4167/4356 (95.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8542, Accuracy: 5826/10000 (58.2600%)
time spent on training: 231.1905391216278
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2638, Accuracy: 5467/10000 (54.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 8.6441, Accuracy: 233/9900 (2.3535%)
Done in 254.5731110572815 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 44.93320509291403.
Norm before scaling: 44.92387903138555. Distance: 2.093304600953781
Total norm for 4 adversaries is: 44.92387903138555. distance: 2.093304600953781
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.2245, Accuracy: 9344/9900 (94.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4779/5305 (90.0848%), train_poison_data_count: 415
Global model norm: 44.93320509291403.
Norm before scaling: 44.93172310529541. Distance: 2.2538492337689298
Total norm for 4 adversaries is: 44.93172310529541. distance: 2.2538492337689298
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1971, Accuracy: 9403/9900 (94.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4255/4717 (90.2056%), train_poison_data_count: 370
Global model norm: 44.93320509291403.
Norm before scaling: 44.92229483499465. Distance: 2.043575627065555
Total norm for 4 adversaries is: 44.92229483499465. distance: 2.043575627065555
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3083, Accuracy: 9170/9900 (92.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 44.93320509291403.
Norm before scaling: 44.92977104517532. Distance: 2.220309179788103
Total norm for 4 adversaries is: 44.92977104517532. distance: 2.220309179788103
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.3184, Accuracy: 9151/9900 (92.4343%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4051/4503 (89.9622%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4075/4503 (90.4952%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0854, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4031/4456 (90.4623%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4133/4456 (92.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9544, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4752/5265 (90.2564%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4811/5265 (91.3770%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9126, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4241/4793 (88.4832%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4397/4793 (91.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9426, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4378/4928 (88.8393%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9347, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3225/3638 (88.6476%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3329/3638 (91.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9222, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4191/4663 (89.8778%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4333/4663 (92.9230%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9471, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4324/4928 (87.7435%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4477/4928 (90.8482%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9857, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4008/4465 (89.7648%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4106/4465 (91.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8066, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3636/3911 (92.9686%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3517/3911 (89.9259%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9338, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4025/4518 (89.0881%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4126/4518 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0414, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3771/4235 (89.0437%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3877/4235 (91.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0966, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4613/4934 (93.4941%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4320/4934 (87.5557%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0481, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4151/4647 (89.3264%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4277/4647 (92.0379%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8127, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4178/4651 (89.8301%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4267/4651 (91.7437%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9804, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4398/4989 (88.1539%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4466/4989 (89.5169%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8687, Accuracy: 5727/10000 (57.2700%)
time spent on training: 233.14160561561584
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2926, Accuracy: 5371/10000 (53.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 8.3582, Accuracy: 284/9900 (2.8687%)
Done in 256.30895352363586 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4412/4885 (90.3173%), train_poison_data_count: 385
Global model norm: 44.96746463807541.
Norm before scaling: 44.96221693987561. Distance: 2.188725155657246
Total norm for 4 adversaries is: 44.96221693987561. distance: 2.188725155657246
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0721, Accuracy: 9709/9900 (98.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4788/5305 (90.2545%), train_poison_data_count: 415
Global model norm: 44.96746463807541.
Norm before scaling: 44.96052956483053. Distance: 2.2414764446490407
Total norm for 4 adversaries is: 44.96052956483053. distance: 2.2414764446490407
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.3708, Accuracy: 9079/9900 (91.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4277/4717 (90.6720%), train_poison_data_count: 370
Global model norm: 44.96746463807541.
Norm before scaling: 44.95399395232447. Distance: 2.043506325476974
Total norm for 4 adversaries is: 44.95399395232447. distance: 2.043506325476974
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1668, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 44.96746463807541.
Norm before scaling: 44.965581998381. Distance: 2.2948492550012802
Total norm for 4 adversaries is: 44.965581998381. distance: 2.2948492550012802
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1742, Accuracy: 9438/9900 (95.3333%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4089/4538 (90.1058%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4160/4538 (91.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9142, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3981/4362 (91.2655%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3947/4362 (90.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9864, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4495/5244 (85.7170%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4678/5244 (89.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0381, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3645/4046 (90.0890%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3661/4046 (90.4844%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0412, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3627/4013 (90.3813%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3712/4013 (92.4994%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8965, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4014/4465 (89.8992%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4120/4465 (92.2732%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9394, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4581/5232 (87.5573%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4691/5232 (89.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9744, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4361/4928 (88.4943%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4522/4928 (91.7614%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7957, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4683/5063 (92.4946%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4730/5063 (93.4229%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8317, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5353/5902 (90.6981%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5406/5902 (91.5961%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9583, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4035/4456 (90.5521%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9544, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4097/4596 (89.1427%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4235/4596 (92.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8781, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3991/4441 (89.8671%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4093/4441 (92.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0539, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5122/5740 (89.2334%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5245/5740 (91.3763%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1014, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3130/3472 (90.1498%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0671, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3430/3861 (88.8371%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3518/3861 (91.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8684, Accuracy: 5643/10000 (56.4300%)
time spent on training: 233.60007739067078
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
Client 7 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 7 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2097, Accuracy: 5458/10000 (54.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 7.3943, Accuracy: 531/9900 (5.3636%)
Done in 257.09335255622864 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4507/4885 (92.2620%), train_poison_data_count: 385
Global model norm: 44.98630298273784.
Norm before scaling: 44.97913063169199. Distance: 2.0087832467936595
Total norm for 4 adversaries is: 44.97913063169199. distance: 2.0087832467936595
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.3218, Accuracy: 9121/9900 (92.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 44.98630298273784.
Norm before scaling: 44.97991902209668. Distance: 2.144772153014951
Total norm for 4 adversaries is: 44.97991902209668. distance: 2.144772153014951
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.2618, Accuracy: 9282/9900 (93.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 44.98630298273784.
Norm before scaling: 44.97518847236774. Distance: 2.0203126321720277
Total norm for 4 adversaries is: 44.97518847236774. distance: 2.0203126321720277
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1429, Accuracy: 9519/9900 (96.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4564/5066 (90.0908%), train_poison_data_count: 400
Global model norm: 44.98630298273784.
Norm before scaling: 44.97622255929376. Distance: 2.1563614526223263
Total norm for 4 adversaries is: 44.97622255929376. distance: 2.1563614526223263
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1802, Accuracy: 9427/9900 (95.2222%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3431/3797 (90.3608%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3503/3797 (92.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8923, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2938/3297 (89.1113%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3059/3297 (92.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7928, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3622/3911 (92.6106%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3436/3911 (87.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2247, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2874/3271 (87.8630%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0061, Accuracy: 2901/3271 (88.6885%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0092, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3680/4046 (90.9540%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3762/4046 (92.9807%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9165, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5141/5740 (89.5645%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5234/5740 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0347, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3579/3969 (90.1738%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3620/3969 (91.2069%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8769, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3308/3704 (89.3089%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3373/3704 (91.0637%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8683, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4294/4767 (90.0776%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4301/4767 (90.2245%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0117, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4408/4956 (88.9427%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4427/4956 (89.3261%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0378, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3256/3590 (90.6964%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3073/3590 (85.5989%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2448, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5417/5902 (91.7824%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5324/5902 (90.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0467, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4411/4928 (89.5089%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4544/4928 (92.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7712, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3814/4235 (90.0590%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3933/4235 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0259, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4738/5265 (89.9905%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4738/5265 (89.9905%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1460, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4132/4356 (94.8577%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3794/4356 (87.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1167, Accuracy: 5308/10000 (53.0800%)
time spent on training: 226.9471538066864
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3534, Accuracy: 5236/10000 (52.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 7.6882, Accuracy: 369/9900 (3.7273%)
Done in 250.14238357543945 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 45.016414107106534.
Norm before scaling: 45.00790539284807. Distance: 2.0574905363771405
Total norm for 4 adversaries is: 45.00790539284807. distance: 2.0574905363771405
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.2130, Accuracy: 9392/9900 (94.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 45.016414107106534.
Norm before scaling: 45.00578847319253. Distance: 2.1733404471080098
Total norm for 4 adversaries is: 45.00578847319253. distance: 2.1733404471080098
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1775, Accuracy: 9461/9900 (95.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4260/4717 (90.3116%), train_poison_data_count: 370
Global model norm: 45.016414107106534.
Norm before scaling: 45.005599966229894. Distance: 2.0293567931330974
Total norm for 4 adversaries is: 45.005599966229894. distance: 2.0293567931330974
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1012, Accuracy: 9644/9900 (97.4141%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4613/5066 (91.0580%), train_poison_data_count: 400
Global model norm: 45.016414107106534.
Norm before scaling: 45.00792302212606. Distance: 2.1496275778846656
Total norm for 4 adversaries is: 45.00792302212606. distance: 2.1496275778846656
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1276, Accuracy: 9579/9900 (96.7576%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3673/4025 (91.2547%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3781/4025 (93.9379%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8116, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5368/5902 (90.9522%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5449/5902 (92.3246%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9855, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4235/4793 (88.3580%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4367/4793 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8918, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4739/5265 (90.0095%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4779/5265 (90.7692%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9238, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3809/4295 (88.6845%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3818/4295 (88.8941%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9883, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3309/3704 (89.3359%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3386/3704 (91.4147%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8182, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4508/5116 (88.1157%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4573/5116 (89.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0005, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5149/5740 (89.7038%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5239/5740 (91.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0700, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3438/3797 (90.5452%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3466/3797 (91.2826%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9975, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4185/4716 (88.7405%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4283/4716 (90.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9254, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4022/4433 (90.7286%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4104/4433 (92.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8621, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3954/4416 (89.5380%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4019/4416 (91.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8734, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3756/4223 (88.9415%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3882/4223 (91.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8704, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4477/5083 (88.0779%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4564/5083 (89.7895%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9234, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4103/4576 (89.6635%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4222/4576 (92.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9888, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4864/5392 (90.2077%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4851/5392 (89.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0623, Accuracy: 5512/10000 (55.1200%)
time spent on training: 234.07403016090393
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.4127, Accuracy: 5203/10000 (52.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 7.8397, Accuracy: 253/9900 (2.5556%)
Done in 257.38637828826904 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4488/4885 (91.8731%), train_poison_data_count: 385
Global model norm: 45.04233441606282.
Norm before scaling: 45.03073901297521. Distance: 2.0212356193186607
Total norm for 4 adversaries is: 45.03073901297521. distance: 2.0212356193186607
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2430, Accuracy: 9314/9900 (94.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4817/5305 (90.8011%), train_poison_data_count: 415
Global model norm: 45.04233441606282.
Norm before scaling: 45.0329482786111. Distance: 2.1655755107558923
Total norm for 4 adversaries is: 45.0329482786111. distance: 2.1655755107558923
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.1607, Accuracy: 9487/9900 (95.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4284/4717 (90.8204%), train_poison_data_count: 370
Global model norm: 45.04233441606282.
Norm before scaling: 45.03224349398509. Distance: 2.0177886941635967
Total norm for 4 adversaries is: 45.03224349398509. distance: 2.0177886941635967
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0750, Accuracy: 9700/9900 (97.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4571/5066 (90.2290%), train_poison_data_count: 400
Global model norm: 45.04233441606282.
Norm before scaling: 45.034719678959924. Distance: 2.1774601100767246
Total norm for 4 adversaries is: 45.034719678959924. distance: 2.1774601100767246
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.2986, Accuracy: 9198/9900 (92.9091%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4761/5265 (90.4274%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4801/5265 (91.1871%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9979, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4071/4356 (93.4573%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3959/4356 (90.8861%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1986, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3438/3756 (91.5335%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3513/3756 (93.5304%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8506, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3438/3837 (89.6013%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3566/3837 (92.9372%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8403, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5168/5740 (90.0348%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5238/5740 (91.2544%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9758, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3752/4223 (88.8468%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3868/4223 (91.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8028, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4008/4465 (89.7648%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4127/4465 (92.4300%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9138, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5016/5591 (89.7156%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5059/5591 (90.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0498, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5447/5902 (92.2907%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5242/5902 (88.8174%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1181, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4412/4918 (89.7113%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4515/4918 (91.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0572, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3463/3861 (89.6918%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3531/3861 (91.4530%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9499, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3892/4295 (90.6170%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3916/4295 (91.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9096, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3595/4158 (86.4598%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3699/4158 (88.9610%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9187, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5687/6263 (90.8031%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5707/6263 (91.1225%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1062, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4166/4354 (95.6821%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3534/4354 (81.1667%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5691, Accuracy: 4612/10000 (46.1200%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3399/3797 (89.5180%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3485/3797 (91.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9379, Accuracy: 5689/10000 (56.8900%)
time spent on training: 232.29992985725403
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.4613, Accuracy: 5098/10000 (50.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 8.5122, Accuracy: 172/9900 (1.7374%)
Done in 256.24039483070374 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 45.085793325233006.
Norm before scaling: 45.07440273843418. Distance: 2.034637677979019
Total norm for 4 adversaries is: 45.07440273843418. distance: 2.034637677979019
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2094, Accuracy: 9379/9900 (94.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4781/5305 (90.1225%), train_poison_data_count: 415
Global model norm: 45.085793325233006.
Norm before scaling: 45.0755983910641. Distance: 2.2087180924067367
Total norm for 4 adversaries is: 45.0755983910641. distance: 2.2087180924067367
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.3460, Accuracy: 9086/9900 (91.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 45.085793325233006.
Norm before scaling: 45.07663694467664. Distance: 2.007384970897889
Total norm for 4 adversaries is: 45.07663694467664. distance: 2.007384970897889
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1989, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4531/5066 (89.4394%), train_poison_data_count: 400
Global model norm: 45.085793325233006.
Norm before scaling: 45.080479520398434. Distance: 2.2480451781053543
Total norm for 4 adversaries is: 45.080479520398434. distance: 2.2480451781053543
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.2419, Accuracy: 9275/9900 (93.6869%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3401/3797 (89.5707%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3457/3797 (91.0456%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9168, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4472/5037 (88.7830%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4622/5037 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8330, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4631/4934 (93.8589%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4641/4934 (94.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9351, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4860/5455 (89.0926%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4876/5455 (89.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0252, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5376/5902 (91.0878%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5253/5902 (89.0037%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3138, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5855/6391 (91.6132%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5911/6391 (92.4894%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1274, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3558/3911 (90.9742%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3495/3911 (89.3633%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0561, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4633/5195 (89.1819%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4709/5195 (90.6449%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0280, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3812/4235 (90.0118%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3873/4235 (91.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8880, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4510/5116 (88.1548%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4610/5116 (90.1095%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0805, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4110/4538 (90.5685%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4282/4538 (94.3587%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8429, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5014/5582 (89.8244%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5128/5582 (91.8667%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1743, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4091/4558 (89.7543%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4192/4558 (91.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0541, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3654/4046 (90.3114%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3746/4046 (92.5853%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8792, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3430/3828 (89.6029%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3510/3828 (91.6928%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8506, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4498/5055 (88.9812%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4613/5055 (91.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9146, Accuracy: 5673/10000 (56.7300%)
time spent on training: 238.68933773040771
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4316, Accuracy: 5152/10000 (51.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 8.2831, Accuracy: 238/9900 (2.4040%)
Done in 261.9844796657562 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 45.123155043655245.
Norm before scaling: 45.114479761820235. Distance: 1.9768555917670576
Total norm for 4 adversaries is: 45.114479761820235. distance: 1.9768555917670576
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1775, Accuracy: 9474/9900 (95.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4763/5305 (89.7832%), train_poison_data_count: 415
Global model norm: 45.123155043655245.
Norm before scaling: 45.11361931236439. Distance: 2.2229475691940515
Total norm for 4 adversaries is: 45.11361931236439. distance: 2.2229475691940515
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2609, Accuracy: 9302/9900 (93.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 45.123155043655245.
Norm before scaling: 45.10985803560224. Distance: 1.986419285545645
Total norm for 4 adversaries is: 45.10985803560224. distance: 1.986419285545645
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.2129, Accuracy: 9372/9900 (94.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 45.123155043655245.
Norm before scaling: 45.11493162650324. Distance: 2.200155434752907
Total norm for 4 adversaries is: 45.11493162650324. distance: 2.200155434752907
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1524, Accuracy: 9504/9900 (96.0000%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5061/5582 (90.6664%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5093/5582 (91.2397%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9762, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3973/4501 (88.2693%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4079/4501 (90.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9960, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3578/3911 (91.4856%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3553/3911 (90.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9983, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4201/4663 (90.0922%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4303/4663 (92.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9049, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4732/5265 (89.8765%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4767/5265 (90.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8769, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3885/4416 (87.9755%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4002/4416 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0028, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3971/4433 (89.5782%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4098/4433 (92.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.7855, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5639/6263 (90.0367%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5666/6263 (90.4678%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0632, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4886/5455 (89.5692%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4933/5455 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8900, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4152/4634 (89.5986%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4200/4634 (90.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9161, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4185/4707 (88.9101%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4322/4707 (91.8207%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9005, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3715/4126 (90.0388%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3826/4126 (92.7290%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8448, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4518/5116 (88.3112%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4574/5116 (89.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9573, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4686/5063 (92.5538%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4705/5063 (92.9291%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9679, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3946/4361 (90.4838%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3830/4361 (87.8239%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1355, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5466/6124 (89.2554%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5600/6124 (91.4435%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8163, Accuracy: 5717/10000 (57.1700%)
time spent on training: 237.01117706298828
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.4075, Accuracy: 5226/10000 (52.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 9.0665, Accuracy: 146/9900 (1.4747%)
Done in 260.29790210723877 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 45.15298701446146.
Norm before scaling: 45.14202982194434. Distance: 2.0772138620250122
Total norm for 4 adversaries is: 45.14202982194434. distance: 2.0772138620250122
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0501, Accuracy: 9774/9900 (98.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 45.15298701446146.
Norm before scaling: 45.14060471832359. Distance: 2.1840088369588964
Total norm for 4 adversaries is: 45.14060471832359. distance: 2.1840088369588964
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.1707, Accuracy: 9475/9900 (95.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 45.15298701446146.
Norm before scaling: 45.13874823028298. Distance: 2.002198679681285
Total norm for 4 adversaries is: 45.13874823028298. distance: 2.002198679681285
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2277, Accuracy: 9321/9900 (94.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4572/5066 (90.2487%), train_poison_data_count: 400
Global model norm: 45.15298701446146.
Norm before scaling: 45.1427193720614. Distance: 2.129312514991405
Total norm for 4 adversaries is: 45.1427193720614. distance: 2.129312514991405
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.2020, Accuracy: 9382/9900 (94.7677%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4057/4356 (93.1359%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3894/4356 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1434, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3975/4362 (91.1279%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3993/4362 (91.5406%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1176, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4288/4679 (91.6435%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4144/4679 (88.5659%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2488, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3604/4158 (86.6763%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3749/4158 (90.1635%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9162, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4196/4651 (90.2172%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4279/4651 (92.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9860, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3709/4175 (88.8383%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3778/4175 (90.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9618, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4171/4618 (90.3205%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4246/4618 (91.9446%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8711, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4134/4625 (89.3838%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4155/4625 (89.8378%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9593, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5041/5582 (90.3081%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5096/5582 (91.2934%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0447, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4364/4874 (89.5363%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4449/4874 (91.2803%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1244, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4636/4934 (93.9603%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4363/4934 (88.4272%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2732, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4914/5424 (90.5973%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5024/5424 (92.6254%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1822, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4574/4804 (95.2123%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4398/4804 (91.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8866, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4429/4918 (90.0569%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0333, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3469/3861 (89.8472%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3508/3861 (90.8573%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8659, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3796/4223 (89.8887%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3888/4223 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8236, Accuracy: 5791/10000 (57.9100%)
time spent on training: 230.87223172187805
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3218, Accuracy: 5283/10000 (52.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 8.6472, Accuracy: 191/9900 (1.9293%)
Done in 254.10189294815063 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 45.18356791545254.
Norm before scaling: 45.17193310053337. Distance: 2.010957384937439
Total norm for 4 adversaries is: 45.17193310053337. distance: 2.010957384937439
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1557, Accuracy: 9531/9900 (96.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4824/5305 (90.9331%), train_poison_data_count: 415
Global model norm: 45.18356791545254.
Norm before scaling: 45.17178311993423. Distance: 2.171086559304337
Total norm for 4 adversaries is: 45.17178311993423. distance: 2.171086559304337
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.1105, Accuracy: 9635/9900 (97.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4304/4717 (91.2444%), train_poison_data_count: 370
Global model norm: 45.18356791545254.
Norm before scaling: 45.16939957762473. Distance: 1.9458285340516115
Total norm for 4 adversaries is: 45.16939957762473. distance: 1.9458285340516115
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2087, Accuracy: 9393/9900 (94.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 45.18356791545254.
Norm before scaling: 45.176776800800816. Distance: 2.1801175476020336
Total norm for 4 adversaries is: 45.176776800800816. distance: 2.1801175476020336
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.2691, Accuracy: 9223/9900 (93.1616%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4107/4647 (88.3796%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4275/4647 (91.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8085, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3415/3804 (89.7739%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3512/3804 (92.3239%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9349, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4994/5591 (89.3221%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5039/5591 (90.1270%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1406, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4160/4634 (89.7713%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4243/4634 (91.5624%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9184, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4023/4433 (90.7512%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4120/4433 (92.9393%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8098, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3280/3704 (88.5529%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3382/3704 (91.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8356, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3412/3837 (88.9236%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3567/3837 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9045, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4881/5455 (89.4775%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4943/5455 (90.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9430, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5175/5740 (90.1568%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5255/5740 (91.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1707, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4425/4986 (88.7485%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4537/4986 (90.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8983, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4065/4456 (91.2253%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4163/4456 (93.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9673, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4042/4356 (92.7916%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3901/4356 (89.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2187, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3212/3590 (89.4708%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3223/3590 (89.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0589, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4031/4503 (89.5181%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4093/4503 (90.8950%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9931, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4495/5037 (89.2396%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4606/5037 (91.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1095, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4627/5167 (89.5491%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4741/5167 (91.7554%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0497, Accuracy: 5473/10000 (54.7300%)
time spent on training: 231.96544933319092
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3260, Accuracy: 5225/10000 (52.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 8.6976, Accuracy: 174/9900 (1.7576%)
Done in 255.43562173843384 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4516/4885 (92.4463%), train_poison_data_count: 385
Global model norm: 45.20617239339046.
Norm before scaling: 45.19393296835801. Distance: 1.9965075159196515
Total norm for 4 adversaries is: 45.19393296835801. distance: 1.9965075159196515
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1405, Accuracy: 9541/9900 (96.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4773/5305 (89.9717%), train_poison_data_count: 415
Global model norm: 45.20617239339046.
Norm before scaling: 45.19218401553249. Distance: 2.1906140641444223
Total norm for 4 adversaries is: 45.19218401553249. distance: 2.1906140641444223
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2918, Accuracy: 9165/9900 (92.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4251/4717 (90.1208%), train_poison_data_count: 370
Global model norm: 45.20617239339046.
Norm before scaling: 45.19396267971323. Distance: 2.041542386794268
Total norm for 4 adversaries is: 45.19396267971323. distance: 2.041542386794268
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.1147, Accuracy: 9612/9900 (97.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4549/5066 (89.7947%), train_poison_data_count: 400
Global model norm: 45.20617239339046.
Norm before scaling: 45.19978842896764. Distance: 2.2079320099079087
Total norm for 4 adversaries is: 45.19978842896764. distance: 2.2079320099079087
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0763, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3219/3638 (88.4827%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8372, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4176/4716 (88.5496%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4271/4716 (90.5640%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9718, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4359/4956 (87.9540%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4450/4956 (89.7902%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1519, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4924/5392 (91.3205%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4952/5392 (91.8398%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0053, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3741/4184 (89.4120%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3881/4184 (92.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7823, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4118/4481 (91.8991%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4104/4481 (91.5867%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9440, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3265/3646 (89.5502%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3383/3646 (92.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.7932, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4503/5025 (89.6119%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4579/5025 (91.1244%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0019, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3331/3590 (92.7855%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3221/3590 (89.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0465, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4133/4596 (89.9260%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4309/4596 (93.7554%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9018, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3902/4336 (89.9908%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3984/4336 (91.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9685, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4377/4874 (89.8030%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4336/4874 (88.9618%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1569, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4663/5167 (90.2458%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4764/5167 (92.2005%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1036, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4214/4618 (91.2516%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4230/4618 (91.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9184, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4414/4928 (89.5698%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4494/4928 (91.1932%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9677, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4167/4647 (89.6708%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4233/4647 (91.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9153, Accuracy: 5623/10000 (56.2300%)
time spent on training: 232.40031814575195
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2931, Accuracy: 5268/10000 (52.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 8.5672, Accuracy: 208/9900 (2.1010%)
Done in 256.20393419265747 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4461/4885 (91.3204%), train_poison_data_count: 385
Global model norm: 45.23520346823368.
Norm before scaling: 45.226499746242524. Distance: 2.0035820116813183
Total norm for 4 adversaries is: 45.226499746242524. distance: 2.0035820116813183
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.3938, Accuracy: 8989/9900 (90.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4805/5305 (90.5749%), train_poison_data_count: 415
Global model norm: 45.23520346823368.
Norm before scaling: 45.22591404030713. Distance: 2.215142985049468
Total norm for 4 adversaries is: 45.22591404030713. distance: 2.215142985049468
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2022, Accuracy: 9400/9900 (94.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4278/4717 (90.6932%), train_poison_data_count: 370
Global model norm: 45.23520346823368.
Norm before scaling: 45.22414203123081. Distance: 2.0218941830605024
Total norm for 4 adversaries is: 45.22414203123081. distance: 2.0218941830605024
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2146, Accuracy: 9367/9900 (94.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4566/5066 (90.1303%), train_poison_data_count: 400
Global model norm: 45.23520346823368.
Norm before scaling: 45.22567111856937. Distance: 2.1488753548850896
Total norm for 4 adversaries is: 45.22567111856937. distance: 2.1488753548850896
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.2342, Accuracy: 9316/9900 (94.1010%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3883/4368 (88.8965%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3936/4368 (90.1099%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8073, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4660/5195 (89.7016%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4576/5195 (88.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2458, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3887/4315 (90.0811%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4022/4315 (93.2097%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8508, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3230/3646 (88.5902%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3370/3646 (92.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8183, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3313/3590 (92.2841%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3320/3590 (92.4791%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9493, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3699/4126 (89.6510%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3860/4126 (93.5531%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7855, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4011/4361 (91.9743%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4045/4361 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9156, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3424/3837 (89.2364%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3569/3837 (93.0154%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8812, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3822/4235 (90.2479%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3810/4235 (89.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0006, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5506/5902 (93.2904%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5461/5902 (92.5280%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0566, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4031/4433 (90.9316%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4020/4433 (90.6835%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9625, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3209/3638 (88.2078%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3324/3638 (91.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7487, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4641/5232 (88.7041%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4706/5232 (89.9465%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0600, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3902/4336 (89.9908%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3992/4336 (92.0664%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0382, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4416/4989 (88.5147%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4526/4989 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9284, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4162/4481 (92.8811%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4110/4481 (91.7206%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8226, Accuracy: 5884/10000 (58.8400%)
time spent on training: 231.44224572181702
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3922, Accuracy: 5152/10000 (51.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 8.1555, Accuracy: 250/9900 (2.5253%)
Done in 254.85644507408142 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4480/4885 (91.7093%), train_poison_data_count: 385
Global model norm: 45.268720769181506.
Norm before scaling: 45.25488254908248. Distance: 1.9966634097998819
Total norm for 4 adversaries is: 45.25488254908248. distance: 1.9966634097998819
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1809, Accuracy: 9460/9900 (95.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4840/5305 (91.2347%), train_poison_data_count: 415
Global model norm: 45.268720769181506.
Norm before scaling: 45.257488158038555. Distance: 2.1207416726960338
Total norm for 4 adversaries is: 45.257488158038555. distance: 2.1207416726960338
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0506, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 45.268720769181506.
Norm before scaling: 45.25402476921251. Distance: 1.949104015207287
Total norm for 4 adversaries is: 45.25402476921251. distance: 1.949104015207287
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0527, Accuracy: 9769/9900 (98.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4556/5066 (89.9329%), train_poison_data_count: 400
Global model norm: 45.268720769181506.
Norm before scaling: 45.26320324898996. Distance: 2.1919371154006893
Total norm for 4 adversaries is: 45.26320324898996. distance: 2.1919371154006893
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1306, Accuracy: 9558/9900 (96.5455%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4541/5116 (88.7608%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4645/5116 (90.7936%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8538, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4012/4362 (91.9762%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3984/4362 (91.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0299, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4046/4441 (91.1056%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4123/4441 (92.8395%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0042, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4301/4663 (92.2368%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4324/4663 (92.7300%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0694, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4570/5083 (89.9075%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4630/5083 (91.0879%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9730, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4254/4767 (89.2385%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4331/4767 (90.8538%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9942, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3460/3797 (91.1246%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3499/3797 (92.1517%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8402, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4749/5195 (91.4148%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4799/5195 (92.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9741, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4195/4618 (90.8402%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4213/4618 (91.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0759, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4014/4433 (90.5482%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4019/4433 (90.6610%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8456, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4551/5055 (90.0297%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4654/5055 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7762, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3625/4158 (87.1813%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3786/4158 (91.0534%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8582, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3450/3781 (91.2457%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3390/3781 (89.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0183, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3720/4175 (89.1018%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3767/4175 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9022, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4756/5265 (90.3324%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4771/5265 (90.6173%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8967, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3451/3837 (89.9401%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3548/3837 (92.4681%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8109, Accuracy: 5764/10000 (57.6400%)
time spent on training: 232.41050744056702
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.4005, Accuracy: 5132/10000 (51.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 7.9645, Accuracy: 309/9900 (3.1212%)
Done in 255.536723613739 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4495/4885 (92.0164%), train_poison_data_count: 385
Global model norm: 45.297001659878106.
Norm before scaling: 45.283023817913815. Distance: 2.01022253598079
Total norm for 4 adversaries is: 45.283023817913815. distance: 2.01022253598079
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0997, Accuracy: 9655/9900 (97.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4816/5305 (90.7823%), train_poison_data_count: 415
Global model norm: 45.297001659878106.
Norm before scaling: 45.28503477971503. Distance: 2.15465885002226
Total norm for 4 adversaries is: 45.28503477971503. distance: 2.15465885002226
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1629, Accuracy: 9503/9900 (95.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4311/4717 (91.3928%), train_poison_data_count: 370
Global model norm: 45.297001659878106.
Norm before scaling: 45.28279198547722. Distance: 1.9478134563118716
Total norm for 4 adversaries is: 45.28279198547722. distance: 1.9478134563118716
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.1552, Accuracy: 9490/9900 (95.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4599/5066 (90.7817%), train_poison_data_count: 400
Global model norm: 45.297001659878106.
Norm before scaling: 45.28888123669953. Distance: 2.1339949798739446
Total norm for 4 adversaries is: 45.28888123669953. distance: 2.1339949798739446
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0903, Accuracy: 9691/9900 (97.8889%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3655/3911 (93.4544%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3494/3911 (89.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0703, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4755/5195 (91.5303%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4673/5195 (89.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1557, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3488/3775 (92.3974%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3588/3775 (95.0464%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8375, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4375/4679 (93.5029%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4374/4679 (93.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9311, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4034/4361 (92.5017%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4045/4361 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9453, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3287/3672 (89.5153%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3399/3672 (92.5654%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9616, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4149/4481 (92.5909%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4131/4481 (92.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0452, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3711/4126 (89.9418%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3837/4126 (92.9956%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8133, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3587/3969 (90.3754%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3648/3969 (91.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9318, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4637/5116 (90.6372%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4641/5116 (90.7154%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8658, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4672/5063 (92.2773%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4474/5063 (88.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9675, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2978/3297 (90.3245%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3087/3297 (93.6306%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7325, Accuracy: 5994/10000 (59.9400%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4482/5037 (88.9815%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4600/5037 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9178, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4200/4596 (91.3838%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4280/4596 (93.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9901, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4016/4501 (89.2246%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4043/4501 (89.8245%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9143, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4062/4465 (90.9742%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4179/4465 (93.5946%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7963, Accuracy: 5919/10000 (59.1900%)
time spent on training: 227.73746371269226
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3406, Accuracy: 5258/10000 (52.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 7.8028, Accuracy: 368/9900 (3.7172%)
Done in 251.0338852405548 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4519/4885 (92.5077%), train_poison_data_count: 385
Global model norm: 45.32792032873475.
Norm before scaling: 45.313531777046194. Distance: 1.9706646525140845
Total norm for 4 adversaries is: 45.313531777046194. distance: 1.9706646525140845
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1461, Accuracy: 9519/9900 (96.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4810/5305 (90.6692%), train_poison_data_count: 415
Global model norm: 45.32792032873475.
Norm before scaling: 45.31515078453342. Distance: 2.1524348023362068
Total norm for 4 adversaries is: 45.31515078453342. distance: 2.1524348023362068
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0820, Accuracy: 9699/9900 (97.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4331/4717 (91.8168%), train_poison_data_count: 370
Global model norm: 45.32792032873475.
Norm before scaling: 45.31661080491071. Distance: 1.9296864497996573
Total norm for 4 adversaries is: 45.31661080491071. distance: 1.9296864497996573
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1811, Accuracy: 9476/9900 (95.7172%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4592/5066 (90.6435%), train_poison_data_count: 400
Global model norm: 45.32792032873475.
Norm before scaling: 45.31869839070982. Distance: 2.1360781753750206
Total norm for 4 adversaries is: 45.31869839070982. distance: 2.1360781753750206
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1293, Accuracy: 9556/9900 (96.5253%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4019/4361 (92.1578%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4080/4361 (93.5565%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8424, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3969/4346 (91.3254%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4093/4346 (94.1786%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7765, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4897/5455 (89.7709%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4997/5455 (91.6040%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9443, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4020/4465 (90.0336%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4155/4465 (93.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7914, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3966/4336 (91.4668%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4025/4336 (92.8275%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9955, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4062/4441 (91.4659%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4186/4441 (94.2580%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9780, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3962/4362 (90.8299%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3969/4362 (90.9904%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9445, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3574/3969 (90.0479%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3635/3969 (91.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9653, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3863/4295 (89.9418%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3935/4295 (91.6182%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9125, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4540/5017 (90.4923%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4601/5017 (91.7082%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9606, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4751/5063 (93.8376%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4640/5063 (91.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9649, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2952/3271 (90.2476%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2922/3271 (89.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9052, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5739/6263 (91.6334%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5759/6263 (91.9527%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9552, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4487/4874 (92.0599%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4464/4874 (91.5880%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9600, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3630/3911 (92.8151%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3635/3911 (92.9430%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7853, Accuracy: 5985/10000 (59.8500%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4542/4804 (94.5462%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4542/4804 (94.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.7995, Accuracy: 5866/10000 (58.6600%)
time spent on training: 233.69835591316223
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2762, Accuracy: 5334/10000 (53.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 7.9124, Accuracy: 375/9900 (3.7879%)
Done in 257.08367347717285 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4487/4885 (91.8526%), train_poison_data_count: 385
Global model norm: 45.354344902803966.
Norm before scaling: 45.34121396250601. Distance: 2.0133186570742088
Total norm for 4 adversaries is: 45.34121396250601. distance: 2.0133186570742088
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0563, Accuracy: 9756/9900 (98.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 45.354344902803966.
Norm before scaling: 45.34004819917073. Distance: 2.151589706348618
Total norm for 4 adversaries is: 45.34004819917073. distance: 2.151589706348618
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.2653, Accuracy: 9242/9900 (93.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4271/4717 (90.5448%), train_poison_data_count: 370
Global model norm: 45.354344902803966.
Norm before scaling: 45.34199740324223. Distance: 2.0260969087445613
Total norm for 4 adversaries is: 45.34199740324223. distance: 2.0260969087445613
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1495, Accuracy: 9531/9900 (96.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4561/5066 (90.0316%), train_poison_data_count: 400
Global model norm: 45.354344902803966.
Norm before scaling: 45.34310388926303. Distance: 2.1457570503774153
Total norm for 4 adversaries is: 45.34310388926303. distance: 2.1457570503774153
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.1143, Accuracy: 9592/9900 (96.8889%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5480/5902 (92.8499%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5496/5902 (93.1210%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9193, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4446/4918 (90.4026%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4553/4918 (92.5783%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0259, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3646/4025 (90.5839%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3775/4025 (93.7888%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8043, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3171/3472 (91.3306%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3213/3472 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9304, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4264/4793 (88.9631%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4387/4793 (91.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0704, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4622/4934 (93.6765%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4641/4934 (94.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7862, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3629/3911 (92.7896%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3579/3911 (91.5111%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9357, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4918/5392 (91.2092%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4892/5392 (90.7270%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9746, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3268/3638 (89.8296%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3371/3638 (92.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8028, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5496/6124 (89.7453%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5552/6124 (90.6597%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8456, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3758/4175 (90.0120%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3831/4175 (91.7605%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9301, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4170/4625 (90.1622%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4171/4625 (90.1838%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0198, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4195/4354 (96.3482%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3970/4354 (91.1805%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1981, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4156/4511 (92.1303%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8954, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3325/3704 (89.7678%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3376/3704 (91.1447%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8514, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3502/3861 (90.7019%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3540/3861 (91.6861%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8333, Accuracy: 5773/10000 (57.7300%)
time spent on training: 229.85748028755188
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3444, Accuracy: 5227/10000 (52.2700%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 7.4522, Accuracy: 511/9900 (5.1616%)
Done in 253.17737817764282 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4488/4885 (91.8731%), train_poison_data_count: 385
Global model norm: 45.380288732760945.
Norm before scaling: 45.365712289817516. Distance: 2.0070023739149256
Total norm for 4 adversaries is: 45.365712289817516. distance: 2.0070023739149256
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0480, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4799/5305 (90.4618%), train_poison_data_count: 415
Global model norm: 45.380288732760945.
Norm before scaling: 45.36764155640697. Distance: 2.150640738179391
Total norm for 4 adversaries is: 45.36764155640697. distance: 2.150640738179391
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0777, Accuracy: 9727/9900 (98.2525%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 45.380288732760945.
Norm before scaling: 45.366204704569185. Distance: 1.9920794289391155
Total norm for 4 adversaries is: 45.366204704569185. distance: 1.9920794289391155
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1376, Accuracy: 9564/9900 (96.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4591/5066 (90.6238%), train_poison_data_count: 400
Global model norm: 45.380288732760945.
Norm before scaling: 45.37072767421193. Distance: 2.1487758300719997
Total norm for 4 adversaries is: 45.37072767421193. distance: 2.1487758300719997
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.1397, Accuracy: 9554/9900 (96.5051%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4597/5083 (90.4387%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4567/5083 (89.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1483, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3284/3646 (90.0713%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3352/3646 (91.9364%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7897, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4075/4503 (90.4952%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4130/4503 (91.7166%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8922, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4026/4501 (89.4468%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4094/4501 (90.9576%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9152, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3671/4013 (91.4777%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3708/4013 (92.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8221, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4046/4362 (92.7556%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3936/4362 (90.2338%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0193, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3954/4315 (91.6338%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4033/4315 (93.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8144, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4189/4651 (90.0667%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4230/4651 (90.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9948, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3891/4416 (88.1114%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4020/4416 (91.0326%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0578, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3269/3704 (88.2559%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3416/3704 (92.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7819, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4229/4707 (89.8449%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4283/4707 (90.9921%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8520, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4178/4662 (89.6182%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4310/4662 (92.4496%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0123, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4924/5424 (90.7817%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5000/5424 (92.1829%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2838, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3914/4336 (90.2675%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4033/4336 (93.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9681, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4131/4481 (92.1892%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4137/4481 (92.3231%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8766, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3437/3828 (89.7858%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3554/3828 (92.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7878, Accuracy: 5845/10000 (58.4500%)
time spent on training: 231.05694007873535
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4760, Accuracy: 5058/10000 (50.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 7.4160, Accuracy: 498/9900 (5.0303%)
Done in 254.3955466747284 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4472/4885 (91.5455%), train_poison_data_count: 385
Global model norm: 45.4113791838015.
Norm before scaling: 45.39381174269517. Distance: 2.01571595925608
Total norm for 4 adversaries is: 45.39381174269517. distance: 2.01571595925608
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0468, Accuracy: 9786/9900 (98.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 45.4113791838015.
Norm before scaling: 45.400085072710766. Distance: 2.1917741708050364
Total norm for 4 adversaries is: 45.400085072710766. distance: 2.1917741708050364
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0814, Accuracy: 9716/9900 (98.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4292/4717 (90.9900%), train_poison_data_count: 370
Global model norm: 45.4113791838015.
Norm before scaling: 45.398270117786424. Distance: 2.030306435555855
Total norm for 4 adversaries is: 45.398270117786424. distance: 2.030306435555855
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1373, Accuracy: 9556/9900 (96.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4565/5066 (90.1105%), train_poison_data_count: 400
Global model norm: 45.4113791838015.
Norm before scaling: 45.40121971878206. Distance: 2.2135906139272667
Total norm for 4 adversaries is: 45.40121971878206. distance: 2.2135906139272667
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.1302, Accuracy: 9596/9900 (96.9293%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3730/4184 (89.1491%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3834/4184 (91.6348%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9049, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4446/5037 (88.2668%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4600/5037 (91.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8910, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3664/4158 (88.1193%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3771/4158 (90.6926%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8570, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2941/3271 (89.9113%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2954/3271 (90.3088%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7835, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4433/4918 (90.1383%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4568/4918 (92.8833%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0860, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5514/5902 (93.4260%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5370/5902 (90.9861%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0234, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4234/4354 (97.2439%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3855/4354 (88.5393%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2031, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3628/3969 (91.4084%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3619/3969 (91.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0138, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4023/4356 (92.3554%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4003/4356 (91.8962%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0905, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3879/4295 (90.3143%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3832/4295 (89.2200%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9987, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3709/4126 (89.8934%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3790/4126 (91.8565%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8413, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4421/4928 (89.7119%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4530/4928 (91.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8282, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4048/4511 (89.7362%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4155/4511 (92.1082%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8844, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4199/4618 (90.9268%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4231/4618 (91.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0277, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3298/3704 (89.0389%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3406/3704 (91.9546%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8322, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3214/3616 (88.8827%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3335/3616 (92.2290%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8928, Accuracy: 5881/10000 (58.8100%)
time spent on training: 229.01870965957642
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5522, Accuracy: 4957/10000 (49.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 8.6324, Accuracy: 215/9900 (2.1717%)
Done in 252.83492636680603 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 45.44117774404208.
Norm before scaling: 45.42719320861129. Distance: 1.9930293679224516
Total norm for 4 adversaries is: 45.42719320861129. distance: 1.9930293679224516
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2189, Accuracy: 9360/9900 (94.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 45.44117774404208.
Norm before scaling: 45.42986148397467. Distance: 2.1509726253879795
Total norm for 4 adversaries is: 45.42986148397467. distance: 2.1509726253879795
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1312, Accuracy: 9577/9900 (96.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4273/4717 (90.5872%), train_poison_data_count: 370
Global model norm: 45.44117774404208.
Norm before scaling: 45.42930258327905. Distance: 2.039081441857063
Total norm for 4 adversaries is: 45.42930258327905. distance: 2.039081441857063
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.1303, Accuracy: 9577/9900 (96.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4570/5066 (90.2092%), train_poison_data_count: 400
Global model norm: 45.44117774404208.
Norm before scaling: 45.43434587573866. Distance: 2.2208187505972092
Total norm for 4 adversaries is: 45.43434587573866. distance: 2.2208187505972092
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.2347, Accuracy: 9324/9900 (94.1818%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2928/3271 (89.5139%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3027/3271 (92.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8651, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4041/4456 (90.6867%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4186/4456 (93.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8611, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3670/4013 (91.4528%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3766/4013 (93.8450%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.6887, Accuracy: 6007/10000 (60.0700%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3391/3781 (89.6853%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3477/3781 (91.9598%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0405, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3415/3775 (90.4636%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3582/3775 (94.8874%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7777, Accuracy: 5935/10000 (59.3500%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4598/5232 (87.8823%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4705/5232 (89.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0250, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4401/4989 (88.2141%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4462/4989 (89.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0928, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3228/3646 (88.5354%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3370/3646 (92.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8119, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3938/4315 (91.2630%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3988/4315 (92.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7987, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4429/4918 (90.0569%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4506/4918 (91.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2238, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3913/4416 (88.6096%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4016/4416 (90.9420%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8324, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5646/6263 (90.1485%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5773/6263 (92.1763%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0017, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5463/6124 (89.2064%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5514/6124 (90.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9969, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4204/4651 (90.3892%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4281/4651 (92.0447%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9080, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4112/4356 (94.3985%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4074/4356 (93.5262%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9581, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4036/4356 (92.6538%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3851/4356 (88.4068%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1514, Accuracy: 5210/10000 (52.1000%)
time spent on training: 231.28344798088074
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4542, Accuracy: 4956/10000 (49.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 8.5297, Accuracy: 185/9900 (1.8687%)
Done in 255.83149027824402 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 45.46494292481021.
Norm before scaling: 45.44907757417911. Distance: 2.0681868094842306
Total norm for 4 adversaries is: 45.44907757417911. distance: 2.0681868094842306
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1771, Accuracy: 9445/9900 (95.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4812/5305 (90.7069%), train_poison_data_count: 415
Global model norm: 45.46494292481021.
Norm before scaling: 45.451819764690114. Distance: 2.1823966305298397
Total norm for 4 adversaries is: 45.451819764690114. distance: 2.1823966305298397
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1059, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4298/4717 (91.1172%), train_poison_data_count: 370
Global model norm: 45.46494292481021.
Norm before scaling: 45.449509997186716. Distance: 1.9728100405127393
Total norm for 4 adversaries is: 45.449509997186716. distance: 1.9728100405127393
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1805, Accuracy: 9455/9900 (95.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4593/5066 (90.6632%), train_poison_data_count: 400
Global model norm: 45.46494292481021.
Norm before scaling: 45.45516334807301. Distance: 2.1421702578328596
Total norm for 4 adversaries is: 45.45516334807301. distance: 2.1421702578328596
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1516, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4131/4716 (87.5954%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4270/4716 (90.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0426, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4153/4634 (89.6202%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4190/4634 (90.4186%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9293, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3452/3828 (90.1776%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3554/3828 (92.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9112, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4390/4989 (87.9936%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4495/4989 (90.0982%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0339, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4541/5116 (88.7608%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4638/5116 (90.6568%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9967, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3983/4362 (91.3113%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4011/4362 (91.9532%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9555, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4523/5017 (90.1535%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4573/5017 (91.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8767, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4265/4354 (97.9559%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3979/4354 (91.3872%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2232, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3205/3638 (88.0979%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3345/3638 (91.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8318, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4724/5195 (90.9336%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4714/5195 (90.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9112, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4137/4596 (90.0131%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4295/4596 (93.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9394, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4360/4928 (88.4740%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0424, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4621/5244 (88.1198%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4685/5244 (89.3402%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9897, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5465/5902 (92.5957%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5362/5902 (90.8506%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0668, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4512/5025 (89.7910%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4631/5025 (92.1592%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9250, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5513/6124 (90.0229%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5548/6124 (90.5944%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0138, Accuracy: 5551/10000 (55.5100%)
time spent on training: 236.8338143825531
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.8704, Accuracy: 4385/10000 (43.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 8.4354, Accuracy: 231/9900 (2.3333%)
Done in 260.03109526634216 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4417/4885 (90.4197%), train_poison_data_count: 385
Global model norm: 45.4921734125429.
Norm before scaling: 45.48453065930081. Distance: 2.1682667570378173
Total norm for 4 adversaries is: 45.48453065930081. distance: 2.1682667570378173
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0544, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 45.4921734125429.
Norm before scaling: 45.48117581500752. Distance: 2.191711186970926
Total norm for 4 adversaries is: 45.48117581500752. distance: 2.191711186970926
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.2362, Accuracy: 9319/9900 (94.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 45.4921734125429.
Norm before scaling: 45.480088792377046. Distance: 2.0571183014910313
Total norm for 4 adversaries is: 45.480088792377046. distance: 2.0571183014910313
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0846, Accuracy: 9689/9900 (97.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4562/5066 (90.0513%), train_poison_data_count: 400
Global model norm: 45.4921734125429.
Norm before scaling: 45.48409320163479. Distance: 2.2057628666548847
Total norm for 4 adversaries is: 45.48409320163479. distance: 2.2057628666548847
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0611, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4550/5116 (88.9367%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4637/5116 (90.6372%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0087, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4671/5197 (89.8788%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4735/5197 (91.1103%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1114, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4169/4356 (95.7071%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3947/4356 (90.6107%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9622, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4328/4679 (92.4984%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4206/4679 (89.8910%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1068, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4145/4647 (89.1973%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4260/4647 (91.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8716, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3526/3911 (90.1560%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3504/3911 (89.5935%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1746, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3951/4315 (91.5643%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3976/4315 (92.1437%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8608, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3212/3646 (88.0965%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3349/3646 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8987, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4166/4634 (89.9007%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4223/4634 (91.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0143, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4517/5055 (89.3571%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4668/5055 (92.3442%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8414, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3982/4362 (91.2884%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4042/4362 (92.6639%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8908, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4527/4934 (91.7511%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4395/4934 (89.0758%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1050, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4252/4767 (89.1966%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4343/4767 (91.1055%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2031, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3984/4433 (89.8714%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4086/4433 (92.1723%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8530, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4286/4928 (86.9724%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4477/4928 (90.8482%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0092, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3401/3837 (88.6370%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3540/3837 (92.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0498, Accuracy: 5505/10000 (55.0500%)
time spent on training: 232.77629494667053
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.8141, Accuracy: 4469/10000 (44.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 8.7438, Accuracy: 170/9900 (1.7172%)
Done in 256.0678610801697 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4449/4885 (91.0747%), train_poison_data_count: 385
Global model norm: 45.52491430267195.
Norm before scaling: 45.51177356688184. Distance: 2.094864733569479
Total norm for 4 adversaries is: 45.51177356688184. distance: 2.094864733569479
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1208, Accuracy: 9597/9900 (96.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4751/5305 (89.5570%), train_poison_data_count: 415
Global model norm: 45.52491430267195.
Norm before scaling: 45.51781609470351. Distance: 2.280957242391859
Total norm for 4 adversaries is: 45.51781609470351. distance: 2.280957242391859
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1645, Accuracy: 9466/9900 (95.6162%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4276/4717 (90.6508%), train_poison_data_count: 370
Global model norm: 45.52491430267195.
Norm before scaling: 45.51354376463807. Distance: 2.0771319088728837
Total norm for 4 adversaries is: 45.51354376463807. distance: 2.0771319088728837
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1388, Accuracy: 9564/9900 (96.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4542/5066 (89.6565%), train_poison_data_count: 400
Global model norm: 45.52491430267195.
Norm before scaling: 45.52396239722274. Distance: 2.286980837916406
Total norm for 4 adversaries is: 45.52396239722274. distance: 2.286980837916406
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.1161, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4450/4986 (89.2499%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4481/4986 (89.8716%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8387, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4240/4767 (88.9448%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4314/4767 (90.4972%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9402, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3917/4315 (90.7764%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4021/4315 (93.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8420, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3320/3672 (90.4139%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3397/3672 (92.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8735, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4042/4558 (88.6792%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4037/4558 (88.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2343, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3417/3828 (89.2633%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3567/3828 (93.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8728, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4345/4679 (92.8617%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4247/4679 (90.7673%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9739, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4354/4956 (87.8531%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4436/4956 (89.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0061, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4144/4356 (95.1331%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4126/4356 (94.7199%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8819, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4093/4538 (90.1939%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4191/4538 (92.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9241, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3634/4013 (90.5557%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3768/4013 (93.8948%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7413, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4717/5265 (89.5916%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4739/5265 (90.0095%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9601, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4213/4663 (90.3496%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4330/4663 (92.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9401, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5649/6263 (90.1964%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5732/6263 (91.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0228, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4730/5063 (93.4229%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4533/5063 (89.5319%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1055, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3887/4416 (88.0208%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4043/4416 (91.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9322, Accuracy: 5658/10000 (56.5800%)
time spent on training: 231.20607805252075
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.7560, Accuracy: 4589/10000 (45.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 8.8804, Accuracy: 198/9900 (2.0000%)
Done in 254.63190245628357 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4431/4885 (90.7062%), train_poison_data_count: 385
Global model norm: 45.556594696185314.
Norm before scaling: 45.5454089601109. Distance: 2.089396263057726
Total norm for 4 adversaries is: 45.5454089601109. distance: 2.089396263057726
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1978, Accuracy: 9447/9900 (95.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4800/5305 (90.4807%), train_poison_data_count: 415
Global model norm: 45.556594696185314.
Norm before scaling: 45.5458404685255. Distance: 2.222160082848977
Total norm for 4 adversaries is: 45.5458404685255. distance: 2.222160082848977
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0398, Accuracy: 9810/9900 (99.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4310/4717 (91.3716%), train_poison_data_count: 370
Global model norm: 45.556594696185314.
Norm before scaling: 45.54244189403852. Distance: 2.013507529211259
Total norm for 4 adversaries is: 45.54244189403852. distance: 2.013507529211259
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1228, Accuracy: 9611/9900 (97.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4579/5066 (90.3869%), train_poison_data_count: 400
Global model norm: 45.556594696185314.
Norm before scaling: 45.546180848055194. Distance: 2.174732441723514
Total norm for 4 adversaries is: 45.546180848055194. distance: 2.174732441723514
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.2578, Accuracy: 9259/9900 (93.5253%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5058/5740 (88.1185%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5203/5740 (90.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0672, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4150/4651 (89.2281%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4297/4651 (92.3887%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9756, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4067/4503 (90.3176%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4059/4503 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8845, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4234/4767 (88.8190%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4295/4767 (90.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1666, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4965/5591 (88.8034%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4971/5591 (88.9107%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1376, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3961/4465 (88.7122%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4154/4465 (93.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8079, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4338/4956 (87.5303%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4441/4956 (89.6086%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0467, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3273/3704 (88.3639%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3390/3704 (91.5227%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8788, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3629/4025 (90.1615%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3770/4025 (93.6646%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8499, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4667/5083 (91.8159%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4699/5083 (92.4454%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0704, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5487/6124 (89.5983%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5544/6124 (90.5291%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8537, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3854/4295 (89.7322%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3904/4295 (90.8964%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8938, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4484/4804 (93.3389%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4410/4804 (91.7985%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1145, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4278/4793 (89.2552%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4397/4793 (91.7380%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0139, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3995/4433 (90.1196%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4110/4433 (92.7137%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8146, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3981/4361 (91.2864%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3959/4361 (90.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9068, Accuracy: 5700/10000 (57.0000%)
time spent on training: 235.42067074775696
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 3.0116, Accuracy: 4267/10000 (42.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 9.1475, Accuracy: 138/9900 (1.3939%)
Done in 258.97016310691833 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4453/4885 (91.1566%), train_poison_data_count: 385
Global model norm: 45.58355619851445.
Norm before scaling: 45.57333600997545. Distance: 2.12904612230446
Total norm for 4 adversaries is: 45.57333600997545. distance: 2.12904612230446
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0513, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4784/5305 (90.1791%), train_poison_data_count: 415
Global model norm: 45.58355619851445.
Norm before scaling: 45.57151456176462. Distance: 2.242156769545236
Total norm for 4 adversaries is: 45.57151456176462. distance: 2.242156769545236
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1766, Accuracy: 9453/9900 (95.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 45.58355619851445.
Norm before scaling: 45.57145830999925. Distance: 2.0332232940582244
Total norm for 4 adversaries is: 45.57145830999925. distance: 2.0332232940582244
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.2598, Accuracy: 9274/9900 (93.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 45.58355619851445.
Norm before scaling: 45.5768179877734. Distance: 2.245911910947769
Total norm for 4 adversaries is: 45.5768179877734. distance: 2.245911910947769
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.1253, Accuracy: 9567/9900 (96.6364%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4079/4558 (89.4910%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4113/4558 (90.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0852, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4171/4596 (90.7528%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4261/4596 (92.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8480, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4437/4874 (91.0341%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4396/4874 (90.1929%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1434, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3636/4158 (87.4459%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3729/4158 (89.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9996, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4865/5455 (89.1842%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4983/5455 (91.3474%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9520, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3937/4346 (90.5890%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4055/4346 (93.3042%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9318, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4339/4679 (92.7335%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4408/4679 (94.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8517, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3934/4416 (89.0851%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4007/4416 (90.7382%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9251, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3393/3828 (88.6364%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3568/3828 (93.2079%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8161, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3776/4223 (89.4151%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3881/4223 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0942, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4670/5265 (88.6990%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4728/5265 (89.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0457, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5444/6124 (88.8961%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5511/6124 (89.9902%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9648, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3977/4361 (91.1947%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3993/4361 (91.5616%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9503, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4352/4956 (87.8128%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4404/4956 (88.8620%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0563, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5102/5740 (88.8850%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5138/5740 (89.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1607, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3600/4013 (89.7084%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3689/4013 (91.9262%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8312, Accuracy: 5763/10000 (57.6300%)
time spent on training: 234.2283456325531
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.8482, Accuracy: 4463/10000 (44.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 9.0621, Accuracy: 145/9900 (1.4646%)
Done in 258.04719281196594 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4455/4885 (91.1975%), train_poison_data_count: 385
Global model norm: 45.62023733703607.
Norm before scaling: 45.60652183607488. Distance: 2.060514476937245
Total norm for 4 adversaries is: 45.60652183607488. distance: 2.060514476937245
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.1496, Accuracy: 9525/9900 (96.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4815/5305 (90.7634%), train_poison_data_count: 415
Global model norm: 45.62023733703607.
Norm before scaling: 45.60686443929658. Distance: 2.185183797477861
Total norm for 4 adversaries is: 45.60686443929658. distance: 2.185183797477861
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2793, Accuracy: 9243/9900 (93.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4318/4717 (91.5412%), train_poison_data_count: 370
Global model norm: 45.62023733703607.
Norm before scaling: 45.60192856307587. Distance: 1.9903303877532343
Total norm for 4 adversaries is: 45.60192856307587. distance: 1.9903303877532343
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0477, Accuracy: 9780/9900 (98.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4550/5066 (89.8144%), train_poison_data_count: 400
Global model norm: 45.62023733703607.
Norm before scaling: 45.60802873569795. Distance: 2.1901102024377725
Total norm for 4 adversaries is: 45.60802873569795. distance: 2.1901102024377725
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.2286, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3741/4184 (89.4120%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3853/4184 (92.0889%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8157, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3296/3590 (91.8106%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3590 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9589, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3590/4158 (86.3396%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3658/4158 (87.9750%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9098, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3654/4025 (90.7826%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3747/4025 (93.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8859, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3651/4046 (90.2373%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3673/4046 (90.7810%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8027, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4484/5025 (89.2338%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4613/5025 (91.8010%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0258, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4822/5063 (95.2400%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4843/5063 (95.6548%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8535, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4069/4356 (93.4114%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4144/4356 (95.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9543, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4154/4651 (89.3141%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4291/4651 (92.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9803, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4147/4356 (95.2020%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3928/4356 (90.1745%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0180, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4069/4576 (88.9205%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4217/4576 (92.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9317, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4059/4456 (91.0907%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4140/4456 (92.9084%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9023, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2943/3297 (89.2630%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3068/3297 (93.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7348, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4586/4804 (95.4621%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4471/4804 (93.0683%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9906, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3560/3969 (89.6951%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3586/3969 (90.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8464, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4669/5195 (89.8749%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4704/5195 (90.5486%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0644, Accuracy: 5438/10000 (54.3800%)
time spent on training: 228.51781392097473
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.9486, Accuracy: 4366/10000 (43.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 8.9461, Accuracy: 157/9900 (1.5859%)
Done in 251.59128546714783 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4458/4885 (91.2590%), train_poison_data_count: 385
Global model norm: 45.64653012979875.
Norm before scaling: 45.63296430915512. Distance: 2.0725451828249906
Total norm for 4 adversaries is: 45.63296430915512. distance: 2.0725451828249906
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1849, Accuracy: 9446/9900 (95.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4809/5305 (90.6503%), train_poison_data_count: 415
Global model norm: 45.64653012979875.
Norm before scaling: 45.63613145459007. Distance: 2.2439697838039177
Total norm for 4 adversaries is: 45.63613145459007. distance: 2.2439697838039177
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1276, Accuracy: 9566/9900 (96.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 45.64653012979875.
Norm before scaling: 45.63121211989936. Distance: 2.008969815754227
Total norm for 4 adversaries is: 45.63121211989936. distance: 2.008969815754227
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1132, Accuracy: 9611/9900 (97.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 45.64653012979875.
Norm before scaling: 45.63415201445213. Distance: 2.220819609446345
Total norm for 4 adversaries is: 45.63415201445213. distance: 2.220819609446345
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.1755, Accuracy: 9468/9900 (95.6364%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3415/3837 (89.0018%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3584/3837 (93.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8623, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5028/5582 (90.0752%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5103/5582 (91.4188%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0017, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4879/5455 (89.4409%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4984/5455 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9719, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4323/4679 (92.3915%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4305/4679 (92.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0222, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4080/4518 (90.3054%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4205/4518 (93.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9909, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4156/4618 (89.9957%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4257/4618 (92.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9508, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4167/4716 (88.3588%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4209/4716 (89.2494%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0285, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4556/5244 (86.8802%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4660/5244 (88.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0243, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4454/4874 (91.3828%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4368/4874 (89.6184%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1960, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4379/4928 (88.8596%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4454/4928 (90.3815%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9858, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3716/4126 (90.0630%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3855/4126 (93.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8761, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3382/3828 (88.3490%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3525/3828 (92.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9860, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3121/3472 (89.8906%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3221/3472 (92.7707%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9590, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3226/3638 (88.6751%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8045, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3290/3590 (91.6435%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3244/3590 (90.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0343, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3767/4223 (89.2020%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3840/4223 (90.9306%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0432, Accuracy: 5423/10000 (54.2300%)
time spent on training: 228.25229167938232
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.7462, Accuracy: 4570/10000 (45.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 9.5029, Accuracy: 101/9900 (1.0202%)
Done in 251.82140946388245 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 45.66772667612901.
Norm before scaling: 45.65436501498926. Distance: 2.057355301915027
Total norm for 4 adversaries is: 45.65436501498926. distance: 2.057355301915027
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1921, Accuracy: 9409/9900 (95.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4830/5305 (91.0462%), train_poison_data_count: 415
Global model norm: 45.66772667612901.
Norm before scaling: 45.658169663612775. Distance: 2.1902191700415243
Total norm for 4 adversaries is: 45.658169663612775. distance: 2.1902191700415243
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1609, Accuracy: 9500/9900 (95.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 45.66772667612901.
Norm before scaling: 45.65354682706071. Distance: 2.0076525435204546
Total norm for 4 adversaries is: 45.65354682706071. distance: 2.0076525435204546
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1759, Accuracy: 9457/9900 (95.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4573/5066 (90.2685%), train_poison_data_count: 400
Global model norm: 45.66772667612901.
Norm before scaling: 45.65894499232872. Distance: 2.2432432447183177
Total norm for 4 adversaries is: 45.65894499232872. distance: 2.2432432447183177
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.1022, Accuracy: 9646/9900 (97.4343%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4027/4441 (90.6778%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4146/4441 (93.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9638, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4475/5017 (89.1967%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4652/5017 (92.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8164, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4408/4918 (89.6299%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4529/4918 (92.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9861, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4718/5197 (90.7831%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4805/5197 (92.4572%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9450, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4217/4356 (96.8090%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4053/4356 (93.0441%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8513, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4909/5455 (89.9908%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4955/5455 (90.8341%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9739, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2970/3297 (90.0819%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3061/3297 (92.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8427, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4646/5195 (89.4321%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4763/5195 (91.6843%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9530, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3431/3828 (89.6290%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3531/3828 (92.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7862, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4063/4456 (91.1804%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4137/4456 (92.8411%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8394, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3971/4361 (91.0571%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3915/4361 (89.7730%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2964, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3797/4235 (89.6576%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3887/4235 (91.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9171, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4477/5025 (89.0945%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0910, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3240/3646 (88.8645%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3393/3646 (93.0609%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7415, Accuracy: 5942/10000 (59.4200%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3618/4158 (87.0130%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3723/4158 (89.5382%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8513, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4098/4538 (90.3041%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4260/4538 (93.8740%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7493, Accuracy: 5863/10000 (58.6300%)
time spent on training: 235.7948727607727
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.6922, Accuracy: 4623/10000 (46.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 9.5464, Accuracy: 87/9900 (0.8788%)
Done in 259.20298767089844 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4470/4885 (91.5046%), train_poison_data_count: 385
Global model norm: 45.69679977597583.
Norm before scaling: 45.681386389863434. Distance: 2.050860071029914
Total norm for 4 adversaries is: 45.681386389863434. distance: 2.050860071029914
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1563, Accuracy: 9535/9900 (96.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 45.69679977597583.
Norm before scaling: 45.68611863079282. Distance: 2.203422580398517
Total norm for 4 adversaries is: 45.68611863079282. distance: 2.203422580398517
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2027, Accuracy: 9408/9900 (95.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4279/4717 (90.7144%), train_poison_data_count: 370
Global model norm: 45.69679977597583.
Norm before scaling: 45.683802004922924. Distance: 2.0727607502279533
Total norm for 4 adversaries is: 45.683802004922924. distance: 2.0727607502279533
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.1060, Accuracy: 9637/9900 (97.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4579/5066 (90.3869%), train_poison_data_count: 400
Global model norm: 45.69679977597583.
Norm before scaling: 45.68821070753647. Distance: 2.2426903988099984
Total norm for 4 adversaries is: 45.68821070753647. distance: 2.2426903988099984
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.2004, Accuracy: 9371/9900 (94.6566%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3886/4295 (90.4773%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3815/4295 (88.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0702, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5077/5582 (90.9531%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5088/5582 (91.1501%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1575, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3293/3672 (89.6786%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3405/3672 (92.7288%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9688, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4117/4518 (91.1244%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4177/4518 (92.4524%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9992, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3419/3797 (90.0448%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3493/3797 (91.9937%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9036, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4003/4362 (91.7698%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3940/4362 (90.3255%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0772, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4567/4804 (95.0666%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4221/4804 (87.8643%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1108, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4540/5116 (88.7412%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4659/5116 (91.0672%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8646, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4473/5025 (89.0149%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4569/5025 (90.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1423, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2935/3297 (89.0203%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3094/3297 (93.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8168, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3300/3704 (89.0929%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3416/3704 (92.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8670, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4924/5424 (90.7817%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4998/5424 (92.1460%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2564, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3463/3861 (89.6918%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3549/3861 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8948, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4457/4874 (91.4444%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4538/4874 (93.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9937, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4166/4647 (89.6492%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4312/4647 (92.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8656, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4041/4356 (92.7686%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3868/4356 (88.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3207, Accuracy: 5080/10000 (50.8000%)
time spent on training: 231.11797642707825
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.6866, Accuracy: 4642/10000 (46.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 9.1479, Accuracy: 160/9900 (1.6162%)
Done in 254.51533889770508 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 45.72275753539615.
Norm before scaling: 45.70882176034239. Distance: 2.064981874658874
Total norm for 4 adversaries is: 45.70882176034239. distance: 2.064981874658874
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2308, Accuracy: 9347/9900 (94.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 45.72275753539615.
Norm before scaling: 45.71104365160295. Distance: 2.1662264034264975
Total norm for 4 adversaries is: 45.71104365160295. distance: 2.1662264034264975
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.3014, Accuracy: 9202/9900 (92.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4305/4717 (91.2656%), train_poison_data_count: 370
Global model norm: 45.72275753539615.
Norm before scaling: 45.70691490696457. Distance: 2.0024099135881577
Total norm for 4 adversaries is: 45.70691490696457. distance: 2.0024099135881577
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1794, Accuracy: 9457/9900 (95.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4551/5066 (89.8342%), train_poison_data_count: 400
Global model norm: 45.72275753539615.
Norm before scaling: 45.71215455673414. Distance: 2.242388247764186
Total norm for 4 adversaries is: 45.71215455673414. distance: 2.242388247764186
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.2627, Accuracy: 9272/9900 (93.6566%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4058/4503 (90.1177%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4087/4503 (90.7617%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9027, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3469/3861 (89.8472%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3574/3861 (92.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9186, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3767/4184 (90.0335%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3856/4184 (92.1606%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9095, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4094/4518 (90.6153%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4187/4518 (92.6737%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9319, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4683/5083 (92.1306%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4726/5083 (92.9766%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8680, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4582/4804 (95.3789%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4166/4804 (86.7194%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1674, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4120/4356 (94.5822%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3897/4356 (89.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3672, Accuracy: 4907/10000 (49.0700%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4592/5244 (87.5667%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4587/5244 (87.4714%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0274, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4349/4679 (92.9472%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4216/4679 (90.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2314, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3898/4416 (88.2699%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4010/4416 (90.8062%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9326, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4384/4918 (89.1419%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4521/4918 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1865, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3206/3616 (88.6615%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3336/3616 (92.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8062, Accuracy: 5936/10000 (59.3600%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4079/4576 (89.1390%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4251/4576 (92.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8585, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4398/4928 (89.2451%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4532/4928 (91.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8994, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3672/4013 (91.5026%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3767/4013 (93.8699%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7399, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3911/4336 (90.1983%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3997/4336 (92.1817%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9964, Accuracy: 5554/10000 (55.5400%)
time spent on training: 255.39932942390442
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.7412, Accuracy: 4668/10000 (46.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 9.2349, Accuracy: 154/9900 (1.5556%)
Done in 281.95743584632874 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4454/4885 (91.1771%), train_poison_data_count: 385
Global model norm: 45.756894118536934.
Norm before scaling: 45.74498350229236. Distance: 2.09987473341307
Total norm for 4 adversaries is: 45.74498350229236. distance: 2.09987473341307
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0588, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 45.756894118536934.
Norm before scaling: 45.745509193013966. Distance: 2.2139075721049166
Total norm for 4 adversaries is: 45.745509193013966. distance: 2.2139075721049166
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.1445, Accuracy: 9575/9900 (96.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4269/4717 (90.5024%), train_poison_data_count: 370
Global model norm: 45.756894118536934.
Norm before scaling: 45.74534107937933. Distance: 2.091925438101038
Total norm for 4 adversaries is: 45.74534107937933. distance: 2.091925438101038
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0822, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4526/5066 (89.3407%), train_poison_data_count: 400
Global model norm: 45.756894118536934.
Norm before scaling: 45.75055231480135. Distance: 2.2896682927130554
Total norm for 4 adversaries is: 45.75055231480135. distance: 2.2896682927130554
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0930, Accuracy: 9665/9900 (97.6263%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5694/6263 (90.9149%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5786/6263 (92.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9226, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3152/3472 (90.7834%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3182/3472 (91.6475%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9831, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3650/4158 (87.7826%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3791/4158 (91.1736%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8485, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3200/3638 (87.9604%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9634, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4460/4874 (91.5059%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4371/4874 (89.6799%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2038, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4184/4356 (96.0514%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4026/4356 (92.4242%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8573, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4075/4538 (89.7973%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4208/4538 (92.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8467, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4403/4928 (89.3466%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4516/4928 (91.6396%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8619, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4180/4618 (90.5154%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4279/4618 (92.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9753, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4216/4707 (89.5687%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4288/4707 (91.0984%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0052, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4345/4679 (92.8617%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4356/4679 (93.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0076, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4131/4647 (88.8961%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4303/4647 (92.5974%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8806, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4132/4576 (90.2972%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4246/4576 (92.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9183, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3641/4046 (89.9901%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3707/4046 (91.6214%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9460, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4165/4651 (89.5506%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4285/4651 (92.1307%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0570, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4520/5055 (89.4164%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4628/5055 (91.5529%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9462, Accuracy: 5696/10000 (56.9600%)
time spent on training: 235.8202621936798
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.6270, Accuracy: 4832/10000 (48.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 9.4980, Accuracy: 128/9900 (1.2929%)
Done in 259.2031202316284 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4434/4885 (90.7677%), train_poison_data_count: 385
Global model norm: 45.78486280540081.
Norm before scaling: 45.7727541178292. Distance: 2.119170439198394
Total norm for 4 adversaries is: 45.7727541178292. distance: 2.119170439198394
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.4123, Accuracy: 8943/9900 (90.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4792/5305 (90.3299%), train_poison_data_count: 415
Global model norm: 45.78486280540081.
Norm before scaling: 45.774716897335914. Distance: 2.249296502229941
Total norm for 4 adversaries is: 45.774716897335914. distance: 2.249296502229941
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1088, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4314/4717 (91.4564%), train_poison_data_count: 370
Global model norm: 45.78486280540081.
Norm before scaling: 45.77125797529084. Distance: 2.0066025944024872
Total norm for 4 adversaries is: 45.77125797529084. distance: 2.0066025944024872
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.1991, Accuracy: 9431/9900 (95.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4524/5066 (89.3012%), train_poison_data_count: 400
Global model norm: 45.78486280540081.
Norm before scaling: 45.776287593680806. Distance: 2.2693059024781603
Total norm for 4 adversaries is: 45.776287593680806. distance: 2.2693059024781603
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0694, Accuracy: 9720/9900 (98.1818%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5165/5740 (89.9826%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5224/5740 (91.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9524, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3709/4175 (88.8383%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3772/4175 (90.3473%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9220, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4379/4918 (89.0403%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4547/4918 (92.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0600, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3872/4235 (91.4286%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3874/4235 (91.4758%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9283, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4917/5455 (90.1375%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4967/5455 (91.0541%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9712, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4184/4662 (89.7469%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4284/4662 (91.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9430, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4053/4465 (90.7727%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4155/4465 (93.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8608, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4180/4651 (89.8731%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4221/4651 (90.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1306, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4178/4618 (90.4721%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4299/4618 (93.0922%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8780, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4467/5037 (88.6837%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4621/5037 (91.7411%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9202, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4233/4354 (97.2209%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4108/4354 (94.3500%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1054, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4039/4441 (90.9480%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4089/4441 (92.0739%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9699, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4104/4538 (90.4363%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4230/4538 (93.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8009, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4536/5116 (88.6630%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4614/5116 (90.1876%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9000, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5549/6124 (90.6107%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5575/6124 (91.0353%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8911, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3987/4362 (91.4030%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4018/4362 (92.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9969, Accuracy: 5554/10000 (55.5400%)
time spent on training: 236.49448800086975
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.8442, Accuracy: 4544/10000 (45.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 9.4269, Accuracy: 126/9900 (1.2727%)
Done in 259.97785902023315 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4430/4885 (90.6858%), train_poison_data_count: 385
Global model norm: 45.80656030304912.
Norm before scaling: 45.795275688553566. Distance: 2.1366160924265305
Total norm for 4 adversaries is: 45.795275688553566. distance: 2.1366160924265305
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1804, Accuracy: 9442/9900 (95.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4801/5305 (90.4995%), train_poison_data_count: 415
Global model norm: 45.80656030304912.
Norm before scaling: 45.79581946071197. Distance: 2.240385494439805
Total norm for 4 adversaries is: 45.79581946071197. distance: 2.240385494439805
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1079, Accuracy: 9614/9900 (97.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 45.80656030304912.
Norm before scaling: 45.79201825151273. Distance: 2.027494627055282
Total norm for 4 adversaries is: 45.79201825151273. distance: 2.027494627055282
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.1506, Accuracy: 9532/9900 (96.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4575/5066 (90.3079%), train_poison_data_count: 400
Global model norm: 45.80656030304912.
Norm before scaling: 45.79520638379496. Distance: 2.2089933332806306
Total norm for 4 adversaries is: 45.79520638379496. distance: 2.2089933332806306
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.3455, Accuracy: 9033/9900 (91.2424%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4016/4361 (92.0890%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3894/4361 (89.2914%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0244, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3381/3797 (89.0440%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9224, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4387/4918 (89.2029%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4483/4918 (91.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0964, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3231/3638 (88.8125%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3335/3638 (91.6712%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8115, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3348/3590 (93.2591%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3393/3590 (94.5125%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8891, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4455/4986 (89.3502%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4547/4986 (91.1953%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9057, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4867/5392 (90.2634%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4994/5392 (92.6187%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9892, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3395/3804 (89.2482%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3519/3804 (92.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8965, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4418/5025 (87.9204%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4609/5025 (91.7214%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1979, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4235/4793 (88.3580%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4365/4793 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0862, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4359/4956 (87.9540%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4421/4956 (89.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0631, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4503/5116 (88.0180%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4579/5116 (89.5035%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8982, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4562/5055 (90.2473%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4652/5055 (92.0277%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8815, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4755/5063 (93.9167%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4617/5063 (91.1910%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0977, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4009/4433 (90.4354%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4061/4433 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8463, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4154/4662 (89.1034%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4278/4662 (91.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9636, Accuracy: 5686/10000 (56.8600%)
time spent on training: 231.142760515213
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.8649, Accuracy: 4518/10000 (45.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 9.6284, Accuracy: 113/9900 (1.1414%)
Done in 254.47184991836548 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4452/4885 (91.1361%), train_poison_data_count: 385
Global model norm: 45.832463888533745.
Norm before scaling: 45.821944903786274. Distance: 2.1440215625532684
Total norm for 4 adversaries is: 45.821944903786274. distance: 2.1440215625532684
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.2429, Accuracy: 9332/9900 (94.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4797/5305 (90.4241%), train_poison_data_count: 415
Global model norm: 45.832463888533745.
Norm before scaling: 45.81965379428488. Distance: 2.2327277240182264
Total norm for 4 adversaries is: 45.81965379428488. distance: 2.2327277240182264
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1103, Accuracy: 9634/9900 (97.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4286/4717 (90.8628%), train_poison_data_count: 370
Global model norm: 45.832463888533745.
Norm before scaling: 45.816715145443915. Distance: 2.036377055569811
Total norm for 4 adversaries is: 45.816715145443915. distance: 2.036377055569811
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1681, Accuracy: 9478/9900 (95.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 45.832463888533745.
Norm before scaling: 45.82503239224169. Distance: 2.2678038544718055
Total norm for 4 adversaries is: 45.82503239224169. distance: 2.2678038544718055
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.1066, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4582/4804 (95.3789%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4323/4804 (89.9875%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1265, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4279/4793 (89.2760%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4366/4793 (91.0912%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8883, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3375/3781 (89.2621%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3410/3781 (90.1878%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1225, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3732/4175 (89.3892%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3740/4175 (89.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8528, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3966/4362 (90.9216%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4058/4362 (93.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8434, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4635/5083 (91.1863%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4738/5083 (93.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8884, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4516/4874 (92.6549%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4488/4874 (92.0804%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0712, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3283/3646 (90.0439%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3375/3646 (92.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.7439, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3391/3756 (90.2822%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3505/3756 (93.3174%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8703, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3730/4223 (88.3258%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3884/4223 (91.9725%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9125, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4191/4356 (96.2121%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0016, Accuracy: 4254/4356 (97.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.6253, Accuracy: 6290/10000 (62.9000%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4502/5025 (89.5920%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4634/5025 (92.2189%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0341, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5783/6391 (90.4866%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5800/6391 (90.7526%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9560, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4079/4518 (90.2833%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4210/4518 (93.1828%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9740, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4649/5167 (89.9748%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4745/5167 (91.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1266, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4351/4679 (92.9900%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4328/4679 (92.4984%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9507, Accuracy: 5679/10000 (56.7900%)
time spent on training: 229.96343684196472
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.8020, Accuracy: 4610/10000 (46.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 9.7248, Accuracy: 81/9900 (0.8182%)
Done in 253.68018531799316 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4451/4885 (91.1157%), train_poison_data_count: 385
Global model norm: 45.868871461380266.
Norm before scaling: 45.85494016035104. Distance: 2.080931181444783
Total norm for 4 adversaries is: 45.85494016035104. distance: 2.080931181444783
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1808, Accuracy: 9484/9900 (95.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4821/5305 (90.8765%), train_poison_data_count: 415
Global model norm: 45.868871461380266.
Norm before scaling: 45.85518773473183. Distance: 2.1938041310818424
Total norm for 4 adversaries is: 45.85518773473183. distance: 2.1938041310818424
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.1606, Accuracy: 9525/9900 (96.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4297/4717 (91.0960%), train_poison_data_count: 370
Global model norm: 45.868871461380266.
Norm before scaling: 45.84991384516851. Distance: 2.0097702515662856
Total norm for 4 adversaries is: 45.84991384516851. distance: 2.0097702515662856
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0965, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4569/5066 (90.1895%), train_poison_data_count: 400
Global model norm: 45.868871461380266.
Norm before scaling: 45.85881334834941. Distance: 2.2142001500276174
Total norm for 4 adversaries is: 45.85881334834941. distance: 2.2142001500276174
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0761, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4365/4956 (88.0751%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4484/4956 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0772, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3391/3797 (89.3073%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3519/3797 (92.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9008, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4524/5017 (90.1734%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4663/5017 (92.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7918, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4030/4433 (90.9091%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4109/4433 (92.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9424, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3423/3781 (90.5316%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3461/3781 (91.5366%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9824, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4757/5265 (90.3514%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4806/5265 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9086, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4736/5197 (91.1295%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4823/5197 (92.8035%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9782, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3267/3646 (89.6050%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3386/3646 (92.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7484, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4082/4356 (93.7098%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3815/4356 (87.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3286, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3416/3804 (89.8002%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3543/3804 (93.1388%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8327, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3351/3590 (93.3426%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3264/3590 (90.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0989, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3664/4046 (90.5586%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3706/4046 (91.5966%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9838, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4613/5244 (87.9672%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4686/5244 (89.3593%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9215, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4488/5025 (89.3134%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4539/5025 (90.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1750, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3410/3756 (90.7881%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3528/3756 (93.9297%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0014, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4876/5392 (90.4303%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4901/5392 (90.8939%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0917, Accuracy: 5460/10000 (54.6000%)
time spent on training: 229.4610207080841
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.7311, Accuracy: 4723/10000 (47.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 9.8468, Accuracy: 81/9900 (0.8182%)
Done in 252.7859263420105 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4478/4885 (91.6684%), train_poison_data_count: 385
Global model norm: 45.895378222512775.
Norm before scaling: 45.88099735150436. Distance: 2.0356513828703053
Total norm for 4 adversaries is: 45.88099735150436. distance: 2.0356513828703053
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1896, Accuracy: 9436/9900 (95.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4776/5305 (90.0283%), train_poison_data_count: 415
Global model norm: 45.895378222512775.
Norm before scaling: 45.887241320607025. Distance: 2.2678900610097714
Total norm for 4 adversaries is: 45.887241320607025. distance: 2.2678900610097714
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1856, Accuracy: 9446/9900 (95.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4282/4717 (90.7780%), train_poison_data_count: 370
Global model norm: 45.895378222512775.
Norm before scaling: 45.8815268049476. Distance: 2.0295800019797285
Total norm for 4 adversaries is: 45.8815268049476. distance: 2.0295800019797285
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1411, Accuracy: 9562/9900 (96.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4544/5066 (89.6960%), train_poison_data_count: 400
Global model norm: 45.895378222512775.
Norm before scaling: 45.881901941628904. Distance: 2.227468741183687
Total norm for 4 adversaries is: 45.881901941628904. distance: 2.227468741183687
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.1884, Accuracy: 9425/9900 (95.2020%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4189/4663 (89.8349%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4336/4663 (92.9873%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0049, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4179/4618 (90.4937%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4314/4618 (93.4171%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9432, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4191/4662 (89.8970%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4348/4662 (93.2647%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8519, Accuracy: 5808/10000 (58.0800%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4012/4511 (88.9382%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4129/4511 (91.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9721, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3971/4362 (91.0362%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4065/4362 (93.1912%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9912, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4109/4558 (90.1492%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4183/4558 (91.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0258, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3395/3828 (88.6886%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3531/3828 (92.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7443, Accuracy: 5937/10000 (59.3700%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4192/4716 (88.8889%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0478, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4035/4465 (90.3695%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4114/4465 (92.1389%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8497, Accuracy: 5832/10000 (58.3200%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4359/4928 (88.4537%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4453/4928 (90.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1061, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4896/5455 (89.7525%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4848/5455 (88.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1352, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4165/4647 (89.6277%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4248/4647 (91.4138%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9650, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4949/5591 (88.5173%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5030/5591 (89.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0180, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3237/3616 (89.5188%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8735, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4444/4986 (89.1296%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4580/4986 (91.8572%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8917, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4646/5167 (89.9168%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4732/5167 (91.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1102, Accuracy: 5512/10000 (55.1200%)
time spent on training: 233.43391370773315
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.6628, Accuracy: 4854/10000 (48.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 9.6031, Accuracy: 96/9900 (0.9697%)
Done in 256.81993293762207 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4475/4885 (91.6070%), train_poison_data_count: 385
Global model norm: 45.92519499312169.
Norm before scaling: 45.911017557914406. Distance: 2.0706459784488525
Total norm for 4 adversaries is: 45.911017557914406. distance: 2.0706459784488525
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2178, Accuracy: 9327/9900 (94.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4813/5305 (90.7257%), train_poison_data_count: 415
Global model norm: 45.92519499312169.
Norm before scaling: 45.911902945001636. Distance: 2.2227533248861056
Total norm for 4 adversaries is: 45.911902945001636. distance: 2.2227533248861056
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.1532, Accuracy: 9521/9900 (96.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4308/4717 (91.3292%), train_poison_data_count: 370
Global model norm: 45.92519499312169.
Norm before scaling: 45.909863604370194. Distance: 2.0176574159682485
Total norm for 4 adversaries is: 45.909863604370194. distance: 2.0176574159682485
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2625, Accuracy: 9222/9900 (93.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4580/5066 (90.4066%), train_poison_data_count: 400
Global model norm: 45.92519499312169.
Norm before scaling: 45.91292656945182. Distance: 2.169602337099465
Total norm for 4 adversaries is: 45.91292656945182. distance: 2.169602337099465
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.2035, Accuracy: 9382/9900 (94.7677%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3709/4175 (88.8383%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3749/4175 (89.7964%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0315, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4181/4596 (90.9704%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4299/4596 (93.5379%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8699, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3232/3616 (89.3805%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3345/3616 (92.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8513, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4153/4356 (95.3398%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4183/4356 (96.0285%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8044, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4626/5244 (88.2151%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4726/5244 (90.1220%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9294, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2954/3297 (89.5966%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3060/3297 (92.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.6751, Accuracy: 5986/10000 (59.8600%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3284/3646 (90.0713%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3402/3646 (93.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7187, Accuracy: 6055/10000 (60.5500%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3405/3797 (89.6761%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3545/3797 (93.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8692, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4079/4456 (91.5395%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4124/4456 (92.5494%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8734, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3455/3828 (90.2560%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3544/3828 (92.5810%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8643, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5040/5582 (90.2902%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5054/5582 (90.5410%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9856, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3162/3472 (91.0714%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3199/3472 (92.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9777, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3995/4362 (91.5864%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4052/4362 (92.8932%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9153, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4929/5424 (90.8739%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4983/5424 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0702, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4387/4679 (93.7594%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4309/4679 (92.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9651, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3349/3590 (93.2869%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3223/3590 (89.7772%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0899, Accuracy: 5418/10000 (54.1800%)
time spent on training: 228.5560007095337
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.7673, Accuracy: 4746/10000 (47.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 8.9726, Accuracy: 163/9900 (1.6465%)
Done in 251.78369760513306 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4487/4885 (91.8526%), train_poison_data_count: 385
Global model norm: 45.94619124839811.
Norm before scaling: 45.92989148300511. Distance: 2.0616158410943637
Total norm for 4 adversaries is: 45.92989148300511. distance: 2.0616158410943637
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1927, Accuracy: 9395/9900 (94.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 45.94619124839811.
Norm before scaling: 45.93197511419061. Distance: 2.2138339100319326
Total norm for 4 adversaries is: 45.93197511419061. distance: 2.2138339100319326
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.1367, Accuracy: 9562/9900 (96.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4264/4717 (90.3964%), train_poison_data_count: 370
Global model norm: 45.94619124839811.
Norm before scaling: 45.934199498780316. Distance: 2.102388241005445
Total norm for 4 adversaries is: 45.934199498780316. distance: 2.102388241005445
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0916, Accuracy: 9648/9900 (97.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4560/5066 (90.0118%), train_poison_data_count: 400
Global model norm: 45.94619124839811.
Norm before scaling: 45.93498877064601. Distance: 2.2386901375473793
Total norm for 4 adversaries is: 45.93498877064601. distance: 2.2386901375473793
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0524, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3398/3804 (89.3270%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3467/3804 (91.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0480, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2972/3297 (90.1426%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3069/3297 (93.0846%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8463, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4260/4354 (97.8411%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3949/4354 (90.6982%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1071, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4002/4433 (90.2775%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4145/4433 (93.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7939, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3425/3775 (90.7285%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3563/3775 (94.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8583, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4770/5195 (91.8191%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4837/5195 (93.1088%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0274, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4927/5392 (91.3761%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4934/5392 (91.5059%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1151, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4660/5244 (88.8635%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4705/5244 (89.7216%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1076, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4159/4356 (95.4775%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4062/4356 (93.2507%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8674, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3890/4416 (88.0888%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4002/4416 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9336, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4094/4481 (91.3635%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4114/4481 (91.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9851, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4052/4441 (91.2407%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4163/4441 (93.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9444, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3924/4336 (90.4982%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3988/4336 (91.9742%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0968, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3286/3646 (90.1262%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3385/3646 (92.8415%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7709, Accuracy: 5906/10000 (59.0600%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4218/4647 (90.7682%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4263/4647 (91.7366%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8901, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3206/3638 (88.1253%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3341/3638 (91.8362%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9185, Accuracy: 5734/10000 (57.3400%)
time spent on training: 228.48247504234314
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.8156, Accuracy: 4716/10000 (47.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 8.9033, Accuracy: 188/9900 (1.8990%)
Done in 251.91397833824158 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4467/4885 (91.4432%), train_poison_data_count: 385
Global model norm: 45.97181700764475.
Norm before scaling: 45.957983315945775. Distance: 2.1106189591917484
Total norm for 4 adversaries is: 45.957983315945775. distance: 2.1106189591917484
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.2957, Accuracy: 9135/9900 (92.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 45.97181700764475.
Norm before scaling: 45.95648257880084. Distance: 2.1812183104565883
Total norm for 4 adversaries is: 45.95648257880084. distance: 2.1812183104565883
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1182, Accuracy: 9615/9900 (97.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 45.97181700764475.
Norm before scaling: 45.958734994183914. Distance: 2.054503690091029
Total norm for 4 adversaries is: 45.958734994183914. distance: 2.054503690091029
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.1404, Accuracy: 9564/9900 (96.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4529/5066 (89.3999%), train_poison_data_count: 400
Global model norm: 45.97181700764475.
Norm before scaling: 45.964607223248414. Distance: 2.296472734790675
Total norm for 4 adversaries is: 45.964607223248414. distance: 2.296472734790675
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0549, Accuracy: 9743/9900 (98.4141%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4149/4538 (91.4279%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4197/4538 (92.4857%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9141, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5142/5740 (89.5819%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5258/5740 (91.6028%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0865, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4579/4934 (92.8050%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4570/4934 (92.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8771, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3675/4013 (91.5774%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3742/4013 (93.2469%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7643, Accuracy: 5972/10000 (59.7200%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4014/4511 (88.9825%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4153/4511 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8342, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4019/4501 (89.2913%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4071/4501 (90.4466%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9399, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4070/4518 (90.0841%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4179/4518 (92.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8955, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3437/3804 (90.3523%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3527/3804 (92.7182%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8994, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3412/3781 (90.2407%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3322/3781 (87.8604%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1639, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4061/4441 (91.4434%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4068/4441 (91.6010%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0211, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4189/4662 (89.8541%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4278/4662 (91.7632%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9484, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3125/3472 (90.0058%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3233/3472 (93.1164%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9856, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3546/3911 (90.6673%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3575/3911 (91.4088%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1352, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4135/4634 (89.2318%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4273/4634 (92.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8645, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4176/4618 (90.4288%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4199/4618 (90.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0557, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4792/5195 (92.2425%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4696/5195 (90.3946%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1364, Accuracy: 5365/10000 (53.6500%)
time spent on training: 229.85657739639282
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 3.0421, Accuracy: 4511/10000 (45.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 8.9436, Accuracy: 205/9900 (2.0707%)
Done in 253.00822615623474 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4456/4885 (91.2180%), train_poison_data_count: 385
Global model norm: 45.99667744454484.
Norm before scaling: 45.983498972287606. Distance: 2.1182908002223493
Total norm for 4 adversaries is: 45.983498972287606. distance: 2.1182908002223493
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.2259, Accuracy: 9342/9900 (94.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4787/5305 (90.2356%), train_poison_data_count: 415
Global model norm: 45.99667744454484.
Norm before scaling: 45.98309280832195. Distance: 2.2196766167596356
Total norm for 4 adversaries is: 45.98309280832195. distance: 2.2196766167596356
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1554, Accuracy: 9535/9900 (96.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4309/4717 (91.3504%), train_poison_data_count: 370
Global model norm: 45.99667744454484.
Norm before scaling: 45.982468954720936. Distance: 2.011137824762194
Total norm for 4 adversaries is: 45.982468954720936. distance: 2.011137824762194
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.1416, Accuracy: 9530/9900 (96.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4598/5066 (90.7619%), train_poison_data_count: 400
Global model norm: 45.99667744454484.
Norm before scaling: 45.983315800747235. Distance: 2.1733968329173026
Total norm for 4 adversaries is: 45.983315800747235. distance: 2.1733968329173026
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0409, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2948/3271 (90.1253%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2901/3271 (88.6885%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0393, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4420/4928 (89.6916%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4490/4928 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0535, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4548/4804 (94.6711%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4362/4804 (90.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0904, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4139/4618 (89.6275%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4210/4618 (91.1650%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0142, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3423/3756 (91.1342%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3549/3756 (94.4888%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8664, Accuracy: 5865/10000 (58.6500%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4178/4634 (90.1597%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4242/4634 (91.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8810, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3238/3638 (89.0049%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3371/3638 (92.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7662, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3274/3704 (88.3909%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3388/3704 (91.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8525, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4239/4707 (90.0574%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4323/4707 (91.8419%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9111, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4090/4481 (91.2743%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4089/4481 (91.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9782, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4258/4354 (97.7951%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0017, Accuracy: 4258/4354 (97.7951%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8051, Accuracy: 6031/10000 (60.3100%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3243/3646 (88.9468%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3368/3646 (92.3752%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8398, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3804/4223 (90.0781%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3949/4223 (93.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8194, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4060/4511 (90.0022%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4172/4511 (92.4850%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9189, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4046/4456 (90.7989%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4128/4456 (92.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8991, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3470/3861 (89.8731%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3556/3861 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8289, Accuracy: 5828/10000 (58.2800%)
time spent on training: 226.58830666542053
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 3.2233, Accuracy: 4373/10000 (43.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 9.2922, Accuracy: 152/9900 (1.5354%)
Done in 249.9584197998047 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 46.024696686432655.
Norm before scaling: 46.01005112676468. Distance: 2.0875171866251945
Total norm for 4 adversaries is: 46.01005112676468. distance: 2.0875171866251945
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.2566, Accuracy: 9273/9900 (93.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4778/5305 (90.0660%), train_poison_data_count: 415
Global model norm: 46.024696686432655.
Norm before scaling: 46.01208602690031. Distance: 2.2667879474207058
Total norm for 4 adversaries is: 46.01208602690031. distance: 2.2667879474207058
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.1037, Accuracy: 9634/9900 (97.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 46.024696686432655.
Norm before scaling: 46.0110354247693. Distance: 2.081452423424327
Total norm for 4 adversaries is: 46.0110354247693. distance: 2.081452423424327
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.3153, Accuracy: 9148/9900 (92.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4552/5066 (89.8539%), train_poison_data_count: 400
Global model norm: 46.024696686432655.
Norm before scaling: 46.01451080994043. Distance: 2.260381062545118
Total norm for 4 adversaries is: 46.01451080994043. distance: 2.260381062545118
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0865, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3399/3804 (89.3533%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3470/3804 (91.2198%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9776, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4018/4501 (89.2691%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4082/4501 (90.6910%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0512, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4203/4663 (90.1351%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4314/4663 (92.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8804, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4996/5591 (89.3579%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5044/5591 (90.2164%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1001, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4590/5244 (87.5286%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4701/5244 (89.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8703, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3993/4433 (90.0744%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4148/4433 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8831, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4226/4707 (89.7812%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4298/4707 (91.3108%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8000, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4029/4456 (90.4174%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4107/4456 (92.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8255, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4157/4356 (95.4316%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3999/4356 (91.8044%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0163, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4129/4576 (90.2316%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4228/4576 (92.3951%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9382, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4356/4679 (93.0968%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4210/4679 (89.9765%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1701, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4193/4634 (90.4834%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4258/4634 (91.8861%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.7710, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3618/4013 (90.1570%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3744/4013 (93.2968%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8353, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4573/5232 (87.4044%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4722/5232 (90.2523%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0782, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3716/4126 (90.0630%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3829/4126 (92.8017%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9690, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3416/3756 (90.9478%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3488/3756 (92.8647%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8764, Accuracy: 5790/10000 (57.9000%)
time spent on training: 232.07878708839417
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 3.2689, Accuracy: 4394/10000 (43.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 9.1591, Accuracy: 175/9900 (1.7677%)
Done in 255.3434019088745 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 46.052364895844384.
Norm before scaling: 46.038589876455816. Distance: 2.106418147860309
Total norm for 4 adversaries is: 46.038589876455816. distance: 2.106418147860309
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1526, Accuracy: 9539/9900 (96.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4780/5305 (90.1037%), train_poison_data_count: 415
Global model norm: 46.052364895844384.
Norm before scaling: 46.04192001250056. Distance: 2.2567354689139028
Total norm for 4 adversaries is: 46.04192001250056. distance: 2.2567354689139028
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1219, Accuracy: 9602/9900 (96.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 46.052364895844384.
Norm before scaling: 46.036044387115844. Distance: 2.0380738883583094
Total norm for 4 adversaries is: 46.036044387115844. distance: 2.0380738883583094
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1366, Accuracy: 9565/9900 (96.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4572/5066 (90.2487%), train_poison_data_count: 400
Global model norm: 46.052364895844384.
Norm before scaling: 46.04077994526971. Distance: 2.2213841235401874
Total norm for 4 adversaries is: 46.04077994526971. distance: 2.2213841235401874
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.1203, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4591/5055 (90.8210%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4606/5055 (91.1177%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8442, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4098/4481 (91.4528%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4084/4481 (91.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9581, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4243/4767 (89.0078%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4289/4767 (89.9727%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1318, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4742/5265 (90.0665%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4788/5265 (90.9402%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9349, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4080/4558 (89.5129%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4160/4558 (91.2681%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9990, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5008/5591 (89.5725%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5047/5591 (90.2701%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0301, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4604/5232 (87.9969%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4731/5232 (90.4243%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0640, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3402/3756 (90.5751%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3500/3756 (93.1842%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9604, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4023/4433 (90.7512%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4103/4433 (92.5558%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8822, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4250/4793 (88.6710%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4372/4793 (91.2164%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0401, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3840/4235 (90.6730%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3891/4235 (91.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8881, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4205/4707 (89.3350%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4357/4707 (92.5643%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8478, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3656/4025 (90.8323%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3739/4025 (92.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9073, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3416/3837 (89.0279%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3574/3837 (93.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8868, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5821/6391 (91.0812%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5862/6391 (91.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9862, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4261/4354 (97.8640%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3851/4354 (88.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3069, Accuracy: 5220/10000 (52.2000%)
time spent on training: 234.87368440628052
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 3.1796, Accuracy: 4471/10000 (44.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 8.7533, Accuracy: 283/9900 (2.8586%)
Done in 258.4759042263031 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4475/4885 (91.6070%), train_poison_data_count: 385
Global model norm: 46.081907906771015.
Norm before scaling: 46.06662602365323. Distance: 2.1208542043961747
Total norm for 4 adversaries is: 46.06662602365323. distance: 2.1208542043961747
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1209, Accuracy: 9592/9900 (96.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4806/5305 (90.5938%), train_poison_data_count: 415
Global model norm: 46.081907906771015.
Norm before scaling: 46.0668565612795. Distance: 2.226975038022835
Total norm for 4 adversaries is: 46.0668565612795. distance: 2.226975038022835
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1006, Accuracy: 9641/9900 (97.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4300/4717 (91.1596%), train_poison_data_count: 370
Global model norm: 46.081907906771015.
Norm before scaling: 46.066596875135566. Distance: 2.054168751723938
Total norm for 4 adversaries is: 46.066596875135566. distance: 2.054168751723938
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.2188, Accuracy: 9372/9900 (94.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4523/5066 (89.2815%), train_poison_data_count: 400
Global model norm: 46.081907906771015.
Norm before scaling: 46.0718486103499. Distance: 2.2507667294755174
Total norm for 4 adversaries is: 46.0718486103499. distance: 2.2507667294755174
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.1440, Accuracy: 9538/9900 (96.3434%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4946/5424 (91.1873%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4982/5424 (91.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1002, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4098/4576 (89.5542%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4260/4576 (93.0944%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8352, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4570/4934 (92.6226%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4382/4934 (88.8123%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0558, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5056/5582 (90.5769%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5010/5582 (89.7528%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9844, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4385/4956 (88.4786%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4465/4956 (90.0928%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9772, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5379/5902 (91.1386%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5344/5902 (90.5456%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9273, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2959/3297 (89.7483%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3082/3297 (93.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.7400, Accuracy: 6028/10000 (60.2800%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3124/3472 (89.9770%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3235/3472 (93.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8959, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4439/4928 (90.0771%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4559/4928 (92.5122%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9490, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4120/4481 (91.9438%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4089/4481 (91.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1249, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4513/5025 (89.8109%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9610, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4426/4986 (88.7686%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4568/4986 (91.6165%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9501, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4336/4928 (87.9870%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4490/4928 (91.1120%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9340, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4621/4804 (96.1907%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4524/4804 (94.1715%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8887, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3284/3646 (90.0713%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3339/3646 (91.5798%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8130, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4258/4707 (90.4610%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4340/4707 (92.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9178, Accuracy: 5734/10000 (57.3400%)
time spent on training: 234.26729559898376
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 3.0502, Accuracy: 4553/10000 (45.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 9.1251, Accuracy: 193/9900 (1.9495%)
Done in 257.4447543621063 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4469/4885 (91.4841%), train_poison_data_count: 385
Global model norm: 46.11400773067089.
Norm before scaling: 46.09994926532593. Distance: 2.067951165712864
Total norm for 4 adversaries is: 46.09994926532593. distance: 2.067951165712864
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1486, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4798/5305 (90.4430%), train_poison_data_count: 415
Global model norm: 46.11400773067089.
Norm before scaling: 46.09872589667609. Distance: 2.2210520232873714
Total norm for 4 adversaries is: 46.09872589667609. distance: 2.2210520232873714
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.3136, Accuracy: 9153/9900 (92.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4307/4717 (91.3080%), train_poison_data_count: 370
Global model norm: 46.11400773067089.
Norm before scaling: 46.09614665379445. Distance: 1.9875110266037725
Total norm for 4 adversaries is: 46.09614665379445. distance: 1.9875110266037725
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.1735, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 46.11400773067089.
Norm before scaling: 46.106547481926306. Distance: 2.2747353326458986
Total norm for 4 adversaries is: 46.106547481926306. distance: 2.2747353326458986
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.2164, Accuracy: 9372/9900 (94.6667%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4540/5116 (88.7412%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4651/5116 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1337, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4147/4651 (89.1636%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4226/4651 (90.8622%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9830, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4953/5591 (88.5888%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5012/5591 (89.6441%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0646, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4597/4804 (95.6911%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4459/4804 (92.8185%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1017, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4077/4456 (91.4946%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4180/4456 (93.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9888, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4710/5063 (93.0278%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4570/5063 (90.2627%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9965, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3772/4223 (89.3204%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3943/4223 (93.3696%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7842, Accuracy: 5920/10000 (59.2000%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4646/4934 (94.1630%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4480/4934 (90.7985%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9620, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3415/3828 (89.2111%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3550/3828 (92.7377%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9348, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5411/5902 (91.6808%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5288/5902 (89.5967%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1214, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3859/4416 (87.3868%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4006/4416 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0307, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4111/4538 (90.5906%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4251/4538 (93.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8810, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4464/5025 (88.8358%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4589/5025 (91.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9935, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4149/4625 (89.7081%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4179/4625 (90.3568%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1105, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4706/5197 (90.5522%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4729/5197 (90.9948%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0551, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3394/3804 (89.2219%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3463/3804 (91.0358%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9605, Accuracy: 5693/10000 (56.9300%)
time spent on training: 240.70008182525635
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.8741, Accuracy: 4738/10000 (47.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 9.8180, Accuracy: 138/9900 (1.3939%)
Done in 267.53351187705994 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4440/4885 (90.8905%), train_poison_data_count: 385
Global model norm: 46.143683229160686.
Norm before scaling: 46.12991430883679. Distance: 2.121075540538204
Total norm for 4 adversaries is: 46.12991430883679. distance: 2.121075540538204
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1970, Accuracy: 9450/9900 (95.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 46.143683229160686.
Norm before scaling: 46.12450774635703. Distance: 2.1738914076101636
Total norm for 4 adversaries is: 46.12450774635703. distance: 2.1738914076101636
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.2674, Accuracy: 9255/9900 (93.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4295/4717 (91.0536%), train_poison_data_count: 370
Global model norm: 46.143683229160686.
Norm before scaling: 46.125693380628434. Distance: 2.060908310273529
Total norm for 4 adversaries is: 46.125693380628434. distance: 2.060908310273529
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1401, Accuracy: 9580/9900 (96.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4543/5066 (89.6763%), train_poison_data_count: 400
Global model norm: 46.143683229160686.
Norm before scaling: 46.13170841714379. Distance: 2.2700418498681003
Total norm for 4 adversaries is: 46.13170841714379. distance: 2.2700418498681003
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1128, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4574/4804 (95.2123%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4484/4804 (93.3389%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9092, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3556/3911 (90.9230%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3630/3911 (92.8151%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9855, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3621/4013 (90.2317%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3734/4013 (93.0476%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8255, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4637/5232 (88.6277%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4755/5232 (90.8830%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9652, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5017/5591 (89.7335%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4979/5591 (89.0538%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2333, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3485/3837 (90.8262%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3579/3837 (93.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8631, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4914/5424 (90.5973%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4962/5424 (91.4823%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0422, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4619/5167 (89.3942%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4748/5167 (91.8908%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0761, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4082/4456 (91.6068%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4172/4456 (93.6266%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8995, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4388/4928 (89.0422%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4557/4928 (92.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8508, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3976/4433 (89.6910%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3919/4433 (88.4051%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9266, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2909/3297 (88.2317%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3059/3297 (92.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7258, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4202/4716 (89.1009%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4264/4716 (90.4156%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0159, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4144/4596 (90.1654%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4257/4596 (92.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9739, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4300/4793 (89.7142%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4400/4793 (91.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8750, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3892/4416 (88.1341%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4027/4416 (91.1911%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9974, Accuracy: 5551/10000 (55.5100%)
time spent on training: 251.76122736930847
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.8437, Accuracy: 4760/10000 (47.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 9.7807, Accuracy: 137/9900 (1.3838%)
Done in 282.6459994316101 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 46.174537254042946.
Norm before scaling: 46.15644570879294. Distance: 2.05654417212098
Total norm for 4 adversaries is: 46.15644570879294. distance: 2.05654417212098
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.2511, Accuracy: 9289/9900 (93.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4811/5305 (90.6880%), train_poison_data_count: 415
Global model norm: 46.174537254042946.
Norm before scaling: 46.159457932699176. Distance: 2.2314102670935108
Total norm for 4 adversaries is: 46.159457932699176. distance: 2.2314102670935108
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1400, Accuracy: 9521/9900 (96.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4299/4717 (91.1384%), train_poison_data_count: 370
Global model norm: 46.174537254042946.
Norm before scaling: 46.15800606002712. Distance: 2.038175426468801
Total norm for 4 adversaries is: 46.15800606002712. distance: 2.038175426468801
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.1180, Accuracy: 9600/9900 (96.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4530/5066 (89.4197%), train_poison_data_count: 400
Global model norm: 46.174537254042946.
Norm before scaling: 46.162229322419265. Distance: 2.236964079539914
Total norm for 4 adversaries is: 46.162229322419265. distance: 2.236964079539914
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0597, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2954/3271 (90.3088%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2947/3271 (90.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9844, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4601/5116 (89.9335%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4598/5116 (89.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9554, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4025/4501 (89.4246%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4106/4501 (91.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8950, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4149/4356 (95.2479%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4130/4356 (94.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9283, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3894/4368 (89.1484%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3954/4368 (90.5220%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9330, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3458/3837 (90.1225%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3593/3837 (93.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8358, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5155/5740 (89.8084%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5239/5740 (91.2718%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0540, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3364/3590 (93.7047%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3465/3590 (96.5181%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8043, Accuracy: 6024/10000 (60.2400%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2989/3297 (90.6582%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3041/3297 (92.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7645, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4175/4716 (88.5284%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4311/4716 (91.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9096, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4538/5055 (89.7725%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4644/5055 (91.8694%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9581, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3541/3911 (90.5395%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3464/3911 (88.5707%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2558, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3638/4158 (87.4940%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3804/4158 (91.4863%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8822, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4043/4456 (90.7316%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4150/4456 (93.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8946, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4049/4511 (89.7584%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4161/4511 (92.2412%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8751, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3270/3672 (89.0523%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3379/3672 (92.0207%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8512, Accuracy: 5767/10000 (57.6700%)
time spent on training: 240.18854689598083
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
Client 18 misclassified the most to class 95 with 1 misclassifications.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 18 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.7890, Accuracy: 4795/10000 (47.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 8.7054, Accuracy: 277/9900 (2.7980%)
Done in 270.9161379337311 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4494/4885 (91.9959%), train_poison_data_count: 385
Global model norm: 46.190148139578966.
Norm before scaling: 46.17451346099247. Distance: 2.0294019067952505
Total norm for 4 adversaries is: 46.17451346099247. distance: 2.0294019067952505
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1814, Accuracy: 9466/9900 (95.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4820/5305 (90.8577%), train_poison_data_count: 415
Global model norm: 46.190148139578966.
Norm before scaling: 46.172451350040696. Distance: 2.1121555792480073
Total norm for 4 adversaries is: 46.172451350040696. distance: 2.1121555792480073
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.2188, Accuracy: 9392/9900 (94.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 46.190148139578966.
Norm before scaling: 46.16943468593426. Distance: 1.8907987656620162
Total norm for 4 adversaries is: 46.16943468593426. distance: 1.8907987656620162
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1826, Accuracy: 9451/9900 (95.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4587/5066 (90.5448%), train_poison_data_count: 400
Global model norm: 46.190148139578966.
Norm before scaling: 46.178375705653615. Distance: 2.2015513758923184
Total norm for 4 adversaries is: 46.178375705653615. distance: 2.2015513758923184
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.1387, Accuracy: 9572/9900 (96.6869%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4820/5063 (95.2005%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4579/5063 (90.4405%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9150, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4624/5083 (90.9699%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4656/5083 (91.5994%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0703, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3449/3797 (90.8349%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3458/3797 (91.0719%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9287, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5554/6124 (90.6924%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5619/6124 (91.7538%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9714, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4653/5232 (88.9335%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4759/5232 (90.9595%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9944, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3467/3861 (89.7954%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3561/3861 (92.2300%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8350, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4493/5037 (89.1999%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4622/5037 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8929, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4549/5116 (88.9171%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4602/5116 (89.9531%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0866, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3918/4368 (89.6978%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3971/4368 (90.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9419, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3292/3672 (89.6514%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3415/3672 (93.0011%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0079, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5396/5902 (91.4266%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5325/5902 (90.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9581, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4039/4361 (92.6164%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3933/4361 (90.1857%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9192, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3621/4158 (87.0851%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3734/4158 (89.8028%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9097, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4555/5025 (90.6468%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4658/5025 (92.6965%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9372, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4085/4456 (91.6741%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4152/4456 (93.1777%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9183, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4026/4433 (90.8189%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4071/4433 (91.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8328, Accuracy: 5869/10000 (58.6900%)
time spent on training: 246.9183030128479
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.9568, Accuracy: 4640/10000 (46.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 8.8498, Accuracy: 220/9900 (2.2222%)
Done in 276.2177703380585 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 46.223791666366196.
Norm before scaling: 46.21065154708652. Distance: 2.076875124347877
Total norm for 4 adversaries is: 46.21065154708652. distance: 2.076875124347877
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1978, Accuracy: 9417/9900 (95.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4837/5305 (91.1781%), train_poison_data_count: 415
Global model norm: 46.223791666366196.
Norm before scaling: 46.2078936286188. Distance: 2.124565977763946
Total norm for 4 adversaries is: 46.2078936286188. distance: 2.124565977763946
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1720, Accuracy: 9481/9900 (95.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 46.223791666366196.
Norm before scaling: 46.203973085723376. Distance: 1.9431279797069516
Total norm for 4 adversaries is: 46.203973085723376. distance: 1.9431279797069516
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.1457, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4613/5066 (91.0580%), train_poison_data_count: 400
Global model norm: 46.223791666366196.
Norm before scaling: 46.2085804819435. Distance: 2.1078960744295965
Total norm for 4 adversaries is: 46.2085804819435. distance: 2.1078960744295965
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0882, Accuracy: 9720/9900 (98.1818%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3642/4025 (90.4845%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3769/4025 (93.6398%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8824, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4375/4928 (88.7784%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4488/4928 (91.0714%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9997, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3735/4175 (89.4611%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3846/4175 (92.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8522, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3926/4416 (88.9040%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3999/4416 (90.5571%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0115, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3436/3797 (90.4925%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3485/3797 (91.7830%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8185, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4793/5195 (92.2618%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4851/5195 (93.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9765, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4635/5232 (88.5894%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4732/5232 (90.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9864, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4989/5455 (91.4574%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4993/5455 (91.5307%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9885, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4220/4716 (89.4826%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4267/4716 (90.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0749, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4387/4679 (93.7594%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4374/4679 (93.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7900, Accuracy: 5897/10000 (58.9700%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5727/6263 (91.4418%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5775/6263 (92.2082%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1554, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4457/4918 (90.6263%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4530/4918 (92.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0503, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4067/4456 (91.2702%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4155/4456 (93.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9698, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5531/5902 (93.7140%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5494/5902 (93.0871%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8288, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4103/4481 (91.5644%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4107/4481 (91.6536%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0326, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5119/5591 (91.5579%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5145/5591 (92.0229%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0284, Accuracy: 5548/10000 (55.4800%)
time spent on training: 248.96934294700623
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 3.0809, Accuracy: 4541/10000 (45.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 9.0495, Accuracy: 170/9900 (1.7172%)
Done in 278.1878707408905 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4491/4885 (91.9345%), train_poison_data_count: 385
Global model norm: 46.2498733106373.
Norm before scaling: 46.23258223543489. Distance: 2.0353797599494583
Total norm for 4 adversaries is: 46.23258223543489. distance: 2.0353797599494583
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0956, Accuracy: 9674/9900 (97.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 46.2498733106373.
Norm before scaling: 46.23005534907053. Distance: 2.161495407583179
Total norm for 4 adversaries is: 46.23005534907053. distance: 2.161495407583179
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.2356, Accuracy: 9351/9900 (94.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4351/4717 (92.2408%), train_poison_data_count: 370
Global model norm: 46.2498733106373.
Norm before scaling: 46.22965135129726. Distance: 1.8851386299052868
Total norm for 4 adversaries is: 46.22965135129726. distance: 1.8851386299052868
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.2255, Accuracy: 9356/9900 (94.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4627/5066 (91.3344%), train_poison_data_count: 400
Global model norm: 46.2498733106373.
Norm before scaling: 46.23592216066286. Distance: 2.0967679265025643
Total norm for 4 adversaries is: 46.23592216066286. distance: 2.0967679265025643
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0737, Accuracy: 9735/9900 (98.3333%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4026/4501 (89.4468%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4120/4501 (91.5352%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9296, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4670/5083 (91.8749%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4697/5083 (92.4061%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0155, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3414/3804 (89.7476%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3488/3804 (91.6930%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9145, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3470/3756 (92.3855%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3534/3756 (94.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8669, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3750/4175 (89.8204%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3766/4175 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9403, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4667/4934 (94.5886%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4349/4934 (88.1435%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2791, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3990/4336 (92.0203%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4053/4336 (93.4732%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9238, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4127/4356 (94.7429%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4160/4356 (95.5005%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9494, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4649/5244 (88.6537%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4661/5244 (88.8825%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9410, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4600/5017 (91.6883%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4633/5017 (92.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9208, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3472/3828 (90.7001%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3562/3828 (93.0512%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8465, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4146/4538 (91.3618%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4223/4538 (93.0586%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8693, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3233/3638 (88.8675%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3359/3638 (92.3310%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8977, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4255/4662 (91.2698%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4298/4662 (92.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0061, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3444/3797 (90.7032%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3545/3797 (93.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9894, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4203/4634 (90.6992%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4282/4634 (92.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8448, Accuracy: 5868/10000 (58.6800%)
time spent on training: 237.4384789466858
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
Client 4 misclassified the most to class 95 with 1 misclassifications.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 4 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 3.0053, Accuracy: 4596/10000 (45.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 8.1230, Accuracy: 313/9900 (3.1616%)
Done in 265.09109449386597 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4511/4885 (92.3439%), train_poison_data_count: 385
Global model norm: 46.26567513084079.
Norm before scaling: 46.24836356902264. Distance: 1.9764350578626682
Total norm for 4 adversaries is: 46.24836356902264. distance: 1.9764350578626682
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0718, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4876/5305 (91.9133%), train_poison_data_count: 415
Global model norm: 46.26567513084079.
Norm before scaling: 46.24875420619457. Distance: 2.07239436433722
Total norm for 4 adversaries is: 46.24875420619457. distance: 2.07239436433722
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.2340, Accuracy: 9385/9900 (94.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4370/4717 (92.6436%), train_poison_data_count: 370
Global model norm: 46.26567513084079.
Norm before scaling: 46.244644432321834. Distance: 1.8538502269563757
Total norm for 4 adversaries is: 46.244644432321834. distance: 1.8538502269563757
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.1408, Accuracy: 9568/9900 (96.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4657/5066 (91.9266%), train_poison_data_count: 400
Global model norm: 46.26567513084079.
Norm before scaling: 46.24692504558411. Distance: 2.026423074342277
Total norm for 4 adversaries is: 46.24692504558411. distance: 2.026423074342277
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0324, Accuracy: 9816/9900 (99.1515%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3775/4175 (90.4192%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3809/4175 (91.2335%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9244, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4041/4465 (90.5039%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4169/4465 (93.3707%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8704, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4505/4918 (91.6023%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4517/4918 (91.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0163, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4488/5037 (89.1007%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4609/5037 (91.5029%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0241, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3489/3781 (92.2772%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3303/3781 (87.3578%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2152, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4233/4634 (91.3466%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4306/4634 (92.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.7406, Accuracy: 5970/10000 (59.7000%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4123/4576 (90.1005%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4208/4576 (91.9580%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9265, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3480/3861 (90.1321%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3537/3861 (91.6084%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8926, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5608/6124 (91.5741%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5594/6124 (91.3455%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8246, Accuracy: 5828/10000 (58.2800%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3801/4223 (90.0071%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3899/4223 (92.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9196, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4695/5083 (92.3667%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4666/5083 (91.7962%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0404, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4169/4356 (95.7071%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3820/4356 (87.6951%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.6123, Accuracy: 4860/10000 (48.6000%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4297/4793 (89.6516%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4387/4793 (91.5293%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0261, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4549/5055 (89.9901%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4676/5055 (92.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8980, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4000/4362 (91.7011%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3970/4362 (91.0133%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9988, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4001/4433 (90.2549%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4108/4433 (92.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9933, Accuracy: 5623/10000 (56.2300%)
time spent on training: 244.3906922340393
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 3.2144, Accuracy: 4395/10000 (43.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 8.0994, Accuracy: 286/9900 (2.8889%)
Done in 273.39827036857605 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4503/4885 (92.1801%), train_poison_data_count: 385
Global model norm: 46.29397455477467.
Norm before scaling: 46.27729082913535. Distance: 1.9574320795740603
Total norm for 4 adversaries is: 46.27729082913535. distance: 1.9574320795740603
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2424, Accuracy: 9333/9900 (94.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4833/5305 (91.1027%), train_poison_data_count: 415
Global model norm: 46.29397455477467.
Norm before scaling: 46.277398978875205. Distance: 2.1518683765319415
Total norm for 4 adversaries is: 46.277398978875205. distance: 2.1518683765319415
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0617, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4355/4717 (92.3256%), train_poison_data_count: 370
Global model norm: 46.29397455477467.
Norm before scaling: 46.27539948672783. Distance: 1.923587005531523
Total norm for 4 adversaries is: 46.27539948672783. distance: 1.923587005531523
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.2636, Accuracy: 9294/9900 (93.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 46.29397455477467.
Norm before scaling: 46.27816657098545. Distance: 2.105497851904917
Total norm for 4 adversaries is: 46.27816657098545. distance: 2.105497851904917
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.1158, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4566/5025 (90.8657%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4668/5025 (92.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9500, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4048/4441 (91.1506%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4132/4441 (93.0421%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9741, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5133/5591 (91.8083%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5092/5591 (91.0749%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9989, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4209/4481 (93.9299%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4153/4481 (92.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8853, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4250/4767 (89.1546%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4369/4767 (91.6509%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0375, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4576/5055 (90.5242%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4653/5055 (92.0475%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9275, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4108/4518 (90.9252%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4250/4518 (94.0682%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8447, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4117/4625 (89.0162%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4184/4625 (90.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0979, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4304/4793 (89.7976%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4370/4793 (91.1746%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0440, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4666/5083 (91.7962%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4700/5083 (92.4651%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9186, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4660/5244 (88.8635%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4692/5244 (89.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0101, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5752/6263 (91.8410%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5741/6263 (91.6653%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0093, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3790/4175 (90.7784%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3811/4175 (91.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8503, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3931/4416 (89.0172%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4092/4416 (92.6630%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9293, Accuracy: 5770/10000 (57.7000%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4750/5265 (90.2184%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4750/5265 (90.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9960, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3674/4025 (91.2795%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3766/4025 (93.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8729, Accuracy: 5725/10000 (57.2500%)
time spent on training: 247.6219687461853
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 3.1992, Accuracy: 4417/10000 (44.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 7.8308, Accuracy: 379/9900 (3.8283%)
Done in 274.8252148628235 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4520/4885 (92.5281%), train_poison_data_count: 385
Global model norm: 46.32110243992472.
Norm before scaling: 46.3033924285319. Distance: 1.971713666164931
Total norm for 4 adversaries is: 46.3033924285319. distance: 1.971713666164931
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1134, Accuracy: 9630/9900 (97.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4865/5305 (91.7059%), train_poison_data_count: 415
Global model norm: 46.32110243992472.
Norm before scaling: 46.30437049094286. Distance: 2.1423229528072456
Total norm for 4 adversaries is: 46.30437049094286. distance: 2.1423229528072456
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.1190, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4348/4717 (92.1772%), train_poison_data_count: 370
Global model norm: 46.32110243992472.
Norm before scaling: 46.30112514241014. Distance: 1.9340768538099724
Total norm for 4 adversaries is: 46.30112514241014. distance: 1.9340768538099724
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0531, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4633/5066 (91.4528%), train_poison_data_count: 400
Global model norm: 46.32110243992472.
Norm before scaling: 46.30928421696345. Distance: 2.129488860037355
Total norm for 4 adversaries is: 46.30928421696345. distance: 2.129488860037355
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.2117, Accuracy: 9368/9900 (94.6263%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3876/4295 (90.2445%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3802/4295 (88.5215%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9378, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3819/4223 (90.4333%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3935/4223 (93.1802%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9253, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4341/4793 (90.5696%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4335/4793 (90.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9409, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4275/4707 (90.8222%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4355/4707 (92.5218%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9012, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4979/5455 (91.2741%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5041/5455 (92.4106%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9882, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4209/4651 (90.4967%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4295/4651 (92.3457%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9860, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3450/3837 (89.9140%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3575/3837 (93.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0627, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4080/4441 (91.8712%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4131/4441 (93.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9158, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3288/3638 (90.3793%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3349/3638 (92.0561%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8194, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3850/4235 (90.9091%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3946/4235 (93.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8746, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3978/4362 (91.1967%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4093/4362 (93.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9300, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3487/3797 (91.8357%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3533/3797 (93.0471%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9092, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3662/4158 (88.0712%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3769/4158 (90.6445%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8881, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3753/4126 (90.9598%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3844/4126 (93.1653%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8498, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4748/5195 (91.3956%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4633/5195 (89.1819%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0448, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3667/4046 (90.6327%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3747/4046 (92.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9600, Accuracy: 5601/10000 (56.0100%)
time spent on training: 240.84913659095764
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 3.2671, Accuracy: 4332/10000 (43.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 7.6635, Accuracy: 410/9900 (4.1414%)
Done in 270.02242946624756 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4492/4885 (91.9550%), train_poison_data_count: 385
Global model norm: 46.35106145966347.
Norm before scaling: 46.33297297568574. Distance: 2.0051918590579008
Total norm for 4 adversaries is: 46.33297297568574. distance: 2.0051918590579008
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1044, Accuracy: 9654/9900 (97.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4875/5305 (91.8944%), train_poison_data_count: 415
Global model norm: 46.35106145966347.
Norm before scaling: 46.330657076672786. Distance: 2.055136511879076
Total norm for 4 adversaries is: 46.330657076672786. distance: 2.055136511879076
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1643, Accuracy: 9511/9900 (96.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4327/4717 (91.7320%), train_poison_data_count: 370
Global model norm: 46.35106145966347.
Norm before scaling: 46.332085096345494. Distance: 1.9466734265946022
Total norm for 4 adversaries is: 46.332085096345494. distance: 1.9466734265946022
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1270, Accuracy: 9592/9900 (96.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4650/5066 (91.7884%), train_poison_data_count: 400
Global model norm: 46.35106145966347.
Norm before scaling: 46.333418226278646. Distance: 2.0370516746007934
Total norm for 4 adversaries is: 46.333418226278646. distance: 2.0370516746007934
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1797, Accuracy: 9471/9900 (95.6667%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4045/4361 (92.7540%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3989/4361 (91.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8143, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2996/3297 (90.8705%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3096/3297 (93.9035%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7447, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4208/4716 (89.2282%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4269/4716 (90.5216%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9760, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4650/5167 (89.9942%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4823/5167 (93.3424%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0592, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3921/4368 (89.7665%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3901/4368 (89.3086%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0689, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4381/4679 (93.6311%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4361/4679 (93.2037%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8709, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4155/4356 (95.3857%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4169/4356 (95.7071%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9972, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5483/5902 (92.9007%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5327/5902 (90.2575%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1690, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3514/3861 (91.0127%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3549/3861 (91.9192%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8497, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4170/4356 (95.7300%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4077/4356 (93.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8720, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5701/6263 (91.0267%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5739/6263 (91.6334%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1278, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3851/4235 (90.9327%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3858/4235 (91.0980%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9578, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4657/5232 (89.0099%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4782/5232 (91.3991%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9826, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4582/5017 (91.3295%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4650/5017 (92.6849%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.7847, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4620/4804 (96.1699%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4509/4804 (93.8593%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8811, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4283/4793 (89.3595%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4425/4793 (92.3221%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0243, Accuracy: 5664/10000 (56.6400%)
time spent on training: 239.31795716285706
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 3.2902, Accuracy: 4249/10000 (42.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 7.5143, Accuracy: 453/9900 (4.5758%)
Done in 268.14604115486145 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4500/4885 (92.1187%), train_poison_data_count: 385
Global model norm: 46.38561462501737.
Norm before scaling: 46.36911919417653. Distance: 2.037950351301252
Total norm for 4 adversaries is: 46.36911919417653. distance: 2.037950351301252
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0688, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4845/5305 (91.3289%), train_poison_data_count: 415
Global model norm: 46.38561462501737.
Norm before scaling: 46.3673132106552. Distance: 2.0740166689608457
Total norm for 4 adversaries is: 46.3673132106552. distance: 2.0740166689608457
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1147, Accuracy: 9643/9900 (97.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4357/4717 (92.3680%), train_poison_data_count: 370
Global model norm: 46.38561462501737.
Norm before scaling: 46.367197372576875. Distance: 1.8991500710262612
Total norm for 4 adversaries is: 46.367197372576875. distance: 1.8991500710262612
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0727, Accuracy: 9715/9900 (98.1313%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4660/5066 (91.9858%), train_poison_data_count: 400
Global model norm: 46.38561462501737.
Norm before scaling: 46.368666388588856. Distance: 2.0341621064860753
Total norm for 4 adversaries is: 46.368666388588856. distance: 2.0341621064860753
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.1785, Accuracy: 9445/9900 (95.4040%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3475/3837 (90.5655%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3567/3837 (92.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8820, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3495/3861 (90.5206%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3569/3861 (92.4372%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8969, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3734/4175 (89.4371%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3751/4175 (89.8443%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9197, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4060/4441 (91.4209%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4107/4441 (92.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1354, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3983/4336 (91.8589%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4003/4336 (92.3201%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9441, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3694/4046 (91.3000%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3776/4046 (93.3267%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9762, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4456/4956 (89.9112%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4451/4956 (89.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1796, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4211/4618 (91.1867%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4201/4618 (90.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0245, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3230/3616 (89.3252%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3347/3616 (92.5608%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8885, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4197/4576 (91.7177%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4198/4576 (91.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9387, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3830/4223 (90.6938%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3935/4223 (93.1802%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8483, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4090/4503 (90.8283%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4132/4503 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0146, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3392/3590 (94.4847%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3412/3590 (95.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7737, Accuracy: 6045/10000 (60.4500%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4307/4707 (91.5020%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4396/4707 (93.3928%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8998, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3688/4013 (91.9013%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3746/4013 (93.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7593, Accuracy: 5964/10000 (59.6400%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3326/3704 (89.7948%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3389/3704 (91.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8143, Accuracy: 5875/10000 (58.7500%)
time spent on training: 232.52351069450378
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 3.2464, Accuracy: 4292/10000 (42.9200%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 8.0403, Accuracy: 311/9900 (3.1414%)
Done in 261.223833322525 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4486/4885 (91.8321%), train_poison_data_count: 385
Global model norm: 46.412189224316386.
Norm before scaling: 46.394242975287355. Distance: 1.9919491494402382
Total norm for 4 adversaries is: 46.394242975287355. distance: 1.9919491494402382
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1151, Accuracy: 9629/9900 (97.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4861/5305 (91.6305%), train_poison_data_count: 415
Global model norm: 46.412189224316386.
Norm before scaling: 46.39309577876325. Distance: 2.1036027838909606
Total norm for 4 adversaries is: 46.39309577876325. distance: 2.1036027838909606
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1122, Accuracy: 9636/9900 (97.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4347/4717 (92.1560%), train_poison_data_count: 370
Global model norm: 46.412189224316386.
Norm before scaling: 46.390067148885706. Distance: 1.9245669113067494
Total norm for 4 adversaries is: 46.390067148885706. distance: 1.9245669113067494
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0676, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4660/5066 (91.9858%), train_poison_data_count: 400
Global model norm: 46.412189224316386.
Norm before scaling: 46.39516123830291. Distance: 2.0323992485797278
Total norm for 4 adversaries is: 46.39516123830291. distance: 2.0323992485797278
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1427, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4217/4596 (91.7537%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4321/4596 (94.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8536, Accuracy: 5869/10000 (58.6900%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4154/4356 (95.3627%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4000/4356 (91.8274%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1032, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3919/4295 (91.2456%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3977/4295 (92.5960%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9071, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4218/4634 (91.0229%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4213/4634 (90.9150%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8591, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4278/4767 (89.7420%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4331/4767 (90.8538%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9125, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3831/4223 (90.7175%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3957/4223 (93.7012%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8519, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3706/4046 (91.5966%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3711/4046 (91.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8630, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4624/5083 (90.9699%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4659/5083 (91.6585%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9468, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3992/4362 (91.5177%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4103/4362 (94.0624%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8864, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4266/4663 (91.4862%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4339/4663 (93.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8650, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3021/3297 (91.6288%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3081/3297 (93.4486%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8042, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4077/4433 (91.9693%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4058/4433 (91.5407%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8962, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4777/5265 (90.7312%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4781/5265 (90.8072%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9674, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4521/4986 (90.6739%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4558/4986 (91.4160%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9512, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4239/4647 (91.2201%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4297/4647 (92.4683%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8842, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4583/5017 (91.3494%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4602/5017 (91.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9063, Accuracy: 5752/10000 (57.5200%)
time spent on training: 233.10700154304504
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 3.3027, Accuracy: 4154/10000 (41.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 8.4907, Accuracy: 176/9900 (1.7778%)
Done in 261.5751760005951 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4518/4885 (92.4872%), train_poison_data_count: 385
Global model norm: 46.43334646633279.
Norm before scaling: 46.41505598267657. Distance: 1.9585390659241022
Total norm for 4 adversaries is: 46.41505598267657. distance: 1.9585390659241022
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1427, Accuracy: 9555/9900 (96.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4878/5305 (91.9510%), train_poison_data_count: 415
Global model norm: 46.43334646633279.
Norm before scaling: 46.4135673944726. Distance: 2.112478050704781
Total norm for 4 adversaries is: 46.4135673944726. distance: 2.112478050704781
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.1125, Accuracy: 9630/9900 (97.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4319/4717 (91.5624%), train_poison_data_count: 370
Global model norm: 46.43334646633279.
Norm before scaling: 46.41300718902111. Distance: 1.9499242572257098
Total norm for 4 adversaries is: 46.41300718902111. distance: 1.9499242572257098
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0937, Accuracy: 9669/9900 (97.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4614/5066 (91.0778%), train_poison_data_count: 400
Global model norm: 46.43334646633279.
Norm before scaling: 46.41647614600337. Distance: 2.084038144734519
Total norm for 4 adversaries is: 46.41647614600337. distance: 2.084038144734519
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.2274, Accuracy: 9354/9900 (94.4848%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3813/4184 (91.1329%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3795/4184 (90.7027%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9026, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5916/6391 (92.5677%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5912/6391 (92.5051%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0762, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4577/4934 (92.7645%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4458/4934 (90.3527%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1912, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4224/4618 (91.4682%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4263/4618 (92.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0630, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3871/4235 (91.4050%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3932/4235 (92.8453%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0934, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4057/4465 (90.8623%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4191/4465 (93.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8425, Accuracy: 5821/10000 (58.2100%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4071/4503 (90.4064%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4135/4503 (91.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8813, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4505/5025 (89.6517%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0185, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5128/5582 (91.8667%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5164/5582 (92.5116%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1908, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3396/3804 (89.2744%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3512/3804 (92.3239%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8739, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3621/4158 (87.0851%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3719/4158 (89.4420%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8842, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4155/4538 (91.5602%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4235/4538 (93.3230%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8424, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3926/4368 (89.8810%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4006/4368 (91.7125%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9908, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4619/5083 (90.8715%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4613/5083 (90.7535%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9720, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4554/5116 (89.0149%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4686/5116 (91.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9627, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4228/4356 (97.0615%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3963/4356 (90.9780%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1355, Accuracy: 5361/10000 (53.6100%)
time spent on training: 240.72755885124207
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
Client 19 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 19 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 3.2682, Accuracy: 4174/10000 (41.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 7.8532, Accuracy: 266/9900 (2.6869%)
Done in 269.7464051246643 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4540/4885 (92.9376%), train_poison_data_count: 385
Global model norm: 46.450736252911.
Norm before scaling: 46.431090784152914. Distance: 1.9288757099315688
Total norm for 4 adversaries is: 46.431090784152914. distance: 1.9288757099315688
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0913, Accuracy: 9679/9900 (97.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4887/5305 (92.1206%), train_poison_data_count: 415
Global model norm: 46.450736252911.
Norm before scaling: 46.42781222550633. Distance: 1.9812020593853912
Total norm for 4 adversaries is: 46.42781222550633. distance: 1.9812020593853912
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.2687, Accuracy: 9337/9900 (94.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4355/4717 (92.3256%), train_poison_data_count: 370
Global model norm: 46.450736252911.
Norm before scaling: 46.42846427485918. Distance: 1.8796440468297695
Total norm for 4 adversaries is: 46.42846427485918. distance: 1.8796440468297695
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0791, Accuracy: 9706/9900 (98.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4622/5066 (91.2357%), train_poison_data_count: 400
Global model norm: 46.450736252911.
Norm before scaling: 46.43386436390606. Distance: 2.056864582268371
Total norm for 4 adversaries is: 46.43386436390606. distance: 2.056864582268371
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0584, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5674/6263 (90.5956%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5735/6263 (91.5695%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1663, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4010/4433 (90.4579%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4102/4433 (92.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9972, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3328/3672 (90.6318%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3405/3672 (92.7288%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8006, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5035/5455 (92.3006%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5005/5455 (91.7507%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9434, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4539/5025 (90.3284%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4612/5025 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9830, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4230/4618 (91.5981%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4234/4618 (91.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0049, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4266/4707 (90.6310%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4320/4707 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9140, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4027/4362 (92.3200%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3956/4362 (90.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1529, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4406/4989 (88.3143%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4571/4989 (91.6216%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8909, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4666/5083 (91.7962%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4641/5083 (91.3043%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0415, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4227/4647 (90.9619%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4306/4647 (92.6619%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.7903, Accuracy: 5921/10000 (59.2100%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3956/4368 (90.5678%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3927/4368 (89.9038%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9982, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4266/4354 (97.9789%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4181/4354 (96.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9159, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4248/4767 (89.1126%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4326/4767 (90.7489%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0840, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4243/4662 (91.0124%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4324/4662 (92.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9498, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4622/4804 (96.2115%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0021, Accuracy: 4626/4804 (96.2948%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.7721, Accuracy: 6058/10000 (60.5800%)
time spent on training: 243.26750564575195
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
Client 16 misclassified the most to class 48 with 1 misclassifications.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 16 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 3.2436, Accuracy: 4195/10000 (41.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 7.1893, Accuracy: 414/9900 (4.1818%)
Done in 271.7197723388672 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 46.467644047868134.
Norm before scaling: 46.44902542455143. Distance: 1.8695840180119971
Total norm for 4 adversaries is: 46.44902542455143. distance: 1.8695840180119971
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.1409, Accuracy: 9557/9900 (96.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4874/5305 (91.8756%), train_poison_data_count: 415
Global model norm: 46.467644047868134.
Norm before scaling: 46.447146331542804. Distance: 2.006511697308732
Total norm for 4 adversaries is: 46.447146331542804. distance: 2.006511697308732
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.2313, Accuracy: 9382/9900 (94.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4375/4717 (92.7496%), train_poison_data_count: 370
Global model norm: 46.467644047868134.
Norm before scaling: 46.44630268603869. Distance: 1.8078683012030021
Total norm for 4 adversaries is: 46.44630268603869. distance: 1.8078683012030021
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0175, Accuracy: 9855/9900 (99.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4700/5066 (92.7754%), train_poison_data_count: 400
Global model norm: 46.467644047868134.
Norm before scaling: 46.44728825171067. Distance: 1.9335902358514467
Total norm for 4 adversaries is: 46.44728825171067. distance: 1.9335902358514467
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0484, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3869/4235 (91.3577%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3905/4235 (92.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9401, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3441/3775 (91.1523%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3567/3775 (94.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8755, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4519/4874 (92.7165%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4463/4874 (91.5675%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0907, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4754/5265 (90.2944%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4778/5265 (90.7502%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9109, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4647/5083 (91.4224%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4658/5083 (91.6388%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9604, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4088/4511 (90.6229%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4170/4511 (92.4407%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8162, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4203/4538 (92.6179%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4266/4538 (94.0062%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8232, Accuracy: 5931/10000 (59.3100%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4235/4716 (89.8007%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4308/4716 (91.3486%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9010, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4247/4663 (91.0787%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4328/4663 (92.8158%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9382, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4111/4441 (92.5692%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4137/4441 (93.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0671, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4335/4793 (90.4444%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4407/4793 (91.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0389, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4302/4662 (92.2780%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4338/4662 (93.0502%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8899, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3344/3704 (90.2808%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3432/3704 (92.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8488, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4522/4989 (90.6394%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4529/4989 (90.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0963, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4019/4346 (92.4758%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4075/4346 (93.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8207, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4011/4362 (91.9532%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4062/4362 (93.1224%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9262, Accuracy: 5651/10000 (56.5100%)
time spent on training: 236.5405375957489
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
Client 6 misclassified the most to class 92 with 1 misclassifications.
No suspicious behavior detected for user 6.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Client 6 ranked 1 with score 1. Assigned small weight: 0.001
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 3.2476, Accuracy: 4149/10000 (41.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 6.5007, Accuracy: 630/9900 (6.3636%)
Done in 265.1407790184021 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4595/4885 (94.0635%), train_poison_data_count: 385
Global model norm: 46.483526777975335.
Norm before scaling: 46.46098150851287. Distance: 1.7877202225121474
Total norm for 4 adversaries is: 46.46098150851287. distance: 1.7877202225121474
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1187, Accuracy: 9612/9900 (97.0909%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4907/5305 (92.4976%), train_poison_data_count: 415
Global model norm: 46.483526777975335.
Norm before scaling: 46.46198252671209. Distance: 1.9520793709838562
Total norm for 4 adversaries is: 46.46198252671209. distance: 1.9520793709838562
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2330, Accuracy: 9393/9900 (94.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 46.483526777975335.
Norm before scaling: 46.45838821932483. Distance: 1.7418304898666452
Total norm for 4 adversaries is: 46.45838821932483. distance: 1.7418304898666452
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1222, Accuracy: 9579/9900 (96.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4707/5066 (92.9135%), train_poison_data_count: 400
Global model norm: 46.483526777975335.
Norm before scaling: 46.46281800570484. Distance: 1.8857492676912657
Total norm for 4 adversaries is: 46.46281800570484. distance: 1.8857492676912657
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2016, Accuracy: 9431/9900 (95.2626%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3623/3969 (91.2824%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3636/3969 (91.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8463, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4169/4558 (91.4656%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4199/4558 (92.1237%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9210, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4450/4918 (90.4839%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4549/4918 (92.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8625, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5603/5902 (94.9339%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5523/5902 (93.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9009, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4804/5265 (91.2441%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4725/5265 (89.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0004, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4129/4511 (91.5318%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4147/4511 (91.9308%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9592, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4225/4625 (91.3514%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4256/4625 (92.0216%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9372, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3983/4416 (90.1947%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4058/4416 (91.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9783, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3037/3297 (92.1140%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3068/3297 (93.0543%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7545, Accuracy: 6002/10000 (60.0200%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4645/5025 (92.4378%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4683/5025 (93.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0092, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4117/4441 (92.7043%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4178/4441 (94.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0021, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4214/4481 (94.0415%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4153/4481 (92.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0088, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3466/3797 (91.2826%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3572/3797 (94.0743%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8129, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3329/3646 (91.3055%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3414/3646 (93.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8062, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3722/4025 (92.4720%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3789/4025 (94.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8909, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4439/4928 (90.0771%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4477/4928 (90.8482%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9988, Accuracy: 5549/10000 (55.4900%)
time spent on training: 236.00284814834595
users count: 20 and corrupted count: 4.
Selected all 20 users.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
No suspicious behavior detected for user 2.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
No suspicious behavior detected for user 1.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
No suspicious behavior detected for user 0.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
No suspicious behavior detected for user 12.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
No suspicious behavior detected for user 17.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
No suspicious behavior detected for user 18.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
No suspicious behavior detected for user 3.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
No suspicious behavior detected for user 16.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
No suspicious behavior detected for user 14.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
No suspicious behavior detected for user 13.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
No suspicious behavior detected for user 11.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
No suspicious behavior detected for user 9.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
No suspicious behavior detected for user 10.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
No suspicious behavior detected for user 6.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
No suspicious behavior detected for user 19.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
No suspicious behavior detected for user 7.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
No suspicious behavior detected for user 4.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
No suspicious behavior detected for user 5.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
No suspicious behavior detected for user 15.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
No suspicious behavior detected for user 8.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
No non-suspicious updates to aggregate.
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 3.1153, Accuracy: 4236/10000 (42.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 6.7435, Accuracy: 545/9900 (5.5051%)
Done in 264.920533657074 sec.
Saving all the graphs.
This run has a label: Nov.04_17.22.53. Visdom environment: cifar100_CerP
