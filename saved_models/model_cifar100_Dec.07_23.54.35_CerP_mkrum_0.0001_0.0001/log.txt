current path: saved_models/model_cifar100_Dec.07_23.54.35_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4311/4885 (88.2497%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.44001827717782. Distance: 2.294078967543657
Total norm for 4 adversaries is: 42.44001827717782. distance: 2.294078967543657
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4412, Accuracy: 8829/9900 (89.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4738/5305 (89.3120%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435273551683984. Distance: 2.2499746745061797
Total norm for 4 adversaries is: 42.435273551683984. distance: 2.2499746745061797
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7255, Accuracy: 8319/9900 (84.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4181/4717 (88.6368%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43860455116308. Distance: 2.176270352903283
Total norm for 4 adversaries is: 42.43860455116308. distance: 2.176270352903283
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4354, Accuracy: 8869/9900 (89.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4458/5066 (87.9984%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44041664314513. Distance: 2.3041467064469487
Total norm for 4 adversaries is: 42.44041664314513. distance: 2.3041467064469487
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6026, Accuracy: 8506/9900 (85.9192%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3841/4356 (88.1772%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3669/4356 (84.2287%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.3636, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3939/4465 (88.2195%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4090/4465 (91.6013%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0079, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4045/4647 (87.0454%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4162/4647 (89.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9727, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4450/5055 (88.0317%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4534/5055 (89.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1388, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4436/5116 (86.7084%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4456/5116 (87.0993%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9903, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3629/4126 (87.9544%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3755/4126 (91.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9291, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3076/3472 (88.5945%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3225/3472 (92.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0434, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4431/4986 (88.8688%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4439/4986 (89.0293%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0570, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8082, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4025/4618 (87.1589%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4065/4618 (88.0251%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0807, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4445/5083 (87.4484%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1372, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3972/4511 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4010/4511 (88.8938%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1737, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3332/3797 (87.7535%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3414/3797 (89.9131%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9875, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4992/5582 (89.4303%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5071/5582 (90.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1414, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3156/3616 (87.2788%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3219/3616 (89.0210%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1486, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4828/5455 (88.5060%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4857/5455 (89.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0123, Accuracy: 5253/10000 (52.5300%)
time spent on training: 257.3086452484131
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1051, Accuracy: 7059/10000 (70.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0711, Accuracy: 119/9900 (1.2020%)
Done in 284.18108344078064 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4401/4885 (90.0921%), train_poison_data_count: 385
Global model norm: 42.45473232603169.
Norm before scaling: 42.46064497944317. Distance: 2.110960414036442
Total norm for 4 adversaries is: 42.46064497944317. distance: 2.110960414036442
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2630, Accuracy: 9212/9900 (93.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4767/5305 (89.8586%), train_poison_data_count: 415
Global model norm: 42.45473232603169.
Norm before scaling: 42.4581149878361. Distance: 2.167491743518631
Total norm for 4 adversaries is: 42.4581149878361. distance: 2.167491743518631
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5453, Accuracy: 8582/9900 (86.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4184/4717 (88.7004%), train_poison_data_count: 370
Global model norm: 42.45473232603169.
Norm before scaling: 42.46202347392314. Distance: 2.1656703002947744
Total norm for 4 adversaries is: 42.46202347392314. distance: 2.1656703002947744
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2277, Accuracy: 9351/9900 (94.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4497/5066 (88.7683%), train_poison_data_count: 400
Global model norm: 42.45473232603169.
Norm before scaling: 42.46452304893389. Distance: 2.288979798994005
Total norm for 4 adversaries is: 42.46452304893389. distance: 2.288979798994005
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2787, Accuracy: 9143/9900 (92.3535%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3608/4025 (89.6398%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3723/4025 (92.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9684, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3351/3797 (88.2539%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3403/3797 (89.6234%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0521, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3940/4625 (85.1892%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4014/4625 (86.7892%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2237, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3861/4481 (86.1638%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3869/4481 (86.3423%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1077, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3859/4315 (89.4322%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3968/4315 (91.9583%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9993, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3700/4235 (87.3672%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3844/4235 (90.7674%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8999, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3375/3828 (88.1661%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3480/3828 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9001, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3830/4416 (86.7301%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3976/4416 (90.0362%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9363, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3159/3638 (86.8334%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3278/3638 (90.1045%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9248, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4550/5265 (86.4198%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4498/5265 (85.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0414, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3363/3781 (88.9447%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3314/3781 (87.6488%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2678, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3985/4441 (89.7320%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4001/4441 (90.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1906, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3976/4433 (89.6910%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4012/4433 (90.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9906, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4434/5083 (87.2319%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4416/5083 (86.8778%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0613, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4319/4928 (87.6420%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4387/4928 (89.0219%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9635, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4177/4793 (87.1479%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4358/4793 (90.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0658, Accuracy: 5354/10000 (53.5400%)
time spent on training: 257.113981962204
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0966, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0744, Accuracy: 227/9900 (2.2929%)
Done in 284.76402854919434 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 42.47731902834661.
Norm before scaling: 42.47777020882879. Distance: 2.0173795884891703
Total norm for 4 adversaries is: 42.47777020882879. distance: 2.0173795884891703
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2230, Accuracy: 9295/9900 (93.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4794/5305 (90.3676%), train_poison_data_count: 415
Global model norm: 42.47731902834661.
Norm before scaling: 42.4785691026406. Distance: 2.0951569797452865
Total norm for 4 adversaries is: 42.4785691026406. distance: 2.0951569797452865
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0881, Accuracy: 9657/9900 (97.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4254/4717 (90.1844%), train_poison_data_count: 370
Global model norm: 42.47731902834661.
Norm before scaling: 42.47888664438929. Distance: 1.9885783095369944
Total norm for 4 adversaries is: 42.47888664438929. distance: 1.9885783095369944
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2239, Accuracy: 9317/9900 (94.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4512/5066 (89.0644%), train_poison_data_count: 400
Global model norm: 42.47731902834661.
Norm before scaling: 42.48346415445073. Distance: 2.162155467905816
Total norm for 4 adversaries is: 42.48346415445073. distance: 2.162155467905816
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1519, Accuracy: 9509/9900 (96.0505%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3163/3616 (87.4723%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3303/3616 (91.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8697, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3401/3837 (88.6370%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3512/3837 (91.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9200, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4169/4679 (89.1002%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4268/4679 (91.2161%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0298, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3092/3638 (84.9918%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3252/3638 (89.3898%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0479, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3633/4046 (89.7924%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3643/4046 (90.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9671, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3977/4518 (88.0257%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4089/4518 (90.5046%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1776, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3379/3797 (88.9913%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3414/3797 (89.9131%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1221, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4427/5025 (88.0995%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4462/5025 (88.7960%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2906, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3915/4362 (89.7524%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0512, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3998/4558 (87.7139%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4009/4558 (87.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0923, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3212/3672 (87.4728%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3260/3672 (88.7800%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1052, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4326/4874 (88.7567%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4365/4874 (89.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1888, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3607/4025 (89.6149%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3707/4025 (92.0994%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9456, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4096/4663 (87.8404%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4248/4663 (91.1002%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0370, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3461/3911 (88.4940%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3437/3911 (87.8803%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0877, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4438/5017 (88.4592%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4559/5017 (90.8710%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8364, Accuracy: 5704/10000 (57.0400%)
time spent on training: 254.8517198562622
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0916, Accuracy: 7054/10000 (70.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0906, Accuracy: 429/9900 (4.3333%)
Done in 281.78917026519775 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4444/4885 (90.9724%), train_poison_data_count: 385
Global model norm: 42.49775241069741.
Norm before scaling: 42.50005888093348. Distance: 1.9724202534228528
Total norm for 4 adversaries is: 42.50005888093348. distance: 1.9724202534228528
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5270, Accuracy: 8697/9900 (87.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4828/5305 (91.0085%), train_poison_data_count: 415
Global model norm: 42.49775241069741.
Norm before scaling: 42.495787647406154. Distance: 2.018677167493921
Total norm for 4 adversaries is: 42.495787647406154. distance: 2.018677167493921
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0769, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4250/4717 (90.0996%), train_poison_data_count: 370
Global model norm: 42.49775241069741.
Norm before scaling: 42.49926900795986. Distance: 1.955434425653232
Total norm for 4 adversaries is: 42.49926900795986. distance: 1.955434425653232
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1468, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4538/5066 (89.5776%), train_poison_data_count: 400
Global model norm: 42.49775241069741.
Norm before scaling: 42.5037323154354. Distance: 2.119184052334402
Total norm for 4 adversaries is: 42.5037323154354. distance: 2.119184052334402
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3457, Accuracy: 9019/9900 (91.1010%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5279/6124 (86.2018%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5298/6124 (86.5121%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1609, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3876/4356 (88.9807%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3679/4356 (84.4582%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2602, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3537/4158 (85.0649%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3593/4158 (86.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0622, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4893/5455 (89.6975%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4920/5455 (90.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9943, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3933/4511 (87.1869%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4071/4511 (90.2461%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0103, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4548/5232 (86.9266%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4557/5232 (87.0986%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0952, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4492/5244 (85.6598%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4544/5244 (86.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1052, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4384/4918 (89.1419%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4400/4918 (89.4673%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0748, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3626/4126 (87.8817%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3734/4126 (90.4993%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8105, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4356/4928 (88.3929%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4394/4928 (89.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1997, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3741/4223 (88.5863%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3834/4223 (90.7885%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9178, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4509/5195 (86.7950%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4621/5195 (88.9509%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2149, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4157/4679 (88.8438%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4139/4679 (88.4591%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0756, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3215/3646 (88.1788%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3281/3646 (89.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9080, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3195/3616 (88.3573%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3225/3616 (89.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9401, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4068/4716 (86.2595%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4063/4716 (86.1535%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0042, Accuracy: 5467/10000 (54.6700%)
time spent on training: 261.67873215675354
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0889, Accuracy: 7058/10000 (70.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.4283, Accuracy: 704/9900 (7.1111%)
Done in 288.8896267414093 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 42.522750689153156.
Norm before scaling: 42.52582653931094. Distance: 1.9597590579614221
Total norm for 4 adversaries is: 42.52582653931094. distance: 1.9597590579614221
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1721, Accuracy: 9485/9900 (95.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4866/5305 (91.7248%), train_poison_data_count: 415
Global model norm: 42.522750689153156.
Norm before scaling: 42.517597459757766. Distance: 1.9804177061346135
Total norm for 4 adversaries is: 42.517597459757766. distance: 1.9804177061346135
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1458, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4285/4717 (90.8416%), train_poison_data_count: 370
Global model norm: 42.522750689153156.
Norm before scaling: 42.523296119781506. Distance: 1.916177320899928
Total norm for 4 adversaries is: 42.523296119781506. distance: 1.916177320899928
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2035, Accuracy: 9371/9900 (94.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4553/5066 (89.8737%), train_poison_data_count: 400
Global model norm: 42.522750689153156.
Norm before scaling: 42.53031719678769. Distance: 2.0818430974801236
Total norm for 4 adversaries is: 42.53031719678769. distance: 2.0818430974801236
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2663, Accuracy: 9234/9900 (93.2727%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5288/6124 (86.3488%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5352/6124 (87.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0306, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3965/4433 (89.4428%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4021/4433 (90.7061%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0239, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3380/3781 (89.3943%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3251/3781 (85.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4082, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3574/3969 (90.0479%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3574/3969 (90.0479%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0187, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4459/5025 (88.7363%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4539/5025 (90.3284%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1997, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4187/4679 (89.4849%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4227/4679 (90.3398%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9985, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4157/4707 (88.3153%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4213/4707 (89.5050%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9966, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4442/4986 (89.0895%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4453/4986 (89.3101%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9876, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3911/4315 (90.6373%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3947/4315 (91.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8603, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3863/4416 (87.4774%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3944/4416 (89.3116%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9359, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4232/4804 (88.0933%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4092/4804 (85.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1387, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4180/4793 (87.2105%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4268/4793 (89.0465%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0669, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4536/5232 (86.6972%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4554/5232 (87.0413%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0332, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4108/4662 (88.1167%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4202/4662 (90.1330%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0938, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4252/4956 (85.7950%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4289/4956 (86.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1890, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3834/4368 (87.7747%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3803/4368 (87.0650%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0202, Accuracy: 5313/10000 (53.1300%)
time spent on training: 260.77533507347107
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0885, Accuracy: 7079/10000 (70.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7672, Accuracy: 1054/9900 (10.6465%)
Done in 288.0731258392334 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4471/4885 (91.5251%), train_poison_data_count: 385
Global model norm: 42.54702849540803.
Norm before scaling: 42.547529144806106. Distance: 1.9256096506172513
Total norm for 4 adversaries is: 42.547529144806106. distance: 1.9256096506172513
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2941, Accuracy: 9165/9900 (92.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4847/5305 (91.3666%), train_poison_data_count: 415
Global model norm: 42.54702849540803.
Norm before scaling: 42.54398860940139. Distance: 1.9552634777272306
Total norm for 4 adversaries is: 42.54398860940139. distance: 1.9552634777272306
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2219, Accuracy: 9346/9900 (94.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4315/4717 (91.4776%), train_poison_data_count: 370
Global model norm: 42.54702849540803.
Norm before scaling: 42.547160472325444. Distance: 1.8681326672577583
Total norm for 4 adversaries is: 42.547160472325444. distance: 1.8681326672577583
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2323, Accuracy: 9313/9900 (94.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4605/5066 (90.9001%), train_poison_data_count: 400
Global model norm: 42.54702849540803.
Norm before scaling: 42.551684737780214. Distance: 2.0189622560764184
Total norm for 4 adversaries is: 42.551684737780214. distance: 2.0189622560764184
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1118, Accuracy: 9612/9900 (97.0909%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5364/6124 (87.5898%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5335/6124 (87.1163%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0285, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5140/5902 (87.0891%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5106/5902 (86.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0684, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4180/4707 (88.8039%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4209/4707 (89.4200%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9772, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4087/4647 (87.9492%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4170/4647 (89.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9192, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2979/3297 (90.3549%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3020/3297 (91.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8541, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5560/6263 (88.7753%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5653/6263 (90.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1820, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4181/4663 (89.6633%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4265/4663 (91.4647%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1145, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4338/4956 (87.5303%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4357/4956 (87.9136%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1216, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3635/4046 (89.8418%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3702/4046 (91.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9387, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3717/4184 (88.8384%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3774/4184 (90.2008%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8409, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4876/5591 (87.2116%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4910/5591 (87.8197%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1555, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4104/4634 (88.5628%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4200/4634 (90.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9367, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3400/3828 (88.8192%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3511/3828 (91.7189%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9842, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3144/3638 (86.4211%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3260/3638 (89.6097%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9338, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3403/3781 (90.0026%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3365/3781 (88.9976%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2612, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3420/3837 (89.1321%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3513/3837 (91.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8944, Accuracy: 5629/10000 (56.2900%)
time spent on training: 255.00886940956116
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0851, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.2122, Accuracy: 1408/9900 (14.2222%)
Done in 282.1681354045868 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4481/4885 (91.7298%), train_poison_data_count: 385
Global model norm: 42.57057559218574.
Norm before scaling: 42.5687891140989. Distance: 1.8532438088939776
Total norm for 4 adversaries is: 42.5687891140989. distance: 1.8532438088939776
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2878, Accuracy: 9200/9900 (92.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4885/5305 (92.0829%), train_poison_data_count: 415
Global model norm: 42.57057559218574.
Norm before scaling: 42.5679704060716. Distance: 1.9386129566703776
Total norm for 4 adversaries is: 42.5679704060716. distance: 1.9386129566703776
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1516, Accuracy: 9540/9900 (96.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4286/4717 (90.8628%), train_poison_data_count: 370
Global model norm: 42.57057559218574.
Norm before scaling: 42.572377765786264. Distance: 1.8832129847915893
Total norm for 4 adversaries is: 42.572377765786264. distance: 1.8832129847915893
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1547, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 42.57057559218574.
Norm before scaling: 42.572522567195556. Distance: 1.9537356223213749
Total norm for 4 adversaries is: 42.572522567195556. distance: 1.9537356223213749
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2367, Accuracy: 9325/9900 (94.1919%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3917/4501 (87.0251%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3947/4501 (87.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1513, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3713/4175 (88.9341%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3720/4175 (89.1018%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9364, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3164/3616 (87.5000%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3220/3616 (89.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8914, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4070/4634 (87.8291%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4127/4634 (89.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9428, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4021/4558 (88.2185%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4010/4558 (87.9772%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2047, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4564/5167 (88.3298%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4635/5167 (89.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1473, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3897/4356 (89.4628%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3854/4356 (88.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1822, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4150/4716 (87.9983%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4190/4716 (88.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0254, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5394/6124 (88.0797%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5331/6124 (87.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0099, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4473/5055 (88.4866%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4582/5055 (90.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0094, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4519/5025 (89.9303%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4585/5025 (91.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1307, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4378/4918 (89.0199%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4381/4918 (89.0809%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2472, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3767/4223 (89.2020%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3822/4223 (90.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8824, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3922/4481 (87.5251%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3887/4481 (86.7440%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1090, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3205/3638 (88.0979%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3293/3638 (90.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9275, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3586/4013 (89.3596%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3660/4013 (91.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8518, Accuracy: 5650/10000 (56.5000%)
time spent on training: 262.12076568603516
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0858, Accuracy: 7082/10000 (70.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6929, Accuracy: 1896/9900 (19.1515%)
Done in 289.90663957595825 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4508/4885 (92.2825%), train_poison_data_count: 385
Global model norm: 42.593770061440615.
Norm before scaling: 42.59147153205234. Distance: 1.837230859884905
Total norm for 4 adversaries is: 42.59147153205234. distance: 1.837230859884905
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2306, Accuracy: 9323/9900 (94.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4867/5305 (91.7436%), train_poison_data_count: 415
Global model norm: 42.593770061440615.
Norm before scaling: 42.59071344871218. Distance: 1.9233301747900526
Total norm for 4 adversaries is: 42.59071344871218. distance: 1.9233301747900526
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2297, Accuracy: 9356/9900 (94.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4331/4717 (91.8168%), train_poison_data_count: 370
Global model norm: 42.593770061440615.
Norm before scaling: 42.59291457590467. Distance: 1.7884943697197957
Total norm for 4 adversaries is: 42.59291457590467. distance: 1.7884943697197957
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4282, Accuracy: 8861/9900 (89.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4612/5066 (91.0383%), train_poison_data_count: 400
Global model norm: 42.593770061440615.
Norm before scaling: 42.594962267231494. Distance: 1.9545066524186494
Total norm for 4 adversaries is: 42.594962267231494. distance: 1.9545066524186494
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1398, Accuracy: 9540/9900 (96.3636%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3228/3646 (88.5354%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3320/3646 (91.0587%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7858, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3954/4501 (87.8471%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4016/4501 (89.2246%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0263, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4105/4651 (88.2606%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4182/4651 (89.9161%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9825, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4599/5167 (89.0072%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4681/5167 (90.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0675, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4899/5455 (89.8075%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4882/5455 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1371, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4908/5591 (87.7839%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4862/5591 (86.9612%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1730, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4221/4679 (90.2116%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4117/4679 (87.9889%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1132, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4476/5017 (89.2167%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4516/5017 (90.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9016, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4277/4793 (89.2343%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4304/4793 (89.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9966, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4034/4456 (90.5296%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4083/4456 (91.6293%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9463, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4837/5424 (89.1777%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4906/5424 (90.4499%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1417, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3685/4175 (88.2635%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3691/4175 (88.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9984, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4582/5116 (89.5622%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4595/5116 (89.8163%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0109, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3308/3704 (89.3089%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3366/3704 (90.8747%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9153, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4528/5232 (86.5443%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4671/5232 (89.2775%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2490, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3105/3472 (89.4297%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3166/3472 (91.1866%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0951, Accuracy: 5409/10000 (54.0900%)
time spent on training: 262.8777401447296
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0880, Accuracy: 7074/10000 (70.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.2086, Accuracy: 2453/9900 (24.7778%)
Done in 290.03534293174744 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4509/4885 (92.3030%), train_poison_data_count: 385
Global model norm: 42.61752047876334.
Norm before scaling: 42.61533780930949. Distance: 1.8034979793155477
Total norm for 4 adversaries is: 42.61533780930949. distance: 1.8034979793155477
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2050, Accuracy: 9392/9900 (94.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4886/5305 (92.1018%), train_poison_data_count: 415
Global model norm: 42.61752047876334.
Norm before scaling: 42.611507842200766. Distance: 1.884110126257218
Total norm for 4 adversaries is: 42.611507842200766. distance: 1.884110126257218
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2019, Accuracy: 9434/9900 (95.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4322/4717 (91.6260%), train_poison_data_count: 370
Global model norm: 42.61752047876334.
Norm before scaling: 42.6145873118327. Distance: 1.7879753974484949
Total norm for 4 adversaries is: 42.6145873118327. distance: 1.7879753974484949
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1541, Accuracy: 9525/9900 (96.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4645/5066 (91.6897%), train_poison_data_count: 400
Global model norm: 42.61752047876334.
Norm before scaling: 42.61874639105792. Distance: 1.9217313387140775
Total norm for 4 adversaries is: 42.61874639105792. distance: 1.9217313387140775
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3571, Accuracy: 9005/9900 (90.9596%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3250/3590 (90.5292%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3329/3590 (92.7298%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9720, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3878/4368 (88.7821%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3851/4368 (88.1639%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8761, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3299/3704 (89.0659%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3351/3704 (90.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9441, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4363/4928 (88.5349%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4371/4928 (88.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0365, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3912/4356 (89.8072%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3854/4356 (88.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1553, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3494/3911 (89.3378%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3349/3911 (85.6303%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1655, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4152/4651 (89.2711%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4184/4651 (89.9591%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1106, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3754/4184 (89.7228%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3782/4184 (90.3920%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8981, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3935/4346 (90.5430%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4018/4346 (92.4528%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8620, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4233/4793 (88.3163%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4341/4793 (90.5696%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0240, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3430/3804 (90.1682%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3474/3804 (91.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9953, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4495/4986 (90.1524%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4498/4986 (90.2126%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8556, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5395/6124 (88.0960%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5296/6124 (86.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0789, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4183/4707 (88.8676%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4237/4707 (90.0149%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9856, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3825/4235 (90.3188%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3712/4235 (87.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0348, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3658/4046 (90.4103%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3702/4046 (91.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0029, Accuracy: 5396/10000 (53.9600%)
time spent on training: 257.93155574798584
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0920, Accuracy: 7069/10000 (70.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.7558, Accuracy: 3022/9900 (30.5253%)
Done in 284.76935601234436 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4557/4885 (93.2856%), train_poison_data_count: 385
Global model norm: 42.639837730914856.
Norm before scaling: 42.63412744788132. Distance: 1.7735708581466902
Total norm for 4 adversaries is: 42.63412744788132. distance: 1.7735708581466902
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0651, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4901/5305 (92.3845%), train_poison_data_count: 415
Global model norm: 42.639837730914856.
Norm before scaling: 42.635435913190946. Distance: 1.8450133957415318
Total norm for 4 adversaries is: 42.635435913190946. distance: 1.8450133957415318
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0939, Accuracy: 9679/9900 (97.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 42.639837730914856.
Norm before scaling: 42.63698626376224. Distance: 1.7526364902124858
Total norm for 4 adversaries is: 42.63698626376224. distance: 1.7526364902124858
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3351, Accuracy: 9141/9900 (92.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4620/5066 (91.1962%), train_poison_data_count: 400
Global model norm: 42.639837730914856.
Norm before scaling: 42.64134068655528. Distance: 1.942338991893519
Total norm for 4 adversaries is: 42.64134068655528. distance: 1.942338991893519
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1595, Accuracy: 9497/9900 (95.9293%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4456/4986 (89.3702%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4509/4986 (90.4332%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0821, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4075/4634 (87.9370%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4129/4634 (89.1023%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9202, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4179/4716 (88.6132%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4199/4716 (89.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2045, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5376/6124 (87.7858%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5431/6124 (88.6839%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0375, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4399/4918 (89.4469%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4484/4918 (91.1753%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0670, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3399/3797 (89.5180%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3431/3797 (90.3608%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0343, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5008/5582 (89.7169%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5060/5582 (90.6485%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1616, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4356/4956 (87.8935%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4364/4956 (88.0549%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0768, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4047/4433 (91.2926%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8831, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3889/4354 (89.3202%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0115, Accuracy: 3386/4354 (77.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.3755, Accuracy: 4794/10000 (47.9400%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4367/4928 (88.6161%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4424/4928 (89.7727%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8693, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3506/3911 (89.6446%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3485/3911 (89.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9623, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3851/4481 (85.9406%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3791/4481 (84.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1308, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4609/5197 (88.6858%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4599/5197 (88.4934%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9994, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4854/5455 (88.9826%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4927/5455 (90.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0346, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3850/4361 (88.2825%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3762/4361 (86.2646%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1529, Accuracy: 5102/10000 (51.0200%)
time spent on training: 261.5136580467224
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.0977, Accuracy: 7045/10000 (70.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.3474, Accuracy: 3566/9900 (36.0202%)
Done in 288.51869463920593 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4535/4885 (92.8352%), train_poison_data_count: 385
Global model norm: 42.665380776419596.
Norm before scaling: 42.66489724622866. Distance: 1.77453800958903
Total norm for 4 adversaries is: 42.66489724622866. distance: 1.77453800958903
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1572, Accuracy: 9528/9900 (96.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4914/5305 (92.6296%), train_poison_data_count: 415
Global model norm: 42.665380776419596.
Norm before scaling: 42.65837191379832. Distance: 1.82830992195397
Total norm for 4 adversaries is: 42.65837191379832. distance: 1.82830992195397
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1411, Accuracy: 9519/9900 (96.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4717 (92.4316%), train_poison_data_count: 370
Global model norm: 42.665380776419596.
Norm before scaling: 42.65954085291179. Distance: 1.711615650131128
Total norm for 4 adversaries is: 42.65954085291179. distance: 1.711615650131128
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0659, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4628/5066 (91.3541%), train_poison_data_count: 400
Global model norm: 42.665380776419596.
Norm before scaling: 42.66823177645973. Distance: 1.9137059093656197
Total norm for 4 adversaries is: 42.66823177645973. distance: 1.9137059093656197
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1638, Accuracy: 9493/9900 (95.8889%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4347/4928 (88.2102%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4376/4928 (88.7987%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9491, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3797/4184 (90.7505%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3823/4184 (91.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8867, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4263/4707 (90.5672%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4236/4707 (89.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0251, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3451/3828 (90.1515%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3531/3828 (92.2414%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9372, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4020/4503 (89.2738%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4027/4503 (89.4293%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9665, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4204/4662 (90.1759%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4238/4662 (90.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9251, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3797/4235 (89.6576%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3805/4235 (89.8465%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0296, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4461/5244 (85.0686%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4509/5244 (85.9840%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1347, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4264/4793 (88.9631%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4352/4793 (90.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9110, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3986/4481 (88.9534%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3868/4481 (86.3200%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2941, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3974/4346 (91.4404%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4026/4346 (92.6369%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7231, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3847/4361 (88.2137%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3685/4361 (84.4990%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1446, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4572/5055 (90.4451%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4571/5055 (90.4253%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9514, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4588/5195 (88.3157%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4554/5195 (87.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0405, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3933/4315 (91.1472%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3978/4315 (92.1900%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9906, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4224/4663 (90.5855%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4259/4663 (91.3360%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0945, Accuracy: 5394/10000 (53.9400%)
time spent on training: 261.87472677230835
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1029, Accuracy: 7036/10000 (70.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.9394, Accuracy: 4149/9900 (41.9091%)
Done in 289.279661655426 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4549/4885 (93.1218%), train_poison_data_count: 385
Global model norm: 42.688771085120415.
Norm before scaling: 42.68510499549652. Distance: 1.704010199690904
Total norm for 4 adversaries is: 42.68510499549652. distance: 1.704010199690904
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1721, Accuracy: 9500/9900 (95.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4920/5305 (92.7427%), train_poison_data_count: 415
Global model norm: 42.688771085120415.
Norm before scaling: 42.684009682985355. Distance: 1.8169750348540057
Total norm for 4 adversaries is: 42.684009682985355. distance: 1.8169750348540057
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2175, Accuracy: 9363/9900 (94.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4378/4717 (92.8132%), train_poison_data_count: 370
Global model norm: 42.688771085120415.
Norm before scaling: 42.683061628707. Distance: 1.6719213461468263
Total norm for 4 adversaries is: 42.683061628707. distance: 1.6719213461468263
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1746, Accuracy: 9491/9900 (95.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4676/5066 (92.3016%), train_poison_data_count: 400
Global model norm: 42.688771085120415.
Norm before scaling: 42.68873677060862. Distance: 1.8421792920732978
Total norm for 4 adversaries is: 42.68873677060862. distance: 1.8421792920732978
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1494, Accuracy: 9515/9900 (96.1111%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3969/4315 (91.9815%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3964/4315 (91.8656%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8919, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3280/3590 (91.3649%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3203/3590 (89.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1109, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4216/4679 (90.1047%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4246/4679 (90.7459%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9882, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4640/5167 (89.8007%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4659/5167 (90.1684%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1182, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3388/3775 (89.7483%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3526/3775 (93.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7845, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3457/3828 (90.3083%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3498/3828 (91.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8751, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3812/4235 (90.0118%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3865/4235 (91.2633%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9000, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4160/4647 (89.5201%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4181/4647 (89.9720%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9641, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4427/4918 (90.0163%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4469/4918 (90.8703%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0436, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4013/4433 (90.5256%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0106, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3984/4481 (88.9087%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3886/4481 (86.7217%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1521, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3839/4295 (89.3830%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3727/4295 (86.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1893, Accuracy: 5153/10000 (51.5300%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4028/4503 (89.4515%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4046/4503 (89.8512%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9313, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3869/4354 (88.8608%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3635/4354 (83.4864%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.4790, Accuracy: 4718/10000 (47.1800%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4481/4986 (89.8716%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4451/4986 (89.2700%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9893, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5613/6263 (89.6216%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5677/6263 (90.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1416, Accuracy: 5158/10000 (51.5800%)
time spent on training: 256.2600562572479
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1125, Accuracy: 7008/10000 (70.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.6529, Accuracy: 4625/9900 (46.7172%)
Done in 283.29723143577576 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4538/4885 (92.8966%), train_poison_data_count: 385
Global model norm: 42.711752753102836.
Norm before scaling: 42.70692817175203. Distance: 1.7340341181450944
Total norm for 4 adversaries is: 42.70692817175203. distance: 1.7340341181450944
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1579, Accuracy: 9517/9900 (96.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4899/5305 (92.3468%), train_poison_data_count: 415
Global model norm: 42.711752753102836.
Norm before scaling: 42.70746982104682. Distance: 1.872811757149144
Total norm for 4 adversaries is: 42.70746982104682. distance: 1.872811757149144
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0806, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4381/4717 (92.8768%), train_poison_data_count: 370
Global model norm: 42.711752753102836.
Norm before scaling: 42.704002575139256. Distance: 1.6495733460871311
Total norm for 4 adversaries is: 42.704002575139256. distance: 1.6495733460871311
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1707, Accuracy: 9491/9900 (95.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 42.711752753102836.
Norm before scaling: 42.71002505541732. Distance: 1.824973299536628
Total norm for 4 adversaries is: 42.71002505541732. distance: 1.824973299536628
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0624, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3763/4223 (89.1073%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3836/4223 (90.8359%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9624, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4948/5455 (90.7058%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4856/5455 (89.0192%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1259, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5097/5582 (91.3114%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5074/5582 (90.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2471, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4027/4465 (90.1904%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4075/4465 (91.2654%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8798, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4978/5591 (89.0360%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4973/5591 (88.9465%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1790, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3538/3911 (90.4628%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3392/3911 (86.7297%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0353, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3920/4356 (89.9908%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0147, Accuracy: 3271/4356 (75.0918%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.5483, Accuracy: 4507/10000 (45.0700%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4467/5037 (88.6837%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4517/5037 (89.6764%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9318, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4245/4679 (90.7245%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4219/4679 (90.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0995, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4002/4362 (91.7469%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3924/4362 (89.9587%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2102, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4119/4518 (91.1687%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4168/4518 (92.2532%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9565, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4530/5083 (89.1206%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4510/5083 (88.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1891, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3602/4013 (89.7583%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3732/4013 (92.9978%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7971, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4632/5197 (89.1283%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4674/5197 (89.9365%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1100, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2980/3297 (90.3852%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3053/3297 (92.5993%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7988, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4035/4441 (90.8579%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4027/4441 (90.6778%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1393, Accuracy: 5345/10000 (53.4500%)
time spent on training: 259.92317485809326
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1132, Accuracy: 7018/10000 (70.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3846, Accuracy: 5024/9900 (50.7475%)
Done in 287.25542855262756 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4542/4885 (92.9785%), train_poison_data_count: 385
Global model norm: 42.734802043113085.
Norm before scaling: 42.729828654418185. Distance: 1.7235578396406992
Total norm for 4 adversaries is: 42.729828654418185. distance: 1.7235578396406992
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0882, Accuracy: 9688/9900 (97.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4919/5305 (92.7238%), train_poison_data_count: 415
Global model norm: 42.734802043113085.
Norm before scaling: 42.726618925954696. Distance: 1.7444111271461997
Total norm for 4 adversaries is: 42.726618925954696. distance: 1.7444111271461997
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3102, Accuracy: 9210/9900 (93.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4396/4717 (93.1948%), train_poison_data_count: 370
Global model norm: 42.734802043113085.
Norm before scaling: 42.72806026242079. Distance: 1.6573588420201988
Total norm for 4 adversaries is: 42.72806026242079. distance: 1.6573588420201988
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2972, Accuracy: 9146/9900 (92.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4669/5066 (92.1634%), train_poison_data_count: 400
Global model norm: 42.734802043113085.
Norm before scaling: 42.73350661823372. Distance: 1.8299872539680895
Total norm for 4 adversaries is: 42.73350661823372. distance: 1.8299872539680895
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1810, Accuracy: 9444/9900 (95.3939%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4043/4501 (89.8245%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4032/4501 (89.5801%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0163, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4033/4511 (89.4037%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4086/4511 (90.5786%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9675, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3894/4354 (89.4350%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3465/4354 (79.5820%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.4671, Accuracy: 4675/10000 (46.7500%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3966/4346 (91.2563%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4020/4346 (92.4988%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8412, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4239/4707 (90.0574%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4236/4707 (89.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9381, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4941/5591 (88.3742%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4964/5591 (88.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0989, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4141/4647 (89.1113%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4213/4647 (90.6606%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8366, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4104/4538 (90.4363%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4181/4538 (92.1331%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9015, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4371/4934 (88.5894%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4365/4934 (88.4678%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1030, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4335/4804 (90.2373%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4177/4804 (86.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1345, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5701/6263 (91.0267%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5657/6263 (90.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2855, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3972/4481 (88.6409%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3917/4481 (87.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9632, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4449/5063 (87.8728%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4395/5063 (86.8062%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9424, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3739/4223 (88.5390%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3854/4223 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9998, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4051/4441 (91.2182%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4106/4441 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0311, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3415/3756 (90.9212%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3473/3756 (92.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8656, Accuracy: 5703/10000 (57.0300%)
time spent on training: 262.1689112186432
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1172, Accuracy: 7010/10000 (70.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.1859, Accuracy: 5345/9900 (53.9899%)
Done in 289.3988275527954 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4582/4885 (93.7973%), train_poison_data_count: 385
Global model norm: 42.75848126075764.
Norm before scaling: 42.75135917064509. Distance: 1.6748960775903499
Total norm for 4 adversaries is: 42.75135917064509. distance: 1.6748960775903499
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1267, Accuracy: 9589/9900 (96.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4931/5305 (92.9500%), train_poison_data_count: 415
Global model norm: 42.75848126075764.
Norm before scaling: 42.75518803040895. Distance: 1.8460272610347
Total norm for 4 adversaries is: 42.75518803040895. distance: 1.8460272610347
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0622, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4390/4717 (93.0676%), train_poison_data_count: 370
Global model norm: 42.75848126075764.
Norm before scaling: 42.75214866904718. Distance: 1.626208369596724
Total norm for 4 adversaries is: 42.75214866904718. distance: 1.626208369596724
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2025, Accuracy: 9400/9900 (94.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4714/5066 (93.0517%), train_poison_data_count: 400
Global model norm: 42.75848126075764.
Norm before scaling: 42.75298098159355. Distance: 1.7605708203360009
Total norm for 4 adversaries is: 42.75298098159355. distance: 1.7605708203360009
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1897, Accuracy: 9424/9900 (95.1919%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4487/5244 (85.5645%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4560/5244 (86.9565%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9866, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4421/4928 (89.7119%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4449/4928 (90.2800%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8634, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3437/3804 (90.3523%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3485/3804 (91.6141%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9076, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3656/4013 (91.1039%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3685/4013 (91.8266%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9326, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3647/4158 (87.7104%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3633/4158 (87.3737%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9689, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5122/5582 (91.7592%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5041/5582 (90.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0374, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4909/5455 (89.9908%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4944/5455 (90.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0536, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3901/4354 (89.5958%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3522/4354 (80.8911%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.7414, Accuracy: 4448/10000 (44.4800%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4031/4433 (90.9316%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4058/4433 (91.5407%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9555, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3248/3646 (89.0839%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3347/3646 (91.7992%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8531, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4081/4518 (90.3276%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4115/4518 (91.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9812, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3860/4235 (91.1452%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3771/4235 (89.0437%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2531, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4016/4362 (92.0679%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3896/4362 (89.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1041, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4869/5392 (90.3004%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4759/5392 (88.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1494, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4929/5591 (88.1595%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4899/5591 (87.6230%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2075, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9755, Accuracy: 5596/10000 (55.9600%)
time spent on training: 259.13657808303833
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1255, Accuracy: 6981/10000 (69.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.9463, Accuracy: 5800/9900 (58.5859%)
Done in 286.2506048679352 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 42.78173078847807.
Norm before scaling: 42.77360659213153. Distance: 1.6788245534923212
Total norm for 4 adversaries is: 42.77360659213153. distance: 1.6788245534923212
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0913, Accuracy: 9662/9900 (97.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4945/5305 (93.2139%), train_poison_data_count: 415
Global model norm: 42.78173078847807.
Norm before scaling: 42.773107161966415. Distance: 1.7794157254402614
Total norm for 4 adversaries is: 42.773107161966415. distance: 1.7794157254402614
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0185, Accuracy: 9850/9900 (99.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4386/4717 (92.9828%), train_poison_data_count: 370
Global model norm: 42.78173078847807.
Norm before scaling: 42.774282953973206. Distance: 1.6381099496766431
Total norm for 4 adversaries is: 42.774282953973206. distance: 1.6381099496766431
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1097, Accuracy: 9637/9900 (97.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4697/5066 (92.7161%), train_poison_data_count: 400
Global model norm: 42.78173078847807.
Norm before scaling: 42.777106720476084. Distance: 1.8024181282824963
Total norm for 4 adversaries is: 42.777106720476084. distance: 1.8024181282824963
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1313, Accuracy: 9571/9900 (96.6768%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4227/4634 (91.2171%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4164/4634 (89.8576%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0509, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4079/4503 (90.5841%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4062/4503 (90.2065%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9015, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4398/4928 (89.2451%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4479/4928 (90.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8074, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3420/3804 (89.9054%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3450/3804 (90.6940%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9928, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3285/3590 (91.5042%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3064/3590 (85.3482%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.6486, Accuracy: 4635/10000 (46.3500%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4176/4647 (89.8644%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4265/4647 (91.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9013, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4045/4625 (87.4595%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4075/4625 (88.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1113, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3956/4356 (90.8173%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3914/4356 (89.8531%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1529, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3459/3797 (91.0982%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3503/3797 (92.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9397, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4069/4456 (91.3151%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4103/4456 (92.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9268, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3628/4025 (90.1366%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3726/4025 (92.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8902, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3168/3472 (91.2442%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3169/3472 (91.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0434, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2944/3297 (89.2933%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3027/3297 (91.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8344, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3907/4416 (88.4737%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3966/4416 (89.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0837, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3961/4356 (90.9320%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4041/4356 (92.7686%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0394, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3234/3638 (88.8950%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3327/3638 (91.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8673, Accuracy: 5590/10000 (55.9000%)
time spent on training: 253.83053922653198
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1312, Accuracy: 6987/10000 (69.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.7495, Accuracy: 6172/9900 (62.3434%)
Done in 280.9835014343262 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4557/4885 (93.2856%), train_poison_data_count: 385
Global model norm: 42.80183204223711.
Norm before scaling: 42.795928019825965. Distance: 1.6984887670730027
Total norm for 4 adversaries is: 42.795928019825965. distance: 1.6984887670730027
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1483, Accuracy: 9544/9900 (96.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4948/5305 (93.2705%), train_poison_data_count: 415
Global model norm: 42.80183204223711.
Norm before scaling: 42.7915764906446. Distance: 1.7383701944633823
Total norm for 4 adversaries is: 42.7915764906446. distance: 1.7383701944633823
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1140, Accuracy: 9621/9900 (97.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4380/4717 (92.8556%), train_poison_data_count: 370
Global model norm: 42.80183204223711.
Norm before scaling: 42.79284305806507. Distance: 1.6224093694311008
Total norm for 4 adversaries is: 42.79284305806507. distance: 1.6224093694311008
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1150, Accuracy: 9619/9900 (97.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4729/5066 (93.3478%), train_poison_data_count: 400
Global model norm: 42.80183204223711.
Norm before scaling: 42.79458310082524. Distance: 1.75091869218193
Total norm for 4 adversaries is: 42.79458310082524. distance: 1.75091869218193
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0813, Accuracy: 9691/9900 (97.8889%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3730/4175 (89.3413%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3716/4175 (89.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9017, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4356/4956 (87.8935%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4448/4956 (89.7498%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0871, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4464/5037 (88.6242%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4580/5037 (90.9271%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9826, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4304/4793 (89.7976%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4348/4793 (90.7156%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0466, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3410/3804 (89.6425%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3424/3804 (90.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1397, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4873/5392 (90.3746%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4880/5392 (90.5045%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0542, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4084/4465 (91.4670%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9139, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4177/4596 (90.8834%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4251/4596 (92.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9469, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5385/6124 (87.9327%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5390/6124 (88.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0171, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2915/3271 (89.1165%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0051, Accuracy: 2946/3271 (90.0642%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8873, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3258/3590 (90.7521%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3282/3590 (91.4206%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0181, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3963/4501 (88.0471%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4010/4501 (89.0913%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0318, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4649/5232 (88.8570%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4615/5232 (88.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0430, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3283/3672 (89.4063%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3301/3672 (89.8965%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0232, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3834/4223 (90.7885%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3867/4223 (91.5700%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1242, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3933/4354 (90.3307%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0165, Accuracy: 3052/4354 (70.0965%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.7147, Accuracy: 4319/10000 (43.1900%)
time spent on training: 259.36130118370056
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1361, Accuracy: 6983/10000 (69.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.5737, Accuracy: 6491/9900 (65.5657%)
Done in 286.51652574539185 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4624/4885 (94.6571%), train_poison_data_count: 385
Global model norm: 42.824723106865356.
Norm before scaling: 42.81189124795309. Distance: 1.5734439580760202
Total norm for 4 adversaries is: 42.81189124795309. distance: 1.5734439580760202
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2828, Accuracy: 9225/9900 (93.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4975/5305 (93.7795%), train_poison_data_count: 415
Global model norm: 42.824723106865356.
Norm before scaling: 42.81187128872303. Distance: 1.701683484304768
Total norm for 4 adversaries is: 42.81187128872303. distance: 1.701683484304768
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0529, Accuracy: 9770/9900 (98.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4404/4717 (93.3644%), train_poison_data_count: 370
Global model norm: 42.824723106865356.
Norm before scaling: 42.81680806335726. Distance: 1.6458563823132235
Total norm for 4 adversaries is: 42.81680806335726. distance: 1.6458563823132235
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0789, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4732/5066 (93.4070%), train_poison_data_count: 400
Global model norm: 42.824723106865356.
Norm before scaling: 42.81638754019526. Distance: 1.6779215200938316
Total norm for 4 adversaries is: 42.81638754019526. distance: 1.6779215200938316
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1858, Accuracy: 9441/9900 (95.3636%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5110/5582 (91.5442%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5017/5582 (89.8782%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0857, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4179/4647 (89.9290%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4214/4647 (90.6822%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9816, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4048/4465 (90.6607%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4140/4465 (92.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8779, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4553/5083 (89.5731%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4451/5083 (87.5664%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1977, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3868/4416 (87.5906%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3952/4416 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9180, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4408/4956 (88.9427%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4432/4956 (89.4270%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2191, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4025/4362 (92.2742%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3914/4362 (89.7295%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9806, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3949/4356 (90.6566%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3790/4356 (87.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2303, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3422/3781 (90.5052%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3477/3781 (91.9598%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0045, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3281/3590 (91.3928%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3307/3590 (92.1170%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0480, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4209/4651 (90.4967%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4235/4651 (91.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0396, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4220/4662 (90.5191%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4222/4662 (90.5620%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8947, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3160/3472 (91.0138%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3235/3472 (93.1740%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8491, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4906/5424 (90.4499%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4981/5424 (91.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1303, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2956/3271 (90.3699%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2928/3271 (89.5139%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9814, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4479/5037 (88.9220%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4506/5037 (89.4580%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9769, Accuracy: 5525/10000 (55.2500%)
time spent on training: 256.91449093818665
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1381, Accuracy: 6986/10000 (69.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4907, Accuracy: 6645/9900 (67.1212%)
Done in 284.053973197937 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4622/4885 (94.6162%), train_poison_data_count: 385
Global model norm: 42.84651648161581.
Norm before scaling: 42.838507155507884. Distance: 1.5986167799717208
Total norm for 4 adversaries is: 42.838507155507884. distance: 1.5986167799717208
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1633, Accuracy: 9510/9900 (96.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4970/5305 (93.6852%), train_poison_data_count: 415
Global model norm: 42.84651648161581.
Norm before scaling: 42.83715502441704. Distance: 1.7308152241586747
Total norm for 4 adversaries is: 42.83715502441704. distance: 1.7308152241586747
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1048, Accuracy: 9632/9900 (97.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4428/4717 (93.8732%), train_poison_data_count: 370
Global model norm: 42.84651648161581.
Norm before scaling: 42.83459454966715. Distance: 1.576207724237992
Total norm for 4 adversaries is: 42.83459454966715. distance: 1.576207724237992
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2123, Accuracy: 9386/9900 (94.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4689/5066 (92.5582%), train_poison_data_count: 400
Global model norm: 42.84651648161581.
Norm before scaling: 42.8414021967944. Distance: 1.7651617066868928
Total norm for 4 adversaries is: 42.8414021967944. distance: 1.7651617066868928
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2690, Accuracy: 9244/9900 (93.3737%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4397/4989 (88.1339%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4465/4989 (89.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0553, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3643/4013 (90.7800%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3735/4013 (93.0725%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8462, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4629/5195 (89.1049%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4487/5195 (86.3715%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0398, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3604/3969 (90.8037%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3572/3969 (89.9975%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8772, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3972/4356 (91.1846%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3840/4356 (88.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0921, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4062/4441 (91.4659%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4071/4441 (91.6685%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9999, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4091/4518 (90.5489%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4130/4518 (91.4121%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9607, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3544/3911 (90.6162%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3297/3911 (84.3007%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1066, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4008/4362 (91.8845%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3948/4362 (90.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0939, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3464/3804 (91.0620%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3492/3804 (91.7981%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0408, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3812/4223 (90.2676%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3898/4223 (92.3040%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9305, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4207/4634 (90.7855%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4221/4634 (91.0876%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8615, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3947/4354 (90.6523%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0146, Accuracy: 3205/4354 (73.6105%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.8371, Accuracy: 4074/10000 (40.7400%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4536/5244 (86.4989%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4553/5244 (86.8230%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9735, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4483/5037 (89.0014%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4592/5037 (91.1654%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1091, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3327/3704 (89.8218%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3378/3704 (91.1987%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8394, Accuracy: 5721/10000 (57.2100%)
time spent on training: 258.2756850719452
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1330, Accuracy: 6996/10000 (69.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.4261, Accuracy: 6767/9900 (68.3535%)
Done in 285.758985042572 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4612/4885 (94.4115%), train_poison_data_count: 385
Global model norm: 42.86918720846084.
Norm before scaling: 42.85827417242862. Distance: 1.5846608101642015
Total norm for 4 adversaries is: 42.85827417242862. distance: 1.5846608101642015
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1376, Accuracy: 9545/9900 (96.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4962/5305 (93.5344%), train_poison_data_count: 415
Global model norm: 42.86918720846084.
Norm before scaling: 42.85717331658144. Distance: 1.6940721465896758
Total norm for 4 adversaries is: 42.85717331658144. distance: 1.6940721465896758
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0735, Accuracy: 9711/9900 (98.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4417/4717 (93.6400%), train_poison_data_count: 370
Global model norm: 42.86918720846084.
Norm before scaling: 42.85736415260947. Distance: 1.5468285293534645
Total norm for 4 adversaries is: 42.85736415260947. distance: 1.5468285293534645
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0983, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4741/5066 (93.5847%), train_poison_data_count: 400
Global model norm: 42.86918720846084.
Norm before scaling: 42.85979794951719. Distance: 1.6493356436500208
Total norm for 4 adversaries is: 42.85979794951719. distance: 1.6493356436500208
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1880, Accuracy: 9442/9900 (95.3737%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3924/4416 (88.8587%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3973/4416 (89.9683%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9998, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4644/5197 (89.3592%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4615/5197 (88.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9499, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4429/4918 (90.0569%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4509/4918 (91.6836%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0966, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5672/6263 (90.5636%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5679/6263 (90.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1789, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3274/3646 (89.7970%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3322/3646 (91.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7986, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4307/4707 (91.5020%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4324/4707 (91.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9367, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4465/5063 (88.1888%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4255/5063 (84.0411%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2122, Accuracy: 5088/10000 (50.8800%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3832/4295 (89.2200%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3867/4295 (90.0349%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0490, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4320/4793 (90.1314%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4335/4793 (90.4444%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0429, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4126/4538 (90.9211%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4229/4538 (93.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8500, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4561/5083 (89.7305%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4526/5083 (89.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0535, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3247/3638 (89.2523%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3277/3638 (90.0770%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7973, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5450/6124 (88.9941%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5433/6124 (88.7165%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0591, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4183/4618 (90.5803%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4016/4618 (86.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0832, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3621/3969 (91.2320%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3601/3969 (90.7281%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8907, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3612/4158 (86.8687%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3673/4158 (88.3357%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9942, Accuracy: 5349/10000 (53.4900%)
time spent on training: 264.6517012119293
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1327, Accuracy: 6998/10000 (69.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.3634, Accuracy: 6882/9900 (69.5152%)
Done in 291.4818217754364 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4594/4885 (94.0430%), train_poison_data_count: 385
Global model norm: 42.892873347263354.
Norm before scaling: 42.882787592222684. Distance: 1.5567292268395334
Total norm for 4 adversaries is: 42.882787592222684. distance: 1.5567292268395334
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1909, Accuracy: 9443/9900 (95.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4942/5305 (93.1574%), train_poison_data_count: 415
Global model norm: 42.892873347263354.
Norm before scaling: 42.881446820802495. Distance: 1.7366280570226056
Total norm for 4 adversaries is: 42.881446820802495. distance: 1.7366280570226056
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1592, Accuracy: 9493/9900 (95.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4438/4717 (94.0852%), train_poison_data_count: 370
Global model norm: 42.892873347263354.
Norm before scaling: 42.88160481197036. Distance: 1.549868605797345
Total norm for 4 adversaries is: 42.88160481197036. distance: 1.549868605797345
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0799, Accuracy: 9683/9900 (97.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4716/5066 (93.0912%), train_poison_data_count: 400
Global model norm: 42.892873347263354.
Norm before scaling: 42.88602121239143. Distance: 1.726039962752366
Total norm for 4 adversaries is: 42.88602121239143. distance: 1.726039962752366
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.3118, Accuracy: 9157/9900 (92.4949%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4151/4716 (88.0195%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4184/4716 (88.7193%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0268, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3996/4481 (89.1765%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3910/4481 (87.2573%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0578, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3904/4361 (89.5208%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3821/4361 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1773, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4364/4793 (91.0494%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0491, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3907/4295 (90.9662%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3731/4295 (86.8685%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0783, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4573/5244 (87.2044%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4577/5244 (87.2807%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0291, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4428/4989 (88.7553%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4473/4989 (89.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9582, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4650/5197 (89.4747%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4642/5197 (89.3208%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1720, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3940/4356 (90.4500%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3668/4356 (84.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3232, Accuracy: 4811/10000 (48.1100%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4165/4647 (89.6277%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4168/4647 (89.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0092, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3671/4013 (91.4777%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3699/4013 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7862, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4150/4538 (91.4500%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4200/4538 (92.5518%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7735, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4286/4707 (91.0559%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4289/4707 (91.1196%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8073, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5666/6263 (90.4678%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5665/6263 (90.4519%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1227, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3865/4235 (91.2633%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3741/4235 (88.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0710, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3484/3861 (90.2357%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3478/3861 (90.0803%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0502, Accuracy: 5413/10000 (54.1300%)
time spent on training: 261.98920941352844
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1360, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 1.3036, Accuracy: 6996/9900 (70.6667%)
Done in 289.1845655441284 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4593/4885 (94.0225%), train_poison_data_count: 385
Global model norm: 42.91684080415723.
Norm before scaling: 42.908918571419974. Distance: 1.6345776959212726
Total norm for 4 adversaries is: 42.908918571419974. distance: 1.6345776959212726
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1186, Accuracy: 9606/9900 (97.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4977/5305 (93.8172%), train_poison_data_count: 415
Global model norm: 42.91684080415723.
Norm before scaling: 42.90522577073217. Distance: 1.703089722434239
Total norm for 4 adversaries is: 42.90522577073217. distance: 1.703089722434239
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1198, Accuracy: 9586/9900 (96.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4423/4717 (93.7672%), train_poison_data_count: 370
Global model norm: 42.91684080415723.
Norm before scaling: 42.90574073350354. Distance: 1.5430195860395328
Total norm for 4 adversaries is: 42.90574073350354. distance: 1.5430195860395328
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1523, Accuracy: 9513/9900 (96.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4735/5066 (93.4662%), train_poison_data_count: 400
Global model norm: 42.91684080415723.
Norm before scaling: 42.9107463617252. Distance: 1.7148042643873769
Total norm for 4 adversaries is: 42.9107463617252. distance: 1.7148042643873769
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0920, Accuracy: 9655/9900 (97.5253%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4601/5055 (91.0188%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4639/5055 (91.7705%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9293, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3476/3828 (90.8046%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3593/3828 (93.8610%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8846, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3924/4361 (89.9794%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3890/4361 (89.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9812, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3655/4013 (91.0790%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3738/4013 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8680, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4114/4518 (91.0580%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4169/4518 (92.2753%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9792, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4101/4558 (89.9737%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4058/4558 (89.0303%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1629, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3712/4126 (89.9661%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3807/4126 (92.2685%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9270, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4264/4679 (91.1306%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3911/4679 (83.5862%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2728, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3915/4235 (92.4439%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3831/4235 (90.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8868, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4633/5037 (91.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8842, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3298/3672 (89.8148%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3351/3672 (91.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8058, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4442/4928 (90.1380%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4394/4928 (89.1640%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0204, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3982/4356 (91.4141%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3797/4356 (87.1671%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1781, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4077/4456 (91.4946%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4131/4456 (92.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9986, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4320/4793 (90.1314%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4399/4793 (91.7797%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0637, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4535/5025 (90.2488%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4523/5025 (90.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0508, Accuracy: 5340/10000 (53.4000%)
time spent on training: 258.649405002594
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1365, Accuracy: 7003/10000 (70.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 1.2071, Accuracy: 7180/9900 (72.5253%)
Done in 286.9128260612488 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4641/4885 (95.0051%), train_poison_data_count: 385
Global model norm: 42.93856326012492.
Norm before scaling: 42.9273195149917. Distance: 1.5384445886411822
Total norm for 4 adversaries is: 42.9273195149917. distance: 1.5384445886411822
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0924, Accuracy: 9656/9900 (97.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4991/5305 (94.0811%), train_poison_data_count: 415
Global model norm: 42.93856326012492.
Norm before scaling: 42.92650053570856. Distance: 1.6911179647057555
Total norm for 4 adversaries is: 42.92650053570856. distance: 1.6911179647057555
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0814, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4461/4717 (94.5728%), train_poison_data_count: 370
Global model norm: 42.93856326012492.
Norm before scaling: 42.92398804864245. Distance: 1.4881970639585762
Total norm for 4 adversaries is: 42.92398804864245. distance: 1.4881970639585762
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1628, Accuracy: 9503/9900 (95.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4731/5066 (93.3873%), train_poison_data_count: 400
Global model norm: 42.93856326012492.
Norm before scaling: 42.9313473575836. Distance: 1.6849262956069644
Total norm for 4 adversaries is: 42.9313473575836. distance: 1.6849262956069644
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1271, Accuracy: 9558/9900 (96.5455%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3985/4346 (91.6935%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4039/4346 (92.9360%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8748, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3804/4184 (90.9178%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3808/4184 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9332, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3945/4356 (90.5647%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0111, Accuracy: 3497/4356 (80.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.5219, Accuracy: 4814/10000 (48.1400%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3317/3646 (90.9764%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3365/3646 (92.2929%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7560, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4598/5083 (90.4584%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4562/5083 (89.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0643, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3965/4356 (91.0239%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3927/4356 (90.1515%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1339, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4096/4558 (89.8640%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4067/4558 (89.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0439, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3762/4175 (90.1078%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3688/4175 (88.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9267, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3193/3472 (91.9643%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3151/3472 (90.7546%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1295, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4106/4501 (91.2242%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4087/4501 (90.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9009, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4917/5424 (90.6527%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4967/5424 (91.5745%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1864, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4024/4481 (89.8014%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3997/4481 (89.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9913, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4928/5455 (90.3391%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4933/5455 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2035, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4687/5232 (89.5833%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4640/5232 (88.6850%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0817, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5571/6391 (87.1695%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5572/6391 (87.1851%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0647, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3483/3775 (92.2649%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3576/3775 (94.7285%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8555, Accuracy: 5772/10000 (57.7200%)
time spent on training: 259.1281819343567
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1414, Accuracy: 6989/10000 (69.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 1.1065, Accuracy: 7367/9900 (74.4141%)
Done in 286.0616042613983 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4600/4885 (94.1658%), train_poison_data_count: 385
Global model norm: 42.96180909849613.
Norm before scaling: 42.95175089881014. Distance: 1.6358847302631099
Total norm for 4 adversaries is: 42.95175089881014. distance: 1.6358847302631099
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0898, Accuracy: 9653/9900 (97.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5003/5305 (94.3073%), train_poison_data_count: 415
Global model norm: 42.96180909849613.
Norm before scaling: 42.947609856461305. Distance: 1.6467489118281444
Total norm for 4 adversaries is: 42.947609856461305. distance: 1.6467489118281444
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0431, Accuracy: 9774/9900 (98.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4440/4717 (94.1276%), train_poison_data_count: 370
Global model norm: 42.96180909849613.
Norm before scaling: 42.94873113212281. Distance: 1.5208050015392864
Total norm for 4 adversaries is: 42.94873113212281. distance: 1.5208050015392864
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1457, Accuracy: 9513/9900 (96.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4745/5066 (93.6636%), train_poison_data_count: 400
Global model norm: 42.96180909849613.
Norm before scaling: 42.9548599708716. Distance: 1.6936077213001424
Total norm for 4 adversaries is: 42.9548599708716. distance: 1.6936077213001424
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1622, Accuracy: 9480/9900 (95.7576%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3682/4025 (91.4783%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3756/4025 (93.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8153, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3877/4223 (91.8068%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3860/4223 (91.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9576, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3268/3638 (89.8296%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3370/3638 (92.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8330, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4501/5063 (88.8999%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4354/5063 (85.9964%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2112, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4375/4874 (89.7620%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4276/4874 (87.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2725, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4336/4804 (90.2581%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4072/4804 (84.7627%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3372, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3674/4158 (88.3598%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3646/4158 (87.6864%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9594, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4092/4518 (90.5710%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4167/4518 (92.2311%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0527, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3892/4235 (91.9008%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3792/4235 (89.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9841, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4369/4934 (88.5488%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4090/4934 (82.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3191, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5637/6391 (88.2022%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5603/6391 (87.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0754, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3889/4295 (90.5471%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3834/4295 (89.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0305, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3470/3756 (92.3855%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3543/3756 (94.3291%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8234, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4033/4481 (90.0022%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3882/4481 (86.6324%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1119, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3750/4175 (89.8204%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3716/4175 (89.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9972, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3302/3590 (91.9777%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3186/3590 (88.7465%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1742, Accuracy: 5270/10000 (52.7000%)
time spent on training: 253.40920686721802
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1484, Accuracy: 6960/10000 (69.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 1.0153, Accuracy: 7546/9900 (76.2222%)
Done in 280.76335048675537 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4629/4885 (94.7595%), train_poison_data_count: 385
Global model norm: 42.9851233009202.
Norm before scaling: 42.971541102531596. Distance: 1.5420848777506957
Total norm for 4 adversaries is: 42.971541102531596. distance: 1.5420848777506957
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1966, Accuracy: 9429/9900 (95.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5046/5305 (95.1178%), train_poison_data_count: 415
Global model norm: 42.9851233009202.
Norm before scaling: 42.96747583338109. Distance: 1.5460998442511902
Total norm for 4 adversaries is: 42.96747583338109. distance: 1.5460998442511902
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2632, Accuracy: 9301/9900 (93.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4459/4717 (94.5304%), train_poison_data_count: 370
Global model norm: 42.9851233009202.
Norm before scaling: 42.970451670850224. Distance: 1.462310961382127
Total norm for 4 adversaries is: 42.970451670850224. distance: 1.462310961382127
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1061, Accuracy: 9637/9900 (97.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4755/5066 (93.8610%), train_poison_data_count: 400
Global model norm: 42.9851233009202.
Norm before scaling: 42.97703613286548. Distance: 1.6618683726568448
Total norm for 4 adversaries is: 42.97703613286548. distance: 1.6618683726568448
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0784, Accuracy: 9702/9900 (98.0000%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3522/3828 (92.0063%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3554/3828 (92.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7697, Accuracy: 5870/10000 (58.7000%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3578/3911 (91.4856%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3337/3911 (85.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1612, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4039/4362 (92.5951%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3901/4362 (89.4315%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9398, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4787/5197 (92.1108%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4623/5197 (88.9552%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1674, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4288/4679 (91.6435%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4156/4679 (88.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1641, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4358/4793 (90.9243%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1383, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4586/5116 (89.6403%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4618/5116 (90.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1269, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4109/4625 (88.8432%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4124/4625 (89.1676%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9648, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4261/4618 (92.2694%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4189/4618 (90.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0269, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2973/3271 (90.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0122, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3825/4175 (91.6168%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3768/4175 (90.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9362, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3222/3616 (89.1040%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3313/3616 (91.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8884, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3977/4481 (88.7525%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3944/4481 (88.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0990, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3951/4368 (90.4533%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3905/4368 (89.4002%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9159, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5131/5740 (89.3902%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5177/5740 (90.1916%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0653, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4197/4647 (90.3163%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4206/4647 (90.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9745, Accuracy: 5486/10000 (54.8600%)
time spent on training: 258.7264087200165
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1640, Accuracy: 6959/10000 (69.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.8755, Accuracy: 7854/9900 (79.3333%)
Done in 286.5668776035309 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4660/4885 (95.3941%), train_poison_data_count: 385
Global model norm: 43.00749389641298.
Norm before scaling: 42.9939315417195. Distance: 1.5192390690533166
Total norm for 4 adversaries is: 42.9939315417195. distance: 1.5192390690533166
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2201, Accuracy: 9359/9900 (94.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5008/5305 (94.4015%), train_poison_data_count: 415
Global model norm: 43.00749389641298.
Norm before scaling: 42.98980876006036. Distance: 1.621147136498563
Total norm for 4 adversaries is: 42.98980876006036. distance: 1.621147136498563
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1103, Accuracy: 9646/9900 (97.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4450/4717 (94.3396%), train_poison_data_count: 370
Global model norm: 43.00749389641298.
Norm before scaling: 42.992827061161464. Distance: 1.4813089125623478
Total norm for 4 adversaries is: 42.992827061161464. distance: 1.4813089125623478
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0551, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4768/5066 (94.1176%), train_poison_data_count: 400
Global model norm: 43.00749389641298.
Norm before scaling: 42.99759259249289. Distance: 1.6531572075574572
Total norm for 4 adversaries is: 42.99759259249289. distance: 1.6531572075574572
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0562, Accuracy: 9749/9900 (98.4747%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4998/5591 (89.3937%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5034/5591 (90.0376%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0193, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4413/4956 (89.0436%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4333/4956 (87.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0938, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4028/4511 (89.2928%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4130/4511 (91.5540%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9659, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3682/4013 (91.7518%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3722/4013 (92.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8278, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3321/3590 (92.5070%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3336/3590 (92.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9628, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4339/4793 (90.5279%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4364/4793 (91.0494%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0250, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3472/3804 (91.2723%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3477/3804 (91.4038%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0262, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3490/3837 (90.9565%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3546/3837 (92.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9670, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3938/4361 (90.3004%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3802/4361 (87.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0985, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4514/5063 (89.1566%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4371/5063 (86.3322%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2522, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3909/4368 (89.4918%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3921/4368 (89.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0248, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4327/4679 (92.4770%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4114/4679 (87.9248%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1485, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4740/5265 (90.0285%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4655/5265 (88.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0713, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4248/4767 (89.1126%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4186/4767 (87.8120%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2098, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5211/5902 (88.2921%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4925/5902 (83.4463%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3250, Accuracy: 4994/10000 (49.9400%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3817/4223 (90.3860%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3858/4223 (91.3569%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8750, Accuracy: 5685/10000 (56.8500%)
time spent on training: 260.56238317489624
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed, confusion matrix created.
Validation completed for user 0, confusion matrix appended.
No suspicious behavior detected for client 0.
User 0 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 1, confusion matrix appended.
No suspicious behavior detected for client 1.
User 1 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 2, confusion matrix appended.
No suspicious behavior detected for client 2.
User 2 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 3, confusion matrix appended.
No suspicious behavior detected for client 3.
User 3 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 4, confusion matrix appended.
No suspicious behavior detected for client 4.
User 4 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 5, confusion matrix appended.
No suspicious behavior detected for client 5.
User 5 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 6, confusion matrix appended.
No suspicious behavior detected for client 6.
User 6 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 7, confusion matrix appended.
No suspicious behavior detected for client 7.
User 7 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 8, confusion matrix appended.
No suspicious behavior detected for client 8.
User 8 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 9, confusion matrix appended.
No suspicious behavior detected for client 9.
User 9 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 10, confusion matrix appended.
No suspicious behavior detected for client 10.
User 10 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 11, confusion matrix appended.
No suspicious behavior detected for client 11.
User 11 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 12, confusion matrix appended.
No suspicious behavior detected for client 12.
User 12 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
No suspicious behavior detected for client 13.
User 13 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 14, confusion matrix appended.
No suspicious behavior detected for client 14.
User 14 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 15, confusion matrix appended.
No suspicious behavior detected for client 15.
User 15 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 16, confusion matrix appended.
No suspicious behavior detected for client 16.
User 16 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 17, confusion matrix appended.
No suspicious behavior detected for client 17.
User 17 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 18, confusion matrix appended.
No suspicious behavior detected for client 18.
User 18 analyzed for suspicious behavior.
Validation completed, confusion matrix created.
Validation completed for user 19, confusion matrix appended.
No suspicious behavior detected for client 19.
User 19 analyzed for suspicious behavior.
Type of susp_pair_clients before calling assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on entry to assign_weights_based_on_misclassification: <class 'collections.defaultdict'>
susp_pair_clients type on susp_clients_dict = susp_pair_client: <class 'collections.defaultdict'>
Suspicious pairs analyzed across clients.
Central model updated with weighted gradients.
Actual adversaries: [0, 1, 2, 3].
Identified adversaries: [].
Accuracy of identifying adversarial clients: 0.00% (0/3 correctly identified as we are taking 3).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1642, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.8574, Accuracy: 7900/9900 (79.7980%)
Done in 287.70683217048645 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4672/4885 (95.6397%), train_poison_data_count: 385
Global model norm: 43.03067696604656.
Norm before scaling: 43.0144302640114. Distance: 1.433657444674513
Total norm for 4 adversaries is: 43.0144302640114. distance: 1.433657444674513
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1756, Accuracy: 9459/9900 (95.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4997/5305 (94.1942%), train_poison_data_count: 415
Global model norm: 43.03067696604656.
Norm before scaling: 43.01804558663434. Distance: 1.6588842208591086
Total norm for 4 adversaries is: 43.01804558663434. distance: 1.6588842208591086
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1546, Accuracy: 9509/9900 (96.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4454/4717 (94.4244%), train_poison_data_count: 370
Global model norm: 43.03067696604656.
Norm before scaling: 43.01460479402243. Distance: 1.4479201428854216
Total norm for 4 adversaries is: 43.01460479402243. distance: 1.4479201428854216
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1670, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4772/5066 (94.1966%), train_poison_data_count: 400
Global model norm: 43.03067696604656.
Norm before scaling: 43.018159092629126. Distance: 1.6416666992626412
Total norm for 4 adversaries is: 43.018159092629126. distance: 1.6416666992626412
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0490, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3491/3797 (91.9410%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8865, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3497/3861 (90.5724%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3446/3861 (89.2515%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9859, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4301/4707 (91.3745%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4236/4707 (89.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1084, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4139/4518 (91.6113%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4175/4518 (92.4081%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0168, Accuracy: 5468/10000 (54.6800%)
