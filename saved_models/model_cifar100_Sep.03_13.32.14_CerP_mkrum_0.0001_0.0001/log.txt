current path: saved_models/model_cifar100_Sep.03_13.32.14_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4749/5308 (89.4687%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43911510871707. Distance: 2.2814727047422965
Total norm for 4 adversaries is: 42.43911510871707. distance: 2.2814727047422965
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5626, Accuracy: 8595/9900 (86.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5301/5777 (91.7604%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.429675272738066. Distance: 2.173634646460611
Total norm for 4 adversaries is: 42.429675272738066. distance: 2.173634646460611
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5991, Accuracy: 8526/9900 (86.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4579/5123 (89.3812%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.43914243415947. Distance: 2.2640090967676305
Total norm for 4 adversaries is: 42.43914243415947. distance: 2.2640090967676305
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4735, Accuracy: 8750/9900 (88.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4938/5503 (89.7329%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.439300633743365. Distance: 2.3053427589088495
Total norm for 4 adversaries is: 42.439300633743365. distance: 2.3053427589088495
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5233, Accuracy: 8615/9900 (87.0202%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6166/6947 (88.7577%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6144/6947 (88.4411%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0038, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3576/4028 (88.7786%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3692/4028 (91.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8804, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4113/4736 (86.8454%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4248/4736 (89.6959%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0065, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3447/3959 (87.0674%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3578/3959 (90.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8721, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5473/6235 (87.7787%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5433/6235 (87.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2798, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4539/5224 (86.8874%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4706/5224 (90.0842%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0819, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3459/3929 (88.0377%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3567/3929 (90.7865%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9340, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4568/5068 (90.1342%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4699/5068 (92.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0116, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4294/4732 (90.7439%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4408/4732 (93.1530%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7673, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4429/4911 (90.1853%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4473/4911 (91.0812%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8795, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4286/4869 (88.0263%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3999/4869 (82.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4032, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3757/4249 (88.4208%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3858/4249 (90.7978%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9998, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4419/4929 (89.6531%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4461/4929 (90.5052%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0176, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5122/5696 (89.9228%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5137/5696 (90.1861%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0608, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3914/4364 (89.6884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3895/4364 (89.2530%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9897, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4521/5035 (89.7915%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4643/5035 (92.2145%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0308, Accuracy: 5359/10000 (53.5900%)
time spent on training: 271.4506587982178
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1043, Accuracy: 7045/10000 (70.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8376, Accuracy: 136/9900 (1.3737%)
Done in 297.7781774997711 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4866/5308 (91.6729%), train_poison_data_count: 415
Global model norm: 42.45324289181275.
Norm before scaling: 42.45541376789449. Distance: 2.0671544586332122
Total norm for 4 adversaries is: 42.45541376789449. distance: 2.0671544586332122
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2308, Accuracy: 9308/9900 (94.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5369/5777 (92.9375%), train_poison_data_count: 455
Global model norm: 42.45324289181275.
Norm before scaling: 42.44504144147759. Distance: 1.9896311795804436
Total norm for 4 adversaries is: 42.44504144147759. distance: 1.9896311795804436
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2293, Accuracy: 9319/9900 (94.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4604/5123 (89.8692%), train_poison_data_count: 403
Global model norm: 42.45324289181275.
Norm before scaling: 42.45754715650534. Distance: 2.1505612505749205
Total norm for 4 adversaries is: 42.45754715650534. distance: 2.1505612505749205
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1153, Accuracy: 9597/9900 (96.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5046/5503 (91.6954%), train_poison_data_count: 430
Global model norm: 42.45324289181275.
Norm before scaling: 42.45585511786405. Distance: 2.105935690771917
Total norm for 4 adversaries is: 42.45585511786405. distance: 2.105935690771917
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3010, Accuracy: 9152/9900 (92.4444%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4491/5123 (87.6635%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4210/5123 (82.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1261, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4547/5068 (89.7198%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4631/5068 (91.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0805, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4337/5018 (86.4289%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4478/5018 (89.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2582, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3753/4161 (90.1947%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3756/4161 (90.2668%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0324, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4301/4894 (87.8831%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4337/4894 (88.6187%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1277, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4418/4956 (89.1445%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4545/4956 (91.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0248, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4092/4587 (89.2086%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4183/4587 (91.1925%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0745, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6199/6947 (89.2328%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6172/6947 (88.8441%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2894, Accuracy: 5148/10000 (51.4800%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4496/5055 (88.9416%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4604/5055 (91.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0680, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4426/4929 (89.7951%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4394/4929 (89.1459%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1645, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4218/4797 (87.9300%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4272/4797 (89.0557%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9786, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4873/5645 (86.3242%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4876/5645 (86.3773%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.5110, Accuracy: 4835/10000 (48.3500%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4832/5362 (90.1156%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4895/5362 (91.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9405, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4780/5489 (87.0833%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4886/5489 (89.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2601, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3681/4108 (89.6056%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3822/4108 (93.0380%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9208, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3725/4130 (90.1937%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3805/4130 (92.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0120, Accuracy: 5514/10000 (55.1400%)
time spent on training: 265.02598333358765
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0960, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.4961, Accuracy: 328/9900 (3.3131%)
Done in 291.4840281009674 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4890/5308 (92.1251%), train_poison_data_count: 415
Global model norm: 42.47625140703626.
Norm before scaling: 42.47533751337357. Distance: 1.9786225089512317
Total norm for 4 adversaries is: 42.47533751337357. distance: 1.9786225089512317
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3163, Accuracy: 9112/9900 (92.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5399/5777 (93.4568%), train_poison_data_count: 455
Global model norm: 42.47625140703626.
Norm before scaling: 42.469528943371564. Distance: 1.960957196505288
Total norm for 4 adversaries is: 42.469528943371564. distance: 1.960957196505288
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3109, Accuracy: 9100/9900 (91.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4679/5123 (91.3332%), train_poison_data_count: 403
Global model norm: 42.47625140703626.
Norm before scaling: 42.47427127924769. Distance: 1.9664582734771934
Total norm for 4 adversaries is: 42.47427127924769. distance: 1.9664582734771934
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2966, Accuracy: 9187/9900 (92.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5010/5503 (91.0413%), train_poison_data_count: 430
Global model norm: 42.47625140703626.
Norm before scaling: 42.47547258694569. Distance: 2.083286043266173
Total norm for 4 adversaries is: 42.47547258694569. distance: 2.083286043266173
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1137, Accuracy: 9616/9900 (97.1313%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4089/4537 (90.1256%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4172/4537 (91.9550%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8779, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4544/5123 (88.6980%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4465/5123 (87.1560%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1644, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3850/4196 (91.7541%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3957/4196 (94.3041%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7812, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4127/4605 (89.6200%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4228/4605 (91.8132%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8672, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4322/4851 (89.0950%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4412/4851 (90.9503%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8611, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3673/4145 (88.6128%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3798/4145 (91.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9614, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4547/5035 (90.3078%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4676/5035 (92.8699%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9850, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3688/4175 (88.3353%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3760/4175 (90.0599%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0577, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5449/5939 (91.7495%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5504/5939 (92.6755%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0712, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3995/4368 (91.4606%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4048/4368 (92.6740%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0639, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4010/4587 (87.4210%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4132/4587 (90.0807%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0609, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4130/4397 (93.9277%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4201/4397 (95.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7369, Accuracy: 5926/10000 (59.2600%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4278/4869 (87.8620%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4199/4869 (86.2395%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1966, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5163/5696 (90.6426%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5166/5696 (90.6952%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9981, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3168/3552 (89.1892%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3279/3552 (92.3142%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8363, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4154/4736 (87.7111%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4261/4736 (89.9704%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9998, Accuracy: 5400/10000 (54.0000%)
time spent on training: 271.8269953727722
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0904, Accuracy: 7094/10000 (70.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.4152, Accuracy: 662/9900 (6.6869%)
Done in 298.28859519958496 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4908/5308 (92.4642%), train_poison_data_count: 415
Global model norm: 42.496105060493484.
Norm before scaling: 42.49681312729888. Distance: 1.9517529360335109
Total norm for 4 adversaries is: 42.49681312729888. distance: 1.9517529360335109
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1258, Accuracy: 9588/9900 (96.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5395/5777 (93.3876%), train_poison_data_count: 455
Global model norm: 42.496105060493484.
Norm before scaling: 42.48668075988271. Distance: 1.940345889059333
Total norm for 4 adversaries is: 42.48668075988271. distance: 1.940345889059333
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1341, Accuracy: 9542/9900 (96.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4632/5123 (90.4158%), train_poison_data_count: 403
Global model norm: 42.496105060493484.
Norm before scaling: 42.49984633474058. Distance: 2.0655384224480975
Total norm for 4 adversaries is: 42.49984633474058. distance: 2.0655384224480975
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1611, Accuracy: 9469/9900 (95.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5061/5503 (91.9680%), train_poison_data_count: 430
Global model norm: 42.496105060493484.
Norm before scaling: 42.49760160971587. Distance: 2.008614583984959
Total norm for 4 adversaries is: 42.49760160971587. distance: 2.008614583984959
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1946, Accuracy: 9391/9900 (94.8586%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4633/5068 (91.4167%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4534/5068 (89.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1428, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3459/3959 (87.3705%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3577/3959 (90.3511%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9125, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5480/6068 (90.3098%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5501/6068 (90.6559%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9823, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5309/5907 (89.8764%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5343/5907 (90.4520%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2988, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4517/4956 (91.1421%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4557/4956 (91.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9864, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4240/4903 (86.4777%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4416/4903 (90.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3096, Accuracy: 4931/10000 (49.3100%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4999/5727 (87.2883%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5090/5727 (88.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0008, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4889/5346 (91.4516%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4940/5346 (92.4055%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2133, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5373/5871 (91.5176%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5361/5871 (91.3132%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0152, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4340/4889 (88.7707%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4385/4889 (89.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.2519, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4847/5497 (88.1754%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4956/5497 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0628, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4251/4818 (88.2316%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4312/4818 (89.4977%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8968, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4125/4397 (93.8140%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4196/4397 (95.4287%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8538, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3733/4130 (90.3874%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3799/4130 (91.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9117, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3986/4364 (91.3382%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3946/4364 (90.4216%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9085, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4841/5702 (84.9000%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4616/5702 (80.9541%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1583, Accuracy: 5062/10000 (50.6200%)
time spent on training: 277.789945602417
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0916, Accuracy: 7084/10000 (70.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.5530, Accuracy: 1114/9900 (11.2525%)
Done in 304.22352051734924 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4927/5308 (92.8222%), train_poison_data_count: 415
Global model norm: 42.51891955950683.
Norm before scaling: 42.51298916856911. Distance: 1.8764597614506375
Total norm for 4 adversaries is: 42.51298916856911. distance: 1.8764597614506375
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2184, Accuracy: 9365/9900 (94.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5435/5777 (94.0800%), train_poison_data_count: 455
Global model norm: 42.51891955950683.
Norm before scaling: 42.50676359324331. Distance: 1.8252523953169073
Total norm for 4 adversaries is: 42.50676359324331. distance: 1.8252523953169073
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2183, Accuracy: 9373/9900 (94.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4661/5123 (90.9818%), train_poison_data_count: 403
Global model norm: 42.51891955950683.
Norm before scaling: 42.519928691585314. Distance: 1.9928553639827353
Total norm for 4 adversaries is: 42.519928691585314. distance: 1.9928553639827353
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1739, Accuracy: 9471/9900 (95.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5109/5503 (92.8403%), train_poison_data_count: 430
Global model norm: 42.51891955950683.
Norm before scaling: 42.51636432424064. Distance: 1.939232390136549
Total norm for 4 adversaries is: 42.51636432424064. distance: 1.939232390136549
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1006, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4567/4956 (92.1509%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4555/4956 (91.9088%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0428, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3654/4145 (88.1544%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3769/4145 (90.9288%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9533, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4238/4797 (88.3469%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4337/4797 (90.4107%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9106, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4636/5193 (89.2740%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4673/5193 (89.9865%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2648, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5430/5871 (92.4885%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5381/5871 (91.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0588, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3869/4196 (92.2069%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3946/4196 (94.0419%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9479, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4433/4979 (89.0339%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4499/4979 (90.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0794, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4835/5362 (90.1716%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4852/5362 (90.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9544, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5068/5727 (88.4931%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5033/5727 (87.8820%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0432, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4911/5461 (89.9286%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4941/5461 (90.4779%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0904, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5128/5696 (90.0281%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5178/5696 (90.9059%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9714, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4183/4605 (90.8360%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4271/4605 (92.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9343, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4335/4843 (89.5106%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4387/4843 (90.5843%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3117, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4880/5298 (92.1102%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4931/5298 (93.0729%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9834, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4820/5427 (88.8152%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4846/5427 (89.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9988, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4430/4830 (91.7184%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4416/4830 (91.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2471, Accuracy: 5265/10000 (52.6500%)
time spent on training: 278.9168679714203
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0959, Accuracy: 7051/10000 (70.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.7129, Accuracy: 1751/9900 (17.6869%)
Done in 305.205890417099 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4941/5308 (93.0859%), train_poison_data_count: 415
Global model norm: 42.541383229854844.
Norm before scaling: 42.5379210992417. Distance: 1.838611295280339
Total norm for 4 adversaries is: 42.5379210992417. distance: 1.838611295280339
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2278, Accuracy: 9355/9900 (94.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5452/5777 (94.3742%), train_poison_data_count: 455
Global model norm: 42.541383229854844.
Norm before scaling: 42.52854337916037. Distance: 1.7813344567337224
Total norm for 4 adversaries is: 42.52854337916037. distance: 1.7813344567337224
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1031, Accuracy: 9647/9900 (97.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4680/5123 (91.3527%), train_poison_data_count: 403
Global model norm: 42.541383229854844.
Norm before scaling: 42.54138753402753. Distance: 1.9332883034866253
Total norm for 4 adversaries is: 42.54138753402753. distance: 1.9332883034866253
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1498, Accuracy: 9520/9900 (96.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5076/5503 (92.2406%), train_poison_data_count: 430
Global model norm: 42.541383229854844.
Norm before scaling: 42.54293413855217. Distance: 1.9656619724987212
Total norm for 4 adversaries is: 42.54293413855217. distance: 1.9656619724987212
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1459, Accuracy: 9518/9900 (96.1414%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3970/4364 (90.9716%)
___Train Local_ResNet_18,  epoch  76, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3969/4364 (90.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9105, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4803/5353 (89.7254%)
___Train Local_ResNet_18,  epoch  76, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4794/5353 (89.5573%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0098, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4217/4672 (90.2611%)
___Train Local_ResNet_18,  epoch  76, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4313/4672 (92.3159%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7998, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3706/4145 (89.4089%)
___Train Local_ResNet_18,  epoch  76, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3765/4145 (90.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0176, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3931/4313 (91.1431%)
___Train Local_ResNet_18,  epoch  76, local model 24, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3958/4313 (91.7691%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9020, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4358/4889 (89.1389%)
___Train Local_ResNet_18,  epoch  76, local model 8, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4440/4889 (90.8161%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9649, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4401/5050 (87.1485%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4506/5050 (89.2277%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9500, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4796/5702 (84.1108%)
___Train Local_ResNet_18,  epoch  76, local model 11, internal_epoch   2,  Average loss: 0.0108, Accuracy: 4557/5702 (79.9193%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.3290, Accuracy: 4843/10000 (48.4300%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4931/5461 (90.2948%)
___Train Local_ResNet_18,  epoch  76, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4939/5461 (90.4413%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1539, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4536/5122 (88.5592%)
___Train Local_ResNet_18,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0117, Accuracy: 4075/5122 (79.5588%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.4669, Accuracy: 4682/10000 (46.8200%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4275/4714 (90.6873%)
___Train Local_ResNet_18,  epoch  76, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4348/4714 (92.2359%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1877, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3550/3968 (89.4657%)
___Train Local_ResNet_18,  epoch  76, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3627/3968 (91.4062%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8697, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3503/3959 (88.4819%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3638/3959 (91.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9367, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4536/4956 (91.5254%)
___Train Local_ResNet_18,  epoch  76, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4531/4956 (91.4245%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1341, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4262/4818 (88.4599%)
___Train Local_ResNet_18,  epoch  76, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4298/4818 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9797, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3980/4368 (91.1172%)
___Train Local_ResNet_18,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3986/4368 (91.2546%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1012, Accuracy: 5232/10000 (52.3200%)
time spent on training: 272.7439548969269
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.1035, Accuracy: 7025/10000 (70.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 3.9842, Accuracy: 2547/9900 (25.7273%)
Done in 299.05186128616333 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 29, 81, 74, 11, 98, 12, 65, 40, 72, 67, 2, 26, 91, 61, 25, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4940/5308 (93.0671%), train_poison_data_count: 415
Global model norm: 42.56265487306625.
Norm before scaling: 42.55800556758534. Distance: 1.8490463092630856
Total norm for 4 adversaries is: 42.55800556758534. distance: 1.8490463092630856
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1064, Accuracy: 9625/9900 (97.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5479/5777 (94.8416%), train_poison_data_count: 455
Global model norm: 42.56265487306625.
Norm before scaling: 42.55133474836233. Distance: 1.728446174562571
Total norm for 4 adversaries is: 42.55133474836233. distance: 1.728446174562571
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1924, Accuracy: 9412/9900 (95.0707%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4734/5123 (92.4068%), train_poison_data_count: 403
Global model norm: 42.56265487306625.
Norm before scaling: 42.55913567375253. Distance: 1.8568636820630233
Total norm for 4 adversaries is: 42.55913567375253. distance: 1.8568636820630233
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1999, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5120/5503 (93.0402%), train_poison_data_count: 430
Global model norm: 42.56265487306625.
Norm before scaling: 42.55960319620884. Distance: 1.880600829293988
Total norm for 4 adversaries is: 42.55960319620884. distance: 1.880600829293988
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2207, Accuracy: 9326/9900 (94.2020%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4359/4732 (92.1175%)
___Train Local_ResNet_18,  epoch  77, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4389/4732 (92.7515%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9289, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4552/5035 (90.4071%)
___Train Local_ResNet_18,  epoch  77, local model 81, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4592/5035 (91.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9082, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4269/4797 (88.9931%)
___Train Local_ResNet_18,  epoch  77, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4297/4797 (89.5768%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0677, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4747/5702 (83.2515%)
___Train Local_ResNet_18,  epoch  77, local model 11, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4735/5702 (83.0410%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.4522, Accuracy: 4710/10000 (47.1000%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3797/4161 (91.2521%)
___Train Local_ResNet_18,  epoch  77, local model 98, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3837/4161 (92.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9434, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4876/5526 (88.2374%)
___Train Local_ResNet_18,  epoch  77, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4892/5526 (88.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1444, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4895/5497 (89.0486%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4918/5497 (89.4670%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1182, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5458/5939 (91.9010%)
___Train Local_ResNet_18,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5539/5939 (93.2649%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1436, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4635/5193 (89.2548%)
___Train Local_ResNet_18,  epoch  77, local model 72, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4412/5193 (84.9605%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2621, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4861/5559 (87.4438%)
___Train Local_ResNet_18,  epoch  77, local model 67, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4912/5559 (88.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0017, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3532/3968 (89.0121%)
___Train Local_ResNet_18,  epoch  77, local model 2, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3639/3968 (91.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8489, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3742/4086 (91.5810%)
___Train Local_ResNet_18,  epoch  77, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3806/4086 (93.1473%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9835, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4042/4527 (89.2865%)
___Train Local_ResNet_18,  epoch  77, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4040/4527 (89.2423%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9388, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4030/4485 (89.8551%)
___Train Local_ResNet_18,  epoch  77, local model 61, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3865/4485 (86.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9922, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5680/6419 (88.4873%)
___Train Local_ResNet_18,  epoch  77, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5529/6419 (86.1349%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3186, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4850/5489 (88.3585%)
___Train Local_ResNet_18,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4967/5489 (90.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0508, Accuracy: 5382/10000 (53.8200%)
time spent on training: 278.89559626579285
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.1076, Accuracy: 7024/10000 (70.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.4541, Accuracy: 3273/9900 (33.0606%)
Done in 305.2339451313019 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 56, 90, 54, 63, 94, 10, 96, 45, 38, 59, 6, 85, 55, 32, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4956/5308 (93.3685%), train_poison_data_count: 415
Global model norm: 42.58631085302309.
Norm before scaling: 42.58352030036825. Distance: 1.81228064163327
Total norm for 4 adversaries is: 42.58352030036825. distance: 1.81228064163327
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2002, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5487/5777 (94.9801%), train_poison_data_count: 455
Global model norm: 42.58631085302309.
Norm before scaling: 42.571183493796596. Distance: 1.701911493947494
Total norm for 4 adversaries is: 42.571183493796596. distance: 1.701911493947494
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1996, Accuracy: 9395/9900 (94.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4728/5123 (92.2897%), train_poison_data_count: 403
Global model norm: 42.58631085302309.
Norm before scaling: 42.58335690332844. Distance: 1.8376301855563317
Total norm for 4 adversaries is: 42.58335690332844. distance: 1.8376301855563317
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1942, Accuracy: 9401/9900 (94.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5121/5503 (93.0583%), train_poison_data_count: 430
Global model norm: 42.58631085302309.
Norm before scaling: 42.58315623943932. Distance: 1.8697591653051673
Total norm for 4 adversaries is: 42.58315623943932. distance: 1.8697591653051673
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1440, Accuracy: 9535/9900 (96.3131%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4837/5427 (89.1284%)
___Train Local_ResNet_18,  epoch  78, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4892/5427 (90.1419%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0460, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4384/4748 (92.3336%)
___Train Local_ResNet_18,  epoch  78, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4359/4748 (91.8071%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0138, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4907/5645 (86.9265%)
___Train Local_ResNet_18,  epoch  78, local model 54, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4819/5645 (85.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2768, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3575/3910 (91.4322%)
___Train Local_ResNet_18,  epoch  78, local model 63, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3428/3910 (87.6726%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0542, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4633/5224 (88.6868%)
___Train Local_ResNet_18,  epoch  78, local model 94, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4785/5224 (91.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9776, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4612/5068 (91.0024%)
___Train Local_ResNet_18,  epoch  78, local model 10, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4607/5068 (90.9037%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1509, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4580/5086 (90.0511%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4635/5086 (91.1325%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0183, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4889/5489 (89.0690%)
___Train Local_ResNet_18,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4953/5489 (90.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1252, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5512/6235 (88.4042%)
___Train Local_ResNet_18,  epoch  78, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5538/6235 (88.8212%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0809, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4149/4397 (94.3598%)
___Train Local_ResNet_18,  epoch  78, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4187/4397 (95.2240%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7734, Accuracy: 5868/10000 (58.6800%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4450/4929 (90.2820%)
___Train Local_ResNet_18,  epoch  78, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4487/4929 (91.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1073, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 6239/6947 (89.8086%)
___Train Local_ResNet_18,  epoch  78, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6132/6947 (88.2683%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0565, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4278/4731 (90.4249%)
___Train Local_ResNet_18,  epoch  78, local model 55, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4330/4731 (91.5240%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9135, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5281/6080 (86.8586%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5332/6080 (87.6974%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2565, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3188/3552 (89.7523%)
___Train Local_ResNet_18,  epoch  78, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3299/3552 (92.8773%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7999, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4307/4737 (90.9225%)
___Train Local_ResNet_18,  epoch  78, local model 89, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4315/4737 (91.0914%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0078, Accuracy: 5430/10000 (54.3000%)
time spent on training: 279.3515408039093
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1125, Accuracy: 7026/10000 (70.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 2.9093, Accuracy: 4030/9900 (40.7071%)
Done in 306.0345001220703 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 23, 89, 83, 1, 0, 90, 46, 70, 48, 5, 17, 96, 79, 7, 63, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4970/5308 (93.6323%), train_poison_data_count: 415
Global model norm: 42.60785659194059.
Norm before scaling: 42.60450301033698. Distance: 1.7849331305237415
Total norm for 4 adversaries is: 42.60450301033698. distance: 1.7849331305237415
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1836, Accuracy: 9437/9900 (95.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5470/5777 (94.6858%), train_poison_data_count: 455
Global model norm: 42.60785659194059.
Norm before scaling: 42.59658573419867. Distance: 1.7660302566364334
Total norm for 4 adversaries is: 42.59658573419867. distance: 1.7660302566364334
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1974, Accuracy: 9435/9900 (95.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4731/5123 (92.3482%), train_poison_data_count: 403
Global model norm: 42.60785659194059.
Norm before scaling: 42.60134401305609. Distance: 1.8210420906401859
Total norm for 4 adversaries is: 42.60134401305609. distance: 1.8210420906401859
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3778, Accuracy: 8935/9900 (90.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5122/5503 (93.0765%), train_poison_data_count: 430
Global model norm: 42.60785659194059.
Norm before scaling: 42.60260477475233. Distance: 1.8204066698331443
Total norm for 4 adversaries is: 42.60260477475233. distance: 1.8204066698331443
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3261, Accuracy: 9018/9900 (91.0909%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4262/4549 (93.6909%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4261/4549 (93.6689%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.7326, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4278/4737 (90.3103%)
___Train Local_ResNet_18,  epoch  79, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4291/4737 (90.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2351, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3219/3552 (90.6250%)
___Train Local_ResNet_18,  epoch  79, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3310/3552 (93.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8747, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5020/5422 (92.5858%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5029/5422 (92.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9554, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4875/5454 (89.3839%)
___Train Local_ResNet_18,  epoch  79, local model 0, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4755/5454 (87.1837%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0774, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4343/4748 (91.4701%)
___Train Local_ResNet_18,  epoch  79, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4365/4748 (91.9334%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9038, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4652/5399 (86.1641%)
___Train Local_ResNet_18,  epoch  79, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4682/5399 (86.7198%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1400, Accuracy: 5227/10000 (52.2700%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5436/5871 (92.5907%)
___Train Local_ResNet_18,  epoch  79, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5382/5871 (91.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0450, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4472/4830 (92.5880%)
___Train Local_ResNet_18,  epoch  79, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4551/4830 (94.2236%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0899, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4625/4993 (92.6297%)
___Train Local_ResNet_18,  epoch  79, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4666/4993 (93.4508%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8875, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4311/4903 (87.9258%)
___Train Local_ResNet_18,  epoch  79, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4378/4903 (89.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0983, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4601/5086 (90.4640%)
___Train Local_ResNet_18,  epoch  79, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4685/5086 (92.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8650, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3730/4111 (90.7322%)
___Train Local_ResNet_18,  epoch  79, local model 79, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3698/4111 (89.9538%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0915, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4352/4869 (89.3818%)
___Train Local_ResNet_18,  epoch  79, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4185/4869 (85.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.3207, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3538/3910 (90.4859%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3522/3910 (90.0767%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0554, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3733/4175 (89.4132%)
___Train Local_ResNet_18,  epoch  79, local model 39, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3758/4175 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9981, Accuracy: 5456/10000 (54.5600%)
time spent on training: 270.7261905670166
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1179, Accuracy: 7005/10000 (70.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 2.5664, Accuracy: 4563/9900 (46.0909%)
Done in 297.1855642795563 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 44, 30, 66, 73, 76, 81, 22, 46, 17, 34, 96, 31, 95, 40, 53, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4981/5308 (93.8395%), train_poison_data_count: 415
Global model norm: 42.62899197765823.
Norm before scaling: 42.622293604513764. Distance: 1.7549869461878265
Total norm for 4 adversaries is: 42.622293604513764. distance: 1.7549869461878265
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1418, Accuracy: 9554/9900 (96.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5487/5777 (94.9801%), train_poison_data_count: 455
Global model norm: 42.62899197765823.
Norm before scaling: 42.61354891089511. Distance: 1.671996923261303
Total norm for 4 adversaries is: 42.61354891089511. distance: 1.671996923261303
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1178, Accuracy: 9604/9900 (97.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4750/5123 (92.7191%), train_poison_data_count: 403
Global model norm: 42.62899197765823.
Norm before scaling: 42.62198858726341. Distance: 1.790009893251496
Total norm for 4 adversaries is: 42.62198858726341. distance: 1.790009893251496
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2683, Accuracy: 9224/9900 (93.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5149/5503 (93.5671%), train_poison_data_count: 430
Global model norm: 42.62899197765823.
Norm before scaling: 42.62272463455894. Distance: 1.8144984573269403
Total norm for 4 adversaries is: 42.62272463455894. distance: 1.8144984573269403
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.2192, Accuracy: 9340/9900 (94.3434%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4649/5075 (91.6059%)
___Train Local_ResNet_18,  epoch  80, local model 44, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4565/5075 (89.9507%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0510, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3414/3774 (90.4610%)
___Train Local_ResNet_18,  epoch  80, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3519/3774 (93.2432%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8239, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4370/4843 (90.2333%)
___Train Local_ResNet_18,  epoch  80, local model 66, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4423/4843 (91.3277%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0094, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4243/4605 (92.1390%)
___Train Local_ResNet_18,  epoch  80, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4237/4605 (92.0087%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9559, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3485/3959 (88.0273%)
___Train Local_ResNet_18,  epoch  80, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3602/3959 (90.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0376, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4563/5035 (90.6256%)
___Train Local_ResNet_18,  epoch  80, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4627/5035 (91.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0027, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5205/5696 (91.3799%)
___Train Local_ResNet_18,  epoch  80, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5182/5696 (90.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1745, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4657/5399 (86.2567%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4671/5399 (86.5160%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1354, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4342/4903 (88.5580%)
___Train Local_ResNet_18,  epoch  80, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4405/4903 (89.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0624, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4485/4911 (91.3256%)
___Train Local_ResNet_18,  epoch  80, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4509/4911 (91.8143%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0028, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4601/5086 (90.4640%)
___Train Local_ResNet_18,  epoch  80, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4608/5086 (90.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2310, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4124/4537 (90.8971%)
___Train Local_ResNet_18,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4157/4537 (91.6244%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9202, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4455/5018 (88.7804%)
___Train Local_ResNet_18,  epoch  80, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4448/5018 (88.6409%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1287, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5470/5939 (92.1030%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5500/5939 (92.6082%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0214, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5803/6664 (87.0798%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5651/6664 (84.7989%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2336, Accuracy: 4910/10000 (49.1000%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4859/5702 (85.2157%)
___Train Local_ResNet_18,  epoch  80, local model 11, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4551/5702 (79.8141%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2531, Accuracy: 5064/10000 (50.6400%)
time spent on training: 278.49790596961975
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1231, Accuracy: 7002/10000 (70.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.1880, Accuracy: 5225/9900 (52.7778%)
Done in 305.15677976608276 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 69, 64, 10, 24, 15, 54, 35, 59, 42, 72, 84, 92, 73, 76, 29, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5001/5308 (94.2163%), train_poison_data_count: 415
Global model norm: 42.650951193324076.
Norm before scaling: 42.64093990356422. Distance: 1.669112731143447
Total norm for 4 adversaries is: 42.64093990356422. distance: 1.669112731143447
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0993, Accuracy: 9655/9900 (97.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5518/5777 (95.5167%), train_poison_data_count: 455
Global model norm: 42.650951193324076.
Norm before scaling: 42.63210024945625. Distance: 1.6381467721271619
Total norm for 4 adversaries is: 42.63210024945625. distance: 1.6381467721271619
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1044, Accuracy: 9633/9900 (97.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4769/5123 (93.0900%), train_poison_data_count: 403
Global model norm: 42.650951193324076.
Norm before scaling: 42.643723836189395. Distance: 1.7463638813565079
Total norm for 4 adversaries is: 42.643723836189395. distance: 1.7463638813565079
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1748, Accuracy: 9436/9900 (95.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5178/5503 (94.0941%), train_poison_data_count: 430
Global model norm: 42.650951193324076.
Norm before scaling: 42.642392723984926. Distance: 1.7525488139495227
Total norm for 4 adversaries is: 42.642392723984926. distance: 1.7525488139495227
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1711, Accuracy: 9460/9900 (95.5556%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3970/4364 (90.9716%)
___Train Local_ResNet_18,  epoch  81, local model 69, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4009/4364 (91.8653%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9734, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4360/4894 (89.0887%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4378/4894 (89.4565%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9363, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4686/5068 (92.4625%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4618/5068 (91.1208%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1410, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3952/4313 (91.6300%)
___Train Local_ResNet_18,  epoch  81, local model 24, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3973/4313 (92.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8307, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5487/6068 (90.4252%)
___Train Local_ResNet_18,  epoch  81, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5451/6068 (89.8319%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1493, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4972/5645 (88.0779%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4854/5645 (85.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.5995, Accuracy: 4682/10000 (46.8200%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5059/5615 (90.0980%)
___Train Local_ResNet_18,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5049/5615 (89.9199%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0855, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4138/4397 (94.1096%)
___Train Local_ResNet_18,  epoch  81, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4177/4397 (94.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7586, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5335/5907 (90.3166%)
___Train Local_ResNet_18,  epoch  81, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5322/5907 (90.0965%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2986, Accuracy: 4954/10000 (49.5400%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4643/5193 (89.4088%)
___Train Local_ResNet_18,  epoch  81, local model 72, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4440/5193 (85.4997%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.4162, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4669/5209 (89.6333%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4697/5209 (90.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1192, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6263/6812 (91.9407%)
___Train Local_ResNet_18,  epoch  81, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6228/6812 (91.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2017, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4204/4605 (91.2921%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4263/4605 (92.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9557, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3565/3959 (90.0480%)
___Train Local_ResNet_18,  epoch  81, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3655/3959 (92.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0123, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4373/4732 (92.4134%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4419/4732 (93.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9183, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4620/5075 (91.0345%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4649/5075 (91.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0152, Accuracy: 5376/10000 (53.7600%)
time spent on training: 279.3273205757141
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1305, Accuracy: 6974/10000 (69.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 1.8828, Accuracy: 5760/9900 (58.1818%)
Done in 305.8200259208679 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 14, 54, 3, 34, 68, 73, 15, 91, 7, 26, 79, 11, 61, 56, 16, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5009/5308 (94.3670%), train_poison_data_count: 415
Global model norm: 42.67293343615921.
Norm before scaling: 42.66456821367556. Distance: 1.6806526427515498
Total norm for 4 adversaries is: 42.66456821367556. distance: 1.6806526427515498
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2387, Accuracy: 9326/9900 (94.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5513/5777 (95.4302%), train_poison_data_count: 455
Global model norm: 42.67293343615921.
Norm before scaling: 42.65325367223613. Distance: 1.5947355327365595
Total norm for 4 adversaries is: 42.65325367223613. distance: 1.5947355327365595
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1398, Accuracy: 9553/9900 (96.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4799/5123 (93.6756%), train_poison_data_count: 403
Global model norm: 42.67293343615921.
Norm before scaling: 42.66305749251189. Distance: 1.673247442485474
Total norm for 4 adversaries is: 42.66305749251189. distance: 1.673247442485474
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.4110, Accuracy: 8931/9900 (90.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5150/5503 (93.5853%), train_poison_data_count: 430
Global model norm: 42.67293343615921.
Norm before scaling: 42.66552955383743. Distance: 1.7660417318154726
Total norm for 4 adversaries is: 42.66552955383743. distance: 1.7660417318154726
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.3108, Accuracy: 9083/9900 (91.7475%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3934/4196 (93.7560%)
___Train Local_ResNet_18,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3973/4196 (94.6854%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8639, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4993/5645 (88.4500%)
___Train Local_ResNet_18,  epoch  82, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4862/5645 (86.1293%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1856, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4932/5346 (92.2559%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4888/5346 (91.4328%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1525, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4456/4911 (90.7351%)
___Train Local_ResNet_18,  epoch  82, local model 34, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4434/4911 (90.2871%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0967, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3298/3589 (91.8919%)
___Train Local_ResNet_18,  epoch  82, local model 68, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3150/3589 (87.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0131, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4257/4605 (92.4430%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4329/4605 (94.0065%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9039, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5533/6068 (91.1833%)
___Train Local_ResNet_18,  epoch  82, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5521/6068 (90.9855%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1317, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4045/4527 (89.3528%)
___Train Local_ResNet_18,  epoch  82, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4011/4527 (88.6017%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9027, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4376/4869 (89.8747%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4204/4869 (86.3422%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.7087, Accuracy: 4662/10000 (46.6200%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3744/4086 (91.6300%)
___Train Local_ResNet_18,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3827/4086 (93.6613%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9180, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3727/4111 (90.6592%)
___Train Local_ResNet_18,  epoch  82, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3738/4111 (90.9268%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2900, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4852/5702 (85.0929%)
___Train Local_ResNet_18,  epoch  82, local model 11, internal_epoch   2,  Average loss: 0.0118, Accuracy: 4410/5702 (77.3413%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1623, Accuracy: 4989/10000 (49.8900%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4100/4485 (91.4158%)
___Train Local_ResNet_18,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4088/4485 (91.1483%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0255, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4878/5427 (89.8839%)
___Train Local_ResNet_18,  epoch  82, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4854/5427 (89.4417%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9168, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4826/5353 (90.1551%)
___Train Local_ResNet_18,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4819/5353 (90.0243%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0990, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4850/5489 (88.3585%)
___Train Local_ResNet_18,  epoch  82, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4967/5489 (90.4901%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0588, Accuracy: 5318/10000 (53.1800%)
time spent on training: 273.4143524169922
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1308, Accuracy: 6971/10000 (69.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 1.7117, Accuracy: 6081/9900 (61.4242%)
Done in 299.4681031703949 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 46, 78, 3, 7, 8, 74, 87, 47, 38, 94, 25, 49, 44, 70, 40, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5037/5308 (94.8945%), train_poison_data_count: 415
Global model norm: 42.695710628290136.
Norm before scaling: 42.68275132582467. Distance: 1.623453211042879
Total norm for 4 adversaries is: 42.68275132582467. distance: 1.623453211042879
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1014, Accuracy: 9649/9900 (97.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5526/5777 (95.6552%), train_poison_data_count: 455
Global model norm: 42.695710628290136.
Norm before scaling: 42.67726702934186. Distance: 1.599989476765359
Total norm for 4 adversaries is: 42.67726702934186. distance: 1.599989476765359
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1298, Accuracy: 9567/9900 (96.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4798/5123 (93.6561%), train_poison_data_count: 403
Global model norm: 42.695710628290136.
Norm before scaling: 42.685882850499446. Distance: 1.6799351709209835
Total norm for 4 adversaries is: 42.685882850499446. distance: 1.6799351709209835
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.4424, Accuracy: 8813/9900 (89.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5185/5503 (94.2213%), train_poison_data_count: 430
Global model norm: 42.695710628290136.
Norm before scaling: 42.68661350653446. Distance: 1.734676712873974
Total norm for 4 adversaries is: 42.68661350653446. distance: 1.734676712873974
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0505, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4754/5399 (88.0533%)
___Train Local_ResNet_18,  epoch  83, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4739/5399 (87.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2158, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4030/4368 (92.2619%)
___Train Local_ResNet_18,  epoch  83, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3986/4368 (91.2546%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9562, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4932/5346 (92.2559%)
___Train Local_ResNet_18,  epoch  83, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5000/5346 (93.5279%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0177, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4390/4869 (90.1623%)
___Train Local_ResNet_18,  epoch  83, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4183/4869 (85.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3149, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4411/4889 (90.2229%)
___Train Local_ResNet_18,  epoch  83, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4468/4889 (91.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9131, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4291/4797 (89.4517%)
___Train Local_ResNet_18,  epoch  83, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4282/4797 (89.2641%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0045, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3527/3995 (88.2854%)
___Train Local_ResNet_18,  epoch  83, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3603/3995 (90.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0041, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4562/5123 (89.0494%)
___Train Local_ResNet_18,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4555/5123 (88.9127%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3738, Accuracy: 4990/10000 (49.9000%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5497/6235 (88.1636%)
___Train Local_ResNet_18,  epoch  83, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5474/6235 (87.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2374, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4619/5224 (88.4188%)
___Train Local_ResNet_18,  epoch  83, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4684/5224 (89.6631%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9702, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5651/6419 (88.0355%)
___Train Local_ResNet_18,  epoch  83, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5533/6419 (86.1972%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.5340, Accuracy: 4850/10000 (48.5000%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5011/5652 (88.6589%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5000/5652 (88.4643%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0781, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4658/5075 (91.7833%)
___Train Local_ResNet_18,  epoch  83, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4630/5075 (91.2315%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9571, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5422/5871 (92.3522%)
___Train Local_ResNet_18,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5420/5871 (92.3182%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0133, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5455/5939 (91.8505%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5398/5939 (90.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0295, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4875/5454 (89.3839%)
___Train Local_ResNet_18,  epoch  83, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4884/5454 (89.5490%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1023, Accuracy: 5401/10000 (54.0100%)
time spent on training: 281.93371534347534
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1374, Accuracy: 6958/10000 (69.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.5132, Accuracy: 6466/9900 (65.3131%)
Done in 308.57328367233276 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 80, 3, 45, 6, 57, 22, 68, 38, 76, 26, 41, 98, 61, 0, 1, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5040/5308 (94.9510%), train_poison_data_count: 415
Global model norm: 42.720020155312575.
Norm before scaling: 42.70746410446744. Distance: 1.6285200141377274
Total norm for 4 adversaries is: 42.70746410446744. distance: 1.6285200141377274
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1507, Accuracy: 9512/9900 (96.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5522/5777 (95.5859%), train_poison_data_count: 455
Global model norm: 42.720020155312575.
Norm before scaling: 42.70036638089303. Distance: 1.6186220007996859
Total norm for 4 adversaries is: 42.70036638089303. distance: 1.6186220007996859
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1187, Accuracy: 9607/9900 (97.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4807/5123 (93.8317%), train_poison_data_count: 403
Global model norm: 42.720020155312575.
Norm before scaling: 42.70988500738149. Distance: 1.666286504621765
Total norm for 4 adversaries is: 42.70988500738149. distance: 1.666286504621765
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3544, Accuracy: 9039/9900 (91.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5163/5503 (93.8216%), train_poison_data_count: 430
Global model norm: 42.720020155312575.
Norm before scaling: 42.71264015377942. Distance: 1.7581860632790036
Total norm for 4 adversaries is: 42.71264015377942. distance: 1.7581860632790036
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1527, Accuracy: 9505/9900 (96.0101%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4951/5461 (90.6611%)
___Train Local_ResNet_18,  epoch  84, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4913/5461 (89.9652%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2793, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4932/5346 (92.2559%)
___Train Local_ResNet_18,  epoch  84, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4943/5346 (92.4617%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9311, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4931/5489 (89.8342%)
___Train Local_ResNet_18,  epoch  84, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4950/5489 (90.1804%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0385, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4508/4929 (91.4587%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4487/4929 (91.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0302, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4525/4956 (91.3035%)
___Train Local_ResNet_18,  epoch  84, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4552/4956 (91.8483%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0487, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5171/5696 (90.7830%)
___Train Local_ResNet_18,  epoch  84, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5135/5696 (90.1510%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0031, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3273/3589 (91.1953%)
___Train Local_ResNet_18,  epoch  84, local model 68, internal_epoch   2,  Average loss: 0.0095, Accuracy: 2968/3589 (82.6971%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2676, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5531/6235 (88.7089%)
___Train Local_ResNet_18,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5543/6235 (88.9014%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2402, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3533/3959 (89.2397%)
___Train Local_ResNet_18,  epoch  84, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3618/3959 (91.3867%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9308, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3741/4086 (91.5565%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3871/4086 (94.7381%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9334, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4355/4714 (92.3844%)
___Train Local_ResNet_18,  epoch  84, local model 41, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4340/4714 (92.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0119, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3823/4161 (91.8770%)
___Train Local_ResNet_18,  epoch  84, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3808/4161 (91.5165%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2808, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4106/4485 (91.5496%)
___Train Local_ResNet_18,  epoch  84, local model 61, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3982/4485 (88.7848%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1298, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4959/5454 (90.9241%)
___Train Local_ResNet_18,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4965/5454 (91.0341%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9663, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5049/5422 (93.1206%)
___Train Local_ResNet_18,  epoch  84, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5050/5422 (93.1391%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9153, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4600/5122 (89.8087%)
___Train Local_ResNet_18,  epoch  84, local model 28, internal_epoch   2,  Average loss: 0.0089, Accuracy: 4249/5122 (82.9559%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3337, Accuracy: 4882/10000 (48.8200%)
time spent on training: 284.898503780365
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1424, Accuracy: 6941/10000 (69.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.3187, Accuracy: 6844/9900 (69.1313%)
Done in 311.24501514434814 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 47, 12, 88, 79, 31, 29, 65, 32, 92, 8, 20, 41, 52, 61, 39, 64].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5044/5308 (95.0264%), train_poison_data_count: 415
Global model norm: 42.74267515372517.
Norm before scaling: 42.72944727073473. Distance: 1.6077918997613567
Total norm for 4 adversaries is: 42.72944727073473. distance: 1.6077918997613567
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1223, Accuracy: 9581/9900 (96.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5527/5777 (95.6725%), train_poison_data_count: 455
Global model norm: 42.74267515372517.
Norm before scaling: 42.72236891446988. Distance: 1.5828789594429489
Total norm for 4 adversaries is: 42.72236891446988. distance: 1.5828789594429489
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2269, Accuracy: 9346/9900 (94.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4792/5123 (93.5389%), train_poison_data_count: 403
Global model norm: 42.74267515372517.
Norm before scaling: 42.73024288752128. Distance: 1.6586272974345515
Total norm for 4 adversaries is: 42.73024288752128. distance: 1.6586272974345515
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.3287, Accuracy: 9163/9900 (92.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5196/5503 (94.4212%), train_poison_data_count: 430
Global model norm: 42.74267515372517.
Norm before scaling: 42.73039001072597. Distance: 1.6994712203558344
Total norm for 4 adversaries is: 42.73039001072597. distance: 1.6994712203558344
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1560, Accuracy: 9491/9900 (95.8687%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4586/5123 (89.5179%)
___Train Local_ResNet_18,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4459/5123 (87.0388%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9814, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4933/5526 (89.2689%)
___Train Local_ResNet_18,  epoch  85, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4929/5526 (89.1965%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0757, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4928/5362 (91.9060%)
___Train Local_ResNet_18,  epoch  85, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4869/5362 (90.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1572, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3780/4111 (91.9484%)
___Train Local_ResNet_18,  epoch  85, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3795/4111 (92.3133%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9501, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4163/4537 (91.7567%)
___Train Local_ResNet_18,  epoch  85, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4207/4537 (92.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8988, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4415/4732 (93.3009%)
___Train Local_ResNet_18,  epoch  85, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4476/4732 (94.5900%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8099, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4961/5497 (90.2492%)
___Train Local_ResNet_18,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4947/5497 (89.9945%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1368, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5356/6080 (88.0921%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5300/6080 (87.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0570, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6275/6812 (92.1169%)
___Train Local_ResNet_18,  epoch  85, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6231/6812 (91.4709%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0954, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4447/4889 (90.9593%)
___Train Local_ResNet_18,  epoch  85, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4416/4889 (90.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9761, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4324/4714 (91.7268%)
___Train Local_ResNet_18,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4392/4714 (93.1693%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8857, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4301/4714 (91.2389%)
___Train Local_ResNet_18,  epoch  85, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4363/4714 (92.5541%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1130, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3792/4130 (91.8160%)
___Train Local_ResNet_18,  epoch  85, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3822/4130 (92.5424%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9160, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4070/4485 (90.7469%)
___Train Local_ResNet_18,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3963/4485 (88.3612%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2393, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3738/4175 (89.5329%)
___Train Local_ResNet_18,  epoch  85, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3746/4175 (89.7246%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0105, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4358/4894 (89.0478%)
___Train Local_ResNet_18,  epoch  85, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4342/4894 (88.7209%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0679, Accuracy: 5420/10000 (54.2000%)
time spent on training: 273.575528383255
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1460, Accuracy: 6943/10000 (69.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.1649, Accuracy: 7160/9900 (72.3232%)
Done in 299.91243171691895 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 88, 39, 63, 20, 24, 15, 83, 29, 97, 50, 96, 1, 57, 30, 10, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5036/5308 (94.8757%), train_poison_data_count: 415
Global model norm: 42.764787224621934.
Norm before scaling: 42.75083378207377. Distance: 1.6159430982042378
Total norm for 4 adversaries is: 42.75083378207377. distance: 1.6159430982042378
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1537, Accuracy: 9520/9900 (96.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5549/5777 (96.0533%), train_poison_data_count: 455
Global model norm: 42.764787224621934.
Norm before scaling: 42.74224104936327. Distance: 1.5434697750136266
Total norm for 4 adversaries is: 42.74224104936327. distance: 1.5434697750136266
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1744, Accuracy: 9468/9900 (95.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4811/5123 (93.9098%), train_poison_data_count: 403
Global model norm: 42.764787224621934.
Norm before scaling: 42.753414976905646. Distance: 1.6542680505900864
Total norm for 4 adversaries is: 42.753414976905646. distance: 1.6542680505900864
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.2218, Accuracy: 9351/9900 (94.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5222/5503 (94.8937%), train_poison_data_count: 430
Global model norm: 42.764787224621934.
Norm before scaling: 42.753038086491586. Distance: 1.67674515752177
Total norm for 4 adversaries is: 42.753038086491586. distance: 1.67674515752177
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1026, Accuracy: 9628/9900 (97.2525%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4927/5362 (91.8874%)
___Train Local_ResNet_18,  epoch  86, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4900/5362 (91.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9725, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3753/4175 (89.8922%)
___Train Local_ResNet_18,  epoch  86, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3796/4175 (90.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0729, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3623/3910 (92.6598%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3583/3910 (91.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0916, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4337/4714 (92.0025%)
___Train Local_ResNet_18,  epoch  86, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4415/4714 (93.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.7833, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3925/4313 (91.0039%)
___Train Local_ResNet_18,  epoch  86, local model 24, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3987/4313 (92.4415%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8421, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5524/6068 (91.0349%)
___Train Local_ResNet_18,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5551/6068 (91.4799%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0490, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3224/3552 (90.7658%)
___Train Local_ResNet_18,  epoch  86, local model 83, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3267/3552 (91.9764%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8680, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4376/4732 (92.4768%)
___Train Local_ResNet_18,  epoch  86, local model 29, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4450/4732 (94.0406%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8018, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4214/4736 (88.9780%)
___Train Local_ResNet_18,  epoch  86, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4255/4736 (89.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0545, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4355/4757 (91.5493%)
___Train Local_ResNet_18,  epoch  86, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4339/4757 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9974, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4595/5086 (90.3460%)
___Train Local_ResNet_18,  epoch  86, local model 96, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4617/5086 (90.7786%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0583, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5034/5422 (92.8440%)
___Train Local_ResNet_18,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5010/5422 (92.4013%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9874, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4575/4956 (92.3123%)
___Train Local_ResNet_18,  epoch  86, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4539/4956 (91.5860%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1615, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3482/3774 (92.2629%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3559/3774 (94.3031%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8519, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4679/5068 (92.3244%)
___Train Local_ResNet_18,  epoch  86, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4689/5068 (92.5217%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0696, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4925/5346 (92.1250%)
___Train Local_ResNet_18,  epoch  86, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4933/5346 (92.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0157, Accuracy: 5362/10000 (53.6200%)
time spent on training: 272.60665678977966
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1583, Accuracy: 6920/10000 (69.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.9818, Accuracy: 7582/9900 (76.5859%)
Done in 298.8873782157898 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 47, 33, 81, 59, 32, 96, 60, 88, 7, 69, 95, 21, 51, 35, 93, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5029/5308 (94.7438%), train_poison_data_count: 415
Global model norm: 42.784875040445804.
Norm before scaling: 42.77138622364475. Distance: 1.5918415086725533
Total norm for 4 adversaries is: 42.77138622364475. distance: 1.5918415086725533
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2186, Accuracy: 9346/9900 (94.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5547/5777 (96.0187%), train_poison_data_count: 455
Global model norm: 42.784875040445804.
Norm before scaling: 42.7616072395664. Distance: 1.5219493933947632
Total norm for 4 adversaries is: 42.7616072395664. distance: 1.5219493933947632
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1045, Accuracy: 9637/9900 (97.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4810/5123 (93.8903%), train_poison_data_count: 403
Global model norm: 42.784875040445804.
Norm before scaling: 42.77014185363064. Distance: 1.5930354442544588
Total norm for 4 adversaries is: 42.77014185363064. distance: 1.5930354442544588
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0985, Accuracy: 9635/9900 (97.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5227/5503 (94.9846%), train_poison_data_count: 430
Global model norm: 42.784875040445804.
Norm before scaling: 42.76948825946556. Distance: 1.6120031434116053
Total norm for 4 adversaries is: 42.76948825946556. distance: 1.6120031434116053
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3280, Accuracy: 9096/9900 (91.8788%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4623/5123 (90.2401%)
___Train Local_ResNet_18,  epoch  87, local model 47, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4446/5123 (86.7851%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1893, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4303/4818 (89.3109%)
___Train Local_ResNet_18,  epoch  87, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4274/4818 (88.7090%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0440, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4596/5035 (91.2810%)
___Train Local_ResNet_18,  epoch  87, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4624/5035 (91.8371%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0408, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4169/4397 (94.8146%)
___Train Local_ResNet_18,  epoch  87, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8270, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5289/6080 (86.9901%)
___Train Local_ResNet_18,  epoch  87, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5286/6080 (86.9408%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2158, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4621/5086 (90.8573%)
___Train Local_ResNet_18,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4659/5086 (91.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0359, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3795/4145 (91.5561%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3791/4145 (91.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1094, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4850/5362 (90.4513%)
___Train Local_ResNet_18,  epoch  87, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4879/5362 (90.9922%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0947, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4360/4869 (89.5461%)
___Train Local_ResNet_18,  epoch  87, local model 7, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4054/4869 (83.2614%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2668, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3947/4364 (90.4445%)
___Train Local_ResNet_18,  epoch  87, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4000/4364 (91.6590%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8563, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4438/5018 (88.4416%)
___Train Local_ResNet_18,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4481/5018 (89.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2461, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4585/5038 (91.0083%)
___Train Local_ResNet_18,  epoch  87, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4644/5038 (92.1794%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.8735, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3783/4108 (92.0886%)
___Train Local_ResNet_18,  epoch  87, local model 51, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3741/4108 (91.0662%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0585, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5055/5615 (90.0267%)
___Train Local_ResNet_18,  epoch  87, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5064/5615 (90.1870%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2439, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4555/5055 (90.1088%)
___Train Local_ResNet_18,  epoch  87, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4507/5055 (89.1592%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1036, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4286/4797 (89.3475%)
___Train Local_ResNet_18,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4308/4797 (89.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0800, Accuracy: 5353/10000 (53.5300%)
time spent on training: 276.1719446182251
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1606, Accuracy: 6908/10000 (69.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.8786, Accuracy: 7824/9900 (79.0303%)
Done in 302.492933511734 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 91, 26, 17, 2, 35, 90, 19, 77, 49, 55, 42, 94, 76, 73, 74, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5079/5308 (95.6858%), train_poison_data_count: 415
Global model norm: 42.80690542825713.
Norm before scaling: 42.792055736780014. Distance: 1.55745209683004
Total norm for 4 adversaries is: 42.792055736780014. distance: 1.55745209683004
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1085, Accuracy: 9590/9900 (96.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5518/5777 (95.5167%), train_poison_data_count: 455
Global model norm: 42.80690542825713.
Norm before scaling: 42.787638196351466. Distance: 1.6133895726818508
Total norm for 4 adversaries is: 42.787638196351466. distance: 1.6133895726818508
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0914, Accuracy: 9663/9900 (97.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4823/5123 (94.1441%), train_poison_data_count: 403
Global model norm: 42.80690542825713.
Norm before scaling: 42.793243844677164. Distance: 1.621924791692644
Total norm for 4 adversaries is: 42.793243844677164. distance: 1.621924791692644
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1542, Accuracy: 9481/9900 (95.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5210/5503 (94.6756%), train_poison_data_count: 430
Global model norm: 42.80690542825713.
Norm before scaling: 42.79375872873067. Distance: 1.6649046723395022
Total norm for 4 adversaries is: 42.79375872873067. distance: 1.6649046723395022
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0679, Accuracy: 9718/9900 (98.1616%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4069/4527 (89.8829%)
___Train Local_ResNet_18,  epoch  88, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4038/4527 (89.1981%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0634, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3805/4086 (93.1229%)
___Train Local_ResNet_18,  epoch  88, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3797/4086 (92.9271%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9609, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4357/4903 (88.8640%)
___Train Local_ResNet_18,  epoch  88, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4418/4903 (90.1081%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1694, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3626/3968 (91.3810%)
___Train Local_ResNet_18,  epoch  88, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3678/3968 (92.6915%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.7686, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5102/5615 (90.8638%)
___Train Local_ResNet_18,  epoch  88, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5088/5615 (90.6144%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0416, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4419/4748 (93.0708%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4376/4748 (92.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0219, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4859/5361 (90.6361%)
___Train Local_ResNet_18,  epoch  88, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4822/5361 (89.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1099, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4452/5050 (88.1584%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4547/5050 (90.0396%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0809, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5044/5652 (89.2427%)
___Train Local_ResNet_18,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5010/5652 (88.6412%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1500, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4342/4731 (91.7776%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4344/4731 (91.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9552, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5309/5907 (89.8764%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5298/5907 (89.6902%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.4864, Accuracy: 4869/10000 (48.6900%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4658/5224 (89.1654%)
___Train Local_ResNet_18,  epoch  88, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4698/5224 (89.9311%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0708, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3576/3959 (90.3258%)
___Train Local_ResNet_18,  epoch  88, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3632/3959 (91.7403%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8417, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4287/4605 (93.0945%)
___Train Local_ResNet_18,  epoch  88, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4304/4605 (93.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9475, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4331/4797 (90.2856%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4279/4797 (89.2016%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9701, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5240/5696 (91.9944%)
___Train Local_ResNet_18,  epoch  88, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5198/5696 (91.2570%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0895, Accuracy: 5325/10000 (53.2500%)
time spent on training: 275.8302788734436
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1613, Accuracy: 6924/10000 (69.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.8372, Accuracy: 7894/9900 (79.7374%)
Done in 302.21593976020813 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 59, 78, 62, 30, 12, 24, 43, 89, 46, 60, 90, 77, 95, 53, 69, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5043/5308 (95.0075%), train_poison_data_count: 415
Global model norm: 42.82865799102862.
Norm before scaling: 42.814920666055485. Distance: 1.595394856478293
Total norm for 4 adversaries is: 42.814920666055485. distance: 1.595394856478293
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0623, Accuracy: 9731/9900 (98.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5537/5777 (95.8456%), train_poison_data_count: 455
Global model norm: 42.82865799102862.
Norm before scaling: 42.8067172189424. Distance: 1.570485954763524
Total norm for 4 adversaries is: 42.8067172189424. distance: 1.570485954763524
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1748, Accuracy: 9455/9900 (95.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4818/5123 (94.0465%), train_poison_data_count: 403
Global model norm: 42.82865799102862.
Norm before scaling: 42.81288634634072. Distance: 1.566698004361829
Total norm for 4 adversaries is: 42.81288634634072. distance: 1.566698004361829
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2783, Accuracy: 9226/9900 (93.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5212/5503 (94.7120%), train_poison_data_count: 430
Global model norm: 42.82865799102862.
Norm before scaling: 42.81182281626843. Distance: 1.6129124845731233
Total norm for 4 adversaries is: 42.81182281626843. distance: 1.6129124845731233
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1316, Accuracy: 9576/9900 (96.7273%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4181/4397 (95.0876%)
___Train Local_ResNet_18,  epoch  89, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4177/4397 (94.9966%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7916, Accuracy: 5881/10000 (58.8100%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4025/4368 (92.1474%)
___Train Local_ResNet_18,  epoch  89, local model 78, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4002/4368 (91.6209%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9897, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4801/5504 (87.2275%)
___Train Local_ResNet_18,  epoch  89, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4843/5504 (87.9906%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1362, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3453/3774 (91.4944%)
___Train Local_ResNet_18,  epoch  89, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3498/3774 (92.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9938, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4977/5526 (90.0651%)
___Train Local_ResNet_18,  epoch  89, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4888/5526 (88.4546%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1881, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3978/4313 (92.2328%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3988/4313 (92.4646%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8943, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4486/4979 (90.0984%)
___Train Local_ResNet_18,  epoch  89, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4550/4979 (91.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0429, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4297/4737 (90.7114%)
___Train Local_ResNet_18,  epoch  89, local model 89, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4335/4737 (91.5136%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1619, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4785/5399 (88.6275%)
___Train Local_ResNet_18,  epoch  89, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4711/5399 (87.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1317, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3783/4145 (91.2666%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3815/4145 (92.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9649, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4431/4748 (93.3235%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4363/4748 (91.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0733, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4489/5050 (88.8911%)
___Train Local_ResNet_18,  epoch  89, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4528/5050 (89.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0309, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4436/5018 (88.4018%)
___Train Local_ResNet_18,  epoch  89, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4479/5018 (89.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1065, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5881/6664 (88.2503%)
___Train Local_ResNet_18,  epoch  89, local model 53, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5701/6664 (85.5492%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.3465, Accuracy: 4874/10000 (48.7400%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3995/4364 (91.5445%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4063/4364 (93.1027%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7404, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3924/4196 (93.5176%)
___Train Local_ResNet_18,  epoch  89, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3938/4196 (93.8513%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.7861, Accuracy: 5909/10000 (59.0900%)
time spent on training: 274.13365864753723
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1619, Accuracy: 6913/10000 (69.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.7719, Accuracy: 8033/9900 (81.1414%)
Done in 300.4566023349762 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 6, 84, 86, 33, 22, 12, 42, 56, 72, 93, 82, 28, 78, 39, 99, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5056/5308 (95.2524%), train_poison_data_count: 415
Global model norm: 42.848402487177104.
Norm before scaling: 42.833045651747526. Distance: 1.581900282725205
Total norm for 4 adversaries is: 42.833045651747526. distance: 1.581900282725205
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0434, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5529/5777 (95.7071%), train_poison_data_count: 455
Global model norm: 42.848402487177104.
Norm before scaling: 42.827631906136254. Distance: 1.5669401785673307
Total norm for 4 adversaries is: 42.827631906136254. distance: 1.5669401785673307
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0728, Accuracy: 9718/9900 (98.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4859/5123 (94.8468%), train_poison_data_count: 403
Global model norm: 42.848402487177104.
Norm before scaling: 42.83461164850365. Distance: 1.5664971912649857
Total norm for 4 adversaries is: 42.83461164850365. distance: 1.5664971912649857
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2615, Accuracy: 9223/9900 (93.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5227/5503 (94.9846%), train_poison_data_count: 430
Global model norm: 42.848402487177104.
Norm before scaling: 42.832425791901514. Distance: 1.6159363112835339
Total norm for 4 adversaries is: 42.832425791901514. distance: 1.6159363112835339
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1043, Accuracy: 9613/9900 (97.1010%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4512/4929 (91.5399%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4446/4929 (90.2009%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3764, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4680/5209 (89.8445%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4656/5209 (89.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0424, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3532/3929 (89.8956%)
___Train Local_ResNet_18,  epoch  90, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3560/3929 (90.6083%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8770, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4364/4818 (90.5770%)
___Train Local_ResNet_18,  epoch  90, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4338/4818 (90.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0138, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5245/5696 (92.0822%)
___Train Local_ResNet_18,  epoch  90, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5205/5696 (91.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9474, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4989/5526 (90.2823%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4861/5526 (87.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0317, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5362/5907 (90.7737%)
___Train Local_ResNet_18,  epoch  90, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5406/5907 (91.5185%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3427, Accuracy: 5005/10000 (50.0500%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4850/5427 (89.3680%)
___Train Local_ResNet_18,  epoch  90, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4867/5427 (89.6812%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9581, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4716/5193 (90.8146%)
___Train Local_ResNet_18,  epoch  90, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4591/5193 (88.4075%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1301, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4546/5055 (89.9308%)
___Train Local_ResNet_18,  epoch  90, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4564/5055 (90.2868%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0694, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4902/5298 (92.5255%)
___Train Local_ResNet_18,  epoch  90, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4902/5298 (92.5255%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9677, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4556/5122 (88.9496%)
___Train Local_ResNet_18,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4191/5122 (81.8235%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.2492, Accuracy: 4902/10000 (49.0200%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4058/4368 (92.9029%)
___Train Local_ResNet_18,  epoch  90, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4065/4368 (93.0632%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9158, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3765/4175 (90.1796%)
___Train Local_ResNet_18,  epoch  90, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0945, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4372/4851 (90.1257%)
___Train Local_ResNet_18,  epoch  90, local model 99, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4370/4851 (90.0845%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0355, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4867/5353 (90.9210%)
___Train Local_ResNet_18,  epoch  90, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4815/5353 (89.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9597, Accuracy: 5406/10000 (54.0600%)
time spent on training: 277.981458902359
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1699, Accuracy: 6890/10000 (68.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.6797, Accuracy: 8214/9900 (82.9697%)
Done in 304.65119886398315 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 56, 54, 18, 92, 50, 11, 82, 27, 16, 4, 75, 29, 52, 67, 62, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5070/5308 (95.5162%), train_poison_data_count: 415
Global model norm: 42.87165165496893.
Norm before scaling: 42.85590437779913. Distance: 1.5557331038753963
Total norm for 4 adversaries is: 42.85590437779913. distance: 1.5557331038753963
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0832, Accuracy: 9671/9900 (97.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5549/5777 (96.0533%), train_poison_data_count: 455
Global model norm: 42.87165165496893.
Norm before scaling: 42.84654497174335. Distance: 1.5263732792884674
Total norm for 4 adversaries is: 42.84654497174335. distance: 1.5263732792884674
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0543, Accuracy: 9762/9900 (98.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4863/5123 (94.9248%), train_poison_data_count: 403
Global model norm: 42.87165165496893.
Norm before scaling: 42.85209163871117. Distance: 1.5169953119435604
Total norm for 4 adversaries is: 42.85209163871117. distance: 1.5169953119435604
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1625, Accuracy: 9493/9900 (95.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5244/5503 (95.2935%), train_poison_data_count: 430
Global model norm: 42.87165165496893.
Norm before scaling: 42.85509685173836. Distance: 1.5915333910095906
Total norm for 4 adversaries is: 42.85509685173836. distance: 1.5915333910095906
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0690, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4878/5427 (89.8839%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4893/5427 (90.1603%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0508, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4994/5645 (88.4677%)
___Train Local_ResNet_18,  epoch  91, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4954/5645 (87.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2411, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3881/4249 (91.3391%)
___Train Local_ResNet_18,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3901/4249 (91.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9832, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6236/6812 (91.5443%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6173/6812 (90.6195%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0646, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4353/4757 (91.5073%)
___Train Local_ResNet_18,  epoch  91, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4311/4757 (90.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0412, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4910/5702 (86.1101%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4865/5702 (85.3209%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.2738, Accuracy: 4942/10000 (49.4200%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4920/5298 (92.8652%)
___Train Local_ResNet_18,  epoch  91, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4938/5298 (93.2050%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0792, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4138/4587 (90.2115%)
___Train Local_ResNet_18,  epoch  91, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4176/4587 (91.0399%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1169, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4804/5353 (89.7441%)
___Train Local_ResNet_18,  epoch  91, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4756/5353 (88.8474%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0994, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3703/4028 (91.9315%)
___Train Local_ResNet_18,  epoch  91, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3697/4028 (91.7825%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7774, Accuracy: 5860/10000 (58.6000%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4288/4672 (91.7808%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4316/4672 (92.3801%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9154, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4400/4732 (92.9839%)
___Train Local_ResNet_18,  epoch  91, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4432/4732 (93.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9541, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3795/4130 (91.8886%)
___Train Local_ResNet_18,  epoch  91, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3815/4130 (92.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9007, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4928/5559 (88.6490%)
___Train Local_ResNet_18,  epoch  91, local model 67, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4865/5559 (87.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1862, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4803/5504 (87.2638%)
___Train Local_ResNet_18,  epoch  91, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4851/5504 (88.1359%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1149, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4594/5123 (89.6740%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4347/5123 (84.8526%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1159, Accuracy: 5191/10000 (51.9100%)
time spent on training: 277.1318438053131
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1708, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.6290, Accuracy: 8338/9900 (84.2222%)
Done in 303.6890459060669 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 74, 10, 82, 34, 43, 23, 33, 1, 44, 19, 63, 0, 28, 54, 70, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5083/5308 (95.7611%), train_poison_data_count: 415
Global model norm: 42.89474877716677.
Norm before scaling: 42.87491316272183. Distance: 1.5024587030812933
Total norm for 4 adversaries is: 42.87491316272183. distance: 1.5024587030812933
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0379, Accuracy: 9797/9900 (98.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5566/5777 (96.3476%), train_poison_data_count: 455
Global model norm: 42.89474877716677.
Norm before scaling: 42.869847825004726. Distance: 1.4723366307043269
Total norm for 4 adversaries is: 42.869847825004726. distance: 1.4723366307043269
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2467, Accuracy: 9344/9900 (94.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4857/5123 (94.8077%), train_poison_data_count: 403
Global model norm: 42.89474877716677.
Norm before scaling: 42.87927046881162. Distance: 1.5565931439786531
Total norm for 4 adversaries is: 42.87927046881162. distance: 1.5565931439786531
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1525, Accuracy: 9483/9900 (95.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5231/5503 (95.0572%), train_poison_data_count: 430
Global model norm: 42.89474877716677.
Norm before scaling: 42.87733457565314. Distance: 1.5922719047717906
Total norm for 4 adversaries is: 42.87733457565314. distance: 1.5922719047717906
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2214, Accuracy: 9350/9900 (94.4444%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4255/4797 (88.7013%)
___Train Local_ResNet_18,  epoch  92, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4269/4797 (88.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9883, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4676/5068 (92.2652%)
___Train Local_ResNet_18,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4678/5068 (92.3047%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9890, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4932/5298 (93.0917%)
___Train Local_ResNet_18,  epoch  92, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4917/5298 (92.8086%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0575, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4475/4911 (91.1220%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4547/4911 (92.5881%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1016, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4492/4979 (90.2189%)
___Train Local_ResNet_18,  epoch  92, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4554/4979 (91.4641%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0143, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4259/4549 (93.6250%)
___Train Local_ResNet_18,  epoch  92, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4140/4549 (91.0090%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8653, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4393/4818 (91.1789%)
___Train Local_ResNet_18,  epoch  92, local model 33, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4306/4818 (89.3732%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1254, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5056/5422 (93.2497%)
___Train Local_ResNet_18,  epoch  92, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5075/5422 (93.6001%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8899, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4660/5075 (91.8227%)
___Train Local_ResNet_18,  epoch  92, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4651/5075 (91.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0553, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4820/5361 (89.9086%)
___Train Local_ResNet_18,  epoch  92, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4793/5361 (89.4050%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0656, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3564/3910 (91.1509%)
___Train Local_ResNet_18,  epoch  92, local model 63, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3506/3910 (89.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0951, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4930/5454 (90.3924%)
___Train Local_ResNet_18,  epoch  92, local model 0, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4799/5454 (87.9905%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0554, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4529/5122 (88.4225%)
___Train Local_ResNet_18,  epoch  92, local model 28, internal_epoch   2,  Average loss: 0.0088, Accuracy: 4274/5122 (83.4440%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.3650, Accuracy: 4852/10000 (48.5200%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4995/5645 (88.4854%)
___Train Local_ResNet_18,  epoch  92, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4971/5645 (88.0602%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2498, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5417/5871 (92.2671%)
___Train Local_ResNet_18,  epoch  92, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5376/5871 (91.5687%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0423, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6308/6812 (92.6013%)
___Train Local_ResNet_18,  epoch  92, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6229/6812 (91.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1829, Accuracy: 5334/10000 (53.3400%)
time spent on training: 281.1472501754761
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1701, Accuracy: 6897/10000 (68.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.6082, Accuracy: 8392/9900 (84.7677%)
Done in 307.4718060493469 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 92, 14, 45, 16, 59, 87, 19, 95, 47, 66, 6, 7, 82, 69, 79, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5073/5308 (95.5727%), train_poison_data_count: 415
Global model norm: 42.91779364924005.
Norm before scaling: 42.900849760304865. Distance: 1.5409686682138044
Total norm for 4 adversaries is: 42.900849760304865. distance: 1.5409686682138044
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0756, Accuracy: 9708/9900 (98.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5536/5777 (95.8283%), train_poison_data_count: 455
Global model norm: 42.91779364924005.
Norm before scaling: 42.89364885743212. Distance: 1.5331768446692735
Total norm for 4 adversaries is: 42.89364885743212. distance: 1.5331768446692735
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1081, Accuracy: 9621/9900 (97.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4860/5123 (94.8663%), train_poison_data_count: 403
Global model norm: 42.91779364924005.
Norm before scaling: 42.90024226193615. Distance: 1.547333004126513
Total norm for 4 adversaries is: 42.90024226193615. distance: 1.547333004126513
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1401, Accuracy: 9547/9900 (96.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5245/5503 (95.3116%), train_poison_data_count: 430
Global model norm: 42.91779364924005.
Norm before scaling: 42.90079854297586. Distance: 1.548963735639861
Total norm for 4 adversaries is: 42.90079854297586. distance: 1.548963735639861
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0847, Accuracy: 9673/9900 (97.7071%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6317/6812 (92.7334%)
___Train Local_ResNet_18,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 6234/6812 (91.5150%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1801, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3968/4196 (94.5663%)
___Train Local_ResNet_18,  epoch  93, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3986/4196 (94.9952%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8313, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4877/5489 (88.8504%)
___Train Local_ResNet_18,  epoch  93, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4970/5489 (90.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0462, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4861/5353 (90.8089%)
___Train Local_ResNet_18,  epoch  93, local model 16, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4770/5353 (89.1089%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0322, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4139/4397 (94.1324%)
___Train Local_ResNet_18,  epoch  93, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8317, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3557/3995 (89.0363%)
___Train Local_ResNet_18,  epoch  93, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3575/3995 (89.4869%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0244, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4852/5361 (90.5055%)
___Train Local_ResNet_18,  epoch  93, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4741/5361 (88.4350%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1225, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4521/5018 (90.0957%)
___Train Local_ResNet_18,  epoch  93, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4461/5018 (88.9000%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0226, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4581/5123 (89.4203%)
___Train Local_ResNet_18,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0086, Accuracy: 4306/5123 (84.0523%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2506, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4399/4843 (90.8321%)
___Train Local_ResNet_18,  epoch  93, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4440/4843 (91.6787%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9406, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4560/4929 (92.5137%)
___Train Local_ResNet_18,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4467/4929 (90.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1573, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4393/4869 (90.2239%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3963/4869 (81.3925%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3524, Accuracy: 4853/10000 (48.5300%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4893/5298 (92.3556%)
___Train Local_ResNet_18,  epoch  93, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4896/5298 (92.4122%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0094, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3996/4364 (91.5674%)
___Train Local_ResNet_18,  epoch  93, local model 69, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3880/4364 (88.9093%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9637, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3760/4111 (91.4619%)
___Train Local_ResNet_18,  epoch  93, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3727/4111 (90.6592%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0142, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3645/4028 (90.4916%)
___Train Local_ResNet_18,  epoch  93, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3706/4028 (92.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8857, Accuracy: 5699/10000 (56.9900%)
time spent on training: 274.83674454689026
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1707, Accuracy: 6896/10000 (68.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.5405, Accuracy: 8560/9900 (86.4646%)
Done in 301.106965303421 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 14, 82, 18, 47, 52, 43, 16, 75, 27, 28, 33, 5, 17, 67, 48, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5093/5308 (95.9495%), train_poison_data_count: 415
Global model norm: 42.940095559286135.
Norm before scaling: 42.92031645331993. Distance: 1.4959848229816473
Total norm for 4 adversaries is: 42.92031645331993. distance: 1.4959848229816473
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0707, Accuracy: 9719/9900 (98.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5571/5777 (96.4341%), train_poison_data_count: 455
Global model norm: 42.940095559286135.
Norm before scaling: 42.911761925181274. Distance: 1.4433583839010466
Total norm for 4 adversaries is: 42.911761925181274. distance: 1.4433583839010466
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1660, Accuracy: 9484/9900 (95.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4865/5123 (94.9639%), train_poison_data_count: 403
Global model norm: 42.940095559286135.
Norm before scaling: 42.92175270732487. Distance: 1.5478082019015331
Total norm for 4 adversaries is: 42.92175270732487. distance: 1.5478082019015331
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1393, Accuracy: 9549/9900 (96.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5255/5503 (95.4934%), train_poison_data_count: 430
Global model norm: 42.940095559286135.
Norm before scaling: 42.92243100067624. Distance: 1.5689787253401712
Total norm for 4 adversaries is: 42.92243100067624. distance: 1.5689787253401712
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0849, Accuracy: 9662/9900 (97.5960%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3957/4196 (94.3041%)
___Train Local_ResNet_18,  epoch  94, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3977/4196 (94.7807%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7776, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4900/5298 (92.4877%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4945/5298 (93.3371%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0243, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3860/4249 (90.8449%)
___Train Local_ResNet_18,  epoch  94, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3883/4249 (91.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9608, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4626/5123 (90.2987%)
___Train Local_ResNet_18,  epoch  94, local model 47, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4589/5123 (89.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1263, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3822/4130 (92.5424%)
___Train Local_ResNet_18,  epoch  94, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3819/4130 (92.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9179, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4512/4979 (90.6206%)
___Train Local_ResNet_18,  epoch  94, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4512/4979 (90.6206%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8883, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4882/5353 (91.2012%)
___Train Local_ResNet_18,  epoch  94, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4787/5353 (89.4265%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0117, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4298/4672 (91.9949%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4354/4672 (93.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8635, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4129/4587 (90.0153%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4169/4587 (90.8873%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1673, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4576/5122 (89.3401%)
___Train Local_ResNet_18,  epoch  94, local model 28, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4286/5122 (83.6783%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3657, Accuracy: 4869/10000 (48.6900%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4373/4818 (90.7638%)
___Train Local_ResNet_18,  epoch  94, local model 33, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4366/4818 (90.6185%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2272, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4699/4993 (94.1118%)
___Train Local_ResNet_18,  epoch  94, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4642/4993 (92.9702%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9924, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4421/4903 (90.1693%)
___Train Local_ResNet_18,  epoch  94, local model 17, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4404/4903 (89.8226%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1347, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4935/5559 (88.7750%)
___Train Local_ResNet_18,  epoch  94, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4943/5559 (88.9189%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0911, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4493/4830 (93.0228%)
___Train Local_ResNet_18,  epoch  94, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4520/4830 (93.5818%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9880, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5203/5696 (91.3448%)
___Train Local_ResNet_18,  epoch  94, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5169/5696 (90.7479%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0188, Accuracy: 5387/10000 (53.8700%)
time spent on training: 274.96021366119385
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1675, Accuracy: 6891/10000 (68.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.5153, Accuracy: 8607/9900 (86.9394%)
Done in 301.4845802783966 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 14, 47, 73, 97, 20, 45, 34, 76, 40, 35, 85, 62, 90, 54, 32, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5064/5308 (95.4032%), train_poison_data_count: 415
Global model norm: 42.961836091484294.
Norm before scaling: 42.94195613476041. Distance: 1.5205205918046387
Total norm for 4 adversaries is: 42.94195613476041. distance: 1.5205205918046387
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0286, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5563/5777 (96.2957%), train_poison_data_count: 455
Global model norm: 42.961836091484294.
Norm before scaling: 42.93415510761435. Distance: 1.4847263121223957
Total norm for 4 adversaries is: 42.93415510761435. distance: 1.4847263121223957
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1967, Accuracy: 9453/9900 (95.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4830/5123 (94.2807%), train_poison_data_count: 403
Global model norm: 42.961836091484294.
Norm before scaling: 42.948645865040085. Distance: 1.6083951022421021
Total norm for 4 adversaries is: 42.948645865040085. distance: 1.6083951022421021
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1868, Accuracy: 9420/9900 (95.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5288/5503 (96.0930%), train_poison_data_count: 430
Global model norm: 42.961836091484294.
Norm before scaling: 42.9407280787097. Distance: 1.4692261106799012
Total norm for 4 adversaries is: 42.9407280787097. distance: 1.4692261106799012
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1493, Accuracy: 9504/9900 (96.0000%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3963/4196 (94.4471%)
___Train Local_ResNet_18,  epoch  95, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3961/4196 (94.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8853, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4608/5123 (89.9473%)
___Train Local_ResNet_18,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0099, Accuracy: 4177/5123 (81.5343%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.5521, Accuracy: 4620/10000 (46.2000%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4274/4605 (92.8122%)
___Train Local_ResNet_18,  epoch  95, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4254/4605 (92.3779%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9307, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4233/4736 (89.3792%)
___Train Local_ResNet_18,  epoch  95, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4231/4736 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0106, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4353/4714 (92.3420%)
___Train Local_ResNet_18,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4390/4714 (93.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9009, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4925/5489 (89.7249%)
___Train Local_ResNet_18,  epoch  95, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4922/5489 (89.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3909, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4495/4911 (91.5292%)
___Train Local_ResNet_18,  epoch  95, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4536/4911 (92.3641%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1269, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3526/3959 (89.0629%)
___Train Local_ResNet_18,  epoch  95, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3611/3959 (91.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0514, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5431/5939 (91.4464%)
___Train Local_ResNet_18,  epoch  95, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5482/5939 (92.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0253, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5136/5615 (91.4693%)
___Train Local_ResNet_18,  epoch  95, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5118/5615 (91.1487%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1610, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6285/6947 (90.4707%)
___Train Local_ResNet_18,  epoch  95, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6096/6947 (87.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.3799, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4809/5504 (87.3728%)
___Train Local_ResNet_18,  epoch  95, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4802/5504 (87.2456%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1005, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4407/4748 (92.8180%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4383/4748 (92.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0216, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4980/5645 (88.2197%)
___Train Local_ResNet_18,  epoch  95, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4964/5645 (87.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2021, Accuracy: 5015/10000 (50.1500%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5387/6080 (88.6020%)
___Train Local_ResNet_18,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5377/6080 (88.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1411, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3307/3589 (92.1427%)
___Train Local_ResNet_18,  epoch  95, local model 68, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3262/3589 (90.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0691, Accuracy: 5466/10000 (54.6600%)
time spent on training: 277.96738624572754
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1698, Accuracy: 6893/10000 (68.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.4814, Accuracy: 8698/9900 (87.8586%)
Done in 304.5173223018646 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 19, 26, 11, 32, 40, 65, 21, 5, 17, 92, 12, 63, 44, 51, 82, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5105/5308 (96.1756%), train_poison_data_count: 415
Global model norm: 42.983398071413866.
Norm before scaling: 42.96097372816258. Distance: 1.4240403507762827
Total norm for 4 adversaries is: 42.96097372816258. distance: 1.4240403507762827
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1210, Accuracy: 9583/9900 (96.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5564/5777 (96.3130%), train_poison_data_count: 455
Global model norm: 42.983398071413866.
Norm before scaling: 42.957747170821094. Distance: 1.5112329140983851
Total norm for 4 adversaries is: 42.957747170821094. distance: 1.5112329140983851
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0423, Accuracy: 9775/9900 (98.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4856/5123 (94.7882%), train_poison_data_count: 403
Global model norm: 42.983398071413866.
Norm before scaling: 42.96581808179032. Distance: 1.5266049054131345
Total norm for 4 adversaries is: 42.96581808179032. distance: 1.5266049054131345
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.3013, Accuracy: 9141/9900 (92.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5264/5503 (95.6569%), train_poison_data_count: 430
Global model norm: 42.983398071413866.
Norm before scaling: 42.9645253605009. Distance: 1.5767219273814266
Total norm for 4 adversaries is: 42.9645253605009. distance: 1.5767219273814266
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0904, Accuracy: 9662/9900 (97.5960%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4836/5361 (90.2071%)
___Train Local_ResNet_18,  epoch  96, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4852/5361 (90.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1412, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3761/4086 (92.0460%)
___Train Local_ResNet_18,  epoch  96, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3829/4086 (93.7102%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1020, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4908/5702 (86.0751%)
___Train Local_ResNet_18,  epoch  96, local model 11, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4694/5702 (82.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2581, Accuracy: 5001/10000 (50.0100%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5329/6080 (87.6480%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5333/6080 (87.7138%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1621, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5454/5939 (91.8336%)
___Train Local_ResNet_18,  epoch  96, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5411/5939 (91.1096%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9777, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4917/5497 (89.4488%)
___Train Local_ResNet_18,  epoch  96, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4967/5497 (90.3584%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1185, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4547/5038 (90.2541%)
___Train Local_ResNet_18,  epoch  96, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4590/5038 (91.1076%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8803, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4647/4993 (93.0703%)
___Train Local_ResNet_18,  epoch  96, local model 5, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4556/4993 (91.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2249, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4399/4903 (89.7206%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4429/4903 (90.3324%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1600, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6307/6812 (92.5866%)
___Train Local_ResNet_18,  epoch  96, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6228/6812 (91.4269%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1244, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5004/5526 (90.5537%)
___Train Local_ResNet_18,  epoch  96, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4907/5526 (88.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0577, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3604/3910 (92.1739%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3504/3910 (89.6164%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0676, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4721/5075 (93.0246%)
___Train Local_ResNet_18,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4634/5075 (91.3103%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0552, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3759/4108 (91.5044%)
___Train Local_ResNet_18,  epoch  96, local model 51, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3771/4108 (91.7965%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9511, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4959/5298 (93.6014%)
___Train Local_ResNet_18,  epoch  96, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4940/5298 (93.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0532, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5014/5422 (92.4751%)
___Train Local_ResNet_18,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4975/5422 (91.7558%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9706, Accuracy: 5565/10000 (55.6500%)
time spent on training: 277.8941214084625
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1688, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.4673, Accuracy: 8722/9900 (88.1010%)
Done in 304.435747385025 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 40, 64, 16, 91, 86, 42, 49, 66, 2, 8, 83, 26, 43, 81, 28, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5103/5308 (96.1379%), train_poison_data_count: 415
Global model norm: 43.0064777551737.
Norm before scaling: 42.98440765856629. Distance: 1.4321008543589604
Total norm for 4 adversaries is: 42.98440765856629. distance: 1.4321008543589604
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0566, Accuracy: 9744/9900 (98.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5568/5777 (96.3822%), train_poison_data_count: 455
Global model norm: 43.0064777551737.
Norm before scaling: 42.9792032739382. Distance: 1.459012073422443
Total norm for 4 adversaries is: 42.9792032739382. distance: 1.459012073422443
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0944, Accuracy: 9639/9900 (97.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4870/5123 (95.0615%), train_poison_data_count: 403
Global model norm: 43.0064777551737.
Norm before scaling: 42.985459819099006. Distance: 1.4930723273150956
Total norm for 4 adversaries is: 42.985459819099006. distance: 1.4930723273150956
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2201, Accuracy: 9358/9900 (94.5253%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5248/5503 (95.3662%), train_poison_data_count: 430
Global model norm: 43.0064777551737.
Norm before scaling: 42.98611864874956. Distance: 1.5320616147671318
Total norm for 4 adversaries is: 42.98611864874956. distance: 1.5320616147671318
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1062, Accuracy: 9604/9900 (97.0101%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5432/5939 (91.4632%)
___Train Local_ResNet_18,  epoch  97, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5441/5939 (91.6147%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2165, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4317/4894 (88.2101%)
___Train Local_ResNet_18,  epoch  97, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4324/4894 (88.3531%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1792, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4815/5353 (89.9496%)
___Train Local_ResNet_18,  epoch  97, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4811/5353 (89.8748%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0750, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4083/4527 (90.1922%)
___Train Local_ResNet_18,  epoch  97, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4032/4527 (89.0656%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1150, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3593/3929 (91.4482%)
___Train Local_ResNet_18,  epoch  97, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3624/3929 (92.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8115, Accuracy: 5878/10000 (58.7800%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5396/5907 (91.3492%)
___Train Local_ResNet_18,  epoch  97, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5279/5907 (89.3685%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.3141, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5092/5652 (90.0920%)
___Train Local_ResNet_18,  epoch  97, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5026/5652 (88.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1578, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4439/4843 (91.6581%)
___Train Local_ResNet_18,  epoch  97, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4434/4843 (91.5548%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1430, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3621/3968 (91.2550%)
___Train Local_ResNet_18,  epoch  97, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3684/3968 (92.8427%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8518, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4481/4889 (91.6547%)
___Train Local_ResNet_18,  epoch  97, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4467/4889 (91.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2858, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3230/3552 (90.9347%)
___Train Local_ResNet_18,  epoch  97, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3284/3552 (92.4550%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8772, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3832/4086 (93.7837%)
___Train Local_ResNet_18,  epoch  97, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3863/4086 (94.5423%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8646, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4562/4979 (91.6248%)
___Train Local_ResNet_18,  epoch  97, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4583/4979 (92.0466%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9896, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4657/5035 (92.4926%)
___Train Local_ResNet_18,  epoch  97, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4654/5035 (92.4330%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0068, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4620/5122 (90.1991%)
___Train Local_ResNet_18,  epoch  97, local model 28, internal_epoch   2,  Average loss: 0.0131, Accuracy: 3909/5122 (76.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.5659, Accuracy: 4530/10000 (45.3000%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5127/5615 (91.3090%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5184/5615 (92.3241%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2084, Accuracy: 5220/10000 (52.2000%)
time spent on training: 271.86271572113037
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1779, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4207, Accuracy: 8831/9900 (89.2020%)
Done in 298.5302894115448 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 48, 89, 35, 76, 39, 12, 31, 24, 1, 54, 37, 22, 21, 17, 10, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5101/5308 (96.1002%), train_poison_data_count: 415
Global model norm: 43.027357757884694.
Norm before scaling: 43.006219458461764. Distance: 1.49188421073151
Total norm for 4 adversaries is: 43.006219458461764. distance: 1.49188421073151
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0757, Accuracy: 9696/9900 (97.9394%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5585/5777 (96.6765%), train_poison_data_count: 455
Global model norm: 43.027357757884694.
Norm before scaling: 42.997903462243805. Distance: 1.444520475554734
Total norm for 4 adversaries is: 42.997903462243805. distance: 1.444520475554734
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0492, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4872/5123 (95.1005%), train_poison_data_count: 403
Global model norm: 43.027357757884694.
Norm before scaling: 43.009494886485534. Distance: 1.5203939700277294
Total norm for 4 adversaries is: 43.009494886485534. distance: 1.5203939700277294
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1691, Accuracy: 9480/9900 (95.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5262/5503 (95.6206%), train_poison_data_count: 430
Global model norm: 43.027357757884694.
Norm before scaling: 43.007821724567584. Distance: 1.5321938855860715
Total norm for 4 adversaries is: 43.007821724567584. distance: 1.5321938855860715
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0446, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4505/4830 (93.2712%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4500/4830 (93.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0127, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4303/4737 (90.8381%)
___Train Local_ResNet_18,  epoch  98, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4290/4737 (90.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1477, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5110/5615 (91.0062%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5095/5615 (90.7391%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0674, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3552/3959 (89.7196%)
___Train Local_ResNet_18,  epoch  98, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3596/3959 (90.8310%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0514, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3827/4175 (91.6647%)
___Train Local_ResNet_18,  epoch  98, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3796/4175 (90.9222%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9194, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5095/5526 (92.2005%)
___Train Local_ResNet_18,  epoch  98, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4943/5526 (89.4499%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0897, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4178/4537 (92.0873%)
___Train Local_ResNet_18,  epoch  98, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4173/4537 (91.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9388, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3928/4313 (91.0735%)
___Train Local_ResNet_18,  epoch  98, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3958/4313 (91.7691%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9388, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5060/5422 (93.3235%)
___Train Local_ResNet_18,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5063/5422 (93.3788%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9243, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4996/5645 (88.5031%)
___Train Local_ResNet_18,  epoch  98, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4819/5645 (85.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0441, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4362/4741 (92.0059%)
___Train Local_ResNet_18,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3838/4741 (80.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.4450, Accuracy: 4694/10000 (46.9400%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5219/5696 (91.6257%)
___Train Local_ResNet_18,  epoch  98, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5166/5696 (90.6952%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1050, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4570/5038 (90.7106%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4601/5038 (91.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9421, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4399/4903 (89.7206%)
___Train Local_ResNet_18,  epoch  98, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4442/4903 (90.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9793, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4689/5068 (92.5217%)
___Train Local_ResNet_18,  epoch  98, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4632/5068 (91.3970%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3008, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4420/4748 (93.0918%)
___Train Local_ResNet_18,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4392/4748 (92.5021%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0100, Accuracy: 5463/10000 (54.6300%)
time spent on training: 275.30023431777954
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1796, Accuracy: 6888/10000 (68.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.3886, Accuracy: 8896/9900 (89.8586%)
Done in 301.8561074733734 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 83, 63, 46, 35, 25, 8, 56, 22, 31, 87, 5, 7, 10, 30, 82, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5098/5308 (96.0437%), train_poison_data_count: 415
Global model norm: 43.04890818701155.
Norm before scaling: 43.02628818070849. Distance: 1.4747944898812286
Total norm for 4 adversaries is: 43.02628818070849. distance: 1.4747944898812286
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0223, Accuracy: 9829/9900 (99.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5551/5777 (96.0879%), train_poison_data_count: 455
Global model norm: 43.04890818701155.
Norm before scaling: 43.022151475468135. Distance: 1.500010649325397
Total norm for 4 adversaries is: 43.022151475468135. distance: 1.500010649325397
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0837, Accuracy: 9678/9900 (97.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4875/5123 (95.1591%), train_poison_data_count: 403
Global model norm: 43.04890818701155.
Norm before scaling: 43.03013371146507. Distance: 1.5443323218555516
Total norm for 4 adversaries is: 43.03013371146507. distance: 1.5443323218555516
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1211, Accuracy: 9598/9900 (96.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5231/5503 (95.0572%), train_poison_data_count: 430
Global model norm: 43.04890818701155.
Norm before scaling: 43.03075072331995. Distance: 1.5557658993709915
Total norm for 4 adversaries is: 43.03075072331995. distance: 1.5557658993709915
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1385, Accuracy: 9548/9900 (96.4444%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3216/3552 (90.5405%)
___Train Local_ResNet_18,  epoch  99, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3316/3552 (93.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8279, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3662/3910 (93.6573%)
___Train Local_ResNet_18,  epoch  99, local model 63, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3264/3910 (83.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.4384, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4797/5399 (88.8498%)
___Train Local_ResNet_18,  epoch  99, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4793/5399 (88.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1329, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5125/5615 (91.2734%)
___Train Local_ResNet_18,  epoch  99, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5201/5615 (92.6269%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0716, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5673/6419 (88.3783%)
___Train Local_ResNet_18,  epoch  99, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5508/6419 (85.8078%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2300, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4444/4889 (90.8979%)
___Train Local_ResNet_18,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4434/4889 (90.6934%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0894, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4896/5427 (90.2156%)
___Train Local_ResNet_18,  epoch  99, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4887/5427 (90.0498%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0444, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5278/5696 (92.6615%)
___Train Local_ResNet_18,  epoch  99, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5247/5696 (92.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0576, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4152/4537 (91.5142%)
___Train Local_ResNet_18,  epoch  99, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4135/4537 (91.1395%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9706, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3595/3995 (89.9875%)
___Train Local_ResNet_18,  epoch  99, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3536/3995 (88.5106%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0045, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4684/4993 (93.8113%)
___Train Local_ResNet_18,  epoch  99, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4669/4993 (93.5109%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0776, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4392/4869 (90.2033%)
___Train Local_ResNet_18,  epoch  99, local model 7, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4336/4869 (89.0532%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.2790, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4710/5068 (92.9361%)
___Train Local_ResNet_18,  epoch  99, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4635/5068 (91.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1283, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3489/3774 (92.4483%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3547/3774 (93.9852%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0778, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4955/5298 (93.5259%)
___Train Local_ResNet_18,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4920/5298 (92.8652%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0216, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4991/5461 (91.3935%)
___Train Local_ResNet_18,  epoch  99, local model 80, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4983/5461 (91.2470%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1823, Accuracy: 5302/10000 (53.0200%)
time spent on training: 272.69176626205444
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1832, Accuracy: 6880/10000 (68.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.3516, Accuracy: 8975/9900 (90.6566%)
Done in 298.881605386734 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 87, 99, 81, 52, 95, 3, 6, 0, 51, 78, 18, 89, 92, 40, 42, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5124/5308 (96.5335%), train_poison_data_count: 415
Global model norm: 43.07009355671723.
Norm before scaling: 43.0477058676621. Distance: 1.419152304456653
Total norm for 4 adversaries is: 43.0477058676621. distance: 1.419152304456653
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0809, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5590/5777 (96.7630%), train_poison_data_count: 455
Global model norm: 43.07009355671723.
Norm before scaling: 43.04040048859618. Distance: 1.4263533607093768
Total norm for 4 adversaries is: 43.04040048859618. distance: 1.4263533607093768
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0592, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4848/5123 (94.6321%), train_poison_data_count: 403
Global model norm: 43.07009355671723.
Norm before scaling: 43.04893654319465. Distance: 1.5129012182580412
Total norm for 4 adversaries is: 43.04893654319465. distance: 1.5129012182580412
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1138, Accuracy: 9611/9900 (97.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5296/5503 (96.2384%), train_poison_data_count: 430
Global model norm: 43.07009355671723.
Norm before scaling: 43.04648508217236. Distance: 1.4815939298754646
Total norm for 4 adversaries is: 43.04648508217236. distance: 1.4815939298754646
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0545, Accuracy: 9732/9900 (98.3030%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3579/3995 (89.5870%)
___Train Local_ResNet_18,  epoch 100, local model 87, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3527/3995 (88.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2534, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4409/4851 (90.8885%)
___Train Local_ResNet_18,  epoch 100, local model 99, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4389/4851 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1782, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4648/5035 (92.3138%)
___Train Local_ResNet_18,  epoch 100, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4664/5035 (92.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9959, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3825/4130 (92.6150%)
___Train Local_ResNet_18,  epoch 100, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3841/4130 (93.0024%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9450, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4470/5018 (89.0793%)
___Train Local_ResNet_18,  epoch 100, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4497/5018 (89.6174%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0767, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4977/5346 (93.0976%)
___Train Local_ResNet_18,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4955/5346 (92.6861%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2075, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4570/4929 (92.7166%)
___Train Local_ResNet_18,  epoch 100, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4466/4929 (90.6066%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0627, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4959/5454 (90.9241%)
___Train Local_ResNet_18,  epoch 100, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4874/5454 (89.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0633, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3794/4108 (92.3564%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3777/4108 (91.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8968, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4066/4368 (93.0861%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3965/4368 (90.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0536, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3903/4249 (91.8569%)
___Train Local_ResNet_18,  epoch 100, local model 18, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3887/4249 (91.4803%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9161, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4322/4737 (91.2392%)
___Train Local_ResNet_18,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4325/4737 (91.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0926, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 6317/6812 (92.7334%)
___Train Local_ResNet_18,  epoch 100, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6275/6812 (92.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3514, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5471/5939 (92.1199%)
___Train Local_ResNet_18,  epoch 100, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5470/5939 (92.1030%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9564, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5346/5907 (90.5028%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5337/5907 (90.3504%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.3476, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4432/4843 (91.5135%)
___Train Local_ResNet_18,  epoch 100, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4442/4843 (91.7200%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0004, Accuracy: 5436/10000 (54.3600%)
time spent on training: 274.93969440460205
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1892, Accuracy: 6871/10000 (68.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.3023, Accuracy: 9086/9900 (91.7778%)
Done in 301.0022385120392 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 92, 3, 12, 50, 95, 31, 5, 38, 72, 61, 32, 94, 7, 57, 22, 8].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5123/5308 (96.5147%), train_poison_data_count: 415
Global model norm: 43.09108437640407.
Norm before scaling: 43.06837314811183. Distance: 1.4334472248752954
Total norm for 4 adversaries is: 43.06837314811183. distance: 1.4334472248752954
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0447, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5580/5777 (96.5899%), train_poison_data_count: 455
Global model norm: 43.09108437640407.
Norm before scaling: 43.06119600710714. Distance: 1.4525250252490005
Total norm for 4 adversaries is: 43.06119600710714. distance: 1.4525250252490005
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0507, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4877/5123 (95.1981%), train_poison_data_count: 403
Global model norm: 43.09108437640407.
Norm before scaling: 43.06998727316898. Distance: 1.4855432831818347
Total norm for 4 adversaries is: 43.06998727316898. distance: 1.4855432831818347
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1019, Accuracy: 9647/9900 (97.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5264/5503 (95.6569%), train_poison_data_count: 430
Global model norm: 43.09108437640407.
Norm before scaling: 43.07098207691941. Distance: 1.5263239975845289
Total norm for 4 adversaries is: 43.07098207691941. distance: 1.5263239975845289
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0263, Accuracy: 9826/9900 (99.2525%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6318/6812 (92.7481%)
___Train Local_ResNet_18,  epoch 101, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6212/6812 (91.1920%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0004, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4994/5346 (93.4156%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4880/5346 (91.2832%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0920, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5042/5526 (91.2414%)
___Train Local_ResNet_18,  epoch 101, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4859/5526 (87.9298%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2207, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4406/4757 (92.6214%)
___Train Local_ResNet_18,  epoch 101, local model 50, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4301/4757 (90.4141%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1182, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4578/5018 (91.2316%)
___Train Local_ResNet_18,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4475/5018 (89.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1062, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4207/4537 (92.7265%)
___Train Local_ResNet_18,  epoch 101, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4235/4537 (93.3436%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8978, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4668/4993 (93.4909%)
___Train Local_ResNet_18,  epoch 101, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4629/4993 (92.7098%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0817, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5570/6235 (89.3344%)
___Train Local_ResNet_18,  epoch 101, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5494/6235 (88.1155%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.4206, Accuracy: 4797/10000 (47.9700%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4745/5193 (91.3730%)
___Train Local_ResNet_18,  epoch 101, local model 72, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4476/5193 (86.1930%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.4658, Accuracy: 4800/10000 (48.0000%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4086/4485 (91.1037%)
___Train Local_ResNet_18,  epoch 101, local model 61, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3708/4485 (82.6756%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3479, Accuracy: 4806/10000 (48.0600%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5355/6080 (88.0757%)
___Train Local_ResNet_18,  epoch 101, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5381/6080 (88.5033%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2196, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4643/5224 (88.8783%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4691/5224 (89.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1145, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4442/4869 (91.2302%)
___Train Local_ResNet_18,  epoch 101, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4265/4869 (87.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1490, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4535/4956 (91.5052%)
___Train Local_ResNet_18,  epoch 101, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4440/4956 (89.5884%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1333, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5206/5696 (91.3975%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5161/5696 (90.6074%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9816, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4479/4889 (91.6138%)
___Train Local_ResNet_18,  epoch 101, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4466/4889 (91.3479%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9369, Accuracy: 5522/10000 (55.2200%)
time spent on training: 280.44726395606995
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1893, Accuracy: 6874/10000 (68.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2830, Accuracy: 9134/9900 (92.2626%)
Done in 306.9068646430969 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 1, 65, 25, 70, 59, 5, 76, 49, 11, 2, 40, 47, 23, 83, 28, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5144/5308 (96.9103%), train_poison_data_count: 415
Global model norm: 43.116079806617684.
Norm before scaling: 43.088472415231024. Distance: 1.3288794226071816
Total norm for 4 adversaries is: 43.088472415231024. distance: 1.3288794226071816
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1322, Accuracy: 9550/9900 (96.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5563/5777 (96.2957%), train_poison_data_count: 455
Global model norm: 43.116079806617684.
Norm before scaling: 43.087820816727024. Distance: 1.4783729071124547
Total norm for 4 adversaries is: 43.087820816727024. distance: 1.4783729071124547
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0611, Accuracy: 9750/9900 (98.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4884/5123 (95.3348%), train_poison_data_count: 403
Global model norm: 43.116079806617684.
Norm before scaling: 43.095630850905295. Distance: 1.5159268422755736
Total norm for 4 adversaries is: 43.095630850905295. distance: 1.5159268422755736
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1197, Accuracy: 9600/9900 (96.9697%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5276/5503 (95.8750%), train_poison_data_count: 430
Global model norm: 43.116079806617684.
Norm before scaling: 43.092633914118665. Distance: 1.5113554131003208
Total norm for 4 adversaries is: 43.092633914118665. distance: 1.5113554131003208
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0416, Accuracy: 9784/9900 (98.8283%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5070/5422 (93.5079%)
___Train Local_ResNet_18,  epoch 102, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5059/5422 (93.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0097, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4997/5497 (90.9041%)
___Train Local_ResNet_18,  epoch 102, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4915/5497 (89.4124%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0424, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5693/6419 (88.6898%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5509/6419 (85.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2508, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5426/5871 (92.4204%)
___Train Local_ResNet_18,  epoch 102, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5357/5871 (91.2451%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0232, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4141/4397 (94.1778%)
___Train Local_ResNet_18,  epoch 102, local model 59, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4190/4397 (95.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7730, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4694/4993 (94.0116%)
___Train Local_ResNet_18,  epoch 102, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4617/4993 (92.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0076, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3577/3959 (90.3511%)
___Train Local_ResNet_18,  epoch 102, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3613/3959 (91.2604%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9745, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5046/5652 (89.2781%)
___Train Local_ResNet_18,  epoch 102, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5026/5652 (88.9243%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0976, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4937/5702 (86.5837%)
___Train Local_ResNet_18,  epoch 102, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4608/5702 (80.8137%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2875, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3618/3968 (91.1794%)
___Train Local_ResNet_18,  epoch 102, local model 2, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3678/3968 (92.6915%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8642, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5521/5939 (92.9618%)
___Train Local_ResNet_18,  epoch 102, local model 40, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5489/5939 (92.4230%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9945, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4622/5123 (90.2206%)
___Train Local_ResNet_18,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4500/5123 (87.8392%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3062, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4285/4549 (94.1965%)
___Train Local_ResNet_18,  epoch 102, local model 23, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3984/4549 (87.5797%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0489, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3214/3552 (90.4842%)
___Train Local_ResNet_18,  epoch 102, local model 83, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3272/3552 (92.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8690, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4588/5122 (89.5744%)
___Train Local_ResNet_18,  epoch 102, local model 28, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4211/5122 (82.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3418, Accuracy: 4798/10000 (47.9800%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6307/6812 (92.5866%)
___Train Local_ResNet_18,  epoch 102, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6260/6812 (91.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1260, Accuracy: 5327/10000 (53.2700%)
time spent on training: 278.24063205718994
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1877, Accuracy: 6883/10000 (68.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.2681, Accuracy: 9166/9900 (92.5859%)
Done in 304.88718342781067 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 55, 74, 81, 88, 47, 3, 20, 49, 91, 24, 85, 5, 96, 21, 80, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.13791982644881.
Norm before scaling: 43.112518007933325. Distance: 1.3883934546676562
Total norm for 4 adversaries is: 43.112518007933325. distance: 1.3883934546676562
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1137, Accuracy: 9593/9900 (96.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5559/5777 (96.2264%), train_poison_data_count: 455
Global model norm: 43.13791982644881.
Norm before scaling: 43.10882848964931. Distance: 1.4754276657807708
Total norm for 4 adversaries is: 43.10882848964931. distance: 1.4754276657807708
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0900, Accuracy: 9665/9900 (97.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4872/5123 (95.1005%), train_poison_data_count: 403
Global model norm: 43.13791982644881.
Norm before scaling: 43.11645918595792. Distance: 1.5047183531769974
Total norm for 4 adversaries is: 43.11645918595792. distance: 1.5047183531769974
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1584, Accuracy: 9497/9900 (95.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5271/5503 (95.7841%), train_poison_data_count: 430
Global model norm: 43.13791982644881.
Norm before scaling: 43.114141805593356. Distance: 1.4982695134326107
Total norm for 4 adversaries is: 43.114141805593356. distance: 1.4982695134326107
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0331, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4350/4731 (91.9467%)
___Train Local_ResNet_18,  epoch 103, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4414/4731 (93.2995%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9450, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4354/4797 (90.7651%)
___Train Local_ResNet_18,  epoch 103, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4346/4797 (90.5983%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9010, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4646/5035 (92.2741%)
___Train Local_ResNet_18,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4611/5035 (91.5789%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2465, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4871/5362 (90.8430%)
___Train Local_ResNet_18,  epoch 103, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4851/5362 (90.4700%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2196, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4657/5123 (90.9038%)
___Train Local_ResNet_18,  epoch 103, local model 47, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4534/5123 (88.5028%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1858, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4955/5346 (92.6861%)
___Train Local_ResNet_18,  epoch 103, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4936/5346 (92.3307%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0589, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4386/4714 (93.0420%)
___Train Local_ResNet_18,  epoch 103, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4395/4714 (93.2329%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8954, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5081/5652 (89.8974%)
___Train Local_ResNet_18,  epoch 103, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5021/5652 (88.8358%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0370, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4056/4527 (89.5958%)
___Train Local_ResNet_18,  epoch 103, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3972/4527 (87.7402%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1553, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3999/4313 (92.7197%)
___Train Local_ResNet_18,  epoch 103, local model 24, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3993/4313 (92.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8350, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6280/6947 (90.3987%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6094/6947 (87.7213%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2150, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4681/4993 (93.7513%)
___Train Local_ResNet_18,  epoch 103, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4594/4993 (92.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1468, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4680/5086 (92.0173%)
___Train Local_ResNet_18,  epoch 103, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4715/5086 (92.7055%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1069, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4620/5038 (91.7031%)
___Train Local_ResNet_18,  epoch 103, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4635/5038 (92.0008%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8681, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4987/5461 (91.3203%)
___Train Local_ResNet_18,  epoch 103, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4925/5461 (90.1849%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0750, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5125/5727 (89.4884%)
___Train Local_ResNet_18,  epoch 103, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5118/5727 (89.3662%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1765, Accuracy: 5280/10000 (52.8000%)
time spent on training: 282.06882309913635
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1847, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.2593, Accuracy: 9186/9900 (92.7879%)
Done in 308.2832384109497 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 24, 64, 59, 90, 22, 56, 73, 1, 70, 49, 88, 11, 44, 15, 92, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5100/5308 (96.0814%), train_poison_data_count: 415
Global model norm: 43.15948717266938.
Norm before scaling: 43.137525071982715. Distance: 1.46446552734333
Total norm for 4 adversaries is: 43.137525071982715. distance: 1.46446552734333
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0830, Accuracy: 9687/9900 (97.8485%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5595/5777 (96.8496%), train_poison_data_count: 455
Global model norm: 43.15948717266938.
Norm before scaling: 43.1285961476149. Distance: 1.4161161400208628
Total norm for 4 adversaries is: 43.1285961476149. distance: 1.4161161400208628
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0696, Accuracy: 9715/9900 (98.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4881/5123 (95.2762%), train_poison_data_count: 403
Global model norm: 43.15948717266938.
Norm before scaling: 43.13867819765257. Distance: 1.4594176030934793
Total norm for 4 adversaries is: 43.13867819765257. distance: 1.4594176030934793
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2425, Accuracy: 9233/9900 (93.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5295/5503 (96.2202%), train_poison_data_count: 430
Global model norm: 43.15948717266938.
Norm before scaling: 43.13460179566183. Distance: 1.4603062046012472
Total norm for 4 adversaries is: 43.13460179566183. distance: 1.4603062046012472
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0615, Accuracy: 9729/9900 (98.2727%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3957/4313 (91.7459%)
___Train Local_ResNet_18,  epoch 104, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3972/4313 (92.0937%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9634, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4417/4894 (90.2534%)
___Train Local_ResNet_18,  epoch 104, local model 64, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4286/4894 (87.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0691, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4189/4397 (95.2695%)
___Train Local_ResNet_18,  epoch 104, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4213/4397 (95.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8168, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4428/4748 (93.2603%)
___Train Local_ResNet_18,  epoch 104, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4431/4748 (93.3235%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9914, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5264/5696 (92.4157%)
___Train Local_ResNet_18,  epoch 104, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5181/5696 (90.9586%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9251, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4923/5427 (90.7131%)
___Train Local_ResNet_18,  epoch 104, local model 56, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4874/5427 (89.8102%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0322, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4283/4605 (93.0076%)
___Train Local_ResNet_18,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4274/4605 (92.8122%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1680, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5076/5422 (93.6186%)
___Train Local_ResNet_18,  epoch 104, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5075/5422 (93.6001%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9296, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5471/5871 (93.1869%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5323/5871 (90.6660%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1010, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5065/5652 (89.6143%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5073/5652 (89.7558%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1170, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4923/5362 (91.8128%)
___Train Local_ResNet_18,  epoch 104, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4839/5362 (90.2462%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1380, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4944/5702 (86.7064%)
___Train Local_ResNet_18,  epoch 104, local model 11, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4669/5702 (81.8835%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.3557, Accuracy: 4818/10000 (48.1800%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4694/5075 (92.4926%)
___Train Local_ResNet_18,  epoch 104, local model 44, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4596/5075 (90.5616%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1362, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5558/6068 (91.5953%)
___Train Local_ResNet_18,  epoch 104, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5578/6068 (91.9249%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1577, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 6309/6812 (92.6160%)
___Train Local_ResNet_18,  epoch 104, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6271/6812 (92.0581%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0667, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4403/4732 (93.0473%)
___Train Local_ResNet_18,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4425/4732 (93.5123%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8680, Accuracy: 5757/10000 (57.5700%)
time spent on training: 281.39716601371765
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1853, Accuracy: 6867/10000 (68.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.2554, Accuracy: 9203/9900 (92.9596%)
Done in 308.04365038871765 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 38, 1, 27, 46, 63, 42, 19, 95, 85, 68, 67, 92, 3, 17, 59, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5129/5308 (96.6277%), train_poison_data_count: 415
Global model norm: 43.1814550649169.
Norm before scaling: 43.156109985743186. Distance: 1.37695771345091
Total norm for 4 adversaries is: 43.156109985743186. distance: 1.37695771345091
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0999, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5604/5777 (97.0054%), train_poison_data_count: 455
Global model norm: 43.1814550649169.
Norm before scaling: 43.15056420727601. Distance: 1.405096386219992
Total norm for 4 adversaries is: 43.15056420727601. distance: 1.405096386219992
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0722, Accuracy: 9693/9900 (97.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4903/5123 (95.7056%), train_poison_data_count: 403
Global model norm: 43.1814550649169.
Norm before scaling: 43.15864572912216. Distance: 1.4523035824675892
Total norm for 4 adversaries is: 43.15864572912216. distance: 1.4523035824675892
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1626, Accuracy: 9462/9900 (95.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5298/5503 (96.2748%), train_poison_data_count: 430
Global model norm: 43.1814550649169.
Norm before scaling: 43.155254333192154. Distance: 1.45559998441226
Total norm for 4 adversaries is: 43.155254333192154. distance: 1.45559998441226
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0478, Accuracy: 9765/9900 (98.6364%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5598/6235 (89.7835%)
___Train Local_ResNet_18,  epoch 105, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5619/6235 (90.1203%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1578, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5095/5422 (93.9690%)
___Train Local_ResNet_18,  epoch 105, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5013/5422 (92.4567%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8876, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4132/4587 (90.0807%)
___Train Local_ResNet_18,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4100/4587 (89.3830%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0711, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4855/5399 (89.9241%)
___Train Local_ResNet_18,  epoch 105, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4729/5399 (87.5903%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2553, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3627/3910 (92.7621%)
___Train Local_ResNet_18,  epoch 105, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3627/3910 (92.7621%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9670, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5368/5907 (90.8752%)
___Train Local_ResNet_18,  epoch 105, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5274/5907 (89.2839%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.4770, Accuracy: 4875/10000 (48.7500%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4857/5361 (90.5988%)
___Train Local_ResNet_18,  epoch 105, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4804/5361 (89.6101%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1325, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4539/5018 (90.4544%)
___Train Local_ResNet_18,  epoch 105, local model 95, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4520/5018 (90.0757%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0793, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6255/6947 (90.0389%)
___Train Local_ResNet_18,  epoch 105, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6088/6947 (87.6350%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2666, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3286/3589 (91.5575%)
___Train Local_ResNet_18,  epoch 105, local model 68, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3167/3589 (88.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1271, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5041/5559 (90.6818%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4961/5559 (89.2427%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1656, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6358/6812 (93.3353%)
___Train Local_ResNet_18,  epoch 105, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 6196/6812 (90.9571%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1800, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5008/5346 (93.6775%)
___Train Local_ResNet_18,  epoch 105, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4981/5346 (93.1725%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9816, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4387/4903 (89.4758%)
___Train Local_ResNet_18,  epoch 105, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4459/4903 (90.9443%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9060, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4218/4397 (95.9290%)
___Train Local_ResNet_18,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0021, Accuracy: 4228/4397 (96.1565%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7694, Accuracy: 5949/10000 (59.4900%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4705/5035 (93.4459%)
___Train Local_ResNet_18,  epoch 105, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4721/5035 (93.7637%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8928, Accuracy: 5686/10000 (56.8600%)
time spent on training: 282.32016706466675
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1815, Accuracy: 6877/10000 (68.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.2578, Accuracy: 9187/9900 (92.7980%)
Done in 308.6889567375183 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 70, 72, 67, 66, 75, 44, 99, 84, 22, 28, 37, 74, 14, 79, 7, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5124/5308 (96.5335%), train_poison_data_count: 415
Global model norm: 43.20418172306212.
Norm before scaling: 43.18069179106198. Distance: 1.4203618980017614
Total norm for 4 adversaries is: 43.18069179106198. distance: 1.4203618980017614
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0288, Accuracy: 9825/9900 (99.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5574/5777 (96.4861%), train_poison_data_count: 455
Global model norm: 43.20418172306212.
Norm before scaling: 43.174111528206346. Distance: 1.4388729670628462
Total norm for 4 adversaries is: 43.174111528206346. distance: 1.4388729670628462
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0700, Accuracy: 9724/9900 (98.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4910/5123 (95.8423%), train_poison_data_count: 403
Global model norm: 43.20418172306212.
Norm before scaling: 43.18090946683282. Distance: 1.4116190669844495
Total norm for 4 adversaries is: 43.18090946683282. distance: 1.4116190669844495
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0873, Accuracy: 9659/9900 (97.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5278/5503 (95.9113%), train_poison_data_count: 430
Global model norm: 43.20418172306212.
Norm before scaling: 43.18141124770877. Distance: 1.5005519169460413
Total norm for 4 adversaries is: 43.18141124770877. distance: 1.5005519169460413
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0282, Accuracy: 9833/9900 (99.3232%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5392/5871 (91.8413%)
___Train Local_ResNet_18,  epoch 106, local model 70, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5331/5871 (90.8022%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1032, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4695/5193 (90.4102%)
___Train Local_ResNet_18,  epoch 106, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4517/5193 (86.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3973, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5030/5559 (90.4839%)
___Train Local_ResNet_18,  epoch 106, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4921/5559 (88.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1652, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4434/4843 (91.5548%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4406/4843 (90.9767%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9439, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4328/4672 (92.6370%)
___Train Local_ResNet_18,  epoch 106, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4329/4672 (92.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8577, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4730/5075 (93.2020%)
___Train Local_ResNet_18,  epoch 106, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4661/5075 (91.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0705, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4421/4851 (91.1358%)
___Train Local_ResNet_18,  epoch 106, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4423/4851 (91.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0765, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4746/5209 (91.1115%)
___Train Local_ResNet_18,  epoch 106, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4726/5209 (90.7276%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1761, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5253/5696 (92.2226%)
___Train Local_ResNet_18,  epoch 106, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5156/5696 (90.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1636, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4649/5122 (90.7653%)
___Train Local_ResNet_18,  epoch 106, local model 28, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4359/5122 (85.1035%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3017, Accuracy: 5033/10000 (50.3300%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4321/4741 (91.1411%)
___Train Local_ResNet_18,  epoch 106, local model 37, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4157/4741 (87.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3642, Accuracy: 4849/10000 (48.4900%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4321/4797 (90.0771%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4251/4797 (88.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0788, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3968/4196 (94.5663%)
___Train Local_ResNet_18,  epoch 106, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3960/4196 (94.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7738, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3754/4111 (91.3160%)
___Train Local_ResNet_18,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3780/4111 (91.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1035, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4473/4869 (91.8669%)
___Train Local_ResNet_18,  epoch 106, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4142/4869 (85.0688%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2986, Accuracy: 4982/10000 (49.8200%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5039/5645 (89.2648%)
___Train Local_ResNet_18,  epoch 106, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5004/5645 (88.6448%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9606, Accuracy: 5399/10000 (53.9900%)
time spent on training: 277.1433894634247
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1810, Accuracy: 6882/10000 (68.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.2293, Accuracy: 9261/9900 (93.5455%)
Done in 303.52043199539185 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 16, 83, 76, 93, 11, 51, 92, 61, 72, 59, 60, 3, 30, 80, 49, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5128/5308 (96.6089%), train_poison_data_count: 415
Global model norm: 43.22736802859605.
Norm before scaling: 43.20251892658069. Distance: 1.428654198292344
Total norm for 4 adversaries is: 43.20251892658069. distance: 1.428654198292344
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0544, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5601/5777 (96.9534%), train_poison_data_count: 455
Global model norm: 43.22736802859605.
Norm before scaling: 43.19301983990729. Distance: 1.3725905548684527
Total norm for 4 adversaries is: 43.19301983990729. distance: 1.3725905548684527
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0347, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.22736802859605.
Norm before scaling: 43.2036010936697. Distance: 1.436873340846328
Total norm for 4 adversaries is: 43.2036010936697. distance: 1.436873340846328
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1164, Accuracy: 9602/9900 (96.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5316/5503 (96.6019%), train_poison_data_count: 430
Global model norm: 43.22736802859605.
Norm before scaling: 43.20122763690793. Distance: 1.4183997137731015
Total norm for 4 adversaries is: 43.20122763690793. distance: 1.4183997137731015
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1084, Accuracy: 9610/9900 (97.0707%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4904/5353 (91.6122%)
___Train Local_ResNet_18,  epoch 107, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4849/5353 (90.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9874, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3225/3552 (90.7939%)
___Train Local_ResNet_18,  epoch 107, local model 83, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3301/3552 (92.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8088, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3597/3959 (90.8563%)
___Train Local_ResNet_18,  epoch 107, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3623/3959 (91.5130%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8898, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4586/5055 (90.7221%)
___Train Local_ResNet_18,  epoch 107, local model 93, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4525/5055 (89.5153%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2402, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4933/5702 (86.5135%)
___Train Local_ResNet_18,  epoch 107, local model 11, internal_epoch   2,  Average loss: 0.0126, Accuracy: 4328/5702 (75.9032%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.4820, Accuracy: 4647/10000 (46.4700%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3805/4108 (92.6241%)
___Train Local_ResNet_18,  epoch 107, local model 51, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3814/4108 (92.8432%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8735, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6281/6812 (92.2049%)
___Train Local_ResNet_18,  epoch 107, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6197/6812 (90.9718%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1485, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4128/4485 (92.0401%)
___Train Local_ResNet_18,  epoch 107, local model 61, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3959/4485 (88.2720%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1425, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4730/5193 (91.0842%)
___Train Local_ResNet_18,  epoch 107, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4513/5193 (86.9054%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3185, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4150/4397 (94.3825%)
___Train Local_ResNet_18,  epoch 107, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4215/4397 (95.8608%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.6920, Accuracy: 6015/10000 (60.1500%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3800/4145 (91.6767%)
___Train Local_ResNet_18,  epoch 107, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3801/4145 (91.7008%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0684, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4987/5346 (93.2847%)
___Train Local_ResNet_18,  epoch 107, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4976/5346 (93.0789%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9445, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3472/3774 (91.9979%)
___Train Local_ResNet_18,  epoch 107, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3525/3774 (93.4022%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9578, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5042/5461 (92.3274%)
___Train Local_ResNet_18,  epoch 107, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5060/5461 (92.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2349, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5065/5652 (89.6143%)
___Train Local_ResNet_18,  epoch 107, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4942/5652 (87.4381%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0952, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5544/5939 (93.3490%)
___Train Local_ResNet_18,  epoch 107, local model 40, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5508/5939 (92.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9580, Accuracy: 5454/10000 (54.5400%)
time spent on training: 276.1081807613373
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1895, Accuracy: 6864/10000 (68.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.2105, Accuracy: 9312/9900 (94.0606%)
Done in 302.585914850235 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 61, 73, 22, 98, 14, 33, 5, 2, 32, 21, 53, 79, 12, 10, 76, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5137/5308 (96.7784%), train_poison_data_count: 415
Global model norm: 43.24741598359158.
Norm before scaling: 43.221169095800875. Distance: 1.3798155987588954
Total norm for 4 adversaries is: 43.221169095800875. distance: 1.3798155987588954
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0405, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5588/5777 (96.7284%), train_poison_data_count: 455
Global model norm: 43.24741598359158.
Norm before scaling: 43.21436477888096. Distance: 1.380962492075048
Total norm for 4 adversaries is: 43.21436477888096. distance: 1.380962492075048
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0879, Accuracy: 9669/9900 (97.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4915/5123 (95.9399%), train_poison_data_count: 403
Global model norm: 43.24741598359158.
Norm before scaling: 43.22278316322307. Distance: 1.4196371556499154
Total norm for 4 adversaries is: 43.22278316322307. distance: 1.4196371556499154
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0864, Accuracy: 9690/9900 (97.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5326/5503 (96.7836%), train_poison_data_count: 430
Global model norm: 43.24741598359158.
Norm before scaling: 43.22112814317495. Distance: 1.4352032100862733
Total norm for 4 adversaries is: 43.22112814317495. distance: 1.4352032100862733
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1189, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4107/4485 (91.5719%)
___Train Local_ResNet_18,  epoch 108, local model 61, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3913/4485 (87.2464%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1076, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4305/4605 (93.4853%)
___Train Local_ResNet_18,  epoch 108, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4296/4605 (93.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8912, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5299/5696 (93.0302%)
___Train Local_ResNet_18,  epoch 108, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5238/5696 (91.9593%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9980, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3851/4161 (92.5499%)
___Train Local_ResNet_18,  epoch 108, local model 98, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3780/4161 (90.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2541, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3967/4196 (94.5424%)
___Train Local_ResNet_18,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3983/4196 (94.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.7621, Accuracy: 5850/10000 (58.5000%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4407/4818 (91.4695%)
___Train Local_ResNet_18,  epoch 108, local model 33, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4246/4818 (88.1279%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0272, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4674/4993 (93.6111%)
___Train Local_ResNet_18,  epoch 108, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4615/4993 (92.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0888, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3664/3968 (92.3387%)
___Train Local_ResNet_18,  epoch 108, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3633/3968 (91.5575%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8301, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5387/6080 (88.6020%)
___Train Local_ResNet_18,  epoch 108, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5370/6080 (88.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0916, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4598/5038 (91.2664%)
___Train Local_ResNet_18,  epoch 108, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4609/5038 (91.4847%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9581, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5864/6664 (87.9952%)
___Train Local_ResNet_18,  epoch 108, local model 53, internal_epoch   2,  Average loss: 0.0081, Accuracy: 5625/6664 (84.4088%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.5348, Accuracy: 4754/10000 (47.5400%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3810/4111 (92.6782%)
___Train Local_ResNet_18,  epoch 108, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3805/4111 (92.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0777, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5028/5526 (90.9881%)
___Train Local_ResNet_18,  epoch 108, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4822/5526 (87.2602%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2265, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4747/5068 (93.6661%)
___Train Local_ResNet_18,  epoch 108, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4622/5068 (91.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1510, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3596/3959 (90.8310%)
___Train Local_ResNet_18,  epoch 108, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3656/3959 (92.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8760, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4094/4368 (93.7271%)
___Train Local_ResNet_18,  epoch 108, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4073/4368 (93.2463%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9871, Accuracy: 5544/10000 (55.4400%)
time spent on training: 274.1672706604004
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1904, Accuracy: 6870/10000 (68.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1968, Accuracy: 9348/9900 (94.4242%)
Done in 300.7649166584015 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 73, 72, 84, 40, 22, 51, 8, 54, 34, 27, 68, 82, 65, 7, 14, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.26723458770144.
Norm before scaling: 43.24089810069499. Distance: 1.3920434297111661
Total norm for 4 adversaries is: 43.24089810069499. distance: 1.3920434297111661
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1123, Accuracy: 9604/9900 (97.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5608/5777 (97.0746%), train_poison_data_count: 455
Global model norm: 43.26723458770144.
Norm before scaling: 43.23436511790635. Distance: 1.3802943604728086
Total norm for 4 adversaries is: 43.23436511790635. distance: 1.3802943604728086
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1030, Accuracy: 9635/9900 (97.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4904/5123 (95.7252%), train_poison_data_count: 403
Global model norm: 43.26723458770144.
Norm before scaling: 43.24276690555818. Distance: 1.430271633865405
Total norm for 4 adversaries is: 43.24276690555818. distance: 1.430271633865405
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0941, Accuracy: 9639/9900 (97.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5304/5503 (96.3838%), train_poison_data_count: 430
Global model norm: 43.26723458770144.
Norm before scaling: 43.24167583821047. Distance: 1.4614469078670496
Total norm for 4 adversaries is: 43.24167583821047. distance: 1.4614469078670496
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1276, Accuracy: 9552/9900 (96.4848%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4298/4605 (93.3333%)
___Train Local_ResNet_18,  epoch 109, local model 73, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4270/4605 (92.7253%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9118, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4757/5193 (91.6041%)
___Train Local_ResNet_18,  epoch 109, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4514/5193 (86.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3934, Accuracy: 4788/10000 (47.8800%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4767/5209 (91.5147%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4698/5209 (90.1901%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9774, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5516/5939 (92.8776%)
___Train Local_ResNet_18,  epoch 109, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5455/5939 (91.8505%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0936, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5317/5696 (93.3462%)
___Train Local_ResNet_18,  epoch 109, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5224/5696 (91.7135%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0395, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3800/4108 (92.5024%)
___Train Local_ResNet_18,  epoch 109, local model 51, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3702/4108 (90.1168%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0464, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4480/4889 (91.6343%)
___Train Local_ResNet_18,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4471/4889 (91.4502%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0156, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5057/5645 (89.5837%)
___Train Local_ResNet_18,  epoch 109, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4912/5645 (87.0151%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3135, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4526/4911 (92.1605%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4537/4911 (92.3844%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0278, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4149/4587 (90.4513%)
___Train Local_ResNet_18,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4174/4587 (90.9963%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0843, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3333/3589 (92.8671%)
___Train Local_ResNet_18,  epoch 109, local model 68, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3129/3589 (87.1831%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1223, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4958/5298 (93.5825%)
___Train Local_ResNet_18,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4924/5298 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9276, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5037/5497 (91.6318%)
___Train Local_ResNet_18,  epoch 109, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4927/5497 (89.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0794, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4425/4869 (90.8811%)
___Train Local_ResNet_18,  epoch 109, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4215/4869 (86.5681%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.3438, Accuracy: 4970/10000 (49.7000%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3978/4196 (94.8046%)
___Train Local_ResNet_18,  epoch 109, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3971/4196 (94.6378%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7731, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3667/3968 (92.4143%)
___Train Local_ResNet_18,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3680/3968 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.7395, Accuracy: 5913/10000 (59.1300%)
time spent on training: 275.0039310455322
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1932, Accuracy: 6857/10000 (68.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2029, Accuracy: 9331/9900 (94.2525%)
Done in 301.48630237579346 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 98, 90, 19, 60, 20, 39, 86, 78, 25, 23, 28, 34, 4, 9, 5, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5132/5308 (96.6843%), train_poison_data_count: 415
Global model norm: 43.288344127544164.
Norm before scaling: 43.26255660164963. Distance: 1.3972907025969155
Total norm for 4 adversaries is: 43.26255660164963. distance: 1.3972907025969155
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0307, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5618/5777 (97.2477%), train_poison_data_count: 455
Global model norm: 43.288344127544164.
Norm before scaling: 43.25585756712248. Distance: 1.365234549635629
Total norm for 4 adversaries is: 43.25585756712248. distance: 1.365234549635629
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0390, Accuracy: 9797/9900 (98.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4896/5123 (95.5690%), train_poison_data_count: 403
Global model norm: 43.288344127544164.
Norm before scaling: 43.26419734011455. Distance: 1.4425025637122897
Total norm for 4 adversaries is: 43.26419734011455. distance: 1.4425025637122897
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2114, Accuracy: 9363/9900 (94.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5324/5503 (96.7472%), train_poison_data_count: 430
Global model norm: 43.288344127544164.
Norm before scaling: 43.26013417668021. Distance: 1.3988219430675541
Total norm for 4 adversaries is: 43.26013417668021. distance: 1.3988219430675541
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0272, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3881/4161 (93.2708%)
___Train Local_ResNet_18,  epoch 110, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3778/4161 (90.7955%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9730, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4415/4748 (92.9865%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4424/4748 (93.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9087, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4890/5361 (91.2143%)
___Train Local_ResNet_18,  epoch 110, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4840/5361 (90.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9759, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3802/4145 (91.7250%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3829/4145 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9524, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4431/4714 (93.9966%)
___Train Local_ResNet_18,  epoch 110, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4385/4714 (93.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0155, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3828/4175 (91.6886%)
___Train Local_ResNet_18,  epoch 110, local model 39, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3787/4175 (90.7066%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0967, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3566/3929 (90.7610%)
___Train Local_ResNet_18,  epoch 110, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3555/3929 (90.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9087, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4074/4368 (93.2692%)
___Train Local_ResNet_18,  epoch 110, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4068/4368 (93.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9759, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5738/6419 (89.3909%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0071, Accuracy: 5515/6419 (85.9168%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1392, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4299/4549 (94.5043%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3975/4549 (87.3818%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2053, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4599/5122 (89.7891%)
___Train Local_ResNet_18,  epoch 110, local model 28, internal_epoch   2,  Average loss: 0.0130, Accuracy: 3994/5122 (77.9774%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.5490, Accuracy: 4461/10000 (44.6100%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4567/4911 (92.9953%)
___Train Local_ResNet_18,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4574/4911 (93.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9696, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3713/4028 (92.1797%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3717/4028 (92.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9172, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5179/5727 (90.4313%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5096/5727 (88.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0786, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4687/4993 (93.8714%)
___Train Local_ResNet_18,  epoch 110, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4639/4993 (92.9101%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1337, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4424/4714 (93.8481%)
___Train Local_ResNet_18,  epoch 110, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4422/4714 (93.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9984, Accuracy: 5607/10000 (56.0700%)
time spent on training: 272.31096291542053
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1886, Accuracy: 6864/10000 (68.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1953, Accuracy: 9358/9900 (94.5253%)
Done in 298.76914525032043 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 80, 69, 20, 50, 3, 73, 15, 77, 35, 56, 55, 18, 47, 21, 5, 43].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5145/5308 (96.9292%), train_poison_data_count: 415
Global model norm: 43.307281488022454.
Norm before scaling: 43.27808116784191. Distance: 1.307699461578634
Total norm for 4 adversaries is: 43.27808116784191. distance: 1.307699461578634
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0350, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5610/5777 (97.1092%), train_poison_data_count: 455
Global model norm: 43.307281488022454.
Norm before scaling: 43.274151888623855. Distance: 1.3735602383674594
Total norm for 4 adversaries is: 43.274151888623855. distance: 1.3735602383674594
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0765, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4921/5123 (96.0570%), train_poison_data_count: 403
Global model norm: 43.307281488022454.
Norm before scaling: 43.2813797380727. Distance: 1.3773578887577276
Total norm for 4 adversaries is: 43.2813797380727. distance: 1.3773578887577276
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1104, Accuracy: 9612/9900 (97.0909%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5311/5503 (96.5110%), train_poison_data_count: 430
Global model norm: 43.307281488022454.
Norm before scaling: 43.28282939356553. Distance: 1.475435422217756
Total norm for 4 adversaries is: 43.28282939356553. distance: 1.475435422217756
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1580, Accuracy: 9483/9900 (95.7879%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4978/5461 (91.1555%)
___Train Local_ResNet_18,  epoch 111, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4956/5461 (90.7526%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0791, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4000/4364 (91.6590%)
___Train Local_ResNet_18,  epoch 111, local model 69, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3889/4364 (89.1155%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0615, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4424/4714 (93.8481%)
___Train Local_ResNet_18,  epoch 111, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4450/4714 (94.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8780, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4357/4757 (91.5913%)
___Train Local_ResNet_18,  epoch 111, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4305/4757 (90.4982%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2005, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5018/5346 (93.8646%)
___Train Local_ResNet_18,  epoch 111, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4908/5346 (91.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0926, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4299/4605 (93.3550%)
___Train Local_ResNet_18,  epoch 111, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4323/4605 (93.8762%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8796, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5551/6068 (91.4799%)
___Train Local_ResNet_18,  epoch 111, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5497/6068 (90.5900%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.2650, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4503/5050 (89.1683%)
___Train Local_ResNet_18,  epoch 111, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4525/5050 (89.6040%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0786, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5131/5615 (91.3802%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5121/5615 (91.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9670, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4932/5427 (90.8789%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4937/5427 (90.9711%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0822, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4405/4731 (93.1093%)
___Train Local_ResNet_18,  epoch 111, local model 55, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4376/4731 (92.4963%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9354, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3941/4249 (92.7512%)
___Train Local_ResNet_18,  epoch 111, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3897/4249 (91.7157%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9999, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4631/5123 (90.3963%)
___Train Local_ResNet_18,  epoch 111, local model 47, internal_epoch   2,  Average loss: 0.0098, Accuracy: 4174/5123 (81.4757%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.3192, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4648/5038 (92.2588%)
___Train Local_ResNet_18,  epoch 111, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4596/5038 (91.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9294, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4724/4993 (94.6125%)
___Train Local_ResNet_18,  epoch 111, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4659/4993 (93.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0226, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4606/4979 (92.5085%)
___Train Local_ResNet_18,  epoch 111, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4636/4979 (93.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1145, Accuracy: 5392/10000 (53.9200%)
time spent on training: 278.97800517082214
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.1852, Accuracy: 6869/10000 (68.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1892, Accuracy: 9370/9900 (94.6465%)
Done in 305.74053955078125 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 56, 14, 4, 30, 82, 85, 39, 70, 91, 59, 1, 88, 49, 34, 53, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5148/5308 (96.9857%), train_poison_data_count: 415
Global model norm: 43.328470123490256.
Norm before scaling: 43.29939404211175. Distance: 1.3492092306732304
Total norm for 4 adversaries is: 43.29939404211175. distance: 1.3492092306732304
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0341, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5605/5777 (97.0227%), train_poison_data_count: 455
Global model norm: 43.328470123490256.
Norm before scaling: 43.2938426513914. Distance: 1.3628572608054295
Total norm for 4 adversaries is: 43.2938426513914. distance: 1.3628572608054295
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0634, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4925/5123 (96.1351%), train_poison_data_count: 403
Global model norm: 43.328470123490256.
Norm before scaling: 43.30270226484139. Distance: 1.396813797943442
Total norm for 4 adversaries is: 43.30270226484139. distance: 1.396813797943442
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0653, Accuracy: 9717/9900 (98.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5296/5503 (96.2384%), train_poison_data_count: 430
Global model norm: 43.328470123490256.
Norm before scaling: 43.300924848938706. Distance: 1.429416401492438
Total norm for 4 adversaries is: 43.300924848938706. distance: 1.429416401492438
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0697, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4875/5427 (89.8286%)
___Train Local_ResNet_18,  epoch 112, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4881/5427 (89.9392%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0274, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3960/4196 (94.3756%)
___Train Local_ResNet_18,  epoch 112, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3978/4196 (94.8046%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9655, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3703/4028 (91.9315%)
___Train Local_ResNet_18,  epoch 112, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3735/4028 (92.7259%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8358, Accuracy: 5866/10000 (58.6600%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3524/3774 (93.3757%)
___Train Local_ResNet_18,  epoch 112, local model 30, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3566/3774 (94.4886%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8502, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4926/5298 (92.9785%)
___Train Local_ResNet_18,  epoch 112, local model 82, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4892/5298 (92.3367%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0609, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6316/6947 (90.9169%)
___Train Local_ResNet_18,  epoch 112, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6072/6947 (87.4046%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2372, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3815/4175 (91.3772%)
___Train Local_ResNet_18,  epoch 112, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3804/4175 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0719, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5429/5871 (92.4715%)
___Train Local_ResNet_18,  epoch 112, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5376/5871 (91.5687%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2439, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4111/4527 (90.8107%)
___Train Local_ResNet_18,  epoch 112, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4069/4527 (89.8829%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9035, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4172/4397 (94.8829%)
___Train Local_ResNet_18,  epoch 112, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4174/4397 (94.9284%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8496, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5092/5422 (93.9137%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5039/5422 (92.9362%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0227, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4922/5362 (91.7941%)
___Train Local_ResNet_18,  epoch 112, local model 88, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4825/5362 (89.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0537, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5061/5652 (89.5435%)
___Train Local_ResNet_18,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5028/5652 (88.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3278, Accuracy: 4930/10000 (49.3000%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4537/4911 (92.3844%)
___Train Local_ResNet_18,  epoch 112, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4574/4911 (93.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9544, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5834/6664 (87.5450%)
___Train Local_ResNet_18,  epoch 112, local model 53, internal_epoch   2,  Average loss: 0.0083, Accuracy: 5583/6664 (83.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1410, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4579/5055 (90.5836%)
___Train Local_ResNet_18,  epoch 112, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4566/5055 (90.3264%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1540, Accuracy: 5289/10000 (52.8900%)
time spent on training: 275.1954913139343
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.1877, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1782, Accuracy: 9402/9900 (94.9697%)
Done in 301.91205191612244 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 98, 78, 33, 79, 16, 3, 62, 30, 39, 1, 15, 6, 50, 93, 66, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5149/5308 (97.0045%), train_poison_data_count: 415
Global model norm: 43.34861634542099.
Norm before scaling: 43.32072460917595. Distance: 1.3791977787638299
Total norm for 4 adversaries is: 43.32072460917595. distance: 1.3791977787638299
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0389, Accuracy: 9803/9900 (99.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5595/5777 (96.8496%), train_poison_data_count: 455
Global model norm: 43.34861634542099.
Norm before scaling: 43.316291940342005. Distance: 1.4262236444443654
Total norm for 4 adversaries is: 43.316291940342005. distance: 1.4262236444443654
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0647, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4908/5123 (95.8032%), train_poison_data_count: 403
Global model norm: 43.34861634542099.
Norm before scaling: 43.32324930870332. Distance: 1.4271299071496972
Total norm for 4 adversaries is: 43.32324930870332. distance: 1.4271299071496972
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0902, Accuracy: 9663/9900 (97.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5300/5503 (96.3111%), train_poison_data_count: 430
Global model norm: 43.34861634542099.
Norm before scaling: 43.322275795231775. Distance: 1.4555037522419951
Total norm for 4 adversaries is: 43.322275795231775. distance: 1.4555037522419951
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0439, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3884/4161 (93.3429%)
___Train Local_ResNet_18,  epoch 113, local model 98, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3823/4161 (91.8770%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0368, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4119/4368 (94.2995%)
___Train Local_ResNet_18,  epoch 113, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4067/4368 (93.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9408, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4326/4818 (89.7883%)
___Train Local_ResNet_18,  epoch 113, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4312/4818 (89.4977%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9716, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3814/4111 (92.7755%)
___Train Local_ResNet_18,  epoch 113, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3829/4111 (93.1404%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1021, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4905/5353 (91.6309%)
___Train Local_ResNet_18,  epoch 113, local model 16, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4840/5353 (90.4166%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9764, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5018/5346 (93.8646%)
___Train Local_ResNet_18,  epoch 113, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5007/5346 (93.6588%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1441, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4860/5504 (88.2994%)
___Train Local_ResNet_18,  epoch 113, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4757/5504 (86.4281%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2227, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3493/3774 (92.5543%)
___Train Local_ResNet_18,  epoch 113, local model 30, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3544/3774 (93.9057%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8614, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3842/4175 (92.0240%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3834/4175 (91.8323%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8899, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5088/5422 (93.8399%)
___Train Local_ResNet_18,  epoch 113, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5038/5422 (92.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8854, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5583/6068 (92.0073%)
___Train Local_ResNet_18,  epoch 113, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5523/6068 (91.0185%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.2368, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4562/4929 (92.5543%)
___Train Local_ResNet_18,  epoch 113, local model 6, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4436/4929 (89.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0511, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4408/4757 (92.6634%)
___Train Local_ResNet_18,  epoch 113, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4287/4757 (90.1198%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1631, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4625/5055 (91.4936%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4562/5055 (90.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0104, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4472/4843 (92.3395%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4446/4843 (91.8026%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9963, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4705/5035 (93.4459%)
___Train Local_ResNet_18,  epoch 113, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4696/5035 (93.2671%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9942, Accuracy: 5627/10000 (56.2700%)
time spent on training: 273.64340257644653
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.1892, Accuracy: 6863/10000 (68.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1710, Accuracy: 9422/9900 (95.1717%)
Done in 300.175616979599 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 33, 91, 10, 81, 5, 93, 90, 24, 64, 16, 9, 18, 27, 2, 67, 82].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5149/5308 (97.0045%), train_poison_data_count: 415
Global model norm: 43.36888549977031.
Norm before scaling: 43.33961683835371. Distance: 1.3416552073224284
Total norm for 4 adversaries is: 43.33961683835371. distance: 1.3416552073224284
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0540, Accuracy: 9757/9900 (98.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5598/5777 (96.9015%), train_poison_data_count: 455
Global model norm: 43.36888549977031.
Norm before scaling: 43.33298183200788. Distance: 1.3372762118495058
Total norm for 4 adversaries is: 43.33298183200788. distance: 1.3372762118495058
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0448, Accuracy: 9780/9900 (98.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4922/5123 (96.0765%), train_poison_data_count: 403
Global model norm: 43.36888549977031.
Norm before scaling: 43.342398140417885. Distance: 1.4127287502226418
Total norm for 4 adversaries is: 43.342398140417885. distance: 1.4127287502226418
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0860, Accuracy: 9687/9900 (97.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5310/5503 (96.4928%), train_poison_data_count: 430
Global model norm: 43.36888549977031.
Norm before scaling: 43.34065755911244. Distance: 1.4338571581917274
Total norm for 4 adversaries is: 43.34065755911244. distance: 1.4338571581917274
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0567, Accuracy: 9756/9900 (98.5455%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4420/4818 (91.7393%)
___Train Local_ResNet_18,  epoch 114, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4264/4818 (88.5015%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1451, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4058/4527 (89.6399%)
___Train Local_ResNet_18,  epoch 114, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4035/4527 (89.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1067, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4706/5068 (92.8571%)
___Train Local_ResNet_18,  epoch 114, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4620/5068 (91.1602%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2821, Accuracy: 4950/10000 (49.5000%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4699/5035 (93.3267%)
___Train Local_ResNet_18,  epoch 114, local model 81, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4735/5035 (94.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9748, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4756/4993 (95.2534%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4645/4993 (93.0302%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1142, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4548/5055 (89.9703%)
___Train Local_ResNet_18,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4590/5055 (90.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0837, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4428/4748 (93.2603%)
___Train Local_ResNet_18,  epoch 114, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4357/4748 (91.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0557, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3993/4313 (92.5806%)
___Train Local_ResNet_18,  epoch 114, local model 24, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3975/4313 (92.1632%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9298, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4344/4894 (88.7617%)
___Train Local_ResNet_18,  epoch 114, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4265/4894 (87.1475%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2175, Accuracy: 5156/10000 (51.5600%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4945/5353 (92.3781%)
___Train Local_ResNet_18,  epoch 114, local model 16, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4818/5353 (90.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0310, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5128/5727 (89.5408%)
___Train Local_ResNet_18,  epoch 114, local model 9, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4989/5727 (87.1137%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2258, Accuracy: 5116/10000 (51.1600%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3922/4249 (92.3041%)
___Train Local_ResNet_18,  epoch 114, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3935/4249 (92.6100%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9667, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4167/4587 (90.8437%)
___Train Local_ResNet_18,  epoch 114, local model 27, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4146/4587 (90.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1656, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3668/3968 (92.4395%)
___Train Local_ResNet_18,  epoch 114, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3663/3968 (92.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9338, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5011/5559 (90.1421%)
___Train Local_ResNet_18,  epoch 114, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4940/5559 (88.8649%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1513, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4935/5298 (93.1484%)
___Train Local_ResNet_18,  epoch 114, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4927/5298 (92.9974%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0975, Accuracy: 5452/10000 (54.5200%)
time spent on training: 274.8141279220581
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.1956, Accuracy: 6840/10000 (68.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1554, Accuracy: 9466/9900 (95.6162%)
Done in 301.54434537887573 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 33, 82, 16, 30, 63, 31, 53, 84, 47, 60, 12, 92, 42, 39, 44, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5154/5308 (97.0987%), train_poison_data_count: 415
Global model norm: 43.38971207853093.
Norm before scaling: 43.35999999549556. Distance: 1.3318164014523282
Total norm for 4 adversaries is: 43.35999999549556. distance: 1.3318164014523282
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0769, Accuracy: 9707/9900 (98.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5609/5777 (97.0919%), train_poison_data_count: 455
Global model norm: 43.38971207853093.
Norm before scaling: 43.35284720005784. Distance: 1.3407251333974721
Total norm for 4 adversaries is: 43.35284720005784. distance: 1.3407251333974721
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0454, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4930/5123 (96.2327%), train_poison_data_count: 403
Global model norm: 43.38971207853093.
Norm before scaling: 43.36335145054447. Distance: 1.404536750690172
Total norm for 4 adversaries is: 43.36335145054447. distance: 1.404536750690172
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0869, Accuracy: 9670/9900 (97.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5312/5503 (96.5292%), train_poison_data_count: 430
Global model norm: 43.38971207853093.
Norm before scaling: 43.359532657371034. Distance: 1.3887126503496283
Total norm for 4 adversaries is: 43.359532657371034. distance: 1.3887126503496283
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0478, Accuracy: 9776/9900 (98.7475%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4369/4818 (90.6808%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4301/4818 (89.2694%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0241, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5018/5298 (94.7150%)
___Train Local_ResNet_18,  epoch 115, local model 82, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4979/5298 (93.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0393, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4966/5353 (92.7704%)
___Train Local_ResNet_18,  epoch 115, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4836/5353 (90.3419%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0968, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3534/3774 (93.6407%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3523/3774 (93.3492%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8819, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3634/3910 (92.9412%)
___Train Local_ResNet_18,  epoch 115, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3574/3910 (91.4066%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1538, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4169/4537 (91.8889%)
___Train Local_ResNet_18,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4182/4537 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9558, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5897/6664 (88.4904%)
___Train Local_ResNet_18,  epoch 115, local model 53, internal_epoch   2,  Average loss: 0.0082, Accuracy: 5629/6664 (84.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2442, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4727/5209 (90.7468%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4657/5209 (89.4030%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1103, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4621/5123 (90.2011%)
___Train Local_ResNet_18,  epoch 115, local model 47, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3974/5123 (77.5717%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3758, Accuracy: 4689/10000 (46.8900%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3855/4145 (93.0036%)
___Train Local_ResNet_18,  epoch 115, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3823/4145 (92.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9840, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5078/5526 (91.8929%)
___Train Local_ResNet_18,  epoch 115, local model 12, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4947/5526 (89.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.2578, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6336/6812 (93.0123%)
___Train Local_ResNet_18,  epoch 115, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6255/6812 (91.8233%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1038, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5418/5907 (91.7217%)
___Train Local_ResNet_18,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5376/5907 (91.0107%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3441, Accuracy: 5069/10000 (50.6900%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3861/4175 (92.4790%)
___Train Local_ResNet_18,  epoch 115, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3839/4175 (91.9521%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0284, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4716/5075 (92.9261%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4619/5075 (91.0148%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1931, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3808/4111 (92.6295%)
___Train Local_ResNet_18,  epoch 115, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3756/4111 (91.3646%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9364, Accuracy: 5516/10000 (55.1600%)
time spent on training: 277.6293270587921
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.1991, Accuracy: 6846/10000 (68.4600%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1529, Accuracy: 9478/9900 (95.7374%)
Done in 303.9051103591919 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 41, 49, 96, 89, 92, 44, 42, 48, 23, 22, 76, 75, 29, 6, 15, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5139/5308 (96.8161%), train_poison_data_count: 415
Global model norm: 43.41109527942569.
Norm before scaling: 43.381482258328695. Distance: 1.3481398889447191
Total norm for 4 adversaries is: 43.381482258328695. distance: 1.3481398889447191
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0506, Accuracy: 9767/9900 (98.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5607/5777 (97.0573%), train_poison_data_count: 455
Global model norm: 43.41109527942569.
Norm before scaling: 43.377233090481205. Distance: 1.395292143977595
Total norm for 4 adversaries is: 43.377233090481205. distance: 1.395292143977595
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0640, Accuracy: 9728/9900 (98.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4928/5123 (96.1936%), train_poison_data_count: 403
Global model norm: 43.41109527942569.
Norm before scaling: 43.383274663259485. Distance: 1.3598321606346997
Total norm for 4 adversaries is: 43.383274663259485. distance: 1.3598321606346997
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0922, Accuracy: 9651/9900 (97.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5293/5503 (96.1839%), train_poison_data_count: 430
Global model norm: 43.41109527942569.
Norm before scaling: 43.38571412838202. Distance: 1.477210493043993
Total norm for 4 adversaries is: 43.38571412838202. distance: 1.477210493043993
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0381, Accuracy: 9802/9900 (99.0101%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4392/4714 (93.1693%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4377/4714 (92.8511%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0741, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5037/5652 (89.1189%)
___Train Local_ResNet_18,  epoch 116, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5039/5652 (89.1543%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2396, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4685/5086 (92.1156%)
___Train Local_ResNet_18,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4686/5086 (92.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0749, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4304/4737 (90.8592%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4318/4737 (91.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3514, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6371/6812 (93.5261%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6299/6812 (92.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2362, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4680/5075 (92.2167%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4735/5075 (93.3005%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0538, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5416/5907 (91.6878%)
___Train Local_ResNet_18,  epoch 116, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5283/5907 (89.4363%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3487, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4499/4830 (93.1470%)
___Train Local_ResNet_18,  epoch 116, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4552/4830 (94.2443%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0390, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4301/4549 (94.5483%)
___Train Local_ResNet_18,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3925/4549 (86.2827%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.3540, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5256/5696 (92.2753%)
___Train Local_ResNet_18,  epoch 116, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5182/5696 (90.9761%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1824, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3620/3959 (91.4372%)
___Train Local_ResNet_18,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3611/3959 (91.2099%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9032, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4361/4672 (93.3433%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4356/4672 (93.2363%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9646, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4412/4732 (93.2375%)
___Train Local_ResNet_18,  epoch 116, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4396/4732 (92.8994%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8701, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4551/4929 (92.3311%)
___Train Local_ResNet_18,  epoch 116, local model 6, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1701, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5621/6068 (92.6335%)
___Train Local_ResNet_18,  epoch 116, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5557/6068 (91.5788%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1893, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3591/3995 (89.8874%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3583/3995 (89.6871%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2784, Accuracy: 5198/10000 (51.9800%)
time spent on training: 273.7680809497833
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2049, Accuracy: 6848/10000 (68.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1442, Accuracy: 9499/9900 (95.9495%)
Done in 300.3368995189667 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 5, 39, 78, 34, 63, 68, 55, 14, 81, 75, 43, 73, 11, 3, 70, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5107/5308 (96.2133%), train_poison_data_count: 415
Global model norm: 43.43239628290154.
Norm before scaling: 43.40515601123183. Distance: 1.3955227615484735
Total norm for 4 adversaries is: 43.40515601123183. distance: 1.3955227615484735
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0648, Accuracy: 9722/9900 (98.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5584/5777 (96.6592%), train_poison_data_count: 455
Global model norm: 43.43239628290154.
Norm before scaling: 43.39984738371424. Distance: 1.4112961407291005
Total norm for 4 adversaries is: 43.39984738371424. distance: 1.4112961407291005
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0550, Accuracy: 9765/9900 (98.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4912/5123 (95.8813%), train_poison_data_count: 403
Global model norm: 43.43239628290154.
Norm before scaling: 43.40729615369978. Distance: 1.4531659356370736
Total norm for 4 adversaries is: 43.40729615369978. distance: 1.4531659356370736
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0163, Accuracy: 9856/9900 (99.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5329/5503 (96.8381%), train_poison_data_count: 430
Global model norm: 43.43239628290154.
Norm before scaling: 43.40173887645517. Distance: 1.3443732036328517
Total norm for 4 adversaries is: 43.40173887645517. distance: 1.3443732036328517
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0465, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4679/4993 (93.7112%)
___Train Local_ResNet_18,  epoch 117, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4611/4993 (92.3493%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1263, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3825/4175 (91.6168%)
___Train Local_ResNet_18,  epoch 117, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3781/4175 (90.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1929, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4135/4368 (94.6658%)
___Train Local_ResNet_18,  epoch 117, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4064/4368 (93.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0417, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4521/4911 (92.0586%)
___Train Local_ResNet_18,  epoch 117, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4442/4911 (90.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1332, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3638/3910 (93.0435%)
___Train Local_ResNet_18,  epoch 117, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3454/3910 (88.3376%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1806, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3313/3589 (92.3098%)
___Train Local_ResNet_18,  epoch 117, local model 68, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3191/3589 (88.9106%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2848, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4399/4731 (92.9825%)
___Train Local_ResNet_18,  epoch 117, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4398/4731 (92.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9453, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3989/4196 (95.0667%)
___Train Local_ResNet_18,  epoch 117, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3947/4196 (94.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9505, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4666/5035 (92.6713%)
___Train Local_ResNet_18,  epoch 117, local model 81, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4620/5035 (91.7577%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0094, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4347/4672 (93.0437%)
___Train Local_ResNet_18,  epoch 117, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4359/4672 (93.3005%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8753, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4558/4979 (91.5445%)
___Train Local_ResNet_18,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4541/4979 (91.2031%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1290, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4291/4605 (93.1813%)
___Train Local_ResNet_18,  epoch 117, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4319/4605 (93.7894%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9597, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4952/5702 (86.8467%)
___Train Local_ResNet_18,  epoch 117, local model 11, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4759/5702 (83.4619%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2200, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5031/5346 (94.1077%)
___Train Local_ResNet_18,  epoch 117, local model 3, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5022/5346 (93.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1199, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5438/5871 (92.6248%)
___Train Local_ResNet_18,  epoch 117, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5289/5871 (90.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2189, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5094/5645 (90.2391%)
___Train Local_ResNet_18,  epoch 117, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4990/5645 (88.3968%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9830, Accuracy: 5481/10000 (54.8100%)
time spent on training: 273.22604513168335
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2029, Accuracy: 6858/10000 (68.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1421, Accuracy: 9506/9900 (96.0202%)
Done in 299.62879490852356 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 53, 62, 44, 64, 3, 63, 32, 24, 73, 6, 54, 16, 25, 82, 84, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5161/5308 (97.2306%), train_poison_data_count: 415
Global model norm: 43.452408637568645.
Norm before scaling: 43.42155592047212. Distance: 1.2813806699784214
Total norm for 4 adversaries is: 43.42155592047212. distance: 1.2813806699784214
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0442, Accuracy: 9782/9900 (98.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5612/5777 (97.1438%), train_poison_data_count: 455
Global model norm: 43.452408637568645.
Norm before scaling: 43.41713916914394. Distance: 1.3611061210713855
Total norm for 4 adversaries is: 43.41713916914394. distance: 1.3611061210713855
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0740, Accuracy: 9686/9900 (97.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4925/5123 (96.1351%), train_poison_data_count: 403
Global model norm: 43.452408637568645.
Norm before scaling: 43.42465665568425. Distance: 1.371213467579897
Total norm for 4 adversaries is: 43.42465665568425. distance: 1.371213467579897
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0658, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5326/5503 (96.7836%), train_poison_data_count: 430
Global model norm: 43.452408637568645.
Norm before scaling: 43.422151908526914. Distance: 1.3654464098605221
Total norm for 4 adversaries is: 43.422151908526914. distance: 1.3654464098605221
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1021, Accuracy: 9615/9900 (97.1212%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5897/6664 (88.4904%)
___Train Local_ResNet_18,  epoch 118, local model 53, internal_epoch   2,  Average loss: 0.0086, Accuracy: 5560/6664 (83.4334%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.2822, Accuracy: 4859/10000 (48.5900%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4847/5504 (88.0632%)
___Train Local_ResNet_18,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4831/5504 (87.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0341, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4749/5075 (93.5764%)
___Train Local_ResNet_18,  epoch 118, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4684/5075 (92.2956%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0510, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4372/4894 (89.3339%)
___Train Local_ResNet_18,  epoch 118, local model 64, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4289/4894 (87.6379%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1926, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5023/5346 (93.9581%)
___Train Local_ResNet_18,  epoch 118, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4932/5346 (92.2559%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0269, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3609/3910 (92.3018%)
___Train Local_ResNet_18,  epoch 118, local model 63, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3474/3910 (88.8491%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0913, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5380/6080 (88.4868%)
___Train Local_ResNet_18,  epoch 118, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5351/6080 (88.0099%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.5243, Accuracy: 4745/10000 (47.4500%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4032/4313 (93.4848%)
___Train Local_ResNet_18,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4003/4313 (92.8124%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8915, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4315/4605 (93.7025%)
___Train Local_ResNet_18,  epoch 118, local model 73, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4312/4605 (93.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8164, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4562/4929 (92.5543%)
___Train Local_ResNet_18,  epoch 118, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4522/4929 (91.7427%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0406, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5075/5645 (89.9026%)
___Train Local_ResNet_18,  epoch 118, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4860/5645 (86.0939%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1779, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4938/5353 (92.2473%)
___Train Local_ResNet_18,  epoch 118, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4847/5353 (90.5474%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0132, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5731/6419 (89.2818%)
___Train Local_ResNet_18,  epoch 118, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5510/6419 (85.8389%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.3147, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5019/5298 (94.7339%)
___Train Local_ResNet_18,  epoch 118, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4980/5298 (93.9977%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9679, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4751/5209 (91.2075%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4693/5209 (90.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1026, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4379/4714 (92.8935%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4334/4714 (91.9389%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1154, Accuracy: 5344/10000 (53.4400%)
time spent on training: 282.1385054588318
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2077, Accuracy: 6854/10000 (68.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1368, Accuracy: 9520/9900 (96.1616%)
Done in 308.50457978248596 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 20, 31, 38, 91, 81, 60, 39, 47, 52, 84, 79, 21, 4, 77, 8, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5165/5308 (97.3060%), train_poison_data_count: 415
Global model norm: 43.474148489810155.
Norm before scaling: 43.44118127386444. Distance: 1.271208561809868
Total norm for 4 adversaries is: 43.44118127386444. distance: 1.271208561809868
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0732, Accuracy: 9701/9900 (97.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5595/5777 (96.8496%), train_poison_data_count: 455
Global model norm: 43.474148489810155.
Norm before scaling: 43.43863111162186. Distance: 1.3628002728300994
Total norm for 4 adversaries is: 43.43863111162186. distance: 1.3628002728300994
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0648, Accuracy: 9730/9900 (98.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4910/5123 (95.8423%), train_poison_data_count: 403
Global model norm: 43.474148489810155.
Norm before scaling: 43.44924807408208. Distance: 1.4583094004529151
Total norm for 4 adversaries is: 43.44924807408208. distance: 1.4583094004529151
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0881, Accuracy: 9671/9900 (97.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5311/5503 (96.5110%), train_poison_data_count: 430
Global model norm: 43.474148489810155.
Norm before scaling: 43.4446388580664. Distance: 1.3865044656592895
Total norm for 4 adversaries is: 43.4446388580664. distance: 1.3865044656592895
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0288, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4376/4714 (92.8299%)
___Train Local_ResNet_18,  epoch 119, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4385/4714 (93.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8839, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4213/4537 (92.8587%)
___Train Local_ResNet_18,  epoch 119, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4218/4537 (92.9689%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8262, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5609/6235 (89.9599%)
___Train Local_ResNet_18,  epoch 119, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5472/6235 (87.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.4156, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4068/4527 (89.8608%)
___Train Local_ResNet_18,  epoch 119, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4017/4527 (88.7343%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0135, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4700/5035 (93.3466%)
___Train Local_ResNet_18,  epoch 119, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4703/5035 (93.4062%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9436, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3782/4145 (91.2425%)
___Train Local_ResNet_18,  epoch 119, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3791/4145 (91.4596%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0914, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3865/4175 (92.5749%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3805/4175 (91.1377%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0670, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4618/5123 (90.1425%)
___Train Local_ResNet_18,  epoch 119, local model 47, internal_epoch   2,  Average loss: 0.0158, Accuracy: 3683/5123 (71.8915%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.4736, Accuracy: 4608/10000 (46.0800%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3895/4130 (94.3099%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3875/4130 (93.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9100, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4783/5209 (91.8218%)
___Train Local_ResNet_18,  epoch 119, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4690/5209 (90.0365%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1763, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3824/4111 (93.0187%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3778/4111 (91.8998%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8690, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4645/5038 (92.1993%)
___Train Local_ResNet_18,  epoch 119, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4621/5038 (91.7229%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9743, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3759/4028 (93.3217%)
___Train Local_ResNet_18,  epoch 119, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3779/4028 (93.8183%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8345, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4541/5050 (89.9208%)
___Train Local_ResNet_18,  epoch 119, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4526/5050 (89.6238%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.3043, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4477/4889 (91.5729%)
___Train Local_ResNet_18,  epoch 119, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4332/4889 (88.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1286, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4058/4364 (92.9881%)
___Train Local_ResNet_18,  epoch 119, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3988/4364 (91.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9625, Accuracy: 5550/10000 (55.5000%)
time spent on training: 265.95914340019226
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2064, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1310, Accuracy: 9545/9900 (96.4141%)
Done in 292.2885375022888 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 72, 30, 96, 38, 62, 1, 31, 88, 21, 34, 43, 37, 10, 83, 93, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5164/5308 (97.2871%), train_poison_data_count: 415
Global model norm: 43.49329684120517.
Norm before scaling: 43.4625925163489. Distance: 1.3130670866435155
Total norm for 4 adversaries is: 43.4625925163489. distance: 1.3130670866435155
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0382, Accuracy: 9791/9900 (98.8990%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.49329684120517.
Norm before scaling: 43.4549355182865. Distance: 1.3118589743207383
Total norm for 4 adversaries is: 43.4549355182865. distance: 1.3118589743207383
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0554, Accuracy: 9750/9900 (98.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4939/5123 (96.4084%), train_poison_data_count: 403
Global model norm: 43.49329684120517.
Norm before scaling: 43.464915190749686. Distance: 1.3663919368493709
Total norm for 4 adversaries is: 43.464915190749686. distance: 1.3663919368493709
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1522, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5314/5503 (96.5655%), train_poison_data_count: 430
Global model norm: 43.49329684120517.
Norm before scaling: 43.46665781719219. Distance: 1.430330642541793
Total norm for 4 adversaries is: 43.46665781719219. distance: 1.430330642541793
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1105, Accuracy: 9603/9900 (97.0000%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4775/5193 (91.9507%)
___Train Local_ResNet_18,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4482/5193 (86.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.4917, Accuracy: 4826/10000 (48.2600%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3504/3774 (92.8458%)
___Train Local_ResNet_18,  epoch 120, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3491/3774 (92.5013%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8998, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4651/5086 (91.4471%)
___Train Local_ResNet_18,  epoch 120, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4615/5086 (90.7393%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0100, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5594/6235 (89.7193%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5498/6235 (88.1796%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.4730, Accuracy: 4724/10000 (47.2400%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4911/5504 (89.2260%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4828/5504 (87.7180%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1241, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5098/5422 (94.0243%)
___Train Local_ResNet_18,  epoch 120, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5045/5422 (93.0468%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9779, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4225/4537 (93.1232%)
___Train Local_ResNet_18,  epoch 120, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4160/4537 (91.6905%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9455, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4934/5362 (92.0179%)
___Train Local_ResNet_18,  epoch 120, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4894/5362 (91.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1394, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4601/5038 (91.3259%)
___Train Local_ResNet_18,  epoch 120, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4631/5038 (91.9214%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9055, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4570/4911 (93.0564%)
___Train Local_ResNet_18,  epoch 120, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4581/4911 (93.2804%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1158, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4604/4979 (92.4684%)
___Train Local_ResNet_18,  epoch 120, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4568/4979 (91.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0600, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4325/4741 (91.2255%)
___Train Local_ResNet_18,  epoch 120, local model 37, internal_epoch   2,  Average loss: 0.0101, Accuracy: 3833/4741 (80.8479%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.7669, Accuracy: 4326/10000 (43.2600%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4746/5068 (93.6464%)
___Train Local_ResNet_18,  epoch 120, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4662/5068 (91.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0252, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3258/3552 (91.7230%)
___Train Local_ResNet_18,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3287/3552 (92.5394%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7977, Accuracy: 5917/10000 (59.1700%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4660/5055 (92.1860%)
___Train Local_ResNet_18,  epoch 120, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4569/5055 (90.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1407, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3651/3959 (92.2203%)
___Train Local_ResNet_18,  epoch 120, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3626/3959 (91.5888%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9962, Accuracy: 5612/10000 (56.1200%)
time spent on training: 275.3905940055847
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2096, Accuracy: 6839/10000 (68.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1248, Accuracy: 9562/9900 (96.5859%)
Done in 301.8091537952423 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 86, 74, 94, 24, 51, 84, 63, 26, 28, 88, 55, 2, 33, 98, 34, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5173/5308 (97.4567%), train_poison_data_count: 415
Global model norm: 43.51295576418519.
Norm before scaling: 43.47989444218011. Distance: 1.2665769505517643
Total norm for 4 adversaries is: 43.47989444218011. distance: 1.2665769505517643
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0586, Accuracy: 9748/9900 (98.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5620/5777 (97.2823%), train_poison_data_count: 455
Global model norm: 43.51295576418519.
Norm before scaling: 43.47738305043281. Distance: 1.3404344863505548
Total norm for 4 adversaries is: 43.47738305043281. distance: 1.3404344863505548
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1418, Accuracy: 9555/9900 (96.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4918/5123 (95.9984%), train_poison_data_count: 403
Global model norm: 43.51295576418519.
Norm before scaling: 43.48512592551403. Distance: 1.4013147430708222
Total norm for 4 adversaries is: 43.48512592551403. distance: 1.4013147430708222
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0605, Accuracy: 9733/9900 (98.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5339/5503 (97.0198%), train_poison_data_count: 430
Global model norm: 43.51295576418519.
Norm before scaling: 43.48277485377831. Distance: 1.3582739481592017
Total norm for 4 adversaries is: 43.48277485377831. distance: 1.3582739481592017
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0191, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3563/3929 (90.6847%)
___Train Local_ResNet_18,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3532/3929 (89.8956%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9622, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4378/4797 (91.2654%)
___Train Local_ResNet_18,  epoch 121, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4283/4797 (89.2850%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1521, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4717/5224 (90.2948%)
___Train Local_ResNet_18,  epoch 121, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4728/5224 (90.5054%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2781, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4030/4313 (93.4384%)
___Train Local_ResNet_18,  epoch 121, local model 24, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4044/4313 (93.7630%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7817, Accuracy: 5800/10000 (58.0000%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3845/4108 (93.5979%)
___Train Local_ResNet_18,  epoch 121, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3809/4108 (92.7215%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9380, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4733/5209 (90.8620%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4678/5209 (89.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1894, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3648/3910 (93.2992%)
___Train Local_ResNet_18,  epoch 121, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3598/3910 (92.0205%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0947, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3824/4086 (93.5879%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3808/4086 (93.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0741, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4575/5122 (89.3206%)
___Train Local_ResNet_18,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4379/5122 (85.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.4257, Accuracy: 4878/10000 (48.7800%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4909/5362 (91.5517%)
___Train Local_ResNet_18,  epoch 121, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4818/5362 (89.8545%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0921, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4398/4731 (92.9613%)
___Train Local_ResNet_18,  epoch 121, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4372/4731 (92.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0459, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3645/3968 (91.8599%)
___Train Local_ResNet_18,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3649/3968 (91.9607%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8448, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4450/4818 (92.3620%)
___Train Local_ResNet_18,  epoch 121, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4350/4818 (90.2864%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0772, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3871/4161 (93.0305%)
___Train Local_ResNet_18,  epoch 121, local model 98, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3796/4161 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0125, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4512/4911 (91.8754%)
___Train Local_ResNet_18,  epoch 121, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4529/4911 (92.2215%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0827, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4749/5068 (93.7056%)
___Train Local_ResNet_18,  epoch 121, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4774/5068 (94.1989%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0335, Accuracy: 5515/10000 (55.1500%)
time spent on training: 269.18597745895386
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2189, Accuracy: 6821/10000 (68.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1166, Accuracy: 9589/9900 (96.8586%)
Done in 295.6678235530853 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 33, 32, 46, 38, 22, 73, 61, 35, 83, 24, 87, 23, 3, 19, 98, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 43.53152481069036.
Norm before scaling: 43.497353659626526. Distance: 1.2312036166676474
Total norm for 4 adversaries is: 43.497353659626526. distance: 1.2312036166676474
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0615, Accuracy: 9736/9900 (98.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5623/5777 (97.3343%), train_poison_data_count: 455
Global model norm: 43.53152481069036.
Norm before scaling: 43.495731538961095. Distance: 1.3506607399041932
Total norm for 4 adversaries is: 43.495731538961095. distance: 1.3506607399041932
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0933, Accuracy: 9665/9900 (97.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4926/5123 (96.1546%), train_poison_data_count: 403
Global model norm: 43.53152481069036.
Norm before scaling: 43.50192922939956. Distance: 1.3465347709996607
Total norm for 4 adversaries is: 43.50192922939956. distance: 1.3465347709996607
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1679, Accuracy: 9477/9900 (95.7273%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5318/5503 (96.6382%), train_poison_data_count: 430
Global model norm: 43.53152481069036.
Norm before scaling: 43.50119683384082. Distance: 1.4128234239817017
Total norm for 4 adversaries is: 43.50119683384082. distance: 1.4128234239817017
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0862, Accuracy: 9675/9900 (97.7273%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4462/4818 (92.6110%)
___Train Local_ResNet_18,  epoch 122, local model 33, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4243/4818 (88.0656%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0659, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5467/6080 (89.9178%)
___Train Local_ResNet_18,  epoch 122, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5314/6080 (87.4013%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1860, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4834/5399 (89.5351%)
___Train Local_ResNet_18,  epoch 122, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4713/5399 (87.2939%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2993, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5600/6235 (89.8156%)
___Train Local_ResNet_18,  epoch 122, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5436/6235 (87.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2739, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5342/5696 (93.7851%)
___Train Local_ResNet_18,  epoch 122, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5253/5696 (92.2226%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0299, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4329/4605 (94.0065%)
___Train Local_ResNet_18,  epoch 122, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4350/4605 (94.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8179, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4142/4485 (92.3523%)
___Train Local_ResNet_18,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4012/4485 (89.4537%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1306, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5140/5615 (91.5405%)
___Train Local_ResNet_18,  epoch 122, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5108/5615 (90.9706%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1633, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3257/3552 (91.6948%)
___Train Local_ResNet_18,  epoch 122, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3305/3552 (93.0462%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7621, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4019/4313 (93.1834%)
___Train Local_ResNet_18,  epoch 122, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4057/4313 (94.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7659, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3618/3995 (90.5632%)
___Train Local_ResNet_18,  epoch 122, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3585/3995 (89.7372%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.4206, Accuracy: 4912/10000 (49.1200%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4326/4549 (95.0978%)
___Train Local_ResNet_18,  epoch 122, local model 23, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3995/4549 (87.8215%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1859, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5015/5346 (93.8085%)
___Train Local_ResNet_18,  epoch 122, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4960/5346 (92.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.1293, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4865/5361 (90.7480%)
___Train Local_ResNet_18,  epoch 122, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4782/5361 (89.1998%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2251, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3863/4161 (92.8383%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3839/4161 (92.2615%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0318, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4395/4714 (93.2329%)
___Train Local_ResNet_18,  epoch 122, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4416/4714 (93.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9914, Accuracy: 5603/10000 (56.0300%)
time spent on training: 273.16841864585876
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2285, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1154, Accuracy: 9587/9900 (96.8384%)
Done in 299.6592879295349 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 9, 53, 69, 0, 77, 5, 33, 81, 92, 66, 83, 47, 17, 1, 84, 22].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5177/5308 (97.5320%), train_poison_data_count: 415
Global model norm: 43.551746677623335.
Norm before scaling: 43.51727302759. Distance: 1.2462620158175817
Total norm for 4 adversaries is: 43.51727302759. distance: 1.2462620158175817
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1086, Accuracy: 9613/9900 (97.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5605/5777 (97.0227%), train_poison_data_count: 455
Global model norm: 43.551746677623335.
Norm before scaling: 43.51498120035429. Distance: 1.3827753439184027
Total norm for 4 adversaries is: 43.51498120035429. distance: 1.3827753439184027
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0415, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4947/5123 (96.5645%), train_poison_data_count: 403
Global model norm: 43.551746677623335.
Norm before scaling: 43.52124767310144. Distance: 1.3440758953123217
Total norm for 4 adversaries is: 43.52124767310144. distance: 1.3440758953123217
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0834, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5338/5503 (97.0016%), train_poison_data_count: 430
Global model norm: 43.551746677623335.
Norm before scaling: 43.52013413576884. Distance: 1.3616389134651434
Total norm for 4 adversaries is: 43.52013413576884. distance: 1.3616389134651434
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0489, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5150/5727 (89.9249%)
___Train Local_ResNet_18,  epoch 123, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5090/5727 (88.8772%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1355, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5840/6664 (87.6351%)
___Train Local_ResNet_18,  epoch 123, local model 53, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5760/6664 (86.4346%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1311, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4049/4364 (92.7819%)
___Train Local_ResNet_18,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3916/4364 (89.7342%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0105, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4989/5454 (91.4741%)
___Train Local_ResNet_18,  epoch 123, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4823/5454 (88.4305%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0910, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4471/5050 (88.5347%)
___Train Local_ResNet_18,  epoch 123, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4431/5050 (87.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0356, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4723/4993 (94.5924%)
___Train Local_ResNet_18,  epoch 123, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4638/4993 (92.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0080, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4425/4818 (91.8431%)
___Train Local_ResNet_18,  epoch 123, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4296/4818 (89.1656%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0196, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4704/5035 (93.4260%)
___Train Local_ResNet_18,  epoch 123, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4685/5035 (93.0487%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9228, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6389/6812 (93.7904%)
___Train Local_ResNet_18,  epoch 123, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 6311/6812 (92.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1150, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4477/4843 (92.4427%)
___Train Local_ResNet_18,  epoch 123, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4463/4843 (92.1536%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0575, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3316/3552 (93.3559%)
___Train Local_ResNet_18,  epoch 123, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3328/3552 (93.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8323, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4627/5123 (90.3182%)
___Train Local_ResNet_18,  epoch 123, local model 47, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4410/5123 (86.0824%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.3871, Accuracy: 4914/10000 (49.1400%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4477/4903 (91.3114%)
___Train Local_ResNet_18,  epoch 123, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4400/4903 (89.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1014, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5125/5422 (94.5223%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5080/5422 (93.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8570, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4756/5209 (91.3035%)
___Train Local_ResNet_18,  epoch 123, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4730/5209 (90.8044%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1186, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5299/5696 (93.0302%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5207/5696 (91.4150%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0807, Accuracy: 5401/10000 (54.0100%)
time spent on training: 281.1200976371765
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2264, Accuracy: 6817/10000 (68.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1199, Accuracy: 9583/9900 (96.7980%)
Done in 307.5426046848297 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 33, 99, 27, 61, 22, 75, 85, 54, 11, 37, 60, 21, 32, 64, 29, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5139/5308 (96.8161%), train_poison_data_count: 415
Global model norm: 43.573177829622146.
Norm before scaling: 43.5418654052482. Distance: 1.3289497955920313
Total norm for 4 adversaries is: 43.5418654052482. distance: 1.3289497955920313
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0993, Accuracy: 9651/9900 (97.4848%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5622/5777 (97.3169%), train_poison_data_count: 455
Global model norm: 43.573177829622146.
Norm before scaling: 43.53685102830632. Distance: 1.3579802976816717
Total norm for 4 adversaries is: 43.53685102830632. distance: 1.3579802976816717
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0916, Accuracy: 9667/9900 (97.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4946/5123 (96.5450%), train_poison_data_count: 403
Global model norm: 43.573177829622146.
Norm before scaling: 43.54242890830018. Distance: 1.3402276559570674
Total norm for 4 adversaries is: 43.54242890830018. distance: 1.3402276559570674
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1422, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5319/5503 (96.6564%), train_poison_data_count: 430
Global model norm: 43.573177829622146.
Norm before scaling: 43.54464079754821. Distance: 1.4393624389736412
Total norm for 4 adversaries is: 43.54464079754821. distance: 1.4393624389736412
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0310, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4430/4818 (91.9469%)
___Train Local_ResNet_18,  epoch 124, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4291/4818 (89.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0212, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4460/4851 (91.9398%)
___Train Local_ResNet_18,  epoch 124, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4427/4851 (91.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9976, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4246/4587 (92.5659%)
___Train Local_ResNet_18,  epoch 124, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4192/4587 (91.3887%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0406, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4146/4485 (92.4415%)
___Train Local_ResNet_18,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3951/4485 (88.0936%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9778, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5330/5696 (93.5744%)
___Train Local_ResNet_18,  epoch 124, local model 22, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5249/5696 (92.1524%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1007, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4340/4672 (92.8938%)
___Train Local_ResNet_18,  epoch 124, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4341/4672 (92.9152%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8612, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 6259/6947 (90.0964%)
___Train Local_ResNet_18,  epoch 124, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 6023/6947 (86.6993%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.5024, Accuracy: 4916/10000 (49.1600%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5058/5645 (89.6014%)
___Train Local_ResNet_18,  epoch 124, local model 54, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4910/5645 (86.9796%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.3398, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 4917/5702 (86.2329%)
___Train Local_ResNet_18,  epoch 124, local model 11, internal_epoch   2,  Average loss: 0.0126, Accuracy: 4321/5702 (75.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1622, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4323/4741 (91.1833%)
___Train Local_ResNet_18,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4092/4741 (86.3109%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2559, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3827/4145 (92.3281%)
___Train Local_ResNet_18,  epoch 124, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3758/4145 (90.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9983, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4667/5038 (92.6360%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4608/5038 (91.4649%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9396, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5391/6080 (88.6678%)
___Train Local_ResNet_18,  epoch 124, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5278/6080 (86.8092%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1749, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4396/4894 (89.8243%)
___Train Local_ResNet_18,  epoch 124, local model 64, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4280/4894 (87.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2427, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4445/4732 (93.9349%)
___Train Local_ResNet_18,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4484/4732 (94.7591%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.8264, Accuracy: 5778/10000 (57.7800%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3948/4249 (92.9160%)
___Train Local_ResNet_18,  epoch 124, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3901/4249 (91.8098%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0350, Accuracy: 5491/10000 (54.9100%)
time spent on training: 278.98771953582764
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2274, Accuracy: 6830/10000 (68.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1263, Accuracy: 9564/9900 (96.6061%)
Done in 305.46083879470825 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 53, 50, 93, 1, 7, 79, 52, 24, 16, 28, 10, 62, 86, 47, 98, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.594842056214056.
Norm before scaling: 43.564332592371365. Distance: 1.3153978781475524
Total norm for 4 adversaries is: 43.564332592371365. distance: 1.3153978781475524
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0715, Accuracy: 9698/9900 (97.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5611/5777 (97.1265%), train_poison_data_count: 455
Global model norm: 43.594842056214056.
Norm before scaling: 43.55834976195006. Distance: 1.392298388105546
Total norm for 4 adversaries is: 43.55834976195006. distance: 1.392298388105546
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0741, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4944/5123 (96.5060%), train_poison_data_count: 403
Global model norm: 43.594842056214056.
Norm before scaling: 43.564722078370075. Distance: 1.3295438480441593
Total norm for 4 adversaries is: 43.564722078370075. distance: 1.3295438480441593
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0380, Accuracy: 9793/9900 (98.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5333/5503 (96.9108%), train_poison_data_count: 430
Global model norm: 43.594842056214056.
Norm before scaling: 43.56438863373673. Distance: 1.370519142707481
Total norm for 4 adversaries is: 43.56438863373673. distance: 1.370519142707481
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0594, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5888/6664 (88.3553%)
___Train Local_ResNet_18,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0076, Accuracy: 5690/6664 (85.3842%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2763, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4423/4757 (92.9788%)
___Train Local_ResNet_18,  epoch 125, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4334/4757 (91.1078%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1066, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4637/5055 (91.7310%)
___Train Local_ResNet_18,  epoch 125, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4602/5055 (91.0386%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1463, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5133/5422 (94.6699%)
___Train Local_ResNet_18,  epoch 125, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5056/5422 (93.2497%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9247, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4409/4869 (90.5525%)
___Train Local_ResNet_18,  epoch 125, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4180/4869 (85.8493%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4249, Accuracy: 4946/10000 (49.4600%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3822/4111 (92.9701%)
___Train Local_ResNet_18,  epoch 125, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3787/4111 (92.1187%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.1174, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3879/4130 (93.9225%)
___Train Local_ResNet_18,  epoch 125, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3781/4130 (91.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0853, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4039/4313 (93.6471%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4041/4313 (93.6935%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7138, Accuracy: 6033/10000 (60.3300%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4932/5353 (92.1353%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4825/5353 (90.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2105, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4651/5122 (90.8044%)
___Train Local_ResNet_18,  epoch 125, local model 28, internal_epoch   2,  Average loss: 0.0095, Accuracy: 4263/5122 (83.2292%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2909, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4725/5068 (93.2320%)
___Train Local_ResNet_18,  epoch 125, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4706/5068 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0965, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4911/5504 (89.2260%)
___Train Local_ResNet_18,  epoch 125, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4829/5504 (87.7362%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3703, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3595/3929 (91.4991%)
___Train Local_ResNet_18,  epoch 125, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3594/3929 (91.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0499, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4680/5123 (91.3527%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0092, Accuracy: 4269/5123 (83.3301%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3724, Accuracy: 4869/10000 (48.6900%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3915/4161 (94.0880%)
___Train Local_ResNet_18,  epoch 125, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3824/4161 (91.9010%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9990, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4990/5454 (91.4925%)
___Train Local_ResNet_18,  epoch 125, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4876/5454 (89.4023%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9931, Accuracy: 5544/10000 (55.4400%)
time spent on training: 277.5843815803528
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2324, Accuracy: 6809/10000 (68.0900%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1163, Accuracy: 9596/9900 (96.9293%)
Done in 303.9432375431061 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 2, 78, 57, 41, 70, 21, 35, 39, 46, 53, 29, 48, 56, 65, 45, 93].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5172/5308 (97.4378%), train_poison_data_count: 415
Global model norm: 43.61561951440103.
Norm before scaling: 43.58088968013962. Distance: 1.2177841075928395
Total norm for 4 adversaries is: 43.58088968013962. distance: 1.2177841075928395
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1099, Accuracy: 9607/9900 (97.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.61561951440103.
Norm before scaling: 43.578300073599564. Distance: 1.3423252536839019
Total norm for 4 adversaries is: 43.578300073599564. distance: 1.3423252536839019
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0804, Accuracy: 9692/9900 (97.8990%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4945/5123 (96.5255%), train_poison_data_count: 403
Global model norm: 43.61561951440103.
Norm before scaling: 43.58607263265483. Distance: 1.3516958534736472
Total norm for 4 adversaries is: 43.58607263265483. distance: 1.3516958534736472
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1826, Accuracy: 9430/9900 (95.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5323/5503 (96.7291%), train_poison_data_count: 430
Global model norm: 43.61561951440103.
Norm before scaling: 43.58449722593459. Distance: 1.3772757077950253
Total norm for 4 adversaries is: 43.58449722593459. distance: 1.3772757077950253
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0789, Accuracy: 9689/9900 (97.8687%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3707/3968 (93.4224%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3690/3968 (92.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9077, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4108/4368 (94.0476%)
___Train Local_ResNet_18,  epoch 126, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3967/4368 (90.8196%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1073, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4587/4956 (92.5545%)
___Train Local_ResNet_18,  epoch 126, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4543/4956 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0640, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4404/4714 (93.4238%)
___Train Local_ResNet_18,  epoch 126, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4344/4714 (92.1510%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0188, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5474/5871 (93.2379%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5427/5871 (92.4374%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0492, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4654/5038 (92.3779%)
___Train Local_ResNet_18,  epoch 126, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4647/5038 (92.2390%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9160, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5135/5615 (91.4515%)
___Train Local_ResNet_18,  epoch 126, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5099/5615 (90.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1688, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3812/4175 (91.3054%)
___Train Local_ResNet_18,  epoch 126, local model 39, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3754/4175 (89.9162%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9880, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4834/5399 (89.5351%)
___Train Local_ResNet_18,  epoch 126, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4698/5399 (87.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2928, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5876/6664 (88.1753%)
___Train Local_ResNet_18,  epoch 126, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5800/6664 (87.0348%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0825, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4439/4732 (93.8081%)
___Train Local_ResNet_18,  epoch 126, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4437/4732 (93.7658%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9358, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4529/4830 (93.7681%)
___Train Local_ResNet_18,  epoch 126, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4485/4830 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0048, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4917/5427 (90.6025%)
___Train Local_ResNet_18,  epoch 126, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4874/5427 (89.8102%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0137, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5085/5497 (92.5050%)
___Train Local_ResNet_18,  epoch 126, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4988/5497 (90.7404%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1058, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5022/5489 (91.4921%)
___Train Local_ResNet_18,  epoch 126, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4983/5489 (90.7816%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1031, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4636/5055 (91.7112%)
___Train Local_ResNet_18,  epoch 126, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4578/5055 (90.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1688, Accuracy: 5263/10000 (52.6300%)
time spent on training: 271.40195870399475
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2355, Accuracy: 6801/10000 (68.0100%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1203, Accuracy: 9577/9900 (96.7374%)
Done in 297.82921981811523 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 55, 61, 17, 94, 19, 54, 21, 96, 8, 84, 97, 57, 90, 95, 73, 16].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5167/5308 (97.3436%), train_poison_data_count: 415
Global model norm: 43.636215036312585.
Norm before scaling: 43.602349902180585. Distance: 1.2805693609569693
Total norm for 4 adversaries is: 43.602349902180585. distance: 1.2805693609569693
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0603, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5613/5777 (97.1612%), train_poison_data_count: 455
Global model norm: 43.636215036312585.
Norm before scaling: 43.59887402681691. Distance: 1.3562453625859028
Total norm for 4 adversaries is: 43.59887402681691. distance: 1.3562453625859028
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0483, Accuracy: 9779/9900 (98.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4941/5123 (96.4474%), train_poison_data_count: 403
Global model norm: 43.636215036312585.
Norm before scaling: 43.606535143560336. Distance: 1.3632595202618816
Total norm for 4 adversaries is: 43.606535143560336. distance: 1.3632595202618816
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0213, Accuracy: 9838/9900 (99.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5327/5503 (96.8017%), train_poison_data_count: 430
Global model norm: 43.636215036312585.
Norm before scaling: 43.60460354360893. Distance: 1.3931188616953254
Total norm for 4 adversaries is: 43.60460354360893. distance: 1.3931188616953254
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0332, Accuracy: 9817/9900 (99.1616%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4452/4731 (94.1027%)
___Train Local_ResNet_18,  epoch 127, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4363/4731 (92.2215%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9529, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4116/4485 (91.7726%)
___Train Local_ResNet_18,  epoch 127, local model 61, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3877/4485 (86.4437%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1784, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4409/4903 (89.9245%)
___Train Local_ResNet_18,  epoch 127, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4373/4903 (89.1903%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1348, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4758/5224 (91.0796%)
___Train Local_ResNet_18,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4783/5224 (91.5582%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0790, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4849/5361 (90.4495%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4742/5361 (88.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2192, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5088/5645 (90.1329%)
___Train Local_ResNet_18,  epoch 127, local model 54, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4976/5645 (88.1488%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2841, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4671/5038 (92.7154%)
___Train Local_ResNet_18,  epoch 127, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4632/5038 (91.9412%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8874, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4653/5086 (91.4864%)
___Train Local_ResNet_18,  epoch 127, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4604/5086 (90.5230%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1517, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4492/4889 (91.8797%)
___Train Local_ResNet_18,  epoch 127, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4486/4889 (91.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1661, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4813/5209 (92.3978%)
___Train Local_ResNet_18,  epoch 127, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4709/5209 (90.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1124, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4258/4736 (89.9071%)
___Train Local_ResNet_18,  epoch 127, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4262/4736 (89.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1249, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4585/4956 (92.5141%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4480/4956 (90.3955%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0163, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4428/4748 (93.2603%)
___Train Local_ResNet_18,  epoch 127, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4389/4748 (92.4389%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0023, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4544/5018 (90.5540%)
___Train Local_ResNet_18,  epoch 127, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4389/5018 (87.4651%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.2513, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4359/4605 (94.6580%)
___Train Local_ResNet_18,  epoch 127, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4331/4605 (94.0499%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9062, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4943/5353 (92.3407%)
___Train Local_ResNet_18,  epoch 127, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4848/5353 (90.5660%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0556, Accuracy: 5467/10000 (54.6700%)
time spent on training: 276.72902035713196
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2440, Accuracy: 6802/10000 (68.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1036, Accuracy: 9622/9900 (97.1919%)
Done in 303.4390652179718 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 10, 72, 34, 67, 60, 23, 86, 20, 99, 97, 64, 73, 68, 40, 30, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5175/5308 (97.4943%), train_poison_data_count: 415
Global model norm: 43.657287366880404.
Norm before scaling: 43.62397305829244. Distance: 1.261600311672702
Total norm for 4 adversaries is: 43.62397305829244. distance: 1.261600311672702
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0947, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5621/5777 (97.2996%), train_poison_data_count: 455
Global model norm: 43.657287366880404.
Norm before scaling: 43.620363180335566. Distance: 1.3916509037305311
Total norm for 4 adversaries is: 43.620363180335566. distance: 1.3916509037305311
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0879, Accuracy: 9676/9900 (97.7374%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4948/5123 (96.5840%), train_poison_data_count: 403
Global model norm: 43.657287366880404.
Norm before scaling: 43.62724827435473. Distance: 1.341236558333108
Total norm for 4 adversaries is: 43.62724827435473. distance: 1.341236558333108
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1028, Accuracy: 9645/9900 (97.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5342/5503 (97.0743%), train_poison_data_count: 430
Global model norm: 43.657287366880404.
Norm before scaling: 43.62358969783436. Distance: 1.3490671042796074
Total norm for 4 adversaries is: 43.62358969783436. distance: 1.3490671042796074
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0675, Accuracy: 9715/9900 (98.1313%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4743/5068 (93.5872%)
___Train Local_ResNet_18,  epoch 128, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4623/5068 (91.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2282, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4734/5193 (91.1612%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4563/5193 (87.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2748, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4545/4911 (92.5473%)
___Train Local_ResNet_18,  epoch 128, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4509/4911 (91.8143%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9726, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5045/5559 (90.7537%)
___Train Local_ResNet_18,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4911/5559 (88.3432%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2861, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3793/4145 (91.5078%)
___Train Local_ResNet_18,  epoch 128, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3835/4145 (92.5211%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0492, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4284/4549 (94.1745%)
___Train Local_ResNet_18,  epoch 128, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4114/4549 (90.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9777, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3571/3929 (90.8883%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3580/3929 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9385, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4409/4714 (93.5299%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4415/4714 (93.6572%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9937, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4447/4851 (91.6718%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4451/4851 (91.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9615, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4287/4736 (90.5194%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4217/4736 (89.0414%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0555, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4449/4894 (90.9072%)
___Train Local_ResNet_18,  epoch 128, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4290/4894 (87.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4361, Accuracy: 4927/10000 (49.2700%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4342/4605 (94.2888%)
___Train Local_ResNet_18,  epoch 128, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4312/4605 (93.6374%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0881, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3336/3589 (92.9507%)
___Train Local_ResNet_18,  epoch 128, local model 68, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3045/3589 (84.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.4683, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5505/5939 (92.6924%)
___Train Local_ResNet_18,  epoch 128, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5458/5939 (91.9010%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0401, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3518/3774 (93.2167%)
___Train Local_ResNet_18,  epoch 128, local model 30, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3542/3774 (93.8527%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0062, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3258/3552 (91.7230%)
___Train Local_ResNet_18,  epoch 128, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3310/3552 (93.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9167, Accuracy: 5739/10000 (57.3900%)
time spent on training: 268.53671765327454
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2484, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0977, Accuracy: 9637/9900 (97.3434%)
Done in 294.5624346733093 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 37, 33, 25, 48, 65, 95, 38, 74, 43, 26, 15, 14, 49, 79, 8, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5179/5308 (97.5697%), train_poison_data_count: 415
Global model norm: 43.676152798090946.
Norm before scaling: 43.641655745525256. Distance: 1.244599741208287
Total norm for 4 adversaries is: 43.641655745525256. distance: 1.244599741208287
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0910, Accuracy: 9657/9900 (97.5455%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5620/5777 (97.2823%), train_poison_data_count: 455
Global model norm: 43.676152798090946.
Norm before scaling: 43.64028793953258. Distance: 1.3783945317426138
Total norm for 4 adversaries is: 43.64028793953258. distance: 1.3783945317426138
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0323, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4935/5123 (96.3303%), train_poison_data_count: 403
Global model norm: 43.676152798090946.
Norm before scaling: 43.645993840446714. Distance: 1.3384449944919812
Total norm for 4 adversaries is: 43.645993840446714. distance: 1.3384449944919812
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1197, Accuracy: 9584/9900 (96.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5346/5503 (97.1470%), train_poison_data_count: 430
Global model norm: 43.676152798090946.
Norm before scaling: 43.64309343403819. Distance: 1.337518838054582
Total norm for 4 adversaries is: 43.64309343403819. distance: 1.337518838054582
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0809, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4369/4741 (92.1536%)
___Train Local_ResNet_18,  epoch 129, local model 37, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4178/4741 (88.1249%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.4495, Accuracy: 5036/10000 (50.3600%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4455/4818 (92.4658%)
___Train Local_ResNet_18,  epoch 129, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4402/4818 (91.3657%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0825, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5698/6419 (88.7677%)
___Train Local_ResNet_18,  epoch 129, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5593/6419 (87.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2972, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4530/4830 (93.7888%)
___Train Local_ResNet_18,  epoch 129, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4539/4830 (93.9752%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0455, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5051/5497 (91.8865%)
___Train Local_ResNet_18,  epoch 129, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5008/5497 (91.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2693, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4514/5018 (89.9562%)
___Train Local_ResNet_18,  epoch 129, local model 95, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4486/5018 (89.3982%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2601, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5678/6235 (91.0666%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5528/6235 (88.6608%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2158, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4356/4797 (90.8068%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4326/4797 (90.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0977, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4623/4979 (92.8500%)
___Train Local_ResNet_18,  epoch 129, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4611/4979 (92.6090%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0933, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3805/4086 (93.1229%)
___Train Local_ResNet_18,  epoch 129, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3807/4086 (93.1718%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0188, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5604/6068 (92.3533%)
___Train Local_ResNet_18,  epoch 129, local model 15, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5590/6068 (92.1226%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2815, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3966/4196 (94.5186%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3976/4196 (94.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8020, Accuracy: 5903/10000 (59.0300%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5106/5652 (90.3397%)
___Train Local_ResNet_18,  epoch 129, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5057/5652 (89.4728%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0641, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3835/4111 (93.2863%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3789/4111 (92.1674%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9950, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4526/4889 (92.5752%)
___Train Local_ResNet_18,  epoch 129, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4494/4889 (91.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1291, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4081/4368 (93.4295%)
___Train Local_ResNet_18,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3939/4368 (90.1786%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1983, Accuracy: 5189/10000 (51.8900%)
time spent on training: 278.0685167312622
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2486, Accuracy: 6799/10000 (67.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0948, Accuracy: 9644/9900 (97.4141%)
Done in 304.17878890037537 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 55, 3, 46, 33, 49, 20, 1, 52, 29, 54, 11, 97, 91, 79, 88, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 43.6964530011626.
Norm before scaling: 43.66366201842643. Distance: 1.293437400314648
Total norm for 4 adversaries is: 43.66366201842643. distance: 1.293437400314648
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0243, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5599/5777 (96.9188%), train_poison_data_count: 455
Global model norm: 43.6964530011626.
Norm before scaling: 43.659575917957994. Distance: 1.3608721676899755
Total norm for 4 adversaries is: 43.659575917957994. distance: 1.3608721676899755
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0680, Accuracy: 9723/9900 (98.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4937/5123 (96.3693%), train_poison_data_count: 403
Global model norm: 43.6964530011626.
Norm before scaling: 43.664351151980235. Distance: 1.297069213296901
Total norm for 4 adversaries is: 43.664351151980235. distance: 1.297069213296901
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0993, Accuracy: 9645/9900 (97.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5334/5503 (96.9289%), train_poison_data_count: 430
Global model norm: 43.6964530011626.
Norm before scaling: 43.66465867257166. Distance: 1.3544643319475966
Total norm for 4 adversaries is: 43.66465867257166. distance: 1.3544643319475966
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0434, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4426/4731 (93.5532%)
___Train Local_ResNet_18,  epoch 130, local model 55, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4394/4731 (92.8768%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1001, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5023/5346 (93.9581%)
___Train Local_ResNet_18,  epoch 130, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4900/5346 (91.6573%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1146, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4863/5399 (90.0722%)
___Train Local_ResNet_18,  epoch 130, local model 46, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4718/5399 (87.3866%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3143, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4492/4818 (93.2337%)
___Train Local_ResNet_18,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4409/4818 (91.5110%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0606, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5164/5652 (91.3659%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5013/5652 (88.6943%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2471, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4429/4714 (93.9542%)
___Train Local_ResNet_18,  epoch 130, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4413/4714 (93.6148%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0632, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5119/5422 (94.4117%)
___Train Local_ResNet_18,  epoch 130, local model 1, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5000/5422 (92.2169%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9799, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3854/4130 (93.3172%)
___Train Local_ResNet_18,  epoch 130, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3850/4130 (93.2203%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9638, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4405/4732 (93.0896%)
___Train Local_ResNet_18,  epoch 130, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4436/4732 (93.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8880, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5119/5645 (90.6820%)
___Train Local_ResNet_18,  epoch 130, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4931/5645 (87.3516%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2022, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5006/5702 (87.7938%)
___Train Local_ResNet_18,  epoch 130, local model 11, internal_epoch   2,  Average loss: 0.0130, Accuracy: 4290/5702 (75.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.4604, Accuracy: 4680/10000 (46.8000%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4334/4736 (91.5118%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4321/4736 (91.2373%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0051, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4085/4527 (90.2364%)
___Train Local_ResNet_18,  epoch 130, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4055/4527 (89.5737%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0145, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3831/4111 (93.1890%)
___Train Local_ResNet_18,  epoch 130, local model 79, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3733/4111 (90.8052%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9755, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4938/5362 (92.0925%)
___Train Local_ResNet_18,  epoch 130, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4870/5362 (90.8243%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2532, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5511/5939 (92.7934%)
___Train Local_ResNet_18,  epoch 130, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5405/5939 (91.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.2412, Accuracy: 5203/10000 (52.0300%)
time spent on training: 275.3146708011627
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2462, Accuracy: 6805/10000 (68.0500%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0939, Accuracy: 9643/9900 (97.4040%)
Done in 301.46493315696716 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 44, 96, 65, 90, 49, 43, 69, 8, 56, 63, 2, 72, 42, 7, 64, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5163/5308 (97.2683%), train_poison_data_count: 415
Global model norm: 43.71707466411151.
Norm before scaling: 43.68396662884093. Distance: 1.2752779433287411
Total norm for 4 adversaries is: 43.68396662884093. distance: 1.2752779433287411
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1115, Accuracy: 9634/9900 (97.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.71707466411151.
Norm before scaling: 43.67604798935854. Distance: 1.2899564013395464
Total norm for 4 adversaries is: 43.67604798935854. distance: 1.2899564013395464
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0649, Accuracy: 9731/9900 (98.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4977/5123 (97.1501%), train_poison_data_count: 403
Global model norm: 43.71707466411151.
Norm before scaling: 43.684749052783715. Distance: 1.2919702737093057
Total norm for 4 adversaries is: 43.684749052783715. distance: 1.2919702737093057
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0753, Accuracy: 9693/9900 (97.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 43.71707466411151.
Norm before scaling: 43.68253308004313. Distance: 1.3202191833384138
Total norm for 4 adversaries is: 43.68253308004313. distance: 1.3202191833384138
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0541, Accuracy: 9754/9900 (98.5253%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4739/5075 (93.3793%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4584/5075 (90.3251%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0891, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4662/5086 (91.6634%)
___Train Local_ResNet_18,  epoch 131, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4633/5086 (91.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2278, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5035/5497 (91.5954%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4945/5497 (89.9582%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9467, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4443/4748 (93.5762%)
___Train Local_ResNet_18,  epoch 131, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4298/4748 (90.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1068, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5092/5652 (90.0920%)
___Train Local_ResNet_18,  epoch 131, local model 49, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4902/5652 (86.7304%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3052, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4612/4979 (92.6290%)
___Train Local_ResNet_18,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4571/4979 (91.8056%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0899, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4030/4364 (92.3465%)
___Train Local_ResNet_18,  epoch 131, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3984/4364 (91.2924%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1549, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4503/4889 (92.1047%)
___Train Local_ResNet_18,  epoch 131, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4497/4889 (91.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9748, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4954/5427 (91.2843%)
___Train Local_ResNet_18,  epoch 131, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4846/5427 (89.2943%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0458, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3652/3910 (93.4015%)
___Train Local_ResNet_18,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3617/3910 (92.5064%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0290, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3704/3968 (93.3468%)
___Train Local_ResNet_18,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3677/3968 (92.6663%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8149, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4798/5193 (92.3936%)
___Train Local_ResNet_18,  epoch 131, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4577/5193 (88.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2370, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5408/5907 (91.5524%)
___Train Local_ResNet_18,  epoch 131, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5321/5907 (90.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3780, Accuracy: 4953/10000 (49.5300%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4489/4869 (92.1955%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3929/4869 (80.6942%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.5598, Accuracy: 4748/10000 (47.4800%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4444/4894 (90.8051%)
___Train Local_ResNet_18,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4306/4894 (87.9853%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.2078, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5202/5727 (90.8329%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5032/5727 (87.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0635, Accuracy: 5397/10000 (53.9700%)
time spent on training: 276.4668140411377
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2514, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0938, Accuracy: 9649/9900 (97.4646%)
Done in 303.0041618347168 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 66, 50, 48, 43, 31, 92, 4, 61, 56, 47, 18, 87, 89, 21, 97, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5165/5308 (97.3060%), train_poison_data_count: 415
Global model norm: 43.7385183036467.
Norm before scaling: 43.704939127077644. Distance: 1.269928292029744
Total norm for 4 adversaries is: 43.704939127077644. distance: 1.269928292029744
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0397, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5625/5777 (97.3689%), train_poison_data_count: 455
Global model norm: 43.7385183036467.
Norm before scaling: 43.698270198708954. Distance: 1.2921777708709037
Total norm for 4 adversaries is: 43.698270198708954. distance: 1.2921777708709037
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0899, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4953/5123 (96.6816%), train_poison_data_count: 403
Global model norm: 43.7385183036467.
Norm before scaling: 43.70550471711916. Distance: 1.2924308464690337
Total norm for 4 adversaries is: 43.70550471711916. distance: 1.2924308464690337
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0455, Accuracy: 9784/9900 (98.8283%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 43.7385183036467.
Norm before scaling: 43.70458301107419. Distance: 1.3132898134114628
Total norm for 4 adversaries is: 43.70458301107419. distance: 1.3132898134114628
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0409, Accuracy: 9799/9900 (98.9798%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4518/4843 (93.2893%)
___Train Local_ResNet_18,  epoch 132, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4440/4843 (91.6787%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0463, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4442/4757 (93.3782%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4373/4757 (91.9277%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9084, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4518/4830 (93.5404%)
___Train Local_ResNet_18,  epoch 132, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4497/4830 (93.1056%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0645, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4587/4979 (92.1269%)
___Train Local_ResNet_18,  epoch 132, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4595/4979 (92.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0111, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4204/4537 (92.6603%)
___Train Local_ResNet_18,  epoch 132, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4202/4537 (92.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9492, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6334/6812 (92.9830%)
___Train Local_ResNet_18,  epoch 132, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6191/6812 (90.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1860, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3757/4028 (93.2721%)
___Train Local_ResNet_18,  epoch 132, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3727/4028 (92.5273%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0030, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4165/4485 (92.8651%)
___Train Local_ResNet_18,  epoch 132, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4031/4485 (89.8774%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9801, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4971/5427 (91.5976%)
___Train Local_ResNet_18,  epoch 132, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4880/5427 (89.9208%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1007, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4637/5123 (90.5134%)
___Train Local_ResNet_18,  epoch 132, local model 47, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4203/5123 (82.0418%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.4055, Accuracy: 4914/10000 (49.1400%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3971/4249 (93.4573%)
___Train Local_ResNet_18,  epoch 132, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3888/4249 (91.5039%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1097, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3635/3995 (90.9887%)
___Train Local_ResNet_18,  epoch 132, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3589/3995 (89.8373%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0109, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4400/4737 (92.8858%)
___Train Local_ResNet_18,  epoch 132, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4327/4737 (91.3447%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0413, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4696/5038 (93.2116%)
___Train Local_ResNet_18,  epoch 132, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4642/5038 (92.1397%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9394, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4326/4736 (91.3429%)
___Train Local_ResNet_18,  epoch 132, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4271/4736 (90.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0409, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5503/5871 (93.7319%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5361/5871 (91.3132%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1832, Accuracy: 5349/10000 (53.4900%)
time spent on training: 275.9061415195465
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2539, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0854, Accuracy: 9670/9900 (97.6768%)
Done in 302.5983603000641 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 14, 60, 82, 89, 72, 33, 79, 92, 81, 56, 75, 19, 78, 66, 16, 20].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 43.75824978022001.
Norm before scaling: 43.72111769857331. Distance: 1.1777296682994414
Total norm for 4 adversaries is: 43.72111769857331. distance: 1.1777296682994414
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0716, Accuracy: 9704/9900 (98.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5610/5777 (97.1092%), train_poison_data_count: 455
Global model norm: 43.75824978022001.
Norm before scaling: 43.72077288252476. Distance: 1.3774696625762959
Total norm for 4 adversaries is: 43.72077288252476. distance: 1.3774696625762959
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0543, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4952/5123 (96.6621%), train_poison_data_count: 403
Global model norm: 43.75824978022001.
Norm before scaling: 43.72667067723799. Distance: 1.317251596214904
Total norm for 4 adversaries is: 43.72667067723799. distance: 1.317251596214904
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0499, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 43.75824978022001.
Norm before scaling: 43.722478788000885. Distance: 1.2695877766862682
Total norm for 4 adversaries is: 43.722478788000885. distance: 1.2695877766862682
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0138, Accuracy: 9865/9900 (99.6465%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3978/4196 (94.8046%)
___Train Local_ResNet_18,  epoch 133, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3987/4196 (95.0191%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9431, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3826/4145 (92.3040%)
___Train Local_ResNet_18,  epoch 133, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3808/4145 (91.8697%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9832, Accuracy: 5565/10000 (55.6500%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5003/5298 (94.4319%)
___Train Local_ResNet_18,  epoch 133, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4961/5298 (93.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0346, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4338/4737 (91.5769%)
___Train Local_ResNet_18,  epoch 133, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4346/4737 (91.7458%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1283, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4704/5193 (90.5835%)
___Train Local_ResNet_18,  epoch 133, local model 72, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4518/5193 (87.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.3000, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4503/4818 (93.4620%)
___Train Local_ResNet_18,  epoch 133, local model 33, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4291/4818 (89.0619%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0972, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3857/4111 (93.8215%)
___Train Local_ResNet_18,  epoch 133, local model 79, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3878/4111 (94.3323%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9663, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   1,  Average loss: 0.0036, Accuracy: 6356/6812 (93.3059%)
___Train Local_ResNet_18,  epoch 133, local model 92, internal_epoch   2,  Average loss: 0.0037, Accuracy: 6306/6812 (92.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1969, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4705/5035 (93.4459%)
___Train Local_ResNet_18,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4671/5035 (92.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0605, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4982/5427 (91.8003%)
___Train Local_ResNet_18,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4792/5427 (88.2992%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2760, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4336/4672 (92.8082%)
___Train Local_ResNet_18,  epoch 133, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4349/4672 (93.0865%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8695, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4909/5361 (91.5687%)
___Train Local_ResNet_18,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4785/5361 (89.2557%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2133, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4142/4368 (94.8260%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4076/4368 (93.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9660, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4494/4843 (92.7937%)
___Train Local_ResNet_18,  epoch 133, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4449/4843 (91.8645%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1514, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4970/5353 (92.8451%)
___Train Local_ResNet_18,  epoch 133, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4790/5353 (89.4825%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0403, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4448/4714 (94.3572%)
___Train Local_ResNet_18,  epoch 133, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4416/4714 (93.6784%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8130, Accuracy: 5781/10000 (57.8100%)
time spent on training: 276.96767354011536
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2654, Accuracy: 6767/10000 (67.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0736, Accuracy: 9704/9900 (98.0202%)
Done in 303.420450925827 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 23, 49, 30, 9, 15, 85, 92, 17, 70, 56, 51, 53, 43, 46, 64, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5187/5308 (97.7204%), train_poison_data_count: 415
Global model norm: 43.777351941029394.
Norm before scaling: 43.740021183408224. Distance: 1.2000840137794893
Total norm for 4 adversaries is: 43.740021183408224. distance: 1.2000840137794893
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0424, Accuracy: 9775/9900 (98.7374%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 43.777351941029394.
Norm before scaling: 43.73754705582993. Distance: 1.2922910083795929
Total norm for 4 adversaries is: 43.73754705582993. distance: 1.2922910083795929
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0849, Accuracy: 9686/9900 (97.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 43.777351941029394.
Norm before scaling: 43.74345096072239. Distance: 1.2665774211479937
Total norm for 4 adversaries is: 43.74345096072239. distance: 1.2665774211479937
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.1409, Accuracy: 9511/9900 (96.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 43.777351941029394.
Norm before scaling: 43.74218959300763. Distance: 1.3322441848195603
Total norm for 4 adversaries is: 43.74218959300763. distance: 1.3322441848195603
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0332, Accuracy: 9817/9900 (99.1616%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4286/4549 (94.2185%)
___Train Local_ResNet_18,  epoch 134, local model 23, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3944/4549 (86.7004%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3072, Accuracy: 5011/10000 (50.1100%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5088/5652 (90.0212%)
___Train Local_ResNet_18,  epoch 134, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4937/5652 (87.3496%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1592, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3553/3774 (94.1441%)
___Train Local_ResNet_18,  epoch 134, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3578/3774 (94.8066%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8096, Accuracy: 5867/10000 (58.6700%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5224/5727 (91.2170%)
___Train Local_ResNet_18,  epoch 134, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5096/5727 (88.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2696, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5599/6068 (92.2709%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5493/6068 (90.5241%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1160, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6294/6947 (90.6003%)
___Train Local_ResNet_18,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 6098/6947 (87.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1522, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6365/6812 (93.4381%)
___Train Local_ResNet_18,  epoch 134, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6231/6812 (91.4709%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1247, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4446/4903 (90.6792%)
___Train Local_ResNet_18,  epoch 134, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4455/4903 (90.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1186, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5475/5871 (93.2550%)
___Train Local_ResNet_18,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5383/5871 (91.6880%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0366, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4947/5427 (91.1553%)
___Train Local_ResNet_18,  epoch 134, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4912/5427 (90.5104%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9850, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3837/4108 (93.4031%)
___Train Local_ResNet_18,  epoch 134, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3840/4108 (93.4761%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9236, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5920/6664 (88.8355%)
___Train Local_ResNet_18,  epoch 134, local model 53, internal_epoch   2,  Average loss: 0.0079, Accuracy: 5625/6664 (84.4088%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0929, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4634/4979 (93.0709%)
___Train Local_ResNet_18,  epoch 134, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4592/4979 (92.2274%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1094, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4869/5399 (90.1834%)
___Train Local_ResNet_18,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4738/5399 (87.7570%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3299, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4446/4894 (90.8459%)
___Train Local_ResNet_18,  epoch 134, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4322/4894 (88.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.1546, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3708/3968 (93.4476%)
___Train Local_ResNet_18,  epoch 134, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3683/3968 (92.8175%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8772, Accuracy: 5703/10000 (57.0300%)
time spent on training: 284.5371081829071
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2629, Accuracy: 6772/10000 (67.7200%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0807, Accuracy: 9682/9900 (97.7980%)
Done in 311.1389479637146 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 49, 57, 40, 46, 85, 37, 51, 30, 8, 73, 21, 28, 82, 80, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5170/5308 (97.4002%), train_poison_data_count: 415
Global model norm: 43.79983489819767.
Norm before scaling: 43.76358606014537. Distance: 1.2600429968839464
Total norm for 4 adversaries is: 43.76358606014537. distance: 1.2600429968839464
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0395, Accuracy: 9790/9900 (98.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5624/5777 (97.3516%), train_poison_data_count: 455
Global model norm: 43.79983489819767.
Norm before scaling: 43.76076736921083. Distance: 1.3207217603585575
Total norm for 4 adversaries is: 43.76076736921083. distance: 1.3207217603585575
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0434, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4947/5123 (96.5645%), train_poison_data_count: 403
Global model norm: 43.79983489819767.
Norm before scaling: 43.76776146159836. Distance: 1.3229231446275276
Total norm for 4 adversaries is: 43.76776146159836. distance: 1.3229231446275276
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1938, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5342/5503 (97.0743%), train_poison_data_count: 430
Global model norm: 43.79983489819767.
Norm before scaling: 43.76730823923048. Distance: 1.3632239299627047
Total norm for 4 adversaries is: 43.76730823923048. distance: 1.3632239299627047
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0133, Accuracy: 9865/9900 (99.6465%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6340/6812 (93.0711%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 6163/6812 (90.4727%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2103, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5142/5652 (90.9766%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5034/5652 (89.0658%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2882, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4609/4956 (92.9984%)
___Train Local_ResNet_18,  epoch 135, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4545/4956 (91.7070%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0773, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5508/5939 (92.7429%)
___Train Local_ResNet_18,  epoch 135, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5451/5939 (91.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0182, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4815/5399 (89.1832%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4696/5399 (86.9791%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1680, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6265/6947 (90.1828%)
___Train Local_ResNet_18,  epoch 135, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6066/6947 (87.3183%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4075, Accuracy: 4906/10000 (49.0600%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4395/4741 (92.7020%)
___Train Local_ResNet_18,  epoch 135, local model 37, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4091/4741 (86.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.4993, Accuracy: 4816/10000 (48.1600%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3859/4108 (93.9387%)
___Train Local_ResNet_18,  epoch 135, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3774/4108 (91.8695%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0641, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3535/3774 (93.6672%)
___Train Local_ResNet_18,  epoch 135, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3585/3774 (94.9921%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8279, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4538/4889 (92.8206%)
___Train Local_ResNet_18,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4465/4889 (91.3275%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3960, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4360/4605 (94.6797%)
___Train Local_ResNet_18,  epoch 135, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4308/4605 (93.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9922, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4678/5038 (92.8543%)
___Train Local_ResNet_18,  epoch 135, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4643/5038 (92.1596%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9827, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4646/5122 (90.7068%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4281/5122 (83.5806%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.3162, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4972/5298 (93.8467%)
___Train Local_ResNet_18,  epoch 135, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4926/5298 (92.9785%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0208, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5062/5461 (92.6936%)
___Train Local_ResNet_18,  epoch 135, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4974/5461 (91.0822%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1828, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4512/4830 (93.4161%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4501/4830 (93.1884%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1642, Accuracy: 5315/10000 (53.1500%)
time spent on training: 280.2152268886566
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2697, Accuracy: 6766/10000 (67.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0774, Accuracy: 9695/9900 (97.9293%)
Done in 306.6640193462372 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 32, 67, 70, 18, 87, 0, 98, 29, 99, 28, 40, 75, 92, 80, 64, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5158/5308 (97.1741%), train_poison_data_count: 415
Global model norm: 43.820229625300485.
Norm before scaling: 43.786877593795865. Distance: 1.31434624111259
Total norm for 4 adversaries is: 43.786877593795865. distance: 1.31434624111259
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0415, Accuracy: 9798/9900 (98.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5632/5777 (97.4900%), train_poison_data_count: 455
Global model norm: 43.820229625300485.
Norm before scaling: 43.78182993905691. Distance: 1.335025944832708
Total norm for 4 adversaries is: 43.78182993905691. distance: 1.335025944832708
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0426, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4947/5123 (96.5645%), train_poison_data_count: 403
Global model norm: 43.820229625300485.
Norm before scaling: 43.78681626152228. Distance: 1.302149239461608
Total norm for 4 adversaries is: 43.78681626152228. distance: 1.302149239461608
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1887, Accuracy: 9447/9900 (95.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5342/5503 (97.0743%), train_poison_data_count: 430
Global model norm: 43.820229625300485.
Norm before scaling: 43.785919964177694. Distance: 1.3210647065474095
Total norm for 4 adversaries is: 43.785919964177694. distance: 1.3210647065474095
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0457, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5388/6080 (88.6184%)
___Train Local_ResNet_18,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5324/6080 (87.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2060, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4993/5559 (89.8183%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4864/5559 (87.4978%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1024, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5487/5871 (93.4594%)
___Train Local_ResNet_18,  epoch 136, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5396/5871 (91.9094%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2276, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3981/4249 (93.6926%)
___Train Local_ResNet_18,  epoch 136, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3933/4249 (92.5630%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9839, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3641/3995 (91.1389%)
___Train Local_ResNet_18,  epoch 136, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3605/3995 (90.2378%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.3310, Accuracy: 5027/10000 (50.2700%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5014/5454 (91.9325%)
___Train Local_ResNet_18,  epoch 136, local model 0, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4807/5454 (88.1371%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1206, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3898/4161 (93.6794%)
___Train Local_ResNet_18,  epoch 136, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3854/4161 (92.6220%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0168, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4504/4732 (95.1817%)
___Train Local_ResNet_18,  epoch 136, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4453/4732 (94.1040%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9240, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4424/4851 (91.1977%)
___Train Local_ResNet_18,  epoch 136, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4419/4851 (91.0946%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0279, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4665/5122 (91.0777%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0106, Accuracy: 4195/5122 (81.9016%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.6406, Accuracy: 4609/10000 (46.0900%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5480/5939 (92.2714%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5497/5939 (92.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1989, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4412/4672 (94.4349%)
___Train Local_ResNet_18,  epoch 136, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4348/4672 (93.0651%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9012, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6403/6812 (93.9959%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6275/6812 (92.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1558, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5077/5461 (92.9683%)
___Train Local_ResNet_18,  epoch 136, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5012/5461 (91.7781%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2681, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4471/4894 (91.3568%)
___Train Local_ResNet_18,  epoch 136, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4370/4894 (89.2930%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.1615, Accuracy: 5351/10000 (53.5100%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3858/4175 (92.4072%)
___Train Local_ResNet_18,  epoch 136, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3816/4175 (91.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0585, Accuracy: 5378/10000 (53.7800%)
time spent on training: 273.6985111236572
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2816, Accuracy: 6739/10000 (67.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0749, Accuracy: 9700/9900 (97.9798%)
Done in 299.93287420272827 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 94, 74, 82, 63, 27, 55, 92, 11, 34, 79, 60, 59, 43, 16, 78, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5192/5308 (97.8146%), train_poison_data_count: 415
Global model norm: 43.840731809870604.
Norm before scaling: 43.802734679808374. Distance: 1.1968259517490032
Total norm for 4 adversaries is: 43.802734679808374. distance: 1.1968259517490032
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0610, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 43.840731809870604.
Norm before scaling: 43.80126739479835. Distance: 1.3061190763140762
Total norm for 4 adversaries is: 43.80126739479835. distance: 1.3061190763140762
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0693, Accuracy: 9728/9900 (98.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4956/5123 (96.7402%), train_poison_data_count: 403
Global model norm: 43.840731809870604.
Norm before scaling: 43.80816864065922. Distance: 1.320415379957056
Total norm for 4 adversaries is: 43.80816864065922. distance: 1.320415379957056
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0492, Accuracy: 9768/9900 (98.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 43.840731809870604.
Norm before scaling: 43.807352196238845. Distance: 1.346714431502609
Total norm for 4 adversaries is: 43.807352196238845. distance: 1.346714431502609
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0765, Accuracy: 9711/9900 (98.0909%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4781/5224 (91.5199%)
___Train Local_ResNet_18,  epoch 137, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4706/5224 (90.0842%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2456, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4379/4797 (91.2862%)
___Train Local_ResNet_18,  epoch 137, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4321/4797 (90.0771%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0199, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5016/5298 (94.6772%)
___Train Local_ResNet_18,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4980/5298 (93.9977%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8928, Accuracy: 5785/10000 (57.8500%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3668/3910 (93.8107%)
___Train Local_ResNet_18,  epoch 137, local model 63, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3426/3910 (87.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2786, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4223/4587 (92.0645%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4212/4587 (91.8247%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0403, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4419/4731 (93.4052%)
___Train Local_ResNet_18,  epoch 137, local model 55, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4417/4731 (93.3629%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0470, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6426/6812 (94.3335%)
___Train Local_ResNet_18,  epoch 137, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 6268/6812 (92.0141%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2675, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5006/5702 (87.7938%)
___Train Local_ResNet_18,  epoch 137, local model 11, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4825/5702 (84.6194%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2847, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4567/4911 (92.9953%)
___Train Local_ResNet_18,  epoch 137, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4560/4911 (92.8528%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9220, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3806/4111 (92.5809%)
___Train Local_ResNet_18,  epoch 137, local model 79, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3750/4111 (91.2187%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1068, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3859/4145 (93.1001%)
___Train Local_ResNet_18,  epoch 137, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3874/4145 (93.4620%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0146, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4210/4397 (95.7471%)
___Train Local_ResNet_18,  epoch 137, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4206/4397 (95.6561%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7593, Accuracy: 5924/10000 (59.2400%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4569/4979 (91.7654%)
___Train Local_ResNet_18,  epoch 137, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4584/4979 (92.0667%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9981, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5019/5353 (93.7605%)
___Train Local_ResNet_18,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4851/5353 (90.6221%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0839, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4127/4368 (94.4826%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4106/4368 (94.0018%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0696, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5044/5346 (94.3509%)
___Train Local_ResNet_18,  epoch 137, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4961/5346 (92.7984%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0755, Accuracy: 5424/10000 (54.2400%)
time spent on training: 272.67058849334717
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2801, Accuracy: 6737/10000 (67.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0725, Accuracy: 9706/9900 (98.0404%)
Done in 299.1330416202545 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 45, 90, 54, 95, 30, 48, 61, 73, 15, 85, 88, 94, 78, 18, 0, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5194/5308 (97.8523%), train_poison_data_count: 415
Global model norm: 43.85954895093755.
Norm before scaling: 43.82179795017472. Distance: 1.194314028522604
Total norm for 4 adversaries is: 43.82179795017472. distance: 1.194314028522604
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1095, Accuracy: 9607/9900 (97.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5633/5777 (97.5074%), train_poison_data_count: 455
Global model norm: 43.85954895093755.
Norm before scaling: 43.81921143762887. Distance: 1.2989528051206192
Total norm for 4 adversaries is: 43.81921143762887. distance: 1.2989528051206192
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0900, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4955/5123 (96.7207%), train_poison_data_count: 403
Global model norm: 43.85954895093755.
Norm before scaling: 43.827187768499506. Distance: 1.3163404589775949
Total norm for 4 adversaries is: 43.827187768499506. distance: 1.3163404589775949
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.1584, Accuracy: 9507/9900 (96.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 43.85954895093755.
Norm before scaling: 43.825887030651614. Distance: 1.3564957128049973
Total norm for 4 adversaries is: 43.825887030651614. distance: 1.3564957128049973
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0632, Accuracy: 9740/9900 (98.3838%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5025/5489 (91.5467%)
___Train Local_ResNet_18,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4944/5489 (90.0711%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1724, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4480/4748 (94.3555%)
___Train Local_ResNet_18,  epoch 138, local model 90, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4418/4748 (93.0497%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0631, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5112/5645 (90.5580%)
___Train Local_ResNet_18,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4928/5645 (87.2985%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2740, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4588/5018 (91.4308%)
___Train Local_ResNet_18,  epoch 138, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4444/5018 (88.5612%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3019, Accuracy: 5022/10000 (50.2200%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3540/3774 (93.7997%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3536/3774 (93.6937%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0074, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4539/4830 (93.9752%)
___Train Local_ResNet_18,  epoch 138, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4485/4830 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1351, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4153/4485 (92.5975%)
___Train Local_ResNet_18,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3811/4485 (84.9721%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.4167, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4319/4605 (93.7894%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4279/4605 (92.9207%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9258, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5615/6068 (92.5346%)
___Train Local_ResNet_18,  epoch 138, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5469/6068 (90.1285%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2587, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6330/6947 (91.1185%)
___Train Local_ResNet_18,  epoch 138, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 6102/6947 (87.8365%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2408, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4946/5362 (92.2417%)
___Train Local_ResNet_18,  epoch 138, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4896/5362 (91.3092%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1111, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4747/5224 (90.8691%)
___Train Local_ResNet_18,  epoch 138, local model 94, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4687/5224 (89.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0437, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4161/4368 (95.2610%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4088/4368 (93.5897%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9009, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3996/4249 (94.0457%)
___Train Local_ResNet_18,  epoch 138, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3937/4249 (92.6571%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9679, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4973/5454 (91.1808%)
___Train Local_ResNet_18,  epoch 138, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4842/5454 (88.7789%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1108, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5529/5939 (93.0965%)
___Train Local_ResNet_18,  epoch 138, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5451/5939 (91.7831%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9064, Accuracy: 5623/10000 (56.2300%)
time spent on training: 276.82551670074463
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2870, Accuracy: 6738/10000 (67.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0779, Accuracy: 9694/9900 (97.9192%)
Done in 303.34243726730347 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 59, 30, 64, 19, 12, 82, 16, 74, 70, 85, 50, 67, 57, 72, 18, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5173/5308 (97.4567%), train_poison_data_count: 415
Global model norm: 43.88009257526769.
Norm before scaling: 43.84762545238339. Distance: 1.312177754761388
Total norm for 4 adversaries is: 43.84762545238339. distance: 1.312177754761388
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0518, Accuracy: 9766/9900 (98.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5635/5777 (97.5420%), train_poison_data_count: 455
Global model norm: 43.88009257526769.
Norm before scaling: 43.839222636883626. Distance: 1.3090014833102408
Total norm for 4 adversaries is: 43.839222636883626. distance: 1.3090014833102408
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0196, Accuracy: 9838/9900 (99.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 43.88009257526769.
Norm before scaling: 43.84538012605704. Distance: 1.2523695421329344
Total norm for 4 adversaries is: 43.84538012605704. distance: 1.2523695421329344
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0930, Accuracy: 9659/9900 (97.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5357/5503 (97.3469%), train_poison_data_count: 430
Global model norm: 43.88009257526769.
Norm before scaling: 43.84688769510186. Distance: 1.3730321153523024
Total norm for 4 adversaries is: 43.84688769510186. distance: 1.3730321153523024
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0483, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4162/4397 (94.6554%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4204/4397 (95.6106%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7858, Accuracy: 5853/10000 (58.5300%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3569/3774 (94.5681%)
___Train Local_ResNet_18,  epoch 139, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3622/3774 (95.9724%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7212, Accuracy: 6024/10000 (60.2400%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4456/4894 (91.0503%)
___Train Local_ResNet_18,  epoch 139, local model 64, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4299/4894 (87.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3111, Accuracy: 5035/10000 (50.3500%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4836/5361 (90.2071%)
___Train Local_ResNet_18,  epoch 139, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4761/5361 (88.8081%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0032, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5057/5526 (91.5128%)
___Train Local_ResNet_18,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4795/5526 (86.7716%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.4059, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5006/5298 (94.4885%)
___Train Local_ResNet_18,  epoch 139, local model 82, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4924/5298 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2594, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4926/5353 (92.0232%)
___Train Local_ResNet_18,  epoch 139, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4786/5353 (89.4078%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0684, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4417/4797 (92.0784%)
___Train Local_ResNet_18,  epoch 139, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4342/4797 (90.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1787, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5482/5871 (93.3742%)
___Train Local_ResNet_18,  epoch 139, local model 70, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5325/5871 (90.7001%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2039, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6354/6947 (91.4639%)
___Train Local_ResNet_18,  epoch 139, local model 85, internal_epoch   2,  Average loss: 0.0060, Accuracy: 6117/6947 (88.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0908, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4419/4757 (92.8947%)
___Train Local_ResNet_18,  epoch 139, local model 50, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4363/4757 (91.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0581, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5051/5559 (90.8617%)
___Train Local_ResNet_18,  epoch 139, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4928/5559 (88.6490%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1730, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4599/4956 (92.7966%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4548/4956 (91.7676%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3085, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4768/5193 (91.8159%)
___Train Local_ResNet_18,  epoch 139, local model 72, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4572/5193 (88.0416%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2634, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3977/4249 (93.5985%)
___Train Local_ResNet_18,  epoch 139, local model 18, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3938/4249 (92.6806%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9914, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4853/5399 (89.8870%)
___Train Local_ResNet_18,  epoch 139, local model 46, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4711/5399 (87.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1692, Accuracy: 5179/10000 (51.7900%)
time spent on training: 278.32392382621765
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2914, Accuracy: 6730/10000 (67.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0761, Accuracy: 9698/9900 (97.9596%)
Done in 304.8625316619873 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 18, 76, 66, 22, 96, 54, 1, 88, 32, 97, 26, 2, 77, 68, 42, 5].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 43.9011882647234.
Norm before scaling: 43.86570497828785. Distance: 1.287640475044695
Total norm for 4 adversaries is: 43.86570497828785. distance: 1.287640475044695
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0177, Accuracy: 9845/9900 (99.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 43.9011882647234.
Norm before scaling: 43.86147349806975. Distance: 1.3298732695038948
Total norm for 4 adversaries is: 43.86147349806975. distance: 1.3298732695038948
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0241, Accuracy: 9833/9900 (99.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4935/5123 (96.3303%), train_poison_data_count: 403
Global model norm: 43.9011882647234.
Norm before scaling: 43.86984561737353. Distance: 1.356258766743677
Total norm for 4 adversaries is: 43.86984561737353. distance: 1.356258766743677
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0465, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5351/5503 (97.2379%), train_poison_data_count: 430
Global model norm: 43.9011882647234.
Norm before scaling: 43.86640485165584. Distance: 1.345944187846506
Total norm for 4 adversaries is: 43.86640485165584. distance: 1.345944187846506
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0355, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4015/4249 (94.4928%)
___Train Local_ResNet_18,  epoch 140, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3947/4249 (92.8924%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9019, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3624/3959 (91.5383%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3644/3959 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9806, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4521/4843 (93.3512%)
___Train Local_ResNet_18,  epoch 140, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4441/4843 (91.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0709, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5318/5696 (93.3638%)
___Train Local_ResNet_18,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5270/5696 (92.5211%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9223, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4677/5086 (91.9583%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4666/5086 (91.7420%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0370, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5107/5645 (90.4694%)
___Train Local_ResNet_18,  epoch 140, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4824/5645 (85.4562%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2420, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5123/5422 (94.4854%)
___Train Local_ResNet_18,  epoch 140, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5034/5422 (92.8440%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9486, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4965/5362 (92.5960%)
___Train Local_ResNet_18,  epoch 140, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4868/5362 (90.7870%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9878, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5480/6080 (90.1316%)
___Train Local_ResNet_18,  epoch 140, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5341/6080 (87.8454%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2148, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4318/4736 (91.1740%)
___Train Local_ResNet_18,  epoch 140, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4296/4736 (90.7095%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0457, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3864/4086 (94.5668%)
___Train Local_ResNet_18,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3876/4086 (94.8605%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8365, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3707/3968 (93.4224%)
___Train Local_ResNet_18,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3672/3968 (92.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8737, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4543/5050 (89.9604%)
___Train Local_ResNet_18,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4535/5050 (89.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0190, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3335/3589 (92.9228%)
___Train Local_ResNet_18,  epoch 140, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3319/3589 (92.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9362, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5365/5907 (90.8244%)
___Train Local_ResNet_18,  epoch 140, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5403/5907 (91.4678%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2005, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4678/4993 (93.6912%)
___Train Local_ResNet_18,  epoch 140, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4663/4993 (93.3907%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9961, Accuracy: 5635/10000 (56.3500%)
time spent on training: 275.15313243865967
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2929, Accuracy: 6720/10000 (67.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0696, Accuracy: 9715/9900 (98.1313%)
Done in 301.5899066925049 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 69, 7, 17, 81, 55, 66, 54, 73, 78, 3, 79, 38, 84, 90, 5, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5197/5308 (97.9088%), train_poison_data_count: 415
Global model norm: 43.920097627235954.
Norm before scaling: 43.88371168631008. Distance: 1.21642644396259
Total norm for 4 adversaries is: 43.88371168631008. distance: 1.21642644396259
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0484, Accuracy: 9771/9900 (98.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 43.920097627235954.
Norm before scaling: 43.877519236346274. Distance: 1.2767316185603002
Total norm for 4 adversaries is: 43.877519236346274. distance: 1.2767316185603002
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0267, Accuracy: 9833/9900 (99.3232%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 43.920097627235954.
Norm before scaling: 43.883802090720216. Distance: 1.2355747428402108
Total norm for 4 adversaries is: 43.883802090720216. distance: 1.2355747428402108
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.1292, Accuracy: 9569/9900 (96.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 43.920097627235954.
Norm before scaling: 43.88646267865881. Distance: 1.3701498581028875
Total norm for 4 adversaries is: 43.88646267865881. distance: 1.3701498581028875
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0282, Accuracy: 9827/9900 (99.2626%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4012/4364 (91.9340%)
___Train Local_ResNet_18,  epoch 141, local model 69, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3977/4364 (91.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0117, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4490/4869 (92.2161%)
___Train Local_ResNet_18,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4252/4869 (87.3280%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1471, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4459/4903 (90.9443%)
___Train Local_ResNet_18,  epoch 141, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4423/4903 (90.2101%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0830, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4740/5035 (94.1410%)
___Train Local_ResNet_18,  epoch 141, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4718/5035 (93.7041%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9395, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4412/4731 (93.2572%)
___Train Local_ResNet_18,  epoch 141, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4394/4731 (92.8768%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9594, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4524/4843 (93.4132%)
___Train Local_ResNet_18,  epoch 141, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4490/4843 (92.7111%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9953, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5127/5645 (90.8237%)
___Train Local_ResNet_18,  epoch 141, local model 54, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4886/5645 (86.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0950, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4331/4605 (94.0499%)
___Train Local_ResNet_18,  epoch 141, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4339/4605 (94.2237%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9968, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4150/4368 (95.0092%)
___Train Local_ResNet_18,  epoch 141, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4129/4368 (94.5284%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9314, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5023/5346 (93.9581%)
___Train Local_ResNet_18,  epoch 141, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5002/5346 (93.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1306, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3881/4111 (94.4053%)
___Train Local_ResNet_18,  epoch 141, local model 79, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3822/4111 (92.9701%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9148, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5642/6235 (90.4892%)
___Train Local_ResNet_18,  epoch 141, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5535/6235 (88.7731%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.3696, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4758/5209 (91.3419%)
___Train Local_ResNet_18,  epoch 141, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4699/5209 (90.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1802, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4433/4748 (93.3656%)
___Train Local_ResNet_18,  epoch 141, local model 90, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4329/4748 (91.1752%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2275, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4732/4993 (94.7727%)
___Train Local_ResNet_18,  epoch 141, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4654/4993 (93.2105%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0753, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4567/4911 (92.9953%)
___Train Local_ResNet_18,  epoch 141, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4554/4911 (92.7306%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1735, Accuracy: 5290/10000 (52.9000%)
time spent on training: 276.82250475883484
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2933, Accuracy: 6724/10000 (67.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0665, Accuracy: 9730/9900 (98.2828%)
Done in 303.32999300956726 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 96, 52, 20, 2, 65, 42, 1, 45, 48, 32, 68, 12, 39, 33, 4, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5171/5308 (97.4190%), train_poison_data_count: 415
Global model norm: 43.93860990552258.
Norm before scaling: 43.902182307125976. Distance: 1.251629815928502
Total norm for 4 adversaries is: 43.902182307125976. distance: 1.251629815928502
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0603, Accuracy: 9745/9900 (98.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 43.93860990552258.
Norm before scaling: 43.89808782006128. Distance: 1.325780077491471
Total norm for 4 adversaries is: 43.89808782006128. distance: 1.325780077491471
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0463, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4963/5123 (96.8768%), train_poison_data_count: 403
Global model norm: 43.93860990552258.
Norm before scaling: 43.9042537357572. Distance: 1.2805090832133026
Total norm for 4 adversaries is: 43.9042537357572. distance: 1.2805090832133026
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.2237, Accuracy: 9304/9900 (93.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5354/5503 (97.2924%), train_poison_data_count: 430
Global model norm: 43.93860990552258.
Norm before scaling: 43.90340571303239. Distance: 1.3366894752779295
Total norm for 4 adversaries is: 43.90340571303239. distance: 1.3366894752779295
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0518, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4664/5086 (91.7027%)
___Train Local_ResNet_18,  epoch 142, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4661/5086 (91.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0279, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3877/4130 (93.8741%)
___Train Local_ResNet_18,  epoch 142, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3869/4130 (93.6804%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0035, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4405/4714 (93.4451%)
___Train Local_ResNet_18,  epoch 142, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4437/4714 (94.1239%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8678, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3681/3968 (92.7671%)
___Train Local_ResNet_18,  epoch 142, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3658/3968 (92.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9060, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5037/5497 (91.6318%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4871/5497 (88.6120%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2376, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5455/5907 (92.3481%)
___Train Local_ResNet_18,  epoch 142, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5321/5907 (90.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3432, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5150/5422 (94.9834%)
___Train Local_ResNet_18,  epoch 142, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5041/5422 (92.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8942, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5046/5489 (91.9293%)
___Train Local_ResNet_18,  epoch 142, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4953/5489 (90.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.3772, Accuracy: 5014/10000 (50.1400%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4543/4830 (94.0580%)
___Train Local_ResNet_18,  epoch 142, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4540/4830 (93.9959%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1082, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5412/6080 (89.0132%)
___Train Local_ResNet_18,  epoch 142, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5380/6080 (88.4868%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.4161, Accuracy: 4972/10000 (49.7200%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3373/3589 (93.9816%)
___Train Local_ResNet_18,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3089/3589 (86.0685%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1011, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5083/5526 (91.9834%)
___Train Local_ResNet_18,  epoch 142, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4919/5526 (89.0156%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0757, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3861/4175 (92.4790%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3806/4175 (91.1617%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9761, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4462/4818 (92.6110%)
___Train Local_ResNet_18,  epoch 142, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4411/4818 (91.5525%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9662, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3740/4028 (92.8500%)
___Train Local_ResNet_18,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3750/4028 (93.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8908, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4872/5399 (90.2389%)
___Train Local_ResNet_18,  epoch 142, local model 46, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4732/5399 (87.6459%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1324, Accuracy: 5248/10000 (52.4800%)
time spent on training: 274.92524313926697
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2896, Accuracy: 6720/10000 (67.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0683, Accuracy: 9725/9900 (98.2323%)
Done in 301.5442202091217 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 27, 65, 15, 35, 94, 34, 49, 50, 42, 4, 93, 68, 90, 96, 92, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5200/5308 (97.9653%), train_poison_data_count: 415
Global model norm: 43.95839735752644.
Norm before scaling: 43.92056455933755. Distance: 1.2097989051584344
Total norm for 4 adversaries is: 43.92056455933755. distance: 1.2097989051584344
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0220, Accuracy: 9840/9900 (99.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 43.95839735752644.
Norm before scaling: 43.91807697693015. Distance: 1.310750703836558
Total norm for 4 adversaries is: 43.91807697693015. distance: 1.310750703836558
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0378, Accuracy: 9796/9900 (98.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4955/5123 (96.7207%), train_poison_data_count: 403
Global model norm: 43.95839735752644.
Norm before scaling: 43.924629160358315. Distance: 1.3107683929747724
Total norm for 4 adversaries is: 43.924629160358315. distance: 1.3107683929747724
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.1272, Accuracy: 9579/9900 (96.7576%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 43.95839735752644.
Norm before scaling: 43.92005315725309. Distance: 1.2502011137346363
Total norm for 4 adversaries is: 43.92005315725309. distance: 1.2502011137346363
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0286, Accuracy: 9826/9900 (99.2525%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4261/4587 (92.8930%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4220/4587 (91.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9858, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4996/5497 (90.8859%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4955/5497 (90.1401%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1936, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5549/6068 (91.4469%)
___Train Local_ResNet_18,  epoch 143, local model 15, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5494/6068 (90.5405%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3122, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5231/5615 (93.1612%)
___Train Local_ResNet_18,  epoch 143, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5109/5615 (90.9884%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4646, Accuracy: 5010/10000 (50.1000%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4727/5224 (90.4862%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4723/5224 (90.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2524, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4562/4911 (92.8935%)
___Train Local_ResNet_18,  epoch 143, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4534/4911 (92.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0683, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5130/5652 (90.7643%)
___Train Local_ResNet_18,  epoch 143, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5063/5652 (89.5789%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3254, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4447/4757 (93.4833%)
___Train Local_ResNet_18,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4300/4757 (90.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1628, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5409/5907 (91.5693%)
___Train Local_ResNet_18,  epoch 143, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5342/5907 (90.4351%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.4379, Accuracy: 4891/10000 (48.9100%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3714/4028 (92.2046%)
___Train Local_ResNet_18,  epoch 143, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3725/4028 (92.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9658, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4663/5055 (92.2453%)
___Train Local_ResNet_18,  epoch 143, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4559/5055 (90.1879%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1309, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3377/3589 (94.0931%)
___Train Local_ResNet_18,  epoch 143, local model 68, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3341/3589 (93.0900%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0373, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4487/4748 (94.5029%)
___Train Local_ResNet_18,  epoch 143, local model 90, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4312/4748 (90.8172%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0410, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4720/5086 (92.8038%)
___Train Local_ResNet_18,  epoch 143, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4704/5086 (92.4892%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1045, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 6366/6812 (93.4527%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 6233/6812 (91.5003%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0922, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4099/4364 (93.9276%)
___Train Local_ResNet_18,  epoch 143, local model 69, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3980/4364 (91.2007%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0936, Accuracy: 5438/10000 (54.3800%)
time spent on training: 279.38331031799316
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.2865, Accuracy: 6732/10000 (67.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0697, Accuracy: 9718/9900 (98.1616%)
Done in 306.1243646144867 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 0, 83, 23, 90, 88, 51, 9, 6, 70, 7, 75, 87, 85, 89, 84, 2].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5195/5308 (97.8711%), train_poison_data_count: 415
Global model norm: 43.97960953314047.
Norm before scaling: 43.94230614716585. Distance: 1.241819603139906
Total norm for 4 adversaries is: 43.94230614716585. distance: 1.241819603139906
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0753, Accuracy: 9702/9900 (98.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5626/5777 (97.3862%), train_poison_data_count: 455
Global model norm: 43.97960953314047.
Norm before scaling: 43.93933223197853. Distance: 1.3538687109214278
Total norm for 4 adversaries is: 43.93933223197853. distance: 1.3538687109214278
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0975, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4965/5123 (96.9159%), train_poison_data_count: 403
Global model norm: 43.97960953314047.
Norm before scaling: 43.945020137916366. Distance: 1.2848080798262027
Total norm for 4 adversaries is: 43.945020137916366. distance: 1.2848080798262027
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0535, Accuracy: 9752/9900 (98.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5360/5503 (97.4014%), train_poison_data_count: 430
Global model norm: 43.97960953314047.
Norm before scaling: 43.944003452725205. Distance: 1.315974495829036
Total norm for 4 adversaries is: 43.944003452725205. distance: 1.315974495829036
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0423, Accuracy: 9791/9900 (98.8990%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4967/5454 (91.0708%)
___Train Local_ResNet_18,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4835/5454 (88.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1813, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3279/3552 (92.3142%)
___Train Local_ResNet_18,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3301/3552 (92.9336%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0288, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4248/4549 (93.3832%)
___Train Local_ResNet_18,  epoch 144, local model 23, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4031/4549 (88.6129%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0673, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4502/4748 (94.8189%)
___Train Local_ResNet_18,  epoch 144, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4397/4748 (92.6074%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0539, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4953/5362 (92.3722%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4837/5362 (90.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1523, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3808/4108 (92.6972%)
___Train Local_ResNet_18,  epoch 144, local model 51, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3797/4108 (92.4294%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0213, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5263/5727 (91.8980%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5050/5727 (88.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1857, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4577/4929 (92.8586%)
___Train Local_ResNet_18,  epoch 144, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.2357, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5499/5871 (93.6638%)
___Train Local_ResNet_18,  epoch 144, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5412/5871 (92.1819%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1069, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4474/4869 (91.8875%)
___Train Local_ResNet_18,  epoch 144, local model 7, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3929/4869 (80.6942%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.7643, Accuracy: 4375/10000 (43.7500%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4383/4672 (93.8142%)
___Train Local_ResNet_18,  epoch 144, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4363/4672 (93.3861%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0498, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3604/3995 (90.2128%)
___Train Local_ResNet_18,  epoch 144, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3556/3995 (89.0113%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0792, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6285/6947 (90.4707%)
___Train Local_ResNet_18,  epoch 144, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 6027/6947 (86.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3122, Accuracy: 5041/10000 (50.4100%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4356/4737 (91.9569%)
___Train Local_ResNet_18,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4307/4737 (90.9225%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1887, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4781/5209 (91.7835%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4635/5209 (88.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0910, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3751/3968 (94.5312%)
___Train Local_ResNet_18,  epoch 144, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3745/3968 (94.3800%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.7966, Accuracy: 5872/10000 (58.7200%)
time spent on training: 273.47088718414307
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2915, Accuracy: 6721/10000 (67.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0713, Accuracy: 9708/9900 (98.0606%)
Done in 299.5345456600189 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 27, 69, 59, 16, 44, 4, 1, 35, 8, 7, 23, 66, 88, 42, 52, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5178/5308 (97.5509%), train_poison_data_count: 415
Global model norm: 43.99931057476569.
Norm before scaling: 43.96197114810211. Distance: 1.2518379527422239
Total norm for 4 adversaries is: 43.96197114810211. distance: 1.2518379527422239
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0262, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5639/5777 (97.6112%), train_poison_data_count: 455
Global model norm: 43.99931057476569.
Norm before scaling: 43.95798636686725. Distance: 1.3165892974639875
Total norm for 4 adversaries is: 43.95798636686725. distance: 1.3165892974639875
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0442, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4979/5123 (97.1891%), train_poison_data_count: 403
Global model norm: 43.99931057476569.
Norm before scaling: 43.96539749345856. Distance: 1.2708168445622272
Total norm for 4 adversaries is: 43.96539749345856. distance: 1.2708168445622272
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.1376, Accuracy: 9560/9900 (96.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5353/5503 (97.2742%), train_poison_data_count: 430
Global model norm: 43.99931057476569.
Norm before scaling: 43.9643090885415. Distance: 1.3457001131021264
Total norm for 4 adversaries is: 43.9643090885415. distance: 1.3457001131021264
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0428, Accuracy: 9782/9900 (98.8081%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4203/4587 (91.6285%)
___Train Local_ResNet_18,  epoch 145, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4152/4587 (90.5167%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2162, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4056/4364 (92.9423%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4032/4364 (92.3923%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9812, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4185/4397 (95.1785%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4221/4397 (95.9973%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.7829, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4952/5353 (92.5089%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4788/5353 (89.4452%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2947, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4753/5075 (93.6552%)
___Train Local_ResNet_18,  epoch 145, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4645/5075 (91.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1710, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3749/4028 (93.0735%)
___Train Local_ResNet_18,  epoch 145, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3756/4028 (93.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9422, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5131/5422 (94.6330%)
___Train Local_ResNet_18,  epoch 145, local model 1, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5038/5422 (92.9177%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0268, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5214/5615 (92.8584%)
___Train Local_ResNet_18,  epoch 145, local model 35, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5154/5615 (91.7898%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1413, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4545/4889 (92.9638%)
___Train Local_ResNet_18,  epoch 145, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4453/4889 (91.0820%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9745, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4473/4869 (91.8669%)
___Train Local_ResNet_18,  epoch 145, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4209/4869 (86.4449%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2901, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4274/4549 (93.9547%)
___Train Local_ResNet_18,  epoch 145, local model 23, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3956/4549 (86.9642%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2729, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4507/4843 (93.0622%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4464/4843 (92.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0192, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4926/5362 (91.8687%)
___Train Local_ResNet_18,  epoch 145, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4871/5362 (90.8430%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1562, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5500/5907 (93.1099%)
___Train Local_ResNet_18,  epoch 145, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5366/5907 (90.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.4277, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3880/4130 (93.9467%)
___Train Local_ResNet_18,  epoch 145, local model 52, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3832/4130 (92.7845%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9720, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5043/5454 (92.4642%)
___Train Local_ResNet_18,  epoch 145, local model 0, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4806/5454 (88.1188%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1321, Accuracy: 5380/10000 (53.8000%)
time spent on training: 275.99231815338135
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.2906, Accuracy: 6716/10000 (67.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0720, Accuracy: 9704/9900 (98.0202%)
Done in 302.52654361724854 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 54, 63, 3, 38, 67, 73, 20, 32, 49, 0, 75, 56, 10, 2, 42, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 44.019004185603606.
Norm before scaling: 43.98267508926455. Distance: 1.2580632498871243
Total norm for 4 adversaries is: 43.98267508926455. distance: 1.2580632498871243
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0163, Accuracy: 9853/9900 (99.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5646/5777 (97.7324%), train_poison_data_count: 455
Global model norm: 44.019004185603606.
Norm before scaling: 43.97656180604903. Distance: 1.2833372652728465
Total norm for 4 adversaries is: 43.97656180604903. distance: 1.2833372652728465
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0443, Accuracy: 9786/9900 (98.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4965/5123 (96.9159%), train_poison_data_count: 403
Global model norm: 44.019004185603606.
Norm before scaling: 43.98554061510583. Distance: 1.3201267179440572
Total norm for 4 adversaries is: 43.98554061510583. distance: 1.3201267179440572
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.1372, Accuracy: 9553/9900 (96.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5366/5503 (97.5104%), train_poison_data_count: 430
Global model norm: 44.019004185603606.
Norm before scaling: 43.9821963270367. Distance: 1.2916252785891609
Total norm for 4 adversaries is: 43.9821963270367. distance: 1.2916252785891609
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0593, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5106/5645 (90.4517%)
___Train Local_ResNet_18,  epoch 146, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4857/5645 (86.0407%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3410, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3676/3910 (94.0153%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3426/3910 (87.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.6396, Accuracy: 4808/10000 (48.0800%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5080/5346 (95.0243%)
___Train Local_ResNet_18,  epoch 146, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5031/5346 (94.1077%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0174, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5583/6235 (89.5429%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5429/6235 (87.0730%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3060, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5049/5559 (90.8257%)
___Train Local_ResNet_18,  epoch 146, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4921/5559 (88.5231%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0790, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4361/4605 (94.7014%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4320/4605 (93.8111%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0260, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4474/4714 (94.9088%)
___Train Local_ResNet_18,  epoch 146, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4482/4714 (95.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8596, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5472/6080 (90.0000%)
___Train Local_ResNet_18,  epoch 146, local model 32, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5247/6080 (86.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2480, Accuracy: 5094/10000 (50.9400%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5162/5652 (91.3305%)
___Train Local_ResNet_18,  epoch 146, local model 49, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4937/5652 (87.3496%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2494, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5039/5454 (92.3909%)
___Train Local_ResNet_18,  epoch 146, local model 0, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4727/5454 (86.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1237, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4394/4672 (94.0497%)
___Train Local_ResNet_18,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4390/4672 (93.9640%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9269, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4931/5427 (90.8605%)
___Train Local_ResNet_18,  epoch 146, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4849/5427 (89.3495%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0792, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4756/5068 (93.8437%)
___Train Local_ResNet_18,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4668/5068 (92.1073%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3134, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3743/3968 (94.3296%)
___Train Local_ResNet_18,  epoch 146, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3723/3968 (93.8256%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8454, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5412/5907 (91.6201%)
___Train Local_ResNet_18,  epoch 146, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5370/5907 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3540, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4479/4851 (92.3315%)
___Train Local_ResNet_18,  epoch 146, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4457/4851 (91.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0904, Accuracy: 5524/10000 (55.2400%)
time spent on training: 274.9042513370514
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.2978, Accuracy: 6719/10000 (67.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0628, Accuracy: 9738/9900 (98.3636%)
Done in 301.586234331131 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 92, 39, 50, 63, 32, 3, 4, 22, 47, 68, 64, 51, 16, 62, 87, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5190/5308 (97.7769%), train_poison_data_count: 415
Global model norm: 44.040332688574374.
Norm before scaling: 43.99941045192751. Distance: 1.1668895213404045
Total norm for 4 adversaries is: 43.99941045192751. distance: 1.1668895213404045
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0679, Accuracy: 9720/9900 (98.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.040332688574374.
Norm before scaling: 43.996574962131284. Distance: 1.253889517509075
Total norm for 4 adversaries is: 43.996574962131284. distance: 1.253889517509075
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0383, Accuracy: 9801/9900 (99.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 44.040332688574374.
Norm before scaling: 44.00384643388078. Distance: 1.2178403932324924
Total norm for 4 adversaries is: 44.00384643388078. distance: 1.2178403932324924
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0438, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5359/5503 (97.3832%), train_poison_data_count: 430
Global model norm: 44.040332688574374.
Norm before scaling: 44.005570492552415. Distance: 1.347787336525422
Total norm for 4 adversaries is: 44.005570492552415. distance: 1.347787336525422
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1276, Accuracy: 9558/9900 (96.5455%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6445/6812 (94.6124%)
___Train Local_ResNet_18,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0034, Accuracy: 6348/6812 (93.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2903, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3884/4175 (93.0299%)
___Train Local_ResNet_18,  epoch 147, local model 39, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3722/4175 (89.1497%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2108, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4459/4757 (93.7355%)
___Train Local_ResNet_18,  epoch 147, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4383/4757 (92.1379%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0582, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3689/3910 (94.3478%)
___Train Local_ResNet_18,  epoch 147, local model 63, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3394/3910 (86.8031%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0985, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5474/6080 (90.0329%)
___Train Local_ResNet_18,  epoch 147, local model 32, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5390/6080 (88.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1355, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5013/5346 (93.7710%)
___Train Local_ResNet_18,  epoch 147, local model 3, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4911/5346 (91.8631%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2586, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3778/4028 (93.7934%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3726/4028 (92.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9890, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5342/5696 (93.7851%)
___Train Local_ResNet_18,  epoch 147, local model 22, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5227/5696 (91.7662%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0872, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4701/5123 (91.7626%)
___Train Local_ResNet_18,  epoch 147, local model 47, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4179/5123 (81.5733%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1820, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3376/3589 (94.0652%)
___Train Local_ResNet_18,  epoch 147, local model 68, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3166/3589 (88.2140%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0132, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4504/4894 (92.0311%)
___Train Local_ResNet_18,  epoch 147, local model 64, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4327/4894 (88.4144%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3301, Accuracy: 5145/10000 (51.4500%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3866/4108 (94.1091%)
___Train Local_ResNet_18,  epoch 147, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3776/4108 (91.9182%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1291, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5001/5353 (93.4242%)
___Train Local_ResNet_18,  epoch 147, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4876/5353 (91.0891%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1081, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4908/5504 (89.1715%)
___Train Local_ResNet_18,  epoch 147, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4874/5504 (88.5538%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2269, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3646/3995 (91.2641%)
___Train Local_ResNet_18,  epoch 147, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3570/3995 (89.3617%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0770, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5194/5615 (92.5022%)
___Train Local_ResNet_18,  epoch 147, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5136/5615 (91.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1209, Accuracy: 5373/10000 (53.7300%)
time spent on training: 263.68119382858276
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.3068, Accuracy: 6696/10000 (66.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0630, Accuracy: 9735/9900 (98.3333%)
Done in 290.3270254135132 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 34, 96, 45, 52, 66, 63, 32, 29, 57, 44, 77, 79, 94, 64, 51, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5179/5308 (97.5697%), train_poison_data_count: 415
Global model norm: 44.06069782440398.
Norm before scaling: 44.02401632827104. Distance: 1.258967799007458
Total norm for 4 adversaries is: 44.02401632827104. distance: 1.258967799007458
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0500, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5642/5777 (97.6631%), train_poison_data_count: 455
Global model norm: 44.06069782440398.
Norm before scaling: 44.01806547192442. Distance: 1.3063809945163614
Total norm for 4 adversaries is: 44.01806547192442. distance: 1.3063809945163614
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0852, Accuracy: 9681/9900 (97.7879%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.06069782440398.
Norm before scaling: 44.02427142621868. Distance: 1.2272270977644295
Total norm for 4 adversaries is: 44.02427142621868. distance: 1.2272270977644295
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0808, Accuracy: 9688/9900 (97.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5356/5503 (97.3287%), train_poison_data_count: 430
Global model norm: 44.06069782440398.
Norm before scaling: 44.022855891233505. Distance: 1.3034293681485296
Total norm for 4 adversaries is: 44.022855891233505. distance: 1.3034293681485296
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0463, Accuracy: 9783/9900 (98.8182%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4621/4911 (94.0949%)
___Train Local_ResNet_18,  epoch 148, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4556/4911 (92.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0974, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4745/5086 (93.2953%)
___Train Local_ResNet_18,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4709/5086 (92.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0622, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4986/5489 (90.8362%)
___Train Local_ResNet_18,  epoch 148, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4953/5489 (90.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2093, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3886/4130 (94.0920%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3861/4130 (93.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9954, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4508/4843 (93.0828%)
___Train Local_ResNet_18,  epoch 148, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4441/4843 (91.6994%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2166, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3669/3910 (93.8363%)
___Train Local_ResNet_18,  epoch 148, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3519/3910 (90.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2370, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5483/6080 (90.1809%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5304/6080 (87.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1912, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4495/4732 (94.9915%)
___Train Local_ResNet_18,  epoch 148, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4474/4732 (94.5478%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8973, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4617/4956 (93.1598%)
___Train Local_ResNet_18,  epoch 148, local model 57, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4477/4956 (90.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1189, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4730/5075 (93.2020%)
___Train Local_ResNet_18,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4574/5075 (90.1281%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1411, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4580/5050 (90.6931%)
___Train Local_ResNet_18,  epoch 148, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4443/5050 (87.9802%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2513, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3868/4111 (94.0890%)
___Train Local_ResNet_18,  epoch 148, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3817/4111 (92.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0462, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4775/5224 (91.4051%)
___Train Local_ResNet_18,  epoch 148, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4751/5224 (90.9456%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9725, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4547/4894 (92.9097%)
___Train Local_ResNet_18,  epoch 148, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4390/4894 (89.7017%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2374, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3859/4108 (93.9387%)
___Train Local_ResNet_18,  epoch 148, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3833/4108 (93.3057%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9460, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5965/6664 (89.5108%)
___Train Local_ResNet_18,  epoch 148, local model 53, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5732/6664 (86.0144%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2973, Accuracy: 4949/10000 (49.4900%)
time spent on training: 271.35972118377686
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3112, Accuracy: 6686/10000 (66.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0600, Accuracy: 9738/9900 (98.3636%)
Done in 297.96626138687134 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 69, 1, 68, 16, 44, 2, 45, 27, 14, 83, 87, 12, 50, 43, 37, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5176/5308 (97.5132%), train_poison_data_count: 415
Global model norm: 44.079729842727176.
Norm before scaling: 44.04248076919246. Distance: 1.261660358979261
Total norm for 4 adversaries is: 44.04248076919246. distance: 1.261660358979261
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0910, Accuracy: 9639/9900 (97.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5636/5777 (97.5593%), train_poison_data_count: 455
Global model norm: 44.079729842727176.
Norm before scaling: 44.03737093722217. Distance: 1.313326983815705
Total norm for 4 adversaries is: 44.03737093722217. distance: 1.313326983815705
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0472, Accuracy: 9774/9900 (98.7273%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4970/5123 (97.0135%), train_poison_data_count: 403
Global model norm: 44.079729842727176.
Norm before scaling: 44.04633873609346. Distance: 1.3153104211197637
Total norm for 4 adversaries is: 44.04633873609346. distance: 1.3153104211197637
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.1580, Accuracy: 9493/9900 (95.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5355/5503 (97.3106%), train_poison_data_count: 430
Global model norm: 44.079729842727176.
Norm before scaling: 44.04299490714301. Distance: 1.3303448693869615
Total norm for 4 adversaries is: 44.04299490714301. distance: 1.3303448693869615
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0224, Accuracy: 9854/9900 (99.5354%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4090/4364 (93.7214%)
___Train Local_ResNet_18,  epoch 149, local model 69, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3959/4364 (90.7195%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0747, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5092/5422 (93.9137%)
___Train Local_ResNet_18,  epoch 149, local model 1, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5037/5422 (92.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9293, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3356/3589 (93.5079%)
___Train Local_ResNet_18,  epoch 149, local model 68, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3118/3589 (86.8766%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2765, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4939/5353 (92.2660%)
___Train Local_ResNet_18,  epoch 149, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4779/5353 (89.2770%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1104, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4724/5075 (93.0837%)
___Train Local_ResNet_18,  epoch 149, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4668/5075 (91.9803%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0940, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3697/3968 (93.1704%)
___Train Local_ResNet_18,  epoch 149, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3694/3968 (93.0948%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9166, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5087/5489 (92.6763%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5002/5489 (91.1277%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0909, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4255/4587 (92.7622%)
___Train Local_ResNet_18,  epoch 149, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4202/4587 (91.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0211, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4006/4196 (95.4719%)
___Train Local_ResNet_18,  epoch 149, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4007/4196 (95.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8772, Accuracy: 5730/10000 (57.3000%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3275/3552 (92.2016%)
___Train Local_ResNet_18,  epoch 149, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3294/3552 (92.7365%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9003, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3631/3995 (90.8886%)
___Train Local_ResNet_18,  epoch 149, local model 87, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3564/3995 (89.2115%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3299, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5068/5526 (91.7119%)
___Train Local_ResNet_18,  epoch 149, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4921/5526 (89.0518%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3496, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4428/4757 (93.0839%)
___Train Local_ResNet_18,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4466/4757 (93.8827%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9698, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4600/4979 (92.3880%)
___Train Local_ResNet_18,  epoch 149, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4581/4979 (92.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2032, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4372/4741 (92.2168%)
___Train Local_ResNet_18,  epoch 149, local model 37, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4227/4741 (89.1584%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2245, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4742/5193 (91.3152%)
___Train Local_ResNet_18,  epoch 149, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4608/5193 (88.7348%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4920, Accuracy: 5044/10000 (50.4400%)
time spent on training: 249.22300219535828
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3151, Accuracy: 6676/10000 (66.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0593, Accuracy: 9743/9900 (98.4141%)
Done in 275.4984664916992 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 63, 26, 6, 29, 91, 4, 39, 1, 80, 62, 89, 20, 33, 74, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.098922501806236.
Norm before scaling: 44.059275147947. Distance: 1.1900015132157138
Total norm for 4 adversaries is: 44.059275147947. distance: 1.1900015132157138
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0261, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5646/5777 (97.7324%), train_poison_data_count: 455
Global model norm: 44.098922501806236.
Norm before scaling: 44.055422470150454. Distance: 1.2868542338729572
Total norm for 4 adversaries is: 44.055422470150454. distance: 1.2868542338729572
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0510, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4969/5123 (96.9939%), train_poison_data_count: 403
Global model norm: 44.098922501806236.
Norm before scaling: 44.06262743775898. Distance: 1.2596742582086522
Total norm for 4 adversaries is: 44.06262743775898. distance: 1.2596742582086522
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.1829, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5347/5503 (97.1652%), train_poison_data_count: 430
Global model norm: 44.098922501806236.
Norm before scaling: 44.062411347428544. Distance: 1.3374343428138409
Total norm for 4 adversaries is: 44.062411347428544. distance: 1.3374343428138409
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0566, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3673/3910 (93.9386%)
___Train Local_ResNet_18,  epoch 150, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3572/3910 (91.3555%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1141, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3847/4086 (94.1508%)
___Train Local_ResNet_18,  epoch 150, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3853/4086 (94.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9762, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4624/4929 (93.8121%)
___Train Local_ResNet_18,  epoch 150, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4507/4929 (91.4384%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1250, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4468/4732 (94.4210%)
___Train Local_ResNet_18,  epoch 150, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4449/4732 (94.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8275, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4158/4527 (91.8489%)
___Train Local_ResNet_18,  epoch 150, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4005/4527 (88.4692%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0986, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3772/4028 (93.6445%)
___Train Local_ResNet_18,  epoch 150, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3725/4028 (92.4777%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9641, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3876/4175 (92.8383%)
___Train Local_ResNet_18,  epoch 150, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3816/4175 (91.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9948, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5171/5422 (95.3707%)
___Train Local_ResNet_18,  epoch 150, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5108/5422 (94.2088%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9880, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5051/5461 (92.4922%)
___Train Local_ResNet_18,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4994/5461 (91.4485%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2473, Accuracy: 5125/10000 (51.2500%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4935/5504 (89.6621%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4879/5504 (88.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2827, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4386/4737 (92.5902%)
___Train Local_ResNet_18,  epoch 150, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4325/4737 (91.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2059, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4432/4714 (94.0178%)
___Train Local_ResNet_18,  epoch 150, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4423/4714 (93.8269%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8789, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4461/4818 (92.5903%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4315/4818 (89.5600%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0948, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4420/4797 (92.1409%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4366/4797 (91.0152%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0746, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4680/5055 (92.5816%)
___Train Local_ResNet_18,  epoch 150, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4591/5055 (90.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1473, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5080/5497 (92.4140%)
___Train Local_ResNet_18,  epoch 150, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4979/5497 (90.5767%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1867, Accuracy: 5283/10000 (52.8300%)
time spent on training: 244.70664834976196
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3089, Accuracy: 6686/10000 (66.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0634, Accuracy: 9731/9900 (98.2929%)
Done in 271.4105942249298 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 4, 98, 5, 17, 65, 46, 15, 48, 68, 94, 2, 93, 43, 10, 26, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.11757694732481.
Norm before scaling: 44.07728032246318. Distance: 1.1610561181896297
Total norm for 4 adversaries is: 44.07728032246318. distance: 1.1610561181896297
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0868, Accuracy: 9669/9900 (97.6667%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5664/5777 (98.0440%), train_poison_data_count: 455
Global model norm: 44.11757694732481.
Norm before scaling: 44.07225207906118. Distance: 1.2077714940225144
Total norm for 4 adversaries is: 44.07225207906118. distance: 1.2077714940225144
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0801, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4961/5123 (96.8378%), train_poison_data_count: 403
Global model norm: 44.11757694732481.
Norm before scaling: 44.08384068755381. Distance: 1.3165041833326474
Total norm for 4 adversaries is: 44.08384068755381. distance: 1.3165041833326474
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0310, Accuracy: 9812/9900 (99.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5368/5503 (97.5468%), train_poison_data_count: 430
Global model norm: 44.11757694732481.
Norm before scaling: 44.07854594800769. Distance: 1.223238431634547
Total norm for 4 adversaries is: 44.07854594800769. distance: 1.223238431634547
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0379, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3753/4028 (93.1728%)
___Train Local_ResNet_18,  epoch 151, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3750/4028 (93.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8605, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3932/4161 (94.4965%)
___Train Local_ResNet_18,  epoch 151, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3875/4161 (93.1267%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9235, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4726/4993 (94.6525%)
___Train Local_ResNet_18,  epoch 151, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4608/4993 (92.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2975, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4441/4903 (90.5772%)
___Train Local_ResNet_18,  epoch 151, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4335/4903 (88.4153%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2864, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5090/5497 (92.5960%)
___Train Local_ResNet_18,  epoch 151, local model 65, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4879/5497 (88.7575%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2276, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4902/5399 (90.7946%)
___Train Local_ResNet_18,  epoch 151, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4761/5399 (88.1830%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2719, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5656/6068 (93.2103%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5471/6068 (90.1615%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1202, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4577/4830 (94.7619%)
___Train Local_ResNet_18,  epoch 151, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4519/4830 (93.5611%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1258, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3361/3589 (93.6473%)
___Train Local_ResNet_18,  epoch 151, local model 68, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3251/3589 (90.5823%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2254, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4799/5224 (91.8645%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4785/5224 (91.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1986, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3679/3968 (92.7167%)
___Train Local_ResNet_18,  epoch 151, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3681/3968 (92.7671%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8049, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4661/5055 (92.2057%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4622/5055 (91.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1156, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4596/4979 (92.3077%)
___Train Local_ResNet_18,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4585/4979 (92.0868%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9323, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4769/5068 (94.1002%)
___Train Local_ResNet_18,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4651/5068 (91.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3425, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3860/4086 (94.4689%)
___Train Local_ResNet_18,  epoch 151, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3849/4086 (94.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9315, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4972/5362 (92.7266%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4855/5362 (90.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0820, Accuracy: 5374/10000 (53.7400%)
time spent on training: 247.93045258522034
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3041, Accuracy: 6695/10000 (66.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0661, Accuracy: 9726/9900 (98.2424%)
Done in 274.4544358253479 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 7, 81, 4, 44, 5, 99, 83, 55, 94, 14, 32, 74, 20, 49, 23, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5210/5308 (98.1537%), train_poison_data_count: 415
Global model norm: 44.13631754425359.
Norm before scaling: 44.094706481032816. Distance: 1.1625168542768147
Total norm for 4 adversaries is: 44.094706481032816. distance: 1.1625168542768147
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0890, Accuracy: 9672/9900 (97.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5634/5777 (97.5247%), train_poison_data_count: 455
Global model norm: 44.13631754425359.
Norm before scaling: 44.092617698962655. Distance: 1.275484417537909
Total norm for 4 adversaries is: 44.092617698962655. distance: 1.275484417537909
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0508, Accuracy: 9767/9900 (98.6566%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4987/5123 (97.3453%), train_poison_data_count: 403
Global model norm: 44.13631754425359.
Norm before scaling: 44.099799981388095. Distance: 1.2660857409840987
Total norm for 4 adversaries is: 44.099799981388095. distance: 1.2660857409840987
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0509, Accuracy: 9757/9900 (98.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 44.13631754425359.
Norm before scaling: 44.09515218580227. Distance: 1.2155458929608467
Total norm for 4 adversaries is: 44.09515218580227. distance: 1.2155458929608467
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0868, Accuracy: 9690/9900 (97.8788%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4473/4869 (91.8669%)
___Train Local_ResNet_18,  epoch 152, local model 7, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4337/4869 (89.0737%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1585, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4767/5035 (94.6773%)
___Train Local_ResNet_18,  epoch 152, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4684/5035 (93.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9859, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3798/4028 (94.2900%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3750/4028 (93.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8667, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4778/5075 (94.1478%)
___Train Local_ResNet_18,  epoch 152, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4696/5075 (92.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1001, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4730/4993 (94.7326%)
___Train Local_ResNet_18,  epoch 152, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4660/4993 (93.3307%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9840, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4472/4851 (92.1872%)
___Train Local_ResNet_18,  epoch 152, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4469/4851 (92.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0411, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3303/3552 (92.9899%)
___Train Local_ResNet_18,  epoch 152, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3339/3552 (94.0034%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7681, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4423/4731 (93.4897%)
___Train Local_ResNet_18,  epoch 152, local model 55, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4355/4731 (92.0524%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0225, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4793/5224 (91.7496%)
___Train Local_ResNet_18,  epoch 152, local model 94, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4767/5224 (91.2519%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1590, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4014/4196 (95.6625%)
___Train Local_ResNet_18,  epoch 152, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3976/4196 (94.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8702, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5541/6080 (91.1349%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5360/6080 (88.1579%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1511, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4418/4797 (92.0992%)
___Train Local_ResNet_18,  epoch 152, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4341/4797 (90.4941%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0582, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4438/4714 (94.1451%)
___Train Local_ResNet_18,  epoch 152, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4406/4714 (93.4663%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0281, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5137/5652 (90.8882%)
___Train Local_ResNet_18,  epoch 152, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5035/5652 (89.0835%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.3545, Accuracy: 4985/10000 (49.8500%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4307/4549 (94.6801%)
___Train Local_ResNet_18,  epoch 152, local model 23, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4066/4549 (89.3823%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2679, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4982/5504 (90.5160%)
___Train Local_ResNet_18,  epoch 152, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4854/5504 (88.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.4373, Accuracy: 4719/10000 (47.1900%)
time spent on training: 244.44276428222656
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3163, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0631, Accuracy: 9733/9900 (98.3131%)
Done in 270.73836040496826 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 0, 97, 90, 3, 15, 93, 69, 88, 79, 65, 44, 84, 6, 78, 24, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5185/5308 (97.6827%), train_poison_data_count: 415
Global model norm: 44.15463411542652.
Norm before scaling: 44.11631935904289. Distance: 1.2592301051083095
Total norm for 4 adversaries is: 44.11631935904289. distance: 1.2592301051083095
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0242, Accuracy: 9837/9900 (99.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.15463411542652.
Norm before scaling: 44.11112952585634. Distance: 1.2728661501652765
Total norm for 4 adversaries is: 44.11112952585634. distance: 1.2728661501652765
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0896, Accuracy: 9669/9900 (97.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4978/5123 (97.1696%), train_poison_data_count: 403
Global model norm: 44.15463411542652.
Norm before scaling: 44.11741646500705. Distance: 1.267119526010118
Total norm for 4 adversaries is: 44.11741646500705. distance: 1.267119526010118
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.2667, Accuracy: 9172/9900 (92.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5378/5503 (97.7285%), train_poison_data_count: 430
Global model norm: 44.15463411542652.
Norm before scaling: 44.11362974298944. Distance: 1.2220671578260336
Total norm for 4 adversaries is: 44.11362974298944. distance: 1.2220671578260336
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0779, Accuracy: 9698/9900 (97.9596%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5058/5454 (92.7393%)
___Train Local_ResNet_18,  epoch 153, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4835/5454 (88.6505%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1315, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4328/4736 (91.3851%)
___Train Local_ResNet_18,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4298/4736 (90.7517%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0835, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4535/4748 (95.5139%)
___Train Local_ResNet_18,  epoch 153, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4409/4748 (92.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0005, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5047/5346 (94.4070%)
___Train Local_ResNet_18,  epoch 153, local model 3, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4976/5346 (93.0789%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2327, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5577/6068 (91.9084%)
___Train Local_ResNet_18,  epoch 153, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5524/6068 (91.0349%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2648, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4704/5055 (93.0564%)
___Train Local_ResNet_18,  epoch 153, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4626/5055 (91.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0992, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4076/4364 (93.4005%)
___Train Local_ResNet_18,  epoch 153, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3963/4364 (90.8112%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1464, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5032/5362 (93.8456%)
___Train Local_ResNet_18,  epoch 153, local model 88, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4877/5362 (90.9549%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1966, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3847/4111 (93.5782%)
___Train Local_ResNet_18,  epoch 153, local model 79, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3806/4111 (92.5809%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1387, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5027/5497 (91.4499%)
___Train Local_ResNet_18,  epoch 153, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4977/5497 (90.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2046, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4808/5075 (94.7389%)
___Train Local_ResNet_18,  epoch 153, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4693/5075 (92.4729%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9969, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4806/5209 (92.2634%)
___Train Local_ResNet_18,  epoch 153, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4688/5209 (89.9981%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0739, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4584/4929 (93.0006%)
___Train Local_ResNet_18,  epoch 153, local model 6, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4514/4929 (91.5804%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0540, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4086/4368 (93.5440%)
___Train Local_ResNet_18,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3965/4368 (90.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1137, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4034/4313 (93.5312%)
___Train Local_ResNet_18,  epoch 153, local model 24, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3979/4313 (92.2560%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9113, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3798/4028 (94.2900%)
___Train Local_ResNet_18,  epoch 153, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4028 (92.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0343, Accuracy: 5570/10000 (55.7000%)
time spent on training: 252.09971022605896
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3179, Accuracy: 6684/10000 (66.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0650, Accuracy: 9727/9900 (98.2525%)
Done in 278.38994789123535 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 38, 89, 81, 43, 21, 40, 78, 9, 14, 83, 85, 20, 65, 97, 3, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.17386469696335.
Norm before scaling: 44.13397626917526. Distance: 1.1939838979168866
Total norm for 4 adversaries is: 44.13397626917526. distance: 1.1939838979168866
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0624, Accuracy: 9741/9900 (98.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5645/5777 (97.7151%), train_poison_data_count: 455
Global model norm: 44.17386469696335.
Norm before scaling: 44.12868892821809. Distance: 1.2518845656929845
Total norm for 4 adversaries is: 44.12868892821809. distance: 1.2518845656929845
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0362, Accuracy: 9802/9900 (99.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 44.17386469696335.
Norm before scaling: 44.13580172762952. Distance: 1.1940666637532753
Total norm for 4 adversaries is: 44.13580172762952. distance: 1.1940666637532753
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.1140, Accuracy: 9619/9900 (97.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.17386469696335.
Norm before scaling: 44.13801568615129. Distance: 1.3334559543173865
Total norm for 4 adversaries is: 44.13801568615129. distance: 1.3334559543173865
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0551, Accuracy: 9750/9900 (98.4848%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5630/6235 (90.2967%)
___Train Local_ResNet_18,  epoch 154, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5532/6235 (88.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3742, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4391/4737 (92.6958%)
___Train Local_ResNet_18,  epoch 154, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4314/4737 (91.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1828, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4756/5035 (94.4588%)
___Train Local_ResNet_18,  epoch 154, local model 81, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4719/5035 (93.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8975, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4614/4979 (92.6692%)
___Train Local_ResNet_18,  epoch 154, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4565/4979 (91.6851%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0727, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4654/5038 (92.3779%)
___Train Local_ResNet_18,  epoch 154, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4618/5038 (91.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1239, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5520/5939 (92.9449%)
___Train Local_ResNet_18,  epoch 154, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5405/5939 (91.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0849, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4153/4368 (95.0778%)
___Train Local_ResNet_18,  epoch 154, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4092/4368 (93.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1372, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5286/5727 (92.2996%)
___Train Local_ResNet_18,  epoch 154, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5077/5727 (88.6503%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2300, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4028/4196 (95.9962%)
___Train Local_ResNet_18,  epoch 154, local model 14, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3970/4196 (94.6139%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.7954, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3310/3552 (93.1869%)
___Train Local_ResNet_18,  epoch 154, local model 83, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3319/3552 (93.4403%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9458, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6365/6947 (91.6223%)
___Train Local_ResNet_18,  epoch 154, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6069/6947 (87.3615%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3496, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4459/4714 (94.5906%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4430/4714 (93.9754%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8402, Accuracy: 5802/10000 (58.0200%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5058/5497 (92.0138%)
___Train Local_ResNet_18,  epoch 154, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4939/5497 (89.8490%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2188, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4354/4736 (91.9341%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4277/4736 (90.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1891, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5096/5346 (95.3236%)
___Train Local_ResNet_18,  epoch 154, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5040/5346 (94.2761%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9074, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4617/4956 (93.1598%)
___Train Local_ResNet_18,  epoch 154, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4544/4956 (91.6868%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1462, Accuracy: 5340/10000 (53.4000%)
time spent on training: 250.68208813667297
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3133, Accuracy: 6685/10000 (66.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0621, Accuracy: 9737/9900 (98.3535%)
Done in 277.2522921562195 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 79, 41, 44, 27, 24, 6, 29, 62, 19, 17, 51, 10, 22, 55, 2, 18].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5196/5308 (97.8900%), train_poison_data_count: 415
Global model norm: 44.19233696563664.
Norm before scaling: 44.15344946444586. Distance: 1.2290754392143088
Total norm for 4 adversaries is: 44.15344946444586. distance: 1.2290754392143088
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0700, Accuracy: 9713/9900 (98.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5641/5777 (97.6458%), train_poison_data_count: 455
Global model norm: 44.19233696563664.
Norm before scaling: 44.14881008182016. Distance: 1.269111305619058
Total norm for 4 adversaries is: 44.14881008182016. distance: 1.269111305619058
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.1120, Accuracy: 9604/9900 (97.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.19233696563664.
Norm before scaling: 44.155225737855055. Distance: 1.2685089690417999
Total norm for 4 adversaries is: 44.155225737855055. distance: 1.2685089690417999
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0404, Accuracy: 9795/9900 (98.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.19233696563664.
Norm before scaling: 44.151262545650944. Distance: 1.191377383023109
Total norm for 4 adversaries is: 44.151262545650944. distance: 1.191377383023109
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0689, Accuracy: 9728/9900 (98.2626%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3872/4111 (94.1863%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3809/4111 (92.6539%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0932, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4416/4714 (93.6784%)
___Train Local_ResNet_18,  epoch 155, local model 41, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4368/4714 (92.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1658, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4791/5075 (94.4039%)
___Train Local_ResNet_18,  epoch 155, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4725/5075 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0807, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4256/4587 (92.7840%)
___Train Local_ResNet_18,  epoch 155, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4179/4587 (91.1053%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0868, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4063/4313 (94.2036%)
___Train Local_ResNet_18,  epoch 155, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4044/4313 (93.7630%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8844, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4604/4929 (93.4064%)
___Train Local_ResNet_18,  epoch 155, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4491/4929 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0108, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4489/4732 (94.8648%)
___Train Local_ResNet_18,  epoch 155, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4462/4732 (94.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.7900, Accuracy: 5883/10000 (58.8300%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4945/5504 (89.8438%)
___Train Local_ResNet_18,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4830/5504 (87.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3705, Accuracy: 5034/10000 (50.3400%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4864/5361 (90.7293%)
___Train Local_ResNet_18,  epoch 155, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4803/5361 (89.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1734, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4449/4903 (90.7404%)
___Train Local_ResNet_18,  epoch 155, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4393/4903 (89.5982%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2174, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3864/4108 (94.0604%)
___Train Local_ResNet_18,  epoch 155, local model 51, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3777/4108 (91.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9657, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4766/5068 (94.0410%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4534/5068 (89.4633%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.4162, Accuracy: 4964/10000 (49.6400%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5325/5696 (93.4867%)
___Train Local_ResNet_18,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5225/5696 (91.7310%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.2638, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4442/4731 (93.8914%)
___Train Local_ResNet_18,  epoch 155, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4384/4731 (92.6654%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9697, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3694/3968 (93.0948%)
___Train Local_ResNet_18,  epoch 155, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3676/3968 (92.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8951, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4008/4249 (94.3281%)
___Train Local_ResNet_18,  epoch 155, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3896/4249 (91.6922%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0004, Accuracy: 5606/10000 (56.0600%)
time spent on training: 246.88886427879333
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3121, Accuracy: 6683/10000 (66.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0650, Accuracy: 9729/9900 (98.2727%)
Done in 273.23560094833374 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 11, 83, 23, 59, 10, 86, 19, 48, 50, 12, 38, 98, 74, 21, 63, 62].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 44.21057234453372.
Norm before scaling: 44.16990317715998. Distance: 1.1948005228066363
Total norm for 4 adversaries is: 44.16990317715998. distance: 1.1948005228066363
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0322, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.21057234453372.
Norm before scaling: 44.16514943713751. Distance: 1.2392016819716551
Total norm for 4 adversaries is: 44.16514943713751. distance: 1.2392016819716551
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0853, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4982/5123 (97.2477%), train_poison_data_count: 403
Global model norm: 44.21057234453372.
Norm before scaling: 44.17319732942916. Distance: 1.2364332687721267
Total norm for 4 adversaries is: 44.17319732942916. distance: 1.2364332687721267
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0561, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.21057234453372.
Norm before scaling: 44.16939051643966. Distance: 1.2091302490972267
Total norm for 4 adversaries is: 44.16939051643966. distance: 1.2091302490972267
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0612, Accuracy: 9742/9900 (98.4040%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4987/5702 (87.4605%)
___Train Local_ResNet_18,  epoch 156, local model 11, internal_epoch   2,  Average loss: 0.0105, Accuracy: 4545/5702 (79.7089%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.5569, Accuracy: 4788/10000 (47.8800%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3291/3552 (92.6520%)
___Train Local_ResNet_18,  epoch 156, local model 83, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3319/3552 (93.4403%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8579, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4325/4549 (95.0758%)
___Train Local_ResNet_18,  epoch 156, local model 23, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3785/4549 (83.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.5116, Accuracy: 4849/10000 (48.4900%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4220/4397 (95.9745%)
___Train Local_ResNet_18,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4197/4397 (95.4514%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8698, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4818/5068 (95.0671%)
___Train Local_ResNet_18,  epoch 156, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4656/5068 (91.8706%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1467, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3609/3929 (91.8554%)
___Train Local_ResNet_18,  epoch 156, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3583/3929 (91.1937%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9180, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4886/5361 (91.1397%)
___Train Local_ResNet_18,  epoch 156, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4819/5361 (89.8899%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1746, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4567/4830 (94.5549%)
___Train Local_ResNet_18,  epoch 156, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4562/4830 (94.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9903, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4469/4757 (93.9458%)
___Train Local_ResNet_18,  epoch 156, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4362/4757 (91.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2834, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5114/5526 (92.5443%)
___Train Local_ResNet_18,  epoch 156, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4893/5526 (88.5451%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1609, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5652/6235 (90.6496%)
___Train Local_ResNet_18,  epoch 156, local model 38, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5410/6235 (86.7682%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3107, Accuracy: 4937/10000 (49.3700%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3897/4161 (93.6554%)
___Train Local_ResNet_18,  epoch 156, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3816/4161 (91.7087%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1863, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4441/4797 (92.5787%)
___Train Local_ResNet_18,  epoch 156, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4377/4797 (91.2445%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3463, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4670/5038 (92.6955%)
___Train Local_ResNet_18,  epoch 156, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4676/5038 (92.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8859, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3710/3910 (94.8849%)
___Train Local_ResNet_18,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3480/3910 (89.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.2799, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4971/5504 (90.3161%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4812/5504 (87.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4808, Accuracy: 4841/10000 (48.4100%)
time spent on training: 248.47751784324646
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3152, Accuracy: 6674/10000 (66.7400%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0600, Accuracy: 9744/9900 (98.4242%)
Done in 275.43735814094543 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 7, 2, 12, 90, 33, 98, 27, 94, 1, 52, 14, 48, 96, 37, 20, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.22886506437637.
Norm before scaling: 44.18756768249767. Distance: 1.1897721387386895
Total norm for 4 adversaries is: 44.18756768249767. distance: 1.1897721387386895
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0187, Accuracy: 9854/9900 (99.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.22886506437637.
Norm before scaling: 44.18324270067641. Distance: 1.2639554161103923
Total norm for 4 adversaries is: 44.18324270067641. distance: 1.2639554161103923
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0629, Accuracy: 9725/9900 (98.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4973/5123 (97.0720%), train_poison_data_count: 403
Global model norm: 44.22886506437637.
Norm before scaling: 44.1911132716466. Distance: 1.293978155906881
Total norm for 4 adversaries is: 44.1911132716466. distance: 1.293978155906881
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0970, Accuracy: 9642/9900 (97.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5375/5503 (97.6740%), train_poison_data_count: 430
Global model norm: 44.22886506437637.
Norm before scaling: 44.18707594607345. Distance: 1.2353373771727558
Total norm for 4 adversaries is: 44.18707594607345. distance: 1.2353373771727558
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1021, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4456/4869 (91.5178%)
___Train Local_ResNet_18,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4190/4869 (86.0546%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2012, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3740/3968 (94.2540%)
___Train Local_ResNet_18,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3757/3968 (94.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8249, Accuracy: 5848/10000 (58.4800%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5148/5526 (93.1596%)
___Train Local_ResNet_18,  epoch 157, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4932/5526 (89.2508%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2727, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4502/4748 (94.8189%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4329/4748 (91.1752%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1340, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4474/4818 (92.8601%)
___Train Local_ResNet_18,  epoch 157, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4369/4818 (90.6808%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9456, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3944/4161 (94.7849%)
___Train Local_ResNet_18,  epoch 157, local model 98, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3784/4161 (90.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2688, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4249/4587 (92.6313%)
___Train Local_ResNet_18,  epoch 157, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4170/4587 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3859, Accuracy: 5025/10000 (50.2500%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4766/5224 (91.2328%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4746/5224 (90.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2685, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5162/5422 (95.2047%)
___Train Local_ResNet_18,  epoch 157, local model 1, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5103/5422 (94.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9389, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3898/4130 (94.3826%)
___Train Local_ResNet_18,  epoch 157, local model 52, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3806/4130 (92.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1378, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3994/4196 (95.1859%)
___Train Local_ResNet_18,  epoch 157, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4003/4196 (95.4004%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8831, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4590/4830 (95.0311%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4515/4830 (93.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1184, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4716/5086 (92.7251%)
___Train Local_ResNet_18,  epoch 157, local model 96, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4713/5086 (92.6661%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1621, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4399/4741 (92.7863%)
___Train Local_ResNet_18,  epoch 157, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4131/4741 (87.1335%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.4316, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4480/4714 (95.0361%)
___Train Local_ResNet_18,  epoch 157, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4455/4714 (94.5057%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9428, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4634/5122 (90.4725%)
___Train Local_ResNet_18,  epoch 157, local model 28, internal_epoch   2,  Average loss: 0.0110, Accuracy: 4112/5122 (80.2811%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.4075, Accuracy: 4798/10000 (47.9800%)
time spent on training: 247.7409930229187
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3203, Accuracy: 6663/10000 (66.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0551, Accuracy: 9755/9900 (98.5354%)
Done in 274.816561460495 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 76, 60, 40, 20, 6, 79, 62, 50, 11, 68, 14, 94, 19, 35, 31, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.24670742737885.
Norm before scaling: 44.204433967893706. Distance: 1.1643043625229994
Total norm for 4 adversaries is: 44.204433967893706. distance: 1.1643043625229994
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0229, Accuracy: 9834/9900 (99.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.24670742737885.
Norm before scaling: 44.20047380702638. Distance: 1.2338409234180667
Total norm for 4 adversaries is: 44.20047380702638. distance: 1.2338409234180667
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0099, Accuracy: 9871/9900 (99.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4990/5123 (97.4039%), train_poison_data_count: 403
Global model norm: 44.24670742737885.
Norm before scaling: 44.20845176016968. Distance: 1.2304058240513314
Total norm for 4 adversaries is: 44.20845176016968. distance: 1.2304058240513314
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0282, Accuracy: 9825/9900 (99.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5352/5503 (97.2560%), train_poison_data_count: 430
Global model norm: 44.24670742737885.
Norm before scaling: 44.20888113149255. Distance: 1.3397193161372232
Total norm for 4 adversaries is: 44.20888113149255. distance: 1.3397193161372232
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0615, Accuracy: 9742/9900 (98.4040%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3642/3959 (91.9929%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3652/3959 (92.2455%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8700, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3852/4145 (92.9312%)
___Train Local_ResNet_18,  epoch 158, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3829/4145 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0594, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5487/5939 (92.3893%)
___Train Local_ResNet_18,  epoch 158, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5398/5939 (90.8907%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0073, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4479/4714 (95.0148%)
___Train Local_ResNet_18,  epoch 158, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4445/4714 (94.2936%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8837, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4588/4929 (93.0818%)
___Train Local_ResNet_18,  epoch 158, local model 6, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4457/4929 (90.4240%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2743, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3873/4111 (94.2107%)
___Train Local_ResNet_18,  epoch 158, local model 79, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3774/4111 (91.8025%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1417, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4980/5504 (90.4797%)
___Train Local_ResNet_18,  epoch 158, local model 62, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4808/5504 (87.3547%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2385, Accuracy: 5130/10000 (51.3000%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4439/4757 (93.3151%)
___Train Local_ResNet_18,  epoch 158, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4364/4757 (91.7385%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1123, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5025/5702 (88.1270%)
___Train Local_ResNet_18,  epoch 158, local model 11, internal_epoch   2,  Average loss: 0.0122, Accuracy: 4357/5702 (76.4118%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.4718, Accuracy: 4672/10000 (46.7200%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3372/3589 (93.9537%)
___Train Local_ResNet_18,  epoch 158, local model 68, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3371/3589 (93.9259%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9385, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4044/4196 (96.3775%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4007/4196 (95.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7953, Accuracy: 5940/10000 (59.4000%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4800/5224 (91.8836%)
___Train Local_ResNet_18,  epoch 158, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4690/5224 (89.7779%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2682, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4957/5361 (92.4641%)
___Train Local_ResNet_18,  epoch 158, local model 19, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4810/5361 (89.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1420, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5191/5615 (92.4488%)
___Train Local_ResNet_18,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5133/5615 (91.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3811, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4225/4537 (93.1232%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4173/4537 (91.9771%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9407, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4446/4732 (93.9560%)
___Train Local_ResNet_18,  epoch 158, local model 29, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4447/4732 (93.9772%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8562, Accuracy: 5817/10000 (58.1700%)
time spent on training: 246.05084228515625
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3382, Accuracy: 6626/10000 (66.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0465, Accuracy: 9775/9900 (98.7374%)
Done in 272.44280219078064 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 97, 47, 16, 70, 11, 17, 62, 21, 9, 1, 10, 20, 30, 84, 83, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.26475080764038.
Norm before scaling: 44.22251529905326. Distance: 1.1348302826048826
Total norm for 4 adversaries is: 44.22251529905326. distance: 1.1348302826048826
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0486, Accuracy: 9773/9900 (98.7172%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5638/5777 (97.5939%), train_poison_data_count: 455
Global model norm: 44.26475080764038.
Norm before scaling: 44.222110903635496. Distance: 1.3241921481270904
Total norm for 4 adversaries is: 44.222110903635496. distance: 1.3241921481270904
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0353, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4971/5123 (97.0330%), train_poison_data_count: 403
Global model norm: 44.26475080764038.
Norm before scaling: 44.22562336156213. Distance: 1.2407030076261722
Total norm for 4 adversaries is: 44.22562336156213. distance: 1.2407030076261722
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0633, Accuracy: 9723/9900 (98.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5366/5503 (97.5104%), train_poison_data_count: 430
Global model norm: 44.26475080764038.
Norm before scaling: 44.225348723628656. Distance: 1.2655981084533379
Total norm for 4 adversaries is: 44.225348723628656. distance: 1.2655981084533379
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0435, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4347/4736 (91.7863%)
___Train Local_ResNet_18,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4264/4736 (90.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1242, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4745/5123 (92.6215%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4177/5123 (81.5343%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4461, Accuracy: 4874/10000 (48.7400%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5013/5353 (93.6484%)
___Train Local_ResNet_18,  epoch 159, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4880/5353 (91.1638%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0200, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5498/5871 (93.6467%)
___Train Local_ResNet_18,  epoch 159, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5367/5871 (91.4154%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2215, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5029/5702 (88.1971%)
___Train Local_ResNet_18,  epoch 159, local model 11, internal_epoch   2,  Average loss: 0.0128, Accuracy: 4337/5702 (76.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4428, Accuracy: 4761/10000 (47.6100%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4483/4903 (91.4338%)
___Train Local_ResNet_18,  epoch 159, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4389/4903 (89.5166%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2869, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4947/5504 (89.8801%)
___Train Local_ResNet_18,  epoch 159, local model 62, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4834/5504 (87.8270%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1463, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4677/5038 (92.8345%)
___Train Local_ResNet_18,  epoch 159, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4653/5038 (92.3581%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9023, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5245/5727 (91.5837%)
___Train Local_ResNet_18,  epoch 159, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5100/5727 (89.0519%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2117, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5145/5422 (94.8912%)
___Train Local_ResNet_18,  epoch 159, local model 1, internal_epoch   2,  Average loss: 0.0030, Accuracy: 5106/5422 (94.1719%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0189, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4805/5068 (94.8106%)
___Train Local_ResNet_18,  epoch 159, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4737/5068 (93.4688%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0367, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4459/4714 (94.5906%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4443/4714 (94.2512%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9139, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3570/3774 (94.5946%)
___Train Local_ResNet_18,  epoch 159, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3530/3774 (93.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9067, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4779/5209 (91.7451%)
___Train Local_ResNet_18,  epoch 159, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4729/5209 (90.7852%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1052, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3284/3552 (92.4550%)
___Train Local_ResNet_18,  epoch 159, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3313/3552 (93.2714%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8413, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3698/3910 (94.5780%)
___Train Local_ResNet_18,  epoch 159, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3554/3910 (90.8951%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2023, Accuracy: 5303/10000 (53.0300%)
time spent on training: 248.97079348564148
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3376, Accuracy: 6618/10000 (66.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0442, Accuracy: 9777/9900 (98.7576%)
Done in 275.4957091808319 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 82, 6, 27, 91, 61, 74, 8, 42, 9, 15, 85, 19, 89, 48, 96, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.283422229712556.
Norm before scaling: 44.24360222552663. Distance: 1.2188199830136308
Total norm for 4 adversaries is: 44.24360222552663. distance: 1.2188199830136308
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0272, Accuracy: 9830/9900 (99.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5659/5777 (97.9574%), train_poison_data_count: 455
Global model norm: 44.283422229712556.
Norm before scaling: 44.23731666304903. Distance: 1.233494456609262
Total norm for 4 adversaries is: 44.23731666304903. distance: 1.233494456609262
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0793, Accuracy: 9700/9900 (97.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4992/5123 (97.4429%), train_poison_data_count: 403
Global model norm: 44.283422229712556.
Norm before scaling: 44.245136230755634. Distance: 1.235636199607126
Total norm for 4 adversaries is: 44.245136230755634. distance: 1.235636199607126
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0540, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.283422229712556.
Norm before scaling: 44.242381329038594. Distance: 1.2351344223072291
Total norm for 4 adversaries is: 44.242381329038594. distance: 1.2351344223072291
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0383, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4935/5298 (93.1484%)
___Train Local_ResNet_18,  epoch 160, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4876/5298 (92.0347%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1045, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4614/4929 (93.6093%)
___Train Local_ResNet_18,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4527/4929 (91.8442%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1266, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4276/4587 (93.2200%)
___Train Local_ResNet_18,  epoch 160, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4232/4587 (92.2607%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0083, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4154/4527 (91.7605%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4086/4527 (90.2584%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9891, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4136/4485 (92.2185%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4126/4485 (91.9955%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0594, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4468/4797 (93.1415%)
___Train Local_ResNet_18,  epoch 160, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4395/4797 (91.6198%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0823, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4535/4889 (92.7593%)
___Train Local_ResNet_18,  epoch 160, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4470/4889 (91.4297%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0471, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5425/5907 (91.8402%)
___Train Local_ResNet_18,  epoch 160, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5390/5907 (91.2477%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.5255, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5238/5727 (91.4615%)
___Train Local_ResNet_18,  epoch 160, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5131/5727 (89.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9693, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5614/6068 (92.5181%)
___Train Local_ResNet_18,  epoch 160, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5588/6068 (92.0897%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0854, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6380/6947 (91.8382%)
___Train Local_ResNet_18,  epoch 160, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5992/6947 (86.2531%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.4506, Accuracy: 4822/10000 (48.2200%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4869/5361 (90.8226%)
___Train Local_ResNet_18,  epoch 160, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4815/5361 (89.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1629, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4358/4737 (91.9992%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4336/4737 (91.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2335, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4577/4830 (94.7619%)
___Train Local_ResNet_18,  epoch 160, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4483/4830 (92.8157%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0924, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4764/5086 (93.6689%)
___Train Local_ResNet_18,  epoch 160, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4704/5086 (92.4892%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1626, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4978/5362 (92.8385%)
___Train Local_ResNet_18,  epoch 160, local model 88, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4865/5362 (90.7311%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1743, Accuracy: 5223/10000 (52.2300%)
time spent on training: 254.2796347141266
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3379, Accuracy: 6631/10000 (66.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0419, Accuracy: 9781/9900 (98.7980%)
Done in 280.51369190216064 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 74, 51, 9, 80, 78, 64, 90, 42, 14, 6, 57, 0, 46, 43, 18, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.303995239037135.
Norm before scaling: 44.26097669072823. Distance: 1.1450751773025645
Total norm for 4 adversaries is: 44.26097669072823. distance: 1.1450751773025645
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0602, Accuracy: 9736/9900 (98.3434%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5652/5777 (97.8362%), train_poison_data_count: 455
Global model norm: 44.303995239037135.
Norm before scaling: 44.25788214359039. Distance: 1.2478921761548194
Total norm for 4 adversaries is: 44.25788214359039. distance: 1.2478921761548194
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0424, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4966/5123 (96.9354%), train_poison_data_count: 403
Global model norm: 44.303995239037135.
Norm before scaling: 44.26673081481453. Distance: 1.2749704600633376
Total norm for 4 adversaries is: 44.26673081481453. distance: 1.2749704600633376
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0152, Accuracy: 9864/9900 (99.6364%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.303995239037135.
Norm before scaling: 44.263792485453756. Distance: 1.257420496541382
Total norm for 4 adversaries is: 44.263792485453756. distance: 1.257420496541382
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0585, Accuracy: 9760/9900 (98.5859%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4477/4797 (93.3292%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4388/4797 (91.4738%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0059, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3847/4108 (93.6465%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3789/4108 (92.2347%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9273, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5237/5727 (91.4440%)
___Train Local_ResNet_18,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5135/5727 (89.6630%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1544, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5037/5461 (92.2359%)
___Train Local_ResNet_18,  epoch 161, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4950/5461 (90.6427%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3300, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4132/4368 (94.5971%)
___Train Local_ResNet_18,  epoch 161, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4023/4368 (92.1016%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0093, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4513/4894 (92.2150%)
___Train Local_ResNet_18,  epoch 161, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4402/4894 (89.9469%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.3197, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4504/4748 (94.8610%)
___Train Local_ResNet_18,  epoch 161, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4339/4748 (91.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9754, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5457/5907 (92.3819%)
___Train Local_ResNet_18,  epoch 161, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5312/5907 (89.9272%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4406, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3993/4196 (95.1621%)
___Train Local_ResNet_18,  epoch 161, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3992/4196 (95.1382%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7198, Accuracy: 5995/10000 (59.9500%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4657/4929 (94.4816%)
___Train Local_ResNet_18,  epoch 161, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4479/4929 (90.8704%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1345, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4648/4956 (93.7853%)
___Train Local_ResNet_18,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4555/4956 (91.9088%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1355, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5044/5454 (92.4826%)
___Train Local_ResNet_18,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4873/5454 (89.3473%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1817, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4932/5399 (91.3503%)
___Train Local_ResNet_18,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4728/5399 (87.5718%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4214, Accuracy: 4915/10000 (49.1500%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4650/4979 (93.3922%)
___Train Local_ResNet_18,  epoch 161, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4605/4979 (92.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0030, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4017/4249 (94.5399%)
___Train Local_ResNet_18,  epoch 161, local model 18, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3947/4249 (92.8924%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.9265, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4611/5050 (91.3069%)
___Train Local_ResNet_18,  epoch 161, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4455/5050 (88.2178%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1836, Accuracy: 5189/10000 (51.8900%)
time spent on training: 247.5523681640625
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3516, Accuracy: 6603/10000 (66.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0394, Accuracy: 9790/9900 (98.8889%)
Done in 274.1534616947174 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 27, 87, 60, 89, 4, 98, 25, 54, 90, 2, 44, 35, 74, 78, 92, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5219/5308 (98.3233%), train_poison_data_count: 415
Global model norm: 44.32297649207674.
Norm before scaling: 44.27990195107567. Distance: 1.1281264624757876
Total norm for 4 adversaries is: 44.27990195107567. distance: 1.1281264624757876
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0521, Accuracy: 9769/9900 (98.6768%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5647/5777 (97.7497%), train_poison_data_count: 455
Global model norm: 44.32297649207674.
Norm before scaling: 44.278427044809305. Distance: 1.2838829248804189
Total norm for 4 adversaries is: 44.278427044809305. distance: 1.2838829248804189
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0213, Accuracy: 9841/9900 (99.4040%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4982/5123 (97.2477%), train_poison_data_count: 403
Global model norm: 44.32297649207674.
Norm before scaling: 44.28256355011883. Distance: 1.223622339543295
Total norm for 4 adversaries is: 44.28256355011883. distance: 1.223622339543295
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.1047, Accuracy: 9610/9900 (97.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5381/5503 (97.7830%), train_poison_data_count: 430
Global model norm: 44.32297649207674.
Norm before scaling: 44.28251668751097. Distance: 1.2631122464268028
Total norm for 4 adversaries is: 44.28251668751097. distance: 1.2631122464268028
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0168, Accuracy: 9854/9900 (99.5354%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4282/4587 (93.3508%)
___Train Local_ResNet_18,  epoch 162, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4202/4587 (91.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1465, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3646/3995 (91.2641%)
___Train Local_ResNet_18,  epoch 162, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3598/3995 (90.0626%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1129, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3835/4145 (92.5211%)
___Train Local_ResNet_18,  epoch 162, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3817/4145 (92.0869%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0847, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4382/4737 (92.5058%)
___Train Local_ResNet_18,  epoch 162, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4324/4737 (91.2814%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.4047, Accuracy: 5110/10000 (51.1000%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3759/4028 (93.3217%)
___Train Local_ResNet_18,  epoch 162, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3767/4028 (93.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9164, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3971/4161 (95.4338%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3869/4161 (92.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0326, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5820/6419 (90.6683%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5564/6419 (86.6802%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.3224, Accuracy: 5129/10000 (51.2900%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5104/5645 (90.4163%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4763/5645 (84.3756%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.5204, Accuracy: 4679/10000 (46.7900%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4490/4748 (94.5661%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4360/4748 (91.8281%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0736, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3733/3968 (94.0776%)
___Train Local_ResNet_18,  epoch 162, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3737/3968 (94.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8172, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4795/5075 (94.4828%)
___Train Local_ResNet_18,  epoch 162, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4706/5075 (92.7291%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1429, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5220/5615 (92.9653%)
___Train Local_ResNet_18,  epoch 162, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5132/5615 (91.3980%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.2072, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4469/4797 (93.1624%)
___Train Local_ResNet_18,  epoch 162, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4358/4797 (90.8484%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9622, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4166/4368 (95.3755%)
___Train Local_ResNet_18,  epoch 162, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4051/4368 (92.7427%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0860, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6428/6812 (94.3629%)
___Train Local_ResNet_18,  epoch 162, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 6248/6812 (91.7205%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0617, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4786/5068 (94.4357%)
___Train Local_ResNet_18,  epoch 162, local model 10, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4693/5068 (92.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0395, Accuracy: 5418/10000 (54.1800%)
time spent on training: 253.53836798667908
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3595, Accuracy: 6589/10000 (65.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0395, Accuracy: 9788/9900 (98.8687%)
Done in 280.17156529426575 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 95, 8, 67, 7, 31, 90, 40, 65, 34, 20, 2, 82, 51, 83, 86, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 44.34056349764922.
Norm before scaling: 44.299010640758105. Distance: 1.1791673738906592
Total norm for 4 adversaries is: 44.299010640758105. distance: 1.1791673738906592
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0382, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5666/5777 (98.0786%), train_poison_data_count: 455
Global model norm: 44.34056349764922.
Norm before scaling: 44.29201086609751. Distance: 1.202686378485221
Total norm for 4 adversaries is: 44.29201086609751. distance: 1.202686378485221
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0259, Accuracy: 9832/9900 (99.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4995/5123 (97.5015%), train_poison_data_count: 403
Global model norm: 44.34056349764922.
Norm before scaling: 44.302241462851654. Distance: 1.2460635190543323
Total norm for 4 adversaries is: 44.302241462851654. distance: 1.2460635190543323
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0483, Accuracy: 9788/9900 (98.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5384/5503 (97.8375%), train_poison_data_count: 430
Global model norm: 44.34056349764922.
Norm before scaling: 44.29961962396658. Distance: 1.2257202074887252
Total norm for 4 adversaries is: 44.29961962396658. distance: 1.2257202074887252
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0747, Accuracy: 9694/9900 (97.9192%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4518/5018 (90.0359%)
___Train Local_ResNet_18,  epoch 163, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4450/5018 (88.6807%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2555, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4540/4889 (92.8615%)
___Train Local_ResNet_18,  epoch 163, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4358/4889 (89.1389%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1736, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5096/5559 (91.6712%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4875/5559 (87.6956%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.4900, Accuracy: 4879/10000 (48.7900%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4491/4869 (92.2366%)
___Train Local_ResNet_18,  epoch 163, local model 7, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4019/4869 (82.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2294, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4268/4537 (94.0710%)
___Train Local_ResNet_18,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4230/4537 (93.2334%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8802, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4553/4748 (95.8930%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4464/4748 (94.0185%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9668, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5529/5939 (93.0965%)
___Train Local_ResNet_18,  epoch 163, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5467/5939 (92.0525%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1143, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5072/5497 (92.2685%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4965/5497 (90.3220%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1207, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4548/4911 (92.6084%)
___Train Local_ResNet_18,  epoch 163, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4552/4911 (92.6899%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0471, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4479/4714 (95.0148%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4422/4714 (93.8057%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8868, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3708/3968 (93.4476%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3699/3968 (93.2208%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9247, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4962/5298 (93.6580%)
___Train Local_ResNet_18,  epoch 163, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4957/5298 (93.5636%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1343, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3865/4108 (94.0847%)
___Train Local_ResNet_18,  epoch 163, local model 51, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3868/4108 (94.1577%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0071, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3290/3552 (92.6239%)
___Train Local_ResNet_18,  epoch 163, local model 83, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3346/3552 (94.2005%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.7887, Accuracy: 5905/10000 (59.0500%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3590/3929 (91.3719%)
___Train Local_ResNet_18,  epoch 163, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3580/3929 (91.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9992, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6445/6812 (94.6124%)
___Train Local_ResNet_18,  epoch 163, local model 92, internal_epoch   2,  Average loss: 0.0035, Accuracy: 6353/6812 (93.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1134, Accuracy: 5367/10000 (53.6700%)
time spent on training: 273.4705295562744
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3590, Accuracy: 6575/10000 (65.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0403, Accuracy: 9787/9900 (98.8586%)
Done in 299.8038239479065 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 93, 42, 22, 44, 28, 6, 70, 27, 35, 41, 8, 24, 26, 60, 31, 12].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.35826461493323.
Norm before scaling: 44.3163730236213. Distance: 1.1591631816662622
Total norm for 4 adversaries is: 44.3163730236213. distance: 1.1591631816662622
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0522, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5640/5777 (97.6285%), train_poison_data_count: 455
Global model norm: 44.35826461493323.
Norm before scaling: 44.31323413751881. Distance: 1.290882467307956
Total norm for 4 adversaries is: 44.31323413751881. distance: 1.290882467307956
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0709, Accuracy: 9720/9900 (98.1818%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5000/5123 (97.5991%), train_poison_data_count: 403
Global model norm: 44.35826461493323.
Norm before scaling: 44.31931750711957. Distance: 1.235501029279304
Total norm for 4 adversaries is: 44.31931750711957. distance: 1.235501029279304
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0668, Accuracy: 9704/9900 (98.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5386/5503 (97.8739%), train_poison_data_count: 430
Global model norm: 44.35826461493323.
Norm before scaling: 44.31640470058393. Distance: 1.2444895879234057
Total norm for 4 adversaries is: 44.31640470058393. distance: 1.2444895879234057
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0777, Accuracy: 9683/9900 (97.8081%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4682/5055 (92.6212%)
___Train Local_ResNet_18,  epoch 164, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4668/5055 (92.3442%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2677, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5448/5907 (92.2296%)
___Train Local_ResNet_18,  epoch 164, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5320/5907 (90.0626%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.4132, Accuracy: 4898/10000 (48.9800%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5282/5696 (92.7317%)
___Train Local_ResNet_18,  epoch 164, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5151/5696 (90.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1603, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4774/5075 (94.0690%)
___Train Local_ResNet_18,  epoch 164, local model 44, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4643/5075 (91.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1882, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4681/5122 (91.3901%)
___Train Local_ResNet_18,  epoch 164, local model 28, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4275/5122 (83.4635%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.4331, Accuracy: 4833/10000 (48.3300%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4651/4929 (94.3599%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4492/4929 (91.1341%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0523, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5502/5871 (93.7149%)
___Train Local_ResNet_18,  epoch 164, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5364/5871 (91.3643%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1025, Accuracy: 5425/10000 (54.2500%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4280/4587 (93.3072%)
___Train Local_ResNet_18,  epoch 164, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4211/4587 (91.8029%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9986, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5257/5615 (93.6242%)
___Train Local_ResNet_18,  epoch 164, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5146/5615 (91.6474%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2776, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4437/4714 (94.1239%)
___Train Local_ResNet_18,  epoch 164, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4398/4714 (93.2966%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1205, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4559/4889 (93.2502%)
___Train Local_ResNet_18,  epoch 164, local model 8, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4480/4889 (91.6343%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0516, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4068/4313 (94.3195%)
___Train Local_ResNet_18,  epoch 164, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4031/4313 (93.4616%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8565, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3874/4086 (94.8116%)
___Train Local_ResNet_18,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3818/4086 (93.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9406, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3861/4145 (93.1484%)
___Train Local_ResNet_18,  epoch 164, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3840/4145 (92.6417%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0707, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4250/4537 (93.6742%)
___Train Local_ResNet_18,  epoch 164, local model 31, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4194/4537 (92.4399%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8668, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5080/5526 (91.9291%)
___Train Local_ResNet_18,  epoch 164, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4924/5526 (89.1060%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1996, Accuracy: 5265/10000 (52.6500%)
time spent on training: 275.76063537597656
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3691, Accuracy: 6563/10000 (65.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0382, Accuracy: 9791/9900 (98.8990%)
Done in 302.24803709983826 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 90, 84, 56, 79, 2, 19, 51, 77, 98, 18, 60, 16, 88, 63, 69, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5213/5308 (98.2102%), train_poison_data_count: 415
Global model norm: 44.37756237100217.
Norm before scaling: 44.335884498866996. Distance: 1.1780613687264845
Total norm for 4 adversaries is: 44.335884498866996. distance: 1.1780613687264845
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0553, Accuracy: 9760/9900 (98.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5663/5777 (98.0267%), train_poison_data_count: 455
Global model norm: 44.37756237100217.
Norm before scaling: 44.331305512442334. Distance: 1.263273244064526
Total norm for 4 adversaries is: 44.331305512442334. distance: 1.263273244064526
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0751, Accuracy: 9708/9900 (98.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4991/5123 (97.4234%), train_poison_data_count: 403
Global model norm: 44.37756237100217.
Norm before scaling: 44.33860881269633. Distance: 1.2258797464373166
Total norm for 4 adversaries is: 44.33860881269633. distance: 1.2258797464373166
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.1145, Accuracy: 9591/9900 (96.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5392/5503 (97.9829%), train_poison_data_count: 430
Global model norm: 44.37756237100217.
Norm before scaling: 44.3343068257388. Distance: 1.2160051197709671
Total norm for 4 adversaries is: 44.3343068257388. distance: 1.2160051197709671
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0629, Accuracy: 9739/9900 (98.3737%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4525/4748 (95.3033%)
___Train Local_ResNet_18,  epoch 165, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4414/4748 (92.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1033, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4815/5209 (92.4362%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4750/5209 (91.1883%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2563, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5022/5427 (92.5373%)
___Train Local_ResNet_18,  epoch 165, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4825/5427 (88.9073%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1487, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3882/4111 (94.4296%)
___Train Local_ResNet_18,  epoch 165, local model 79, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3781/4111 (91.9728%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0893, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3763/3968 (94.8337%)
___Train Local_ResNet_18,  epoch 165, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3737/3968 (94.1784%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7503, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4970/5361 (92.7066%)
___Train Local_ResNet_18,  epoch 165, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4720/5361 (88.0433%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2276, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3887/4108 (94.6203%)
___Train Local_ResNet_18,  epoch 165, local model 51, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3720/4108 (90.5550%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1336, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4638/5050 (91.8416%)
___Train Local_ResNet_18,  epoch 165, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4532/5050 (89.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9916, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3914/4161 (94.0639%)
___Train Local_ResNet_18,  epoch 165, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3827/4161 (91.9731%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1016, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3972/4249 (93.4808%)
___Train Local_ResNet_18,  epoch 165, local model 18, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3888/4249 (91.5039%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0419, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3885/4145 (93.7274%)
___Train Local_ResNet_18,  epoch 165, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3829/4145 (92.3764%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0579, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5015/5353 (93.6858%)
___Train Local_ResNet_18,  epoch 165, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4898/5353 (91.5001%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1240, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4941/5362 (92.1485%)
___Train Local_ResNet_18,  epoch 165, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4936/5362 (92.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1881, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3719/3910 (95.1151%)
___Train Local_ResNet_18,  epoch 165, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3649/3910 (93.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2117, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4094/4364 (93.8130%)
___Train Local_ResNet_18,  epoch 165, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3996/4364 (91.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0526, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5302/5727 (92.5790%)
___Train Local_ResNet_18,  epoch 165, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5048/5727 (88.1439%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.1015, Accuracy: 5423/10000 (54.2300%)
time spent on training: 270.94763350486755
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3855, Accuracy: 6545/10000 (65.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0390, Accuracy: 9790/9900 (98.8889%)
Done in 297.1936285495758 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 37, 97, 49, 32, 82, 55, 2, 63, 31, 12, 87, 60, 93, 0, 66, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5177/5308 (97.5320%), train_poison_data_count: 415
Global model norm: 44.39532435086774.
Norm before scaling: 44.356013488783994. Distance: 1.256442538257906
Total norm for 4 adversaries is: 44.356013488783994. distance: 1.256442538257906
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0535, Accuracy: 9761/9900 (98.5960%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.39532435086774.
Norm before scaling: 44.34758038204776. Distance: 1.1901884765588941
Total norm for 4 adversaries is: 44.34758038204776. distance: 1.1901884765588941
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0561, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4983/5123 (97.2672%), train_poison_data_count: 403
Global model norm: 44.39532435086774.
Norm before scaling: 44.355870381548. Distance: 1.2307936950806007
Total norm for 4 adversaries is: 44.355870381548. distance: 1.2307936950806007
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0537, Accuracy: 9759/9900 (98.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5379/5503 (97.7467%), train_poison_data_count: 430
Global model norm: 44.39532435086774.
Norm before scaling: 44.353675554076126. Distance: 1.2469317927608268
Total norm for 4 adversaries is: 44.353675554076126. distance: 1.2469317927608268
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0304, Accuracy: 9822/9900 (99.2121%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4434/4741 (93.5246%)
___Train Local_ResNet_18,  epoch 166, local model 37, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4242/4741 (89.4748%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.5744, Accuracy: 4831/10000 (48.3100%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4303/4736 (90.8573%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4231/4736 (89.3370%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1767, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5153/5652 (91.1713%)
___Train Local_ResNet_18,  epoch 166, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4974/5652 (88.0042%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2635, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5472/6080 (90.0000%)
___Train Local_ResNet_18,  epoch 166, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5365/6080 (88.2401%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2996, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5027/5298 (94.8849%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4913/5298 (92.7331%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9287, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4479/4731 (94.6734%)
___Train Local_ResNet_18,  epoch 166, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4433/4731 (93.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9218, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3761/3968 (94.7833%)
___Train Local_ResNet_18,  epoch 166, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3708/3968 (93.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8408, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3710/3910 (94.8849%)
___Train Local_ResNet_18,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3483/3910 (89.0793%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2117, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4280/4537 (94.3355%)
___Train Local_ResNet_18,  epoch 166, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4183/4537 (92.1975%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0131, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5080/5526 (91.9291%)
___Train Local_ResNet_18,  epoch 166, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4879/5526 (88.2917%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2873, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3707/3995 (92.7910%)
___Train Local_ResNet_18,  epoch 166, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3650/3995 (91.3642%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0190, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3889/4145 (93.8239%)
___Train Local_ResNet_18,  epoch 166, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3859/4145 (93.1001%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0875, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4708/5055 (93.1355%)
___Train Local_ResNet_18,  epoch 166, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4567/5055 (90.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2383, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5046/5454 (92.5193%)
___Train Local_ResNet_18,  epoch 166, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4865/5454 (89.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2431, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4489/4843 (92.6905%)
___Train Local_ResNet_18,  epoch 166, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4457/4843 (92.0297%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9308, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3903/4130 (94.5036%)
___Train Local_ResNet_18,  epoch 166, local model 52, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3808/4130 (92.2034%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0585, Accuracy: 5554/10000 (55.5400%)
time spent on training: 273.2943363189697
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3894, Accuracy: 6526/10000 (65.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0386, Accuracy: 9791/9900 (98.8990%)
Done in 299.49361205101013 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 59, 98, 38, 39, 7, 3, 32, 76, 35, 66, 73, 20, 74, 49, 62, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5198/5308 (97.9277%), train_poison_data_count: 415
Global model norm: 44.41349562632962.
Norm before scaling: 44.370114167646676. Distance: 1.1573797840778022
Total norm for 4 adversaries is: 44.370114167646676. distance: 1.1573797840778022
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0314, Accuracy: 9823/9900 (99.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5680/5777 (98.3209%), train_poison_data_count: 455
Global model norm: 44.41349562632962.
Norm before scaling: 44.36539288609423. Distance: 1.1919730917338451
Total norm for 4 adversaries is: 44.36539288609423. distance: 1.1919730917338451
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0428, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 44.41349562632962.
Norm before scaling: 44.37383636238391. Distance: 1.2048930763355337
Total norm for 4 adversaries is: 44.37383636238391. distance: 1.2048930763355337
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0611, Accuracy: 9740/9900 (98.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5374/5503 (97.6558%), train_poison_data_count: 430
Global model norm: 44.41349562632962.
Norm before scaling: 44.37462037689731. Distance: 1.3000626512249267
Total norm for 4 adversaries is: 44.37462037689731. distance: 1.3000626512249267
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0487, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4227/4397 (96.1337%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0019, Accuracy: 4245/4397 (96.5431%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7112, Accuracy: 6063/10000 (60.6300%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3945/4161 (94.8089%)
___Train Local_ResNet_18,  epoch 167, local model 98, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3807/4161 (91.4924%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1592, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5663/6235 (90.8260%)
___Train Local_ResNet_18,  epoch 167, local model 38, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5519/6235 (88.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3405, Accuracy: 4935/10000 (49.3500%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3899/4175 (93.3892%)
___Train Local_ResNet_18,  epoch 167, local model 39, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3758/4175 (90.0120%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1178, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4477/4869 (91.9491%)
___Train Local_ResNet_18,  epoch 167, local model 7, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4132/4869 (84.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.4150, Accuracy: 4996/10000 (49.9600%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5050/5346 (94.4632%)
___Train Local_ResNet_18,  epoch 167, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4955/5346 (92.6861%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2559, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5492/6080 (90.3289%)
___Train Local_ResNet_18,  epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5312/6080 (87.3684%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2571, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3657/3959 (92.3718%)
___Train Local_ResNet_18,  epoch 167, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3573/3959 (90.2501%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0583, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5212/5615 (92.8228%)
___Train Local_ResNet_18,  epoch 167, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5141/5615 (91.5583%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2257, Accuracy: 5252/10000 (52.5200%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4506/4843 (93.0415%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4458/4843 (92.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9553, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4395/4605 (95.4397%)
___Train Local_ResNet_18,  epoch 167, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4336/4605 (94.1585%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9485, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4474/4714 (94.9088%)
___Train Local_ResNet_18,  epoch 167, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4427/4714 (93.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9539, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4425/4797 (92.2452%)
___Train Local_ResNet_18,  epoch 167, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4314/4797 (89.9312%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1514, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5165/5652 (91.3836%)
___Train Local_ResNet_18,  epoch 167, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5015/5652 (88.7297%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3645, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4946/5504 (89.8619%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4793/5504 (87.0821%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2721, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4755/5075 (93.6946%)
___Train Local_ResNet_18,  epoch 167, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4562/5075 (89.8916%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0108, Accuracy: 5483/10000 (54.8300%)
time spent on training: 275.96989822387695
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3854, Accuracy: 6535/10000 (65.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0399, Accuracy: 9789/9900 (98.8788%)
Done in 302.244832277298 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 32, 2, 40, 91, 74, 50, 6, 92, 53, 87, 69, 86, 52, 37, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.432322955728836.
Norm before scaling: 44.39030600906154. Distance: 1.1928375651659502
Total norm for 4 adversaries is: 44.39030600906154. distance: 1.1928375651659502
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0124, Accuracy: 9869/9900 (99.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5652/5777 (97.8362%), train_poison_data_count: 455
Global model norm: 44.432322955728836.
Norm before scaling: 44.385054703747834. Distance: 1.233252534066842
Total norm for 4 adversaries is: 44.385054703747834. distance: 1.233252534066842
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0507, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4988/5123 (97.3648%), train_poison_data_count: 403
Global model norm: 44.432322955728836.
Norm before scaling: 44.39376666329055. Distance: 1.233988641077621
Total norm for 4 adversaries is: 44.39376666329055. distance: 1.233988641077621
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.2125, Accuracy: 9311/9900 (94.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5367/5503 (97.5286%), train_poison_data_count: 430
Global model norm: 44.432322955728836.
Norm before scaling: 44.391264349936435. Distance: 1.2884746713987278
Total norm for 4 adversaries is: 44.391264349936435. distance: 1.2884746713987278
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0276, Accuracy: 9832/9900 (99.3131%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3915/4175 (93.7725%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3854/4175 (92.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8674, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5473/6080 (90.0164%)
___Train Local_ResNet_18,  epoch 168, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5292/6080 (87.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.3013, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3751/3968 (94.5312%)
___Train Local_ResNet_18,  epoch 168, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3753/3968 (94.5817%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7529, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5527/5939 (93.0628%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5391/5939 (90.7729%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1671, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4111/4527 (90.8107%)
___Train Local_ResNet_18,  epoch 168, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3986/4527 (88.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2064, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4493/4797 (93.6627%)
___Train Local_ResNet_18,  epoch 168, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4413/4797 (91.9950%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9954, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4460/4757 (93.7566%)
___Train Local_ResNet_18,  epoch 168, local model 50, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4341/4757 (91.2550%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1616, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4623/4929 (93.7918%)
___Train Local_ResNet_18,  epoch 168, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4476/4929 (90.8095%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2267, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6482/6812 (95.1556%)
___Train Local_ResNet_18,  epoch 168, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6276/6812 (92.1315%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1281, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5947/6664 (89.2407%)
___Train Local_ResNet_18,  epoch 168, local model 53, internal_epoch   2,  Average loss: 0.0089, Accuracy: 5520/6664 (82.8331%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.4566, Accuracy: 4751/10000 (47.5100%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3679/3995 (92.0901%)
___Train Local_ResNet_18,  epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3597/3995 (90.0375%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2934, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4056/4364 (92.9423%)
___Train Local_ResNet_18,  epoch 168, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4030/4364 (92.3465%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0796, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3612/3929 (91.9318%)
___Train Local_ResNet_18,  epoch 168, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3603/3929 (91.7027%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1005, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3887/4130 (94.1162%)
___Train Local_ResNet_18,  epoch 168, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3787/4130 (91.6949%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9970, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4384/4741 (92.4699%)
___Train Local_ResNet_18,  epoch 168, local model 37, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4074/4741 (85.9312%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.5550, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5522/5871 (94.0555%)
___Train Local_ResNet_18,  epoch 168, local model 70, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5364/5871 (91.3643%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2452, Accuracy: 5268/10000 (52.6800%)
time spent on training: 275.0061218738556
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.3857, Accuracy: 6529/10000 (65.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0438, Accuracy: 9783/9900 (98.8182%)
Done in 301.3806848526001 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 30, 23, 34, 24, 2, 67, 21, 72, 83, 87, 29, 15, 42, 37, 70, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5207/5308 (98.0972%), train_poison_data_count: 415
Global model norm: 44.45154324953887.
Norm before scaling: 44.40773852844724. Distance: 1.1513480329659345
Total norm for 4 adversaries is: 44.40773852844724. distance: 1.1513480329659345
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0330, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5660/5777 (97.9747%), train_poison_data_count: 455
Global model norm: 44.45154324953887.
Norm before scaling: 44.40544867547577. Distance: 1.2481276317371939
Total norm for 4 adversaries is: 44.40544867547577. distance: 1.2481276317371939
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0269, Accuracy: 9827/9900 (99.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4978/5123 (97.1696%), train_poison_data_count: 403
Global model norm: 44.45154324953887.
Norm before scaling: 44.41269992962669. Distance: 1.2474938064146237
Total norm for 4 adversaries is: 44.41269992962669. distance: 1.2474938064146237
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0398, Accuracy: 9795/9900 (98.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5385/5503 (97.8557%), train_poison_data_count: 430
Global model norm: 44.45154324953887.
Norm before scaling: 44.40840649452323. Distance: 1.2376996909965998
Total norm for 4 adversaries is: 44.40840649452323. distance: 1.2376996909965998
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0224, Accuracy: 9844/9900 (99.4343%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3574/3774 (94.7006%)
___Train Local_ResNet_18,  epoch 169, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3568/3774 (94.5416%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9447, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4306/4549 (94.6582%)
___Train Local_ResNet_18,  epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4210/4549 (92.5478%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1020, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4600/4911 (93.6673%)
___Train Local_ResNet_18,  epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4508/4911 (91.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1221, Accuracy: 5415/10000 (54.1500%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4064/4313 (94.2268%)
___Train Local_ResNet_18,  epoch 169, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4007/4313 (92.9052%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9545, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3781/3968 (95.2873%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3721/3968 (93.7752%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7720, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5132/5559 (92.3188%)
___Train Local_ResNet_18,  epoch 169, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4933/5559 (88.7390%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.2201, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4704/5038 (93.3704%)
___Train Local_ResNet_18,  epoch 169, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5038 (91.8023%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0682, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4773/5193 (91.9122%)
___Train Local_ResNet_18,  epoch 169, local model 72, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4645/5193 (89.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.4190, Accuracy: 5082/10000 (50.8200%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3271/3552 (92.0890%)
___Train Local_ResNet_18,  epoch 169, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3269/3552 (92.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8330, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3695/3995 (92.4906%)
___Train Local_ResNet_18,  epoch 169, local model 87, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3601/3995 (90.1377%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1654, Accuracy: 5249/10000 (52.4900%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4486/4732 (94.8014%)
___Train Local_ResNet_18,  epoch 169, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4457/4732 (94.1885%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9246, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5613/6068 (92.5016%)
___Train Local_ResNet_18,  epoch 169, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5480/6068 (90.3098%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1619, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5360/5907 (90.7398%)
___Train Local_ResNet_18,  epoch 169, local model 42, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5235/5907 (88.6237%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.8357, Accuracy: 4462/10000 (44.6200%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4425/4741 (93.3347%)
___Train Local_ResNet_18,  epoch 169, local model 37, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4157/4741 (87.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.7602, Accuracy: 4813/10000 (48.1300%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5522/5871 (94.0555%)
___Train Local_ResNet_18,  epoch 169, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5405/5871 (92.0627%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1210, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3877/4111 (94.3080%)
___Train Local_ResNet_18,  epoch 169, local model 79, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3767/4111 (91.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1679, Accuracy: 5480/10000 (54.8000%)
time spent on training: 272.5200300216675
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.3939, Accuracy: 6516/10000 (65.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0412, Accuracy: 9788/9900 (98.8687%)
Done in 299.23487401008606 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 51, 97, 20, 54, 5, 34, 74, 14, 77, 50, 56, 10, 16, 39, 79].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.46959135931049.
Norm before scaling: 44.42734588628945. Distance: 1.1602665498749536
Total norm for 4 adversaries is: 44.42734588628945. distance: 1.1602665498749536
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0199, Accuracy: 9846/9900 (99.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.46959135931049.
Norm before scaling: 44.422358641405175. Distance: 1.2195861588994796
Total norm for 4 adversaries is: 44.422358641405175. distance: 1.2195861588994796
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0234, Accuracy: 9840/9900 (99.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4989/5123 (97.3843%), train_poison_data_count: 403
Global model norm: 44.46959135931049.
Norm before scaling: 44.42923484801069. Distance: 1.2169855990940914
Total norm for 4 adversaries is: 44.42923484801069. distance: 1.2169855990940914
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0390, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5373/5503 (97.6377%), train_poison_data_count: 430
Global model norm: 44.46959135931049.
Norm before scaling: 44.42716316791381. Distance: 1.2278674527805924
Total norm for 4 adversaries is: 44.42716316791381. distance: 1.2278674527805924
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0563, Accuracy: 9774/9900 (98.7273%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4359/4672 (93.3005%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4406/4672 (94.3065%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9684, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3879/4108 (94.4255%)
___Train Local_ResNet_18,  epoch 170, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3827/4108 (93.1597%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9544, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4363/4736 (92.1242%)
___Train Local_ResNet_18,  epoch 170, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4260/4736 (89.9493%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0873, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4482/4714 (95.0785%)
___Train Local_ResNet_18,  epoch 170, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4447/4714 (94.3360%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8586, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5118/5645 (90.6643%)
___Train Local_ResNet_18,  epoch 170, local model 54, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4853/5645 (85.9699%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1443, Accuracy: 5208/10000 (52.0800%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4743/4993 (94.9930%)
___Train Local_ResNet_18,  epoch 170, local model 5, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4599/4993 (92.1090%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2380, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4621/4911 (94.0949%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4590/4911 (93.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0214, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4401/4797 (91.7448%)
___Train Local_ResNet_18,  epoch 170, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4418/4797 (92.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1317, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4009/4196 (95.5434%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3983/4196 (94.9237%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8030, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4613/5050 (91.3465%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4493/5050 (88.9703%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1460, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4478/4757 (94.1350%)
___Train Local_ResNet_18,  epoch 170, local model 50, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4363/4757 (91.7175%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0427, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4940/5427 (91.0263%)
___Train Local_ResNet_18,  epoch 170, local model 56, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4772/5427 (87.9307%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1079, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4770/5068 (94.1200%)
___Train Local_ResNet_18,  epoch 170, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4713/5068 (92.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1444, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5005/5353 (93.4990%)
___Train Local_ResNet_18,  epoch 170, local model 16, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4750/5353 (88.7353%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.1009, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3876/4175 (92.8383%)
___Train Local_ResNet_18,  epoch 170, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3795/4175 (90.8982%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0921, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3862/4111 (93.9431%)
___Train Local_ResNet_18,  epoch 170, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3817/4111 (92.8485%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0692, Accuracy: 5464/10000 (54.6400%)
time spent on training: 272.22597646713257
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4048, Accuracy: 6489/10000 (64.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0384, Accuracy: 9793/9900 (98.9192%)
Done in 298.55290603637695 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 31, 8, 83, 64, 23, 74, 90, 97, 86, 76, 0, 62, 33, 32, 54, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5212/5308 (98.1914%), train_poison_data_count: 415
Global model norm: 44.48688991178679.
Norm before scaling: 44.44372703820951. Distance: 1.1589938933184465
Total norm for 4 adversaries is: 44.44372703820951. distance: 1.1589938933184465
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0407, Accuracy: 9798/9900 (98.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5654/5777 (97.8709%), train_poison_data_count: 455
Global model norm: 44.48688991178679.
Norm before scaling: 44.439860993450324. Distance: 1.2256916623658811
Total norm for 4 adversaries is: 44.439860993450324. distance: 1.2256916623658811
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0787, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4996/5123 (97.5210%), train_poison_data_count: 403
Global model norm: 44.48688991178679.
Norm before scaling: 44.44595037664075. Distance: 1.200408891712041
Total norm for 4 adversaries is: 44.44595037664075. distance: 1.200408891712041
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0634, Accuracy: 9742/9900 (98.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5358/5503 (97.3651%), train_poison_data_count: 430
Global model norm: 44.48688991178679.
Norm before scaling: 44.446023158538885. Distance: 1.2948521844168683
Total norm for 4 adversaries is: 44.446023158538885. distance: 1.2948521844168683
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0247, Accuracy: 9836/9900 (99.3535%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4301/4537 (94.7983%)
___Train Local_ResNet_18,  epoch 171, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4237/4537 (93.3877%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9072, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4543/4889 (92.9229%)
___Train Local_ResNet_18,  epoch 171, local model 8, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4540/4889 (92.8615%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9920, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3309/3552 (93.1588%)
___Train Local_ResNet_18,  epoch 171, local model 83, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3363/3552 (94.6791%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8485, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4506/4894 (92.0719%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4375/4894 (89.3952%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0753, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4338/4549 (95.3616%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3847/4549 (84.5680%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.6119, Accuracy: 4767/10000 (47.6700%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4440/4797 (92.5578%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4333/4797 (90.3273%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0347, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4543/4748 (95.6824%)
___Train Local_ResNet_18,  epoch 171, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4406/4748 (92.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9442, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4347/4736 (91.7863%)
___Train Local_ResNet_18,  epoch 171, local model 97, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4259/4736 (89.9282%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2552, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3650/3929 (92.8990%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3574/3929 (90.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9692, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3652/3959 (92.2455%)
___Train Local_ResNet_18,  epoch 171, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3640/3959 (91.9424%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0628, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5005/5454 (91.7675%)
___Train Local_ResNet_18,  epoch 171, local model 0, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4757/5454 (87.2204%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3342, Accuracy: 4986/10000 (49.8600%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4954/5504 (90.0073%)
___Train Local_ResNet_18,  epoch 171, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4742/5504 (86.1555%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2361, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4499/4818 (93.3790%)
___Train Local_ResNet_18,  epoch 171, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4368/4818 (90.6600%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0454, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5464/6080 (89.8684%)
___Train Local_ResNet_18,  epoch 171, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5365/6080 (88.2401%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2920, Accuracy: 5052/10000 (50.5200%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5132/5645 (90.9123%)
___Train Local_ResNet_18,  epoch 171, local model 54, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4859/5645 (86.0762%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2242, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4471/4869 (91.8258%)
___Train Local_ResNet_18,  epoch 171, local model 7, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4077/4869 (83.7338%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.6257, Accuracy: 4748/10000 (47.4800%)
time spent on training: 271.92927289009094
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4111, Accuracy: 6483/10000 (64.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0362, Accuracy: 9801/9900 (99.0000%)
Done in 298.32432103157043 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 93, 25, 55, 21, 42, 88, 17, 23, 2, 68, 12, 52, 5, 44, 72, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 44.50623749297676.
Norm before scaling: 44.46202404334794. Distance: 1.1203291674960894
Total norm for 4 adversaries is: 44.46202404334794. distance: 1.1203291674960894
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0223, Accuracy: 9844/9900 (99.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.50623749297676.
Norm before scaling: 44.45972737656449. Distance: 1.2484339918104015
Total norm for 4 adversaries is: 44.45972737656449. distance: 1.2484339918104015
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0877, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5002/5123 (97.6381%), train_poison_data_count: 403
Global model norm: 44.50623749297676.
Norm before scaling: 44.4647063121064. Distance: 1.208063764209235
Total norm for 4 adversaries is: 44.4647063121064. distance: 1.208063764209235
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0634, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5394/5503 (98.0193%), train_poison_data_count: 430
Global model norm: 44.50623749297676.
Norm before scaling: 44.46267883934022. Distance: 1.1777362475530564
Total norm for 4 adversaries is: 44.46267883934022. distance: 1.1777362475530564
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0571, Accuracy: 9746/9900 (98.4444%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4685/5055 (92.6805%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4629/5055 (91.5727%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1888, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5850/6419 (91.1357%)
___Train Local_ResNet_18,  epoch 172, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5569/6419 (86.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2409, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4486/4731 (94.8214%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4404/4731 (93.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9544, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4667/5038 (92.6360%)
___Train Local_ResNet_18,  epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4630/5038 (91.9015%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0789, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5452/5907 (92.2973%)
___Train Local_ResNet_18,  epoch 172, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5387/5907 (91.1969%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3382, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4998/5362 (93.2115%)
___Train Local_ResNet_18,  epoch 172, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4837/5362 (90.2089%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0981, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4497/4903 (91.7194%)
___Train Local_ResNet_18,  epoch 172, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4382/4903 (89.3739%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2306, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4315/4549 (94.8560%)
___Train Local_ResNet_18,  epoch 172, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4107/4549 (90.2836%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0748, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3764/3968 (94.8589%)
___Train Local_ResNet_18,  epoch 172, local model 2, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3764/3968 (94.8589%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8394, Accuracy: 5793/10000 (57.9300%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3407/3589 (94.9289%)
___Train Local_ResNet_18,  epoch 172, local model 68, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3183/3589 (88.6877%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1364, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5145/5526 (93.1053%)
___Train Local_ResNet_18,  epoch 172, local model 12, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4800/5526 (86.8621%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3226, Accuracy: 5084/10000 (50.8400%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3905/4130 (94.5521%)
___Train Local_ResNet_18,  epoch 172, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3826/4130 (92.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9366, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4735/4993 (94.8328%)
___Train Local_ResNet_18,  epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4618/4993 (92.4895%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1425, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4792/5075 (94.4236%)
___Train Local_ResNet_18,  epoch 172, local model 44, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4561/5075 (89.8719%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1336, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4785/5193 (92.1433%)
___Train Local_ResNet_18,  epoch 172, local model 72, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4475/5193 (86.1737%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.6015, Accuracy: 4720/10000 (47.2000%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4731/5035 (93.9623%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4693/5035 (93.2075%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0681, Accuracy: 5550/10000 (55.5000%)
time spent on training: 276.7978904247284
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4149, Accuracy: 6482/10000 (64.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0372, Accuracy: 9799/9900 (98.9798%)
Done in 302.9559910297394 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 32, 54, 57, 25, 67, 38, 0, 98, 43, 94, 42, 26, 70, 90, 56, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5224/5308 (98.4175%), train_poison_data_count: 415
Global model norm: 44.52545192517.
Norm before scaling: 44.481243852746516. Distance: 1.1218443162382643
Total norm for 4 adversaries is: 44.481243852746516. distance: 1.1218443162382643
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0386, Accuracy: 9805/9900 (99.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5655/5777 (97.8882%), train_poison_data_count: 455
Global model norm: 44.52545192517.
Norm before scaling: 44.47755809201001. Distance: 1.2235584769232755
Total norm for 4 adversaries is: 44.47755809201001. distance: 1.2235584769232755
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0498, Accuracy: 9764/9900 (98.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.52545192517.
Norm before scaling: 44.48299057162538. Distance: 1.211826564141562
Total norm for 4 adversaries is: 44.48299057162538. distance: 1.211826564141562
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0245, Accuracy: 9828/9900 (99.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5383/5503 (97.8194%), train_poison_data_count: 430
Global model norm: 44.52545192517.
Norm before scaling: 44.485356010872415. Distance: 1.2955465291721011
Total norm for 4 adversaries is: 44.485356010872415. distance: 1.2955465291721011
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0300, Accuracy: 9828/9900 (99.2727%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5566/6080 (91.5461%)
___Train Local_ResNet_18,  epoch 173, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5316/6080 (87.4342%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2884, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5167/5645 (91.5323%)
___Train Local_ResNet_18,  epoch 173, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4897/5645 (86.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1607, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4675/4956 (94.3301%)
___Train Local_ResNet_18,  epoch 173, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4567/4956 (92.1509%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0490, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5825/6419 (90.7462%)
___Train Local_ResNet_18,  epoch 173, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5499/6419 (85.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2712, Accuracy: 5096/10000 (50.9600%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5153/5559 (92.6965%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4894/5559 (88.0374%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2030, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5695/6235 (91.3392%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5515/6235 (88.4523%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3344, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5056/5454 (92.7026%)
___Train Local_ResNet_18,  epoch 173, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4923/5454 (90.2640%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0944, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3943/4161 (94.7609%)
___Train Local_ResNet_18,  epoch 173, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3830/4161 (92.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0045, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4614/4979 (92.6692%)
___Train Local_ResNet_18,  epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4520/4979 (90.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1207, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4800/5224 (91.8836%)
___Train Local_ResNet_18,  epoch 173, local model 94, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4744/5224 (90.8116%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1587, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5510/5907 (93.2792%)
___Train Local_ResNet_18,  epoch 173, local model 42, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5450/5907 (92.2634%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3098, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3890/4086 (95.2031%)
___Train Local_ResNet_18,  epoch 173, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3837/4086 (93.9060%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8792, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5528/5871 (94.1577%)
___Train Local_ResNet_18,  epoch 173, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5392/5871 (91.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.2256, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4529/4748 (95.3875%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4375/4748 (92.1441%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0460, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4939/5427 (91.0079%)
___Train Local_ResNet_18,  epoch 173, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4841/5427 (89.2021%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0830, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4020/4196 (95.8055%)
___Train Local_ResNet_18,  epoch 173, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3999/4196 (95.3051%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9522, Accuracy: 5697/10000 (56.9700%)
time spent on training: 282.0829267501831
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4253, Accuracy: 6458/10000 (64.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0334, Accuracy: 9807/9900 (99.0606%)
Done in 308.5604045391083 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 12, 96, 75, 78, 54, 4, 5, 33, 35, 83, 57, 40, 6, 38, 18, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.54561857005762.
Norm before scaling: 44.503092797632476. Distance: 1.2109888865735066
Total norm for 4 adversaries is: 44.503092797632476. distance: 1.2109888865735066
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0297, Accuracy: 9825/9900 (99.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.54561857005762.
Norm before scaling: 44.49751737720179. Distance: 1.2365684335993807
Total norm for 4 adversaries is: 44.49751737720179. distance: 1.2365684335993807
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0348, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5015/5123 (97.8919%), train_poison_data_count: 403
Global model norm: 44.54561857005762.
Norm before scaling: 44.50338492217474. Distance: 1.158255513182013
Total norm for 4 adversaries is: 44.50338492217474. distance: 1.158255513182013
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0446, Accuracy: 9787/9900 (98.8586%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5407/5503 (98.2555%), train_poison_data_count: 430
Global model norm: 44.54561857005762.
Norm before scaling: 44.501431902875325. Distance: 1.1744481129851159
Total norm for 4 adversaries is: 44.501431902875325. distance: 1.1744481129851159
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0833, Accuracy: 9655/9900 (97.5253%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5051/5526 (91.4043%)
___Train Local_ResNet_18,  epoch 174, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4836/5526 (87.5136%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.3199, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4781/5086 (94.0031%)
___Train Local_ResNet_18,  epoch 174, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4732/5086 (93.0397%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9723, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4417/4672 (94.5420%)
___Train Local_ResNet_18,  epoch 174, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4350/4672 (93.1079%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9095, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4118/4368 (94.2766%)
___Train Local_ResNet_18,  epoch 174, local model 78, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4030/4368 (92.2619%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0812, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5116/5645 (90.6289%)
___Train Local_ResNet_18,  epoch 174, local model 54, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4745/5645 (84.0567%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.4477, Accuracy: 4893/10000 (48.9300%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3800/4028 (94.3396%)
___Train Local_ResNet_18,  epoch 174, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3761/4028 (93.3714%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9155, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4725/4993 (94.6325%)
___Train Local_ResNet_18,  epoch 174, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4621/4993 (92.5496%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1486, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4497/4818 (93.3375%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4430/4818 (91.9469%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1594, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5193/5615 (92.4844%)
___Train Local_ResNet_18,  epoch 174, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5089/5615 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2299, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3289/3552 (92.5957%)
___Train Local_ResNet_18,  epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3322/3552 (93.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9514, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4645/4956 (93.7248%)
___Train Local_ResNet_18,  epoch 174, local model 57, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4574/4956 (92.2922%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0747, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5559/5939 (93.6016%)
___Train Local_ResNet_18,  epoch 174, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5497/5939 (92.5577%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0593, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4638/4929 (94.0962%)
___Train Local_ResNet_18,  epoch 174, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4498/4929 (91.2558%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1749, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5663/6235 (90.8260%)
___Train Local_ResNet_18,  epoch 174, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5467/6235 (87.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.2564, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4018/4249 (94.5634%)
___Train Local_ResNet_18,  epoch 174, local model 18, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3950/4249 (92.9631%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9257, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4225/4485 (94.2029%)
___Train Local_ResNet_18,  epoch 174, local model 61, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3825/4485 (85.2843%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1847, Accuracy: 5094/10000 (50.9400%)
time spent on training: 275.8919641971588
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4269, Accuracy: 6456/10000 (64.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0319, Accuracy: 9812/9900 (99.1111%)
Done in 302.5494771003723 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 65, 4, 57, 0, 72, 62, 24, 77, 78, 41, 19, 61, 52, 59, 2, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.56377512858328.
Norm before scaling: 44.51857138590801. Distance: 1.1184642405482859
Total norm for 4 adversaries is: 44.51857138590801. distance: 1.1184642405482859
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0501, Accuracy: 9762/9900 (98.6061%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.56377512858328.
Norm before scaling: 44.51423194556012. Distance: 1.198359824875055
Total norm for 4 adversaries is: 44.51423194556012. distance: 1.198359824875055
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0634, Accuracy: 9736/9900 (98.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 44.56377512858328.
Norm before scaling: 44.52300636416105. Distance: 1.2027567510453054
Total norm for 4 adversaries is: 44.52300636416105. distance: 1.2027567510453054
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0505, Accuracy: 9762/9900 (98.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.56377512858328.
Norm before scaling: 44.519058089801554. Distance: 1.1983966308150404
Total norm for 4 adversaries is: 44.519058089801554. distance: 1.1983966308150404
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0388, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5116/5497 (93.0689%)
___Train Local_ResNet_18,  epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4942/5497 (89.9036%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0463, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3822/4028 (94.8858%)
___Train Local_ResNet_18,  epoch 175, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3771/4028 (93.6197%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9524, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4679/4956 (94.4108%)
___Train Local_ResNet_18,  epoch 175, local model 57, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4514/4956 (91.0815%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2278, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5020/5454 (92.0425%)
___Train Local_ResNet_18,  epoch 175, local model 0, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4846/5454 (88.8522%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2449, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4808/5193 (92.5862%)
___Train Local_ResNet_18,  epoch 175, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4572/5193 (88.0416%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3592, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4976/5504 (90.4070%)
___Train Local_ResNet_18,  epoch 175, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4875/5504 (88.5719%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0933, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4047/4313 (93.8326%)
___Train Local_ResNet_18,  epoch 175, local model 24, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4011/4313 (92.9979%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1910, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4608/5050 (91.2475%)
___Train Local_ResNet_18,  epoch 175, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4479/5050 (88.6931%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.1492, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4129/4368 (94.5284%)
___Train Local_ResNet_18,  epoch 175, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4083/4368 (93.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8889, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4469/4714 (94.8027%)
___Train Local_ResNet_18,  epoch 175, local model 41, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4390/4714 (93.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2494, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4898/5361 (91.3636%)
___Train Local_ResNet_18,  epoch 175, local model 19, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4891/5361 (91.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0732, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4154/4485 (92.6198%)
___Train Local_ResNet_18,  epoch 175, local model 61, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3725/4485 (83.0546%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.5020, Accuracy: 4854/10000 (48.5400%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3898/4130 (94.3826%)
___Train Local_ResNet_18,  epoch 175, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3882/4130 (93.9952%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9244, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4174/4397 (94.9284%)
___Train Local_ResNet_18,  epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4171/4397 (94.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9180, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3741/3968 (94.2792%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3757/3968 (94.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8415, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4387/4605 (95.2660%)
___Train Local_ResNet_18,  epoch 175, local model 73, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4309/4605 (93.5722%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9173, Accuracy: 5684/10000 (56.8400%)
time spent on training: 259.1912820339203
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4256, Accuracy: 6461/10000 (64.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0327, Accuracy: 9809/9900 (99.0808%)
Done in 285.5502862930298 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 19, 85, 76, 57, 46, 62, 22, 25, 89, 95, 48, 51, 45, 96, 41, 17].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5202/5308 (98.0030%), train_poison_data_count: 415
Global model norm: 44.5813150584833.
Norm before scaling: 44.538849406392536. Distance: 1.1826160786857416
Total norm for 4 adversaries is: 44.538849406392536. distance: 1.1826160786857416
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0454, Accuracy: 9792/9900 (98.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5667/5777 (98.0959%), train_poison_data_count: 455
Global model norm: 44.5813150584833.
Norm before scaling: 44.53222586650032. Distance: 1.1937710665296957
Total norm for 4 adversaries is: 44.53222586650032. distance: 1.1937710665296957
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0263, Accuracy: 9822/9900 (99.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 44.5813150584833.
Norm before scaling: 44.5380806164792. Distance: 1.1668205103030436
Total norm for 4 adversaries is: 44.5380806164792. distance: 1.1668205103030436
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0801, Accuracy: 9691/9900 (97.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5390/5503 (97.9466%), train_poison_data_count: 430
Global model norm: 44.5813150584833.
Norm before scaling: 44.5363278354908. Distance: 1.2107176058065012
Total norm for 4 adversaries is: 44.5363278354908. distance: 1.2107176058065012
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0481, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4915/5361 (91.6807%)
___Train Local_ResNet_18,  epoch 176, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4832/5361 (90.1324%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1286, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6336/6947 (91.2048%)
___Train Local_ResNet_18,  epoch 176, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 6027/6947 (86.7569%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3777, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3643/3959 (92.0182%)
___Train Local_ResNet_18,  epoch 176, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3635/3959 (91.8161%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1297, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4650/4956 (93.8257%)
___Train Local_ResNet_18,  epoch 176, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4526/4956 (91.3236%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1468, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4874/5399 (90.2760%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4744/5399 (87.8681%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3141, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4948/5504 (89.8983%)
___Train Local_ResNet_18,  epoch 176, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4857/5504 (88.2449%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2614, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5330/5696 (93.5744%)
___Train Local_ResNet_18,  epoch 176, local model 22, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5084/5696 (89.2556%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2458, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5831/6419 (90.8397%)
___Train Local_ResNet_18,  epoch 176, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 5477/6419 (85.3248%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2237, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4421/4737 (93.3291%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4299/4737 (90.7536%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3113, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4617/5018 (92.0088%)
___Train Local_ResNet_18,  epoch 176, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4485/5018 (89.3782%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.4183, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4609/4830 (95.4244%)
___Train Local_ResNet_18,  epoch 176, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4467/4830 (92.4845%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1503, Accuracy: 5370/10000 (53.7000%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3910/4108 (95.1801%)
___Train Local_ResNet_18,  epoch 176, local model 51, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3818/4108 (92.9406%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0093, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5003/5489 (91.1459%)
___Train Local_ResNet_18,  epoch 176, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4974/5489 (90.6176%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1869, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4785/5086 (94.0818%)
___Train Local_ResNet_18,  epoch 176, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4723/5086 (92.8628%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0653, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4438/4714 (94.1451%)
___Train Local_ResNet_18,  epoch 176, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4385/4714 (93.0208%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0141, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4500/4903 (91.7805%)
___Train Local_ResNet_18,  epoch 176, local model 17, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4439/4903 (90.5364%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3865, Accuracy: 5004/10000 (50.0400%)
time spent on training: 253.58768844604492
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4354, Accuracy: 6456/10000 (64.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0313, Accuracy: 9814/9900 (99.1313%)
Done in 280.10220980644226 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 2, 27, 99, 74, 8, 3, 67, 72, 7, 24, 17, 10, 20, 59, 16, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.600701050316324.
Norm before scaling: 44.55457037399123. Distance: 1.0979765292405492
Total norm for 4 adversaries is: 44.55457037399123. distance: 1.0979765292405492
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0367, Accuracy: 9802/9900 (99.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.600701050316324.
Norm before scaling: 44.549209645942376. Distance: 1.1738923574128495
Total norm for 4 adversaries is: 44.549209645942376. distance: 1.1738923574128495
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0372, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 44.600701050316324.
Norm before scaling: 44.558171686711965. Distance: 1.1942504452965481
Total norm for 4 adversaries is: 44.558171686711965. distance: 1.1942504452965481
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0833, Accuracy: 9694/9900 (97.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.600701050316324.
Norm before scaling: 44.55630325954174. Distance: 1.2007112938104583
Total norm for 4 adversaries is: 44.55630325954174. distance: 1.2007112938104583
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0372, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3772/3968 (95.0605%)
___Train Local_ResNet_18,  epoch 177, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3727/3968 (93.9264%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8576, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4304/4587 (93.8304%)
___Train Local_ResNet_18,  epoch 177, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4244/4587 (92.5223%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0743, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4434/4851 (91.4038%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4346/4851 (89.5898%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1329, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4511/4797 (94.0379%)
___Train Local_ResNet_18,  epoch 177, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4386/4797 (91.4321%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9450, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4591/4889 (93.9047%)
___Train Local_ResNet_18,  epoch 177, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4456/4889 (91.1434%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1242, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5079/5346 (95.0056%)
___Train Local_ResNet_18,  epoch 177, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5006/5346 (93.6401%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1800, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5157/5559 (92.7685%)
___Train Local_ResNet_18,  epoch 177, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4918/5559 (88.4691%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2792, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4718/5193 (90.8531%)
___Train Local_ResNet_18,  epoch 177, local model 72, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4503/5193 (86.7129%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.5161, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4510/4869 (92.6268%)
___Train Local_ResNet_18,  epoch 177, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4313/4869 (88.5808%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2093, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4060/4313 (94.1340%)
___Train Local_ResNet_18,  epoch 177, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4038/4313 (93.6239%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8930, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4527/4903 (92.3312%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4460/4903 (90.9647%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.1822, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4843/5068 (95.5604%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4649/5068 (91.7324%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3846, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4498/4714 (95.4179%)
___Train Local_ResNet_18,  epoch 177, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4446/4714 (94.3148%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9176, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4214/4397 (95.8381%)
___Train Local_ResNet_18,  epoch 177, local model 59, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4218/4397 (95.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7040, Accuracy: 6021/10000 (60.2100%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5019/5353 (93.7605%)
___Train Local_ResNet_18,  epoch 177, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4855/5353 (90.6968%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2377, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4518/4818 (93.7733%)
___Train Local_ResNet_18,  epoch 177, local model 33, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4357/4818 (90.4317%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.2635, Accuracy: 5191/10000 (51.9100%)
time spent on training: 248.4403235912323
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4395, Accuracy: 6441/10000 (64.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0301, Accuracy: 9813/9900 (99.1212%)
Done in 274.720255613327 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 44, 6, 40, 60, 96, 93, 0, 47, 5, 94, 78, 63, 23, 45, 26, 72].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5222/5308 (98.3798%), train_poison_data_count: 415
Global model norm: 44.61804726342876.
Norm before scaling: 44.57343396716255. Distance: 1.1244827776955877
Total norm for 4 adversaries is: 44.57343396716255. distance: 1.1244827776955877
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0850, Accuracy: 9672/9900 (97.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.61804726342876.
Norm before scaling: 44.56820560861605. Distance: 1.1970086623175578
Total norm for 4 adversaries is: 44.56820560861605. distance: 1.1970086623175578
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0328, Accuracy: 9814/9900 (99.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.61804726342876.
Norm before scaling: 44.57574120641812. Distance: 1.2067892084985157
Total norm for 4 adversaries is: 44.57574120641812. distance: 1.2067892084985157
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0285, Accuracy: 9825/9900 (99.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5393/5503 (98.0011%), train_poison_data_count: 430
Global model norm: 44.61804726342876.
Norm before scaling: 44.5734572455437. Distance: 1.1958983737036566
Total norm for 4 adversaries is: 44.5734572455437. distance: 1.1958983737036566
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0362, Accuracy: 9813/9900 (99.1212%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4781/5075 (94.2069%)
___Train Local_ResNet_18,  epoch 178, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4744/5075 (93.4778%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2057, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4622/4929 (93.7716%)
___Train Local_ResNet_18,  epoch 178, local model 6, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4465/4929 (90.5863%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3535, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5566/5939 (93.7195%)
___Train Local_ResNet_18,  epoch 178, local model 40, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5473/5939 (92.1536%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0830, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3868/4145 (93.3172%)
___Train Local_ResNet_18,  epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3883/4145 (93.6791%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9842, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4783/5086 (94.0425%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4703/5086 (92.4695%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2348, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4726/5055 (93.4916%)
___Train Local_ResNet_18,  epoch 178, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4639/5055 (91.7705%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0124, Accuracy: 5578/10000 (55.7800%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5050/5454 (92.5926%)
___Train Local_ResNet_18,  epoch 178, local model 0, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4739/5454 (86.8904%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3008, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4762/5123 (92.9533%)
___Train Local_ResNet_18,  epoch 178, local model 47, internal_epoch   2,  Average loss: 0.0130, Accuracy: 3935/5123 (76.8105%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.4925, Accuracy: 4742/10000 (47.4200%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4718/4993 (94.4923%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4594/4993 (92.0088%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0653, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4824/5224 (92.3430%)
___Train Local_ResNet_18,  epoch 178, local model 94, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4739/5224 (90.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0421, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4155/4368 (95.1236%)
___Train Local_ResNet_18,  epoch 178, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4134/4368 (94.6429%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9361, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3728/3910 (95.3453%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3623/3910 (92.6598%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0529, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4356/4549 (95.7573%)
___Train Local_ResNet_18,  epoch 178, local model 23, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4021/4549 (88.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3832, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5005/5489 (91.1824%)
___Train Local_ResNet_18,  epoch 178, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4949/5489 (90.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.2724, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3871/4086 (94.7381%)
___Train Local_ResNet_18,  epoch 178, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3834/4086 (93.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0420, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4785/5193 (92.1433%)
___Train Local_ResNet_18,  epoch 178, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4604/5193 (88.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.3900, Accuracy: 5077/10000 (50.7700%)
time spent on training: 249.63067150115967
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4543, Accuracy: 6421/10000 (64.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0272, Accuracy: 9823/9900 (99.2222%)
Done in 275.88825011253357 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 27, 56, 90, 39, 16, 69, 88, 23, 98, 84, 48, 3, 35, 81, 55, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5230/5308 (98.5305%), train_poison_data_count: 415
Global model norm: 44.636644740738944.
Norm before scaling: 44.59059505088699. Distance: 1.0913710198693014
Total norm for 4 adversaries is: 44.59059505088699. distance: 1.0913710198693014
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0570, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5676/5777 (98.2517%), train_poison_data_count: 455
Global model norm: 44.636644740738944.
Norm before scaling: 44.58662949020564. Distance: 1.1742502681641722
Total norm for 4 adversaries is: 44.58662949020564. distance: 1.1742502681641722
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0283, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.636644740738944.
Norm before scaling: 44.594036055932555. Distance: 1.1817367640706937
Total norm for 4 adversaries is: 44.594036055932555. distance: 1.1817367640706937
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0807, Accuracy: 9695/9900 (97.9293%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.636644740738944.
Norm before scaling: 44.59176808840394. Distance: 1.2279551672533158
Total norm for 4 adversaries is: 44.59176808840394. distance: 1.2279551672533158
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0328, Accuracy: 9819/9900 (99.1818%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4321/4587 (94.2010%)
___Train Local_ResNet_18,  epoch 179, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4258/4587 (92.8276%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1253, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5034/5427 (92.7584%)
___Train Local_ResNet_18,  epoch 179, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4903/5427 (90.3446%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0894, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4517/4748 (95.1348%)
___Train Local_ResNet_18,  epoch 179, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4365/4748 (91.9334%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0923, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3916/4175 (93.7964%)
___Train Local_ResNet_18,  epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3786/4175 (90.6826%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0606, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5055/5353 (94.4330%)
___Train Local_ResNet_18,  epoch 179, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4866/5353 (90.9023%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2665, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4084/4364 (93.5839%)
___Train Local_ResNet_18,  epoch 179, local model 69, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3902/4364 (89.4134%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2291, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5026/5362 (93.7337%)
___Train Local_ResNet_18,  epoch 179, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4887/5362 (91.1414%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3845, Accuracy: 5040/10000 (50.4000%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4331/4549 (95.2077%)
___Train Local_ResNet_18,  epoch 179, local model 23, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3869/4549 (85.0517%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.3952, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3945/4161 (94.8089%)
___Train Local_ResNet_18,  epoch 179, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3836/4161 (92.1894%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1353, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4807/5209 (92.2826%)
___Train Local_ResNet_18,  epoch 179, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4681/5209 (89.8637%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1352, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4577/4830 (94.7619%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4544/4830 (94.0787%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0868, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5088/5346 (95.1740%)
___Train Local_ResNet_18,  epoch 179, local model 3, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5028/5346 (94.0516%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0417, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5268/5615 (93.8201%)
___Train Local_ResNet_18,  epoch 179, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5217/5615 (92.9118%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0670, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4760/5035 (94.5382%)
___Train Local_ResNet_18,  epoch 179, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4674/5035 (92.8302%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0149, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4531/4731 (95.7726%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4419/4731 (93.4052%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0951, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5071/5702 (88.9337%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0126, Accuracy: 4330/5702 (75.9383%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4780, Accuracy: 4755/10000 (47.5500%)
time spent on training: 251.5528175830841
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.4647, Accuracy: 6394/10000 (63.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0254, Accuracy: 9832/9900 (99.3131%)
Done in 277.86989521980286 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 97, 21, 14, 37, 95, 9, 28, 17, 73, 23, 0, 68, 19, 50, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5244/5308 (98.7943%), train_poison_data_count: 415
Global model norm: 44.65546136243794.
Norm before scaling: 44.60797666372294. Distance: 1.0473968571614112
Total norm for 4 adversaries is: 44.60797666372294. distance: 1.0473968571614112
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0299, Accuracy: 9819/9900 (99.1818%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5672/5777 (98.1824%), train_poison_data_count: 455
Global model norm: 44.65546136243794.
Norm before scaling: 44.60684373291278. Distance: 1.208151880429991
Total norm for 4 adversaries is: 44.60684373291278. distance: 1.208151880429991
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0227, Accuracy: 9845/9900 (99.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4995/5123 (97.5015%), train_poison_data_count: 403
Global model norm: 44.65546136243794.
Norm before scaling: 44.61334127507782. Distance: 1.1740582283435774
Total norm for 4 adversaries is: 44.61334127507782. distance: 1.1740582283435774
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0655, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5398/5503 (98.0919%), train_poison_data_count: 430
Global model norm: 44.65546136243794.
Norm before scaling: 44.61173647427322. Distance: 1.2160412445947724
Total norm for 4 adversaries is: 44.61173647427322. distance: 1.2160412445947724
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0396, Accuracy: 9800/9900 (98.9899%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4384/4736 (92.5676%)
___Train Local_ResNet_18,  epoch 180, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4245/4736 (89.6326%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0456, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4699/5038 (93.2711%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4640/5038 (92.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0830, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4041/4196 (96.3060%)
___Train Local_ResNet_18,  epoch 180, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4019/4196 (95.7817%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8079, Accuracy: 6020/10000 (60.2000%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4435/4741 (93.5457%)
___Train Local_ResNet_18,  epoch 180, local model 37, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4247/4741 (89.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.7521, Accuracy: 4634/10000 (46.3400%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4589/5018 (91.4508%)
___Train Local_ResNet_18,  epoch 180, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4471/5018 (89.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0436, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5269/5727 (92.0028%)
___Train Local_ResNet_18,  epoch 180, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5043/5727 (88.0566%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1978, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4669/5122 (91.1558%)
___Train Local_ResNet_18,  epoch 180, local model 28, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4193/5122 (81.8626%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.6402, Accuracy: 4695/10000 (46.9500%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4559/4903 (92.9839%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4397/4903 (89.6798%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1815, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4374/4605 (94.9837%)
___Train Local_ResNet_18,  epoch 180, local model 73, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4342/4605 (94.2888%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0751, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4306/4549 (94.6582%)
___Train Local_ResNet_18,  epoch 180, local model 23, internal_epoch   2,  Average loss: 0.0096, Accuracy: 3786/4549 (83.2271%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.5315, Accuracy: 4772/10000 (47.7200%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5091/5454 (93.3443%)
___Train Local_ResNet_18,  epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4885/5454 (89.5673%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2944, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3376/3589 (94.0652%)
___Train Local_ResNet_18,  epoch 180, local model 68, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3270/3589 (91.1117%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0216, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4932/5361 (91.9978%)
___Train Local_ResNet_18,  epoch 180, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4775/5361 (89.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.4348, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4475/4757 (94.0719%)
___Train Local_ResNet_18,  epoch 180, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4325/4757 (90.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1879, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4483/4731 (94.7580%)
___Train Local_ResNet_18,  epoch 180, local model 55, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4404/4731 (93.0881%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1872, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5700/6235 (91.4194%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5479/6235 (87.8749%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3134, Accuracy: 5124/10000 (51.2400%)
time spent on training: 247.4966585636139
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4699, Accuracy: 6403/10000 (64.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0231, Accuracy: 9838/9900 (99.3737%)
Done in 273.8022725582123 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 89, 53, 72, 87, 21, 48, 39, 95, 70, 57, 16, 55, 17, 7, 74, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5206/5308 (98.0784%), train_poison_data_count: 415
Global model norm: 44.675145801035164.
Norm before scaling: 44.6317971232744. Distance: 1.1776499045779185
Total norm for 4 adversaries is: 44.6317971232744. distance: 1.1776499045779185
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0246, Accuracy: 9836/9900 (99.3535%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5680/5777 (98.3209%), train_poison_data_count: 455
Global model norm: 44.675145801035164.
Norm before scaling: 44.624811252226884. Distance: 1.1897348655929225
Total norm for 4 adversaries is: 44.624811252226884. distance: 1.1897348655929225
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0537, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4985/5123 (97.3063%), train_poison_data_count: 403
Global model norm: 44.675145801035164.
Norm before scaling: 44.63500659209722. Distance: 1.2616649887866642
Total norm for 4 adversaries is: 44.63500659209722. distance: 1.2616649887866642
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0601, Accuracy: 9755/9900 (98.5354%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5385/5503 (97.8557%), train_poison_data_count: 430
Global model norm: 44.675145801035164.
Norm before scaling: 44.631306178633594. Distance: 1.2270184295190494
Total norm for 4 adversaries is: 44.631306178633594. distance: 1.2270184295190494
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0792, Accuracy: 9692/9900 (97.8990%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4421/4737 (93.3291%)
___Train Local_ResNet_18,  epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4361/4737 (92.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1904, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5958/6664 (89.4058%)
___Train Local_ResNet_18,  epoch 181, local model 53, internal_epoch   2,  Average loss: 0.0078, Accuracy: 5646/6664 (84.7239%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3038, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4747/5193 (91.4115%)
___Train Local_ResNet_18,  epoch 181, local model 72, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4570/5193 (88.0031%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3846, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3700/3995 (92.6158%)
___Train Local_ResNet_18,  epoch 181, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3577/3995 (89.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.4956, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4709/5038 (93.4696%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4666/5038 (92.6161%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0226, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4598/4830 (95.1967%)
___Train Local_ResNet_18,  epoch 181, local model 48, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4582/4830 (94.8654%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0509, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3934/4175 (94.2275%)
___Train Local_ResNet_18,  epoch 181, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3835/4175 (91.8563%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0391, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4621/5018 (92.0885%)
___Train Local_ResNet_18,  epoch 181, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4471/5018 (89.0992%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3897, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5514/5871 (93.9193%)
___Train Local_ResNet_18,  epoch 181, local model 70, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5402/5871 (92.0116%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0258, Accuracy: 5584/10000 (55.8400%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4670/4956 (94.2292%)
___Train Local_ResNet_18,  epoch 181, local model 57, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4611/4956 (93.0387%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1526, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5079/5353 (94.8814%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4906/5353 (91.6495%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0137, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4483/4731 (94.7580%)
___Train Local_ResNet_18,  epoch 181, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4437/4731 (93.7857%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9842, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4499/4903 (91.7601%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4444/4903 (90.6384%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3106, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4486/4869 (92.1339%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0131, Accuracy: 3689/4869 (75.7650%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.7309, Accuracy: 4497/10000 (44.9700%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4480/4797 (93.3917%)
___Train Local_ResNet_18,  epoch 181, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4420/4797 (92.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0675, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3736/3910 (95.5499%)
___Train Local_ResNet_18,  epoch 181, local model 63, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3186/3910 (81.4834%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.6310, Accuracy: 4725/10000 (47.2500%)
time spent on training: 249.1582133769989
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.4707, Accuracy: 6411/10000 (64.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0237, Accuracy: 9834/9900 (99.3333%)
Done in 275.5349304676056 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 77, 41, 51, 7, 32, 44, 67, 5, 85, 49, 55, 64, 35, 95, 4, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5203/5308 (98.0219%), train_poison_data_count: 415
Global model norm: 44.69388885711194.
Norm before scaling: 44.64871842103226. Distance: 1.1546497612388118
Total norm for 4 adversaries is: 44.64871842103226. distance: 1.1546497612388118
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0385, Accuracy: 9789/9900 (98.8788%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5678/5777 (98.2863%), train_poison_data_count: 455
Global model norm: 44.69388885711194.
Norm before scaling: 44.643792819435575. Distance: 1.1830640054286399
Total norm for 4 adversaries is: 44.643792819435575. distance: 1.1830640054286399
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0598, Accuracy: 9743/9900 (98.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4998/5123 (97.5600%), train_poison_data_count: 403
Global model norm: 44.69388885711194.
Norm before scaling: 44.6519253066847. Distance: 1.2117741309569543
Total norm for 4 adversaries is: 44.6519253066847. distance: 1.2117741309569543
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0606, Accuracy: 9744/9900 (98.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5389/5503 (97.9284%), train_poison_data_count: 430
Global model norm: 44.69388885711194.
Norm before scaling: 44.64861862933513. Distance: 1.190555956983793
Total norm for 4 adversaries is: 44.64861862933513. distance: 1.190555956983793
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0413, Accuracy: 9796/9900 (98.9495%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4636/5050 (91.8020%)
___Train Local_ResNet_18,  epoch 182, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4542/5050 (89.9406%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1955, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4482/4714 (95.0785%)
___Train Local_ResNet_18,  epoch 182, local model 41, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4365/4714 (92.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1458, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3898/4108 (94.8880%)
___Train Local_ResNet_18,  epoch 182, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3777/4108 (91.9426%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1704, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4478/4869 (91.9696%)
___Train Local_ResNet_18,  epoch 182, local model 7, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4231/4869 (86.8967%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2065, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5405/6080 (88.8980%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5275/6080 (86.7599%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3158, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4841/5075 (95.3892%)
___Train Local_ResNet_18,  epoch 182, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4721/5075 (93.0246%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0713, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5170/5559 (93.0023%)
___Train Local_ResNet_18,  epoch 182, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4910/5559 (88.3252%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1240, Accuracy: 5186/10000 (51.8600%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4731/4993 (94.7527%)
___Train Local_ResNet_18,  epoch 182, local model 5, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4648/4993 (93.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0409, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 6308/6947 (90.8018%)
___Train Local_ResNet_18,  epoch 182, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 6095/6947 (87.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3777, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5140/5652 (90.9413%)
___Train Local_ResNet_18,  epoch 182, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4978/5652 (88.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.4576, Accuracy: 4889/10000 (48.8900%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4496/4731 (95.0328%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4448/4731 (94.0182%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9382, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4511/4894 (92.1741%)
___Train Local_ResNet_18,  epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4281/4894 (87.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3726, Accuracy: 4975/10000 (49.7500%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5219/5615 (92.9475%)
___Train Local_ResNet_18,  epoch 182, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5206/5615 (92.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0184, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4658/5018 (92.8258%)
___Train Local_ResNet_18,  epoch 182, local model 95, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4472/5018 (89.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2342, Accuracy: 5173/10000 (51.7300%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3789/4028 (94.0665%)
___Train Local_ResNet_18,  epoch 182, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3768/4028 (93.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9774, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4723/5123 (92.1921%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4428/5123 (86.4337%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3376, Accuracy: 5069/10000 (50.6900%)
time spent on training: 252.64344334602356
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.4642, Accuracy: 6421/10000 (64.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0250, Accuracy: 9832/9900 (99.3131%)
Done in 279.00630617141724 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 17, 70, 42, 31, 21, 82, 84, 28, 86, 67, 5, 85, 95, 74, 38, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5215/5308 (98.2479%), train_poison_data_count: 415
Global model norm: 44.71427574140193.
Norm before scaling: 44.66834160999824. Distance: 1.1194844142276972
Total norm for 4 adversaries is: 44.66834160999824. distance: 1.1194844142276972
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0583, Accuracy: 9753/9900 (98.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5684/5777 (98.3902%), train_poison_data_count: 455
Global model norm: 44.71427574140193.
Norm before scaling: 44.66370651532965. Distance: 1.1895381101618157
Total norm for 4 adversaries is: 44.66370651532965. distance: 1.1895381101618157
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0552, Accuracy: 9762/9900 (98.6061%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5011/5123 (97.8138%), train_poison_data_count: 403
Global model norm: 44.71427574140193.
Norm before scaling: 44.67179028935655. Distance: 1.1662275929971422
Total norm for 4 adversaries is: 44.67179028935655. distance: 1.1662275929971422
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0122, Accuracy: 9869/9900 (99.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5402/5503 (98.1646%), train_poison_data_count: 430
Global model norm: 44.71427574140193.
Norm before scaling: 44.66820223621749. Distance: 1.1642895675498461
Total norm for 4 adversaries is: 44.66820223621749. distance: 1.1642895675498461
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0438, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4543/4903 (92.6576%)
___Train Local_ResNet_18,  epoch 183, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4531/4903 (92.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1180, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5536/5871 (94.2940%)
___Train Local_ResNet_18,  epoch 183, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5362/5871 (91.3303%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0778, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5444/5907 (92.1618%)
___Train Local_ResNet_18,  epoch 183, local model 42, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5277/5907 (89.3347%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.6788, Accuracy: 4708/10000 (47.0800%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4266/4537 (94.0269%)
___Train Local_ResNet_18,  epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4242/4537 (93.4979%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8529, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4658/5038 (92.4573%)
___Train Local_ResNet_18,  epoch 183, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4668/5038 (92.6558%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9594, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5002/5298 (94.4130%)
___Train Local_ResNet_18,  epoch 183, local model 82, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4924/5298 (92.9407%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1087, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4849/5209 (93.0889%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4745/5209 (91.0923%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1126, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4704/5122 (91.8391%)
___Train Local_ResNet_18,  epoch 183, local model 28, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4140/5122 (80.8278%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.5297, Accuracy: 4716/10000 (47.1600%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3621/3929 (92.1609%)
___Train Local_ResNet_18,  epoch 183, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3590/3929 (91.3719%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0056, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5141/5559 (92.4807%)
___Train Local_ResNet_18,  epoch 183, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4986/5559 (89.6924%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2609, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4709/4993 (94.3120%)
___Train Local_ResNet_18,  epoch 183, local model 5, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4633/4993 (92.7899%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1219, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0042, Accuracy: 6379/6947 (91.8238%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 6078/6947 (87.4910%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.4575, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4583/5018 (91.3312%)
___Train Local_ResNet_18,  epoch 183, local model 95, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4414/5018 (87.9633%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2187, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4483/4797 (93.4542%)
___Train Local_ResNet_18,  epoch 183, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4431/4797 (92.3702%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8894, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5701/6235 (91.4354%)
___Train Local_ResNet_18,  epoch 183, local model 38, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5436/6235 (87.1852%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3193, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5074/5461 (92.9134%)
___Train Local_ResNet_18,  epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4933/5461 (90.3314%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2337, Accuracy: 5238/10000 (52.3800%)
time spent on training: 254.79119324684143
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.4719, Accuracy: 6402/10000 (64.0200%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0242, Accuracy: 9834/9900 (99.3333%)
Done in 281.73773193359375 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 87, 92, 52, 89, 22, 93, 78, 49, 39, 82, 35, 94, 38, 61, 32, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 44.734325881915055.
Norm before scaling: 44.68777589512735. Distance: 1.1221137640153516
Total norm for 4 adversaries is: 44.68777589512735. distance: 1.1221137640153516
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0579, Accuracy: 9759/9900 (98.5758%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.734325881915055.
Norm before scaling: 44.68350069516711. Distance: 1.1838197397959567
Total norm for 4 adversaries is: 44.68350069516711. distance: 1.1838197397959567
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0582, Accuracy: 9756/9900 (98.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5005/5123 (97.6967%), train_poison_data_count: 403
Global model norm: 44.734325881915055.
Norm before scaling: 44.69161093416331. Distance: 1.1714333274126703
Total norm for 4 adversaries is: 44.69161093416331. distance: 1.1714333274126703
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0638, Accuracy: 9736/9900 (98.3434%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5401/5503 (98.1465%), train_poison_data_count: 430
Global model norm: 44.734325881915055.
Norm before scaling: 44.68864317812259. Distance: 1.175571207441282
Total norm for 4 adversaries is: 44.68864317812259. distance: 1.175571207441282
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0546, Accuracy: 9770/9900 (98.6869%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3691/3995 (92.3905%)
___Train Local_ResNet_18,  epoch 184, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3580/3995 (89.6120%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3775, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 6409/6812 (94.0840%)
___Train Local_ResNet_18,  epoch 184, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 6292/6812 (92.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0527, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3933/4130 (95.2300%)
___Train Local_ResNet_18,  epoch 184, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3883/4130 (94.0194%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9496, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4412/4737 (93.1391%)
___Train Local_ResNet_18,  epoch 184, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4341/4737 (91.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2853, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5316/5696 (93.3287%)
___Train Local_ResNet_18,  epoch 184, local model 22, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5190/5696 (91.1166%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9917, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4699/5055 (92.9575%)
___Train Local_ResNet_18,  epoch 184, local model 93, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4539/5055 (89.7923%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2929, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4190/4368 (95.9249%)
___Train Local_ResNet_18,  epoch 184, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4143/4368 (94.8489%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0275, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5230/5652 (92.5336%)
___Train Local_ResNet_18,  epoch 184, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5008/5652 (88.6058%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3106, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3922/4175 (93.9401%)
___Train Local_ResNet_18,  epoch 184, local model 39, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3862/4175 (92.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9635, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5027/5298 (94.8849%)
___Train Local_ResNet_18,  epoch 184, local model 82, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4894/5298 (92.3745%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2504, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5272/5615 (93.8914%)
___Train Local_ResNet_18,  epoch 184, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5126/5615 (91.2912%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2976, Accuracy: 5242/10000 (52.4200%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4825/5224 (92.3622%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4831/5224 (92.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2681, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5714/6235 (91.6439%)
___Train Local_ResNet_18,  epoch 184, local model 38, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5468/6235 (87.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3026, Accuracy: 5075/10000 (50.7500%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4210/4485 (93.8685%)
___Train Local_ResNet_18,  epoch 184, local model 61, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3752/4485 (83.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4175, Accuracy: 4880/10000 (48.8000%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5460/6080 (89.8026%)
___Train Local_ResNet_18,  epoch 184, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5274/6080 (86.7434%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4029, Accuracy: 4943/10000 (49.4300%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3901/4108 (94.9611%)
___Train Local_ResNet_18,  epoch 184, local model 51, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3776/4108 (91.9182%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0954, Accuracy: 5475/10000 (54.7500%)
time spent on training: 251.3545527458191
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.4844, Accuracy: 6394/10000 (63.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0243, Accuracy: 9835/9900 (99.3434%)
Done in 278.02604508399963 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 8, 12, 68, 28, 34, 90, 64, 6, 54, 43, 77, 76, 83, 84, 52, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5208/5308 (98.1161%), train_poison_data_count: 415
Global model norm: 44.75296914250844.
Norm before scaling: 44.70663106663401. Distance: 1.1108310975788929
Total norm for 4 adversaries is: 44.70663106663401. distance: 1.1108310975788929
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0509, Accuracy: 9772/9900 (98.7071%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5660/5777 (97.9747%), train_poison_data_count: 455
Global model norm: 44.75296914250844.
Norm before scaling: 44.70439338684664. Distance: 1.2308953892830272
Total norm for 4 adversaries is: 44.70439338684664. distance: 1.2308953892830272
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0339, Accuracy: 9815/9900 (99.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4994/5123 (97.4819%), train_poison_data_count: 403
Global model norm: 44.75296914250844.
Norm before scaling: 44.711237139700124. Distance: 1.2115198519375545
Total norm for 4 adversaries is: 44.711237139700124. distance: 1.2115198519375545
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0473, Accuracy: 9769/9900 (98.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5366/5503 (97.5104%), train_poison_data_count: 430
Global model norm: 44.75296914250844.
Norm before scaling: 44.70983243326838. Distance: 1.2807363085129426
Total norm for 4 adversaries is: 44.70983243326838. distance: 1.2807363085129426
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0539, Accuracy: 9754/9900 (98.5253%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4575/4889 (93.5774%)
___Train Local_ResNet_18,  epoch 185, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4471/4889 (91.4502%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0347, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5118/5526 (92.6167%)
___Train Local_ResNet_18,  epoch 185, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4931/5526 (89.2327%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4297, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3395/3589 (94.5946%)
___Train Local_ResNet_18,  epoch 185, local model 68, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3589 (92.4770%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9990, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4664/5122 (91.0582%)
___Train Local_ResNet_18,  epoch 185, local model 28, internal_epoch   2,  Average loss: 0.0124, Accuracy: 3954/5122 (77.1964%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.5745, Accuracy: 4685/10000 (46.8500%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4586/4911 (93.3822%)
___Train Local_ResNet_18,  epoch 185, local model 34, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4569/4911 (93.0360%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1088, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4521/4748 (95.2190%)
___Train Local_ResNet_18,  epoch 185, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4407/4748 (92.8180%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1029, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4528/4894 (92.5215%)
___Train Local_ResNet_18,  epoch 185, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4405/4894 (90.0082%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2268, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4696/4929 (95.2729%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4554/4929 (92.3920%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9319, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5182/5645 (91.7981%)
___Train Local_ResNet_18,  epoch 185, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5024/5645 (88.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.3452, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4641/4979 (93.2115%)
___Train Local_ResNet_18,  epoch 185, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4591/4979 (92.2073%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1667, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4676/5050 (92.5941%)
___Train Local_ResNet_18,  epoch 185, local model 77, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4515/5050 (89.4059%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1874, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3688/3959 (93.1548%)
___Train Local_ResNet_18,  epoch 185, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3644/3959 (92.0434%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9379, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3322/3552 (93.5248%)
___Train Local_ResNet_18,  epoch 185, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3341/3552 (94.0597%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0135, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4819/5209 (92.5130%)
___Train Local_ResNet_18,  epoch 185, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4684/5209 (89.9213%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1254, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3916/4130 (94.8184%)
___Train Local_ResNet_18,  epoch 185, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3786/4130 (91.6707%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0037, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3876/4086 (94.8605%)
___Train Local_ResNet_18,  epoch 185, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3818/4086 (93.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0676, Accuracy: 5513/10000 (55.1300%)
time spent on training: 247.06569838523865
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.4878, Accuracy: 6384/10000 (63.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0234, Accuracy: 9837/9900 (99.3636%)
Done in 273.6018052101135 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 90, 6, 39, 89, 88, 7, 3, 94, 74, 66, 25, 96, 31, 98, 78, 34].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5221/5308 (98.3610%), train_poison_data_count: 415
Global model norm: 44.769946889975756.
Norm before scaling: 44.72550148850695. Distance: 1.147846043670665
Total norm for 4 adversaries is: 44.72550148850695. distance: 1.147846043670665
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0221, Accuracy: 9844/9900 (99.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5674/5777 (98.2171%), train_poison_data_count: 455
Global model norm: 44.769946889975756.
Norm before scaling: 44.71809622381986. Distance: 1.166840125994578
Total norm for 4 adversaries is: 44.71809622381986. distance: 1.166840125994578
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0179, Accuracy: 9853/9900 (99.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5020/5123 (97.9895%), train_poison_data_count: 403
Global model norm: 44.769946889975756.
Norm before scaling: 44.72418320636569. Distance: 1.1216958585646528
Total norm for 4 adversaries is: 44.72418320636569. distance: 1.1216958585646528
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.1025, Accuracy: 9632/9900 (97.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5403/5503 (98.1828%), train_poison_data_count: 430
Global model norm: 44.769946889975756.
Norm before scaling: 44.72383793557413. Distance: 1.1636566888459197
Total norm for 4 adversaries is: 44.72383793557413. distance: 1.1636566888459197
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0461, Accuracy: 9784/9900 (98.8283%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4537/4748 (95.5560%)
___Train Local_ResNet_18,  epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4420/4748 (93.0918%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9535, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4662/4929 (94.5831%)
___Train Local_ResNet_18,  epoch 186, local model 6, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4481/4929 (90.9109%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1657, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3908/4175 (93.6048%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3900/4175 (93.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8727, Accuracy: 5769/10000 (57.6900%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4435/4737 (93.6247%)
___Train Local_ResNet_18,  epoch 186, local model 89, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4291/4737 (90.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4913, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5021/5362 (93.6404%)
___Train Local_ResNet_18,  epoch 186, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4906/5362 (91.4957%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1685, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4504/4869 (92.5036%)
___Train Local_ResNet_18,  epoch 186, local model 7, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3879/4869 (79.6673%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.5665, Accuracy: 4827/10000 (48.2700%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5066/5346 (94.7624%)
___Train Local_ResNet_18,  epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4958/5346 (92.7422%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0603, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4803/5224 (91.9410%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4759/5224 (91.0988%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1099, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4462/4797 (93.0165%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4347/4797 (90.6191%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0638, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4536/4843 (93.6610%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4461/4843 (92.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0766, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5799/6419 (90.3412%)
___Train Local_ResNet_18,  epoch 186, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5448/6419 (84.8730%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4954, Accuracy: 4843/10000 (48.4300%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4755/5086 (93.4919%)
___Train Local_ResNet_18,  epoch 186, local model 96, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4643/5086 (91.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0026, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4274/4537 (94.2032%)
___Train Local_ResNet_18,  epoch 186, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4205/4537 (92.6824%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8547, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3978/4161 (95.6020%)
___Train Local_ResNet_18,  epoch 186, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3865/4161 (92.8863%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9178, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4154/4368 (95.1007%)
___Train Local_ResNet_18,  epoch 186, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4120/4368 (94.3223%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0338, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4633/4911 (94.3392%)
___Train Local_ResNet_18,  epoch 186, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4550/4911 (92.6492%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2217, Accuracy: 5238/10000 (52.3800%)
time spent on training: 248.34570717811584
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5024, Accuracy: 6368/10000 (63.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0221, Accuracy: 9843/9900 (99.4242%)
Done in 274.7612729072571 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 44, 82, 1, 10, 89, 11, 87, 28, 22, 78, 31, 79, 27, 46, 35, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5209/5308 (98.1349%), train_poison_data_count: 415
Global model norm: 44.78775903497517.
Norm before scaling: 44.743274034083186. Distance: 1.1712649474111299
Total norm for 4 adversaries is: 44.743274034083186. distance: 1.1712649474111299
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0354, Accuracy: 9807/9900 (99.0606%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5682/5777 (98.3555%), train_poison_data_count: 455
Global model norm: 44.78775903497517.
Norm before scaling: 44.73731107200258. Distance: 1.1915561269073969
Total norm for 4 adversaries is: 44.73731107200258. distance: 1.1915561269073969
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0547, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4986/5123 (97.3258%), train_poison_data_count: 403
Global model norm: 44.78775903497517.
Norm before scaling: 44.74602537778495. Distance: 1.227901286941551
Total norm for 4 adversaries is: 44.74602537778495. distance: 1.227901286941551
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0308, Accuracy: 9820/9900 (99.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.78775903497517.
Norm before scaling: 44.74247192484243. Distance: 1.1863646349974135
Total norm for 4 adversaries is: 44.74247192484243. distance: 1.1863646349974135
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0638, Accuracy: 9738/9900 (98.3636%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4804/5075 (94.6601%)
___Train Local_ResNet_18,  epoch 187, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4736/5075 (93.3202%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1508, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5034/5298 (95.0170%)
___Train Local_ResNet_18,  epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0031, Accuracy: 5002/5298 (94.4130%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1491, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5185/5422 (95.6289%)
___Train Local_ResNet_18,  epoch 187, local model 1, internal_epoch   2,  Average loss: 0.0034, Accuracy: 5068/5422 (93.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0203, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4836/5068 (95.4223%)
___Train Local_ResNet_18,  epoch 187, local model 10, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4597/5068 (90.7064%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2987, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4442/4737 (93.7724%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4319/4737 (91.1758%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0352, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5068/5702 (88.8811%)
___Train Local_ResNet_18,  epoch 187, local model 11, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4432/5702 (77.7271%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3452, Accuracy: 4962/10000 (49.6200%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3712/3995 (92.9161%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3589/3995 (89.8373%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3119, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4638/5122 (90.5506%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0127, Accuracy: 3925/5122 (76.6302%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.6268, Accuracy: 4439/10000 (44.3900%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5322/5696 (93.4340%)
___Train Local_ResNet_18,  epoch 187, local model 22, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5211/5696 (91.4853%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.1360, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4181/4368 (95.7189%)
___Train Local_ResNet_18,  epoch 187, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4072/4368 (93.2234%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0839, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4288/4537 (94.5118%)
___Train Local_ResNet_18,  epoch 187, local model 31, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4274/4537 (94.2032%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9767, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3860/4111 (93.8944%)
___Train Local_ResNet_18,  epoch 187, local model 79, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3786/4111 (92.0944%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9565, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4285/4587 (93.4162%)
___Train Local_ResNet_18,  epoch 187, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4238/4587 (92.3915%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9918, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4855/5399 (89.9241%)
___Train Local_ResNet_18,  epoch 187, local model 46, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4685/5399 (86.7753%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3470, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5253/5615 (93.5530%)
___Train Local_ResNet_18,  epoch 187, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5148/5615 (91.6830%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2619, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4436/4714 (94.1027%)
___Train Local_ResNet_18,  epoch 187, local model 41, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4409/4714 (93.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9886, Accuracy: 5624/10000 (56.2400%)
time spent on training: 249.99296259880066
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5087, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0219, Accuracy: 9841/9900 (99.4040%)
Done in 276.69883394241333 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 50, 45, 74, 0, 54, 55, 59, 96, 81, 75, 98, 14, 62, 25, 73, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5225/5308 (98.4363%), train_poison_data_count: 415
Global model norm: 44.805769794033644.
Norm before scaling: 44.75914820074495. Distance: 1.1148874575007364
Total norm for 4 adversaries is: 44.75914820074495. distance: 1.1148874575007364
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0445, Accuracy: 9781/9900 (98.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5643/5777 (97.6805%), train_poison_data_count: 455
Global model norm: 44.805769794033644.
Norm before scaling: 44.75947956290586. Distance: 1.324071105107968
Total norm for 4 adversaries is: 44.75947956290586. distance: 1.324071105107968
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0500, Accuracy: 9760/9900 (98.5859%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5012/5123 (97.8333%), train_poison_data_count: 403
Global model norm: 44.805769794033644.
Norm before scaling: 44.76235808323636. Distance: 1.1820472711156853
Total norm for 4 adversaries is: 44.76235808323636. distance: 1.1820472711156853
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0579, Accuracy: 9746/9900 (98.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5396/5503 (98.0556%), train_poison_data_count: 430
Global model norm: 44.805769794033644.
Norm before scaling: 44.76019000601986. Distance: 1.2113570932260065
Total norm for 4 adversaries is: 44.76019000601986. distance: 1.2113570932260065
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0163, Accuracy: 9860/9900 (99.5960%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4484/4757 (94.2611%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4382/4757 (92.1169%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0457, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5093/5489 (92.7856%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5004/5489 (91.1641%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2973, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4504/4797 (93.8920%)
___Train Local_ResNet_18,  epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4445/4797 (92.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1162, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5081/5454 (93.1610%)
___Train Local_ResNet_18,  epoch 188, local model 0, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4831/5454 (88.5772%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2363, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5157/5645 (91.3552%)
___Train Local_ResNet_18,  epoch 188, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4920/5645 (87.1568%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1856, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4494/4731 (94.9905%)
___Train Local_ResNet_18,  epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4433/4731 (93.7011%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9749, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4202/4397 (95.5652%)
___Train Local_ResNet_18,  epoch 188, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4213/4397 (95.8153%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8230, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4775/5086 (93.8852%)
___Train Local_ResNet_18,  epoch 188, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4714/5086 (92.6858%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0480, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4741/5035 (94.1609%)
___Train Local_ResNet_18,  epoch 188, local model 81, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4673/5035 (92.8103%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0620, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4443/4672 (95.0985%)
___Train Local_ResNet_18,  epoch 188, local model 75, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4398/4672 (94.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9038, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3962/4161 (95.2175%)
___Train Local_ResNet_18,  epoch 188, local model 98, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3826/4161 (91.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2899, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4046/4196 (96.4252%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3998/4196 (95.2812%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8460, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4965/5504 (90.2071%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4761/5504 (86.5007%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.4549, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5836/6419 (90.9176%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0074, Accuracy: 5452/6419 (84.9353%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.5638, Accuracy: 4848/10000 (48.4800%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4357/4605 (94.6145%)
___Train Local_ResNet_18,  epoch 188, local model 73, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4352/4605 (94.5060%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0737, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4537/4732 (95.8791%)
___Train Local_ResNet_18,  epoch 188, local model 29, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4508/4732 (95.2663%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.7853, Accuracy: 5884/10000 (58.8400%)
time spent on training: 250.88957381248474
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5059, Accuracy: 6349/10000 (63.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0213, Accuracy: 9846/9900 (99.4545%)
Done in 277.3106470108032 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 1, 41, 43, 84, 99, 94, 23, 2, 40, 82, 59, 28, 14, 56, 63, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5223/5308 (98.3986%), train_poison_data_count: 415
Global model norm: 44.82195408903292.
Norm before scaling: 44.7752852796607. Distance: 1.0996602725891205
Total norm for 4 adversaries is: 44.7752852796607. distance: 1.0996602725891205
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0368, Accuracy: 9793/9900 (98.9192%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5669/5777 (98.1305%), train_poison_data_count: 455
Global model norm: 44.82195408903292.
Norm before scaling: 44.77032179767293. Distance: 1.1653291608090486
Total norm for 4 adversaries is: 44.77032179767293. distance: 1.1653291608090486
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0302, Accuracy: 9830/9900 (99.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5001/5123 (97.6186%), train_poison_data_count: 403
Global model norm: 44.82195408903292.
Norm before scaling: 44.77808781577771. Distance: 1.1946616800777496
Total norm for 4 adversaries is: 44.77808781577771. distance: 1.1946616800777496
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0440, Accuracy: 9781/9900 (98.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5380/5503 (97.7649%), train_poison_data_count: 430
Global model norm: 44.82195408903292.
Norm before scaling: 44.77744444751174. Distance: 1.2402633062878021
Total norm for 4 adversaries is: 44.77744444751174. distance: 1.2402633062878021
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0424, Accuracy: 9794/9900 (98.9293%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5162/5422 (95.2047%)
___Train Local_ResNet_18,  epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5053/5422 (93.1944%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9606, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4474/4714 (94.9088%)
___Train Local_ResNet_18,  epoch 189, local model 41, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4444/4714 (94.2724%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0745, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4709/4979 (94.5772%)
___Train Local_ResNet_18,  epoch 189, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4581/4979 (92.0064%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1873, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4814/5209 (92.4170%)
___Train Local_ResNet_18,  epoch 189, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4707/5209 (90.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0720, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4449/4851 (91.7130%)
___Train Local_ResNet_18,  epoch 189, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4404/4851 (90.7854%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0476, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4868/5224 (93.1853%)
___Train Local_ResNet_18,  epoch 189, local model 94, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4690/5224 (89.7779%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1823, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4306/4549 (94.6582%)
___Train Local_ResNet_18,  epoch 189, local model 23, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3978/4549 (87.4478%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2263, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3809/3968 (95.9929%)
___Train Local_ResNet_18,  epoch 189, local model 2, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3757/3968 (94.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7890, Accuracy: 5967/10000 (59.6700%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5542/5939 (93.3154%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5438/5939 (91.5642%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3663, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4978/5298 (93.9600%)
___Train Local_ResNet_18,  epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4942/5298 (93.2805%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0239, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4193/4397 (95.3605%)
___Train Local_ResNet_18,  epoch 189, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4199/4397 (95.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8805, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4668/5122 (91.1363%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0117, Accuracy: 4025/5122 (78.5826%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.5727, Accuracy: 4583/10000 (45.8300%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4050/4196 (96.5205%)
___Train Local_ResNet_18,  epoch 189, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3988/4196 (95.0429%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.8907, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4993/5427 (92.0029%)
___Train Local_ResNet_18,  epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4821/5427 (88.8336%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1274, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3726/3910 (95.2941%)
___Train Local_ResNet_18,  epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3266/3910 (83.5294%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.5708, Accuracy: 4833/10000 (48.3300%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3904/4086 (95.5458%)
___Train Local_ResNet_18,  epoch 189, local model 26, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3875/4086 (94.8360%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0688, Accuracy: 5650/10000 (56.5000%)
time spent on training: 249.41291117668152
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5106, Accuracy: 6335/10000 (63.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0213, Accuracy: 9843/9900 (99.4242%)
Done in 275.9355492591858 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 27, 20, 75, 69, 86, 64, 19, 23, 31, 10, 76, 80, 97, 26, 52, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5232/5308 (98.5682%), train_poison_data_count: 415
Global model norm: 44.839033669668744.
Norm before scaling: 44.790797896129014. Distance: 1.0693887775900297
Total norm for 4 adversaries is: 44.790797896129014. distance: 1.0693887775900297
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0157, Accuracy: 9857/9900 (99.5657%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5671/5777 (98.1651%), train_poison_data_count: 455
Global model norm: 44.839033669668744.
Norm before scaling: 44.78889147773907. Distance: 1.1960459434877118
Total norm for 4 adversaries is: 44.78889147773907. distance: 1.1960459434877118
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0221, Accuracy: 9849/9900 (99.4848%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 44.839033669668744.
Norm before scaling: 44.796466252059155. Distance: 1.2136965422246087
Total norm for 4 adversaries is: 44.796466252059155. distance: 1.2136965422246087
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0200, Accuracy: 9837/9900 (99.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5388/5503 (97.9102%), train_poison_data_count: 430
Global model norm: 44.839033669668744.
Norm before scaling: 44.794271211823926. Distance: 1.243996843925839
Total norm for 4 adversaries is: 44.794271211823926. distance: 1.243996843925839
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0285, Accuracy: 9830/9900 (99.2929%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4299/4587 (93.7214%)
___Train Local_ResNet_18,  epoch 190, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4235/4587 (92.3261%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0151, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4471/4714 (94.8451%)
___Train Local_ResNet_18,  epoch 190, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4457/4714 (94.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8255, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4422/4672 (94.6490%)
___Train Local_ResNet_18,  epoch 190, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4367/4672 (93.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9705, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4070/4364 (93.2631%)
___Train Local_ResNet_18,  epoch 190, local model 69, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3876/4364 (88.8176%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1909, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3670/3929 (93.4080%)
___Train Local_ResNet_18,  epoch 190, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3619/3929 (92.1100%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9504, Accuracy: 5729/10000 (57.2900%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4522/4894 (92.3989%)
___Train Local_ResNet_18,  epoch 190, local model 64, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4300/4894 (87.8627%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.2078, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4942/5361 (92.1843%)
___Train Local_ResNet_18,  epoch 190, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4800/5361 (89.5355%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1753, Accuracy: 5319/10000 (53.1900%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4332/4549 (95.2297%)
___Train Local_ResNet_18,  epoch 190, local model 23, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3794/4549 (83.4029%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3798, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4263/4537 (93.9608%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4211/4537 (92.8146%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9282, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4862/5068 (95.9353%)
___Train Local_ResNet_18,  epoch 190, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4757/5068 (93.8635%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0605, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3648/3959 (92.1445%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3581/3959 (90.4521%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1620, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5091/5461 (93.2247%)
___Train Local_ResNet_18,  epoch 190, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4926/5461 (90.2033%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.5442, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4385/4736 (92.5887%)
___Train Local_ResNet_18,  epoch 190, local model 97, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4306/4736 (90.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1963, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3872/4086 (94.7626%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3864/4086 (94.5668%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0786, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3874/4130 (93.8015%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3868/4130 (93.6562%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9400, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4183/4368 (95.7647%)
___Train Local_ResNet_18,  epoch 190, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4154/4368 (95.1007%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8424, Accuracy: 5907/10000 (59.0700%)
time spent on training: 256.32445192337036
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5205, Accuracy: 6328/10000 (63.2800%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0197, Accuracy: 9851/9900 (99.5051%)
Done in 282.8086757659912 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 46, 98, 55, 51, 80, 4, 97, 11, 35, 61, 86, 6, 83, 73, 84, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5220/5308 (98.3421%), train_poison_data_count: 415
Global model norm: 44.85553117239626.
Norm before scaling: 44.80944762747793. Distance: 1.1361803700312392
Total norm for 4 adversaries is: 44.80944762747793. distance: 1.1361803700312392
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0264, Accuracy: 9838/9900 (99.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 44.85553117239626.
Norm before scaling: 44.805167690321305. Distance: 1.2025066619815399
Total norm for 4 adversaries is: 44.805167690321305. distance: 1.2025066619815399
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0395, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5008/5123 (97.7552%), train_poison_data_count: 403
Global model norm: 44.85553117239626.
Norm before scaling: 44.81147030720762. Distance: 1.1645298474107733
Total norm for 4 adversaries is: 44.81147030720762. distance: 1.1645298474107733
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0571, Accuracy: 9744/9900 (98.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5413/5503 (98.3645%), train_poison_data_count: 430
Global model norm: 44.85553117239626.
Norm before scaling: 44.807262758379224. Distance: 1.124203558972271
Total norm for 4 adversaries is: 44.807262758379224. distance: 1.124203558972271
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0609, Accuracy: 9733/9900 (98.3131%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4912/5399 (90.9798%)
___Train Local_ResNet_18,  epoch 191, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4728/5399 (87.5718%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2098, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3964/4161 (95.2656%)
___Train Local_ResNet_18,  epoch 191, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3874/4161 (93.1026%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1274, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4502/4731 (95.1596%)
___Train Local_ResNet_18,  epoch 191, local model 55, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4439/4731 (93.8279%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9093, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3894/4108 (94.7907%)
___Train Local_ResNet_18,  epoch 191, local model 51, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3844/4108 (93.5735%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9004, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5042/5461 (92.3274%)
___Train Local_ResNet_18,  epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4922/5461 (90.1300%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2006, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3798/4028 (94.2900%)
___Train Local_ResNet_18,  epoch 191, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3750/4028 (93.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9669, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4405/4736 (93.0110%)
___Train Local_ResNet_18,  epoch 191, local model 97, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4349/4736 (91.8285%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9637, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5102/5702 (89.4774%)
___Train Local_ResNet_18,  epoch 191, local model 11, internal_epoch   2,  Average loss: 0.0114, Accuracy: 4496/5702 (78.8495%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4394, Accuracy: 4563/10000 (45.6300%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5256/5615 (93.6064%)
___Train Local_ResNet_18,  epoch 191, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5136/5615 (91.4693%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.5225, Accuracy: 5042/10000 (50.4200%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4190/4485 (93.4225%)
___Train Local_ResNet_18,  epoch 191, local model 61, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4102/4485 (91.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1002, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3627/3929 (92.3136%)
___Train Local_ResNet_18,  epoch 191, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3546/3929 (90.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9261, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4685/4929 (95.0497%)
___Train Local_ResNet_18,  epoch 191, local model 6, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4578/4929 (92.8789%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1107, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3317/3552 (93.3840%)
___Train Local_ResNet_18,  epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3354/3552 (94.4257%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8182, Accuracy: 5893/10000 (58.9300%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4412/4605 (95.8089%)
___Train Local_ResNet_18,  epoch 191, local model 73, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4356/4605 (94.5928%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9861, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4857/5209 (93.2425%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4667/5209 (89.5949%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0908, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4468/4869 (91.7642%)
___Train Local_ResNet_18,  epoch 191, local model 7, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3913/4869 (80.3656%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.4739, Accuracy: 4816/10000 (48.1600%)
time spent on training: 270.5306122303009
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5188, Accuracy: 6324/10000 (63.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0196, Accuracy: 9849/9900 (99.4848%)
Done in 297.018506526947 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 14, 5, 1, 61, 91, 75, 59, 44, 12, 38, 53, 74, 20, 89, 0, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5232/5308 (98.5682%), train_poison_data_count: 415
Global model norm: 44.87198588415159.
Norm before scaling: 44.82640943040023. Distance: 1.1414217321872002
Total norm for 4 adversaries is: 44.82640943040023. distance: 1.1414217321872002
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0362, Accuracy: 9805/9900 (99.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5681/5777 (98.3382%), train_poison_data_count: 455
Global model norm: 44.87198588415159.
Norm before scaling: 44.819290476625405. Distance: 1.1759963741765602
Total norm for 4 adversaries is: 44.819290476625405. distance: 1.1759963741765602
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0066, Accuracy: 9884/9900 (99.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5010/5123 (97.7943%), train_poison_data_count: 403
Global model norm: 44.87198588415159.
Norm before scaling: 44.828612427639335. Distance: 1.21934167242527
Total norm for 4 adversaries is: 44.828612427639335. distance: 1.21934167242527
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0550, Accuracy: 9760/9900 (98.5859%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5396/5503 (98.0556%), train_poison_data_count: 430
Global model norm: 44.87198588415159.
Norm before scaling: 44.82500152502786. Distance: 1.1759569917554107
Total norm for 4 adversaries is: 44.82500152502786. distance: 1.1759569917554107
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0261, Accuracy: 9841/9900 (99.4040%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4009/4196 (95.5434%)
___Train Local_ResNet_18,  epoch 192, local model 14, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3953/4196 (94.2088%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8841, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4733/4993 (94.7927%)
___Train Local_ResNet_18,  epoch 192, local model 5, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4634/4993 (92.8099%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0593, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5182/5422 (95.5736%)
___Train Local_ResNet_18,  epoch 192, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5003/5422 (92.2722%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9976, Accuracy: 5727/10000 (57.2700%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4212/4485 (93.9130%)
___Train Local_ResNet_18,  epoch 192, local model 61, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3776/4485 (84.1918%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2883, Accuracy: 5049/10000 (50.4900%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4186/4527 (92.4674%)
___Train Local_ResNet_18,  epoch 192, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4054/4527 (89.5516%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3474, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4429/4672 (94.7988%)
___Train Local_ResNet_18,  epoch 192, local model 75, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4338/4672 (92.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9932, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4232/4397 (96.2474%)
___Train Local_ResNet_18,  epoch 192, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4192/4397 (95.3377%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8012, Accuracy: 5902/10000 (59.0200%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4817/5075 (94.9163%)
___Train Local_ResNet_18,  epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4651/5075 (91.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0305, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5135/5526 (92.9244%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4924/5526 (89.1060%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.3179, Accuracy: 5102/10000 (51.0200%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5669/6235 (90.9222%)
___Train Local_ResNet_18,  epoch 192, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5487/6235 (88.0032%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2853, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 6011/6664 (90.2011%)
___Train Local_ResNet_18,  epoch 192, local model 53, internal_epoch   2,  Average loss: 0.0089, Accuracy: 5504/6664 (82.5930%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4633, Accuracy: 4856/10000 (48.5600%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4473/4797 (93.2458%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4350/4797 (90.6817%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2574, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4536/4714 (96.2240%)
___Train Local_ResNet_18,  epoch 192, local model 20, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4498/4714 (95.4179%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8776, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4445/4737 (93.8358%)
___Train Local_ResNet_18,  epoch 192, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4368/4737 (92.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1958, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5069/5454 (92.9410%)
___Train Local_ResNet_18,  epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4899/5454 (89.8240%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1375, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4510/4869 (92.6268%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4136/4869 (84.9456%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4558, Accuracy: 4934/10000 (49.3400%)
time spent on training: 274.4323019981384
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5347, Accuracy: 6294/10000 (62.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0187, Accuracy: 9854/9900 (99.5354%)
Done in 300.7584342956543 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 17, 26, 15, 18, 38, 29, 82, 21, 84, 80, 85, 11, 12, 88, 89, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5201/5308 (97.9842%), train_poison_data_count: 415
Global model norm: 44.89008793839891.
Norm before scaling: 44.84381124778047. Distance: 1.15186793962158
Total norm for 4 adversaries is: 44.84381124778047. distance: 1.15186793962158
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0657, Accuracy: 9722/9900 (98.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5673/5777 (98.1998%), train_poison_data_count: 455
Global model norm: 44.89008793839891.
Norm before scaling: 44.83903230846285. Distance: 1.216717810840472
Total norm for 4 adversaries is: 44.83903230846285. distance: 1.216717810840472
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0359, Accuracy: 9816/9900 (99.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5022/5123 (98.0285%), train_poison_data_count: 403
Global model norm: 44.89008793839891.
Norm before scaling: 44.844917776606806. Distance: 1.1485984845116401
Total norm for 4 adversaries is: 44.844917776606806. distance: 1.1485984845116401
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0303, Accuracy: 9816/9900 (99.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 44.89008793839891.
Norm before scaling: 44.8435812279054. Distance: 1.20282201543678
Total norm for 4 adversaries is: 44.8435812279054. distance: 1.20282201543678
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0319, Accuracy: 9821/9900 (99.2020%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4516/4903 (92.1069%)
___Train Local_ResNet_18,  epoch 193, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4442/4903 (90.5976%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1094, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3929/4086 (96.1576%)
___Train Local_ResNet_18,  epoch 193, local model 26, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3903/4086 (95.5213%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8778, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5662/6068 (93.3092%)
___Train Local_ResNet_18,  epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5581/6068 (91.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3022, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4003/4249 (94.2104%)
___Train Local_ResNet_18,  epoch 193, local model 18, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3979/4249 (93.6456%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8777, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5698/6235 (91.3873%)
___Train Local_ResNet_18,  epoch 193, local model 38, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5538/6235 (88.8212%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.6911, Accuracy: 4821/10000 (48.2100%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4464/4732 (94.3364%)
___Train Local_ResNet_18,  epoch 193, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4428/4732 (93.5757%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8949, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5038/5298 (95.0925%)
___Train Local_ResNet_18,  epoch 193, local model 82, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4923/5298 (92.9219%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0988, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4692/5038 (93.1322%)
___Train Local_ResNet_18,  epoch 193, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4624/5038 (91.7825%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9415, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4852/5209 (93.1465%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4689/5209 (90.0173%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1681, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5136/5461 (94.0487%)
___Train Local_ResNet_18,  epoch 193, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5026/5461 (92.0344%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2167, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6345/6947 (91.3344%)
___Train Local_ResNet_18,  epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5987/6947 (86.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3076, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5129/5702 (89.9509%)
___Train Local_ResNet_18,  epoch 193, local model 11, internal_epoch   2,  Average loss: 0.0115, Accuracy: 4452/5702 (78.0779%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.3945, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5103/5526 (92.3453%)
___Train Local_ResNet_18,  epoch 193, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4886/5526 (88.4184%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.2050, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5004/5362 (93.3234%)
___Train Local_ResNet_18,  epoch 193, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4857/5362 (90.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1989, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4360/4737 (92.0414%)
___Train Local_ResNet_18,  epoch 193, local model 89, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4313/4737 (91.0492%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.5379, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5265/5727 (91.9329%)
___Train Local_ResNet_18,  epoch 193, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5052/5727 (88.2137%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1102, Accuracy: 5359/10000 (53.5900%)
time spent on training: 255.51258945465088
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5477, Accuracy: 6288/10000 (62.8800%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0167, Accuracy: 9857/9900 (99.5657%)
Done in 283.05671668052673 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 7, 34, 31, 64, 77, 29, 99, 0, 33, 46, 72, 22, 88, 80, 11, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5235/5308 (98.6247%), train_poison_data_count: 415
Global model norm: 44.90940723721966.
Norm before scaling: 44.86158998363049. Distance: 1.072108022645463
Total norm for 4 adversaries is: 44.86158998363049. distance: 1.072108022645463
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0702, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5682/5777 (98.3555%), train_poison_data_count: 455
Global model norm: 44.90940723721966.
Norm before scaling: 44.857573544462646. Distance: 1.15969269093714
Total norm for 4 adversaries is: 44.857573544462646. distance: 1.15969269093714
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0490, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4976/5123 (97.1306%), train_poison_data_count: 403
Global model norm: 44.90940723721966.
Norm before scaling: 44.86933476382771. Distance: 1.2813549463974556
Total norm for 4 adversaries is: 44.86933476382771. distance: 1.2813549463974556
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.1601, Accuracy: 9454/9900 (95.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5396/5503 (98.0556%), train_poison_data_count: 430
Global model norm: 44.90940723721966.
Norm before scaling: 44.8619981382141. Distance: 1.1879271190874323
Total norm for 4 adversaries is: 44.8619981382141. distance: 1.1879271190874323
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0166, Accuracy: 9860/9900 (99.5960%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4546/4869 (93.3662%)
___Train Local_ResNet_18,  epoch 194, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4315/4869 (88.6219%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.6064, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4599/4911 (93.6469%)
___Train Local_ResNet_18,  epoch 194, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4589/4911 (93.4433%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9961, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4275/4537 (94.2253%)
___Train Local_ResNet_18,  epoch 194, local model 31, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4222/4537 (93.0571%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9788, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4531/4894 (92.5828%)
___Train Local_ResNet_18,  epoch 194, local model 64, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4372/4894 (89.3339%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.6817, Accuracy: 4858/10000 (48.5800%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4658/5050 (92.2376%)
___Train Local_ResNet_18,  epoch 194, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4569/5050 (90.4752%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1120, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4511/4732 (95.3297%)
___Train Local_ResNet_18,  epoch 194, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4510/4732 (95.3085%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8289, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4541/4851 (93.6096%)
___Train Local_ResNet_18,  epoch 194, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4453/4851 (91.7955%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8740, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5116/5454 (93.8027%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4944/5454 (90.6491%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1182, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4519/4818 (93.7941%)
___Train Local_ResNet_18,  epoch 194, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4332/4818 (89.9128%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0215, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4935/5399 (91.4058%)
___Train Local_ResNet_18,  epoch 194, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4742/5399 (87.8311%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3195, Accuracy: 5201/10000 (52.0100%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4821/5193 (92.8365%)
___Train Local_ResNet_18,  epoch 194, local model 72, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4569/5193 (87.9838%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.3613, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5368/5696 (94.2416%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5172/5696 (90.8006%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1458, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5024/5362 (93.6964%)
___Train Local_ResNet_18,  epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4902/5362 (91.4211%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1559, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5144/5461 (94.1952%)
___Train Local_ResNet_18,  epoch 194, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5006/5461 (91.6682%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2383, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5041/5702 (88.4076%)
___Train Local_ResNet_18,  epoch 194, local model 11, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4746/5702 (83.2340%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.4615, Accuracy: 5022/10000 (50.2200%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4606/4830 (95.3623%)
___Train Local_ResNet_18,  epoch 194, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4481/4830 (92.7743%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1618, Accuracy: 5509/10000 (55.0900%)
time spent on training: 251.6000566482544
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5640, Accuracy: 6256/10000 (62.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0179, Accuracy: 9855/9900 (99.5455%)
Done in 277.8939595222473 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 31, 7, 49, 8, 57, 89, 19, 42, 51, 98, 15, 35, 76, 48, 75, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5241/5308 (98.7378%), train_poison_data_count: 415
Global model norm: 44.92862720992875.
Norm before scaling: 44.87862319983201. Distance: 1.0558399262155957
Total norm for 4 adversaries is: 44.87862319983201. distance: 1.0558399262155957
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0365, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5670/5777 (98.1478%), train_poison_data_count: 455
Global model norm: 44.92862720992875.
Norm before scaling: 44.87532778649436. Distance: 1.1811494673480634
Total norm for 4 adversaries is: 44.87532778649436. distance: 1.1811494673480634
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0106, Accuracy: 9871/9900 (99.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4992/5123 (97.4429%), train_poison_data_count: 403
Global model norm: 44.92862720992875.
Norm before scaling: 44.88402753468515. Distance: 1.1739317583237063
Total norm for 4 adversaries is: 44.88402753468515. distance: 1.1739317583237063
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0248, Accuracy: 9830/9900 (99.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5408/5503 (98.2737%), train_poison_data_count: 430
Global model norm: 44.92862720992875.
Norm before scaling: 44.87996278485882. Distance: 1.1640400212312878
Total norm for 4 adversaries is: 44.87996278485882. distance: 1.1640400212312878
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0675, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4289/4537 (94.5338%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4231/4537 (93.2555%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9760, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4535/4869 (93.1403%)
___Train Local_ResNet_18,  epoch 195, local model 7, internal_epoch   2,  Average loss: 0.0093, Accuracy: 4018/4869 (82.5221%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.4595, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5148/5652 (91.0828%)
___Train Local_ResNet_18,  epoch 195, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5013/5652 (88.6943%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3274, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4580/4889 (93.6797%)
___Train Local_ResNet_18,  epoch 195, local model 8, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4528/4889 (92.6161%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0378, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4643/4956 (93.6844%)
___Train Local_ResNet_18,  epoch 195, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4538/4956 (91.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2737, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4384/4737 (92.5480%)
___Train Local_ResNet_18,  epoch 195, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4336/4737 (91.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3136, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4989/5361 (93.0610%)
___Train Local_ResNet_18,  epoch 195, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4777/5361 (89.1065%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3424, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5431/5907 (91.9418%)
___Train Local_ResNet_18,  epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5271/5907 (89.2331%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.7267, Accuracy: 4575/10000 (45.7500%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3899/4108 (94.9124%)
___Train Local_ResNet_18,  epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3825/4108 (93.1110%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0499, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3944/4161 (94.7849%)
___Train Local_ResNet_18,  epoch 195, local model 98, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3796/4161 (91.2281%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0634, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5674/6068 (93.5069%)
___Train Local_ResNet_18,  epoch 195, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5519/6068 (90.9525%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3560, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5251/5615 (93.5174%)
___Train Local_ResNet_18,  epoch 195, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5114/5615 (91.0775%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.3051, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3632/3959 (91.7403%)
___Train Local_ResNet_18,  epoch 195, local model 76, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3622/3959 (91.4877%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0237, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4609/4830 (95.4244%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4555/4830 (94.3064%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0621, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4455/4672 (95.3553%)
___Train Local_ResNet_18,  epoch 195, local model 75, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4421/4672 (94.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0003, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5168/5559 (92.9664%)
___Train Local_ResNet_18,  epoch 195, local model 67, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4780/5559 (85.9867%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2263, Accuracy: 5200/10000 (52.0000%)
time spent on training: 253.77729845046997
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5752, Accuracy: 6226/10000 (62.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0155, Accuracy: 9860/9900 (99.5960%)
Done in 280.09674429893494 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 21, 78, 19, 42, 25, 70, 73, 31, 96, 99, 88, 18, 0, 54, 32, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5229/5308 (98.5117%), train_poison_data_count: 415
Global model norm: 44.946669787649455.
Norm before scaling: 44.89760485677382. Distance: 1.0789612553722596
Total norm for 4 adversaries is: 44.89760485677382. distance: 1.0789612553722596
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0345, Accuracy: 9811/9900 (99.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5694/5777 (98.5633%), train_poison_data_count: 455
Global model norm: 44.946669787649455.
Norm before scaling: 44.893341481504805. Distance: 1.1330720801391647
Total norm for 4 adversaries is: 44.893341481504805. distance: 1.1330720801391647
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0151, Accuracy: 9864/9900 (99.6364%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4993/5123 (97.4624%), train_poison_data_count: 403
Global model norm: 44.946669787649455.
Norm before scaling: 44.90353973641026. Distance: 1.2137985885276263
Total norm for 4 adversaries is: 44.90353973641026. distance: 1.2137985885276263
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.1022, Accuracy: 9634/9900 (97.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5406/5503 (98.2373%), train_poison_data_count: 430
Global model norm: 44.946669787649455.
Norm before scaling: 44.89812143724668. Distance: 1.1596296251884677
Total norm for 4 adversaries is: 44.89812143724668. distance: 1.1596296251884677
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0374, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4686/5038 (93.0131%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4648/5038 (92.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9345, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4205/4368 (96.2683%)
___Train Local_ResNet_18,  epoch 196, local model 78, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4155/4368 (95.1236%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9900, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4915/5361 (91.6807%)
___Train Local_ResNet_18,  epoch 196, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4852/5361 (90.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1520, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5498/5907 (93.0760%)
___Train Local_ResNet_18,  epoch 196, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5423/5907 (91.8063%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.4152, Accuracy: 4908/10000 (49.0800%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5857/6419 (91.2447%)
___Train Local_ResNet_18,  epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5619/6419 (87.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.5440, Accuracy: 4966/10000 (49.6600%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5504/5871 (93.7489%)
___Train Local_ResNet_18,  epoch 196, local model 70, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5426/5871 (92.4204%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0869, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4426/4605 (96.1129%)
___Train Local_ResNet_18,  epoch 196, local model 73, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4358/4605 (94.6363%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0328, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4298/4537 (94.7322%)
___Train Local_ResNet_18,  epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4277/4537 (94.2693%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0117, Accuracy: 5701/10000 (57.0100%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4784/5086 (94.0621%)
___Train Local_ResNet_18,  epoch 196, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4691/5086 (92.2336%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0491, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4540/4851 (93.5890%)
___Train Local_ResNet_18,  epoch 196, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4477/4851 (92.2902%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0597, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5041/5362 (94.0134%)
___Train Local_ResNet_18,  epoch 196, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4909/5362 (91.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.2460, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4032/4249 (94.8929%)
___Train Local_ResNet_18,  epoch 196, local model 18, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3857/4249 (90.7743%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1027, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5096/5454 (93.4360%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4862/5454 (89.1456%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3695, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5200/5645 (92.1169%)
___Train Local_ResNet_18,  epoch 196, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4916/5645 (87.0859%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1265, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5494/6080 (90.3618%)
___Train Local_ResNet_18,  epoch 196, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5304/6080 (87.2368%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3335, Accuracy: 4998/10000 (49.9800%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5118/5489 (93.2410%)
___Train Local_ResNet_18,  epoch 196, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5024/5489 (91.5285%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1848, Accuracy: 5328/10000 (53.2800%)
time spent on training: 254.29808282852173
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5806, Accuracy: 6229/10000 (62.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0144, Accuracy: 9861/9900 (99.6061%)
Done in 280.54616618156433 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 84, 48, 20, 55, 59, 40, 92, 0, 16, 85, 82, 90, 52, 6, 15, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5227/5308 (98.4740%), train_poison_data_count: 415
Global model norm: 44.965086553781504.
Norm before scaling: 44.916551314980204. Distance: 1.0901502499573141
Total norm for 4 adversaries is: 44.916551314980204. distance: 1.0901502499573141
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0341, Accuracy: 9808/9900 (99.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5668/5777 (98.1132%), train_poison_data_count: 455
Global model norm: 44.965086553781504.
Norm before scaling: 44.912965149014184. Distance: 1.1897350659893016
Total norm for 4 adversaries is: 44.912965149014184. distance: 1.1897350659893016
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0226, Accuracy: 9839/9900 (99.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5015/5123 (97.8919%), train_poison_data_count: 403
Global model norm: 44.965086553781504.
Norm before scaling: 44.919130350935944. Distance: 1.1409405311078211
Total norm for 4 adversaries is: 44.919130350935944. distance: 1.1409405311078211
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0545, Accuracy: 9752/9900 (98.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5396/5503 (98.0556%), train_poison_data_count: 430
Global model norm: 44.965086553781504.
Norm before scaling: 44.91681357355576. Distance: 1.1652098767898806
Total norm for 4 adversaries is: 44.91681357355576. distance: 1.1652098767898806
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0538, Accuracy: 9764/9900 (98.6263%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4856/5209 (93.2233%)
___Train Local_ResNet_18,  epoch 197, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4715/5209 (90.5164%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3368, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4613/4830 (95.5072%)
___Train Local_ResNet_18,  epoch 197, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4515/4830 (93.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1236, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4519/4714 (95.8634%)
___Train Local_ResNet_18,  epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4439/4714 (94.1663%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0395, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4530/4731 (95.7514%)
___Train Local_ResNet_18,  epoch 197, local model 55, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4471/4731 (94.5043%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0351, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4231/4397 (96.2247%)
___Train Local_ResNet_18,  epoch 197, local model 59, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8558, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5607/5939 (94.4098%)
___Train Local_ResNet_18,  epoch 197, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5431/5939 (91.4464%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3419, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   1,  Average loss: 0.0027, Accuracy: 6469/6812 (94.9648%)
___Train Local_ResNet_18,  epoch 197, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 6250/6812 (91.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2148, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5056/5454 (92.7026%)
___Train Local_ResNet_18,  epoch 197, local model 0, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4864/5454 (89.1823%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1923, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5027/5353 (93.9100%)
___Train Local_ResNet_18,  epoch 197, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4838/5353 (90.3792%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2001, Accuracy: 5287/10000 (52.8700%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6356/6947 (91.4927%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 6004/6947 (86.4258%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.4892, Accuracy: 4810/10000 (48.1000%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5056/5298 (95.4322%)
___Train Local_ResNet_18,  epoch 197, local model 82, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4991/5298 (94.2054%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0835, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4531/4748 (95.4297%)
___Train Local_ResNet_18,  epoch 197, local model 90, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4405/4748 (92.7759%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1880, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3932/4130 (95.2058%)
___Train Local_ResNet_18,  epoch 197, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3825/4130 (92.6150%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0681, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4670/4929 (94.7454%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4542/4929 (92.1485%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1382, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5673/6068 (93.4904%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5621/6068 (92.6335%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1765, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4421/4736 (93.3488%)
___Train Local_ResNet_18,  epoch 197, local model 97, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4300/4736 (90.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.1160, Accuracy: 5407/10000 (54.0700%)
time spent on training: 254.9127390384674
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.6026, Accuracy: 6187/10000 (61.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0140, Accuracy: 9861/9900 (99.6061%)
Done in 281.2509491443634 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 57, 62, 61, 67, 3, 82, 69, 93, 42, 76, 7, 94, 14, 21, 32, 25].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5233/5308 (98.5870%), train_poison_data_count: 415
Global model norm: 44.982440150296426.
Norm before scaling: 44.932998622775834. Distance: 1.057812786243124
Total norm for 4 adversaries is: 44.932998622775834. distance: 1.057812786243124
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0518, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5660/5777 (97.9747%), train_poison_data_count: 455
Global model norm: 44.982440150296426.
Norm before scaling: 44.93352702143398. Distance: 1.300042982491259
Total norm for 4 adversaries is: 44.93352702143398. distance: 1.300042982491259
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0082, Accuracy: 9876/9900 (99.7576%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5009/5123 (97.7747%), train_poison_data_count: 403
Global model norm: 44.982440150296426.
Norm before scaling: 44.93849556659705. Distance: 1.1935432654514526
Total norm for 4 adversaries is: 44.93849556659705. distance: 1.1935432654514526
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0823, Accuracy: 9684/9900 (97.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5420/5503 (98.4917%), train_poison_data_count: 430
Global model norm: 44.982440150296426.
Norm before scaling: 44.93473593072583. Distance: 1.158462366743315
Total norm for 4 adversaries is: 44.93473593072583. distance: 1.158462366743315
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0319, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4699/4956 (94.8144%)
___Train Local_ResNet_18,  epoch 198, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4539/4956 (91.5860%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1712, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4999/5504 (90.8249%)
___Train Local_ResNet_18,  epoch 198, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4827/5504 (87.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.5183, Accuracy: 5038/10000 (50.3800%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4156/4485 (92.6644%)
___Train Local_ResNet_18,  epoch 198, local model 61, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3848/4485 (85.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4410, Accuracy: 4901/10000 (49.0100%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5134/5559 (92.3547%)
___Train Local_ResNet_18,  epoch 198, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4909/5559 (88.3072%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1371, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5033/5346 (94.1452%)
___Train Local_ResNet_18,  epoch 198, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4973/5346 (93.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1533, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5039/5298 (95.1114%)
___Train Local_ResNet_18,  epoch 198, local model 82, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4886/5298 (92.2235%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0988, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4119/4364 (94.3859%)
___Train Local_ResNet_18,  epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3969/4364 (90.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1565, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4687/5055 (92.7201%)
___Train Local_ResNet_18,  epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4578/5055 (90.5638%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1117, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5445/5907 (92.1788%)
___Train Local_ResNet_18,  epoch 198, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5292/5907 (89.5886%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4724, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3648/3959 (92.1445%)
___Train Local_ResNet_18,  epoch 198, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3658/3959 (92.3971%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8601, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4556/4869 (93.5716%)
___Train Local_ResNet_18,  epoch 198, local model 7, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3921/4869 (80.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.6924, Accuracy: 4515/10000 (45.1500%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4883/5224 (93.4724%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4798/5224 (91.8453%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2294, Accuracy: 5328/10000 (53.2800%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4052/4196 (96.5682%)
___Train Local_ResNet_18,  epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3996/4196 (95.2336%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8082, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4721/5038 (93.7078%)
___Train Local_ResNet_18,  epoch 198, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4648/5038 (92.2588%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0243, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5451/6080 (89.6546%)
___Train Local_ResNet_18,  epoch 198, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5367/6080 (88.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1340, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5802/6419 (90.3879%)
___Train Local_ResNet_18,  epoch 198, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5542/6419 (86.3374%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.3554, Accuracy: 5104/10000 (51.0400%)
time spent on training: 253.70220518112183
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.6116, Accuracy: 6169/10000 (61.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0143, Accuracy: 9862/9900 (99.6162%)
Done in 280.25182271003723 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 19, 16, 82, 89, 45, 31, 91, 9, 44, 66, 11, 76, 92, 37, 54, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5241/5308 (98.7378%), train_poison_data_count: 415
Global model norm: 45.00211176685559.
Norm before scaling: 44.95323226221127. Distance: 1.0578180265070969
Total norm for 4 adversaries is: 44.95323226221127. distance: 1.0578180265070969
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0568, Accuracy: 9751/9900 (98.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5687/5777 (98.4421%), train_poison_data_count: 455
Global model norm: 45.00211176685559.
Norm before scaling: 44.94793265980789. Distance: 1.1568911553259025
Total norm for 4 adversaries is: 44.94793265980789. distance: 1.1568911553259025
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0371, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5014/5123 (97.8723%), train_poison_data_count: 403
Global model norm: 45.00211176685559.
Norm before scaling: 44.956731042365895. Distance: 1.1538143278892374
Total norm for 4 adversaries is: 44.956731042365895. distance: 1.1538143278892374
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0287, Accuracy: 9822/9900 (99.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5412/5503 (98.3464%), train_poison_data_count: 430
Global model norm: 45.00211176685559.
Norm before scaling: 44.95247734804571. Distance: 1.1290255156878244
Total norm for 4 adversaries is: 44.95247734804571. distance: 1.1290255156878244
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0873, Accuracy: 9663/9900 (97.6061%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5005/5361 (93.3594%)
___Train Local_ResNet_18,  epoch 199, local model 19, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4763/5361 (88.8454%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3021, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5040/5353 (94.1528%)
___Train Local_ResNet_18,  epoch 199, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4818/5353 (90.0056%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1471, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5065/5298 (95.6021%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4999/5298 (94.3564%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9969, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4432/4737 (93.5613%)
___Train Local_ResNet_18,  epoch 199, local model 89, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4375/4737 (92.3580%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2132, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5063/5489 (92.2390%)
___Train Local_ResNet_18,  epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4969/5489 (90.5265%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.3845, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4313/4537 (95.0628%)
___Train Local_ResNet_18,  epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4230/4537 (93.2334%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9788, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4172/4527 (92.1582%)
___Train Local_ResNet_18,  epoch 199, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4037/4527 (89.1761%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0860, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5284/5727 (92.2647%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5129/5727 (89.5582%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1409, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4795/5075 (94.4828%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4653/5075 (91.6847%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1374, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4570/4843 (94.3630%)
___Train Local_ResNet_18,  epoch 199, local model 66, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4457/4843 (92.0297%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1725, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5037/5702 (88.3374%)
___Train Local_ResNet_18,  epoch 199, local model 11, internal_epoch   2,  Average loss: 0.0097, Accuracy: 4635/5702 (81.2873%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.5672, Accuracy: 4778/10000 (47.7800%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3681/3959 (92.9780%)
___Train Local_ResNet_18,  epoch 199, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3624/3959 (91.5383%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0722, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6426/6812 (94.3335%)
___Train Local_ResNet_18,  epoch 199, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 6218/6812 (91.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2708, Accuracy: 5197/10000 (51.9700%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4378/4741 (92.3434%)
___Train Local_ResNet_18,  epoch 199, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4002/4741 (84.4126%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.5709, Accuracy: 4881/10000 (48.8100%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5127/5645 (90.8237%)
___Train Local_ResNet_18,  epoch 199, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4970/5645 (88.0425%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2799, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3719/3910 (95.1151%)
___Train Local_ResNet_18,  epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3467/3910 (88.6701%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2581, Accuracy: 5282/10000 (52.8200%)
time spent on training: 254.24941539764404
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.6163, Accuracy: 6153/10000 (61.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0152, Accuracy: 9860/9900 (99.5960%)
Done in 280.7580382823944 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 42, 74, 66, 6, 50, 49, 10, 11, 1, 96, 61, 52, 79, 72, 55, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5228/5308 (98.4928%), train_poison_data_count: 415
Global model norm: 45.02223978430341.
Norm before scaling: 44.9730605126558. Distance: 1.0924431759440059
Total norm for 4 adversaries is: 44.9730605126558. distance: 1.0924431759440059
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0249, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5675/5777 (98.2344%), train_poison_data_count: 455
Global model norm: 45.02223978430341.
Norm before scaling: 44.968607485441304. Distance: 1.15665268973848
Total norm for 4 adversaries is: 44.968607485441304. distance: 1.15665268973848
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.1176, Accuracy: 9601/9900 (96.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5029/5123 (98.1651%), train_poison_data_count: 403
Global model norm: 45.02223978430341.
Norm before scaling: 44.97572587483997. Distance: 1.1156404894867462
Total norm for 4 adversaries is: 44.97572587483997. distance: 1.1156404894867462
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.2384, Accuracy: 9266/9900 (93.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5400/5503 (98.1283%), train_poison_data_count: 430
Global model norm: 45.02223978430341.
Norm before scaling: 44.974520781563086. Distance: 1.1723190483572965
Total norm for 4 adversaries is: 44.974520781563086. distance: 1.1723190483572965
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0339, Accuracy: 9817/9900 (99.1616%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5502/5907 (93.1437%)
___Train Local_ResNet_18,  epoch 200, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5331/5907 (90.2489%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.2158, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4473/4797 (93.2458%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4425/4797 (92.2452%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9015, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4549/4843 (93.9294%)
___Train Local_ResNet_18,  epoch 200, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4492/4843 (92.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1521, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4675/4929 (94.8468%)
___Train Local_ResNet_18,  epoch 200, local model 6, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4560/4929 (92.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1112, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4480/4757 (94.1770%)
___Train Local_ResNet_18,  epoch 200, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4339/4757 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1893, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5169/5652 (91.4544%)
___Train Local_ResNet_18,  epoch 200, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5048/5652 (89.3135%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3751, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4832/5068 (95.3433%)
___Train Local_ResNet_18,  epoch 200, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4652/5068 (91.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3066, Accuracy: 5136/10000 (51.3600%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5106/5702 (89.5475%)
___Train Local_ResNet_18,  epoch 200, local model 11, internal_epoch   2,  Average loss: 0.0113, Accuracy: 4472/5702 (78.4286%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4727, Accuracy: 4809/10000 (48.0900%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5204/5422 (95.9793%)
___Train Local_ResNet_18,  epoch 200, local model 1, internal_epoch   2,  Average loss: 0.0029, Accuracy: 5127/5422 (94.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8815, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4784/5086 (94.0621%)
___Train Local_ResNet_18,  epoch 200, local model 96, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4674/5086 (91.8993%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1196, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4218/4485 (94.0468%)
___Train Local_ResNet_18,  epoch 200, local model 61, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3915/4485 (87.2910%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1994, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3949/4130 (95.6174%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3851/4130 (93.2446%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.9802, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3865/4111 (94.0161%)
___Train Local_ResNet_18,  epoch 200, local model 79, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3696/4111 (89.9051%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4774, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4870/5193 (93.7801%)
___Train Local_ResNet_18,  epoch 200, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4548/5193 (87.5794%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.4269, Accuracy: 5023/10000 (50.2300%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4469/4731 (94.4621%)
___Train Local_ResNet_18,  epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4421/4731 (93.4475%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1870, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5771/6235 (92.5581%)
___Train Local_ResNet_18,  epoch 200, local model 38, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5510/6235 (88.3721%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.6765, Accuracy: 4710/10000 (47.1000%)
time spent on training: 251.81618928909302
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6088, Accuracy: 6162/10000 (61.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0182, Accuracy: 9854/9900 (99.5354%)
Done in 278.23730421066284 sec.
Saving all the graphs.
This run has a label: Sep.03_13.32.14. Visdom environment: cifar100_CerP
