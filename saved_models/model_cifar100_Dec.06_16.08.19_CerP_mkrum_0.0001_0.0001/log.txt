current path: saved_models/model_cifar100_Dec.06_16.08.19_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4314/4885 (88.3112%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.439894596008514. Distance: 2.292806226439184
Total norm for 4 adversaries is: 42.439894596008514. distance: 2.292806226439184
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4354, Accuracy: 8848/9900 (89.3737%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4739/5305 (89.3308%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.43527786661927. Distance: 2.2508348399664158
Total norm for 4 adversaries is: 42.43527786661927. distance: 2.2508348399664158
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7150, Accuracy: 8337/9900 (84.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4176/4717 (88.5308%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43873542706518. Distance: 2.1786471382761587
Total norm for 4 adversaries is: 42.43873542706518. distance: 2.1786471382761587
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4294, Accuracy: 8877/9900 (89.6667%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4452/5066 (87.8800%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.440385004107526. Distance: 2.3030386506124034
Total norm for 4 adversaries is: 42.440385004107526. distance: 2.3030386506124034
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5861, Accuracy: 8530/9900 (86.1616%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3837/4356 (88.0854%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3683/4356 (84.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.5766, Accuracy: 4553/10000 (45.5300%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3938/4465 (88.1971%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4094/4465 (91.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9796, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4048/4647 (87.1100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4168/4647 (89.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9250, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4457/5055 (88.1701%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4525/5055 (89.5153%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1001, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4450/5116 (86.9820%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9876, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3633/4126 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3751/4126 (90.9113%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9756, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3077/3472 (88.6233%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0827, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4431/4986 (88.8688%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4468/4986 (89.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9870, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3539/4013 (88.1884%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3686/4013 (91.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8119, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4036/4618 (87.3971%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4095/4618 (88.6748%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1281, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4433/5083 (87.2123%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4429/5083 (87.1336%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1225, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3968/4511 (87.9628%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4024/4511 (89.2042%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2583, Accuracy: 5046/10000 (50.4600%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3335/3797 (87.8325%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3384/3797 (89.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9866, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5001/5582 (89.5915%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5071/5582 (90.8456%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1911, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3155/3616 (87.2511%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3213/3616 (88.8551%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0368, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4828/5455 (88.5060%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4829/5455 (88.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9380, Accuracy: 5365/10000 (53.6500%)
time spent on training: 257.43169021606445
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1054, Accuracy: 7054/10000 (70.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.9216, Accuracy: 135/9900 (1.3636%)
Done in 284.266393661499 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4367/4885 (89.3961%), train_poison_data_count: 385
Global model norm: 42.45446492180622.
Norm before scaling: 42.46256537242907. Distance: 2.1558578798095693
Total norm for 4 adversaries is: 42.46256537242907. distance: 2.1558578798095693
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2449, Accuracy: 9299/9900 (93.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4768/5305 (89.8775%), train_poison_data_count: 415
Global model norm: 42.45446492180622.
Norm before scaling: 42.45560497219051. Distance: 2.2107608576327547
Total norm for 4 adversaries is: 42.45560497219051. distance: 2.2107608576327547
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1626, Accuracy: 9479/9900 (95.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4221/4717 (89.4848%), train_poison_data_count: 370
Global model norm: 42.45446492180622.
Norm before scaling: 42.45797985904343. Distance: 2.0617248928243086
Total norm for 4 adversaries is: 42.45797985904343. distance: 2.0617248928243086
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.3170, Accuracy: 9099/9900 (91.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4509/5066 (89.0051%), train_poison_data_count: 400
Global model norm: 42.45446492180622.
Norm before scaling: 42.46213271661882. Distance: 2.1968127788560996
Total norm for 4 adversaries is: 42.46213271661882. distance: 2.1968127788560996
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2443, Accuracy: 9306/9900 (94.0000%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3572/4025 (88.7453%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3695/4025 (91.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9731, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3356/3797 (88.3856%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3451/3797 (90.8875%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0415, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3942/4625 (85.2324%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4025/4625 (87.0270%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1568, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3858/4481 (86.0969%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3858/4481 (86.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1573, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3908/4315 (90.5678%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3965/4315 (91.8888%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8880, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3776/4235 (89.1617%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3781/4235 (89.2798%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0138, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3383/3828 (88.3751%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3504/3828 (91.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9351, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3804/4416 (86.1413%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3963/4416 (89.7418%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8917, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3139/3638 (86.2837%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3269/3638 (89.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.8733, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4614/5265 (87.6353%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4639/5265 (88.1102%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0784, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3349/3781 (88.5745%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3213/3781 (84.9775%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3763, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4006/4441 (90.2049%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4043/4441 (91.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1188, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3946/4433 (89.0142%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3972/4433 (89.6007%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9763, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4461/5083 (87.7631%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4462/5083 (87.7828%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1394, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4307/4928 (87.3985%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1029, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4192/4793 (87.4609%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4285/4793 (89.4012%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0161, Accuracy: 5414/10000 (54.1400%)
time spent on training: 256.0620663166046
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0977, Accuracy: 7071/10000 (70.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.6522, Accuracy: 330/9900 (3.3333%)
Done in 282.6556873321533 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4445/4885 (90.9928%), train_poison_data_count: 385
Global model norm: 42.476969863091696.
Norm before scaling: 42.478503007679514. Distance: 1.9929123700405507
Total norm for 4 adversaries is: 42.478503007679514. distance: 1.9929123700405507
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1859, Accuracy: 9460/9900 (95.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4818/5305 (90.8200%), train_poison_data_count: 415
Global model norm: 42.476969863091696.
Norm before scaling: 42.47632037934489. Distance: 2.063201438229708
Total norm for 4 adversaries is: 42.47632037934489. distance: 2.063201438229708
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1703, Accuracy: 9435/9900 (95.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4245/4717 (89.9936%), train_poison_data_count: 370
Global model norm: 42.476969863091696.
Norm before scaling: 42.4803593748592. Distance: 2.0114048981512003
Total norm for 4 adversaries is: 42.4803593748592. distance: 2.0114048981512003
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3278, Accuracy: 9115/9900 (92.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4480/5066 (88.4327%), train_poison_data_count: 400
Global model norm: 42.476969863091696.
Norm before scaling: 42.483919579666406. Distance: 2.180043509337876
Total norm for 4 adversaries is: 42.483919579666406. distance: 2.180043509337876
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2337, Accuracy: 9293/9900 (93.8687%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3202/3616 (88.5509%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3275/3616 (90.5697%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8865, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3406/3837 (88.7673%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3559/3837 (92.7548%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9147, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4152/4679 (88.7369%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4166/4679 (89.0361%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0660, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3164/3638 (86.9709%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3298/3638 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8776, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3614/4046 (89.3228%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3711/4046 (91.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0277, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4013/4518 (88.8225%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4108/4518 (90.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0846, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3351/3797 (88.2539%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3433/3797 (90.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0561, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4432/5025 (88.1990%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4501/5025 (89.5721%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1731, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3927/4362 (90.0275%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4028/4362 (92.3430%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8652, Accuracy: 5608/10000 (56.0800%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4017/4558 (88.1308%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3993/4558 (87.6042%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1517, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3216/3672 (87.5817%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3292/3672 (89.6514%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0274, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4292/4874 (88.0591%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4264/4874 (87.4846%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1329, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3594/4025 (89.2919%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3668/4025 (91.1304%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9182, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4151/4663 (89.0199%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4275/4663 (91.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1237, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3400/3911 (86.9343%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3242/3911 (82.8944%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2076, Accuracy: 5028/10000 (50.2800%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4417/5017 (88.0407%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4535/5017 (90.3927%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9353, Accuracy: 5615/10000 (56.1500%)
time spent on training: 252.1170859336853
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0942, Accuracy: 7080/10000 (70.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.4857, Accuracy: 689/9900 (6.9596%)
Done in 278.8140330314636 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4446/4885 (91.0133%), train_poison_data_count: 385
Global model norm: 42.497071647736064.
Norm before scaling: 42.49912108466186. Distance: 1.9621826717136868
Total norm for 4 adversaries is: 42.49912108466186. distance: 1.9621826717136868
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3672, Accuracy: 8992/9900 (90.8283%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4868/5305 (91.7625%), train_poison_data_count: 415
Global model norm: 42.497071647736064.
Norm before scaling: 42.49127610371187. Distance: 1.9690597532707543
Total norm for 4 adversaries is: 42.49127610371187. distance: 1.9690597532707543
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2990, Accuracy: 9116/9900 (92.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4268/4717 (90.4812%), train_poison_data_count: 370
Global model norm: 42.497071647736064.
Norm before scaling: 42.49980181479527. Distance: 1.958163423133835
Total norm for 4 adversaries is: 42.49980181479527. distance: 1.958163423133835
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1743, Accuracy: 9462/9900 (95.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4590/5066 (90.6040%), train_poison_data_count: 400
Global model norm: 42.497071647736064.
Norm before scaling: 42.502935330618634. Distance: 2.0862549958074967
Total norm for 4 adversaries is: 42.502935330618634. distance: 2.0862549958074967
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.2548, Accuracy: 9256/9900 (93.4949%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5285/6124 (86.2998%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5396/6124 (88.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9920, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3885/4356 (89.1873%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3766/4356 (86.4555%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1930, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3567/4158 (85.7864%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3593/4158 (86.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0940, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4885/5455 (89.5509%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4877/5455 (89.4042%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0730, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3908/4511 (86.6327%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4007/4511 (88.8273%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9959, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4511/5232 (86.2194%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4564/5232 (87.2324%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1616, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4448/5244 (84.8207%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4536/5244 (86.4989%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9352, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4364/4918 (88.7353%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4414/4918 (89.7519%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0871, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3648/4126 (88.4149%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3796/4126 (92.0019%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9068, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4253/4928 (86.3028%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4358/4928 (88.4334%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9473, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3747/4223 (88.7284%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3863/4223 (91.4753%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0225, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4565/5195 (87.8730%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4538/5195 (87.3532%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1122, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4164/4679 (88.9934%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4156/4679 (88.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0646, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3202/3646 (87.8223%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3274/3646 (89.7970%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8627, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3159/3616 (87.3617%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3258/3616 (90.0996%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8942, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4087/4716 (86.6624%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4174/4716 (88.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0116, Accuracy: 5383/10000 (53.8300%)
time spent on training: 262.6742377281189
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 2 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 33.33% (1/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0901, Accuracy: 7080/10000 (70.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.9546, Accuracy: 955/9900 (9.6465%)
Done in 289.45898246765137 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4479/4885 (91.6888%), train_poison_data_count: 385
Global model norm: 42.52314971540502.
Norm before scaling: 42.525341422332374. Distance: 1.9208737378066938
Total norm for 4 adversaries is: 42.525341422332374. distance: 1.9208737378066938
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.4301, Accuracy: 8929/9900 (90.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4827/5305 (90.9896%), train_poison_data_count: 415
Global model norm: 42.52314971540502.
Norm before scaling: 42.52101244118533. Distance: 1.9847200949660229
Total norm for 4 adversaries is: 42.52101244118533. distance: 1.9847200949660229
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2514, Accuracy: 9287/9900 (93.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4291/4717 (90.9688%), train_poison_data_count: 370
Global model norm: 42.52314971540502.
Norm before scaling: 42.5238444140461. Distance: 1.9377424642145404
Total norm for 4 adversaries is: 42.5238444140461. distance: 1.9377424642145404
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2276, Accuracy: 9288/9900 (93.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4591/5066 (90.6238%), train_poison_data_count: 400
Global model norm: 42.52314971540502.
Norm before scaling: 42.526831201846115. Distance: 2.0496083420434075
Total norm for 4 adversaries is: 42.526831201846115. distance: 2.0496083420434075
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.3210, Accuracy: 9113/9900 (92.0505%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5298/6124 (86.5121%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5310/6124 (86.7080%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1330, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3966/4433 (89.4654%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4066/4433 (91.7212%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8991, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3350/3781 (88.6009%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3380/3781 (89.3943%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0517, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3534/3969 (89.0401%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3608/3969 (90.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9648, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4396/5025 (87.4826%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4543/5025 (90.4080%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0431, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4195/4679 (89.6559%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4033/4679 (86.1936%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1686, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4124/4707 (87.6142%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4224/4707 (89.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9883, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4986 (88.4075%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4474/4986 (89.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9767, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3901/4315 (90.4056%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3943/4315 (91.3789%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9890, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3883/4416 (87.9303%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3939/4416 (89.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0143, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4272/4804 (88.9259%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4322/4804 (89.9667%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1470, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4241/4793 (88.4832%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4283/4793 (89.3595%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0325, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4567/5232 (87.2898%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4605/5232 (88.0161%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1317, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4119/4662 (88.3526%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4208/4662 (90.2617%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1134, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4301/4956 (86.7837%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4336/4956 (87.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1801, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3808/4368 (87.1795%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3861/4368 (88.3929%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1506, Accuracy: 5197/10000 (51.9700%)
time spent on training: 262.69226598739624
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 4 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0910, Accuracy: 7083/10000 (70.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.2418, Accuracy: 1418/9900 (14.3232%)
Done in 289.689439535141 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4465/4885 (91.4023%), train_poison_data_count: 385
Global model norm: 42.54594684307117.
Norm before scaling: 42.547616650256536. Distance: 1.939274559751655
Total norm for 4 adversaries is: 42.547616650256536. distance: 1.939274559751655
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1925, Accuracy: 9404/9900 (94.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4851/5305 (91.4420%), train_poison_data_count: 415
Global model norm: 42.54594684307117.
Norm before scaling: 42.54581629696391. Distance: 1.9900933722055445
Total norm for 4 adversaries is: 42.54581629696391. distance: 1.9900933722055445
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1617, Accuracy: 9498/9900 (95.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4325/4717 (91.6896%), train_poison_data_count: 370
Global model norm: 42.54594684307117.
Norm before scaling: 42.54201737326875. Distance: 1.806924729561805
Total norm for 4 adversaries is: 42.54201737326875. distance: 1.806924729561805
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1973, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4601/5066 (90.8212%), train_poison_data_count: 400
Global model norm: 42.54594684307117.
Norm before scaling: 42.54898802364091. Distance: 2.0188986047429203
Total norm for 4 adversaries is: 42.54898802364091. distance: 2.0188986047429203
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2021, Accuracy: 9348/9900 (94.4242%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5326/6124 (86.9693%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5321/6124 (86.8877%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9679, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0072, Accuracy: 5070/5902 (85.9031%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5107/5902 (86.5300%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2195, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4164/4707 (88.4640%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4243/4707 (90.1423%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9508, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4076/4647 (87.7125%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4162/4647 (89.5632%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0448, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2929/3297 (88.8383%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0048, Accuracy: 2985/3297 (90.5369%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8638, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5511/6263 (87.9930%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5555/6263 (88.6955%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0159, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4176/4663 (89.5561%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4260/4663 (91.3575%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9477, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4291/4956 (86.5819%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4365/4956 (88.0751%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1022, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3649/4046 (90.1878%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3698/4046 (91.3989%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9042, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3691/4184 (88.2170%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3811/4184 (91.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9810, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4797/5591 (85.7986%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4860/5591 (86.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0446, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4078/4634 (88.0017%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4199/4634 (90.6129%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8551, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3408/3828 (89.0282%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3480/3828 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0866, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3161/3638 (86.8884%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3306/3638 (90.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8100, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3388/3781 (89.6059%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3458/3781 (91.4573%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0513, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3413/3837 (88.9497%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3532/3837 (92.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.0129, Accuracy: 5403/10000 (54.0300%)
time spent on training: 262.77743339538574
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0929, Accuracy: 7077/10000 (70.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 4.5569, Accuracy: 2063/9900 (20.8384%)
Done in 290.22497749328613 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4513/4885 (92.3849%), train_poison_data_count: 385
Global model norm: 42.569038594675824.
Norm before scaling: 42.56742268017659. Distance: 1.8199340033879312
Total norm for 4 adversaries is: 42.56742268017659. distance: 1.8199340033879312
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1544, Accuracy: 9517/9900 (96.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4838/5305 (91.1970%), train_poison_data_count: 415
Global model norm: 42.569038594675824.
Norm before scaling: 42.569062969136546. Distance: 1.959298653461284
Total norm for 4 adversaries is: 42.569062969136546. distance: 1.959298653461284
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.3478, Accuracy: 9078/9900 (91.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4345/4717 (92.1136%), train_poison_data_count: 370
Global model norm: 42.569038594675824.
Norm before scaling: 42.56362998683559. Distance: 1.7930066472455284
Total norm for 4 adversaries is: 42.56362998683559. distance: 1.7930066472455284
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2629, Accuracy: 9211/9900 (93.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4626/5066 (91.3146%), train_poison_data_count: 400
Global model norm: 42.569038594675824.
Norm before scaling: 42.573675226196116. Distance: 1.9900621633548847
Total norm for 4 adversaries is: 42.573675226196116. distance: 1.9900621633548847
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1438, Accuracy: 9531/9900 (96.2727%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3953/4501 (87.8249%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3987/4501 (88.5803%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9972, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3688/4175 (88.3353%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3660/4175 (87.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0926, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3231/3616 (89.3529%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3294/3616 (91.0951%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0124, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4147/4634 (89.4907%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4209/4634 (90.8287%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8069, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4053/4558 (88.9206%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3988/4558 (87.4945%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3044, Accuracy: 4940/10000 (49.4000%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4586/5167 (88.7556%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4638/5167 (89.7620%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0954, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3930/4356 (90.2204%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4015/4356 (92.1717%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0301, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4109/4716 (87.1289%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4223/4716 (89.5462%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0284, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5288/6124 (86.3488%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5369/6124 (87.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0120, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4485/5055 (88.7240%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4568/5055 (90.3660%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9919, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4496/5025 (89.4726%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4576/5025 (91.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.3073, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4425/4918 (89.9756%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4419/4918 (89.8536%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0839, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3786/4223 (89.6519%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3882/4223 (91.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8660, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3880/4481 (86.5878%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3902/4481 (87.0788%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0641, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3203/3638 (88.0429%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3282/3638 (90.2144%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8663, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3580/4013 (89.2101%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3645/4013 (90.8298%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8214, Accuracy: 5721/10000 (57.2100%)
time spent on training: 261.18380856513977
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0956, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 3.9258, Accuracy: 2805/9900 (28.3333%)
Done in 288.2978219985962 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4518/4885 (92.4872%), train_poison_data_count: 385
Global model norm: 42.59141564357115.
Norm before scaling: 42.590468394311834. Distance: 1.8254599422760533
Total norm for 4 adversaries is: 42.590468394311834. distance: 1.8254599422760533
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1513, Accuracy: 9521/9900 (96.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4912/5305 (92.5919%), train_poison_data_count: 415
Global model norm: 42.59141564357115.
Norm before scaling: 42.584083585357185. Distance: 1.8053458858266782
Total norm for 4 adversaries is: 42.584083585357185. distance: 1.8053458858266782
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1978, Accuracy: 9400/9900 (94.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4358/4717 (92.3892%), train_poison_data_count: 370
Global model norm: 42.59141564357115.
Norm before scaling: 42.58781139818645. Distance: 1.7501561912589059
Total norm for 4 adversaries is: 42.58781139818645. distance: 1.7501561912589059
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1779, Accuracy: 9465/9900 (95.6061%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4624/5066 (91.2752%), train_poison_data_count: 400
Global model norm: 42.59141564357115.
Norm before scaling: 42.59331294484132. Distance: 1.9315445338957964
Total norm for 4 adversaries is: 42.59331294484132. distance: 1.9315445338957964
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1701, Accuracy: 9472/9900 (95.6768%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3236/3646 (88.7548%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3282/3646 (90.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8903, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4014/4501 (89.1802%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3993/4501 (88.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0803, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4095/4651 (88.0456%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4144/4651 (89.0991%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1622, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4549/5167 (88.0395%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4628/5167 (89.5684%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0710, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4890/5455 (89.6425%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4869/5455 (89.2576%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9697, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4874/5591 (87.1758%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4849/5591 (86.7287%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1299, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4198/4679 (89.7200%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4171/4679 (89.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1645, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4498/5017 (89.6552%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4477/5017 (89.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8381, Accuracy: 5634/10000 (56.3400%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4226/4793 (88.1702%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4307/4793 (89.8602%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0865, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3965/4456 (88.9811%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4064/4456 (91.2029%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9213, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4825/5424 (88.9565%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4953/5424 (91.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1078, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3647/4175 (87.3533%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3665/4175 (87.7844%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9821, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4541/5116 (88.7608%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4551/5116 (88.9562%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0454, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3293/3704 (88.9039%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3313/3704 (89.4438%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9109, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4545/5232 (86.8693%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4623/5232 (88.3601%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.3118, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3153/3472 (90.8122%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3141/3472 (90.4666%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0198, Accuracy: 5575/10000 (55.7500%)
time spent on training: 257.00860834121704
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.1016, Accuracy: 7047/10000 (70.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 3.4581, Accuracy: 3454/9900 (34.8889%)
Done in 283.9106435775757 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4542/4885 (92.9785%), train_poison_data_count: 385
Global model norm: 42.61471191824485.
Norm before scaling: 42.61220539737558. Distance: 1.773035953451953
Total norm for 4 adversaries is: 42.61220539737558. distance: 1.773035953451953
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1554, Accuracy: 9511/9900 (96.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4898/5305 (92.3280%), train_poison_data_count: 415
Global model norm: 42.61471191824485.
Norm before scaling: 42.60826341601034. Distance: 1.8457032541749294
Total norm for 4 adversaries is: 42.60826341601034. distance: 1.8457032541749294
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1580, Accuracy: 9484/9900 (95.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4351/4717 (92.2408%), train_poison_data_count: 370
Global model norm: 42.61471191824485.
Norm before scaling: 42.610055401149886. Distance: 1.7525438484441993
Total norm for 4 adversaries is: 42.610055401149886. distance: 1.7525438484441993
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1798, Accuracy: 9422/9900 (95.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4639/5066 (91.5713%), train_poison_data_count: 400
Global model norm: 42.61471191824485.
Norm before scaling: 42.612307093377524. Distance: 1.8631003110031041
Total norm for 4 adversaries is: 42.612307093377524. distance: 1.8631003110031041
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1663, Accuracy: 9480/9900 (95.7576%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3241/3590 (90.2786%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3014/3590 (83.9554%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2333, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3922/4368 (89.7894%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3881/4368 (88.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0015, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3291/3704 (88.8499%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3343/3704 (90.2538%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9679, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4298/4928 (87.2159%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4360/4928 (88.4740%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0872, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3940/4356 (90.4500%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3869/4356 (88.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1452, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3508/3911 (89.6957%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3588/3911 (91.7412%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9857, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4182/4651 (89.9161%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4241/4651 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0253, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3791/4184 (90.6071%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3737/4184 (89.3164%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9452, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3898/4346 (89.6917%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3987/4346 (91.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1164, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4273/4793 (89.1508%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4338/4793 (90.5070%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1404, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3345/3804 (87.9338%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3449/3804 (90.6677%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0266, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4462/4986 (89.4906%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4474/4986 (89.7312%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9023, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5361/6124 (87.5408%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5362/6124 (87.5572%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0588, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4201/4707 (89.2501%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4211/4707 (89.4625%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8108, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3801/4235 (89.7521%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3758/4235 (88.7367%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1746, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3658/4046 (90.4103%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3726/4046 (92.0910%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9129, Accuracy: 5590/10000 (55.9000%)
time spent on training: 256.4483735561371
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.1087, Accuracy: 7039/10000 (70.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.0560, Accuracy: 3985/9900 (40.2525%)
Done in 283.16659474372864 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4531/4885 (92.7533%), train_poison_data_count: 385
Global model norm: 42.63558908976455.
Norm before scaling: 42.635214020916735. Distance: 1.7732532422304865
Total norm for 4 adversaries is: 42.635214020916735. distance: 1.7732532422304865
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3164, Accuracy: 9158/9900 (92.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4929/5305 (92.9123%), train_poison_data_count: 415
Global model norm: 42.63558908976455.
Norm before scaling: 42.629428667020186. Distance: 1.8048168317682909
Total norm for 4 adversaries is: 42.629428667020186. distance: 1.8048168317682909
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1435, Accuracy: 9533/9900 (96.2929%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4358/4717 (92.3892%), train_poison_data_count: 370
Global model norm: 42.63558908976455.
Norm before scaling: 42.63137438590562. Distance: 1.7466388849907606
Total norm for 4 adversaries is: 42.63137438590562. distance: 1.7466388849907606
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1344, Accuracy: 9549/9900 (96.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4689/5066 (92.5582%), train_poison_data_count: 400
Global model norm: 42.63558908976455.
Norm before scaling: 42.636863153958394. Distance: 1.8419625621391618
Total norm for 4 adversaries is: 42.636863153958394. distance: 1.8419625621391618
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1443, Accuracy: 9551/9900 (96.4747%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4516/4986 (90.5736%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4520/4986 (90.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9650, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4141/4634 (89.3612%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4220/4634 (91.0660%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8653, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4130/4716 (87.5742%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4192/4716 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.2003, Accuracy: 5105/10000 (51.0500%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5351/6124 (87.3775%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5359/6124 (87.5082%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1191, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4432/4918 (90.1179%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4442/4918 (90.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9776, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3409/3797 (89.7814%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3462/3797 (91.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0370, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5020/5582 (89.9319%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5046/5582 (90.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1869, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4383/4956 (88.4383%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4332/4956 (87.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1068, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4011/4433 (90.4805%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4060/4433 (91.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8491, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3844/4354 (88.2866%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3719/4354 (85.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4401, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4425/4928 (89.7930%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4440/4928 (90.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0814, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3504/3911 (89.5935%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3375/3911 (86.2951%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1706, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3948/4481 (88.1053%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3896/4481 (86.9449%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0537, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4570/5197 (87.9353%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4560/5197 (87.7429%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0907, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4897/5455 (89.7709%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4890/5455 (89.6425%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1288, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3850/4361 (88.2825%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3823/4361 (87.6634%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0274, Accuracy: 5402/10000 (54.0200%)
time spent on training: 265.5554003715515
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1168, Accuracy: 7014/10000 (70.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 2.6463, Accuracy: 4612/9900 (46.5859%)
Done in 292.70580768585205 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4532/4885 (92.7738%), train_poison_data_count: 385
Global model norm: 42.65998724470918.
Norm before scaling: 42.65583361747327. Distance: 1.756329194587778
Total norm for 4 adversaries is: 42.65583361747327. distance: 1.756329194587778
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2716, Accuracy: 9208/9900 (93.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4916/5305 (92.6673%), train_poison_data_count: 415
Global model norm: 42.65998724470918.
Norm before scaling: 42.65337959664656. Distance: 1.8041345979631755
Total norm for 4 adversaries is: 42.65337959664656. distance: 1.8041345979631755
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1655, Accuracy: 9520/9900 (96.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4352/4717 (92.2620%), train_poison_data_count: 370
Global model norm: 42.65998724470918.
Norm before scaling: 42.65619848897989. Distance: 1.7291553757387002
Total norm for 4 adversaries is: 42.65619848897989. distance: 1.7291553757387002
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2582, Accuracy: 9258/9900 (93.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4652/5066 (91.8279%), train_poison_data_count: 400
Global model norm: 42.65998724470918.
Norm before scaling: 42.66121765945623. Distance: 1.8596209836181707
Total norm for 4 adversaries is: 42.66121765945623. distance: 1.8596209836181707
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.2234, Accuracy: 9336/9900 (94.3030%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4320/4928 (87.6623%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4352/4928 (88.3117%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0605, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3749/4184 (89.6033%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3806/4184 (90.9656%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9265, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4274/4707 (90.8009%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4270/4707 (90.7160%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9142, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3406/3828 (88.9760%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9240, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4017/4503 (89.2072%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4034/4503 (89.5847%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0402, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4191/4662 (89.8970%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4280/4662 (91.8061%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9722, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3807/4235 (89.8937%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3708/4235 (87.5561%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0748, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4479/5244 (85.4119%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4595/5244 (87.6240%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0426, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4260/4793 (88.8796%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4344/4793 (90.6322%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9820, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3958/4481 (88.3285%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3914/4481 (87.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2434, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3935/4346 (90.5430%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4015/4346 (92.3838%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7829, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3867/4361 (88.6723%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3908/4361 (89.6125%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9671, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4500/5055 (89.0208%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4595/5055 (90.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9539, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4572/5195 (88.0077%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4596/5195 (88.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9641, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3947/4315 (91.4716%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3989/4315 (92.4450%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9006, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4217/4663 (90.4353%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4281/4663 (91.8078%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9983, Accuracy: 5433/10000 (54.3300%)
time spent on training: 262.9032425880432
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1198, Accuracy: 6999/10000 (69.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.3968, Accuracy: 4997/9900 (50.4747%)
Done in 289.7421283721924 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4558/4885 (93.3060%), train_poison_data_count: 385
Global model norm: 42.68247963020439.
Norm before scaling: 42.67902036477495. Distance: 1.7062731004206197
Total norm for 4 adversaries is: 42.67902036477495. distance: 1.7062731004206197
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1686, Accuracy: 9493/9900 (95.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4961/5305 (93.5156%), train_poison_data_count: 415
Global model norm: 42.68247963020439.
Norm before scaling: 42.675263333527745. Distance: 1.7523857611672644
Total norm for 4 adversaries is: 42.675263333527745. distance: 1.7523857611672644
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1238, Accuracy: 9597/9900 (96.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4359/4717 (92.4104%), train_poison_data_count: 370
Global model norm: 42.68247963020439.
Norm before scaling: 42.67578822225344. Distance: 1.6863238863243362
Total norm for 4 adversaries is: 42.67578822225344. distance: 1.6863238863243362
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.0779, Accuracy: 9697/9900 (97.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4659/5066 (91.9660%), train_poison_data_count: 400
Global model norm: 42.68247963020439.
Norm before scaling: 42.684259920044006. Distance: 1.8496478518841402
Total norm for 4 adversaries is: 42.684259920044006. distance: 1.8496478518841402
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.4428, Accuracy: 8868/9900 (89.5758%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3902/4315 (90.4287%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3961/4315 (91.7961%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0583, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3243/3590 (90.3343%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3162/3590 (88.0780%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1612, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4259/4679 (91.0237%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4288/4679 (91.6435%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9524, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4597/5167 (88.9685%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4678/5167 (90.5361%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2521, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3393/3775 (89.8808%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3521/3775 (93.2715%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8872, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3452/3828 (90.1776%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3488/3828 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0076, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3816/4235 (90.1063%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3697/4235 (87.2963%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9722, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4159/4647 (89.4986%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4226/4647 (90.9404%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9095, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4367/4918 (88.7963%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4435/4918 (90.1789%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1049, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4056/4433 (91.4956%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.7079, Accuracy: 5837/10000 (58.3700%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3933/4481 (87.7706%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3884/4481 (86.6771%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1643, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3830/4295 (89.1735%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3798/4295 (88.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8587, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4060/4503 (90.1621%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4095/4503 (90.9394%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.2577, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3874/4354 (88.9757%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0123, Accuracy: 3361/4354 (77.1934%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.8181, Accuracy: 4247/10000 (42.4700%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4505/4986 (90.3530%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4498/4986 (90.2126%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8151, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5624/6263 (89.7972%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5620/6263 (89.7334%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1331, Accuracy: 5330/10000 (53.3000%)
time spent on training: 260.69258093833923
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1258, Accuracy: 7008/10000 (70.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.0946, Accuracy: 5499/9900 (55.5455%)
Done in 287.5369803905487 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4586/4885 (93.8792%), train_poison_data_count: 385
Global model norm: 42.704808670614014.
Norm before scaling: 42.698663952403855. Distance: 1.6494589438692846
Total norm for 4 adversaries is: 42.698663952403855. distance: 1.6494589438692846
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.2219, Accuracy: 9380/9900 (94.7475%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4951/5305 (93.3270%), train_poison_data_count: 415
Global model norm: 42.704808670614014.
Norm before scaling: 42.69568918520932. Distance: 1.71612605159243
Total norm for 4 adversaries is: 42.69568918520932. distance: 1.71612605159243
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1206, Accuracy: 9584/9900 (96.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4387/4717 (93.0040%), train_poison_data_count: 370
Global model norm: 42.704808670614014.
Norm before scaling: 42.69804357116011. Distance: 1.6315722706225815
Total norm for 4 adversaries is: 42.69804357116011. distance: 1.6315722706225815
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.3484, Accuracy: 9027/9900 (91.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4724/5066 (93.2491%), train_poison_data_count: 400
Global model norm: 42.704808670614014.
Norm before scaling: 42.70206588285937. Distance: 1.7707343653530339
Total norm for 4 adversaries is: 42.70206588285937. distance: 1.7707343653530339
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1482, Accuracy: 9536/9900 (96.3232%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3801/4223 (90.0071%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3895/4223 (92.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0419, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4917/5455 (90.1375%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4883/5455 (89.5142%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0482, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5099/5582 (91.3472%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5026/5582 (90.0394%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1241, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4044/4465 (90.5711%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4083/4465 (91.4446%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8152, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4920/5591 (87.9986%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4981/5591 (89.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9837, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3500/3911 (89.4912%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3449/3911 (88.1872%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0579, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4002/4356 (91.8733%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3784/4356 (86.8687%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1224, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4459/5037 (88.5249%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4567/5037 (90.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9703, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4240/4679 (90.6177%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4140/4679 (88.4804%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0491, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3951/4362 (90.5777%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3961/4362 (90.8070%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0510, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4090/4518 (90.5268%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4113/4518 (91.0359%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0449, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4511/5083 (88.7468%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4507/5083 (88.6681%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.2606, Accuracy: 5087/10000 (50.8700%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3666/4013 (91.3531%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3686/4013 (91.8515%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9168, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4642/5197 (89.3208%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4547/5197 (87.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0985, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2968/3297 (90.0212%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3034/3297 (92.0231%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7460, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4040/4441 (90.9705%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4065/4441 (91.5334%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9921, Accuracy: 5553/10000 (55.5300%)
time spent on training: 262.7229640483856
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1284, Accuracy: 7004/10000 (70.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 1.8899, Accuracy: 5900/9900 (59.5960%)
Done in 289.4940495491028 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4571/4885 (93.5722%), train_poison_data_count: 385
Global model norm: 42.72758315543587.
Norm before scaling: 42.71913433669464. Distance: 1.6528174620849765
Total norm for 4 adversaries is: 42.71913433669464. distance: 1.6528174620849765
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2566, Accuracy: 9247/9900 (93.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4951/5305 (93.3270%), train_poison_data_count: 415
Global model norm: 42.72758315543587.
Norm before scaling: 42.72028303988414. Distance: 1.7599581360172882
Total norm for 4 adversaries is: 42.72028303988414. distance: 1.7599581360172882
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1891, Accuracy: 9440/9900 (95.3535%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4399/4717 (93.2584%), train_poison_data_count: 370
Global model norm: 42.72758315543587.
Norm before scaling: 42.719325789371226. Distance: 1.6260838195433045
Total norm for 4 adversaries is: 42.719325789371226. distance: 1.6260838195433045
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1699, Accuracy: 9505/9900 (96.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4681/5066 (92.4003%), train_poison_data_count: 400
Global model norm: 42.72758315543587.
Norm before scaling: 42.72664178201641. Distance: 1.8084163043182622
Total norm for 4 adversaries is: 42.72664178201641. distance: 1.8084163043182622
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1749, Accuracy: 9457/9900 (95.5253%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4047/4501 (89.9134%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4033/4501 (89.6023%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1190, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4015/4511 (89.0047%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4059/4511 (89.9800%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8489, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3879/4354 (89.0905%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3722/4354 (85.4846%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3106, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3956/4346 (91.0262%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4029/4346 (92.7059%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8020, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4239/4707 (90.0574%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4205/4707 (89.3350%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9084, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4907/5591 (87.7661%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4952/5591 (88.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1717, Accuracy: 5155/10000 (51.5500%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4151/4647 (89.3264%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4176/4647 (89.8644%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9041, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4129/4538 (90.9872%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4155/4538 (91.5602%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9782, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4308/4934 (87.3125%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0096, Accuracy: 4024/4934 (81.5565%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3346, Accuracy: 4877/10000 (48.7700%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4320/4804 (89.9251%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0090, Accuracy: 4003/4804 (83.3264%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1733, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5623/6263 (89.7813%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5587/6263 (89.2065%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2217, Accuracy: 5090/10000 (50.9000%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3995/4481 (89.1542%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3892/4481 (86.8556%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3070, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4431/5063 (87.5173%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4254/5063 (84.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1177, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3777/4223 (89.4388%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3814/4223 (90.3149%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8907, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4084/4441 (91.9613%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4043/4441 (91.0381%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.1254, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3458/3756 (92.0660%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3467/3756 (92.3056%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9126, Accuracy: 5610/10000 (56.1000%)
time spent on training: 264.29958748817444
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1376, Accuracy: 6975/10000 (69.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 1.6624, Accuracy: 6338/9900 (64.0202%)
Done in 291.04116010665894 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4598/4885 (94.1249%), train_poison_data_count: 385
Global model norm: 42.75168039688981.
Norm before scaling: 42.741574176508024. Distance: 1.6404530753017124
Total norm for 4 adversaries is: 42.741574176508024. distance: 1.6404530753017124
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2424, Accuracy: 9297/9900 (93.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4967/5305 (93.6287%), train_poison_data_count: 415
Global model norm: 42.75168039688981.
Norm before scaling: 42.741088652252266. Distance: 1.6861650343429528
Total norm for 4 adversaries is: 42.741088652252266. distance: 1.6861650343429528
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0639, Accuracy: 9743/9900 (98.4141%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4391/4717 (93.0888%), train_poison_data_count: 370
Global model norm: 42.75168039688981.
Norm before scaling: 42.74289363221315. Distance: 1.5877410705632453
Total norm for 4 adversaries is: 42.74289363221315. distance: 1.5877410705632453
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2634, Accuracy: 9288/9900 (93.8182%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4693/5066 (92.6372%), train_poison_data_count: 400
Global model norm: 42.75168039688981.
Norm before scaling: 42.74881925681179. Distance: 1.7911975897118118
Total norm for 4 adversaries is: 42.74881925681179. distance: 1.7911975897118118
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1356, Accuracy: 9567/9900 (96.6364%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4531/5244 (86.4035%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4527/5244 (86.3272%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0217, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4405/4928 (89.3872%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9619, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3405/3804 (89.5110%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3466/3804 (91.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8684, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3599/4013 (89.6835%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3708/4013 (92.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8626, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3622/4158 (87.1092%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3655/4158 (87.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0146, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5092/5582 (91.2218%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5063/5582 (90.7023%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0818, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4916/5455 (90.1192%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4922/5455 (90.2291%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0278, Accuracy: 5309/10000 (53.0900%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3891/4354 (89.3661%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0087, Accuracy: 3665/4354 (84.1755%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.4957, Accuracy: 4748/10000 (47.4800%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4020/4433 (90.6835%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4014/4433 (90.5482%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9285, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3243/3646 (88.9468%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3343/3646 (91.6895%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8070, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9812, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3812/4235 (90.0118%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3868/4235 (91.3341%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9275, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4026/4362 (92.2971%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3956/4362 (90.6923%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1278, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4914/5392 (91.1350%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4851/5392 (89.9666%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0587, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4982/5591 (89.1075%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4864/5591 (86.9970%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2168, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3408/3756 (90.7348%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3498/3756 (93.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9915, Accuracy: 5500/10000 (55.0000%)
time spent on training: 260.58742690086365
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 4 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1416, Accuracy: 6973/10000 (69.7300%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.4950, Accuracy: 6641/9900 (67.0808%)
Done in 287.661159992218 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4596/4885 (94.0839%), train_poison_data_count: 385
Global model norm: 42.7736337038879.
Norm before scaling: 42.76328860762538. Distance: 1.606705534941027
Total norm for 4 adversaries is: 42.76328860762538. distance: 1.606705534941027
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0881, Accuracy: 9678/9900 (97.7576%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4939/5305 (93.1008%), train_poison_data_count: 415
Global model norm: 42.7736337038879.
Norm before scaling: 42.762717692097894. Distance: 1.735880361693079
Total norm for 4 adversaries is: 42.762717692097894. distance: 1.735880361693079
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1942, Accuracy: 9432/9900 (95.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4441/4717 (94.1488%), train_poison_data_count: 370
Global model norm: 42.7736337038879.
Norm before scaling: 42.76232232862827. Distance: 1.5317026364596606
Total norm for 4 adversaries is: 42.76232232862827. distance: 1.5317026364596606
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0654, Accuracy: 9737/9900 (98.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4707/5066 (92.9135%), train_poison_data_count: 400
Global model norm: 42.7736337038879.
Norm before scaling: 42.768589194403965. Distance: 1.7578026665306548
Total norm for 4 adversaries is: 42.768589194403965. distance: 1.7578026665306548
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1584, Accuracy: 9481/9900 (95.7677%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4178/4634 (90.1597%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4202/4634 (90.6776%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8831, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4048/4503 (89.8956%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4028/4503 (89.4515%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0906, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4426/4928 (89.8133%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9425, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3456/3804 (90.8517%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3469/3804 (91.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0968, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3258/3590 (90.7521%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3101/3590 (86.3788%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2060, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4209/4647 (90.5746%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4230/4647 (91.0265%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9502, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4046/4625 (87.4811%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4091/4625 (88.4541%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2016, Accuracy: 5159/10000 (51.5900%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3966/4356 (91.0468%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3746/4356 (85.9963%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3101, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3460/3797 (91.1246%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3478/3797 (91.5986%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9303, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4098/4456 (91.9659%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4087/4456 (91.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9117, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3615/4025 (89.8137%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3711/4025 (92.1988%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9223, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3127/3472 (90.0634%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3165/3472 (91.1578%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0866, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2971/3297 (90.1122%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3041/3297 (92.2354%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9028, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3922/4416 (88.8134%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3979/4416 (90.1042%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0630, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4000/4356 (91.8274%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3859/4356 (88.5904%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.2102, Accuracy: 5167/10000 (51.6700%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3196/3638 (87.8505%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3309/3638 (90.9566%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8172, Accuracy: 5684/10000 (56.8400%)
time spent on training: 249.32933712005615
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1532, Accuracy: 6950/10000 (69.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.3091, Accuracy: 7000/9900 (70.7071%)
Done in 276.2291464805603 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4610/4885 (94.3705%), train_poison_data_count: 385
Global model norm: 42.79412812926267.
Norm before scaling: 42.78434578371656. Distance: 1.5598353744109255
Total norm for 4 adversaries is: 42.78434578371656. distance: 1.5598353744109255
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.2567, Accuracy: 9302/9900 (93.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4957/5305 (93.4402%), train_poison_data_count: 415
Global model norm: 42.79412812926267.
Norm before scaling: 42.78386930440315. Distance: 1.7128265264473044
Total norm for 4 adversaries is: 42.78386930440315. distance: 1.7128265264473044
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3532, Accuracy: 9040/9900 (91.3131%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4430/4717 (93.9156%), train_poison_data_count: 370
Global model norm: 42.79412812926267.
Norm before scaling: 42.78351408134257. Distance: 1.5516212936279656
Total norm for 4 adversaries is: 42.78351408134257. distance: 1.5516212936279656
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1604, Accuracy: 9498/9900 (95.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4757/5066 (93.9005%), train_poison_data_count: 400
Global model norm: 42.79412812926267.
Norm before scaling: 42.78535008201551. Distance: 1.648599481081878
Total norm for 4 adversaries is: 42.78535008201551. distance: 1.648599481081878
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.3404, Accuracy: 9111/9900 (92.0303%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3716/4175 (89.0060%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3748/4175 (89.7725%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0051, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4349/4956 (87.7522%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4419/4956 (89.1646%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2421, Accuracy: 5081/10000 (50.8100%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4479/5037 (88.9220%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4557/5037 (90.4705%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9550, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4302/4793 (89.7559%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4345/4793 (90.6530%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9010, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3438/3804 (90.3785%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3478/3804 (91.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9112, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4833/5392 (89.6328%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4745/5392 (88.0007%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1030, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4059/4465 (90.9071%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4104/4465 (91.9149%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9230, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4111/4596 (89.4473%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4173/4596 (90.7963%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0482, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5451/6124 (89.0105%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5391/6124 (88.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9787, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2922/3271 (89.3305%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2948/3271 (90.1253%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9585, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3301/3590 (91.9499%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3103/3590 (86.4345%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.2629, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4018/4501 (89.2691%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4045/4501 (89.8689%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0053, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4571/5232 (87.3662%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4580/5232 (87.5382%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1404, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3298/3672 (89.8148%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3308/3672 (90.0871%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9727, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3808/4223 (90.1729%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3904/4223 (92.4461%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0703, Accuracy: 5345/10000 (53.4500%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3880/4354 (89.1135%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3665/4354 (84.1755%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.3715, Accuracy: 4944/10000 (49.4400%)
time spent on training: 256.99711060523987
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1515, Accuracy: 6950/10000 (69.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.2549, Accuracy: 7122/9900 (71.9394%)
Done in 284.08688163757324 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4622/4885 (94.6162%), train_poison_data_count: 385
Global model norm: 42.81753220881751.
Norm before scaling: 42.805723403006375. Distance: 1.5686417226925187
Total norm for 4 adversaries is: 42.805723403006375. distance: 1.5686417226925187
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0544, Accuracy: 9747/9900 (98.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4951/5305 (93.3270%), train_poison_data_count: 415
Global model norm: 42.81753220881751.
Norm before scaling: 42.80825138590398. Distance: 1.7194775515347485
Total norm for 4 adversaries is: 42.80825138590398. distance: 1.7194775515347485
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.3201, Accuracy: 9145/9900 (92.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4434/4717 (94.0004%), train_poison_data_count: 370
Global model norm: 42.81753220881751.
Norm before scaling: 42.8062723572726. Distance: 1.4981057604340893
Total norm for 4 adversaries is: 42.8062723572726. distance: 1.4981057604340893
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2240, Accuracy: 9362/9900 (94.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4721/5066 (93.1899%), train_poison_data_count: 400
Global model norm: 42.81753220881751.
Norm before scaling: 42.80977409205169. Distance: 1.6979420041805158
Total norm for 4 adversaries is: 42.80977409205169. distance: 1.6979420041805158
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1406, Accuracy: 9553/9900 (96.4949%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5116/5582 (91.6517%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4889/5582 (87.5851%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.5283, Accuracy: 4736/10000 (47.3600%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4170/4647 (89.7353%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4200/4647 (90.3809%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9000, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4055/4465 (90.8175%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4147/4465 (92.8779%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0265, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4492/5083 (88.3730%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4412/5083 (86.7991%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3157, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3962/4416 (89.7192%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4029/4416 (91.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9740, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4404/4956 (88.8620%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4408/4956 (88.9427%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2632, Accuracy: 5065/10000 (50.6500%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4007/4362 (91.8615%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3900/4362 (89.4085%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1083, Accuracy: 5210/10000 (52.1000%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3947/4356 (90.6107%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3511/4356 (80.6015%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.4403, Accuracy: 4664/10000 (46.6400%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3439/3781 (90.9548%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3252/3781 (86.0090%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2886, Accuracy: 5055/10000 (50.5500%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3301/3590 (91.9499%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3143/3590 (87.5487%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2204, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4186/4651 (90.0022%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4157/4651 (89.3786%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9597, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4217/4662 (90.4547%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4214/4662 (90.3904%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.1837, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3164/3472 (91.1290%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3194/3472 (91.9931%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9757, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4847/5424 (89.3621%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4929/5424 (90.8739%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.3256, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2950/3271 (90.1865%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0052, Accuracy: 2954/3271 (90.3088%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9955, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4501/5037 (89.3587%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4550/5037 (90.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8621, Accuracy: 5654/10000 (56.5400%)
time spent on training: 256.39701986312866
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1567, Accuracy: 6954/10000 (69.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.1324, Accuracy: 7329/9900 (74.0303%)
Done in 283.61000180244446 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4615/4885 (94.4729%), train_poison_data_count: 385
Global model norm: 42.83990056102051.
Norm before scaling: 42.8286722420346. Distance: 1.5758481360913117
Total norm for 4 adversaries is: 42.8286722420346. distance: 1.5758481360913117
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1596, Accuracy: 9525/9900 (96.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4979/5305 (93.8549%), train_poison_data_count: 415
Global model norm: 42.83990056102051.
Norm before scaling: 42.8300388914756. Distance: 1.7096119801836542
Total norm for 4 adversaries is: 42.8300388914756. distance: 1.7096119801836542
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.0869, Accuracy: 9673/9900 (97.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4433/4717 (93.9792%), train_poison_data_count: 370
Global model norm: 42.83990056102051.
Norm before scaling: 42.82943608901622. Distance: 1.570922732992373
Total norm for 4 adversaries is: 42.82943608901622. distance: 1.570922732992373
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1859, Accuracy: 9420/9900 (95.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4728/5066 (93.3281%), train_poison_data_count: 400
Global model norm: 42.83990056102051.
Norm before scaling: 42.83105636857953. Distance: 1.6781682440444443
Total norm for 4 adversaries is: 42.83105636857953. distance: 1.6781682440444443
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.3845, Accuracy: 8994/9900 (90.8485%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4415/4989 (88.4947%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4448/4989 (89.1561%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0281, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3600/4013 (89.7084%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3701/4013 (92.2253%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8108, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4639/5195 (89.2974%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4438/5195 (85.4283%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2872, Accuracy: 5032/10000 (50.3200%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3627/3969 (91.3832%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3630/3969 (91.4588%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9077, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4005/4356 (91.9421%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3809/4356 (87.4426%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.2690, Accuracy: 5128/10000 (51.2800%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4109/4441 (92.5242%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4129/4441 (92.9746%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9969, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4112/4518 (91.0137%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4121/4518 (91.2129%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9699, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3587/3911 (91.7157%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3510/3911 (89.7469%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1240, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4001/4362 (91.7240%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3999/4362 (91.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9216, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3439/3804 (90.4048%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3489/3804 (91.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0133, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3814/4223 (90.3149%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3901/4223 (92.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8598, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4156/4634 (89.6849%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4142/4634 (89.3828%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9791, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3950/4354 (90.7212%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0130, Accuracy: 3393/4354 (77.9283%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 3.1247, Accuracy: 4059/10000 (40.5900%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4540/5244 (86.5751%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4519/5244 (86.1747%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9608, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4513/5037 (89.5970%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4553/5037 (90.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9404, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3306/3704 (89.2549%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3351/3704 (90.4698%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9211, Accuracy: 5669/10000 (56.6900%)
time spent on training: 258.2885091304779
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1625, Accuracy: 6942/10000 (69.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.0449, Accuracy: 7508/9900 (75.8384%)
Done in 285.38252091407776 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4630/4885 (94.7799%), train_poison_data_count: 385
Global model norm: 42.86227005579543.
Norm before scaling: 42.84861615326684. Distance: 1.529981749681319
Total norm for 4 adversaries is: 42.84861615326684. distance: 1.529981749681319
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.2907, Accuracy: 9217/9900 (93.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4986/5305 (93.9868%), train_poison_data_count: 415
Global model norm: 42.86227005579543.
Norm before scaling: 42.84871301487654. Distance: 1.6362872226290117
Total norm for 4 adversaries is: 42.84871301487654. distance: 1.6362872226290117
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0969, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4437/4717 (94.0640%), train_poison_data_count: 370
Global model norm: 42.86227005579543.
Norm before scaling: 42.84939816206947. Distance: 1.5268649938741907
Total norm for 4 adversaries is: 42.84939816206947. distance: 1.5268649938741907
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1343, Accuracy: 9561/9900 (96.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4764/5066 (94.0387%), train_poison_data_count: 400
Global model norm: 42.86227005579543.
Norm before scaling: 42.85247335517811. Distance: 1.6582427362713972
Total norm for 4 adversaries is: 42.85247335517811. distance: 1.6582427362713972
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1075, Accuracy: 9617/9900 (97.1414%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3953/4416 (89.5154%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3993/4416 (90.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0531, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4662/5197 (89.7056%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4566/5197 (87.8584%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0570, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4459/4918 (90.6669%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4495/4918 (91.3989%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9525, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5684/6263 (90.7552%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5631/6263 (89.9090%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1687, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3289/3646 (90.2084%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3364/3646 (92.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7881, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4239/4707 (90.0574%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4275/4707 (90.8222%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0647, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4474/5063 (88.3666%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4233/5063 (83.6066%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0610, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3894/4295 (90.6636%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3717/4295 (86.5425%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0813, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4793 (90.0480%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4385/4793 (91.4876%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9328, Accuracy: 5548/10000 (55.4800%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4138/4538 (91.1855%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4186/4538 (92.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8621, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4552/5083 (89.5534%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4483/5083 (88.1959%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0870, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3259/3638 (89.5822%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3283/3638 (90.2419%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0102, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5456/6124 (89.0921%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5402/6124 (88.2103%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1804, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4214/4618 (91.2516%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4128/4618 (89.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1245, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3619/3969 (91.1817%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3566/3969 (89.8463%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9430, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3650/4158 (87.7826%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3667/4158 (88.1914%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9838, Accuracy: 5345/10000 (53.4500%)
time spent on training: 258.8051929473877
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1702, Accuracy: 6937/10000 (69.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.9426, Accuracy: 7743/9900 (78.2121%)
Done in 286.42212677001953 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4596/4885 (94.0839%), train_poison_data_count: 385
Global model norm: 42.88564264094176.
Norm before scaling: 42.873098080993636. Distance: 1.5630184839221042
Total norm for 4 adversaries is: 42.873098080993636. distance: 1.5630184839221042
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1659, Accuracy: 9533/9900 (96.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4996/5305 (94.1753%), train_poison_data_count: 415
Global model norm: 42.88564264094176.
Norm before scaling: 42.87484625519082. Distance: 1.6670177169480755
Total norm for 4 adversaries is: 42.87484625519082. distance: 1.6670177169480755
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1251, Accuracy: 9606/9900 (97.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4432/4717 (93.9580%), train_poison_data_count: 370
Global model norm: 42.88564264094176.
Norm before scaling: 42.873236172265. Distance: 1.5417852957507927
Total norm for 4 adversaries is: 42.873236172265. distance: 1.5417852957507927
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0710, Accuracy: 9706/9900 (98.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4749/5066 (93.7426%), train_poison_data_count: 400
Global model norm: 42.88564264094176.
Norm before scaling: 42.879466900144934. Distance: 1.7002622710599722
Total norm for 4 adversaries is: 42.879466900144934. distance: 1.7002622710599722
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2509, Accuracy: 9267/9900 (93.6061%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4216/4716 (89.3978%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4251/4716 (90.1399%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9842, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3992/4481 (89.0873%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3963/4481 (88.4401%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1556, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3912/4361 (89.7042%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3849/4361 (88.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1687, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4300/4793 (89.7142%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4384/4793 (91.4667%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9450, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3905/4295 (90.9197%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3833/4295 (89.2433%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0089, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4632/5244 (88.3295%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4600/5244 (87.7193%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1627, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4408/4989 (88.3544%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4441/4989 (89.0158%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9611, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4649/5197 (89.4555%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4550/5197 (87.5505%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9420, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3970/4356 (91.1387%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0109, Accuracy: 3517/4356 (80.7392%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.6613, Accuracy: 4310/10000 (43.1000%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4167/4647 (89.6708%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4257/4647 (91.6075%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9075, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3625/4013 (90.3314%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3705/4013 (92.3249%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9036, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4138/4538 (91.1855%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4183/4538 (92.1772%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8894, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4249/4707 (90.2698%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4247/4707 (90.2273%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9962, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5677/6263 (90.6435%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5627/6263 (89.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0958, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3929/4235 (92.7745%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3898/4235 (92.0425%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0319, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3509/3861 (90.8832%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3490/3861 (90.3911%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1213, Accuracy: 5330/10000 (53.3000%)
time spent on training: 259.91241002082825
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1754, Accuracy: 6930/10000 (69.3000%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.8612, Accuracy: 7907/9900 (79.8687%)
Done in 287.17329931259155 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4627/4885 (94.7185%), train_poison_data_count: 385
Global model norm: 42.90895839958714.
Norm before scaling: 42.89495936660274. Distance: 1.519120501627493
Total norm for 4 adversaries is: 42.89495936660274. distance: 1.519120501627493
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0926, Accuracy: 9666/9900 (97.6364%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5021/5305 (94.6466%), train_poison_data_count: 415
Global model norm: 42.90895839958714.
Norm before scaling: 42.89387937334781. Distance: 1.6094447741151336
Total norm for 4 adversaries is: 42.89387937334781. distance: 1.6094447741151336
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.2047, Accuracy: 9394/9900 (94.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4448/4717 (94.2972%), train_poison_data_count: 370
Global model norm: 42.90895839958714.
Norm before scaling: 42.89575902788206. Distance: 1.5079698233481538
Total norm for 4 adversaries is: 42.89575902788206. distance: 1.5079698233481538
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1409, Accuracy: 9533/9900 (96.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4757/5066 (93.9005%), train_poison_data_count: 400
Global model norm: 42.90895839958714.
Norm before scaling: 42.90062354997375. Distance: 1.68400501441209
Total norm for 4 adversaries is: 42.90062354997375. distance: 1.68400501441209
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0934, Accuracy: 9653/9900 (97.5051%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4589/5055 (90.7814%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4553/5055 (90.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0517, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3496/3828 (91.3271%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3550/3828 (92.7377%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8948, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3929/4361 (90.0940%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3651/4361 (83.7193%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.4658, Accuracy: 4895/10000 (48.9500%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3676/4013 (91.6023%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3699/4013 (92.1754%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8308, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4128/4518 (91.3679%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4173/4518 (92.3639%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8399, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4114/4558 (90.2589%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3954/4558 (86.7486%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1520, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3736/4126 (90.5477%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3810/4126 (92.3413%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8533, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4265/4679 (91.1520%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4242/4679 (90.6604%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1382, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3866/4235 (91.2869%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3811/4235 (89.9882%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0396, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4525/5037 (89.8352%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4577/5037 (90.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1371, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3275/3672 (89.1885%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3304/3672 (89.9782%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0834, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4468/4928 (90.6656%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8321, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3995/4356 (91.7126%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3648/4356 (83.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.4665, Accuracy: 4786/10000 (47.8600%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4113/4456 (92.3025%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4130/4456 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8692, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4316/4793 (90.0480%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4388/4793 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0269, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4532/5025 (90.1891%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4501/5025 (89.5721%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1155, Accuracy: 5390/10000 (53.9000%)
time spent on training: 258.7313084602356
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1790, Accuracy: 6926/10000 (69.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.7867, Accuracy: 8074/9900 (81.5556%)
Done in 285.584103345871 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4652/4885 (95.2303%), train_poison_data_count: 385
Global model norm: 42.93013748058073.
Norm before scaling: 42.91627050914446. Distance: 1.5217164319282483
Total norm for 4 adversaries is: 42.91627050914446. distance: 1.5217164319282483
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0831, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4990/5305 (94.0622%), train_poison_data_count: 415
Global model norm: 42.93013748058073.
Norm before scaling: 42.91895836695816. Distance: 1.67682911938415
Total norm for 4 adversaries is: 42.91895836695816. distance: 1.67682911938415
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1670, Accuracy: 9485/9900 (95.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4470/4717 (94.7636%), train_poison_data_count: 370
Global model norm: 42.93013748058073.
Norm before scaling: 42.915434252379555. Distance: 1.4369120017220083
Total norm for 4 adversaries is: 42.915434252379555. distance: 1.4369120017220083
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2404, Accuracy: 9310/9900 (94.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4759/5066 (93.9400%), train_poison_data_count: 400
Global model norm: 42.93013748058073.
Norm before scaling: 42.91953573667314. Distance: 1.6302421086949128
Total norm for 4 adversaries is: 42.91953573667314. distance: 1.6302421086949128
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.2549, Accuracy: 9258/9900 (93.5152%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4012/4346 (92.3148%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4036/4346 (92.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8301, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3786/4184 (90.4876%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3810/4184 (91.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9185, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4025/4356 (92.4013%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3683/4356 (84.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1274, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3293/3646 (90.3182%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3342/3646 (91.6621%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8603, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4580/5083 (90.1043%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4524/5083 (89.0026%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0215, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3973/4356 (91.2075%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3988/4356 (91.5519%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0389, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4082/4558 (89.5568%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4131/4558 (90.6319%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0965, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3739/4175 (89.5569%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3615/4175 (86.5868%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1019, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3198/3472 (92.1083%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3150/3472 (90.7258%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0729, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4033/4501 (89.6023%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4102/4501 (91.1353%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9874, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4902/5424 (90.3761%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5026/5424 (92.6622%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2865, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4030/4481 (89.9353%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3971/4481 (88.6186%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1748, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4968/5455 (91.0724%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4951/5455 (90.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0548, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4618/5232 (88.2645%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4637/5232 (88.6277%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9754, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5647/6391 (88.3586%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5545/6391 (86.7626%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2165, Accuracy: 5057/10000 (50.5700%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3451/3775 (91.4172%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3510/3775 (92.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7958, Accuracy: 5745/10000 (57.4500%)
time spent on training: 278.4890921115875
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1792, Accuracy: 6912/10000 (69.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.7377, Accuracy: 8189/9900 (82.7172%)
Done in 305.2790114879608 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4613/4885 (94.4319%), train_poison_data_count: 385
Global model norm: 42.95246850625992.
Norm before scaling: 42.937846841757796. Distance: 1.5542249902139935
Total norm for 4 adversaries is: 42.937846841757796. distance: 1.5542249902139935
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1125, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4974/5305 (93.7606%), train_poison_data_count: 415
Global model norm: 42.95246850625992.
Norm before scaling: 42.93882764959792. Distance: 1.638452235564317
Total norm for 4 adversaries is: 42.93882764959792. distance: 1.638452235564317
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.3153, Accuracy: 9129/9900 (92.2121%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4464/4717 (94.6364%), train_poison_data_count: 370
Global model norm: 42.95246850625992.
Norm before scaling: 42.93757676030257. Distance: 1.4610914669400457
Total norm for 4 adversaries is: 42.93757676030257. distance: 1.4610914669400457
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.2130, Accuracy: 9367/9900 (94.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4762/5066 (93.9992%), train_poison_data_count: 400
Global model norm: 42.95246850625992.
Norm before scaling: 42.94130657708118. Distance: 1.6458803564508735
Total norm for 4 adversaries is: 42.94130657708118. distance: 1.6458803564508735
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0992, Accuracy: 9625/9900 (97.2222%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3671/4025 (91.2050%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3797/4025 (94.3354%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.7985, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3857/4223 (91.3332%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3879/4223 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8852, Accuracy: 5627/10000 (56.2700%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3246/3638 (89.2248%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3318/3638 (91.2040%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8031, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4452/5063 (87.9321%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4385/5063 (86.6087%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2808, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4368/4874 (89.6184%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4270/4874 (87.6077%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3327, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4303/4804 (89.5712%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4348/4804 (90.5079%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1104, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3634/4158 (87.3978%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3679/4158 (88.4800%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9749, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4147/4518 (91.7884%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4158/4518 (92.0319%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9986, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3852/4235 (90.9563%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3786/4235 (89.3979%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0133, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4378/4934 (88.7313%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4288/4934 (86.9072%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1386, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5636/6391 (88.1865%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5511/6391 (86.2306%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1810, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3923/4295 (91.3388%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3815/4295 (88.8242%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9152, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3480/3756 (92.6518%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3538/3756 (94.1960%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9484, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3966/4481 (88.5070%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4004/4481 (89.3551%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0464, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3743/4175 (89.6527%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3691/4175 (88.4072%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0621, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3289/3590 (91.6156%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3202/3590 (89.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2023, Accuracy: 5185/10000 (51.8500%)
time spent on training: 247.6811637878418
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1795, Accuracy: 6908/10000 (69.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.6780, Accuracy: 8320/9900 (84.0404%)
Done in 274.3936207294464 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4613/4885 (94.4319%), train_poison_data_count: 385
Global model norm: 42.97432918324613.
Norm before scaling: 42.96283055817334. Distance: 1.5627721168077113
Total norm for 4 adversaries is: 42.96283055817334. distance: 1.5627721168077113
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0749, Accuracy: 9693/9900 (97.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5015/5305 (94.5335%), train_poison_data_count: 415
Global model norm: 42.97432918324613.
Norm before scaling: 42.9616599264136. Distance: 1.6596391657961471
Total norm for 4 adversaries is: 42.9616599264136. distance: 1.6596391657961471
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1237, Accuracy: 9587/9900 (96.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4479/4717 (94.9544%), train_poison_data_count: 370
Global model norm: 42.97432918324613.
Norm before scaling: 42.95776137900243. Distance: 1.4381350897311136
Total norm for 4 adversaries is: 42.95776137900243. distance: 1.4381350897311136
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1053, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4774/5066 (94.2361%), train_poison_data_count: 400
Global model norm: 42.97432918324613.
Norm before scaling: 42.96207334491377. Distance: 1.5891751469807764
Total norm for 4 adversaries is: 42.96207334491377. distance: 1.5891751469807764
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1281, Accuracy: 9546/9900 (96.4242%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3481/3828 (90.9352%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3545/3828 (92.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8459, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3565/3911 (91.1532%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3471/3911 (88.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1509, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4034/4362 (92.4805%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4104/4362 (94.0853%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8681, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4675/5197 (89.9557%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4675/5197 (89.9557%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2288, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4325/4679 (92.4343%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4172/4679 (89.1644%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1872, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4366/4793 (91.0912%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4412/4793 (92.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9377, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4567/5116 (89.2690%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4543/5116 (88.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1016, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4096/4625 (88.5622%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3982/4625 (86.0973%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1047, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4197/4618 (90.8835%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4101/4618 (88.8047%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1741, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2916/3271 (89.1470%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2937/3271 (89.7891%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0211, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3751/4175 (89.8443%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3766/4175 (90.2036%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0379, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3237/3616 (89.5188%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3292/3616 (91.0398%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7926, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4013/4481 (89.5559%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3985/4481 (88.9310%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1307, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3931/4368 (89.9954%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3843/4368 (87.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9859, Accuracy: 5371/10000 (53.7100%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5192/5740 (90.4530%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5165/5740 (89.9826%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0669, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4201/4647 (90.4024%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4182/4647 (89.9935%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9532, Accuracy: 5507/10000 (55.0700%)
time spent on training: 258.2515025138855
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1789, Accuracy: 6910/10000 (69.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.6050, Accuracy: 8449/9900 (85.3434%)
Done in 285.40001130104065 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4633/4885 (94.8414%), train_poison_data_count: 385
Global model norm: 42.99556265712923.
Norm before scaling: 42.98045153168109. Distance: 1.5317469977537295
Total norm for 4 adversaries is: 42.98045153168109. distance: 1.5317469977537295
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0406, Accuracy: 9785/9900 (98.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4992/5305 (94.0999%), train_poison_data_count: 415
Global model norm: 42.99556265712923.
Norm before scaling: 42.98211297892197. Distance: 1.659536663449215
Total norm for 4 adversaries is: 42.98211297892197. distance: 1.659536663449215
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1410, Accuracy: 9547/9900 (96.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4457/4717 (94.4880%), train_poison_data_count: 370
Global model norm: 42.99556265712923.
Norm before scaling: 42.980930091873304. Distance: 1.485133890608745
Total norm for 4 adversaries is: 42.980930091873304. distance: 1.485133890608745
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0092, Accuracy: 9871/9900 (99.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4770/5066 (94.1571%), train_poison_data_count: 400
Global model norm: 42.99556265712923.
Norm before scaling: 42.98361390638443. Distance: 1.6159631637161247
Total norm for 4 adversaries is: 42.98361390638443. distance: 1.6159631637161247
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1251, Accuracy: 9585/9900 (96.8182%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4999/5591 (89.4116%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4959/5591 (88.6961%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1912, Accuracy: 5169/10000 (51.6900%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4442/4956 (89.6287%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4457/4956 (89.9314%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0608, Accuracy: 5421/10000 (54.2100%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4050/4511 (89.7805%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4057/4511 (89.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0913, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3649/4013 (90.9295%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3719/4013 (92.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8445, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3262/3590 (90.8635%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3166/3590 (88.1894%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1179, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4340/4793 (90.5487%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4421/4793 (92.2387%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9466, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3472/3804 (91.2723%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3493/3804 (91.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8185, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3491/3837 (90.9825%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3526/3837 (91.8947%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8853, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3945/4361 (90.4609%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3844/4361 (88.1449%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3249, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4531/5063 (89.4924%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4452/5063 (87.9321%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0815, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3937/4368 (90.1328%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3941/4368 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0994, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4283/4679 (91.5367%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4342/4679 (92.7976%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9953, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4679/5265 (88.8699%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4645/5265 (88.2241%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0359, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4262/4767 (89.4063%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4190/4767 (87.8960%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1612, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5227/5902 (88.5632%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5081/5902 (86.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2033, Accuracy: 5243/10000 (52.4300%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3852/4223 (91.2148%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3907/4223 (92.5172%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9791, Accuracy: 5441/10000 (54.4100%)
time spent on training: 261.82128071784973
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1914, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.5287, Accuracy: 8618/9900 (87.0505%)
Done in 288.90677404403687 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4663/4885 (95.4555%), train_poison_data_count: 385
Global model norm: 43.01828820533411.
Norm before scaling: 43.00209217748161. Distance: 1.472218253572181
Total norm for 4 adversaries is: 43.00209217748161. distance: 1.472218253572181
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0684, Accuracy: 9713/9900 (98.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5041/5305 (95.0236%), train_poison_data_count: 415
Global model norm: 43.01828820533411.
Norm before scaling: 43.00140094692774. Distance: 1.5619778332816403
Total norm for 4 adversaries is: 43.00140094692774. distance: 1.5619778332816403
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0937, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4452/4717 (94.3820%), train_poison_data_count: 370
Global model norm: 43.01828820533411.
Norm before scaling: 43.00441843442151. Distance: 1.4849063123183615
Total norm for 4 adversaries is: 43.00441843442151. distance: 1.4849063123183615
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.2162, Accuracy: 9356/9900 (94.5051%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4780/5066 (94.3545%), train_poison_data_count: 400
Global model norm: 43.01828820533411.
Norm before scaling: 43.008287207870616. Distance: 1.6167620407890133
Total norm for 4 adversaries is: 43.008287207870616. distance: 1.6167620407890133
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1487, Accuracy: 9528/9900 (96.2424%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3456/3797 (91.0192%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3477/3797 (91.5723%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8411, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3538/3861 (91.6343%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3535/3861 (91.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9494, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4304/4707 (91.4383%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4251/4707 (90.3123%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9646, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4137/4518 (91.5671%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4115/4518 (91.0801%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9701, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3648/4013 (90.9046%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3715/4013 (92.5741%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9275, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4665/5167 (90.2845%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4664/5167 (90.2651%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2129, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3569/3969 (89.9219%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3627/3969 (91.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9776, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4070/4441 (91.6460%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4061/4441 (91.4434%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1146, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4119/4558 (90.3686%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4028/4558 (88.3721%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1353, Accuracy: 5204/10000 (52.0400%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4087/4465 (91.5342%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4103/4465 (91.8925%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8855, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3191/3638 (87.7130%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3336/3638 (91.6987%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7782, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4164/4538 (91.7585%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4187/4538 (92.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8772, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5152/5740 (89.7561%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5203/5740 (90.6446%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1533, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3497/3837 (91.1389%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3551/3837 (92.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.7839, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3947/4361 (90.5068%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3846/4361 (88.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1082, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4399/4793 (91.7797%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4394/4793 (91.6754%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2618, Accuracy: 5103/10000 (51.0300%)
time spent on training: 259.27551221847534
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1905, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.4939, Accuracy: 8695/9900 (87.8283%)
Done in 285.9111409187317 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4674/4885 (95.6807%), train_poison_data_count: 385
Global model norm: 43.03889728707626.
Norm before scaling: 43.023077870977424. Distance: 1.4568875730308293
Total norm for 4 adversaries is: 43.023077870977424. distance: 1.4568875730308293
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.2435, Accuracy: 9310/9900 (94.0404%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5042/5305 (95.0424%), train_poison_data_count: 415
Global model norm: 43.03889728707626.
Norm before scaling: 43.02090017145736. Distance: 1.5638425781021192
Total norm for 4 adversaries is: 43.02090017145736. distance: 1.5638425781021192
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0640, Accuracy: 9722/9900 (98.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4490/4717 (95.1876%), train_poison_data_count: 370
Global model norm: 43.03889728707626.
Norm before scaling: 43.02267355073514. Distance: 1.4209043941831758
Total norm for 4 adversaries is: 43.02267355073514. distance: 1.4209043941831758
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0634, Accuracy: 9728/9900 (98.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4763/5066 (94.0189%), train_poison_data_count: 400
Global model norm: 43.03889728707626.
Norm before scaling: 43.028586178442175. Distance: 1.6358001971989886
Total norm for 4 adversaries is: 43.028586178442175. distance: 1.6358001971989886
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1100, Accuracy: 9609/9900 (97.0606%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4252/4767 (89.1966%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4198/4767 (88.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3079, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4120/4441 (92.7719%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4131/4441 (93.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0064, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4029/4356 (92.4931%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3773/4356 (86.6162%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2106, Accuracy: 5061/10000 (50.6100%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5689/6391 (89.0158%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5561/6391 (87.0130%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2965, Accuracy: 4947/10000 (49.4700%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3806/4184 (90.9656%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3839/4184 (91.7543%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8777, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4031/4346 (92.7520%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4072/4346 (93.6954%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8044, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4496/5037 (89.2595%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4584/5037 (91.0066%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9664, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4208/4634 (90.8071%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4209/4634 (90.8287%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8759, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4364/4934 (88.4475%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4321/4934 (87.5760%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0801, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4911/5424 (90.5420%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4900/5424 (90.3392%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3087, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3492/3781 (92.3565%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3447/3781 (91.1664%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1147, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3493/3861 (90.4688%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3459/3861 (89.5882%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0451, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4666/5055 (92.3046%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4648/5055 (91.9486%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9896, Accuracy: 5547/10000 (55.4700%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4097/4433 (92.4205%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4078/4433 (91.9919%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9452, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4671/5167 (90.4006%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4651/5167 (90.0135%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2153, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3312/3590 (92.2563%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3058/3590 (85.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1217, Accuracy: 5271/10000 (52.7100%)
time spent on training: 264.58237195014954
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1863, Accuracy: 6881/10000 (68.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.4638, Accuracy: 8759/9900 (88.4747%)
Done in 291.95581459999084 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4658/4885 (95.3531%), train_poison_data_count: 385
Global model norm: 43.061265459898095.
Norm before scaling: 43.043357104439615. Distance: 1.44140625
Total norm for 4 adversaries is: 43.043357104439615. distance: 1.44140625
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1593, Accuracy: 9495/9900 (95.9091%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5030/5305 (94.8162%), train_poison_data_count: 415
Global model norm: 43.061265459898095.
Norm before scaling: 43.045522324482256. Distance: 1.5802143731333964
Total norm for 4 adversaries is: 43.045522324482256. distance: 1.5802143731333964
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1111, Accuracy: 9615/9900 (97.1212%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4478/4717 (94.9332%), train_poison_data_count: 370
Global model norm: 43.061265459898095.
Norm before scaling: 43.04236449826569. Distance: 1.384646347353827
Total norm for 4 adversaries is: 43.04236449826569. distance: 1.384646347353827
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1109, Accuracy: 9613/9900 (97.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4803/5066 (94.8085%), train_poison_data_count: 400
Global model norm: 43.061265459898095.
Norm before scaling: 43.04690902902466. Distance: 1.5372745565728905
Total norm for 4 adversaries is: 43.04690902902466. distance: 1.5372745565728905
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0521, Accuracy: 9753/9900 (98.5152%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3946/4368 (90.3388%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3911/4368 (89.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0990, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3486/3828 (91.0658%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3506/3828 (91.5883%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8732, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4039/4356 (92.7227%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3805/4356 (87.3508%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1950, Accuracy: 5050/10000 (50.5000%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3491/3861 (90.4170%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3466/3861 (89.7695%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0002, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3183/3472 (91.6763%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3210/3472 (92.4539%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9097, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4156/4538 (91.5822%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4174/4538 (91.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0854, Accuracy: 5315/10000 (53.1500%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4910/5392 (91.0608%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4831/5392 (89.5957%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0683, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3916/4295 (91.1758%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3846/4295 (89.5460%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0630, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3858/4235 (91.0980%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3852/4235 (90.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0890, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4125/4456 (92.5718%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4109/4456 (92.2127%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1543, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4743/5265 (90.0855%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4592/5265 (87.2175%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0892, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4102/4441 (92.3666%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4158/4441 (93.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0328, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3701/4013 (92.2253%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3755/4013 (93.5709%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8360, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4082/4465 (91.4222%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4069/4465 (91.1310%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9781, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5661/6263 (90.3880%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5645/6263 (90.1325%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0404, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4514/4986 (90.5335%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4541/4986 (91.0750%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0028, Accuracy: 5542/10000 (55.4200%)
time spent on training: 258.21342730522156
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1824, Accuracy: 6897/10000 (68.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.4339, Accuracy: 8827/9900 (89.1616%)
Done in 285.32872009277344 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4656/4885 (95.3122%), train_poison_data_count: 385
Global model norm: 43.08252267179378.
Norm before scaling: 43.06605034575161. Distance: 1.4710593229166242
Total norm for 4 adversaries is: 43.06605034575161. distance: 1.4710593229166242
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2142, Accuracy: 9351/9900 (94.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5019/5305 (94.6089%), train_poison_data_count: 415
Global model norm: 43.08252267179378.
Norm before scaling: 43.065545803479175. Distance: 1.5999016314308598
Total norm for 4 adversaries is: 43.065545803479175. distance: 1.5999016314308598
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.2096, Accuracy: 9396/9900 (94.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4493/4717 (95.2512%), train_poison_data_count: 370
Global model norm: 43.08252267179378.
Norm before scaling: 43.06204360697916. Distance: 1.3612896381558557
Total norm for 4 adversaries is: 43.06204360697916. distance: 1.3612896381558557
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0829, Accuracy: 9686/9900 (97.8384%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4777/5066 (94.2953%), train_poison_data_count: 400
Global model norm: 43.08252267179378.
Norm before scaling: 43.06995609661173. Distance: 1.5725948012845201
Total norm for 4 adversaries is: 43.06995609661173. distance: 1.5725948012845201
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0738, Accuracy: 9722/9900 (98.2020%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3633/4158 (87.3737%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3708/4158 (89.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9380, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4656/5167 (90.1103%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4630/5167 (89.6071%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2502, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3558/3828 (92.9467%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3611/3828 (94.3312%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9420, Accuracy: 5675/10000 (56.7500%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4285/4663 (91.8936%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4249/4663 (91.1216%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0523, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4085/4433 (92.1498%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4055/4433 (91.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8341, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3841/4184 (91.8021%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3822/4184 (91.3480%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8837, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4197/4716 (88.9949%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4199/4716 (89.0373%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1114, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3826/4223 (90.5991%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3920/4223 (92.8250%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9260, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4268/4679 (91.2161%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4047/4679 (86.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0978, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3383/3704 (91.3337%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3414/3704 (92.1706%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0271, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3505/3837 (91.3474%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3541/3837 (92.2856%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9387, Accuracy: 5550/10000 (55.5000%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3532/3861 (91.4789%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3542/3861 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8788, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4936/5424 (91.0029%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4902/5424 (90.3761%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.2156, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4166/4576 (91.0402%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4213/4576 (92.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0028, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3669/4025 (91.1553%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3784/4025 (94.0124%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8156, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3486/3775 (92.3444%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3510/3775 (92.9801%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8481, Accuracy: 5742/10000 (57.4200%)
time spent on training: 256.06786274909973
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1812, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.4153, Accuracy: 8863/9900 (89.5253%)
Done in 282.6657884120941 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4689/4885 (95.9877%), train_poison_data_count: 385
Global model norm: 43.10232363497791.
Norm before scaling: 43.084354430346146. Distance: 1.439966407887391
Total norm for 4 adversaries is: 43.084354430346146. distance: 1.439966407887391
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.1250, Accuracy: 9572/9900 (96.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5038/5305 (94.9670%), train_poison_data_count: 415
Global model norm: 43.10232363497791.
Norm before scaling: 43.08516474261689. Distance: 1.5705537373489118
Total norm for 4 adversaries is: 43.08516474261689. distance: 1.5705537373489118
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0739, Accuracy: 9698/9900 (97.9596%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4494/4717 (95.2724%), train_poison_data_count: 370
Global model norm: 43.10232363497791.
Norm before scaling: 43.08291368015718. Distance: 1.3847942053424047
Total norm for 4 adversaries is: 43.08291368015718. distance: 1.3847942053424047
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0515, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4777/5066 (94.2953%), train_poison_data_count: 400
Global model norm: 43.10232363497791.
Norm before scaling: 43.08975150276818. Distance: 1.6189856368777278
Total norm for 4 adversaries is: 43.08975150276818. distance: 1.6189856368777278
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0655, Accuracy: 9729/9900 (98.2727%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4209/4576 (91.9799%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4185/4576 (91.4554%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9334, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3350/3672 (91.2309%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3364/3672 (91.6122%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8923, Accuracy: 5668/10000 (56.6800%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4284/4618 (92.7674%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4225/4618 (91.4898%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9791, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4185/4538 (92.2212%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4233/4538 (93.2790%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8834, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4550/5025 (90.5473%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4618/5025 (91.9005%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0511, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3335/3590 (92.8969%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3380/3590 (94.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8917, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4298/4707 (91.3108%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4286/4707 (91.0559%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9696, Accuracy: 5524/10000 (55.2400%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4514/4918 (91.7853%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1399, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3913/4336 (90.2445%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3932/4336 (90.6827%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0533, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5238/5902 (88.7496%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5063/5902 (85.7845%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.2744, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4175/4441 (94.0104%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4139/4441 (93.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9681, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4674/5232 (89.3349%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4687/5232 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1169, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4388/4804 (91.3405%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4141/4804 (86.1990%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.3542, Accuracy: 5085/10000 (50.8500%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3683/3969 (92.7942%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3627/3969 (91.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9181, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4908/5392 (91.0237%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4875/5392 (90.4117%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1632, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3540/3828 (92.4765%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3569/3828 (93.2341%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.7419, Accuracy: 5888/10000 (58.8800%)
time spent on training: 262.5379922389984
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1829, Accuracy: 6894/10000 (68.9400%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.3969, Accuracy: 8904/9900 (89.9394%)
Done in 289.2476456165314 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4692/4885 (96.0491%), train_poison_data_count: 385
Global model norm: 43.12383801650124.
Norm before scaling: 43.10437686230367. Distance: 1.4163000623536401
Total norm for 4 adversaries is: 43.10437686230367. distance: 1.4163000623536401
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1178, Accuracy: 9596/9900 (96.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5051/5305 (95.2121%), train_poison_data_count: 415
Global model norm: 43.12383801650124.
Norm before scaling: 43.10341964573403. Distance: 1.5174657124600284
Total norm for 4 adversaries is: 43.10341964573403. distance: 1.5174657124600284
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0567, Accuracy: 9753/9900 (98.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4482/4717 (95.0180%), train_poison_data_count: 370
Global model norm: 43.12383801650124.
Norm before scaling: 43.105833886366966. Distance: 1.4329196270047544
Total norm for 4 adversaries is: 43.105833886366966. distance: 1.4329196270047544
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0397, Accuracy: 9791/9900 (98.8990%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4810/5066 (94.9467%), train_poison_data_count: 400
Global model norm: 43.12383801650124.
Norm before scaling: 43.10497581984808. Distance: 1.5246029039773878
Total norm for 4 adversaries is: 43.10497581984808. distance: 1.5246029039773878
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0423, Accuracy: 9769/9900 (98.6768%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4653/5232 (88.9335%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4658/5232 (89.0291%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9824, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4410/4956 (88.9831%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4399/4956 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1517, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4505/5063 (88.9789%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4498/5063 (88.8406%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1250, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3742/4025 (92.9689%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3733/4025 (92.7453%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7725, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4121/4441 (92.7944%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4131/4441 (93.0196%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1259, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4123/4625 (89.1459%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4120/4625 (89.0811%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0809, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4969/5591 (88.8750%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4958/5591 (88.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2132, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5152/5582 (92.2967%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5136/5582 (92.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0798, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5245/5902 (88.8682%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5194/5902 (88.0041%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2948, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4185/4538 (92.2212%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4211/4538 (92.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9369, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4540/5025 (90.3483%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4508/5025 (89.7114%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1344, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3869/4223 (91.6173%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3917/4223 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9941, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3983/4361 (91.3323%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3853/4361 (88.3513%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9735, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3940/4354 (90.4915%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0117, Accuracy: 3442/4354 (79.0537%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.4244, Accuracy: 4790/10000 (47.9000%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3334/3672 (90.7952%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3341/3672 (90.9858%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9298, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4001/4356 (91.8503%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3700/4356 (84.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.5069, Accuracy: 4764/10000 (47.6400%)
time spent on training: 262.8025403022766
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1943, Accuracy: 6865/10000 (68.6500%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.3518, Accuracy: 9008/9900 (90.9899%)
Done in 290.5378098487854 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4688/4885 (95.9672%), train_poison_data_count: 385
Global model norm: 43.146682728441014.
Norm before scaling: 43.12947497162613. Distance: 1.4149976978350671
Total norm for 4 adversaries is: 43.12947497162613. distance: 1.4149976978350671
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0690, Accuracy: 9717/9900 (98.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5036/5305 (94.9293%), train_poison_data_count: 415
Global model norm: 43.146682728441014.
Norm before scaling: 43.129053251549585. Distance: 1.5549092350317466
Total norm for 4 adversaries is: 43.129053251549585. distance: 1.5549092350317466
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1318, Accuracy: 9561/9900 (96.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4497/4717 (95.3360%), train_poison_data_count: 370
Global model norm: 43.146682728441014.
Norm before scaling: 43.1276805099912. Distance: 1.375136455353979
Total norm for 4 adversaries is: 43.1276805099912. distance: 1.375136455353979
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0713, Accuracy: 9703/9900 (98.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4821/5066 (95.1638%), train_poison_data_count: 400
Global model norm: 43.146682728441014.
Norm before scaling: 43.1321693542433. Distance: 1.5190423409372698
Total norm for 4 adversaries is: 43.1321693542433. distance: 1.5190423409372698
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1646, Accuracy: 9485/9900 (95.8081%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3535/3828 (92.3459%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3587/3828 (93.7043%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.7755, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3918/4235 (92.5148%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3784/4235 (89.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1406, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3336/3704 (90.0648%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3411/3704 (92.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8157, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3734/4046 (92.2887%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3688/4046 (91.1518%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0109, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4508/4928 (91.4773%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4497/4928 (91.2541%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0143, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5190/5740 (90.4181%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5161/5740 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1473, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4559/5083 (89.6911%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4531/5083 (89.1403%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3384, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4167/4576 (91.0621%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4155/4576 (90.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0089, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4246/4647 (91.3708%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4250/4647 (91.4569%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9853, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4954/5424 (91.3348%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4950/5424 (91.2611%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2436, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4130/4503 (91.7166%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4081/4503 (90.6285%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9537, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5686/6391 (88.9689%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5533/6391 (86.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3973, Accuracy: 4815/10000 (48.1500%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4053/4511 (89.8470%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4094/4511 (90.7559%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9133, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4156/4456 (93.2675%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4174/4456 (93.6715%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8552, Accuracy: 5805/10000 (58.0500%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4362/4804 (90.7993%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4189/4804 (87.1982%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2071, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3455/3804 (90.8254%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3541/3804 (93.0862%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8615, Accuracy: 5762/10000 (57.6200%)
time spent on training: 263.3782088756561
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1938, Accuracy: 6884/10000 (68.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.3409, Accuracy: 9020/9900 (91.1111%)
Done in 290.013934135437 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4692/4885 (96.0491%), train_poison_data_count: 385
Global model norm: 43.16804492375191.
Norm before scaling: 43.14732070684908. Distance: 1.3801149252707023
Total norm for 4 adversaries is: 43.14732070684908. distance: 1.3801149252707023
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1956, Accuracy: 9408/9900 (95.0303%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5040/5305 (95.0047%), train_poison_data_count: 415
Global model norm: 43.16804492375191.
Norm before scaling: 43.14906201453718. Distance: 1.523372237935062
Total norm for 4 adversaries is: 43.14906201453718. distance: 1.523372237935062
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0763, Accuracy: 9694/9900 (97.9192%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4495/4717 (95.2936%), train_poison_data_count: 370
Global model norm: 43.16804492375191.
Norm before scaling: 43.14960518630935. Distance: 1.4243272866613903
Total norm for 4 adversaries is: 43.14960518630935. distance: 1.4243272866613903
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0751, Accuracy: 9690/9900 (97.8788%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4810/5066 (94.9467%), train_poison_data_count: 400
Global model norm: 43.16804492375191.
Norm before scaling: 43.15119081270745. Distance: 1.5170815145007912
Total norm for 4 adversaries is: 43.15119081270745. distance: 1.5170815145007912
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0986, Accuracy: 9641/9900 (97.3838%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4535/4928 (92.0252%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4481/4928 (90.9294%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9152, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4521/5037 (89.7558%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4564/5037 (90.6095%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0027, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4975/5392 (92.2663%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4768/5392 (88.4273%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1299, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4108/4501 (91.2686%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4029/4501 (89.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0851, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3451/3804 (90.7203%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3502/3804 (92.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0155, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3535/3837 (92.1293%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3551/3837 (92.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8765, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4536/5063 (89.5912%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4414/5063 (87.1815%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2453, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4070/4481 (90.8279%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3988/4481 (88.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1235, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4117/4518 (91.1244%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4156/4518 (91.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9248, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3281/3638 (90.1869%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3348/3638 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9205, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4268/4663 (91.5291%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4283/4663 (91.8507%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0243, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4101/4625 (88.6703%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4087/4625 (88.3676%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0823, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4757/5197 (91.5336%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4594/5197 (88.3972%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0860, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4593/5083 (90.3600%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4479/5083 (88.1173%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.2116, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3586/3828 (93.6782%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3592/3828 (93.8349%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8911, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3367/3704 (90.9017%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3372/3704 (91.0367%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9402, Accuracy: 5649/10000 (56.4900%)
time spent on training: 255.9745147228241
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1916, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.3358, Accuracy: 9038/9900 (91.2929%)
Done in 282.63667368888855 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4673/4885 (95.6602%), train_poison_data_count: 385
Global model norm: 43.18934709101814.
Norm before scaling: 43.17111862574836. Distance: 1.4409883715274878
Total norm for 4 adversaries is: 43.17111862574836. distance: 1.4409883715274878
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1326, Accuracy: 9573/9900 (96.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5038/5305 (94.9670%), train_poison_data_count: 415
Global model norm: 43.18934709101814.
Norm before scaling: 43.16784839166327. Distance: 1.5214383041203574
Total norm for 4 adversaries is: 43.16784839166327. distance: 1.5214383041203574
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0439, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4509/4717 (95.5904%), train_poison_data_count: 370
Global model norm: 43.18934709101814.
Norm before scaling: 43.16960866517888. Distance: 1.3644874723508653
Total norm for 4 adversaries is: 43.16960866517888. distance: 1.3644874723508653
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1062, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4821/5066 (95.1638%), train_poison_data_count: 400
Global model norm: 43.18934709101814.
Norm before scaling: 43.17445505546002. Distance: 1.536151049215294
Total norm for 4 adversaries is: 43.17445505546002. distance: 1.536151049215294
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1087, Accuracy: 9627/9900 (97.2424%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3561/3861 (92.2300%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3539/3861 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8295, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3818/4184 (91.2524%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3765/4184 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9593, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4530/5037 (89.9345%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4555/5037 (90.4308%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9888, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4750/5197 (91.3989%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4628/5197 (89.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1136, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4610/5025 (91.7413%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4583/5025 (91.2040%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0994, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4651/5116 (90.9109%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4540/5116 (88.7412%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0998, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4048/4481 (90.3370%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2331, Accuracy: 5146/10000 (51.4600%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4250/4576 (92.8759%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4233/4576 (92.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8556, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4701/5232 (89.8509%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4687/5232 (89.5833%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1659, Accuracy: 5292/10000 (52.9200%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3955/4354 (90.8360%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3842/4354 (88.2407%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3987, Accuracy: 4941/10000 (49.4100%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2947/3271 (90.0948%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0069, Accuracy: 2861/3271 (87.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1735, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4961/5455 (90.9441%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4917/5455 (90.1375%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0298, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3791/4126 (91.8808%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3804/4126 (92.1958%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9798, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3504/3797 (92.2834%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3484/3797 (91.7566%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9279, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3387/3704 (91.4417%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3382/3704 (91.3067%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9472, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4405/4934 (89.2785%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0101, Accuracy: 4002/4934 (81.1107%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.3751, Accuracy: 4784/10000 (47.8400%)
time spent on training: 261.18816113471985
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1992, Accuracy: 6878/10000 (68.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.3201, Accuracy: 9063/9900 (91.5455%)
Done in 287.91368889808655 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4666/4885 (95.5169%), train_poison_data_count: 385
Global model norm: 43.21081814415807.
Norm before scaling: 43.19167598071922. Distance: 1.4126433105686258
Total norm for 4 adversaries is: 43.19167598071922. distance: 1.4126433105686258
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1434, Accuracy: 9540/9900 (96.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.21081814415807.
Norm before scaling: 43.19001411594974. Distance: 1.4515708077216598
Total norm for 4 adversaries is: 43.19001411594974. distance: 1.4515708077216598
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1861, Accuracy: 9447/9900 (95.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4495/4717 (95.2936%), train_poison_data_count: 370
Global model norm: 43.21081814415807.
Norm before scaling: 43.18937959459044. Distance: 1.3571008975132206
Total norm for 4 adversaries is: 43.18937959459044. distance: 1.3571008975132206
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0570, Accuracy: 9751/9900 (98.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4839/5066 (95.5191%), train_poison_data_count: 400
Global model norm: 43.21081814415807.
Norm before scaling: 43.18961418486509. Distance: 1.4333191486514332
Total norm for 4 adversaries is: 43.18961418486509. distance: 1.4333191486514332
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0647, Accuracy: 9731/9900 (98.2929%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4256/4618 (92.1611%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4084/4618 (88.4366%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1456, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4163/4625 (90.0108%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4094/4625 (88.5189%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1698, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5192/5740 (90.4530%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5158/5740 (89.8606%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1149, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3997/4416 (90.5118%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3990/4416 (90.3533%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0138, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3763/4126 (91.2021%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3847/4126 (93.2380%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8211, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3253/3616 (89.9613%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3309/3616 (91.5100%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8134, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3693/4158 (88.8167%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3685/4158 (88.6243%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9375, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4050/4346 (93.1891%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4051/4346 (93.2121%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8708, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4394/4874 (90.1518%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4348/4874 (89.2080%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3566, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4667/5265 (88.6420%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4690/5265 (89.0788%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9124, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3722/4025 (92.4720%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3741/4025 (92.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.7852, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4224/4651 (90.8192%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4240/4651 (91.1632%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0518, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3550/3837 (92.5202%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3583/3837 (93.3802%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8553, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3269/3638 (89.8571%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3331/3638 (91.5613%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8780, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3195/3472 (92.0219%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9675, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4138/4456 (92.8636%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4133/4456 (92.7513%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9106, Accuracy: 5665/10000 (56.6500%)
time spent on training: 256.49951362609863
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 4 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1962, Accuracy: 6890/10000 (68.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.3206, Accuracy: 9059/9900 (91.5051%)
Done in 283.470370054245 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4698/4885 (96.1720%), train_poison_data_count: 385
Global model norm: 43.231201320089696.
Norm before scaling: 43.210202291024395. Distance: 1.379635021209612
Total norm for 4 adversaries is: 43.210202291024395. distance: 1.379635021209612
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1068, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5033/5305 (94.8728%), train_poison_data_count: 415
Global model norm: 43.231201320089696.
Norm before scaling: 43.21442833598809. Distance: 1.6000209926181743
Total norm for 4 adversaries is: 43.21442833598809. distance: 1.6000209926181743
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1134, Accuracy: 9597/9900 (96.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4502/4717 (95.4420%), train_poison_data_count: 370
Global model norm: 43.231201320089696.
Norm before scaling: 43.212123271788556. Distance: 1.385092671113719
Total norm for 4 adversaries is: 43.212123271788556. distance: 1.385092671113719
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0428, Accuracy: 9786/9900 (98.8485%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4822/5066 (95.1836%), train_poison_data_count: 400
Global model norm: 43.231201320089696.
Norm before scaling: 43.21353570316539. Distance: 1.5125341458840558
Total norm for 4 adversaries is: 43.21353570316539. distance: 1.5125341458840558
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1248, Accuracy: 9595/9900 (96.9192%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4936/5424 (91.0029%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4982/5424 (91.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2174, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4570/4986 (91.6566%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4516/4986 (90.5736%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8916, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4716/5167 (91.2715%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4674/5167 (90.4587%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2300, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4244/4716 (89.9915%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4200/4716 (89.0585%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2069, Accuracy: 5162/10000 (51.6200%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3971/4368 (90.9112%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3903/4368 (89.3544%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9699, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4015/4356 (92.1717%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3749/4356 (86.0652%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2579, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4411/4804 (91.8193%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4220/4804 (87.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.2678, Accuracy: 5181/10000 (51.8100%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4082/4481 (91.0957%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3986/4481 (88.9534%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0621, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3688/4025 (91.6273%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3758/4025 (93.3665%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9710, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4590/5017 (91.4889%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4513/5017 (89.9542%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0300, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3288/3616 (90.9292%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3340/3616 (92.3673%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8158, Accuracy: 5898/10000 (58.9800%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3845/4184 (91.8977%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3797/4184 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8922, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4669/5195 (89.8749%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4429/5195 (85.2551%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1164, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3969/4361 (91.0112%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3821/4361 (87.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0068, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3523/3756 (93.7966%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3545/3756 (94.3823%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9587, Accuracy: 5658/10000 (56.5800%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5029/5591 (89.9481%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4944/5591 (88.4278%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.3334, Accuracy: 5022/10000 (50.2200%)
time spent on training: 262.08163952827454
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1961, Accuracy: 6887/10000 (68.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.3066, Accuracy: 9092/9900 (91.8384%)
Done in 288.98850750923157 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4674/4885 (95.6807%), train_poison_data_count: 385
Global model norm: 43.25290983256936.
Norm before scaling: 43.23311430895954. Distance: 1.4154650229360652
Total norm for 4 adversaries is: 43.23311430895954. distance: 1.4154650229360652
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0762, Accuracy: 9699/9900 (97.9697%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5083/5305 (95.8153%), train_poison_data_count: 415
Global model norm: 43.25290983256936.
Norm before scaling: 43.23071705929636. Distance: 1.4739465701798675
Total norm for 4 adversaries is: 43.23071705929636. distance: 1.4739465701798675
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0879, Accuracy: 9652/9900 (97.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4506/4717 (95.5268%), train_poison_data_count: 370
Global model norm: 43.25290983256936.
Norm before scaling: 43.233204662059954. Distance: 1.3563911751255595
Total norm for 4 adversaries is: 43.233204662059954. distance: 1.3563911751255595
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1114, Accuracy: 9626/9900 (97.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4834/5066 (95.4205%), train_poison_data_count: 400
Global model norm: 43.25290983256936.
Norm before scaling: 43.23553542443415. Distance: 1.5099100337479772
Total norm for 4 adversaries is: 43.23553542443415. distance: 1.5099100337479772
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0813, Accuracy: 9697/9900 (97.9495%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3825/4175 (91.6168%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3826/4175 (91.6407%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8680, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4932/5455 (90.4125%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4821/5455 (88.3776%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1355, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3398/3704 (91.7387%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3431/3704 (92.6296%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8551, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4462/4989 (89.4368%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4498/4989 (90.1583%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9285, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4466/4928 (90.6250%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4495/4928 (91.2135%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0265, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3516/3804 (92.4290%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3513/3804 (92.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0568, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3968/4336 (91.5129%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3916/4336 (90.3137%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9753, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3720/4046 (91.9427%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3723/4046 (92.0168%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8071, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4383/4793 (91.4459%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4391/4793 (91.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2022, Accuracy: 5295/10000 (52.9500%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3490/3756 (92.9180%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3516/3756 (93.6102%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8781, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5667/6391 (88.6716%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5527/6391 (86.4810%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.2946, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3314/3672 (90.2505%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3305/3672 (90.0054%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0047, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4157/4558 (91.2023%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4085/4558 (89.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0709, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4227/4576 (92.3733%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4189/4576 (91.5428%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0066, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4159/4456 (93.3348%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4130/4456 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9418, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4055/4356 (93.0900%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3847/4356 (88.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1491, Accuracy: 5318/10000 (53.1800%)
time spent on training: 246.67585730552673
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1961, Accuracy: 6875/10000 (68.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.2768, Accuracy: 9162/9900 (92.5455%)
Done in 269.7860794067383 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4689/4885 (95.9877%), train_poison_data_count: 385
Global model norm: 43.27381620501377.
Norm before scaling: 43.253652076659954. Distance: 1.4323997410545766
Total norm for 4 adversaries is: 43.253652076659954. distance: 1.4323997410545766
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0287, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5054/5305 (95.2686%), train_poison_data_count: 415
Global model norm: 43.27381620501377.
Norm before scaling: 43.252994499839254. Distance: 1.4954873392378414
Total norm for 4 adversaries is: 43.252994499839254. distance: 1.4954873392378414
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1432, Accuracy: 9548/9900 (96.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4508/4717 (95.5692%), train_poison_data_count: 370
Global model norm: 43.27381620501377.
Norm before scaling: 43.25110355799462. Distance: 1.3415011728390385
Total norm for 4 adversaries is: 43.25110355799462. distance: 1.3415011728390385
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1464, Accuracy: 9520/9900 (96.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4848/5066 (95.6968%), train_poison_data_count: 400
Global model norm: 43.27381620501377.
Norm before scaling: 43.253612565888645. Distance: 1.436701013518851
Total norm for 4 adversaries is: 43.253612565888645. distance: 1.436701013518851
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0843, Accuracy: 9664/9900 (97.6162%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4637/5116 (90.6372%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4573/5116 (89.3862%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1103, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5160/5582 (92.4400%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5029/5582 (90.0932%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1660, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4440/4928 (90.0974%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4414/4928 (89.5698%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0689, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3796/4126 (92.0019%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3809/4126 (92.3170%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8243, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3706/4158 (89.1294%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3727/4158 (89.6344%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1228, Accuracy: 5120/10000 (51.2000%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4555/5063 (89.9664%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4328/5063 (85.4829%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1620, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5432/6124 (88.7002%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5388/6124 (87.9817%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1952, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4020/4354 (92.3289%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0102, Accuracy: 3555/4354 (81.6491%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.4477, Accuracy: 4707/10000 (47.0700%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4603/5025 (91.6020%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4612/5025 (91.7811%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9805, Accuracy: 5554/10000 (55.5400%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4332/4679 (92.5839%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3901/4679 (83.3725%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2159, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4376/4793 (91.2998%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4402/4793 (91.8423%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9769, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4181/4518 (92.5409%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4185/4518 (92.6295%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9423, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4727/5167 (91.4844%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4719/5167 (91.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2295, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4099/4433 (92.4656%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4106/4433 (92.6235%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8555, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4123/4503 (91.5612%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4037/4503 (89.6513%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0134, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4304/4707 (91.4383%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4281/4707 (90.9496%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0730, Accuracy: 5306/10000 (53.0600%)
time spent on training: 237.57572054862976
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1951, Accuracy: 6900/10000 (69.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.2661, Accuracy: 9190/9900 (92.8283%)
Done in 261.2216958999634 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4672/4885 (95.6397%), train_poison_data_count: 385
Global model norm: 43.29729649515155.
Norm before scaling: 43.27636056542951. Distance: 1.4172780269826462
Total norm for 4 adversaries is: 43.27636056542951. distance: 1.4172780269826462
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0293, Accuracy: 9830/9900 (99.2929%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5057/5305 (95.3252%), train_poison_data_count: 415
Global model norm: 43.29729649515155.
Norm before scaling: 43.27632671682709. Distance: 1.502679973873957
Total norm for 4 adversaries is: 43.27632671682709. distance: 1.502679973873957
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1209, Accuracy: 9588/9900 (96.8485%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4504/4717 (95.4844%), train_poison_data_count: 370
Global model norm: 43.29729649515155.
Norm before scaling: 43.27645082823986. Distance: 1.3755386337906097
Total norm for 4 adversaries is: 43.27645082823986. distance: 1.3755386337906097
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0837, Accuracy: 9680/9900 (97.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4843/5066 (95.5981%), train_poison_data_count: 400
Global model norm: 43.29729649515155.
Norm before scaling: 43.27792885497829. Distance: 1.4519119942427223
Total norm for 4 adversaries is: 43.27792885497829. distance: 1.4519119942427223
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1318, Accuracy: 9558/9900 (96.5455%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3424/3704 (92.4406%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3411/3704 (92.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8755, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4946/5392 (91.7285%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4828/5392 (89.5401%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2673, Accuracy: 5095/10000 (50.9500%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4038/4362 (92.5722%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3984/4362 (91.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2030, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4231/4538 (93.2349%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4249/4538 (93.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8770, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3842/4184 (91.8260%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3857/4184 (92.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8966, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3500/3756 (93.1842%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3507/3756 (93.3706%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0176, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4356/4679 (93.0968%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4081/4679 (87.2195%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3814, Accuracy: 4988/10000 (49.8800%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3228/3472 (92.9724%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3266/3472 (94.0668%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.7816, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5714/6391 (89.4070%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5596/6391 (87.5606%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0582, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4730/5265 (89.8386%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4668/5265 (88.6610%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2667, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5252/5902 (88.9868%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0080, Accuracy: 4983/5902 (84.4290%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2665, Accuracy: 5118/10000 (51.1800%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5510/6124 (89.9739%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5435/6124 (88.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0933, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4618/5083 (90.8519%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4557/5083 (89.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0990, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4101/4465 (91.8477%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4119/4465 (92.2508%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9010, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3521/3804 (92.5605%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3558/3804 (93.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8368, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4535/4918 (92.2123%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4493/4918 (91.3583%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1396, Accuracy: 5307/10000 (53.0700%)
time spent on training: 256.2074365615845
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.2084, Accuracy: 6876/10000 (68.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2301, Accuracy: 9264/9900 (93.5758%)
Done in 283.608567237854 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4702/4885 (96.2538%), train_poison_data_count: 385
Global model norm: 43.31992011206421.
Norm before scaling: 43.29722883065454. Distance: 1.3602605544166142
Total norm for 4 adversaries is: 43.29722883065454. distance: 1.3602605544166142
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0365, Accuracy: 9806/9900 (99.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5065/5305 (95.4760%), train_poison_data_count: 415
Global model norm: 43.31992011206421.
Norm before scaling: 43.29832836562876. Distance: 1.5050442440081684
Total norm for 4 adversaries is: 43.29832836562876. distance: 1.5050442440081684
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0514, Accuracy: 9772/9900 (98.7071%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4513/4717 (95.6752%), train_poison_data_count: 370
Global model norm: 43.31992011206421.
Norm before scaling: 43.297186540290205. Distance: 1.3485615661054946
Total norm for 4 adversaries is: 43.297186540290205. distance: 1.3485615661054946
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0789, Accuracy: 9701/9900 (97.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4856/5066 (95.8547%), train_poison_data_count: 400
Global model norm: 43.31992011206421.
Norm before scaling: 43.299714021861625. Distance: 1.4456896315663612
Total norm for 4 adversaries is: 43.299714021861625. distance: 1.4456896315663612
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0992, Accuracy: 9626/9900 (97.2323%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4205/4538 (92.6620%)
___Train Local_ResNet_18,  epoch 111, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4188/4538 (92.2874%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9435, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4500/4989 (90.1984%)
___Train Local_ResNet_18,  epoch 111, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4491/4989 (90.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8534, Accuracy: 5644/10000 (56.4400%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4408/4793 (91.9675%)
___Train Local_ResNet_18,  epoch 111, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4451/4793 (92.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9351, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3682/4158 (88.5522%)
___Train Local_ResNet_18,  epoch 111, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3694/4158 (88.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1550, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3544/3861 (91.7897%)
___Train Local_ResNet_18,  epoch 111, local model 14, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3502/3861 (90.7019%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0041, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4665/5232 (89.1628%)
___Train Local_ResNet_18,  epoch 111, local model 22, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4573/5232 (87.4044%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1491, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4329/4663 (92.8372%)
___Train Local_ResNet_18,  epoch 111, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4327/4663 (92.7943%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.8358, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4751/5197 (91.4181%)
___Train Local_ResNet_18,  epoch 111, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4547/5197 (87.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0913, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4716/5167 (91.2715%)
___Train Local_ResNet_18,  epoch 111, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4683/5167 (90.6329%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1212, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4037/4416 (91.4176%)
___Train Local_ResNet_18,  epoch 111, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4043/4416 (91.5534%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9769, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3991/4354 (91.6628%)
___Train Local_ResNet_18,  epoch 111, local model 37, internal_epoch   2,  Average loss: 0.0105, Accuracy: 3564/4354 (81.8558%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.7595, Accuracy: 4606/10000 (46.0600%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4982/5455 (91.3291%)
___Train Local_ResNet_18,  epoch 111, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4939/5455 (90.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0581, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4145/4456 (93.0206%)
___Train Local_ResNet_18,  epoch 111, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4163/4456 (93.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.0400, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2926/3271 (89.4528%)
___Train Local_ResNet_18,  epoch 111, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2942/3271 (89.9419%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.9155, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3042/3297 (92.2657%)
___Train Local_ResNet_18,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3059/3297 (92.7813%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.7174, Accuracy: 5980/10000 (59.8000%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5029/5591 (89.9481%)
___Train Local_ResNet_18,  epoch 111, local model 32, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4947/5591 (88.4815%)
___Test Local_ResNet_18 poisoned: False, epoch: 111: Average loss: 2.1137, Accuracy: 5249/10000 (52.4900%)
time spent on training: 262.31947231292725
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 111: Average loss: 1.2135, Accuracy: 6863/10000 (68.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.2097, Accuracy: 9324/9900 (94.1818%)
Done in 289.21513199806213 sec.
Server Epoch:112 choose agents : [13, 36, 58, 71, 35, 51, 54, 61, 18, 33, 83, 63, 3, 1, 86, 75, 55, 84, 20, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4692/4885 (96.0491%), train_poison_data_count: 385
Global model norm: 43.34150110198581.
Norm before scaling: 43.31927058598243. Distance: 1.3579686662179915
Total norm for 4 adversaries is: 43.31927058598243. distance: 1.3579686662179915
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0891, Accuracy: 9675/9900 (97.7273%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5078/5305 (95.7210%), train_poison_data_count: 415
Global model norm: 43.34150110198581.
Norm before scaling: 43.31653711569419. Distance: 1.464722814018242
Total norm for 4 adversaries is: 43.31653711569419. distance: 1.464722814018242
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.0734, Accuracy: 9706/9900 (98.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4511/4717 (95.6328%), train_poison_data_count: 370
Global model norm: 43.34150110198581.
Norm before scaling: 43.31884930464018. Distance: 1.3573657566243778
Total norm for 4 adversaries is: 43.31884930464018. distance: 1.3573657566243778
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1090, Accuracy: 9606/9900 (97.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 112, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4851/5066 (95.7560%), train_poison_data_count: 400
Global model norm: 43.34150110198581.
Norm before scaling: 43.31995815342003. Distance: 1.4394363961354066
Total norm for 4 adversaries is: 43.31995815342003. distance: 1.4394363961354066
___Test Local_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.1022, Accuracy: 9624/9900 (97.2121%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4687/5167 (90.7103%)
___Train Local_ResNet_18,  epoch 112, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4734/5167 (91.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0922, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3499/3775 (92.6887%)
___Train Local_ResNet_18,  epoch 112, local model 51, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3526/3775 (93.4040%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9407, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4718/5195 (90.8181%)
___Train Local_ResNet_18,  epoch 112, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4591/5195 (88.3734%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3640, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3807/4126 (92.2685%)
___Train Local_ResNet_18,  epoch 112, local model 61, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3821/4126 (92.6079%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8938, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3579/3911 (91.5111%)
___Train Local_ResNet_18,  epoch 112, local model 18, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3519/3911 (89.9770%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0338, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4072/4433 (91.8565%)
___Train Local_ResNet_18,  epoch 112, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4071/4433 (91.8340%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7857, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch 112, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2952/3271 (90.2476%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9117, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3339/3590 (93.0084%)
___Train Local_ResNet_18,  epoch 112, local model 63, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3368/3590 (93.8162%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9090, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4528/4918 (92.0699%)
___Train Local_ResNet_18,  epoch 112, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4559/4918 (92.7003%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0166, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4565/4986 (91.5564%)
___Train Local_ResNet_18,  epoch 112, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4523/4986 (90.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.9907, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3286/3616 (90.8739%)
___Train Local_ResNet_18,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3345/3616 (92.5055%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.7794, Accuracy: 5977/10000 (59.7700%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3925/4295 (91.3853%)
___Train Local_ResNet_18,  epoch 112, local model 75, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3785/4295 (88.1257%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.2593, Accuracy: 5152/10000 (51.5200%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4033/4356 (92.5849%)
___Train Local_ResNet_18,  epoch 112, local model 55, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3677/4356 (84.4123%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.1841, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4406/4793 (91.9257%)
___Train Local_ResNet_18,  epoch 112, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4417/4793 (92.1552%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.0759, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3987/4315 (92.3986%)
___Train Local_ResNet_18,  epoch 112, local model 20, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4008/4315 (92.8853%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.8510, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4390/4804 (91.3822%)
___Train Local_ResNet_18,  epoch 112, local model 94, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4017/4804 (83.6178%)
___Test Local_ResNet_18 poisoned: False, epoch: 112: Average loss: 2.3682, Accuracy: 4826/10000 (48.2600%)
time spent on training: 258.55051255226135
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 112: Average loss: 1.2184, Accuracy: 6852/10000 (68.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 112: Average loss: 0.2075, Accuracy: 9343/9900 (94.3737%)
Done in 285.40936613082886 sec.
Server Epoch:113 choose agents : [13, 36, 58, 71, 64, 88, 94, 66, 93, 23, 19, 51, 12, 40, 76, 18, 39, 8, 49, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4694/4885 (96.0901%), train_poison_data_count: 385
Global model norm: 43.36202272321297.
Norm before scaling: 43.34134056253697. Distance: 1.3919199368537551
Total norm for 4 adversaries is: 43.34134056253697. distance: 1.3919199368537551
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1569, Accuracy: 9481/9900 (95.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5056/5305 (95.3063%), train_poison_data_count: 415
Global model norm: 43.36202272321297.
Norm before scaling: 43.33973372704602. Distance: 1.4909246403449996
Total norm for 4 adversaries is: 43.33973372704602. distance: 1.4909246403449996
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1479, Accuracy: 9534/9900 (96.3030%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4516/4717 (95.7388%), train_poison_data_count: 370
Global model norm: 43.36202272321297.
Norm before scaling: 43.34015198882051. Distance: 1.3481074807872846
Total norm for 4 adversaries is: 43.34015198882051. distance: 1.3481074807872846
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0477, Accuracy: 9778/9900 (98.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 113, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4822/5066 (95.1836%), train_poison_data_count: 400
Global model norm: 43.36202272321297.
Norm before scaling: 43.34391616316383. Distance: 1.5341926637291379
Total norm for 4 adversaries is: 43.34391616316383. distance: 1.5341926637291379
___Test Local_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.0196, Accuracy: 9848/9900 (99.4747%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4157/4503 (92.3162%)
___Train Local_ResNet_18,  epoch 113, local model 64, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4088/4503 (90.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9393, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4438/4934 (89.9473%)
___Train Local_ResNet_18,  epoch 113, local model 88, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4267/4934 (86.4816%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1108, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4454/4804 (92.7144%)
___Train Local_ResNet_18,  epoch 113, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4162/4804 (86.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3155, Accuracy: 5067/10000 (50.6700%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4178/4456 (93.7612%)
___Train Local_ResNet_18,  epoch 113, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4184/4456 (93.8959%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8193, Accuracy: 5845/10000 (58.4500%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4293/4651 (92.3027%)
___Train Local_ResNet_18,  epoch 113, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4241/4651 (91.1847%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9855, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3840/4184 (91.7782%)
___Train Local_ResNet_18,  epoch 113, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3828/4184 (91.4914%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8717, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4465/4928 (90.6047%)
___Train Local_ResNet_18,  epoch 113, local model 19, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0926, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3487/3775 (92.3709%)
___Train Local_ResNet_18,  epoch 113, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3563/3775 (94.3841%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8800, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4598/5083 (90.4584%)
___Train Local_ResNet_18,  epoch 113, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4517/5083 (88.8648%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.3806, Accuracy: 4963/10000 (49.6300%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4977/5455 (91.2374%)
___Train Local_ResNet_18,  epoch 113, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4882/5455 (89.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1874, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3289/3638 (90.4068%)
___Train Local_ResNet_18,  epoch 113, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3367/3638 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.7676, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3597/3911 (91.9714%)
___Train Local_ResNet_18,  epoch 113, local model 18, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3269/3911 (83.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1341, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3546/3837 (92.4159%)
___Train Local_ResNet_18,  epoch 113, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3561/3837 (92.8069%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.8979, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4068/4501 (90.3799%)
___Train Local_ResNet_18,  epoch 113, local model 8, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4018/4501 (89.2691%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.0284, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4754/5197 (91.4759%)
___Train Local_ResNet_18,  epoch 113, local model 49, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4667/5197 (89.8018%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 2.1386, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3539/3861 (91.6602%)
___Train Local_ResNet_18,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3525/3861 (91.2976%)
___Test Local_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.9225, Accuracy: 5674/10000 (56.7400%)
time spent on training: 258.2375581264496
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 113: Average loss: 1.2221, Accuracy: 6836/10000 (68.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 113: Average loss: 0.1973, Accuracy: 9368/9900 (94.6263%)
Done in 285.2428376674652 sec.
Server Epoch:114 choose agents : [13, 36, 58, 71, 83, 17, 76, 15, 66, 25, 74, 88, 5, 39, 85, 50, 60, 92, 84, 42].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.3831381954729.
Norm before scaling: 43.35892454720971. Distance: 1.3149814762507837
Total norm for 4 adversaries is: 43.35892454720971. distance: 1.3149814762507837
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0588, Accuracy: 9747/9900 (98.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5065/5305 (95.4760%), train_poison_data_count: 415
Global model norm: 43.3831381954729.
Norm before scaling: 43.360152020064746. Distance: 1.489911325619491
Total norm for 4 adversaries is: 43.360152020064746. distance: 1.489911325619491
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0364, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4525/4717 (95.9296%), train_poison_data_count: 370
Global model norm: 43.3831381954729.
Norm before scaling: 43.3589358085865. Distance: 1.3079090661570067
Total norm for 4 adversaries is: 43.3589358085865. distance: 1.3079090661570067
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1419, Accuracy: 9551/9900 (96.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 114, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4870/5066 (96.1311%), train_poison_data_count: 400
Global model norm: 43.3831381954729.
Norm before scaling: 43.362359131545475. Distance: 1.421789900360532
Total norm for 4 adversaries is: 43.362359131545475. distance: 1.421789900360532
___Test Local_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.0769, Accuracy: 9710/9900 (98.0808%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2965/3271 (90.6451%)
___Train Local_ResNet_18,  epoch 114, local model 83, internal_epoch   2,  Average loss: 0.0068, Accuracy: 2842/3271 (86.8847%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0708, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4089/4511 (90.6451%)
___Train Local_ResNet_18,  epoch 114, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4095/4511 (90.7781%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9169, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3291/3638 (90.4618%)
___Train Local_ResNet_18,  epoch 114, local model 76, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3348/3638 (92.0286%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8150, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5160/5582 (92.4400%)
___Train Local_ResNet_18,  epoch 114, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5142/5582 (92.1175%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2100, Accuracy: 5135/10000 (51.3500%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4147/4456 (93.0655%)
___Train Local_ResNet_18,  epoch 114, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4157/4456 (93.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.9004, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5346/5902 (90.5795%)
___Train Local_ResNet_18,  epoch 114, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5146/5902 (87.1908%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2124, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4020/4416 (91.0326%)
___Train Local_ResNet_18,  epoch 114, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3997/4416 (90.5118%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0567, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4460/4934 (90.3932%)
___Train Local_ResNet_18,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0087, Accuracy: 4106/4934 (83.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2366, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4209/4596 (91.5796%)
___Train Local_ResNet_18,  epoch 114, local model 5, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4218/4596 (91.7755%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1940, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3582/3837 (93.3542%)
___Train Local_ResNet_18,  epoch 114, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3605/3837 (93.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8336, Accuracy: 5789/10000 (57.8900%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5728/6391 (89.6260%)
___Train Local_ResNet_18,  epoch 114, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5595/6391 (87.5450%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1601, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3929/4368 (89.9496%)
___Train Local_ResNet_18,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3877/4368 (88.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.0124, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3495/3804 (91.8770%)
___Train Local_ResNet_18,  epoch 114, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3481/3804 (91.5089%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.8457, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5736/6263 (91.5855%)
___Train Local_ResNet_18,  epoch 114, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5673/6263 (90.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1281, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4397/4793 (91.7380%)
___Train Local_ResNet_18,  epoch 114, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4395/4793 (91.6962%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.1112, Accuracy: 5380/10000 (53.8000%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4985/5424 (91.9063%)
___Train Local_ResNet_18,  epoch 114, local model 42, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4985/5424 (91.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 114: Average loss: 2.2510, Accuracy: 5161/10000 (51.6100%)
time spent on training: 262.7034983634949
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 114: Average loss: 1.2248, Accuracy: 6847/10000 (68.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 114: Average loss: 0.1871, Accuracy: 9396/9900 (94.9091%)
Done in 289.5914936065674 sec.
Server Epoch:115 choose agents : [13, 36, 58, 71, 65, 23, 14, 94, 30, 24, 56, 15, 84, 44, 88, 1, 33, 28, 5, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4712/4885 (96.4585%), train_poison_data_count: 385
Global model norm: 43.40468775311386.
Norm before scaling: 43.37949139210256. Distance: 1.3406590241780747
Total norm for 4 adversaries is: 43.37949139210256. distance: 1.3406590241780747
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0274, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.40468775311386.
Norm before scaling: 43.38407657869345. Distance: 1.5105715792786079
Total norm for 4 adversaries is: 43.38407657869345. distance: 1.5105715792786079
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0744, Accuracy: 9717/9900 (98.1515%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4505/4717 (95.5056%), train_poison_data_count: 370
Global model norm: 43.40468775311386.
Norm before scaling: 43.381569488540435. Distance: 1.3162442795356564
Total norm for 4 adversaries is: 43.381569488540435. distance: 1.3162442795356564
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1014, Accuracy: 9636/9900 (97.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 115, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4862/5066 (95.9732%), train_poison_data_count: 400
Global model norm: 43.40468775311386.
Norm before scaling: 43.38273863783556. Distance: 1.4355878136435134
Total norm for 4 adversaries is: 43.38273863783556. distance: 1.4355878136435134
___Test Local_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.0369, Accuracy: 9811/9900 (99.1010%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4648/5055 (91.9486%)
___Train Local_ResNet_18,  epoch 115, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4595/5055 (90.9001%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9328, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3836/4184 (91.6826%)
___Train Local_ResNet_18,  epoch 115, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3838/4184 (91.7304%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.7891, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3587/3861 (92.9034%)
___Train Local_ResNet_18,  epoch 115, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3542/3861 (91.7379%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9403, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4407/4804 (91.7361%)
___Train Local_ResNet_18,  epoch 115, local model 94, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4153/4804 (86.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0827, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3243/3472 (93.4044%)
___Train Local_ResNet_18,  epoch 115, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3220/3472 (92.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9866, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3646/3969 (91.8619%)
___Train Local_ResNet_18,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3672/3969 (92.5170%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9651, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4531/4989 (90.8198%)
___Train Local_ResNet_18,  epoch 115, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4440/4989 (88.9958%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9290, Accuracy: 5563/10000 (55.6300%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5182/5582 (92.8341%)
___Train Local_ResNet_18,  epoch 115, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5070/5582 (90.8277%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1585, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4394/4793 (91.6754%)
___Train Local_ResNet_18,  epoch 115, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4392/4793 (91.6336%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.0373, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4261/4662 (91.3985%)
___Train Local_ResNet_18,  epoch 115, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4285/4662 (91.9133%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.9865, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4445/4934 (90.0892%)
___Train Local_ResNet_18,  epoch 115, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4294/4934 (87.0288%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.3502, Accuracy: 4844/10000 (48.4400%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4549/4986 (91.2355%)
___Train Local_ResNet_18,  epoch 115, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4571/4986 (91.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8623, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4104/4433 (92.5784%)
___Train Local_ResNet_18,  epoch 115, local model 33, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4031/4433 (90.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.8940, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4257/4716 (90.2672%)
___Train Local_ResNet_18,  epoch 115, local model 28, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4259/4716 (90.3096%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1136, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4244/4596 (92.3412%)
___Train Local_ResNet_18,  epoch 115, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4217/4596 (91.7537%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.1361, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3978/4354 (91.3643%)
___Train Local_ResNet_18,  epoch 115, local model 37, internal_epoch   2,  Average loss: 0.0115, Accuracy: 3480/4354 (79.9265%)
___Test Local_ResNet_18 poisoned: False, epoch: 115: Average loss: 2.6978, Accuracy: 4445/10000 (44.4500%)
time spent on training: 261.2353181838989
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 2 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 33.33% (1/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 115: Average loss: 1.2257, Accuracy: 6849/10000 (68.4900%)
___Test Target_ResNet_18 poisoned: True, epoch: 115: Average loss: 0.1850, Accuracy: 9404/9900 (94.9899%)
Done in 287.9032127857208 sec.
Server Epoch:116 choose agents : [13, 36, 58, 71, 67, 44, 25, 62, 37, 54, 55, 75, 92, 17, 10, 41, 19, 59, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4721/4885 (96.6428%), train_poison_data_count: 385
Global model norm: 43.42738332055378.
Norm before scaling: 43.40359513119276. Distance: 1.3338893337099844
Total norm for 4 adversaries is: 43.40359513119276. distance: 1.3338893337099844
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0323, Accuracy: 9816/9900 (99.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5084/5305 (95.8341%), train_poison_data_count: 415
Global model norm: 43.42738332055378.
Norm before scaling: 43.40186403552055. Distance: 1.4465056572073984
Total norm for 4 adversaries is: 43.40186403552055. distance: 1.4465056572073984
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0480, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4509/4717 (95.5904%), train_poison_data_count: 370
Global model norm: 43.42738332055378.
Norm before scaling: 43.4063090577352. Distance: 1.3889389103252887
Total norm for 4 adversaries is: 43.4063090577352. distance: 1.3889389103252887
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0652, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 116, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4844/5066 (95.6178%), train_poison_data_count: 400
Global model norm: 43.42738332055378.
Norm before scaling: 43.41035994536255. Distance: 1.48621495301013
Total norm for 4 adversaries is: 43.41035994536255. distance: 1.48621495301013
___Test Local_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.0965, Accuracy: 9636/9900 (97.3333%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4673/5116 (91.3409%)
___Train Local_ResNet_18,  epoch 116, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4619/5116 (90.2854%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1006, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4279/4662 (91.7846%)
___Train Local_ResNet_18,  epoch 116, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4312/4662 (92.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8690, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5335/5902 (90.3931%)
___Train Local_ResNet_18,  epoch 116, local model 25, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4964/5902 (84.1071%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1961, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4542/5063 (89.7097%)
___Train Local_ResNet_18,  epoch 116, local model 62, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4289/5063 (84.7126%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.1636, Accuracy: 5122/10000 (51.2200%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4047/4354 (92.9490%)
___Train Local_ResNet_18,  epoch 116, local model 37, internal_epoch   2,  Average loss: 0.0134, Accuracy: 3299/4354 (75.7694%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.9589, Accuracy: 4229/10000 (42.2900%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4747/5195 (91.3763%)
___Train Local_ResNet_18,  epoch 116, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4477/5195 (86.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2284, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4062/4356 (93.2507%)
___Train Local_ResNet_18,  epoch 116, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3822/4356 (87.7410%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.2486, Accuracy: 5200/10000 (52.0000%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3923/4295 (91.3388%)
___Train Local_ResNet_18,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3927/4295 (91.4319%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9593, Accuracy: 5694/10000 (56.9400%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5727/6263 (91.4418%)
___Train Local_ResNet_18,  epoch 116, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5676/6263 (90.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0909, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4090/4511 (90.6673%)
___Train Local_ResNet_18,  epoch 116, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4104/4511 (90.9776%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9090, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4325/4663 (92.7514%)
___Train Local_ResNet_18,  epoch 116, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4314/4663 (92.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9898, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3954/4336 (91.1900%)
___Train Local_ResNet_18,  epoch 116, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4008/4336 (92.4354%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9854, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4429/4928 (89.8742%)
___Train Local_ResNet_18,  epoch 116, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4438/4928 (90.0568%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 2.0265, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3749/4046 (92.6594%)
___Train Local_ResNet_18,  epoch 116, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3760/4046 (92.9313%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8673, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3340/3672 (90.9586%)
___Train Local_ResNet_18,  epoch 116, local model 87, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3299/3672 (89.8420%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.8950, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4039/4356 (92.7227%)
___Train Local_ResNet_18,  epoch 116, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3979/4356 (91.3453%)
___Test Local_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.9859, Accuracy: 5466/10000 (54.6600%)
time spent on training: 264.6633105278015
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 116: Average loss: 1.2270, Accuracy: 6855/10000 (68.5500%)
___Test Target_ResNet_18 poisoned: True, epoch: 116: Average loss: 0.1773, Accuracy: 9423/9900 (95.1818%)
Done in 291.78706645965576 sec.
Server Epoch:117 choose agents : [13, 36, 58, 71, 45, 77, 10, 41, 26, 95, 90, 82, 72, 51, 44, 53, 17, 18, 32, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4707/4885 (96.3562%), train_poison_data_count: 385
Global model norm: 43.45040275992847.
Norm before scaling: 43.42570236595561. Distance: 1.3476896862360277
Total norm for 4 adversaries is: 43.42570236595561. distance: 1.3476896862360277
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0590, Accuracy: 9742/9900 (98.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5065/5305 (95.4760%), train_poison_data_count: 415
Global model norm: 43.45040275992847.
Norm before scaling: 43.42540439731463. Distance: 1.4725417843963589
Total norm for 4 adversaries is: 43.42540439731463. distance: 1.4725417843963589
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0234, Accuracy: 9828/9900 (99.2727%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4504/4717 (95.4844%), train_poison_data_count: 370
Global model norm: 43.45040275992847.
Norm before scaling: 43.42795111994765. Distance: 1.3517688748012169
Total norm for 4 adversaries is: 43.42795111994765. distance: 1.3517688748012169
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0702, Accuracy: 9713/9900 (98.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4861/5066 (95.9534%), train_poison_data_count: 400
Global model norm: 43.45040275992847.
Norm before scaling: 43.42783868501358. Distance: 1.4431993862986052
Total norm for 4 adversaries is: 43.42783868501358. distance: 1.4431993862986052
___Test Local_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.0548, Accuracy: 9751/9900 (98.4949%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4522/5037 (89.7757%)
___Train Local_ResNet_18,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4561/5037 (90.5499%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9890, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4249/4647 (91.4353%)
___Train Local_ResNet_18,  epoch 117, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4205/4647 (90.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9927, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4316/4663 (92.5584%)
___Train Local_ResNet_18,  epoch 117, local model 10, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4312/4663 (92.4727%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0809, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3983/4336 (91.8589%)
___Train Local_ResNet_18,  epoch 117, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3994/4336 (92.1125%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1259, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3487/3756 (92.8381%)
___Train Local_ResNet_18,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3538/3756 (94.1960%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8029, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4153/4625 (89.7946%)
___Train Local_ResNet_18,  epoch 117, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4048/4625 (87.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1273, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4072/4362 (93.3517%)
___Train Local_ResNet_18,  epoch 117, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3952/4362 (90.6006%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1332, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4456/4874 (91.4239%)
___Train Local_ResNet_18,  epoch 117, local model 82, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4281/4874 (87.8334%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2042, Accuracy: 5127/10000 (51.2700%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4271/4767 (89.5951%)
___Train Local_ResNet_18,  epoch 117, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4281/4767 (89.8049%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9994, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3484/3775 (92.2914%)
___Train Local_ResNet_18,  epoch 117, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3565/3775 (94.4371%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.8526, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4293/4662 (92.0849%)
___Train Local_ResNet_18,  epoch 117, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4293/4662 (92.0849%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0318, Accuracy: 5495/10000 (54.9500%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5535/6124 (90.3821%)
___Train Local_ResNet_18,  epoch 117, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5407/6124 (88.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0950, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4118/4511 (91.2880%)
___Train Local_ResNet_18,  epoch 117, local model 17, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4082/4511 (90.4899%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.9916, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3612/3911 (92.3549%)
___Train Local_ResNet_18,  epoch 117, local model 18, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3493/3911 (89.3122%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.1001, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5022/5591 (89.8229%)
___Train Local_ResNet_18,  epoch 117, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4974/5591 (88.9644%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.2682, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3811/4126 (92.3655%)
___Train Local_ResNet_18,  epoch 117, local model 61, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3835/4126 (92.9472%)
___Test Local_ResNet_18 poisoned: False, epoch: 117: Average loss: 2.0015, Accuracy: 5552/10000 (55.5200%)
time spent on training: 261.2944040298462
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 117: Average loss: 1.2314, Accuracy: 6841/10000 (68.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 117: Average loss: 0.1557, Accuracy: 9483/9900 (95.7879%)
Done in 288.5343191623688 sec.
Server Epoch:118 choose agents : [13, 36, 58, 71, 80, 67, 35, 57, 93, 41, 65, 51, 9, 78, 56, 84, 60, 52, 33, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4720/4885 (96.6223%), train_poison_data_count: 385
Global model norm: 43.471201516959766.
Norm before scaling: 43.448360265556914. Distance: 1.3425479214034217
Total norm for 4 adversaries is: 43.448360265556914. distance: 1.3425479214034217
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0993, Accuracy: 9649/9900 (97.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 36, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5068/5305 (95.5325%), train_poison_data_count: 415
Global model norm: 43.471201516959766.
Norm before scaling: 43.4476634917302. Distance: 1.4854340640097452
Total norm for 4 adversaries is: 43.4476634917302. distance: 1.4854340640097452
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0708, Accuracy: 9713/9900 (98.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4512/4717 (95.6540%), train_poison_data_count: 370
Global model norm: 43.471201516959766.
Norm before scaling: 43.44768596847967. Distance: 1.3289298816263937
Total norm for 4 adversaries is: 43.44768596847967. distance: 1.3289298816263937
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0586, Accuracy: 9746/9900 (98.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 118, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4849/5066 (95.7165%), train_poison_data_count: 400
Global model norm: 43.471201516959766.
Norm before scaling: 43.450971663204065. Distance: 1.4699812253414821
Total norm for 4 adversaries is: 43.450971663204065. distance: 1.4699812253414821
___Test Local_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.0511, Accuracy: 9773/9900 (98.7172%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4563/5025 (90.8060%)
___Train Local_ResNet_18,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4592/5025 (91.3831%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1099, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4690/5116 (91.6732%)
___Train Local_ResNet_18,  epoch 118, local model 67, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4571/5116 (89.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1647, Accuracy: 5203/10000 (52.0300%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4745/5167 (91.8328%)
___Train Local_ResNet_18,  epoch 118, local model 35, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4735/5167 (91.6392%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1228, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4138/4558 (90.7854%)
___Train Local_ResNet_18,  epoch 118, local model 57, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4018/4558 (88.1527%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1580, Accuracy: 5190/10000 (51.9000%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4322/4651 (92.9263%)
___Train Local_ResNet_18,  epoch 118, local model 93, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4231/4651 (90.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0807, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3946/4336 (91.0055%)
___Train Local_ResNet_18,  epoch 118, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4000/4336 (92.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1342, Accuracy: 5381/10000 (53.8100%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4620/5055 (91.3947%)
___Train Local_ResNet_18,  epoch 118, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4561/5055 (90.2275%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0806, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3503/3775 (92.7947%)
___Train Local_ResNet_18,  epoch 118, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3578/3775 (94.7815%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.7706, Accuracy: 5933/10000 (59.3300%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4777/5265 (90.7312%)
___Train Local_ResNet_18,  epoch 118, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4683/5265 (88.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.1263, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3759/4025 (93.3913%)
___Train Local_ResNet_18,  epoch 118, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3772/4025 (93.7143%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8677, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4527/4989 (90.7396%)
___Train Local_ResNet_18,  epoch 118, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4478/4989 (89.7575%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9327, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4436/4793 (92.5516%)
___Train Local_ResNet_18,  epoch 118, local model 84, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4453/4793 (92.9063%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 2.0097, Accuracy: 5534/10000 (55.3400%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3561/3804 (93.6120%)
___Train Local_ResNet_18,  epoch 118, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3550/3804 (93.3228%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9673, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3549/3797 (93.4685%)
___Train Local_ResNet_18,  epoch 118, local model 52, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3518/3797 (92.6521%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8801, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4107/4433 (92.6461%)
___Train Local_ResNet_18,  epoch 118, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4083/4433 (92.1047%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.9116, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4372/4707 (92.8829%)
___Train Local_ResNet_18,  epoch 118, local model 47, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4257/4707 (90.4398%)
___Test Local_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.8197, Accuracy: 5774/10000 (57.7400%)
time spent on training: 258.15267157554626
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 118: Average loss: 1.2371, Accuracy: 6839/10000 (68.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 118: Average loss: 0.1478, Accuracy: 9508/9900 (96.0404%)
Done in 285.25510692596436 sec.
Server Epoch:119 choose agents : [13, 36, 58, 71, 70, 10, 52, 15, 35, 79, 24, 39, 25, 40, 45, 0, 1, 49, 97, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4720/4885 (96.6223%), train_poison_data_count: 385
Global model norm: 43.49215452104911.
Norm before scaling: 43.467743237352884. Distance: 1.3224645828379367
Total norm for 4 adversaries is: 43.467743237352884. distance: 1.3224645828379367
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0575, Accuracy: 9763/9900 (98.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5086/5305 (95.8718%), train_poison_data_count: 415
Global model norm: 43.49215452104911.
Norm before scaling: 43.466893719351226. Distance: 1.421426555634854
Total norm for 4 adversaries is: 43.466893719351226. distance: 1.421426555634854
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0597, Accuracy: 9745/9900 (98.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4545/4717 (96.3536%), train_poison_data_count: 370
Global model norm: 43.49215452104911.
Norm before scaling: 43.46434225720622. Distance: 1.2441275938779883
Total norm for 4 adversaries is: 43.46434225720622. distance: 1.2441275938779883
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1015, Accuracy: 9633/9900 (97.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 119, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4834/5066 (95.4205%), train_poison_data_count: 400
Global model norm: 43.49215452104911.
Norm before scaling: 43.47110183024969. Distance: 1.4614026966049731
Total norm for 4 adversaries is: 43.47110183024969. distance: 1.4614026966049731
___Test Local_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.0492, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4855/5392 (90.0408%)
___Train Local_ResNet_18,  epoch 119, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4867/5392 (90.2634%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0842, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4351/4663 (93.3090%)
___Train Local_ResNet_18,  epoch 119, local model 10, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4331/4663 (92.8801%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.9476, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3517/3797 (92.6258%)
___Train Local_ResNet_18,  epoch 119, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3490/3797 (91.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0373, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5180/5582 (92.7983%)
___Train Local_ResNet_18,  epoch 119, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5081/5582 (91.0247%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1913, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4736/5167 (91.6586%)
___Train Local_ResNet_18,  epoch 119, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4734/5167 (91.6199%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0276, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3485/3781 (92.1714%)
___Train Local_ResNet_18,  epoch 119, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3310/3781 (87.5430%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0720, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3657/3969 (92.1391%)
___Train Local_ResNet_18,  epoch 119, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3644/3969 (91.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7697, Accuracy: 5965/10000 (59.6500%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3563/3837 (92.8590%)
___Train Local_ResNet_18,  epoch 119, local model 39, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3599/3837 (93.7972%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.7932, Accuracy: 5806/10000 (58.0600%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5323/5902 (90.1898%)
___Train Local_ResNet_18,  epoch 119, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 5082/5902 (86.1064%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.4491, Accuracy: 5002/10000 (50.0200%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4992/5455 (91.5124%)
___Train Local_ResNet_18,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4871/5455 (89.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8735, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4541/5037 (90.1529%)
___Train Local_ResNet_18,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4560/5037 (90.5301%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.1477, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4628/5017 (92.2464%)
___Train Local_ResNet_18,  epoch 119, local model 0, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4616/5017 (92.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8563, Accuracy: 5713/10000 (57.1300%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4563/4986 (91.5162%)
___Train Local_ResNet_18,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4527/4986 (90.7942%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.8189, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4766/5197 (91.7068%)
___Train Local_ResNet_18,  epoch 119, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4719/5197 (90.8024%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0741, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4028/4361 (92.3641%)
___Train Local_ResNet_18,  epoch 119, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3910/4361 (89.6583%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0061, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5770/6263 (92.1284%)
___Train Local_ResNet_18,  epoch 119, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5714/6263 (91.2342%)
___Test Local_ResNet_18 poisoned: False, epoch: 119: Average loss: 2.0211, Accuracy: 5554/10000 (55.5400%)
time spent on training: 265.190238237381
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 119: Average loss: 1.2346, Accuracy: 6833/10000 (68.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 119: Average loss: 0.1466, Accuracy: 9510/9900 (96.0606%)
Done in 292.1071572303772 sec.
Server Epoch:120 choose agents : [13, 36, 58, 71, 0, 19, 23, 84, 38, 26, 73, 27, 62, 56, 16, 25, 66, 53, 98, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 43.51459687968582.
Norm before scaling: 43.48685651381489. Distance: 1.248704572811691
Total norm for 4 adversaries is: 43.48685651381489. distance: 1.248704572811691
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1078, Accuracy: 9620/9900 (97.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5120/5305 (96.5127%), train_poison_data_count: 415
Global model norm: 43.51459687968582.
Norm before scaling: 43.488180023516875. Distance: 1.3909855921566119
Total norm for 4 adversaries is: 43.488180023516875. distance: 1.3909855921566119
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0740, Accuracy: 9718/9900 (98.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4520/4717 (95.8236%), train_poison_data_count: 370
Global model norm: 43.51459687968582.
Norm before scaling: 43.490168721110116. Distance: 1.2970209614067976
Total norm for 4 adversaries is: 43.490168721110116. distance: 1.2970209614067976
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0337, Accuracy: 9808/9900 (99.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 120, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4866/5066 (96.0521%), train_poison_data_count: 400
Global model norm: 43.51459687968582.
Norm before scaling: 43.49204646218375. Distance: 1.435645773458751
Total norm for 4 adversaries is: 43.49204646218375. distance: 1.435645773458751
___Test Local_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.0879, Accuracy: 9681/9900 (97.7879%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4612/5017 (91.9274%)
___Train Local_ResNet_18,  epoch 120, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4551/5017 (90.7116%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9144, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4439/4928 (90.0771%)
___Train Local_ResNet_18,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4373/4928 (88.7378%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1119, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3881/4184 (92.7581%)
___Train Local_ResNet_18,  epoch 120, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3886/4184 (92.8776%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8295, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4449/4793 (92.8229%)
___Train Local_ResNet_18,  epoch 120, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4412/4793 (92.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9022, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5240/5740 (91.2892%)
___Train Local_ResNet_18,  epoch 120, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5194/5740 (90.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3900, Accuracy: 4944/10000 (49.4400%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3543/3756 (94.3291%)
___Train Local_ResNet_18,  epoch 120, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3572/3756 (95.1012%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.7930, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3917/4235 (92.4911%)
___Train Local_ResNet_18,  epoch 120, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3828/4235 (90.3896%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0199, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3901/4223 (92.3751%)
___Train Local_ResNet_18,  epoch 120, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3895/4223 (92.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9852, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4533/5063 (89.5319%)
___Train Local_ResNet_18,  epoch 120, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4382/5063 (86.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.3712, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4518/4989 (90.5592%)
___Train Local_ResNet_18,  epoch 120, local model 56, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4501/4989 (90.2185%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8992, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4494/4928 (91.1932%)
___Train Local_ResNet_18,  epoch 120, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4458/4928 (90.4627%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8959, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5305/5902 (89.8848%)
___Train Local_ResNet_18,  epoch 120, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5090/5902 (86.2420%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.2261, Accuracy: 5180/10000 (51.8000%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4156/4456 (93.2675%)
___Train Local_ResNet_18,  epoch 120, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4130/4456 (92.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.0368, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5509/6124 (89.9575%)
___Train Local_ResNet_18,  epoch 120, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5440/6124 (88.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.9450, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3553/3828 (92.8161%)
___Train Local_ResNet_18,  epoch 120, local model 98, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3550/3828 (92.7377%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 2.1552, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3290/3616 (90.9845%)
___Train Local_ResNet_18,  epoch 120, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3376/3616 (93.3628%)
___Test Local_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.8122, Accuracy: 5895/10000 (58.9500%)
time spent on training: 262.262815952301
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 120: Average loss: 1.2382, Accuracy: 6816/10000 (68.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 120: Average loss: 0.1391, Accuracy: 9533/9900 (96.2929%)
Done in 288.99909353256226 sec.
Server Epoch:121 choose agents : [13, 36, 58, 71, 27, 90, 85, 84, 26, 81, 78, 76, 20, 75, 16, 1, 61, 3, 54, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4716/4885 (96.5404%), train_poison_data_count: 385
Global model norm: 43.53667158225279.
Norm before scaling: 43.5133176565125. Distance: 1.335340221357427
Total norm for 4 adversaries is: 43.5133176565125. distance: 1.335340221357427
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0880, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5108/5305 (96.2865%), train_poison_data_count: 415
Global model norm: 43.53667158225279.
Norm before scaling: 43.511056481460116. Distance: 1.4292289123474136
Total norm for 4 adversaries is: 43.511056481460116. distance: 1.4292289123474136
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0507, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 43.53667158225279.
Norm before scaling: 43.50942224643703. Distance: 1.2383742432919762
Total norm for 4 adversaries is: 43.50942224643703. distance: 1.2383742432919762
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0633, Accuracy: 9732/9900 (98.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 121, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4853/5066 (95.7955%), train_poison_data_count: 400
Global model norm: 43.53667158225279.
Norm before scaling: 43.514927900610296. Distance: 1.4545309177127435
Total norm for 4 adversaries is: 43.514927900610296. distance: 1.4545309177127435
___Test Local_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.0299, Accuracy: 9831/9900 (99.3030%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3862/4223 (91.4516%)
___Train Local_ResNet_18,  epoch 121, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3879/4223 (91.8541%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9322, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4086/4362 (93.6726%)
___Train Local_ResNet_18,  epoch 121, local model 90, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3953/4362 (90.6236%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9831, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5767/6391 (90.2363%)
___Train Local_ResNet_18,  epoch 121, local model 85, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5593/6391 (87.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0544, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4432/4793 (92.4682%)
___Train Local_ResNet_18,  epoch 121, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4448/4793 (92.8020%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0186, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3532/3756 (94.0362%)
___Train Local_ResNet_18,  epoch 121, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3547/3756 (94.4356%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8509, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4280/4618 (92.6808%)
___Train Local_ResNet_18,  epoch 121, local model 81, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4186/4618 (90.6453%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0934, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3736/4025 (92.8199%)
___Train Local_ResNet_18,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3783/4025 (93.9876%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.7781, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3319/3638 (91.2314%)
___Train Local_ResNet_18,  epoch 121, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3356/3638 (92.2485%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8609, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4006/4315 (92.8389%)
___Train Local_ResNet_18,  epoch 121, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4036/4315 (93.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8738, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3943/4295 (91.8044%)
___Train Local_ResNet_18,  epoch 121, local model 75, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3865/4295 (89.9884%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0811, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4540/4928 (92.1266%)
___Train Local_ResNet_18,  epoch 121, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4531/4928 (91.9440%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.0038, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4580/4986 (91.8572%)
___Train Local_ResNet_18,  epoch 121, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4558/4986 (91.4160%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.9470, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3858/4126 (93.5046%)
___Train Local_ResNet_18,  epoch 121, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3800/4126 (92.0989%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.8755, Accuracy: 5735/10000 (57.3500%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4521/4918 (91.9276%)
___Train Local_ResNet_18,  epoch 121, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4485/4918 (91.1956%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1522, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4750/5195 (91.4341%)
___Train Local_ResNet_18,  epoch 121, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4548/5195 (87.5457%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.2282, Accuracy: 5147/10000 (51.4700%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5164/5740 (89.9652%)
___Train Local_ResNet_18,  epoch 121, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5142/5740 (89.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 121: Average loss: 2.1770, Accuracy: 5252/10000 (52.5200%)
time spent on training: 263.79267740249634
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 11 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 121: Average loss: 1.2437, Accuracy: 6810/10000 (68.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 121: Average loss: 0.1251, Accuracy: 9565/9900 (96.6162%)
Done in 290.8658835887909 sec.
Server Epoch:122 choose agents : [13, 36, 58, 71, 68, 98, 62, 8, 84, 27, 26, 76, 2, 82, 92, 45, 90, 55, 67, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4731/4885 (96.8475%), train_poison_data_count: 385
Global model norm: 43.55698354374058.
Norm before scaling: 43.53113082135516. Distance: 1.310964639994294
Total norm for 4 adversaries is: 43.53113082135516. distance: 1.310964639994294
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1046, Accuracy: 9627/9900 (97.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5123/5305 (96.5693%), train_poison_data_count: 415
Global model norm: 43.55698354374058.
Norm before scaling: 43.52971888010822. Distance: 1.3863611324333172
Total norm for 4 adversaries is: 43.52971888010822. distance: 1.3863611324333172
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0233, Accuracy: 9840/9900 (99.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4554/4717 (96.5444%), train_poison_data_count: 370
Global model norm: 43.55698354374058.
Norm before scaling: 43.53108875822614. Distance: 1.256783769617112
Total norm for 4 adversaries is: 43.53108875822614. distance: 1.256783769617112
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1006, Accuracy: 9646/9900 (97.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 122, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4855/5066 (95.8350%), train_poison_data_count: 400
Global model norm: 43.55698354374058.
Norm before scaling: 43.53326897686986. Distance: 1.4262252325369829
Total norm for 4 adversaries is: 43.53326897686986. distance: 1.4262252325369829
___Test Local_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.0434, Accuracy: 9793/9900 (98.9192%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3064/3297 (92.9330%)
___Train Local_ResNet_18,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3076/3297 (93.2969%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8401, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3576/3828 (93.4169%)
___Train Local_ResNet_18,  epoch 122, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3555/3828 (92.8683%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0173, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4586/5063 (90.5787%)
___Train Local_ResNet_18,  epoch 122, local model 62, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4368/5063 (86.2730%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3408, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4125/4501 (91.6463%)
___Train Local_ResNet_18,  epoch 122, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4100/4501 (91.0909%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0559, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4453/4793 (92.9063%)
___Train Local_ResNet_18,  epoch 122, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4458/4793 (93.0106%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0060, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3913/4223 (92.6592%)
___Train Local_ResNet_18,  epoch 122, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3930/4223 (93.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8592, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3534/3756 (94.0895%)
___Train Local_ResNet_18,  epoch 122, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3569/3756 (95.0213%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8643, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3334/3638 (91.6438%)
___Train Local_ResNet_18,  epoch 122, local model 76, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3364/3638 (92.4684%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8321, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3361/3646 (92.1832%)
___Train Local_ResNet_18,  epoch 122, local model 2, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3391/3646 (93.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.7759, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4481/4874 (91.9368%)
___Train Local_ResNet_18,  epoch 122, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4322/4874 (88.6746%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.2695, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5740/6263 (91.6494%)
___Train Local_ResNet_18,  epoch 122, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5762/6263 (92.0006%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0046, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4531/5037 (89.9543%)
___Train Local_ResNet_18,  epoch 122, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4622/5037 (91.7610%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9354, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4105/4362 (94.1082%)
___Train Local_ResNet_18,  epoch 122, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4074/4362 (93.3975%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.0602, Accuracy: 5513/10000 (55.1300%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4052/4356 (93.0211%)
___Train Local_ResNet_18,  epoch 122, local model 55, internal_epoch   2,  Average loss: 0.0080, Accuracy: 3734/4356 (85.7208%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 2.3455, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4634/5116 (90.5786%)
___Train Local_ResNet_18,  epoch 122, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4542/5116 (88.7803%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.9657, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4026/4346 (92.6369%)
___Train Local_ResNet_18,  epoch 122, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4062/4346 (93.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.8494, Accuracy: 5760/10000 (57.6000%)
time spent on training: 235.5329167842865
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 122: Average loss: 1.2330, Accuracy: 6825/10000 (68.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 122: Average loss: 0.1255, Accuracy: 9562/9900 (96.5859%)
Done in 258.79800724983215 sec.
Server Epoch:123 choose agents : [13, 36, 58, 71, 34, 57, 60, 51, 12, 16, 11, 56, 1, 31, 22, 62, 48, 2, 35, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4711/4885 (96.4381%), train_poison_data_count: 385
Global model norm: 43.57716138231844.
Norm before scaling: 43.55140612639203. Distance: 1.3459778437470096
Total norm for 4 adversaries is: 43.55140612639203. distance: 1.3459778437470096
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0641, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5115/5305 (96.4185%), train_poison_data_count: 415
Global model norm: 43.57716138231844.
Norm before scaling: 43.54864518065186. Distance: 1.3979470868882191
Total norm for 4 adversaries is: 43.54864518065186. distance: 1.3979470868882191
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0557, Accuracy: 9757/9900 (98.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 58, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4516/4717 (95.7388%), train_poison_data_count: 370
Global model norm: 43.57716138231844.
Norm before scaling: 43.55229884145038. Distance: 1.3064200039712048
Total norm for 4 adversaries is: 43.55229884145038. distance: 1.3064200039712048
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0635, Accuracy: 9727/9900 (98.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 123, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4885/5066 (96.4272%), train_poison_data_count: 400
Global model norm: 43.57716138231844.
Norm before scaling: 43.55201715468742. Distance: 1.3595689657100785
Total norm for 4 adversaries is: 43.55201715468742. distance: 1.3595689657100785
___Test Local_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.0855, Accuracy: 9658/9900 (97.5556%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4202/4518 (93.0058%)
___Train Local_ResNet_18,  epoch 123, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4150/4518 (91.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1501, Accuracy: 5378/10000 (53.7800%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4171/4558 (91.5094%)
___Train Local_ResNet_18,  epoch 123, local model 57, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4000/4558 (87.7578%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2293, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3557/3804 (93.5068%)
___Train Local_ResNet_18,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3554/3804 (93.4280%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9048, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3506/3775 (92.8742%)
___Train Local_ResNet_18,  epoch 123, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3586/3775 (94.9934%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8454, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4643/5083 (91.3437%)
___Train Local_ResNet_18,  epoch 123, local model 12, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4561/5083 (89.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0783, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4527/4928 (91.8628%)
___Train Local_ResNet_18,  epoch 123, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4469/4928 (90.6859%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0362, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4656/5244 (88.7872%)
___Train Local_ResNet_18,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4594/5244 (87.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9877, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4572/4989 (91.6416%)
___Train Local_ResNet_18,  epoch 123, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4559/4989 (91.3810%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9305, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4600/4986 (92.2583%)
___Train Local_ResNet_18,  epoch 123, local model 1, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4571/4986 (91.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.9316, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3794/4175 (90.8743%)
___Train Local_ResNet_18,  epoch 123, local model 31, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3868/4175 (92.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.8459, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4772/5232 (91.2080%)
___Train Local_ResNet_18,  epoch 123, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4651/5232 (88.8953%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1255, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4570/5063 (90.2627%)
___Train Local_ResNet_18,  epoch 123, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4370/5063 (86.3125%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.2767, Accuracy: 4979/10000 (49.7900%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4155/4441 (93.5600%)
___Train Local_ResNet_18,  epoch 123, local model 48, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4127/4441 (92.9295%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0158, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3358/3646 (92.1009%)
___Train Local_ResNet_18,  epoch 123, local model 2, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3337/3646 (91.5250%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.7874, Accuracy: 5849/10000 (58.4900%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4749/5167 (91.9102%)
___Train Local_ResNet_18,  epoch 123, local model 35, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4714/5167 (91.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.1326, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4271/4538 (94.1164%)
___Train Local_ResNet_18,  epoch 123, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4256/4538 (93.7858%)
___Test Local_ResNet_18 poisoned: False, epoch: 123: Average loss: 2.0212, Accuracy: 5491/10000 (54.9100%)
time spent on training: 236.4667706489563
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 123: Average loss: 1.2377, Accuracy: 6817/10000 (68.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 123: Average loss: 0.1200, Accuracy: 9573/9900 (96.6970%)
Done in 260.225594997406 sec.
Server Epoch:124 choose agents : [13, 36, 58, 71, 55, 19, 45, 94, 51, 35, 73, 46, 38, 96, 4, 30, 93, 21, 25, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4725/4885 (96.7247%), train_poison_data_count: 385
Global model norm: 43.59822025691315.
Norm before scaling: 43.57265534650502. Distance: 1.3298914213962156
Total norm for 4 adversaries is: 43.57265534650502. distance: 1.3298914213962156
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0596, Accuracy: 9742/9900 (98.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5104/5305 (96.2111%), train_poison_data_count: 415
Global model norm: 43.59822025691315.
Norm before scaling: 43.57050511545196. Distance: 1.4086106725132177
Total norm for 4 adversaries is: 43.57050511545196. distance: 1.4086106725132177
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0299, Accuracy: 9824/9900 (99.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4530/4717 (96.0356%), train_poison_data_count: 370
Global model norm: 43.59822025691315.
Norm before scaling: 43.57245503630275. Distance: 1.2793139740478217
Total norm for 4 adversaries is: 43.57245503630275. distance: 1.2793139740478217
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1669, Accuracy: 9462/9900 (95.5758%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 124, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4882/5066 (96.3679%), train_poison_data_count: 400
Global model norm: 43.59822025691315.
Norm before scaling: 43.57271838099357. Distance: 1.3544189609351762
Total norm for 4 adversaries is: 43.57271838099357. distance: 1.3544189609351762
___Test Local_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.0964, Accuracy: 9640/9900 (97.3737%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4077/4356 (93.5950%)
___Train Local_ResNet_18,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3837/4356 (88.0854%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2154, Accuracy: 5205/10000 (52.0500%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4453/4928 (90.3612%)
___Train Local_ResNet_18,  epoch 124, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4395/4928 (89.1843%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1132, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4575/5037 (90.8279%)
___Train Local_ResNet_18,  epoch 124, local model 45, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4557/5037 (90.4705%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0115, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4428/4804 (92.1732%)
___Train Local_ResNet_18,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4146/4804 (86.3031%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2857, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3557/3775 (94.2252%)
___Train Local_ResNet_18,  epoch 124, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3576/3775 (94.7285%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.7811, Accuracy: 5910/10000 (59.1000%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4797/5167 (92.8392%)
___Train Local_ResNet_18,  epoch 124, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4714/5167 (91.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0935, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3941/4235 (93.0579%)
___Train Local_ResNet_18,  epoch 124, local model 73, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3849/4235 (90.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0169, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4492/4956 (90.6376%)
___Train Local_ResNet_18,  epoch 124, local model 46, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4359/4956 (87.9540%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1889, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5227/5740 (91.0627%)
___Train Local_ResNet_18,  epoch 124, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5183/5740 (90.2962%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0526, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4341/4679 (92.7762%)
___Train Local_ResNet_18,  epoch 124, local model 96, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4253/4679 (90.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.1964, Accuracy: 5275/10000 (52.7500%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3367/3704 (90.9017%)
___Train Local_ResNet_18,  epoch 124, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3442/3704 (92.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9795, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3207/3472 (92.3675%)
___Train Local_ResNet_18,  epoch 124, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3237/3472 (93.2316%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9116, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4286/4651 (92.1522%)
___Train Local_ResNet_18,  epoch 124, local model 93, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4221/4651 (90.7547%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0082, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4211/4634 (90.8718%)
___Train Local_ResNet_18,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4192/4634 (90.4618%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.0451, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5339/5902 (90.4609%)
___Train Local_ResNet_18,  epoch 124, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5185/5902 (87.8516%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 2.2440, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3555/3837 (92.6505%)
___Train Local_ResNet_18,  epoch 124, local model 39, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3572/3837 (93.0936%)
___Test Local_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.9053, Accuracy: 5662/10000 (56.6200%)
time spent on training: 249.22480368614197
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 124: Average loss: 1.2341, Accuracy: 6814/10000 (68.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 124: Average loss: 0.1268, Accuracy: 9557/9900 (96.5354%)
Done in 276.20442271232605 sec.
Server Epoch:125 choose agents : [13, 36, 58, 71, 24, 47, 14, 5, 64, 16, 80, 43, 3, 20, 63, 66, 37, 8, 18, 57].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4714/4885 (96.4995%), train_poison_data_count: 385
Global model norm: 43.61918780676544.
Norm before scaling: 43.59155460421778. Distance: 1.3134352666893505
Total norm for 4 adversaries is: 43.59155460421778. distance: 1.3134352666893505
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0599, Accuracy: 9752/9900 (98.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 43.61918780676544.
Norm before scaling: 43.59162741248312. Distance: 1.3836763776234542
Total norm for 4 adversaries is: 43.59162741248312. distance: 1.3836763776234542
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0384, Accuracy: 9798/9900 (98.9697%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.61918780676544.
Norm before scaling: 43.59296454265513. Distance: 1.2834887600366833
Total norm for 4 adversaries is: 43.59296454265513. distance: 1.2834887600366833
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.0212, Accuracy: 9840/9900 (99.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 125, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4870/5066 (96.1311%), train_poison_data_count: 400
Global model norm: 43.61918780676544.
Norm before scaling: 43.59589908457202. Distance: 1.4090349383438847
Total norm for 4 adversaries is: 43.59589908457202. distance: 1.4090349383438847
___Test Local_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1057, Accuracy: 9629/9900 (97.2626%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3686/3969 (92.8697%)
___Train Local_ResNet_18,  epoch 125, local model 24, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3633/3969 (91.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0131, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4348/4707 (92.3731%)
___Train Local_ResNet_18,  epoch 125, local model 47, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4313/4707 (91.6295%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8276, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3569/3861 (92.4372%)
___Train Local_ResNet_18,  epoch 125, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3552/3861 (91.9969%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9173, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4207/4596 (91.5361%)
___Train Local_ResNet_18,  epoch 125, local model 5, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4176/4596 (90.8616%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0462, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4165/4503 (92.4939%)
___Train Local_ResNet_18,  epoch 125, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4096/4503 (90.9616%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9581, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4603/4928 (93.4050%)
___Train Local_ResNet_18,  epoch 125, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4494/4928 (91.1932%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9317, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4572/5025 (90.9851%)
___Train Local_ResNet_18,  epoch 125, local model 80, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4585/5025 (91.2438%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0894, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4271/4576 (93.3348%)
___Train Local_ResNet_18,  epoch 125, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4209/4576 (91.9799%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.9824, Accuracy: 5619/10000 (56.1900%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4530/4918 (92.1106%)
___Train Local_ResNet_18,  epoch 125, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4527/4918 (92.0496%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0392, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4019/4315 (93.1402%)
___Train Local_ResNet_18,  epoch 125, local model 20, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4053/4315 (93.9282%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.7618, Accuracy: 5891/10000 (58.9100%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3364/3590 (93.7047%)
___Train Local_ResNet_18,  epoch 125, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3352/3590 (93.3705%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.8112, Accuracy: 5861/10000 (58.6100%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4147/4456 (93.0655%)
___Train Local_ResNet_18,  epoch 125, local model 66, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4131/4456 (92.7065%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.3185, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4010/4354 (92.0992%)
___Train Local_ResNet_18,  epoch 125, local model 37, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3690/4354 (84.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.4536, Accuracy: 4803/10000 (48.0300%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4133/4501 (91.8240%)
___Train Local_ResNet_18,  epoch 125, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4106/4501 (91.2242%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0692, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3626/3911 (92.7129%)
___Train Local_ResNet_18,  epoch 125, local model 18, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3409/3911 (87.1644%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.2052, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4222/4558 (92.6283%)
___Train Local_ResNet_18,  epoch 125, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4110/4558 (90.1711%)
___Test Local_ResNet_18 poisoned: False, epoch: 125: Average loss: 2.0659, Accuracy: 5414/10000 (54.1400%)
time spent on training: 256.8185040950775
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 125: Average loss: 1.2430, Accuracy: 6798/10000 (67.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 125: Average loss: 0.1167, Accuracy: 9582/9900 (96.7879%)
Done in 283.8735682964325 sec.
Server Epoch:126 choose agents : [13, 36, 58, 71, 67, 70, 72, 81, 59, 95, 76, 74, 82, 2, 62, 61, 88, 17, 34, 68].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4741/4885 (97.0522%), train_poison_data_count: 385
Global model norm: 43.63889771241578.
Norm before scaling: 43.61060662001418. Distance: 1.280200388764494
Total norm for 4 adversaries is: 43.61060662001418. distance: 1.280200388764494
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0332, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5094/5305 (96.0226%), train_poison_data_count: 415
Global model norm: 43.63889771241578.
Norm before scaling: 43.61333845299652. Distance: 1.4536113130340218
Total norm for 4 adversaries is: 43.61333845299652. distance: 1.4536113130340218
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.0218, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4557/4717 (96.6080%), train_poison_data_count: 370
Global model norm: 43.63889771241578.
Norm before scaling: 43.610071989234896. Distance: 1.2216486084519778
Total norm for 4 adversaries is: 43.610071989234896. distance: 1.2216486084519778
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1572, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 126, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4862/5066 (95.9732%), train_poison_data_count: 400
Global model norm: 43.63889771241578.
Norm before scaling: 43.61521508951535. Distance: 1.4078217094365724
Total norm for 4 adversaries is: 43.61521508951535. distance: 1.4078217094365724
___Test Local_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1346, Accuracy: 9539/9900 (96.3535%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4690/5116 (91.6732%)
___Train Local_ResNet_18,  epoch 126, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4622/5116 (90.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.9672, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4978/5392 (92.3220%)
___Train Local_ResNet_18,  epoch 126, local model 70, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4803/5392 (89.0764%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1730, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4335/4767 (90.9377%)
___Train Local_ResNet_18,  epoch 126, local model 72, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4197/4767 (88.0428%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2641, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4333/4618 (93.8285%)
___Train Local_ResNet_18,  epoch 126, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4264/4618 (92.3343%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1905, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3760/4046 (92.9313%)
___Train Local_ResNet_18,  epoch 126, local model 59, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3788/4046 (93.6233%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8698, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4185/4625 (90.4865%)
___Train Local_ResNet_18,  epoch 126, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4099/4625 (88.6270%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.2362, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3333/3638 (91.6163%)
___Train Local_ResNet_18,  epoch 126, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3319/3638 (91.2314%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8982, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4012/4416 (90.8514%)
___Train Local_ResNet_18,  epoch 126, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3988/4416 (90.3080%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0636, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4500/4874 (92.3266%)
___Train Local_ResNet_18,  epoch 126, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4273/4874 (87.6693%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.3918, Accuracy: 4957/10000 (49.5700%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3364/3646 (92.2655%)
___Train Local_ResNet_18,  epoch 126, local model 2, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3372/3646 (92.4849%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7937, Accuracy: 5907/10000 (59.0700%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4627/5063 (91.3885%)
___Train Local_ResNet_18,  epoch 126, local model 62, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4387/5063 (86.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0695, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3824/4126 (92.6806%)
___Train Local_ResNet_18,  epoch 126, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3869/4126 (93.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8118, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4495/4934 (91.1026%)
___Train Local_ResNet_18,  epoch 126, local model 88, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4307/4934 (87.2923%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.1777, Accuracy: 5224/10000 (52.2400%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4146/4511 (91.9087%)
___Train Local_ResNet_18,  epoch 126, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4122/4511 (91.3766%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 2.0836, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4164/4518 (92.1647%)
___Train Local_ResNet_18,  epoch 126, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4161/4518 (92.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.8997, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3066/3297 (92.9936%)
___Train Local_ResNet_18,  epoch 126, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3092/3297 (93.7822%)
___Test Local_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.7551, Accuracy: 5954/10000 (59.5400%)
time spent on training: 260.8593122959137
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 126: Average loss: 1.2403, Accuracy: 6815/10000 (68.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 126: Average loss: 0.1139, Accuracy: 9594/9900 (96.9091%)
Done in 288.7552192211151 sec.
Server Epoch:127 choose agents : [13, 36, 58, 71, 53, 80, 30, 45, 15, 67, 34, 19, 57, 68, 26, 93, 48, 76, 5, 83].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4748/4885 (97.1955%), train_poison_data_count: 385
Global model norm: 43.658868535016026.
Norm before scaling: 43.63008258581815. Distance: 1.2589560576262677
Total norm for 4 adversaries is: 43.63008258581815. distance: 1.2589560576262677
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0755, Accuracy: 9709/9900 (98.0707%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5124/5305 (96.5881%), train_poison_data_count: 415
Global model norm: 43.658868535016026.
Norm before scaling: 43.63044910228621. Distance: 1.4007098101532385
Total norm for 4 adversaries is: 43.63044910228621. distance: 1.4007098101532385
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0620, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4528/4717 (95.9932%), train_poison_data_count: 370
Global model norm: 43.658868535016026.
Norm before scaling: 43.63493518225248. Distance: 1.311679538233872
Total norm for 4 adversaries is: 43.63493518225248. distance: 1.311679538233872
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0481, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 127, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4887/5066 (96.4666%), train_poison_data_count: 400
Global model norm: 43.658868535016026.
Norm before scaling: 43.6334804391579. Distance: 1.3802372287628544
Total norm for 4 adversaries is: 43.6334804391579. distance: 1.3802372287628544
___Test Local_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.0417, Accuracy: 9790/9900 (98.8889%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5586/6124 (91.2149%)
___Train Local_ResNet_18,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5440/6124 (88.8308%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1594, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4670/5025 (92.9353%)
___Train Local_ResNet_18,  epoch 127, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4649/5025 (92.5174%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0961, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3221/3472 (92.7707%)
___Train Local_ResNet_18,  epoch 127, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3260/3472 (93.8940%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8487, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4576/5037 (90.8477%)
___Train Local_ResNet_18,  epoch 127, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4604/5037 (91.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9722, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5209/5582 (93.3178%)
___Train Local_ResNet_18,  epoch 127, local model 15, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5008/5582 (89.7169%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.3641, Accuracy: 5030/10000 (50.3000%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4709/5116 (92.0446%)
___Train Local_ResNet_18,  epoch 127, local model 67, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4623/5116 (90.3636%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9272, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4196/4518 (92.8730%)
___Train Local_ResNet_18,  epoch 127, local model 34, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4154/4518 (91.9433%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0567, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4511/4928 (91.5381%)
___Train Local_ResNet_18,  epoch 127, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4491/4928 (91.1323%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0849, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4170/4558 (91.4875%)
___Train Local_ResNet_18,  epoch 127, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4080/4558 (89.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.1162, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3082/3297 (93.4789%)
___Train Local_ResNet_18,  epoch 127, local model 68, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3100/3297 (94.0249%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.7743, Accuracy: 5885/10000 (58.8500%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3514/3756 (93.5570%)
___Train Local_ResNet_18,  epoch 127, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3533/3756 (94.0628%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8298, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4306/4651 (92.5822%)
___Train Local_ResNet_18,  epoch 127, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4199/4651 (90.2817%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 2.0428, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4142/4441 (93.2673%)
___Train Local_ResNet_18,  epoch 127, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4152/4441 (93.4925%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9202, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3306/3638 (90.8741%)
___Train Local_ResNet_18,  epoch 127, local model 76, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3340/3638 (91.8087%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8645, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4238/4596 (92.2106%)
___Train Local_ResNet_18,  epoch 127, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4280/4596 (93.1245%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.9345, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3011/3271 (92.0514%)
___Train Local_ResNet_18,  epoch 127, local model 83, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3000/3271 (91.7151%)
___Test Local_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.8934, Accuracy: 5732/10000 (57.3200%)
time spent on training: 258.60343766212463
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 127: Average loss: 1.2404, Accuracy: 6793/10000 (67.9300%)
___Test Target_ResNet_18 poisoned: True, epoch: 127: Average loss: 0.1083, Accuracy: 9612/9900 (97.0909%)
Done in 285.8475058078766 sec.
Server Epoch:128 choose agents : [13, 36, 58, 71, 56, 99, 20, 72, 85, 87, 24, 63, 25, 69, 94, 31, 86, 97, 42, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 43.67757118486987.
Norm before scaling: 43.65033010596111. Distance: 1.2856192175216337
Total norm for 4 adversaries is: 43.65033010596111. distance: 1.2856192175216337
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0314, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5092/5305 (95.9849%), train_poison_data_count: 415
Global model norm: 43.67757118486987.
Norm before scaling: 43.650208455884695. Distance: 1.4050888778024795
Total norm for 4 adversaries is: 43.650208455884695. distance: 1.4050888778024795
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1292, Accuracy: 9560/9900 (96.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4539/4717 (96.2264%), train_poison_data_count: 370
Global model norm: 43.67757118486987.
Norm before scaling: 43.651721367207415. Distance: 1.270674018045704
Total norm for 4 adversaries is: 43.651721367207415. distance: 1.270674018045704
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.0733, Accuracy: 9710/9900 (98.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 128, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4877/5066 (96.2692%), train_poison_data_count: 400
Global model norm: 43.67757118486987.
Norm before scaling: 43.651574552786755. Distance: 1.3642268795146515
Total norm for 4 adversaries is: 43.651574552786755. distance: 1.3642268795146515
___Test Local_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1014, Accuracy: 9637/9900 (97.3434%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4574/4989 (91.6817%)
___Train Local_ResNet_18,  epoch 128, local model 56, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4557/4989 (91.3410%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0684, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4158/4465 (93.1243%)
___Train Local_ResNet_18,  epoch 128, local model 99, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4185/4465 (93.7290%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9765, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4039/4315 (93.6037%)
___Train Local_ResNet_18,  epoch 128, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4035/4315 (93.5110%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8951, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4306/4767 (90.3293%)
___Train Local_ResNet_18,  epoch 128, local model 72, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4258/4767 (89.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1404, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5751/6391 (89.9859%)
___Train Local_ResNet_18,  epoch 128, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5582/6391 (87.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.0757, Accuracy: 5245/10000 (52.4500%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3366/3672 (91.6667%)
___Train Local_ResNet_18,  epoch 128, local model 87, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3330/3672 (90.6863%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9265, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3694/3969 (93.0713%)
___Train Local_ResNet_18,  epoch 128, local model 24, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3635/3969 (91.5848%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8944, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3362/3590 (93.6490%)
___Train Local_ResNet_18,  epoch 128, local model 63, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3241/3590 (90.2786%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.1544, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5385/5902 (91.2403%)
___Train Local_ResNet_18,  epoch 128, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5132/5902 (86.9536%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2597, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3749/4013 (93.4214%)
___Train Local_ResNet_18,  epoch 128, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3713/4013 (92.5243%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.9046, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4442/4804 (92.4646%)
___Train Local_ResNet_18,  epoch 128, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4124/4804 (85.8451%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.2248, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3858/4175 (92.4072%)
___Train Local_ResNet_18,  epoch 128, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3820/4175 (91.4970%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8568, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3300/3616 (91.2611%)
___Train Local_ResNet_18,  epoch 128, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3320/3616 (91.8142%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.7295, Accuracy: 5960/10000 (59.6000%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3993/4361 (91.5616%)
___Train Local_ResNet_18,  epoch 128, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3927/4361 (90.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3724, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5031/5424 (92.7544%)
___Train Local_ResNet_18,  epoch 128, local model 42, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5004/5424 (92.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 2.3530, Accuracy: 5064/10000 (50.6400%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3570/3837 (93.0414%)
___Train Local_ResNet_18,  epoch 128, local model 39, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3570/3837 (93.0414%)
___Test Local_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.8869, Accuracy: 5692/10000 (56.9200%)
time spent on training: 260.56638860702515
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 128: Average loss: 1.2403, Accuracy: 6795/10000 (67.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 128: Average loss: 0.1095, Accuracy: 9611/9900 (97.0808%)
Done in 287.7715027332306 sec.
Server Epoch:129 choose agents : [13, 36, 58, 71, 74, 38, 45, 67, 3, 39, 93, 14, 27, 44, 92, 79, 60, 98, 20, 46].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4734/4885 (96.9089%), train_poison_data_count: 385
Global model norm: 43.69768635716026.
Norm before scaling: 43.67144733690424. Distance: 1.32420488648486
Total norm for 4 adversaries is: 43.67144733690424. distance: 1.32420488648486
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0527, Accuracy: 9747/9900 (98.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5126/5305 (96.6258%), train_poison_data_count: 415
Global model norm: 43.69768635716026.
Norm before scaling: 43.66956193561412. Distance: 1.4199311100004877
Total norm for 4 adversaries is: 43.66956193561412. distance: 1.4199311100004877
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0358, Accuracy: 9818/9900 (99.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 43.69768635716026.
Norm before scaling: 43.67118318995877. Distance: 1.2734983464781828
Total norm for 4 adversaries is: 43.67118318995877. distance: 1.2734983464781828
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0363, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4869/5066 (96.1113%), train_poison_data_count: 400
Global model norm: 43.69768635716026.
Norm before scaling: 43.6737519162862. Distance: 1.4122671880690711
Total norm for 4 adversaries is: 43.6737519162862. distance: 1.4122671880690711
___Test Local_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.0487, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4070/4416 (92.1649%)
___Train Local_ResNet_18,  epoch 129, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4028/4416 (91.2138%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9233, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5257/5740 (91.5854%)
___Train Local_ResNet_18,  epoch 129, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5144/5740 (89.6167%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1857, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4595/5037 (91.2249%)
___Train Local_ResNet_18,  epoch 129, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4596/5037 (91.2448%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0883, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4711/5116 (92.0837%)
___Train Local_ResNet_18,  epoch 129, local model 67, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4581/5116 (89.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0801, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4551/4918 (92.5376%)
___Train Local_ResNet_18,  epoch 129, local model 3, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4489/4918 (91.2769%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.1014, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3583/3837 (93.3802%)
___Train Local_ResNet_18,  epoch 129, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3613/3837 (94.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8778, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4325/4651 (92.9908%)
___Train Local_ResNet_18,  epoch 129, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4279/4651 (92.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9988, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3597/3861 (93.1624%)
___Train Local_ResNet_18,  epoch 129, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3584/3861 (92.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9622, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3882/4223 (91.9252%)
___Train Local_ResNet_18,  epoch 129, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3906/4223 (92.4935%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0228, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4288/4662 (91.9777%)
___Train Local_ResNet_18,  epoch 129, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4298/4662 (92.1922%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.9680, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5767/6263 (92.0805%)
___Train Local_ResNet_18,  epoch 129, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5696/6263 (90.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0746, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3472/3781 (91.8276%)
___Train Local_ResNet_18,  epoch 129, local model 79, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3190/3781 (84.3692%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.7238, Accuracy: 4431/10000 (44.3100%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3527/3804 (92.7182%)
___Train Local_ResNet_18,  epoch 129, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3521/3804 (92.5605%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.0052, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3573/3828 (93.3386%)
___Train Local_ResNet_18,  epoch 129, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3589/3828 (93.7565%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8757, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4041/4315 (93.6501%)
___Train Local_ResNet_18,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4043/4315 (93.6964%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.8706, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4490/4956 (90.5973%)
___Train Local_ResNet_18,  epoch 129, local model 46, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4370/4956 (88.1759%)
___Test Local_ResNet_18 poisoned: False, epoch: 129: Average loss: 2.2105, Accuracy: 5054/10000 (50.5400%)
time spent on training: 260.4730136394501
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 129: Average loss: 1.2433, Accuracy: 6804/10000 (68.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 129: Average loss: 0.1060, Accuracy: 9622/9900 (97.1919%)
Done in 287.70484375953674 sec.
Server Epoch:130 choose agents : [13, 36, 58, 71, 44, 86, 98, 68, 97, 43, 75, 12, 67, 59, 25, 49, 99, 4, 14, 61].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4750/4885 (97.2364%), train_poison_data_count: 385
Global model norm: 43.717896982832585.
Norm before scaling: 43.68771934181347. Distance: 1.2237410440399725
Total norm for 4 adversaries is: 43.68771934181347. distance: 1.2237410440399725
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0737, Accuracy: 9726/9900 (98.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 36, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5116/5305 (96.4373%), train_poison_data_count: 415
Global model norm: 43.717896982832585.
Norm before scaling: 43.68832147832816. Distance: 1.3963878678273691
Total norm for 4 adversaries is: 43.68832147832816. distance: 1.3963878678273691
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0408, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4565/4717 (96.7776%), train_poison_data_count: 370
Global model norm: 43.717896982832585.
Norm before scaling: 43.690521790611946. Distance: 1.2233690615399069
Total norm for 4 adversaries is: 43.690521790611946. distance: 1.2233690615399069
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0491, Accuracy: 9767/9900 (98.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 130, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4874/5066 (96.2100%), train_poison_data_count: 400
Global model norm: 43.717896982832585.
Norm before scaling: 43.69073832329199. Distance: 1.3633652800537643
Total norm for 4 adversaries is: 43.69073832329199. distance: 1.3633652800537643
___Test Local_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.0559, Accuracy: 9755/9900 (98.5354%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4288/4662 (91.9777%)
___Train Local_ResNet_18,  epoch 130, local model 44, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4277/4662 (91.7417%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9731, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3298/3616 (91.2058%)
___Train Local_ResNet_18,  epoch 130, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3310/3616 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8130, Accuracy: 5894/10000 (58.9400%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3593/3828 (93.8610%)
___Train Local_ResNet_18,  epoch 130, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3562/3828 (93.0512%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8557, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3057/3297 (92.7207%)
___Train Local_ResNet_18,  epoch 130, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3078/3297 (93.3576%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8611, Accuracy: 5807/10000 (58.0700%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3974/4361 (91.1259%)
___Train Local_ResNet_18,  epoch 130, local model 97, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3764/4361 (86.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9641, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4244/4576 (92.7448%)
___Train Local_ResNet_18,  epoch 130, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4216/4576 (92.1329%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9530, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3981/4295 (92.6892%)
___Train Local_ResNet_18,  epoch 130, local model 75, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3961/4295 (92.2235%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8555, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4633/5083 (91.1470%)
___Train Local_ResNet_18,  epoch 130, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4471/5083 (87.9599%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1664, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4682/5116 (91.5168%)
___Train Local_ResNet_18,  epoch 130, local model 67, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4604/5116 (89.9922%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1255, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3783/4046 (93.4998%)
___Train Local_ResNet_18,  epoch 130, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3771/4046 (93.2032%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.8322, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5378/5902 (91.1217%)
___Train Local_ResNet_18,  epoch 130, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5091/5902 (86.2589%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.1397, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4805/5197 (92.4572%)
___Train Local_ResNet_18,  epoch 130, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4648/5197 (89.4362%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.3078, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4145/4465 (92.8331%)
___Train Local_ResNet_18,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4142/4465 (92.7660%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.9342, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3433/3704 (92.6836%)
___Train Local_ResNet_18,  epoch 130, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3445/3704 (93.0076%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.7978, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3594/3861 (93.0847%)
___Train Local_ResNet_18,  epoch 130, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3550/3861 (91.9451%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 2.0098, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3853/4126 (93.3834%)
___Train Local_ResNet_18,  epoch 130, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3862/4126 (93.6016%)
___Test Local_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.6712, Accuracy: 6055/10000 (60.5500%)
time spent on training: 258.68447828292847
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 130: Average loss: 1.2480, Accuracy: 6786/10000 (67.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 130: Average loss: 0.1049, Accuracy: 9624/9900 (97.2121%)
Done in 286.08473944664 sec.
Server Epoch:131 choose agents : [13, 36, 58, 71, 17, 38, 44, 73, 9, 33, 5, 65, 45, 6, 26, 78, 11, 10, 39, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4758/4885 (97.4002%), train_poison_data_count: 385
Global model norm: 43.737872202974735.
Norm before scaling: 43.707677632017635. Distance: 1.2226025261821512
Total norm for 4 adversaries is: 43.707677632017635. distance: 1.2226025261821512
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.1006, Accuracy: 9656/9900 (97.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5130/5305 (96.7012%), train_poison_data_count: 415
Global model norm: 43.737872202974735.
Norm before scaling: 43.707514248213805. Distance: 1.3494304532860968
Total norm for 4 adversaries is: 43.707514248213805. distance: 1.3494304532860968
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0975, Accuracy: 9662/9900 (97.5960%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 43.737872202974735.
Norm before scaling: 43.70950274119819. Distance: 1.2266040965030671
Total norm for 4 adversaries is: 43.70950274119819. distance: 1.2266040965030671
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0469, Accuracy: 9776/9900 (98.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 131, local model 71, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4867/5066 (96.0719%), train_poison_data_count: 400
Global model norm: 43.737872202974735.
Norm before scaling: 43.712122275051605. Distance: 1.3790914611057483
Total norm for 4 adversaries is: 43.712122275051605. distance: 1.3790914611057483
___Test Local_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0351, Accuracy: 9817/9900 (99.1616%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4141/4511 (91.7978%)
___Train Local_ResNet_18,  epoch 131, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4096/4511 (90.8003%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9967, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5244/5740 (91.3589%)
___Train Local_ResNet_18,  epoch 131, local model 38, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5140/5740 (89.5470%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.1738, Accuracy: 5154/10000 (51.5400%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4289/4662 (91.9991%)
___Train Local_ResNet_18,  epoch 131, local model 44, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4252/4662 (91.2055%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0600, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3907/4235 (92.2550%)
___Train Local_ResNet_18,  epoch 131, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3852/4235 (90.9563%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9938, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4841/5265 (91.9468%)
___Train Local_ResNet_18,  epoch 131, local model 9, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4721/5265 (89.6676%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0458, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4168/4433 (94.0221%)
___Train Local_ResNet_18,  epoch 131, local model 33, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4073/4433 (91.8791%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0573, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4253/4596 (92.5370%)
___Train Local_ResNet_18,  epoch 131, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4266/4596 (92.8198%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9312, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4668/5055 (92.3442%)
___Train Local_ResNet_18,  epoch 131, local model 65, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4598/5055 (90.9594%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0059, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4522/5037 (89.7757%)
___Train Local_ResNet_18,  epoch 131, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4598/5037 (91.2845%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0772, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4229/4538 (93.1908%)
___Train Local_ResNet_18,  epoch 131, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4274/4538 (94.1825%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9564, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3559/3756 (94.7551%)
___Train Local_ResNet_18,  epoch 131, local model 26, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3536/3756 (94.1427%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8835, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3729/4025 (92.6460%)
___Train Local_ResNet_18,  epoch 131, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3757/4025 (93.3416%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8619, Accuracy: 5703/10000 (57.0300%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4740/5244 (90.3890%)
___Train Local_ResNet_18,  epoch 131, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4670/5244 (89.0542%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.0722, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4340/4663 (93.0731%)
___Train Local_ResNet_18,  epoch 131, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4365/4663 (93.6093%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.9284, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3602/3837 (93.8754%)
___Train Local_ResNet_18,  epoch 131, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3616/3837 (94.2403%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.8751, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4114/4481 (91.8099%)
___Train Local_ResNet_18,  epoch 131, local model 7, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3915/4481 (87.3689%)
___Test Local_ResNet_18 poisoned: False, epoch: 131: Average loss: 2.3013, Accuracy: 5117/10000 (51.1700%)
time spent on training: 262.8117368221283
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 131: Average loss: 1.2516, Accuracy: 6764/10000 (67.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 131: Average loss: 0.0958, Accuracy: 9643/9900 (97.4040%)
Done in 289.75754952430725 sec.
Server Epoch:132 choose agents : [13, 36, 58, 71, 90, 32, 20, 79, 91, 17, 84, 42, 81, 50, 88, 22, 25, 70, 0, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4742/4885 (97.0727%), train_poison_data_count: 385
Global model norm: 43.7586096439175.
Norm before scaling: 43.72905190452624. Distance: 1.2224795180245112
Total norm for 4 adversaries is: 43.72905190452624. distance: 1.2224795180245112
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.1082, Accuracy: 9615/9900 (97.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5122/5305 (96.5504%), train_poison_data_count: 415
Global model norm: 43.7586096439175.
Norm before scaling: 43.729280808172454. Distance: 1.3735717811949593
Total norm for 4 adversaries is: 43.729280808172454. distance: 1.3735717811949593
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0587, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4552/4717 (96.5020%), train_poison_data_count: 370
Global model norm: 43.7586096439175.
Norm before scaling: 43.731054770805464. Distance: 1.2331358085580122
Total norm for 4 adversaries is: 43.731054770805464. distance: 1.2331358085580122
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0388, Accuracy: 9799/9900 (98.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 132, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4879/5066 (96.3087%), train_poison_data_count: 400
Global model norm: 43.7586096439175.
Norm before scaling: 43.733166404343514. Distance: 1.3945765127321617
Total norm for 4 adversaries is: 43.733166404343514. distance: 1.3945765127321617
___Test Local_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0179, Accuracy: 9853/9900 (99.5253%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4095/4362 (93.8790%)
___Train Local_ResNet_18,  epoch 132, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3917/4362 (89.7983%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0805, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5031/5591 (89.9839%)
___Train Local_ResNet_18,  epoch 132, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4914/5591 (87.8913%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2119, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4046/4315 (93.7659%)
___Train Local_ResNet_18,  epoch 132, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3988/4315 (92.4218%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8671, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3551/3781 (93.9170%)
___Train Local_ResNet_18,  epoch 132, local model 79, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3279/3781 (86.7231%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2789, Accuracy: 5004/10000 (50.0400%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3814/4158 (91.7268%)
___Train Local_ResNet_18,  epoch 132, local model 91, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3786/4158 (91.0534%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9548, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4121/4511 (91.3545%)
___Train Local_ResNet_18,  epoch 132, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4146/4511 (91.9087%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0140, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4439/4793 (92.6142%)
___Train Local_ResNet_18,  epoch 132, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4398/4793 (91.7588%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.9882, Accuracy: 5564/10000 (55.6400%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4921/5424 (90.7264%)
___Train Local_ResNet_18,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4974/5424 (91.7035%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2478, Accuracy: 5089/10000 (50.8900%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4320/4618 (93.5470%)
___Train Local_ResNet_18,  epoch 132, local model 81, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4141/4618 (89.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0543, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4006/4368 (91.7125%)
___Train Local_ResNet_18,  epoch 132, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3941/4368 (90.2244%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0453, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4451/4934 (90.2108%)
___Train Local_ResNet_18,  epoch 132, local model 88, internal_epoch   2,  Average loss: 0.0107, Accuracy: 3939/4934 (79.8338%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.3443, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4782/5232 (91.3991%)
___Train Local_ResNet_18,  epoch 132, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4705/5232 (89.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0308, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5403/5902 (91.5452%)
___Train Local_ResNet_18,  epoch 132, local model 25, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5179/5902 (87.7499%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.1694, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4989/5392 (92.5260%)
___Train Local_ResNet_18,  epoch 132, local model 70, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4885/5392 (90.5972%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.0735, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4641/5017 (92.5055%)
___Train Local_ResNet_18,  epoch 132, local model 0, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4550/5017 (90.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.8309, Accuracy: 5752/10000 (57.5200%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4753/5195 (91.4918%)
___Train Local_ResNet_18,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4522/5195 (87.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 132: Average loss: 2.2634, Accuracy: 5164/10000 (51.6400%)
time spent on training: 266.0852735042572
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 132: Average loss: 1.2550, Accuracy: 6766/10000 (67.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 132: Average loss: 0.0876, Accuracy: 9667/9900 (97.6465%)
Done in 293.53935170173645 sec.
Server Epoch:133 choose agents : [13, 36, 58, 71, 9, 61, 8, 53, 83, 10, 78, 93, 94, 86, 18, 49, 6, 85, 4, 73].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4741/4885 (97.0522%), train_poison_data_count: 385
Global model norm: 43.78195122341725.
Norm before scaling: 43.75314162827339. Distance: 1.2592594519679434
Total norm for 4 adversaries is: 43.75314162827339. distance: 1.2592594519679434
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.1045, Accuracy: 9623/9900 (97.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5107/5305 (96.2677%), train_poison_data_count: 415
Global model norm: 43.78195122341725.
Norm before scaling: 43.75267988444036. Distance: 1.3958815333836156
Total norm for 4 adversaries is: 43.75267988444036. distance: 1.3958815333836156
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0408, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4572/4717 (96.9260%), train_poison_data_count: 370
Global model norm: 43.78195122341725.
Norm before scaling: 43.75314999820727. Distance: 1.2024294341194686
Total norm for 4 adversaries is: 43.75314999820727. distance: 1.2024294341194686
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0564, Accuracy: 9753/9900 (98.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 133, local model 71, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4874/5066 (96.2100%), train_poison_data_count: 400
Global model norm: 43.78195122341725.
Norm before scaling: 43.75765139565951. Distance: 1.427171421348857
Total norm for 4 adversaries is: 43.75765139565951. distance: 1.427171421348857
___Test Local_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0765, Accuracy: 9716/9900 (98.1414%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4836/5265 (91.8519%)
___Train Local_ResNet_18,  epoch 133, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4629/5265 (87.9202%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1281, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3851/4126 (93.3349%)
___Train Local_ResNet_18,  epoch 133, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3872/4126 (93.8439%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9757, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4156/4501 (92.3350%)
___Train Local_ResNet_18,  epoch 133, local model 8, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4071/4501 (90.4466%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0891, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5596/6124 (91.3782%)
___Train Local_ResNet_18,  epoch 133, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5381/6124 (87.8674%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1009, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3029/3271 (92.6017%)
___Train Local_ResNet_18,  epoch 133, local model 83, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3073/3271 (93.9468%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8007, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4355/4663 (93.3948%)
___Train Local_ResNet_18,  epoch 133, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4320/4663 (92.6442%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9799, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3757/4025 (93.3416%)
___Train Local_ResNet_18,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3726/4025 (92.5714%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8333, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4293/4651 (92.3027%)
___Train Local_ResNet_18,  epoch 133, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4230/4651 (90.9482%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1252, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4399/4804 (91.5695%)
___Train Local_ResNet_18,  epoch 133, local model 94, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3987/4804 (82.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.4998, Accuracy: 4643/10000 (46.4300%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3343/3616 (92.4502%)
___Train Local_ResNet_18,  epoch 133, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3338/3616 (92.3119%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8237, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3648/3911 (93.2754%)
___Train Local_ResNet_18,  epoch 133, local model 18, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3507/3911 (89.6702%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0166, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4803/5197 (92.4187%)
___Train Local_ResNet_18,  epoch 133, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4722/5197 (90.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.2020, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4263/4538 (93.9401%)
___Train Local_ResNet_18,  epoch 133, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4299/4538 (94.7334%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.9263, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5777/6391 (90.3927%)
___Train Local_ResNet_18,  epoch 133, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5691/6391 (89.0471%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.0767, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3454/3704 (93.2505%)
___Train Local_ResNet_18,  epoch 133, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3430/3704 (92.6026%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.8479, Accuracy: 5736/10000 (57.3600%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3911/4235 (92.3495%)
___Train Local_ResNet_18,  epoch 133, local model 73, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3788/4235 (89.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 133: Average loss: 2.1182, Accuracy: 5414/10000 (54.1400%)
time spent on training: 260.236444234848
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 133: Average loss: 1.2612, Accuracy: 6748/10000 (67.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 133: Average loss: 0.0882, Accuracy: 9666/9900 (97.6364%)
Done in 287.3482029438019 sec.
Server Epoch:134 choose agents : [13, 36, 58, 71, 67, 15, 73, 95, 7, 22, 44, 48, 34, 16, 21, 88, 14, 86, 74, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4747/4885 (97.1750%), train_poison_data_count: 385
Global model norm: 43.80316106110737.
Norm before scaling: 43.77247469604186. Distance: 1.232086329417262
Total norm for 4 adversaries is: 43.77247469604186. distance: 1.232086329417262
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0641, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5114/5305 (96.3996%), train_poison_data_count: 415
Global model norm: 43.80316106110737.
Norm before scaling: 43.77419671280745. Distance: 1.3904102459649637
Total norm for 4 adversaries is: 43.77419671280745. distance: 1.3904102459649637
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0335, Accuracy: 9817/9900 (99.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4561/4717 (96.6928%), train_poison_data_count: 370
Global model norm: 43.80316106110737.
Norm before scaling: 43.77376168338817. Distance: 1.2164428097835847
Total norm for 4 adversaries is: 43.77376168338817. distance: 1.2164428097835847
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0603, Accuracy: 9748/9900 (98.4646%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4895/5066 (96.6246%), train_poison_data_count: 400
Global model norm: 43.80316106110737.
Norm before scaling: 43.77698804871331. Distance: 1.371070187792779
Total norm for 4 adversaries is: 43.77698804871331. distance: 1.371070187792779
___Test Local_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0492, Accuracy: 9778/9900 (98.7677%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4761/5116 (93.0610%)
___Train Local_ResNet_18,  epoch 134, local model 67, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4661/5116 (91.1063%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0254, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5196/5582 (93.0849%)
___Train Local_ResNet_18,  epoch 134, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5156/5582 (92.3683%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0775, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3955/4235 (93.3884%)
___Train Local_ResNet_18,  epoch 134, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3829/4235 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2065, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4182/4625 (90.4216%)
___Train Local_ResNet_18,  epoch 134, local model 95, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4003/4625 (86.5514%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3323, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4107/4481 (91.6536%)
___Train Local_ResNet_18,  epoch 134, local model 7, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4012/4481 (89.5336%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3423, Accuracy: 5031/10000 (50.3100%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4752/5232 (90.8257%)
___Train Local_ResNet_18,  epoch 134, local model 22, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4613/5232 (88.1690%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.2106, Accuracy: 5160/10000 (51.6000%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4343/4662 (93.1574%)
___Train Local_ResNet_18,  epoch 134, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4269/4662 (91.5701%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0232, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4178/4441 (94.0779%)
___Train Local_ResNet_18,  epoch 134, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4158/4441 (93.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0114, Accuracy: 5636/10000 (56.3600%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4210/4518 (93.1828%)
___Train Local_ResNet_18,  epoch 134, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4196/4518 (92.8730%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9927, Accuracy: 5510/10000 (55.1000%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4588/4928 (93.1006%)
___Train Local_ResNet_18,  epoch 134, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4456/4928 (90.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0473, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4239/4634 (91.4760%)
___Train Local_ResNet_18,  epoch 134, local model 21, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4174/4634 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8970, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4528/4934 (91.7714%)
___Train Local_ResNet_18,  epoch 134, local model 88, internal_epoch   2,  Average loss: 0.0071, Accuracy: 4257/4934 (86.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.3009, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3604/3861 (93.3437%)
___Train Local_ResNet_18,  epoch 134, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3544/3861 (91.7897%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.8851, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3307/3616 (91.4546%)
___Train Local_ResNet_18,  epoch 134, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3289/3616 (90.9569%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9255, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4062/4416 (91.9837%)
___Train Local_ResNet_18,  epoch 134, local model 74, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4019/4416 (91.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 2.0600, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3533/3797 (93.0471%)
___Train Local_ResNet_18,  epoch 134, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3513/3797 (92.5204%)
___Test Local_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.9817, Accuracy: 5528/10000 (55.2800%)
time spent on training: 258.7809085845947
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 134: Average loss: 1.2644, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 134: Average loss: 0.0861, Accuracy: 9672/9900 (97.6970%)
Done in 286.41368079185486 sec.
Server Epoch:135 choose agents : [13, 36, 58, 71, 92, 75, 56, 27, 53, 7, 81, 48, 69, 17, 74, 46, 6, 9, 49, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4745/4885 (97.1341%), train_poison_data_count: 385
Global model norm: 43.8237729011214.
Norm before scaling: 43.794427776794564. Distance: 1.2550977708339766
Total norm for 4 adversaries is: 43.794427776794564. distance: 1.2550977708339766
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.1018, Accuracy: 9624/9900 (97.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 43.8237729011214.
Norm before scaling: 43.79186612902561. Distance: 1.330425334766384
Total norm for 4 adversaries is: 43.79186612902561. distance: 1.330425334766384
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0437, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4545/4717 (96.3536%), train_poison_data_count: 370
Global model norm: 43.8237729011214.
Norm before scaling: 43.795853482111326. Distance: 1.2606402532499166
Total norm for 4 adversaries is: 43.795853482111326. distance: 1.2606402532499166
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0468, Accuracy: 9780/9900 (98.7879%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 135, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 43.8237729011214.
Norm before scaling: 43.796186558092586. Distance: 1.3000106132514246
Total norm for 4 adversaries is: 43.796186558092586. distance: 1.3000106132514246
___Test Local_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0998, Accuracy: 9635/9900 (97.3232%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5717/6263 (91.2821%)
___Train Local_ResNet_18,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5671/6263 (90.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1769, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4000/4295 (93.1315%)
___Train Local_ResNet_18,  epoch 135, local model 75, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3856/4295 (89.7788%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1109, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4580/4989 (91.8020%)
___Train Local_ResNet_18,  epoch 135, local model 56, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4476/4989 (89.7174%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7857, Accuracy: 5767/10000 (57.6700%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3919/4223 (92.8013%)
___Train Local_ResNet_18,  epoch 135, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3930/4223 (93.0618%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2126, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5568/6124 (90.9210%)
___Train Local_ResNet_18,  epoch 135, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5378/6124 (87.8184%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9913, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4053/4481 (90.4486%)
___Train Local_ResNet_18,  epoch 135, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3897/4481 (86.9672%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2416, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4297/4618 (93.0489%)
___Train Local_ResNet_18,  epoch 135, local model 81, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4229/4618 (91.5764%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9354, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4203/4441 (94.6408%)
___Train Local_ResNet_18,  epoch 135, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4154/4441 (93.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9559, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3726/4013 (92.8482%)
___Train Local_ResNet_18,  epoch 135, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3741/4013 (93.2220%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8613, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4139/4511 (91.7535%)
___Train Local_ResNet_18,  epoch 135, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4112/4511 (91.1550%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.9841, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4084/4416 (92.4819%)
___Train Local_ResNet_18,  epoch 135, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4061/4416 (91.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.8695, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4530/4956 (91.4044%)
___Train Local_ResNet_18,  epoch 135, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4439/4956 (89.5682%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.2047, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4277/4538 (94.2486%)
___Train Local_ResNet_18,  epoch 135, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4247/4538 (93.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.7608, Accuracy: 5872/10000 (58.7200%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4843/5265 (91.9848%)
___Train Local_ResNet_18,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4675/5265 (88.7939%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.0532, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4831/5197 (92.9575%)
___Train Local_ResNet_18,  epoch 135, local model 49, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4765/5197 (91.6875%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1604, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4308/4716 (91.3486%)
___Train Local_ResNet_18,  epoch 135, local model 28, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4212/4716 (89.3130%)
___Test Local_ResNet_18 poisoned: False, epoch: 135: Average loss: 2.1425, Accuracy: 5315/10000 (53.1500%)
time spent on training: 261.70927810668945
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 135: Average loss: 1.2572, Accuracy: 6766/10000 (67.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 135: Average loss: 0.0909, Accuracy: 9663/9900 (97.6061%)
Done in 289.13262248039246 sec.
Server Epoch:136 choose agents : [13, 36, 58, 71, 86, 20, 40, 94, 90, 92, 6, 21, 67, 28, 59, 34, 62, 38, 15, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4749/4885 (97.2160%), train_poison_data_count: 385
Global model norm: 43.84548870616922.
Norm before scaling: 43.81674317452034. Distance: 1.2502117931231431
Total norm for 4 adversaries is: 43.81674317452034. distance: 1.2502117931231431
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0964, Accuracy: 9646/9900 (97.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5123/5305 (96.5693%), train_poison_data_count: 415
Global model norm: 43.84548870616922.
Norm before scaling: 43.81622498875987. Distance: 1.3577418986096184
Total norm for 4 adversaries is: 43.81622498875987. distance: 1.3577418986096184
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0629, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4553/4717 (96.5232%), train_poison_data_count: 370
Global model norm: 43.84548870616922.
Norm before scaling: 43.816718101156894. Distance: 1.2604064257917702
Total norm for 4 adversaries is: 43.816718101156894. distance: 1.2604064257917702
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.1551, Accuracy: 9479/9900 (95.7475%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 136, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4908/5066 (96.8812%), train_poison_data_count: 400
Global model norm: 43.84548870616922.
Norm before scaling: 43.816456222947785. Distance: 1.3174192792569068
Total norm for 4 adversaries is: 43.816456222947785. distance: 1.3174192792569068
___Test Local_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0483, Accuracy: 9777/9900 (98.7576%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3343/3616 (92.4502%)
___Train Local_ResNet_18,  epoch 136, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3382/3616 (93.5288%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8921, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4056/4315 (93.9977%)
___Train Local_ResNet_18,  epoch 136, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4027/4315 (93.3256%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8792, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5037/5455 (92.3373%)
___Train Local_ResNet_18,  epoch 136, local model 40, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4951/5455 (90.7608%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0850, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4379/4804 (91.1532%)
___Train Local_ResNet_18,  epoch 136, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4123/4804 (85.8243%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.4452, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4110/4362 (94.2228%)
___Train Local_ResNet_18,  epoch 136, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4137/4362 (94.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.7949, Accuracy: 5826/10000 (58.2600%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5769/6263 (92.1124%)
___Train Local_ResNet_18,  epoch 136, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5768/6263 (92.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0409, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4285/4538 (94.4249%)
___Train Local_ResNet_18,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4255/4538 (93.7638%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9464, Accuracy: 5676/10000 (56.7600%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4263/4634 (91.9940%)
___Train Local_ResNet_18,  epoch 136, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4240/4634 (91.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9434, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4715/5116 (92.1618%)
___Train Local_ResNet_18,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4656/5116 (91.0086%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0631, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4227/4716 (89.6310%)
___Train Local_ResNet_18,  epoch 136, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4287/4716 (90.9033%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9449, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3779/4046 (93.4009%)
___Train Local_ResNet_18,  epoch 136, local model 59, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3766/4046 (93.0796%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.9346, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4165/4518 (92.1868%)
___Train Local_ResNet_18,  epoch 136, local model 34, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4111/4518 (90.9916%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0895, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4653/5063 (91.9020%)
___Train Local_ResNet_18,  epoch 136, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4453/5063 (87.9518%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.2447, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5280/5740 (91.9861%)
___Train Local_ResNet_18,  epoch 136, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5204/5740 (90.6620%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0802, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5217/5582 (93.4611%)
___Train Local_ResNet_18,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5084/5582 (91.0785%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 2.0778, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4169/4433 (94.0447%)
___Train Local_ResNet_18,  epoch 136, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4152/4433 (93.6612%)
___Test Local_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.8531, Accuracy: 5789/10000 (57.8900%)
time spent on training: 267.79635643959045
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 136: Average loss: 1.2586, Accuracy: 6764/10000 (67.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 136: Average loss: 0.0933, Accuracy: 9649/9900 (97.4646%)
Done in 295.08215594291687 sec.
Server Epoch:137 choose agents : [13, 36, 58, 71, 49, 78, 7, 93, 25, 61, 50, 85, 31, 5, 21, 27, 18, 33, 41, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 43.86702123187546.
Norm before scaling: 43.83499556219323. Distance: 1.2289851372505294
Total norm for 4 adversaries is: 43.83499556219323. distance: 1.2289851372505294
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0718, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5121/5305 (96.5316%), train_poison_data_count: 415
Global model norm: 43.86702123187546.
Norm before scaling: 43.83796541713658. Distance: 1.4063820670949414
Total norm for 4 adversaries is: 43.83796541713658. distance: 1.4063820670949414
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1444, Accuracy: 9546/9900 (96.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4559/4717 (96.6504%), train_poison_data_count: 370
Global model norm: 43.86702123187546.
Norm before scaling: 43.83664272178228. Distance: 1.188157351403052
Total norm for 4 adversaries is: 43.83664272178228. distance: 1.188157351403052
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.1358, Accuracy: 9541/9900 (96.3737%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 137, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4893/5066 (96.5851%), train_poison_data_count: 400
Global model norm: 43.86702123187546.
Norm before scaling: 43.840432485410226. Distance: 1.383384413905939
Total norm for 4 adversaries is: 43.840432485410226. distance: 1.383384413905939
___Test Local_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0342, Accuracy: 9815/9900 (99.1414%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4807/5197 (92.4957%)
___Train Local_ResNet_18,  epoch 137, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4615/5197 (88.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1404, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3750/4025 (93.1677%)
___Train Local_ResNet_18,  epoch 137, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3800/4025 (94.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.7746, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4141/4481 (92.4124%)
___Train Local_ResNet_18,  epoch 137, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4007/4481 (89.4220%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1767, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4350/4651 (93.5283%)
___Train Local_ResNet_18,  epoch 137, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4309/4651 (92.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9613, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5391/5902 (91.3419%)
___Train Local_ResNet_18,  epoch 137, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5169/5902 (87.5805%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2105, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3876/4126 (93.9409%)
___Train Local_ResNet_18,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3848/4126 (93.2622%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9087, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4000/4368 (91.5751%)
___Train Local_ResNet_18,  epoch 137, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3956/4368 (90.5678%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1051, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5754/6391 (90.0329%)
___Train Local_ResNet_18,  epoch 137, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5609/6391 (87.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2236, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3875/4175 (92.8144%)
___Train Local_ResNet_18,  epoch 137, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3747/4175 (89.7485%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9353, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4242/4596 (92.2977%)
___Train Local_ResNet_18,  epoch 137, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4255/4596 (92.5805%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.0892, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4286/4634 (92.4903%)
___Train Local_ResNet_18,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4229/4634 (91.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.2058, Accuracy: 5209/10000 (52.0900%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3950/4223 (93.5354%)
___Train Local_ResNet_18,  epoch 137, local model 27, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3892/4223 (92.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8420, Accuracy: 5794/10000 (57.9400%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3612/3911 (92.3549%)
___Train Local_ResNet_18,  epoch 137, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3470/3911 (88.7241%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1755, Accuracy: 5303/10000 (53.0300%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4172/4433 (94.1123%)
___Train Local_ResNet_18,  epoch 137, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4110/4433 (92.7137%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.9742, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4007/4336 (92.4124%)
___Train Local_ResNet_18,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3984/4336 (91.8819%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 2.1351, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3323/3638 (91.3414%)
___Train Local_ResNet_18,  epoch 137, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3365/3638 (92.4959%)
___Test Local_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.8864, Accuracy: 5738/10000 (57.3800%)
time spent on training: 262.45463943481445
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 137: Average loss: 1.2567, Accuracy: 6767/10000 (67.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 137: Average loss: 0.0919, Accuracy: 9652/9900 (97.4949%)
Done in 289.9652986526489 sec.
Server Epoch:138 choose agents : [13, 36, 58, 71, 26, 42, 33, 8, 78, 73, 53, 21, 28, 72, 60, 30, 70, 38, 5, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4737/4885 (96.9703%), train_poison_data_count: 385
Global model norm: 43.888053669339364.
Norm before scaling: 43.8581294911324. Distance: 1.280807232529796
Total norm for 4 adversaries is: 43.8581294911324. distance: 1.280807232529796
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0646, Accuracy: 9742/9900 (98.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5140/5305 (96.8897%), train_poison_data_count: 415
Global model norm: 43.888053669339364.
Norm before scaling: 43.85744896911042. Distance: 1.3325466825599308
Total norm for 4 adversaries is: 43.85744896911042. distance: 1.3325466825599308
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0812, Accuracy: 9696/9900 (97.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4561/4717 (96.6928%), train_poison_data_count: 370
Global model norm: 43.888053669339364.
Norm before scaling: 43.858293705498994. Distance: 1.2270321281038439
Total norm for 4 adversaries is: 43.858293705498994. distance: 1.2270321281038439
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0789, Accuracy: 9696/9900 (97.9394%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 138, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4882/5066 (96.3679%), train_poison_data_count: 400
Global model norm: 43.888053669339364.
Norm before scaling: 43.86030180264096. Distance: 1.3453312375207032
Total norm for 4 adversaries is: 43.86030180264096. distance: 1.3453312375207032
___Test Local_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0507, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3516/3756 (93.6102%)
___Train Local_ResNet_18,  epoch 138, local model 26, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3557/3756 (94.7018%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8807, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5048/5424 (93.0678%)
___Train Local_ResNet_18,  epoch 138, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4979/5424 (91.7957%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.3429, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4149/4433 (93.5935%)
___Train Local_ResNet_18,  epoch 138, local model 33, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4131/4433 (93.1875%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9038, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4146/4501 (92.1129%)
___Train Local_ResNet_18,  epoch 138, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4039/4501 (89.7356%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1604, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3756/4025 (93.3168%)
___Train Local_ResNet_18,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3796/4025 (94.3106%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9438, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3986/4235 (94.1204%)
___Train Local_ResNet_18,  epoch 138, local model 73, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3867/4235 (91.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9927, Accuracy: 5500/10000 (55.0000%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5588/6124 (91.2476%)
___Train Local_ResNet_18,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5389/6124 (87.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2886, Accuracy: 5079/10000 (50.7900%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4280/4634 (92.3608%)
___Train Local_ResNet_18,  epoch 138, local model 21, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4237/4634 (91.4329%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.9091, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4285/4716 (90.8609%)
___Train Local_ResNet_18,  epoch 138, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4280/4716 (90.7549%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0439, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4350/4767 (91.2524%)
___Train Local_ResNet_18,  epoch 138, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4239/4767 (88.9239%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1456, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3515/3804 (92.4027%)
___Train Local_ResNet_18,  epoch 138, local model 60, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3595/3804 (94.5058%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8903, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3245/3472 (93.4620%)
___Train Local_ResNet_18,  epoch 138, local model 30, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3271/3472 (94.2108%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8277, Accuracy: 5822/10000 (58.2200%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5034/5392 (93.3605%)
___Train Local_ResNet_18,  epoch 138, local model 70, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4896/5392 (90.8012%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.0856, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5327/5740 (92.8049%)
___Train Local_ResNet_18,  epoch 138, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5194/5740 (90.4878%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.2116, Accuracy: 5277/10000 (52.7700%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4251/4596 (92.4935%)
___Train Local_ResNet_18,  epoch 138, local model 5, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4249/4596 (92.4500%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 2.1337, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3361/3616 (92.9480%)
___Train Local_ResNet_18,  epoch 138, local model 86, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3336/3616 (92.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.8188, Accuracy: 5815/10000 (58.1500%)
time spent on training: 262.5685043334961
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 138: Average loss: 1.2562, Accuracy: 6767/10000 (67.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 138: Average loss: 0.0959, Accuracy: 9646/9900 (97.4343%)
Done in 289.62303709983826 sec.
Server Epoch:139 choose agents : [13, 36, 58, 71, 62, 94, 57, 26, 42, 17, 35, 89, 11, 84, 98, 59, 69, 83, 90, 29].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4740/4885 (97.0317%), train_poison_data_count: 385
Global model norm: 43.90673932111675.
Norm before scaling: 43.87598211596664. Distance: 1.2547005012570187
Total norm for 4 adversaries is: 43.87598211596664. distance: 1.2547005012570187
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0672, Accuracy: 9740/9900 (98.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5109/5305 (96.3054%), train_poison_data_count: 415
Global model norm: 43.90673932111675.
Norm before scaling: 43.877203470310185. Distance: 1.392938339919849
Total norm for 4 adversaries is: 43.877203470310185. distance: 1.392938339919849
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0466, Accuracy: 9792/9900 (98.9091%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4571/4717 (96.9048%), train_poison_data_count: 370
Global model norm: 43.90673932111675.
Norm before scaling: 43.878718291961455. Distance: 1.2404200617639434
Total norm for 4 adversaries is: 43.878718291961455. distance: 1.2404200617639434
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.1189, Accuracy: 9598/9900 (96.9495%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 139, local model 71, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4890/5066 (96.5259%), train_poison_data_count: 400
Global model norm: 43.90673932111675.
Norm before scaling: 43.8792482585376. Distance: 1.3666290014395581
Total norm for 4 adversaries is: 43.8792482585376. distance: 1.3666290014395581
___Test Local_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0173, Accuracy: 9863/9900 (99.6263%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4649/5063 (91.8230%)
___Train Local_ResNet_18,  epoch 139, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4512/5063 (89.1171%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1006, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4432/4804 (92.2565%)
___Train Local_ResNet_18,  epoch 139, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4128/4804 (85.9284%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3128, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4238/4558 (92.9794%)
___Train Local_ResNet_18,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4111/4558 (90.1931%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.3945, Accuracy: 4926/10000 (49.2600%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3597/3756 (95.7668%)
___Train Local_ResNet_18,  epoch 139, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3567/3756 (94.9681%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9090, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4959/5424 (91.4270%)
___Train Local_ResNet_18,  epoch 139, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4949/5424 (91.2426%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.2226, Accuracy: 5280/10000 (52.8000%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4143/4511 (91.8422%)
___Train Local_ResNet_18,  epoch 139, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4140/4511 (91.7757%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0880, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4781/5167 (92.5295%)
___Train Local_ResNet_18,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4798/5167 (92.8585%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0436, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4036/4356 (92.6538%)
___Train Local_ResNet_18,  epoch 139, local model 89, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3958/4356 (90.8632%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1308, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4722/5244 (90.0458%)
___Train Local_ResNet_18,  epoch 139, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4604/5244 (87.7956%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.1887, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4434/4793 (92.5099%)
___Train Local_ResNet_18,  epoch 139, local model 84, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4404/4793 (91.8840%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9859, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3597/3828 (93.9655%)
___Train Local_ResNet_18,  epoch 139, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3577/3828 (93.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9061, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3774/4046 (93.2773%)
___Train Local_ResNet_18,  epoch 139, local model 59, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3750/4046 (92.6841%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.9833, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3764/4013 (93.7952%)
___Train Local_ResNet_18,  epoch 139, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3767/4013 (93.8699%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.7375, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3008/3271 (91.9596%)
___Train Local_ResNet_18,  epoch 139, local model 83, internal_epoch   2,  Average loss: 0.0050, Accuracy: 2956/3271 (90.3699%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0328, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4129/4362 (94.6584%)
___Train Local_ResNet_18,  epoch 139, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3947/4362 (90.4860%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 2.0380, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4068/4346 (93.6033%)
___Train Local_ResNet_18,  epoch 139, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4131/4346 (95.0529%)
___Test Local_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.8019, Accuracy: 5850/10000 (58.5000%)
time spent on training: 257.9151623249054
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 139: Average loss: 1.2605, Accuracy: 6760/10000 (67.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 139: Average loss: 0.0895, Accuracy: 9665/9900 (97.6263%)
Done in 285.397668838501 sec.
Server Epoch:140 choose agents : [13, 36, 58, 71, 61, 40, 57, 73, 60, 85, 41, 10, 17, 64, 62, 20, 76, 48, 96, 9].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4760/4885 (97.4411%), train_poison_data_count: 385
Global model norm: 43.925043242188444.
Norm before scaling: 43.892578776823854. Distance: 1.209714604288187
Total norm for 4 adversaries is: 43.892578776823854. distance: 1.209714604288187
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0873, Accuracy: 9681/9900 (97.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5116/5305 (96.4373%), train_poison_data_count: 415
Global model norm: 43.925043242188444.
Norm before scaling: 43.89498437544217. Distance: 1.3941192873291588
Total norm for 4 adversaries is: 43.89498437544217. distance: 1.3941192873291588
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0186, Accuracy: 9853/9900 (99.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 58, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4556/4717 (96.5868%), train_poison_data_count: 370
Global model norm: 43.925043242188444.
Norm before scaling: 43.896530563449005. Distance: 1.2432320958989824
Total norm for 4 adversaries is: 43.896530563449005. distance: 1.2432320958989824
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0687, Accuracy: 9709/9900 (98.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 140, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4920/5066 (97.1180%), train_poison_data_count: 400
Global model norm: 43.925043242188444.
Norm before scaling: 43.89553361213132. Distance: 1.3003499458713412
Total norm for 4 adversaries is: 43.89553361213132. distance: 1.3003499458713412
___Test Local_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0679, Accuracy: 9725/9900 (98.2323%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3879/4126 (94.0136%)
___Train Local_ResNet_18,  epoch 140, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3891/4126 (94.3044%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.7513, Accuracy: 5909/10000 (59.0900%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5038/5455 (92.3556%)
___Train Local_ResNet_18,  epoch 140, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4964/5455 (90.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.1391, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4244/4558 (93.1110%)
___Train Local_ResNet_18,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4169/4558 (91.4656%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0023, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3947/4235 (93.1995%)
___Train Local_ResNet_18,  epoch 140, local model 73, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3845/4235 (90.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0029, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3545/3804 (93.1914%)
___Train Local_ResNet_18,  epoch 140, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0540, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5755/6391 (90.0485%)
___Train Local_ResNet_18,  epoch 140, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5597/6391 (87.5763%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.3812, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4010/4336 (92.4815%)
___Train Local_ResNet_18,  epoch 140, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3955/4336 (91.2131%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2644, Accuracy: 5176/10000 (51.7600%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4354/4663 (93.3734%)
___Train Local_ResNet_18,  epoch 140, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4352/4663 (93.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8433, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4129/4511 (91.5318%)
___Train Local_ResNet_18,  epoch 140, local model 17, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4109/4511 (91.0885%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8801, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4142/4503 (91.9831%)
___Train Local_ResNet_18,  epoch 140, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4017/4503 (89.2072%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.0247, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4664/5063 (92.1193%)
___Train Local_ResNet_18,  epoch 140, local model 62, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4319/5063 (85.3052%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2270, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4069/4315 (94.2990%)
___Train Local_ResNet_18,  epoch 140, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4025/4315 (93.2793%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9942, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3329/3638 (91.5063%)
___Train Local_ResNet_18,  epoch 140, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3377/3638 (92.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.8703, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4220/4441 (95.0236%)
___Train Local_ResNet_18,  epoch 140, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4180/4441 (94.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9917, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4353/4679 (93.0327%)
___Train Local_ResNet_18,  epoch 140, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4184/4679 (89.4208%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 2.2417, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4834/5265 (91.8139%)
___Train Local_ResNet_18,  epoch 140, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4714/5265 (89.5347%)
___Test Local_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.9862, Accuracy: 5530/10000 (55.3000%)
time spent on training: 261.4415805339813
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 140: Average loss: 1.2671, Accuracy: 6747/10000 (67.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 140: Average loss: 0.0898, Accuracy: 9663/9900 (97.6061%)
Done in 288.577716588974 sec.
Server Epoch:141 choose agents : [13, 36, 58, 71, 41, 98, 87, 93, 97, 80, 53, 4, 88, 0, 15, 35, 14, 2, 57, 67].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4769/4885 (97.6254%), train_poison_data_count: 385
Global model norm: 43.94579791398576.
Norm before scaling: 43.91340160839641. Distance: 1.1937571859892413
Total norm for 4 adversaries is: 43.91340160839641. distance: 1.1937571859892413
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0614, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 36, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5114/5305 (96.3996%), train_poison_data_count: 415
Global model norm: 43.94579791398576.
Norm before scaling: 43.91655239449871. Distance: 1.4303403103979118
Total norm for 4 adversaries is: 43.91655239449871. distance: 1.4303403103979118
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0110, Accuracy: 9877/9900 (99.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 43.94579791398576.
Norm before scaling: 43.91495548705119. Distance: 1.1827231752639058
Total norm for 4 adversaries is: 43.91495548705119. distance: 1.1827231752639058
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0730, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 141, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4892/5066 (96.5653%), train_poison_data_count: 400
Global model norm: 43.94579791398576.
Norm before scaling: 43.916981840118666. Distance: 1.333025832281477
Total norm for 4 adversaries is: 43.916981840118666. distance: 1.333025832281477
___Test Local_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0403, Accuracy: 9797/9900 (98.9596%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4006/4336 (92.3893%)
___Train Local_ResNet_18,  epoch 141, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3993/4336 (92.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0320, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3605/3828 (94.1745%)
___Train Local_ResNet_18,  epoch 141, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3569/3828 (93.2341%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9934, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3396/3672 (92.4837%)
___Train Local_ResNet_18,  epoch 141, local model 87, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3358/3672 (91.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1155, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4307/4651 (92.6037%)
___Train Local_ResNet_18,  epoch 141, local model 93, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4185/4651 (89.9806%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1172, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4034/4361 (92.5017%)
___Train Local_ResNet_18,  epoch 141, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3808/4361 (87.3194%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1084, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4661/5025 (92.7562%)
___Train Local_ResNet_18,  epoch 141, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4560/5025 (90.7463%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1486, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5595/6124 (91.3619%)
___Train Local_ResNet_18,  epoch 141, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5436/6124 (88.7655%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0954, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3463/3704 (93.4935%)
___Train Local_ResNet_18,  epoch 141, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3475/3704 (93.8175%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8032, Accuracy: 5889/10000 (58.8900%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4507/4934 (91.3458%)
___Train Local_ResNet_18,  epoch 141, local model 88, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4211/4934 (85.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1767, Accuracy: 5183/10000 (51.8300%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4668/5017 (93.0437%)
___Train Local_ResNet_18,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4671/5017 (93.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.8967, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5217/5582 (93.4611%)
___Train Local_ResNet_18,  epoch 141, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5085/5582 (91.0964%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.1401, Accuracy: 5228/10000 (52.2800%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4775/5167 (92.4134%)
___Train Local_ResNet_18,  epoch 141, local model 35, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4724/5167 (91.4264%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.0438, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3623/3861 (93.8358%)
___Train Local_ResNet_18,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3540/3861 (91.6861%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.9366, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3370/3646 (92.4301%)
___Train Local_ResNet_18,  epoch 141, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3381/3646 (92.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.7884, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4211/4558 (92.3870%)
___Train Local_ResNet_18,  epoch 141, local model 57, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4137/4558 (90.7635%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2651, Accuracy: 5142/10000 (51.4200%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4777/5116 (93.3737%)
___Train Local_ResNet_18,  epoch 141, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4553/5116 (88.9953%)
___Test Local_ResNet_18 poisoned: False, epoch: 141: Average loss: 2.2654, Accuracy: 5221/10000 (52.2100%)
time spent on training: 261.59644317626953
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 141: Average loss: 1.2774, Accuracy: 6721/10000 (67.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 141: Average loss: 0.0861, Accuracy: 9672/9900 (97.6970%)
Done in 288.3371481895447 sec.
Server Epoch:142 choose agents : [13, 36, 58, 71, 17, 29, 94, 22, 81, 63, 85, 37, 65, 39, 64, 43, 84, 21, 91, 38].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 43.96651502404273.
Norm before scaling: 43.93508978319963. Distance: 1.219909214487868
Total norm for 4 adversaries is: 43.93508978319963. distance: 1.219909214487868
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0852, Accuracy: 9686/9900 (97.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5106/5305 (96.2488%), train_poison_data_count: 415
Global model norm: 43.96651502404273.
Norm before scaling: 43.936541485810814. Distance: 1.40039598791141
Total norm for 4 adversaries is: 43.936541485810814. distance: 1.40039598791141
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0235, Accuracy: 9837/9900 (99.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4558/4717 (96.6292%), train_poison_data_count: 370
Global model norm: 43.96651502404273.
Norm before scaling: 43.93870436427248. Distance: 1.2700805884046
Total norm for 4 adversaries is: 43.93870436427248. distance: 1.2700805884046
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0382, Accuracy: 9802/9900 (99.0101%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 142, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4899/5066 (96.7035%), train_poison_data_count: 400
Global model norm: 43.96651502404273.
Norm before scaling: 43.9365303724802. Distance: 1.3416137126084198
Total norm for 4 adversaries is: 43.9365303724802. distance: 1.3416137126084198
___Test Local_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0336, Accuracy: 9823/9900 (99.2222%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4173/4511 (92.5072%)
___Train Local_ResNet_18,  epoch 142, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4135/4511 (91.6648%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9092, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4111/4346 (94.5927%)
___Train Local_ResNet_18,  epoch 142, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4096/4346 (94.2476%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8934, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4481/4804 (93.2764%)
___Train Local_ResNet_18,  epoch 142, local model 94, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4339/4804 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0291, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4776/5232 (91.2844%)
___Train Local_ResNet_18,  epoch 142, local model 22, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4659/5232 (89.0482%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2552, Accuracy: 5098/10000 (50.9800%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4374/4618 (94.7163%)
___Train Local_ResNet_18,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4263/4618 (92.3127%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9114, Accuracy: 5715/10000 (57.1500%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3361/3590 (93.6212%)
___Train Local_ResNet_18,  epoch 142, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3297/3590 (91.8384%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.0699, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5795/6391 (90.6744%)
___Train Local_ResNet_18,  epoch 142, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5584/6391 (87.3729%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2968, Accuracy: 5059/10000 (50.5900%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4019/4354 (92.3059%)
___Train Local_ResNet_18,  epoch 142, local model 37, internal_epoch   2,  Average loss: 0.0169, Accuracy: 3082/4354 (70.7855%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 3.0500, Accuracy: 3935/10000 (39.3500%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4690/5055 (92.7794%)
___Train Local_ResNet_18,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4636/5055 (91.7112%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9228, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3622/3837 (94.3967%)
___Train Local_ResNet_18,  epoch 142, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3634/3837 (94.7094%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8492, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4193/4503 (93.1157%)
___Train Local_ResNet_18,  epoch 142, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4120/4503 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9929, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4271/4576 (93.3348%)
___Train Local_ResNet_18,  epoch 142, local model 43, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4225/4576 (92.3295%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8799, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4486/4793 (93.5948%)
___Train Local_ResNet_18,  epoch 142, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4433/4793 (92.4890%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.1644, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4315/4634 (93.1161%)
___Train Local_ResNet_18,  epoch 142, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4299/4634 (92.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.8583, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3766/4158 (90.5724%)
___Train Local_ResNet_18,  epoch 142, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3767/4158 (90.5964%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.9589, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5326/5740 (92.7875%)
___Train Local_ResNet_18,  epoch 142, local model 38, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5219/5740 (90.9233%)
___Test Local_ResNet_18 poisoned: False, epoch: 142: Average loss: 2.2854, Accuracy: 5172/10000 (51.7200%)
time spent on training: 262.7675633430481
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 142: Average loss: 1.2863, Accuracy: 6722/10000 (67.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 142: Average loss: 0.0793, Accuracy: 9694/9900 (97.9192%)
Done in 289.49285197257996 sec.
Server Epoch:143 choose agents : [13, 36, 58, 71, 23, 92, 66, 6, 73, 27, 40, 45, 26, 9, 65, 94, 62, 75, 83, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 43.9876622328459.
Norm before scaling: 43.95610631330489. Distance: 1.220572356276902
Total norm for 4 adversaries is: 43.95610631330489. distance: 1.220572356276902
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0652, Accuracy: 9726/9900 (98.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5133/5305 (96.7578%), train_poison_data_count: 415
Global model norm: 43.9876622328459.
Norm before scaling: 43.95506766725325. Distance: 1.3363618232606231
Total norm for 4 adversaries is: 43.95506766725325. distance: 1.3363618232606231
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0630, Accuracy: 9740/9900 (98.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4572/4717 (96.9260%), train_poison_data_count: 370
Global model norm: 43.9876622328459.
Norm before scaling: 43.95635625120459. Distance: 1.1854788997965306
Total norm for 4 adversaries is: 43.95635625120459. distance: 1.1854788997965306
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0370, Accuracy: 9800/9900 (98.9899%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 143, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4920/5066 (97.1180%), train_poison_data_count: 400
Global model norm: 43.9876622328459.
Norm before scaling: 43.95527178813424. Distance: 1.2432793191489933
Total norm for 4 adversaries is: 43.95527178813424. distance: 1.2432793191489933
___Test Local_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0684, Accuracy: 9735/9900 (98.3333%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3902/4184 (93.2600%)
___Train Local_ResNet_18,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3843/4184 (91.8499%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9365, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5878/6263 (93.8528%)
___Train Local_ResNet_18,  epoch 143, local model 92, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5761/6263 (91.9847%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2304, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4184/4456 (93.8959%)
___Train Local_ResNet_18,  epoch 143, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4183/4456 (93.8734%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8550, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4295/4538 (94.6452%)
___Train Local_ResNet_18,  epoch 143, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4283/4538 (94.3808%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.8612, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3957/4235 (93.4357%)
___Train Local_ResNet_18,  epoch 143, local model 73, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3893/4235 (91.9244%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0518, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3923/4223 (92.8960%)
___Train Local_ResNet_18,  epoch 143, local model 27, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3949/4223 (93.5117%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9620, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5037/5455 (92.3373%)
___Train Local_ResNet_18,  epoch 143, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4978/5455 (91.2557%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9671, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4637/5037 (92.0588%)
___Train Local_ResNet_18,  epoch 143, local model 45, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4686/5037 (93.0316%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.0331, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3596/3756 (95.7401%)
___Train Local_ResNet_18,  epoch 143, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3596/3756 (95.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.7450, Accuracy: 6051/10000 (60.5100%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4891/5265 (92.8965%)
___Train Local_ResNet_18,  epoch 143, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4735/5265 (89.9335%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1813, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4688/5055 (92.7399%)
___Train Local_ResNet_18,  epoch 143, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4665/5055 (92.2849%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9367, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4433/4804 (92.2773%)
___Train Local_ResNet_18,  epoch 143, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4162/4804 (86.6361%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2117, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4601/5063 (90.8750%)
___Train Local_ResNet_18,  epoch 143, local model 62, internal_epoch   2,  Average loss: 0.0081, Accuracy: 4293/5063 (84.7916%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.2665, Accuracy: 5185/10000 (51.8500%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4001/4295 (93.1548%)
___Train Local_ResNet_18,  epoch 143, local model 75, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3670/4295 (85.4482%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.3590, Accuracy: 5012/10000 (50.1200%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3027/3271 (92.5405%)
___Train Local_ResNet_18,  epoch 143, local model 83, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3028/3271 (92.5711%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.9764, Accuracy: 5600/10000 (56.0000%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4088/4356 (93.8476%)
___Train Local_ResNet_18,  epoch 143, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3992/4356 (91.6437%)
___Test Local_ResNet_18 poisoned: False, epoch: 143: Average loss: 2.1315, Accuracy: 5233/10000 (52.3300%)
time spent on training: 263.9287600517273
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 143: Average loss: 1.3007, Accuracy: 6682/10000 (66.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 143: Average loss: 0.0791, Accuracy: 9691/9900 (97.8889%)
Done in 291.60074949264526 sec.
Server Epoch:144 choose agents : [13, 36, 58, 71, 64, 66, 9, 84, 16, 76, 10, 19, 99, 18, 34, 73, 88, 77, 93, 56].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4750/4885 (97.2364%), train_poison_data_count: 385
Global model norm: 44.00715440325442.
Norm before scaling: 43.97644244631863. Distance: 1.2528589931890082
Total norm for 4 adversaries is: 43.97644244631863. distance: 1.2528589931890082
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.1206, Accuracy: 9598/9900 (96.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5131/5305 (96.7201%), train_poison_data_count: 415
Global model norm: 44.00715440325442.
Norm before scaling: 43.97423562084394. Distance: 1.3347098526705101
Total norm for 4 adversaries is: 43.97423562084394. distance: 1.3347098526705101
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0288, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4569/4717 (96.8624%), train_poison_data_count: 370
Global model norm: 44.00715440325442.
Norm before scaling: 43.976796360854465. Distance: 1.2053410816636332
Total norm for 4 adversaries is: 43.976796360854465. distance: 1.2053410816636332
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0893, Accuracy: 9658/9900 (97.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 144, local model 71, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4903/5066 (96.7825%), train_poison_data_count: 400
Global model norm: 44.00715440325442.
Norm before scaling: 43.97919735289274. Distance: 1.360463419174663
Total norm for 4 adversaries is: 43.97919735289274. distance: 1.360463419174663
___Test Local_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0361, Accuracy: 9806/9900 (99.0505%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4185/4503 (92.9380%)
___Train Local_ResNet_18,  epoch 144, local model 64, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4120/4503 (91.4946%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.1039, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4186/4456 (93.9408%)
___Train Local_ResNet_18,  epoch 144, local model 66, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4161/4456 (93.3797%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8927, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4911/5265 (93.2764%)
___Train Local_ResNet_18,  epoch 144, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4651/5265 (88.3381%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.3118, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4508/4793 (94.0538%)
___Train Local_ResNet_18,  epoch 144, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4474/4793 (93.3445%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9207, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4571/4928 (92.7557%)
___Train Local_ResNet_18,  epoch 144, local model 16, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4500/4928 (91.3149%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9626, Accuracy: 5623/10000 (56.2300%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3325/3638 (91.3964%)
___Train Local_ResNet_18,  epoch 144, local model 76, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3313/3638 (91.0665%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9158, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4333/4663 (92.9230%)
___Train Local_ResNet_18,  epoch 144, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4352/4663 (93.3305%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0088, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4432/4928 (89.9351%)
___Train Local_ResNet_18,  epoch 144, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4423/4928 (89.7524%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0677, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4196/4465 (93.9754%)
___Train Local_ResNet_18,  epoch 144, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4131/4465 (92.5196%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8885, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3621/3911 (92.5850%)
___Train Local_ResNet_18,  epoch 144, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3541/3911 (90.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0201, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4211/4518 (93.2050%)
___Train Local_ResNet_18,  epoch 144, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4182/4518 (92.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9829, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3971/4235 (93.7662%)
___Train Local_ResNet_18,  epoch 144, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3789/4235 (89.4687%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0312, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4523/4934 (91.6700%)
___Train Local_ResNet_18,  epoch 144, local model 88, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4447/4934 (90.1297%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0947, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4284/4647 (92.1885%)
___Train Local_ResNet_18,  epoch 144, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4264/4647 (91.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.8798, Accuracy: 5744/10000 (57.4400%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4324/4651 (92.9693%)
___Train Local_ResNet_18,  epoch 144, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4258/4651 (91.5502%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 2.0121, Accuracy: 5475/10000 (54.7500%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4602/4989 (92.2429%)
___Train Local_ResNet_18,  epoch 144, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4555/4989 (91.3009%)
___Test Local_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.9973, Accuracy: 5574/10000 (55.7400%)
time spent on training: 259.9101846218109
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 144: Average loss: 1.2963, Accuracy: 6690/10000 (66.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 144: Average loss: 0.0790, Accuracy: 9695/9900 (97.9293%)
Done in 287.4239971637726 sec.
Server Epoch:145 choose agents : [13, 36, 58, 71, 6, 90, 11, 59, 69, 99, 22, 16, 62, 25, 66, 5, 48, 38, 30, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4753/4885 (97.2979%), train_poison_data_count: 385
Global model norm: 44.026614376278125.
Norm before scaling: 43.9940875155756. Distance: 1.2281193177380525
Total norm for 4 adversaries is: 43.9940875155756. distance: 1.2281193177380525
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0340, Accuracy: 9801/9900 (99.0000%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 44.026614376278125.
Norm before scaling: 43.99406809268438. Distance: 1.3364479918859054
Total norm for 4 adversaries is: 43.99406809268438. distance: 1.3364479918859054
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0468, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4563/4717 (96.7352%), train_poison_data_count: 370
Global model norm: 44.026614376278125.
Norm before scaling: 43.99746558086116. Distance: 1.2320173902584703
Total norm for 4 adversaries is: 43.99746558086116. distance: 1.2320173902584703
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0516, Accuracy: 9763/9900 (98.6162%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 145, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4909/5066 (96.9009%), train_poison_data_count: 400
Global model norm: 44.026614376278125.
Norm before scaling: 43.997407316635574. Distance: 1.3364165044092529
Total norm for 4 adversaries is: 43.997407316635574. distance: 1.3364165044092529
___Test Local_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0598, Accuracy: 9745/9900 (98.4343%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4301/4538 (94.7774%)
___Train Local_ResNet_18,  epoch 145, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4247/4538 (93.5875%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8588, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4143/4362 (94.9794%)
___Train Local_ResNet_18,  epoch 145, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4028/4362 (92.3430%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0775, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4725/5244 (90.1030%)
___Train Local_ResNet_18,  epoch 145, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4631/5244 (88.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1036, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3799/4046 (93.8952%)
___Train Local_ResNet_18,  epoch 145, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3690/4046 (91.2012%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9278, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3732/4013 (92.9978%)
___Train Local_ResNet_18,  epoch 145, local model 69, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3758/4013 (93.6457%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8194, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4194/4465 (93.9306%)
___Train Local_ResNet_18,  epoch 145, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4098/4465 (91.7805%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9979, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4780/5232 (91.3609%)
___Train Local_ResNet_18,  epoch 145, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4727/5232 (90.3479%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0847, Accuracy: 5330/10000 (53.3000%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4617/4928 (93.6891%)
___Train Local_ResNet_18,  epoch 145, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4556/4928 (92.4513%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9372, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4652/5063 (91.8823%)
___Train Local_ResNet_18,  epoch 145, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4474/5063 (88.3666%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.2719, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5386/5902 (91.2572%)
___Train Local_ResNet_18,  epoch 145, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 5057/5902 (85.6828%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.3713, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4230/4456 (94.9282%)
___Train Local_ResNet_18,  epoch 145, local model 66, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4183/4456 (93.8734%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9225, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4299/4596 (93.5379%)
___Train Local_ResNet_18,  epoch 145, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4270/4596 (92.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1076, Accuracy: 5457/10000 (54.5700%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4192/4441 (94.3932%)
___Train Local_ResNet_18,  epoch 145, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4149/4441 (93.4249%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.9794, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5344/5740 (93.1010%)
___Train Local_ResNet_18,  epoch 145, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5187/5740 (90.3659%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.1902, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3292/3472 (94.8157%)
___Train Local_ResNet_18,  epoch 145, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3239/3472 (93.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.8999, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3605/3861 (93.3696%)
___Train Local_ResNet_18,  epoch 145, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3563/3861 (92.2818%)
___Test Local_ResNet_18 poisoned: False, epoch: 145: Average loss: 2.0229, Accuracy: 5580/10000 (55.8000%)
time spent on training: 263.3286910057068
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 2 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 33.33% (1/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 145: Average loss: 1.3083, Accuracy: 6675/10000 (66.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 145: Average loss: 0.0785, Accuracy: 9697/9900 (97.9495%)
Done in 290.21021032333374 sec.
Server Epoch:146 choose agents : [13, 36, 58, 71, 52, 68, 18, 83, 59, 38, 24, 4, 72, 46, 63, 25, 16, 73, 9, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4762/4885 (97.4821%), train_poison_data_count: 385
Global model norm: 44.047195092398475.
Norm before scaling: 44.014070515237655. Distance: 1.1886465159559019
Total norm for 4 adversaries is: 44.014070515237655. distance: 1.1886465159559019
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0615, Accuracy: 9726/9900 (98.2424%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 36, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5121/5305 (96.5316%), train_poison_data_count: 415
Global model norm: 44.047195092398475.
Norm before scaling: 44.01451010302597. Distance: 1.352028738760371
Total norm for 4 adversaries is: 44.01451010302597. distance: 1.352028738760371
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0483, Accuracy: 9782/9900 (98.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4574/4717 (96.9684%), train_poison_data_count: 370
Global model norm: 44.047195092398475.
Norm before scaling: 44.016387662011745. Distance: 1.2121191842520975
Total norm for 4 adversaries is: 44.016387662011745. distance: 1.2121191842520975
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0354, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 146, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4938/5066 (97.4734%), train_poison_data_count: 400
Global model norm: 44.047195092398475.
Norm before scaling: 44.01427436248665. Distance: 1.235775020833027
Total norm for 4 adversaries is: 44.01427436248665. distance: 1.235775020833027
___Test Local_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0870, Accuracy: 9686/9900 (97.8384%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3588/3797 (94.4957%)
___Train Local_ResNet_18,  epoch 146, local model 52, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3559/3797 (93.7319%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8629, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3084/3297 (93.5396%)
___Train Local_ResNet_18,  epoch 146, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3079/3297 (93.3879%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.7845, Accuracy: 5874/10000 (58.7400%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3689/3911 (94.3237%)
___Train Local_ResNet_18,  epoch 146, local model 18, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3618/3911 (92.5083%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8039, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3014/3271 (92.1431%)
___Train Local_ResNet_18,  epoch 146, local model 83, internal_epoch   2,  Average loss: 0.0058, Accuracy: 2905/3271 (88.8108%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9693, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3802/4046 (93.9694%)
___Train Local_ResNet_18,  epoch 146, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3678/4046 (90.9046%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1343, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5312/5740 (92.5436%)
___Train Local_ResNet_18,  epoch 146, local model 38, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5193/5740 (90.4704%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1863, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3721/3969 (93.7516%)
___Train Local_ResNet_18,  epoch 146, local model 24, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3684/3969 (92.8193%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0360, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3475/3704 (93.8175%)
___Train Local_ResNet_18,  epoch 146, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3449/3704 (93.1156%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8179, Accuracy: 5882/10000 (58.8200%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4391/4767 (92.1124%)
___Train Local_ResNet_18,  epoch 146, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4242/4767 (88.9868%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.3106, Accuracy: 5091/10000 (50.9100%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4555/4956 (91.9088%)
___Train Local_ResNet_18,  epoch 146, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4456/4956 (89.9112%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2183, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3378/3590 (94.0947%)
___Train Local_ResNet_18,  epoch 146, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3355/3590 (93.4540%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0659, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5433/5902 (92.0535%)
___Train Local_ResNet_18,  epoch 146, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5199/5902 (88.0888%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.1731, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4626/4928 (93.8718%)
___Train Local_ResNet_18,  epoch 146, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4547/4928 (92.2687%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.8606, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4004/4235 (94.5455%)
___Train Local_ResNet_18,  epoch 146, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3895/4235 (91.9717%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.0532, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4828/5265 (91.6999%)
___Train Local_ResNet_18,  epoch 146, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4697/5265 (89.2118%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.9905, Accuracy: 5528/10000 (55.2800%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4078/4356 (93.6180%)
___Train Local_ResNet_18,  epoch 146, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3704/4356 (85.0321%)
___Test Local_ResNet_18 poisoned: False, epoch: 146: Average loss: 2.2719, Accuracy: 5118/10000 (51.1800%)
time spent on training: 259.631628036499
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 14 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 146: Average loss: 1.3146, Accuracy: 6654/10000 (66.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 146: Average loss: 0.0806, Accuracy: 9691/9900 (97.8889%)
Done in 286.89815044403076 sec.
Server Epoch:147 choose agents : [13, 36, 58, 71, 78, 25, 84, 9, 75, 4, 67, 38, 52, 28, 33, 74, 27, 12, 43, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 44.06637560526592.
Norm before scaling: 44.03257932477028. Distance: 1.1813193649028748
Total norm for 4 adversaries is: 44.03257932477028. distance: 1.1813193649028748
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.1379, Accuracy: 9545/9900 (96.4141%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5136/5305 (96.8143%), train_poison_data_count: 415
Global model norm: 44.06637560526592.
Norm before scaling: 44.03395989487475. Distance: 1.3580972212765052
Total norm for 4 adversaries is: 44.03395989487475. distance: 1.3580972212765052
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0640, Accuracy: 9749/9900 (98.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4577/4717 (97.0320%), train_poison_data_count: 370
Global model norm: 44.06637560526592.
Norm before scaling: 44.03577841112199. Distance: 1.1965990311113885
Total norm for 4 adversaries is: 44.03577841112199. distance: 1.1965990311113885
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0693, Accuracy: 9731/9900 (98.2929%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 147, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.06637560526592.
Norm before scaling: 44.0337949495186. Distance: 1.2310839855757265
Total norm for 4 adversaries is: 44.0337949495186. distance: 1.2310839855757265
___Test Local_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0245, Accuracy: 9843/9900 (99.4242%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3802/4025 (94.4596%)
___Train Local_ResNet_18,  epoch 147, local model 78, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3766/4025 (93.5652%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.7817, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5347/5902 (90.5964%)
___Train Local_ResNet_18,  epoch 147, local model 25, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5174/5902 (87.6652%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0871, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4480/4793 (93.4696%)
___Train Local_ResNet_18,  epoch 147, local model 84, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4499/4793 (93.8661%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8810, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4855/5265 (92.2127%)
___Train Local_ResNet_18,  epoch 147, local model 9, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4755/5265 (90.3134%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9264, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4019/4295 (93.5739%)
___Train Local_ResNet_18,  epoch 147, local model 75, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3983/4295 (92.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8947, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3463/3704 (93.4935%)
___Train Local_ResNet_18,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3398/3704 (91.7387%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8479, Accuracy: 5836/10000 (58.3600%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4756/5116 (92.9633%)
___Train Local_ResNet_18,  epoch 147, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4705/5116 (91.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9430, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5343/5740 (93.0836%)
___Train Local_ResNet_18,  epoch 147, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5167/5740 (90.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.2289, Accuracy: 5251/10000 (52.5100%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3576/3797 (94.1796%)
___Train Local_ResNet_18,  epoch 147, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3525/3797 (92.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.8724, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4318/4716 (91.5606%)
___Train Local_ResNet_18,  epoch 147, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4231/4716 (89.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9711, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4145/4433 (93.5033%)
___Train Local_ResNet_18,  epoch 147, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4122/4433 (92.9844%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9147, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4028/4416 (91.2138%)
___Train Local_ResNet_18,  epoch 147, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3995/4416 (90.4665%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9721, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3946/4223 (93.4407%)
___Train Local_ResNet_18,  epoch 147, local model 27, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3955/4223 (93.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.9438, Accuracy: 5606/10000 (56.0600%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4638/5083 (91.2453%)
___Train Local_ResNet_18,  epoch 147, local model 12, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4457/5083 (87.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.3865, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4256/4576 (93.0070%)
___Train Local_ResNet_18,  epoch 147, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4201/4576 (91.8051%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.0318, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4901/5392 (90.8939%)
___Train Local_ResNet_18,  epoch 147, local model 70, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4760/5392 (88.2789%)
___Test Local_ResNet_18 poisoned: False, epoch: 147: Average loss: 2.1474, Accuracy: 5287/10000 (52.8700%)
time spent on training: 262.1351957321167
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 147: Average loss: 1.3119, Accuracy: 6668/10000 (66.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 147: Average loss: 0.0852, Accuracy: 9679/9900 (97.7677%)
Done in 289.2654490470886 sec.
Server Epoch:148 choose agents : [13, 36, 58, 71, 9, 89, 26, 39, 38, 27, 99, 32, 25, 3, 14, 75, 91, 92, 37, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4732/4885 (96.8680%), train_poison_data_count: 385
Global model norm: 44.08622754312706.
Norm before scaling: 44.054943113064084. Distance: 1.2745330404231863
Total norm for 4 adversaries is: 44.054943113064084. distance: 1.2745330404231863
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0745, Accuracy: 9698/9900 (97.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5129/5305 (96.6824%), train_poison_data_count: 415
Global model norm: 44.08622754312706.
Norm before scaling: 44.05332074156698. Distance: 1.350754159862009
Total norm for 4 adversaries is: 44.05332074156698. distance: 1.350754159862009
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0476, Accuracy: 9785/9900 (98.8384%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 58, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4565/4717 (96.7776%), train_poison_data_count: 370
Global model norm: 44.08622754312706.
Norm before scaling: 44.05780532392572. Distance: 1.2491221683423912
Total norm for 4 adversaries is: 44.05780532392572. distance: 1.2491221683423912
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0508, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 148, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4907/5066 (96.8614%), train_poison_data_count: 400
Global model norm: 44.08622754312706.
Norm before scaling: 44.05641857412067. Distance: 1.3281842386834768
Total norm for 4 adversaries is: 44.05641857412067. distance: 1.3281842386834768
___Test Local_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0296, Accuracy: 9825/9900 (99.2424%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4907/5265 (93.2004%)
___Train Local_ResNet_18,  epoch 148, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4768/5265 (90.5603%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0702, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4093/4356 (93.9624%)
___Train Local_ResNet_18,  epoch 148, local model 89, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3768/4356 (86.5014%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.5516, Accuracy: 4749/10000 (47.4900%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3586/3756 (95.4739%)
___Train Local_ResNet_18,  epoch 148, local model 26, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3576/3756 (95.2077%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8209, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3602/3837 (93.8754%)
___Train Local_ResNet_18,  epoch 148, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3627/3837 (94.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.7332, Accuracy: 5932/10000 (59.3200%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5347/5740 (93.1533%)
___Train Local_ResNet_18,  epoch 148, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5197/5740 (90.5401%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.1932, Accuracy: 5206/10000 (52.0600%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3934/4223 (93.1565%)
___Train Local_ResNet_18,  epoch 148, local model 27, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3917/4223 (92.7540%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9054, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4214/4465 (94.3785%)
___Train Local_ResNet_18,  epoch 148, local model 99, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4209/4465 (94.2665%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8471, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5081/5591 (90.8782%)
___Train Local_ResNet_18,  epoch 148, local model 32, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4943/5591 (88.4099%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2486, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5409/5902 (91.6469%)
___Train Local_ResNet_18,  epoch 148, local model 25, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5157/5902 (87.3772%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2061, Accuracy: 5196/10000 (51.9600%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4605/4918 (93.6356%)
___Train Local_ResNet_18,  epoch 148, local model 3, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4510/4918 (91.7039%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0632, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3583/3861 (92.7998%)
___Train Local_ResNet_18,  epoch 148, local model 14, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3583/3861 (92.7998%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.9593, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4010/4295 (93.3644%)
___Train Local_ResNet_18,  epoch 148, local model 75, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3854/4295 (89.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0900, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3766/4158 (90.5724%)
___Train Local_ResNet_18,  epoch 148, local model 91, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3671/4158 (88.2876%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.0022, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5830/6263 (93.0864%)
___Train Local_ResNet_18,  epoch 148, local model 92, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5723/6263 (91.3779%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.2011, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4080/4354 (93.7069%)
___Train Local_ResNet_18,  epoch 148, local model 37, internal_epoch   2,  Average loss: 0.0091, Accuracy: 3610/4354 (82.9123%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 2.6065, Accuracy: 4659/10000 (46.5900%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3568/3797 (93.9689%)
___Train Local_ResNet_18,  epoch 148, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3547/3797 (93.4159%)
___Test Local_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.8279, Accuracy: 5792/10000 (57.9200%)
time spent on training: 263.3449649810791
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 148: Average loss: 1.3162, Accuracy: 6671/10000 (66.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 148: Average loss: 0.0824, Accuracy: 9684/9900 (97.8182%)
Done in 290.86459398269653 sec.
Server Epoch:149 choose agents : [13, 36, 58, 71, 52, 45, 88, 40, 25, 85, 18, 54, 73, 67, 6, 15, 57, 59, 98, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4772/4885 (97.6868%), train_poison_data_count: 385
Global model norm: 44.10632793673148.
Norm before scaling: 44.07072175067025. Distance: 1.16520112949661
Total norm for 4 adversaries is: 44.07072175067025. distance: 1.16520112949661
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0900, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5152/5305 (97.1159%), train_poison_data_count: 415
Global model norm: 44.10632793673148.
Norm before scaling: 44.07214405762372. Distance: 1.307311201012959
Total norm for 4 adversaries is: 44.07214405762372. distance: 1.307311201012959
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0673, Accuracy: 9735/9900 (98.3333%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4566/4717 (96.7988%), train_poison_data_count: 370
Global model norm: 44.10632793673148.
Norm before scaling: 44.07423242516184. Distance: 1.2051905451291363
Total norm for 4 adversaries is: 44.07423242516184. distance: 1.2051905451291363
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0270, Accuracy: 9831/9900 (99.3030%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4930/5066 (97.3154%), train_poison_data_count: 400
Global model norm: 44.10632793673148.
Norm before scaling: 44.07417841690302. Distance: 1.2542678454237615
Total norm for 4 adversaries is: 44.07417841690302. distance: 1.2542678454237615
___Test Local_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0425, Accuracy: 9791/9900 (98.8990%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3616/3797 (95.2331%)
___Train Local_ResNet_18,  epoch 149, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3545/3797 (93.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9495, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4668/5037 (92.6742%)
___Train Local_ResNet_18,  epoch 149, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0763, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4551/4934 (92.2375%)
___Train Local_ResNet_18,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4461/4934 (90.4135%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1579, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5108/5455 (93.6389%)
___Train Local_ResNet_18,  epoch 149, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4948/5455 (90.7058%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0074, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5411/5902 (91.6808%)
___Train Local_ResNet_18,  epoch 149, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5101/5902 (86.4283%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2277, Accuracy: 5269/10000 (52.6900%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5839/6391 (91.3629%)
___Train Local_ResNet_18,  epoch 149, local model 85, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5593/6391 (87.5137%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.3606, Accuracy: 4983/10000 (49.8300%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3673/3911 (93.9146%)
___Train Local_ResNet_18,  epoch 149, local model 18, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3361/3911 (85.9371%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2742, Accuracy: 4978/10000 (49.7800%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4790/5195 (92.2040%)
___Train Local_ResNet_18,  epoch 149, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4522/5195 (87.0452%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.4185, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3965/4235 (93.6246%)
___Train Local_ResNet_18,  epoch 149, local model 73, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3870/4235 (91.3813%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.1934, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4820/5116 (94.2142%)
___Train Local_ResNet_18,  epoch 149, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4686/5116 (91.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9173, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4301/4538 (94.7774%)
___Train Local_ResNet_18,  epoch 149, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4275/4538 (94.2045%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8556, Accuracy: 5790/10000 (57.9000%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5235/5582 (93.7836%)
___Train Local_ResNet_18,  epoch 149, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5164/5582 (92.5116%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.0467, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4218/4558 (92.5406%)
___Train Local_ResNet_18,  epoch 149, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4135/4558 (90.7196%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 2.2388, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3797/4046 (93.8458%)
___Train Local_ResNet_18,  epoch 149, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3791/4046 (93.6975%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.7850, Accuracy: 5815/10000 (58.1500%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3623/3828 (94.6447%)
___Train Local_ResNet_18,  epoch 149, local model 98, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3594/3828 (93.8871%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.8645, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4690/5055 (92.7794%)
___Train Local_ResNet_18,  epoch 149, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4625/5055 (91.4936%)
___Test Local_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.9328, Accuracy: 5568/10000 (55.6800%)
time spent on training: 265.8138771057129
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 149: Average loss: 1.3149, Accuracy: 6671/10000 (66.7100%)
___Test Target_ResNet_18 poisoned: True, epoch: 149: Average loss: 0.0767, Accuracy: 9698/9900 (97.9596%)
Done in 293.5183687210083 sec.
Server Epoch:150 choose agents : [13, 36, 58, 71, 15, 8, 18, 10, 9, 74, 33, 92, 40, 21, 47, 61, 67, 62, 97, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4764/4885 (97.5230%), train_poison_data_count: 385
Global model norm: 44.126883923132674.
Norm before scaling: 44.09430229765732. Distance: 1.2221802586277801
Total norm for 4 adversaries is: 44.09430229765732. distance: 1.2221802586277801
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0480, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5132/5305 (96.7389%), train_poison_data_count: 415
Global model norm: 44.126883923132674.
Norm before scaling: 44.0933291971416. Distance: 1.3317041974434582
Total norm for 4 adversaries is: 44.0933291971416. distance: 1.3317041974434582
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0743, Accuracy: 9711/9900 (98.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4578/4717 (97.0532%), train_poison_data_count: 370
Global model norm: 44.126883923132674.
Norm before scaling: 44.096503114352075. Distance: 1.2189304511654644
Total norm for 4 adversaries is: 44.096503114352075. distance: 1.2189304511654644
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0474, Accuracy: 9775/9900 (98.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 150, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4924/5066 (97.1970%), train_poison_data_count: 400
Global model norm: 44.126883923132674.
Norm before scaling: 44.09447532181611. Distance: 1.2619350472343716
Total norm for 4 adversaries is: 44.09447532181611. distance: 1.2619350472343716
___Test Local_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0349, Accuracy: 9810/9900 (99.0909%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5271/5582 (94.4285%)
___Train Local_ResNet_18,  epoch 150, local model 15, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5083/5582 (91.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1503, Accuracy: 5233/10000 (52.3300%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4162/4501 (92.4683%)
___Train Local_ResNet_18,  epoch 150, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4075/4501 (90.5354%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2632, Accuracy: 5213/10000 (52.1300%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3641/3911 (93.0964%)
___Train Local_ResNet_18,  epoch 150, local model 18, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3183/3911 (81.3858%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.3209, Accuracy: 5056/10000 (50.5600%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4403/4663 (94.4242%)
___Train Local_ResNet_18,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4375/4663 (93.8237%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8871, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4866/5265 (92.4217%)
___Train Local_ResNet_18,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4696/5265 (89.1928%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0805, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4036/4416 (91.3949%)
___Train Local_ResNet_18,  epoch 150, local model 74, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3996/4416 (90.4891%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1455, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4180/4433 (94.2928%)
___Train Local_ResNet_18,  epoch 150, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4027/4433 (90.8414%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9326, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5780/6263 (92.2880%)
___Train Local_ResNet_18,  epoch 150, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5711/6263 (91.1863%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.0737, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5059/5455 (92.7406%)
___Train Local_ResNet_18,  epoch 150, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5003/5455 (91.7140%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9772, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4259/4634 (91.9076%)
___Train Local_ResNet_18,  epoch 150, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4293/4634 (92.6413%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8151, Accuracy: 5855/10000 (58.5500%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4394/4707 (93.3503%)
___Train Local_ResNet_18,  epoch 150, local model 47, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4335/4707 (92.0969%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.9342, Accuracy: 5599/10000 (55.9900%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3866/4126 (93.6985%)
___Train Local_ResNet_18,  epoch 150, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3876/4126 (93.9409%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.8312, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4823/5116 (94.2729%)
___Train Local_ResNet_18,  epoch 150, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4687/5116 (91.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1107, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4646/5063 (91.7638%)
___Train Local_ResNet_18,  epoch 150, local model 62, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4494/5063 (88.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2345, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4069/4361 (93.3043%)
___Train Local_ResNet_18,  epoch 150, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3902/4361 (89.4749%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.1475, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5550/6124 (90.6270%)
___Train Local_ResNet_18,  epoch 150, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5407/6124 (88.2920%)
___Test Local_ResNet_18 poisoned: False, epoch: 150: Average loss: 2.2801, Accuracy: 5147/10000 (51.4700%)
time spent on training: 268.4673137664795
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 150: Average loss: 1.3190, Accuracy: 6663/10000 (66.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 150: Average loss: 0.0699, Accuracy: 9714/9900 (98.1212%)
Done in 295.8291404247284 sec.
Server Epoch:151 choose agents : [13, 36, 58, 71, 89, 90, 96, 91, 93, 31, 81, 95, 15, 82, 88, 42, 94, 3, 14, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4751/4885 (97.2569%), train_poison_data_count: 385
Global model norm: 44.14886952872137.
Norm before scaling: 44.11565388803333. Distance: 1.2126586987176156
Total norm for 4 adversaries is: 44.11565388803333. distance: 1.2126586987176156
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0577, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5147/5305 (97.0217%), train_poison_data_count: 415
Global model norm: 44.14886952872137.
Norm before scaling: 44.11462591620337. Distance: 1.3173592850243414
Total norm for 4 adversaries is: 44.11462591620337. distance: 1.3173592850243414
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0312, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4594/4717 (97.3924%), train_poison_data_count: 370
Global model norm: 44.14886952872137.
Norm before scaling: 44.11599423412812. Distance: 1.1546768621592187
Total norm for 4 adversaries is: 44.11599423412812. distance: 1.1546768621592187
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0559, Accuracy: 9761/9900 (98.5960%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 151, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4907/5066 (96.8614%), train_poison_data_count: 400
Global model norm: 44.14886952872137.
Norm before scaling: 44.11795324840133. Distance: 1.2982862675958136
Total norm for 4 adversaries is: 44.11795324840133. distance: 1.2982862675958136
___Test Local_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0675, Accuracy: 9733/9900 (98.3131%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4045/4356 (92.8604%)
___Train Local_ResNet_18,  epoch 151, local model 89, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3819/4356 (87.6722%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.4113, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4155/4362 (95.2545%)
___Train Local_ResNet_18,  epoch 151, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4100/4362 (93.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.8885, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4385/4679 (93.7166%)
___Train Local_ResNet_18,  epoch 151, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4215/4679 (90.0834%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1696, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3775/4158 (90.7888%)
___Train Local_ResNet_18,  epoch 151, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3701/4158 (89.0091%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0980, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4358/4651 (93.7003%)
___Train Local_ResNet_18,  epoch 151, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4203/4651 (90.3677%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2949, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3901/4175 (93.4371%)
___Train Local_ResNet_18,  epoch 151, local model 31, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3756/4175 (89.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0321, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4335/4618 (93.8718%)
___Train Local_ResNet_18,  epoch 151, local model 81, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4104/4618 (88.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0490, Accuracy: 5490/10000 (54.9000%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4234/4625 (91.5459%)
___Train Local_ResNet_18,  epoch 151, local model 95, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4104/4625 (88.7351%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1346, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5276/5582 (94.5181%)
___Train Local_ResNet_18,  epoch 151, local model 15, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5209/5582 (93.3178%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1253, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4519/4874 (92.7165%)
___Train Local_ResNet_18,  epoch 151, local model 82, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4397/4874 (90.2134%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.3274, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4550/4934 (92.2173%)
___Train Local_ResNet_18,  epoch 151, local model 88, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4425/4934 (89.6838%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.1575, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5067/5424 (93.4181%)
___Train Local_ResNet_18,  epoch 151, local model 42, internal_epoch   2,  Average loss: 0.0037, Accuracy: 5042/5424 (92.9572%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0662, Accuracy: 5474/10000 (54.7400%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4508/4804 (93.8385%)
___Train Local_ResNet_18,  epoch 151, local model 94, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4256/4804 (88.5928%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.2271, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4620/4918 (93.9406%)
___Train Local_ResNet_18,  epoch 151, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4546/4918 (92.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 2.0806, Accuracy: 5410/10000 (54.1000%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3605/3861 (93.3696%)
___Train Local_ResNet_18,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3520/3861 (91.1681%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9867, Accuracy: 5612/10000 (56.1200%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3959/4223 (93.7485%)
___Train Local_ResNet_18,  epoch 151, local model 27, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3882/4223 (91.9252%)
___Test Local_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.9725, Accuracy: 5563/10000 (55.6300%)
time spent on training: 261.6682138442993
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 151: Average loss: 1.3130, Accuracy: 6675/10000 (66.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 151: Average loss: 0.0706, Accuracy: 9714/9900 (98.1212%)
Done in 288.7255654335022 sec.
Server Epoch:152 choose agents : [13, 36, 58, 71, 77, 60, 32, 21, 33, 4, 39, 40, 38, 1, 66, 89, 63, 64, 45, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4780/4885 (97.8506%), train_poison_data_count: 385
Global model norm: 44.168980107208014.
Norm before scaling: 44.13405786324845. Distance: 1.1581467201431854
Total norm for 4 adversaries is: 44.13405786324845. distance: 1.1581467201431854
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0525, Accuracy: 9770/9900 (98.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5123/5305 (96.5693%), train_poison_data_count: 415
Global model norm: 44.168980107208014.
Norm before scaling: 44.134859966446164. Distance: 1.3226376887650988
Total norm for 4 adversaries is: 44.134859966446164. distance: 1.3226376887650988
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0452, Accuracy: 9788/9900 (98.8687%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4577/4717 (97.0320%), train_poison_data_count: 370
Global model norm: 44.168980107208014.
Norm before scaling: 44.13932935045358. Distance: 1.2235935019155637
Total norm for 4 adversaries is: 44.13932935045358. distance: 1.2235935019155637
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0482, Accuracy: 9769/9900 (98.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4908/5066 (96.8812%), train_poison_data_count: 400
Global model norm: 44.168980107208014.
Norm before scaling: 44.138390430164364. Distance: 1.3417687114663952
Total norm for 4 adversaries is: 44.138390430164364. distance: 1.3417687114663952
___Test Local_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0557, Accuracy: 9756/9900 (98.5455%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4328/4647 (93.1354%)
___Train Local_ResNet_18,  epoch 152, local model 77, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4354/4647 (93.6949%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8934, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3558/3804 (93.5331%)
___Train Local_ResNet_18,  epoch 152, local model 60, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3530/3804 (92.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9644, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5126/5591 (91.6831%)
___Train Local_ResNet_18,  epoch 152, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4941/5591 (88.3742%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0891, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4291/4634 (92.5982%)
___Train Local_ResNet_18,  epoch 152, local model 21, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4260/4634 (91.9292%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8561, Accuracy: 5741/10000 (57.4100%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4185/4433 (94.4056%)
___Train Local_ResNet_18,  epoch 152, local model 33, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4095/4433 (92.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9377, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3460/3704 (93.4125%)
___Train Local_ResNet_18,  epoch 152, local model 4, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3432/3704 (92.6566%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.7990, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3583/3837 (93.3802%)
___Train Local_ResNet_18,  epoch 152, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3630/3837 (94.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9192, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5096/5455 (93.4189%)
___Train Local_ResNet_18,  epoch 152, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4903/5455 (89.8808%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0969, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5338/5740 (92.9965%)
___Train Local_ResNet_18,  epoch 152, local model 38, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5233/5740 (91.1672%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1076, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4684/4986 (93.9430%)
___Train Local_ResNet_18,  epoch 152, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4619/4986 (92.6394%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.8108, Accuracy: 5823/10000 (58.2300%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4210/4456 (94.4794%)
___Train Local_ResNet_18,  epoch 152, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4182/4456 (93.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9699, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4036/4356 (92.6538%)
___Train Local_ResNet_18,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4079/4356 (93.6410%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.1310, Accuracy: 5310/10000 (53.1000%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3397/3590 (94.6240%)
___Train Local_ResNet_18,  epoch 152, local model 63, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3411/3590 (95.0139%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.0871, Accuracy: 5732/10000 (57.3200%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4202/4503 (93.3156%)
___Train Local_ResNet_18,  epoch 152, local model 64, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4177/4503 (92.7604%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9688, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4665/5037 (92.6147%)
___Train Local_ResNet_18,  epoch 152, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4587/5037 (91.0661%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.9821, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4802/5167 (92.9359%)
___Train Local_ResNet_18,  epoch 152, local model 35, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4726/5167 (91.4651%)
___Test Local_ResNet_18 poisoned: False, epoch: 152: Average loss: 2.2485, Accuracy: 5219/10000 (52.1900%)
time spent on training: 262.6649191379547
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 152: Average loss: 1.3255, Accuracy: 6643/10000 (66.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 152: Average loss: 0.0702, Accuracy: 9715/9900 (98.1313%)
Done in 289.75797152519226 sec.
Server Epoch:153 choose agents : [13, 36, 58, 71, 76, 28, 46, 70, 23, 7, 2, 80, 63, 5, 41, 82, 35, 81, 19, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.18732181496959.
Norm before scaling: 44.15245554954659. Distance: 1.1699285491090672
Total norm for 4 adversaries is: 44.15245554954659. distance: 1.1699285491090672
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0900, Accuracy: 9648/9900 (97.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5159/5305 (97.2479%), train_poison_data_count: 415
Global model norm: 44.18732181496959.
Norm before scaling: 44.15098468032381. Distance: 1.270942584276875
Total norm for 4 adversaries is: 44.15098468032381. distance: 1.270942584276875
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0269, Accuracy: 9835/9900 (99.3434%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4584/4717 (97.1804%), train_poison_data_count: 370
Global model norm: 44.18732181496959.
Norm before scaling: 44.156027456534034. Distance: 1.1910886747754272
Total norm for 4 adversaries is: 44.156027456534034. distance: 1.1910886747754272
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0565, Accuracy: 9749/9900 (98.4747%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 153, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4902/5066 (96.7627%), train_poison_data_count: 400
Global model norm: 44.18732181496959.
Norm before scaling: 44.15499766005401. Distance: 1.296643064050368
Total norm for 4 adversaries is: 44.15499766005401. distance: 1.296643064050368
___Test Local_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0813, Accuracy: 9682/9900 (97.7980%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3360/3638 (92.3584%)
___Train Local_ResNet_18,  epoch 153, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3370/3638 (92.6333%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8244, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4347/4716 (92.1756%)
___Train Local_ResNet_18,  epoch 153, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4239/4716 (89.8855%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0884, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4554/4956 (91.8886%)
___Train Local_ResNet_18,  epoch 153, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4481/4956 (90.4157%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1168, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4996/5392 (92.6558%)
___Train Local_ResNet_18,  epoch 153, local model 70, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4801/5392 (89.0393%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.2228, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3929/4184 (93.9054%)
___Train Local_ResNet_18,  epoch 153, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3879/4184 (92.7103%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9309, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4134/4481 (92.2562%)
___Train Local_ResNet_18,  epoch 153, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3939/4481 (87.9045%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0928, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3425/3646 (93.9386%)
___Train Local_ResNet_18,  epoch 153, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3415/3646 (93.6643%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8158, Accuracy: 5890/10000 (58.9000%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4662/5025 (92.7761%)
___Train Local_ResNet_18,  epoch 153, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4551/5025 (90.5672%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1384, Accuracy: 5348/10000 (53.4800%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3402/3590 (94.7632%)
___Train Local_ResNet_18,  epoch 153, local model 63, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3244/3590 (90.3621%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.9965, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4293/4596 (93.4073%)
___Train Local_ResNet_18,  epoch 153, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4259/4596 (92.6675%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0462, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4013/4336 (92.5507%)
___Train Local_ResNet_18,  epoch 153, local model 41, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3968/4336 (91.5129%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0763, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4528/4874 (92.9011%)
___Train Local_ResNet_18,  epoch 153, local model 82, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4443/4874 (91.1572%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1202, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4824/5167 (93.3617%)
___Train Local_ResNet_18,  epoch 153, local model 35, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4778/5167 (92.4715%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0714, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4323/4618 (93.6120%)
___Train Local_ResNet_18,  epoch 153, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4274/4618 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.0225, Accuracy: 5589/10000 (55.8900%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4468/4928 (90.6656%)
___Train Local_ResNet_18,  epoch 153, local model 19, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4425/4928 (89.7930%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 2.1460, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4337/4647 (93.3290%)
___Train Local_ResNet_18,  epoch 153, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4332/4647 (93.2214%)
___Test Local_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.8667, Accuracy: 5773/10000 (57.7300%)
time spent on training: 261.4230043888092
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 153: Average loss: 1.3232, Accuracy: 6663/10000 (66.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 153: Average loss: 0.0699, Accuracy: 9715/9900 (98.1313%)
Done in 288.3662075996399 sec.
Server Epoch:154 choose agents : [13, 36, 58, 71, 50, 54, 20, 2, 63, 61, 97, 39, 73, 25, 33, 76, 22, 41, 56, 7].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4763/4885 (97.5026%), train_poison_data_count: 385
Global model norm: 44.20676046600155.
Norm before scaling: 44.17088840868497. Distance: 1.1606281489595045
Total norm for 4 adversaries is: 44.17088840868497. distance: 1.1606281489595045
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0484, Accuracy: 9779/9900 (98.7778%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5166/5305 (97.3798%), train_poison_data_count: 415
Global model norm: 44.20676046600155.
Norm before scaling: 44.17063830290363. Distance: 1.2626514117404655
Total norm for 4 adversaries is: 44.17063830290363. distance: 1.2626514117404655
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0552, Accuracy: 9776/9900 (98.7475%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4585/4717 (97.2016%), train_poison_data_count: 370
Global model norm: 44.20676046600155.
Norm before scaling: 44.1759938497957. Distance: 1.1962029126345979
Total norm for 4 adversaries is: 44.1759938497957. distance: 1.1962029126345979
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0609, Accuracy: 9730/9900 (98.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 154, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4911/5066 (96.9404%), train_poison_data_count: 400
Global model norm: 44.20676046600155.
Norm before scaling: 44.17417005224532. Distance: 1.2897970707543498
Total norm for 4 adversaries is: 44.17417005224532. distance: 1.2897970707543498
___Test Local_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0141, Accuracy: 9866/9900 (99.6566%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4047/4368 (92.6511%)
___Train Local_ResNet_18,  epoch 154, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3917/4368 (89.6749%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1117, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4777/5195 (91.9538%)
___Train Local_ResNet_18,  epoch 154, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4680/5195 (90.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0215, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4046/4315 (93.7659%)
___Train Local_ResNet_18,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4019/4315 (93.1402%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8305, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3406/3646 (93.4174%)
___Train Local_ResNet_18,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3408/3646 (93.4723%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8194, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3361/3590 (93.6212%)
___Train Local_ResNet_18,  epoch 154, local model 63, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3304/3590 (92.0334%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.2075, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3908/4126 (94.7164%)
___Train Local_ResNet_18,  epoch 154, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3894/4126 (94.3771%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8288, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4016/4361 (92.0890%)
___Train Local_ResNet_18,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3810/4361 (87.3653%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1882, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3584/3837 (93.4063%)
___Train Local_ResNet_18,  epoch 154, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3613/3837 (94.1621%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.8895, Accuracy: 5759/10000 (57.5900%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4013/4235 (94.7580%)
___Train Local_ResNet_18,  epoch 154, local model 73, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3850/4235 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9921, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5447/5902 (92.2907%)
___Train Local_ResNet_18,  epoch 154, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5118/5902 (86.7164%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3445, Accuracy: 5158/10000 (51.5800%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4147/4433 (93.5484%)
___Train Local_ResNet_18,  epoch 154, local model 33, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4077/4433 (91.9693%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9271, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3327/3638 (91.4513%)
___Train Local_ResNet_18,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3363/3638 (92.4409%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.9679, Accuracy: 5498/10000 (54.9800%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4849/5232 (92.6797%)
___Train Local_ResNet_18,  epoch 154, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4760/5232 (90.9786%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1146, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4044/4336 (93.2657%)
___Train Local_ResNet_18,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3983/4336 (91.8589%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.1202, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4581/4989 (91.8220%)
___Train Local_ResNet_18,  epoch 154, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4516/4989 (90.5191%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.0609, Accuracy: 5598/10000 (55.9800%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4101/4481 (91.5198%)
___Train Local_ResNet_18,  epoch 154, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3946/4481 (88.0607%)
___Test Local_ResNet_18 poisoned: False, epoch: 154: Average loss: 2.3049, Accuracy: 5164/10000 (51.6400%)
time spent on training: 259.0409138202667
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 154: Average loss: 1.3341, Accuracy: 6633/10000 (66.3300%)
___Test Target_ResNet_18 poisoned: True, epoch: 154: Average loss: 0.0619, Accuracy: 9740/9900 (98.3838%)
Done in 286.04562497138977 sec.
Server Epoch:155 choose agents : [13, 36, 58, 71, 67, 90, 48, 10, 12, 72, 52, 54, 81, 33, 65, 91, 79, 31, 9, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4768/4885 (97.6049%), train_poison_data_count: 385
Global model norm: 44.22626371675263.
Norm before scaling: 44.19025970431012. Distance: 1.1652175498000885
Total norm for 4 adversaries is: 44.19025970431012. distance: 1.1652175498000885
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0643, Accuracy: 9738/9900 (98.3636%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5145/5305 (96.9840%), train_poison_data_count: 415
Global model norm: 44.22626371675263.
Norm before scaling: 44.1918798107858. Distance: 1.3093889240261993
Total norm for 4 adversaries is: 44.1918798107858. distance: 1.3093889240261993
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0294, Accuracy: 9817/9900 (99.1616%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4578/4717 (97.0532%), train_poison_data_count: 370
Global model norm: 44.22626371675263.
Norm before scaling: 44.19406333858655. Distance: 1.185168034514427
Total norm for 4 adversaries is: 44.19406333858655. distance: 1.185168034514427
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0196, Accuracy: 9852/9900 (99.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 155, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 44.22626371675263.
Norm before scaling: 44.1921090793686. Distance: 1.2288608278294104
Total norm for 4 adversaries is: 44.1921090793686. distance: 1.2288608278294104
___Test Local_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0497, Accuracy: 9771/9900 (98.6970%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4754/5116 (92.9242%)
___Train Local_ResNet_18,  epoch 155, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4657/5116 (91.0281%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0547, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4137/4362 (94.8418%)
___Train Local_ResNet_18,  epoch 155, local model 90, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3988/4362 (91.4260%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0209, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4205/4441 (94.6859%)
___Train Local_ResNet_18,  epoch 155, local model 48, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4175/4441 (94.0104%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8839, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4422/4663 (94.8317%)
___Train Local_ResNet_18,  epoch 155, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4390/4663 (94.1454%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9427, Accuracy: 5622/10000 (56.2200%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4703/5083 (92.5241%)
___Train Local_ResNet_18,  epoch 155, local model 12, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4522/5083 (88.9632%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0623, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4378/4767 (91.8397%)
___Train Local_ResNet_18,  epoch 155, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4258/4767 (89.3224%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1925, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3584/3797 (94.3903%)
___Train Local_ResNet_18,  epoch 155, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3535/3797 (93.0998%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8919, Accuracy: 5751/10000 (57.5100%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4813/5195 (92.6468%)
___Train Local_ResNet_18,  epoch 155, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4576/5195 (88.0847%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.3075, Accuracy: 5058/10000 (50.5800%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4333/4618 (93.8285%)
___Train Local_ResNet_18,  epoch 155, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4251/4618 (92.0528%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1751, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4195/4433 (94.6312%)
___Train Local_ResNet_18,  epoch 155, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4144/4433 (93.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9148, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4717/5055 (93.3136%)
___Train Local_ResNet_18,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4630/5055 (91.5925%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.0611, Accuracy: 5422/10000 (54.2200%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3794/4158 (91.2458%)
___Train Local_ResNet_18,  epoch 155, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3772/4158 (90.7167%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8855, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3549/3781 (93.8641%)
___Train Local_ResNet_18,  epoch 155, local model 79, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3373/3781 (89.2092%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 2.1847, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3889/4175 (93.1497%)
___Train Local_ResNet_18,  epoch 155, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3864/4175 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9042, Accuracy: 5656/10000 (56.5600%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4920/5265 (93.4473%)
___Train Local_ResNet_18,  epoch 155, local model 9, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4806/5265 (91.2821%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.9369, Accuracy: 5643/10000 (56.4300%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3625/3837 (94.4749%)
___Train Local_ResNet_18,  epoch 155, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3606/3837 (93.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.8790, Accuracy: 5832/10000 (58.3200%)
time spent on training: 261.24975967407227
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 17 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 155: Average loss: 1.3420, Accuracy: 6623/10000 (66.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 155: Average loss: 0.0594, Accuracy: 9745/9900 (98.4343%)
Done in 288.12285923957825 sec.
Server Epoch:156 choose agents : [13, 36, 58, 71, 18, 54, 51, 96, 97, 87, 7, 61, 24, 67, 62, 68, 45, 5, 8, 99].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4786/4885 (97.9734%), train_poison_data_count: 385
Global model norm: 44.24588665998372.
Norm before scaling: 44.20979370428005. Distance: 1.1557689903426984
Total norm for 4 adversaries is: 44.20979370428005. distance: 1.1557689903426984
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0441, Accuracy: 9796/9900 (98.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5138/5305 (96.8520%), train_poison_data_count: 415
Global model norm: 44.24588665998372.
Norm before scaling: 44.21229524443681. Distance: 1.3447255430307727
Total norm for 4 adversaries is: 44.21229524443681. distance: 1.3447255430307727
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0455, Accuracy: 9769/9900 (98.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4581/4717 (97.1168%), train_poison_data_count: 370
Global model norm: 44.24588665998372.
Norm before scaling: 44.21257134394866. Distance: 1.184429666671708
Total norm for 4 adversaries is: 44.21257134394866. distance: 1.184429666671708
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0380, Accuracy: 9809/9900 (99.0808%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 156, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4929/5066 (97.2957%), train_poison_data_count: 400
Global model norm: 44.24588665998372.
Norm before scaling: 44.21332232589799. Distance: 1.2776154861954383
Total norm for 4 adversaries is: 44.21332232589799. distance: 1.2776154861954383
___Test Local_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0791, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3693/3911 (94.4260%)
___Train Local_ResNet_18,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3532/3911 (90.3094%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9957, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4782/5195 (92.0500%)
___Train Local_ResNet_18,  epoch 156, local model 54, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4586/5195 (88.2772%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1250, Accuracy: 5387/10000 (53.8700%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3550/3775 (94.0397%)
___Train Local_ResNet_18,  epoch 156, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3588/3775 (95.0464%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7700, Accuracy: 5919/10000 (59.1900%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4363/4679 (93.2464%)
___Train Local_ResNet_18,  epoch 156, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4225/4679 (90.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.3099, Accuracy: 5086/10000 (50.8600%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4006/4361 (91.8597%)
___Train Local_ResNet_18,  epoch 156, local model 97, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3845/4361 (88.1679%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1228, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3393/3672 (92.4020%)
___Train Local_ResNet_18,  epoch 156, local model 87, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3383/3672 (92.1296%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8730, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4085/4481 (91.1627%)
___Train Local_ResNet_18,  epoch 156, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3911/4481 (87.2796%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.4235, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3876/4126 (93.9409%)
___Train Local_ResNet_18,  epoch 156, local model 61, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3853/4126 (93.3834%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8151, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3713/3969 (93.5500%)
___Train Local_ResNet_18,  epoch 156, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3620/3969 (91.2069%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9006, Accuracy: 5743/10000 (57.4300%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4745/5116 (92.7482%)
___Train Local_ResNet_18,  epoch 156, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4574/5116 (89.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0735, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4672/5063 (92.2773%)
___Train Local_ResNet_18,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4511/5063 (89.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.1921, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3114/3297 (94.4495%)
___Train Local_ResNet_18,  epoch 156, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3135/3297 (95.0864%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.7537, Accuracy: 6010/10000 (60.1000%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4609/5037 (91.5029%)
___Train Local_ResNet_18,  epoch 156, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4645/5037 (92.2176%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0898, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4304/4596 (93.6466%)
___Train Local_ResNet_18,  epoch 156, local model 5, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4316/4596 (93.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.8708, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4215/4501 (93.6459%)
___Train Local_ResNet_18,  epoch 156, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4101/4501 (91.1131%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.9415, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4188/4465 (93.7962%)
___Train Local_ResNet_18,  epoch 156, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4172/4465 (93.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 156: Average loss: 2.0059, Accuracy: 5617/10000 (56.1700%)
time spent on training: 259.03026843070984
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 156: Average loss: 1.3542, Accuracy: 6608/10000 (66.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 156: Average loss: 0.0561, Accuracy: 9754/9900 (98.5253%)
Done in 286.0486116409302 sec.
Server Epoch:157 choose agents : [13, 36, 58, 71, 97, 29, 40, 99, 41, 48, 90, 24, 75, 0, 62, 83, 92, 82, 18, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4776/4885 (97.7687%), train_poison_data_count: 385
Global model norm: 44.264927302126004.
Norm before scaling: 44.23038440141432. Distance: 1.1643011373372638
Total norm for 4 adversaries is: 44.23038440141432. distance: 1.1643011373372638
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0986, Accuracy: 9655/9900 (97.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5135/5305 (96.7955%), train_poison_data_count: 415
Global model norm: 44.264927302126004.
Norm before scaling: 44.230261586826074. Distance: 1.3072112566571823
Total norm for 4 adversaries is: 44.230261586826074. distance: 1.3072112566571823
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0439, Accuracy: 9789/9900 (98.8788%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4576/4717 (97.0108%), train_poison_data_count: 370
Global model norm: 44.264927302126004.
Norm before scaling: 44.234177686331385. Distance: 1.218125648009048
Total norm for 4 adversaries is: 44.234177686331385. distance: 1.218125648009048
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0301, Accuracy: 9824/9900 (99.2323%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 157, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4913/5066 (96.9799%), train_poison_data_count: 400
Global model norm: 44.264927302126004.
Norm before scaling: 44.232346628697535. Distance: 1.302840061275943
Total norm for 4 adversaries is: 44.232346628697535. distance: 1.302840061275943
___Test Local_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.1179, Accuracy: 9593/9900 (96.8990%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4047/4361 (92.7998%)
___Train Local_ResNet_18,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3921/4361 (89.9106%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0580, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4108/4346 (94.5237%)
___Train Local_ResNet_18,  epoch 157, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4117/4346 (94.7308%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8320, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5085/5455 (93.2172%)
___Train Local_ResNet_18,  epoch 157, local model 40, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4970/5455 (91.1091%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9985, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4161/4465 (93.1915%)
___Train Local_ResNet_18,  epoch 157, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4172/4465 (93.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8629, Accuracy: 5797/10000 (57.9700%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4000/4336 (92.2509%)
___Train Local_ResNet_18,  epoch 157, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4006/4336 (92.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.1479, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4186/4441 (94.2580%)
___Train Local_ResNet_18,  epoch 157, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4154/4441 (93.5375%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0944, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4134/4362 (94.7730%)
___Train Local_ResNet_18,  epoch 157, local model 90, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3982/4362 (91.2884%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0715, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3763/3969 (94.8098%)
___Train Local_ResNet_18,  epoch 157, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3646/3969 (91.8619%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.9509, Accuracy: 5792/10000 (57.9200%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4003/4295 (93.2014%)
___Train Local_ResNet_18,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3828/4295 (89.1269%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2097, Accuracy: 5352/10000 (53.5200%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4681/5017 (93.3028%)
___Train Local_ResNet_18,  epoch 157, local model 0, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4635/5017 (92.3859%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.8711, Accuracy: 5813/10000 (58.1300%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4691/5063 (92.6526%)
___Train Local_ResNet_18,  epoch 157, local model 62, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4422/5063 (87.3395%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3333, Accuracy: 5060/10000 (50.6000%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3022/3271 (92.3876%)
___Train Local_ResNet_18,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2952/3271 (90.2476%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0998, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5849/6263 (93.3897%)
___Train Local_ResNet_18,  epoch 157, local model 92, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5708/6263 (91.1384%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.3924, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4545/4874 (93.2499%)
___Train Local_ResNet_18,  epoch 157, local model 82, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4447/4874 (91.2392%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.2722, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3690/3911 (94.3493%)
___Train Local_ResNet_18,  epoch 157, local model 18, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3510/3911 (89.7469%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.0998, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4460/4804 (92.8393%)
___Train Local_ResNet_18,  epoch 157, local model 94, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3944/4804 (82.0983%)
___Test Local_ResNet_18 poisoned: False, epoch: 157: Average loss: 2.7156, Accuracy: 4518/10000 (45.1800%)
time spent on training: 256.9186341762543
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 11 ranked 2 as suspicious. Assigned small weight: 0.1
Client 10 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 157: Average loss: 1.3488, Accuracy: 6613/10000 (66.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 157: Average loss: 0.0567, Accuracy: 9752/9900 (98.5051%)
Done in 283.80359649658203 sec.
Server Epoch:158 choose agents : [13, 36, 58, 71, 25, 3, 78, 30, 84, 88, 18, 70, 76, 53, 31, 95, 37, 17, 4, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4761/4885 (97.4616%), train_poison_data_count: 385
Global model norm: 44.284003861968884.
Norm before scaling: 44.248170976500546. Distance: 1.1757474875434444
Total norm for 4 adversaries is: 44.248170976500546. distance: 1.1757474875434444
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0776, Accuracy: 9703/9900 (98.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 36, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5117/5305 (96.4562%), train_poison_data_count: 415
Global model norm: 44.284003861968884.
Norm before scaling: 44.251045516426785. Distance: 1.383792896036614
Total norm for 4 adversaries is: 44.251045516426785. distance: 1.383792896036614
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0462, Accuracy: 9778/9900 (98.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4587/4717 (97.2440%), train_poison_data_count: 370
Global model norm: 44.284003861968884.
Norm before scaling: 44.249713099352405. Distance: 1.139249782576466
Total norm for 4 adversaries is: 44.249713099352405. distance: 1.139249782576466
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0508, Accuracy: 9764/9900 (98.6263%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 158, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4933/5066 (97.3747%), train_poison_data_count: 400
Global model norm: 44.284003861968884.
Norm before scaling: 44.25035034730657. Distance: 1.2768734874146885
Total norm for 4 adversaries is: 44.25035034730657. distance: 1.2768734874146885
___Test Local_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0427, Accuracy: 9787/9900 (98.8586%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5422/5902 (91.8672%)
___Train Local_ResNet_18,  epoch 158, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5151/5902 (87.2755%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3941, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4630/4918 (94.1440%)
___Train Local_ResNet_18,  epoch 158, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4533/4918 (92.1716%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1795, Accuracy: 5291/10000 (52.9100%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3737/4025 (92.8447%)
___Train Local_ResNet_18,  epoch 158, local model 78, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3789/4025 (94.1366%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9648, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3279/3472 (94.4412%)
___Train Local_ResNet_18,  epoch 158, local model 30, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3257/3472 (93.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0307, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4473/4793 (93.3236%)
___Train Local_ResNet_18,  epoch 158, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4353/4793 (90.8199%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0705, Accuracy: 5478/10000 (54.7800%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4539/4934 (91.9943%)
___Train Local_ResNet_18,  epoch 158, local model 88, internal_epoch   2,  Average loss: 0.0079, Accuracy: 4216/4934 (85.4479%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.3896, Accuracy: 4762/10000 (47.6200%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3697/3911 (94.5283%)
___Train Local_ResNet_18,  epoch 158, local model 18, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3467/3911 (88.6474%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1295, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5036/5392 (93.3976%)
___Train Local_ResNet_18,  epoch 158, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4807/5392 (89.1506%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.1275, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3332/3638 (91.5888%)
___Train Local_ResNet_18,  epoch 158, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3351/3638 (92.1111%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8032, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5663/6124 (92.4722%)
___Train Local_ResNet_18,  epoch 158, local model 53, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5547/6124 (90.5781%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.9583, Accuracy: 5596/10000 (55.9600%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3882/4175 (92.9820%)
___Train Local_ResNet_18,  epoch 158, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3818/4175 (91.4491%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.8793, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4220/4625 (91.2432%)
___Train Local_ResNet_18,  epoch 158, local model 95, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4122/4625 (89.1243%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.2260, Accuracy: 5137/10000 (51.3700%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4066/4354 (93.3854%)
___Train Local_ResNet_18,  epoch 158, local model 37, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3628/4354 (83.3257%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.6035, Accuracy: 4626/10000 (46.2600%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4200/4511 (93.1057%)
___Train Local_ResNet_18,  epoch 158, local model 17, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4153/4511 (92.0638%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 2.0383, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3442/3704 (92.9266%)
___Train Local_ResNet_18,  epoch 158, local model 4, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3456/3704 (93.3045%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7827, Accuracy: 5943/10000 (59.4300%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3623/3861 (93.8358%)
___Train Local_ResNet_18,  epoch 158, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3587/3861 (92.9034%)
___Test Local_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.7634, Accuracy: 5940/10000 (59.4000%)
time spent on training: 260.61330246925354
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 158: Average loss: 1.3565, Accuracy: 6606/10000 (66.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 158: Average loss: 0.0585, Accuracy: 9743/9900 (98.4141%)
Done in 288.29385781288147 sec.
Server Epoch:159 choose agents : [13, 36, 58, 71, 12, 2, 64, 8, 69, 90, 20, 93, 74, 4, 47, 44, 42, 41, 7, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.304763958010206.
Norm before scaling: 44.26814820288398. Distance: 1.1418796066917865
Total norm for 4 adversaries is: 44.26814820288398. distance: 1.1418796066917865
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0182, Accuracy: 9859/9900 (99.5859%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5142/5305 (96.9274%), train_poison_data_count: 415
Global model norm: 44.304763958010206.
Norm before scaling: 44.27193135893215. Distance: 1.349675531601443
Total norm for 4 adversaries is: 44.27193135893215. distance: 1.349675531601443
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0457, Accuracy: 9800/9900 (98.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.304763958010206.
Norm before scaling: 44.27023146036948. Distance: 1.1436818587219642
Total norm for 4 adversaries is: 44.27023146036948. distance: 1.1436818587219642
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0259, Accuracy: 9839/9900 (99.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 159, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4930/5066 (97.3154%), train_poison_data_count: 400
Global model norm: 44.304763958010206.
Norm before scaling: 44.27220846516257. Distance: 1.2826525756917142
Total norm for 4 adversaries is: 44.27220846516257. distance: 1.2826525756917142
___Test Local_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0255, Accuracy: 9845/9900 (99.4444%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4737/5083 (93.1930%)
___Train Local_ResNet_18,  epoch 159, local model 12, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4593/5083 (90.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1014, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3418/3646 (93.7466%)
___Train Local_ResNet_18,  epoch 159, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3388/3646 (92.9238%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7156, Accuracy: 5973/10000 (59.7300%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4244/4503 (94.2483%)
___Train Local_ResNet_18,  epoch 159, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4113/4503 (91.3391%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.1304, Accuracy: 5412/10000 (54.1200%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4199/4501 (93.2904%)
___Train Local_ResNet_18,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4060/4501 (90.2022%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0985, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3754/4013 (93.5460%)
___Train Local_ResNet_18,  epoch 159, local model 69, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3788/4013 (94.3932%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7689, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4149/4362 (95.1169%)
___Train Local_ResNet_18,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4073/4362 (93.3746%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.9475, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4087/4315 (94.7161%)
___Train Local_ResNet_18,  epoch 159, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4080/4315 (94.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8651, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4332/4651 (93.1413%)
___Train Local_ResNet_18,  epoch 159, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4280/4651 (92.0232%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2376, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4067/4416 (92.0969%)
___Train Local_ResNet_18,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4002/4416 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0272, Accuracy: 5442/10000 (54.4200%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3466/3704 (93.5745%)
___Train Local_ResNet_18,  epoch 159, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3440/3704 (92.8726%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8560, Accuracy: 5856/10000 (58.5600%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4418/4707 (93.8602%)
___Train Local_ResNet_18,  epoch 159, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4327/4707 (91.9269%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0325, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4360/4662 (93.5221%)
___Train Local_ResNet_18,  epoch 159, local model 44, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4272/4662 (91.6345%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.0274, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5086/5424 (93.7684%)
___Train Local_ResNet_18,  epoch 159, local model 42, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5014/5424 (92.4410%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.4547, Accuracy: 5007/10000 (50.0700%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4038/4336 (93.1273%)
___Train Local_ResNet_18,  epoch 159, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4048/4336 (93.3579%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.8591, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4144/4481 (92.4794%)
___Train Local_ResNet_18,  epoch 159, local model 7, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4013/4481 (89.5559%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 2.2091, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3611/3828 (94.3312%)
___Train Local_ResNet_18,  epoch 159, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3611/3828 (94.3312%)
___Test Local_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.7657, Accuracy: 6025/10000 (60.2500%)
time spent on training: 255.1044683456421
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 159: Average loss: 1.3599, Accuracy: 6608/10000 (66.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 159: Average loss: 0.0485, Accuracy: 9773/9900 (98.7172%)
Done in 282.1050672531128 sec.
Server Epoch:160 choose agents : [13, 36, 58, 71, 23, 45, 91, 83, 3, 25, 37, 24, 89, 75, 61, 16, 17, 81, 4, 86].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4744/4885 (97.1136%), train_poison_data_count: 385
Global model norm: 44.32277681871788.
Norm before scaling: 44.288748979089625. Distance: 1.233269884865935
Total norm for 4 adversaries is: 44.288748979089625. distance: 1.233269884865935
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0282, Accuracy: 9833/9900 (99.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.32277681871788.
Norm before scaling: 44.287332250335. Distance: 1.3146024395279192
Total norm for 4 adversaries is: 44.287332250335. distance: 1.3146024395279192
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0763, Accuracy: 9705/9900 (98.0303%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4589/4717 (97.2864%), train_poison_data_count: 370
Global model norm: 44.32277681871788.
Norm before scaling: 44.290595619742604. Distance: 1.1952844254930426
Total norm for 4 adversaries is: 44.290595619742604. distance: 1.1952844254930426
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0290, Accuracy: 9829/9900 (99.2828%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 160, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4924/5066 (97.1970%), train_poison_data_count: 400
Global model norm: 44.32277681871788.
Norm before scaling: 44.2889226217142. Distance: 1.2577753476170703
Total norm for 4 adversaries is: 44.2889226217142. distance: 1.2577753476170703
___Test Local_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0467, Accuracy: 9789/9900 (98.8788%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3960/4184 (94.6463%)
___Train Local_ResNet_18,  epoch 160, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3868/4184 (92.4474%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8511, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4599/5037 (91.3043%)
___Train Local_ResNet_18,  epoch 160, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4616/5037 (91.6419%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0167, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3799/4158 (91.3660%)
___Train Local_ResNet_18,  epoch 160, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3744/4158 (90.0433%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0365, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3038/3271 (92.8768%)
___Train Local_ResNet_18,  epoch 160, local model 83, internal_epoch   2,  Average loss: 0.0047, Accuracy: 2973/3271 (90.8896%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9436, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4613/4918 (93.7983%)
___Train Local_ResNet_18,  epoch 160, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4606/4918 (93.6560%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9716, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5452/5902 (92.3755%)
___Train Local_ResNet_18,  epoch 160, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5287/5902 (89.5798%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1392, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4086/4354 (93.8447%)
___Train Local_ResNet_18,  epoch 160, local model 37, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4005/4354 (91.9844%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.2403, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3737/3969 (94.1547%)
___Train Local_ResNet_18,  epoch 160, local model 24, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3665/3969 (92.3406%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9225, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4048/4356 (92.9293%)
___Train Local_ResNet_18,  epoch 160, local model 89, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3975/4356 (91.2534%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.1351, Accuracy: 5222/10000 (52.2200%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4016/4295 (93.5041%)
___Train Local_ResNet_18,  epoch 160, local model 75, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4006/4295 (93.2712%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9342, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3924/4126 (95.1042%)
___Train Local_ResNet_18,  epoch 160, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3883/4126 (94.1105%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.7158, Accuracy: 5957/10000 (59.5700%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4600/4928 (93.3442%)
___Train Local_ResNet_18,  epoch 160, local model 16, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4488/4928 (91.0714%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8895, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4182/4511 (92.7067%)
___Train Local_ResNet_18,  epoch 160, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4143/4511 (91.8422%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.9047, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4354/4618 (94.2832%)
___Train Local_ResNet_18,  epoch 160, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4261/4618 (92.2694%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 2.0168, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3460/3704 (93.4125%)
___Train Local_ResNet_18,  epoch 160, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3457/3704 (93.3315%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8452, Accuracy: 5817/10000 (58.1700%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3326/3616 (91.9801%)
___Train Local_ResNet_18,  epoch 160, local model 86, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3354/3616 (92.7544%)
___Test Local_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.8720, Accuracy: 5823/10000 (58.2300%)
time spent on training: 256.7397346496582
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 160: Average loss: 1.3677, Accuracy: 6578/10000 (65.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 160: Average loss: 0.0500, Accuracy: 9769/9900 (98.6768%)
Done in 283.6122043132782 sec.
Server Epoch:161 choose agents : [13, 36, 58, 71, 83, 66, 69, 79, 51, 22, 56, 2, 20, 3, 74, 92, 53, 93, 55, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4783/4885 (97.9120%), train_poison_data_count: 385
Global model norm: 44.340347385310366.
Norm before scaling: 44.30405034478366. Distance: 1.1451430524559252
Total norm for 4 adversaries is: 44.30405034478366. distance: 1.1451430524559252
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0488, Accuracy: 9783/9900 (98.8182%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5150/5305 (97.0782%), train_poison_data_count: 415
Global model norm: 44.340347385310366.
Norm before scaling: 44.30513591401537. Distance: 1.2935458736358434
Total norm for 4 adversaries is: 44.30513591401537. distance: 1.2935458736358434
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0280, Accuracy: 9821/9900 (99.2020%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4603/4717 (97.5832%), train_poison_data_count: 370
Global model norm: 44.340347385310366.
Norm before scaling: 44.3047873775545. Distance: 1.108344015390265
Total norm for 4 adversaries is: 44.3047873775545. distance: 1.108344015390265
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0334, Accuracy: 9821/9900 (99.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 161, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4929/5066 (97.2957%), train_poison_data_count: 400
Global model norm: 44.340347385310366.
Norm before scaling: 44.30501743947857. Distance: 1.2588527950373563
Total norm for 4 adversaries is: 44.30501743947857. distance: 1.2588527950373563
___Test Local_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0308, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3043/3271 (93.0297%)
___Train Local_ResNet_18,  epoch 161, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2953/3271 (90.2782%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1298, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4226/4456 (94.8384%)
___Train Local_ResNet_18,  epoch 161, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4164/4456 (93.4470%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8487, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3761/4013 (93.7204%)
___Train Local_ResNet_18,  epoch 161, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3781/4013 (94.2188%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7166, Accuracy: 5908/10000 (59.0800%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3531/3781 (93.3880%)
___Train Local_ResNet_18,  epoch 161, local model 79, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3333/3781 (88.1513%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.2101, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3560/3775 (94.3046%)
___Train Local_ResNet_18,  epoch 161, local model 51, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3581/3775 (94.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8665, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4817/5232 (92.0680%)
___Train Local_ResNet_18,  epoch 161, local model 22, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4621/5232 (88.3219%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1068, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4625/4989 (92.7039%)
___Train Local_ResNet_18,  epoch 161, local model 56, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4518/4989 (90.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1263, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3387/3646 (92.8963%)
___Train Local_ResNet_18,  epoch 161, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3423/3646 (93.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7563, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4083/4315 (94.6234%)
___Train Local_ResNet_18,  epoch 161, local model 20, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4080/4315 (94.5539%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.7917, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4631/4918 (94.1643%)
___Train Local_ResNet_18,  epoch 161, local model 3, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4534/4918 (92.1919%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1241, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4058/4416 (91.8931%)
___Train Local_ResNet_18,  epoch 161, local model 74, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4002/4416 (90.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.0343, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5794/6263 (92.5116%)
___Train Local_ResNet_18,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5681/6263 (90.7073%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1865, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5625/6124 (91.8517%)
___Train Local_ResNet_18,  epoch 161, local model 53, internal_epoch   2,  Average loss: 0.0056, Accuracy: 5444/6124 (88.8961%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1240, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4385/4651 (94.2808%)
___Train Local_ResNet_18,  epoch 161, local model 93, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4296/4651 (92.3672%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.8835, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4099/4356 (94.1001%)
___Train Local_ResNet_18,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3835/4356 (88.0395%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.1196, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4098/4356 (94.0771%)
___Train Local_ResNet_18,  epoch 161, local model 89, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3847/4356 (88.3150%)
___Test Local_ResNet_18 poisoned: False, epoch: 161: Average loss: 2.4434, Accuracy: 4854/10000 (48.5400%)
time spent on training: 261.0002944469452
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 19 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 161: Average loss: 1.3814, Accuracy: 6566/10000 (65.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 161: Average loss: 0.0455, Accuracy: 9781/9900 (98.7980%)
Done in 287.8782207965851 sec.
Server Epoch:162 choose agents : [13, 36, 58, 71, 28, 21, 98, 56, 67, 90, 0, 37, 76, 54, 5, 19, 11, 25, 80, 53].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.358643002061896.
Norm before scaling: 44.32274376924758. Distance: 1.1419091507806016
Total norm for 4 adversaries is: 44.32274376924758. distance: 1.1419091507806016
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0751, Accuracy: 9703/9900 (98.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5158/5305 (97.2290%), train_poison_data_count: 415
Global model norm: 44.358643002061896.
Norm before scaling: 44.322780949899936. Distance: 1.304020511290358
Total norm for 4 adversaries is: 44.322780949899936. distance: 1.304020511290358
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0478, Accuracy: 9773/9900 (98.7172%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.358643002061896.
Norm before scaling: 44.325442728154165. Distance: 1.172905075034032
Total norm for 4 adversaries is: 44.325442728154165. distance: 1.172905075034032
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0329, Accuracy: 9817/9900 (99.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 162, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4911/5066 (96.9404%), train_poison_data_count: 400
Global model norm: 44.358643002061896.
Norm before scaling: 44.325839296023204. Distance: 1.304760045758628
Total norm for 4 adversaries is: 44.325839296023204. distance: 1.304760045758628
___Test Local_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0243, Accuracy: 9844/9900 (99.4343%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4308/4716 (91.3486%)
___Train Local_ResNet_18,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4214/4716 (89.3554%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0819, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4328/4634 (93.3966%)
___Train Local_ResNet_18,  epoch 162, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4253/4634 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9824, Accuracy: 5594/10000 (55.9400%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3611/3828 (94.3312%)
___Train Local_ResNet_18,  epoch 162, local model 98, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3583/3828 (93.5998%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8066, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4618/4989 (92.5636%)
___Train Local_ResNet_18,  epoch 162, local model 56, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4604/4989 (92.2830%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8924, Accuracy: 5777/10000 (57.7700%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4795/5116 (93.7256%)
___Train Local_ResNet_18,  epoch 162, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4694/5116 (91.7514%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0815, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4165/4362 (95.4837%)
___Train Local_ResNet_18,  epoch 162, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4121/4362 (94.4750%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8175, Accuracy: 5884/10000 (58.8400%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4716/5017 (94.0004%)
___Train Local_ResNet_18,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4642/5017 (92.5254%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8481, Accuracy: 5760/10000 (57.6000%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4043/4354 (92.8571%)
___Train Local_ResNet_18,  epoch 162, local model 37, internal_epoch   2,  Average loss: 0.0121, Accuracy: 3397/4354 (78.0202%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.7398, Accuracy: 4545/10000 (45.4500%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3348/3638 (92.0286%)
___Train Local_ResNet_18,  epoch 162, local model 76, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3369/3638 (92.6058%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.8622, Accuracy: 5819/10000 (58.1900%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4819/5195 (92.7623%)
___Train Local_ResNet_18,  epoch 162, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4666/5195 (89.8171%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.9716, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4314/4596 (93.8642%)
___Train Local_ResNet_18,  epoch 162, local model 5, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4227/4596 (91.9713%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1357, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4498/4928 (91.2744%)
___Train Local_ResNet_18,  epoch 162, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4451/4928 (90.3206%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1424, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4734/5244 (90.2746%)
___Train Local_ResNet_18,  epoch 162, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4647/5244 (88.6156%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1029, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5490/5902 (93.0193%)
___Train Local_ResNet_18,  epoch 162, local model 25, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5282/5902 (89.4951%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.1482, Accuracy: 5360/10000 (53.6000%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4646/5025 (92.4577%)
___Train Local_ResNet_18,  epoch 162, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4559/5025 (90.7264%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0975, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5638/6124 (92.0640%)
___Train Local_ResNet_18,  epoch 162, local model 53, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5466/6124 (89.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 162: Average loss: 2.0454, Accuracy: 5406/10000 (54.0600%)
time spent on training: 263.70387983322144
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 162: Average loss: 1.3828, Accuracy: 6564/10000 (65.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 162: Average loss: 0.0416, Accuracy: 9788/9900 (98.8687%)
Done in 290.6702160835266 sec.
Server Epoch:163 choose agents : [13, 36, 58, 71, 67, 49, 55, 96, 77, 18, 20, 2, 21, 65, 90, 88, 72, 33, 19, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4778/4885 (97.8096%), train_poison_data_count: 385
Global model norm: 44.38054955395367.
Norm before scaling: 44.34513739901479. Distance: 1.183132320891238
Total norm for 4 adversaries is: 44.34513739901479. distance: 1.183132320891238
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0718, Accuracy: 9710/9900 (98.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5168/5305 (97.4175%), train_poison_data_count: 415
Global model norm: 44.38054955395367.
Norm before scaling: 44.34377339895436. Distance: 1.2676353970654135
Total norm for 4 adversaries is: 44.34377339895436. distance: 1.2676353970654135
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.1083, Accuracy: 9631/9900 (97.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4590/4717 (97.3076%), train_poison_data_count: 370
Global model norm: 44.38054955395367.
Norm before scaling: 44.345853103757065. Distance: 1.116966866000938
Total norm for 4 adversaries is: 44.345853103757065. distance: 1.116966866000938
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0248, Accuracy: 9832/9900 (99.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 163, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4936/5066 (97.4339%), train_poison_data_count: 400
Global model norm: 44.38054955395367.
Norm before scaling: 44.34492268533964. Distance: 1.2211643659853662
Total norm for 4 adversaries is: 44.34492268533964. distance: 1.2211643659853662
___Test Local_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0274, Accuracy: 9839/9900 (99.3838%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4810/5116 (94.0188%)
___Train Local_ResNet_18,  epoch 163, local model 67, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4672/5116 (91.3213%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.1637, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4850/5197 (93.3231%)
___Train Local_ResNet_18,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4640/5197 (89.2823%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.3128, Accuracy: 5080/10000 (50.8000%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4085/4356 (93.7787%)
___Train Local_ResNet_18,  epoch 163, local model 55, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3890/4356 (89.3021%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2060, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4355/4679 (93.0754%)
___Train Local_ResNet_18,  epoch 163, local model 96, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4345/4679 (92.8617%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0635, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4337/4647 (93.3290%)
___Train Local_ResNet_18,  epoch 163, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4327/4647 (93.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8701, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3698/3911 (94.5538%)
___Train Local_ResNet_18,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3606/3911 (92.2015%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9305, Accuracy: 5716/10000 (57.1600%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4110/4315 (95.2491%)
___Train Local_ResNet_18,  epoch 163, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4087/4315 (94.7161%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8388, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3425/3646 (93.9386%)
___Train Local_ResNet_18,  epoch 163, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3396/3646 (93.1432%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.8335, Accuracy: 5801/10000 (58.0100%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4323/4634 (93.2887%)
___Train Local_ResNet_18,  epoch 163, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4314/4634 (93.0945%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9089, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4663/5055 (92.2453%)
___Train Local_ResNet_18,  epoch 163, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4640/5055 (91.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9419, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4165/4362 (95.4837%)
___Train Local_ResNet_18,  epoch 163, local model 90, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3981/4362 (91.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2319, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4565/4934 (92.5213%)
___Train Local_ResNet_18,  epoch 163, local model 88, internal_epoch   2,  Average loss: 0.0103, Accuracy: 3989/4934 (80.8472%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.6934, Accuracy: 4479/10000 (44.7900%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4404/4767 (92.3851%)
___Train Local_ResNet_18,  epoch 163, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4291/4767 (90.0147%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.2620, Accuracy: 5265/10000 (52.6500%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4190/4433 (94.5184%)
___Train Local_ResNet_18,  epoch 163, local model 33, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4118/4433 (92.8942%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9029, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4523/4928 (91.7817%)
___Train Local_ResNet_18,  epoch 163, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4482/4928 (90.9497%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 2.0656, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3625/3837 (94.4749%)
___Train Local_ResNet_18,  epoch 163, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3633/3837 (94.6833%)
___Test Local_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.9001, Accuracy: 5736/10000 (57.3600%)
time spent on training: 261.4204041957855
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 163: Average loss: 1.3817, Accuracy: 6558/10000 (65.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 163: Average loss: 0.0414, Accuracy: 9792/9900 (98.9091%)
Done in 288.5224678516388 sec.
Server Epoch:164 choose agents : [13, 36, 58, 71, 1, 72, 20, 87, 57, 98, 96, 46, 55, 6, 69, 9, 10, 92, 62, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4758/4885 (97.4002%), train_poison_data_count: 385
Global model norm: 44.39965066858283.
Norm before scaling: 44.36344479833594. Distance: 1.2083493538594685
Total norm for 4 adversaries is: 44.36344479833594. distance: 1.2083493538594685
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0392, Accuracy: 9802/9900 (99.0101%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.39965066858283.
Norm before scaling: 44.364667866251544. Distance: 1.3341045185905573
Total norm for 4 adversaries is: 44.364667866251544. distance: 1.3341045185905573
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0181, Accuracy: 9850/9900 (99.4949%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4579/4717 (97.0744%), train_poison_data_count: 370
Global model norm: 44.39965066858283.
Norm before scaling: 44.36639716345722. Distance: 1.1586759223015932
Total norm for 4 adversaries is: 44.36639716345722. distance: 1.1586759223015932
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0569, Accuracy: 9750/9900 (98.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4925/5066 (97.2167%), train_poison_data_count: 400
Global model norm: 44.39965066858283.
Norm before scaling: 44.364810945109554. Distance: 1.2564070532257394
Total norm for 4 adversaries is: 44.364810945109554. distance: 1.2564070532257394
___Test Local_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0272, Accuracy: 9831/9900 (99.3030%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4654/4986 (93.3414%)
___Train Local_ResNet_18,  epoch 164, local model 1, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4592/4986 (92.0979%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8840, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4391/4767 (92.1124%)
___Train Local_ResNet_18,  epoch 164, local model 72, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4335/4767 (90.9377%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0607, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4089/4315 (94.7625%)
___Train Local_ResNet_18,  epoch 164, local model 20, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4096/4315 (94.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.7534, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3417/3672 (93.0556%)
___Train Local_ResNet_18,  epoch 164, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3361/3672 (91.5305%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9523, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4280/4558 (93.9008%)
___Train Local_ResNet_18,  epoch 164, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4105/4558 (90.0614%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1504, Accuracy: 5427/10000 (54.2700%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3635/3828 (94.9582%)
___Train Local_ResNet_18,  epoch 164, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3586/3828 (93.6782%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.8141, Accuracy: 5901/10000 (59.0100%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4390/4679 (93.8235%)
___Train Local_ResNet_18,  epoch 164, local model 96, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4262/4679 (91.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2786, Accuracy: 5225/10000 (52.2500%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4575/4956 (92.3123%)
___Train Local_ResNet_18,  epoch 164, local model 46, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4477/4956 (90.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1487, Accuracy: 5335/10000 (53.3500%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4092/4356 (93.9394%)
___Train Local_ResNet_18,  epoch 164, local model 55, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3650/4356 (83.7925%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2784, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4269/4538 (94.0723%)
___Train Local_ResNet_18,  epoch 164, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4287/4538 (94.4689%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9757, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3739/4013 (93.1722%)
___Train Local_ResNet_18,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3770/4013 (93.9447%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9210, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4909/5265 (93.2384%)
___Train Local_ResNet_18,  epoch 164, local model 9, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4750/5265 (90.2184%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.0331, Accuracy: 5414/10000 (54.1400%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4421/4663 (94.8102%)
___Train Local_ResNet_18,  epoch 164, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4381/4663 (93.9524%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9815, Accuracy: 5543/10000 (55.4300%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5840/6263 (93.2460%)
___Train Local_ResNet_18,  epoch 164, local model 92, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5685/6263 (90.7712%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.2495, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4648/5063 (91.8033%)
___Train Local_ResNet_18,  epoch 164, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4304/5063 (85.0089%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 2.1980, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4072/4416 (92.2101%)
___Train Local_ResNet_18,  epoch 164, local model 74, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4074/4416 (92.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.9405, Accuracy: 5723/10000 (57.2300%)
time spent on training: 263.60258054733276
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 164: Average loss: 1.3878, Accuracy: 6561/10000 (65.6100%)
___Test Target_ResNet_18 poisoned: True, epoch: 164: Average loss: 0.0390, Accuracy: 9797/9900 (98.9596%)
Done in 290.74228286743164 sec.
Server Epoch:165 choose agents : [13, 36, 58, 71, 38, 93, 64, 72, 32, 99, 46, 4, 78, 12, 53, 75, 94, 84, 33, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4765/4885 (97.5435%), train_poison_data_count: 385
Global model norm: 44.4198881678438.
Norm before scaling: 44.38472467166702. Distance: 1.209091206454086
Total norm for 4 adversaries is: 44.38472467166702. distance: 1.209091206454086
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0438, Accuracy: 9778/9900 (98.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5160/5305 (97.2667%), train_poison_data_count: 415
Global model norm: 44.4198881678438.
Norm before scaling: 44.38378406677305. Distance: 1.3082893131326092
Total norm for 4 adversaries is: 44.38378406677305. distance: 1.3082893131326092
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0101, Accuracy: 9868/9900 (99.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4619/4717 (97.9224%), train_poison_data_count: 370
Global model norm: 44.4198881678438.
Norm before scaling: 44.38364654976749. Distance: 1.0847736406425077
Total norm for 4 adversaries is: 44.38364654976749. distance: 1.0847736406425077
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0645, Accuracy: 9729/9900 (98.2727%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 165, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4917/5066 (97.0588%), train_poison_data_count: 400
Global model norm: 44.4198881678438.
Norm before scaling: 44.385314602284275. Distance: 1.2789917560159594
Total norm for 4 adversaries is: 44.385314602284275. distance: 1.2789917560159594
___Test Local_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0340, Accuracy: 9824/9900 (99.2323%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5270/5740 (91.8118%)
___Train Local_ResNet_18,  epoch 165, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5167/5740 (90.0174%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3942, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4353/4651 (93.5928%)
___Train Local_ResNet_18,  epoch 165, local model 93, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4294/4651 (92.3242%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0021, Accuracy: 5664/10000 (56.6400%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4215/4503 (93.6043%)
___Train Local_ResNet_18,  epoch 165, local model 64, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4042/4503 (89.7624%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0711, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4421/4767 (92.7418%)
___Train Local_ResNet_18,  epoch 165, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4238/4767 (88.9029%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2823, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5183/5591 (92.7026%)
___Train Local_ResNet_18,  epoch 165, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4972/5591 (88.9286%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2346, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4204/4465 (94.1545%)
___Train Local_ResNet_18,  epoch 165, local model 99, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4225/4465 (94.6249%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.7438, Accuracy: 6043/10000 (60.4300%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4574/4956 (92.2922%)
___Train Local_ResNet_18,  epoch 165, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4429/4956 (89.3664%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.2787, Accuracy: 5207/10000 (52.0700%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3454/3704 (93.2505%)
___Train Local_ResNet_18,  epoch 165, local model 4, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3447/3704 (93.0616%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8595, Accuracy: 5851/10000 (58.5100%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3821/4025 (94.9317%)
___Train Local_ResNet_18,  epoch 165, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3782/4025 (93.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8140, Accuracy: 5839/10000 (58.3900%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4750/5083 (93.4488%)
___Train Local_ResNet_18,  epoch 165, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4603/5083 (90.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.0795, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5589/6124 (91.2639%)
___Train Local_ResNet_18,  epoch 165, local model 53, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5441/6124 (88.8472%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9680, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4061/4295 (94.5518%)
___Train Local_ResNet_18,  epoch 165, local model 75, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3903/4295 (90.8731%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9494, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4444/4804 (92.5062%)
___Train Local_ResNet_18,  epoch 165, local model 94, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4099/4804 (85.3247%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3504, Accuracy: 5021/10000 (50.2100%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4544/4793 (94.8049%)
___Train Local_ResNet_18,  epoch 165, local model 84, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4492/4793 (93.7200%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.9850, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4200/4433 (94.7440%)
___Train Local_ResNet_18,  epoch 165, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4144/4433 (93.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.8213, Accuracy: 5886/10000 (58.8600%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4082/4361 (93.6024%)
___Train Local_ResNet_18,  epoch 165, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3839/4361 (88.0303%)
___Test Local_ResNet_18 poisoned: False, epoch: 165: Average loss: 2.3610, Accuracy: 5077/10000 (50.7700%)
time spent on training: 264.55961894989014
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 165: Average loss: 1.3882, Accuracy: 6559/10000 (65.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 165: Average loss: 0.0406, Accuracy: 9795/9900 (98.9394%)
Done in 292.0512204170227 sec.
Server Epoch:166 choose agents : [13, 36, 58, 71, 57, 5, 82, 91, 40, 29, 96, 74, 98, 27, 9, 53, 97, 46, 38, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4789/4885 (98.0348%), train_poison_data_count: 385
Global model norm: 44.440621868627275.
Norm before scaling: 44.40245904384829. Distance: 1.1207893835666334
Total norm for 4 adversaries is: 44.40245904384829. distance: 1.1207893835666334
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0487, Accuracy: 9778/9900 (98.7677%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5140/5305 (96.8897%), train_poison_data_count: 415
Global model norm: 44.440621868627275.
Norm before scaling: 44.40466108170684. Distance: 1.3238343887878792
Total norm for 4 adversaries is: 44.40466108170684. distance: 1.3238343887878792
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0380, Accuracy: 9805/9900 (99.0404%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4610/4717 (97.7316%), train_poison_data_count: 370
Global model norm: 44.440621868627275.
Norm before scaling: 44.40458548296631. Distance: 1.1116846246903611
Total norm for 4 adversaries is: 44.40458548296631. distance: 1.1116846246903611
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0440, Accuracy: 9782/9900 (98.8081%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 166, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4936/5066 (97.4339%), train_poison_data_count: 400
Global model norm: 44.440621868627275.
Norm before scaling: 44.40555863510009. Distance: 1.2575692362144464
Total norm for 4 adversaries is: 44.40555863510009. distance: 1.2575692362144464
___Test Local_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0550, Accuracy: 9759/9900 (98.5758%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4240/4558 (93.0233%)
___Train Local_ResNet_18,  epoch 166, local model 57, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4153/4558 (91.1145%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1357, Accuracy: 5382/10000 (53.8200%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4354/4596 (94.7346%)
___Train Local_ResNet_18,  epoch 166, local model 5, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4302/4596 (93.6031%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0022, Accuracy: 5616/10000 (56.1600%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4491/4874 (92.1420%)
___Train Local_ResNet_18,  epoch 166, local model 82, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4166/4874 (85.4739%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.4616, Accuracy: 4929/10000 (49.2900%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3837/4158 (92.2799%)
___Train Local_ResNet_18,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3753/4158 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0327, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5101/5455 (93.5105%)
___Train Local_ResNet_18,  epoch 166, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4910/5455 (90.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2464, Accuracy: 5161/10000 (51.6100%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4138/4346 (95.2140%)
___Train Local_ResNet_18,  epoch 166, local model 29, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4100/4346 (94.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8114, Accuracy: 5895/10000 (58.9500%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4397/4679 (93.9731%)
___Train Local_ResNet_18,  epoch 166, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4102/4679 (87.6683%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1713, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4077/4416 (92.3234%)
___Train Local_ResNet_18,  epoch 166, local model 74, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4057/4416 (91.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9983, Accuracy: 5586/10000 (55.8600%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3625/3828 (94.6970%)
___Train Local_ResNet_18,  epoch 166, local model 98, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3612/3828 (94.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.9055, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3960/4223 (93.7722%)
___Train Local_ResNet_18,  epoch 166, local model 27, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3953/4223 (93.6064%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8772, Accuracy: 5831/10000 (58.3100%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4908/5265 (93.2194%)
___Train Local_ResNet_18,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4725/5265 (89.7436%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.1507, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5664/6124 (92.4886%)
___Train Local_ResNet_18,  epoch 166, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5497/6124 (89.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0178, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4049/4361 (92.8457%)
___Train Local_ResNet_18,  epoch 166, local model 97, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3960/4361 (90.8049%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.0114, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4592/4956 (92.6554%)
___Train Local_ResNet_18,  epoch 166, local model 46, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4413/4956 (89.0436%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.3922, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5355/5740 (93.2927%)
___Train Local_ResNet_18,  epoch 166, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5178/5740 (90.2091%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 2.2588, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3760/4013 (93.6955%)
___Train Local_ResNet_18,  epoch 166, local model 69, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3769/4013 (93.9198%)
___Test Local_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.8118, Accuracy: 5843/10000 (58.4300%)
time spent on training: 261.35715794563293
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 166: Average loss: 1.3994, Accuracy: 6536/10000 (65.3600%)
___Test Target_ResNet_18 poisoned: True, epoch: 166: Average loss: 0.0408, Accuracy: 9798/9900 (98.9697%)
Done in 288.34298062324524 sec.
Server Epoch:167 choose agents : [13, 36, 58, 71, 23, 63, 91, 78, 59, 80, 62, 89, 93, 55, 43, 66, 68, 94, 24, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4792/4885 (98.0962%), train_poison_data_count: 385
Global model norm: 44.46086954725962.
Norm before scaling: 44.422349023587635. Distance: 1.1024748899234313
Total norm for 4 adversaries is: 44.422349023587635. distance: 1.1024748899234313
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0666, Accuracy: 9727/9900 (98.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5196/5305 (97.9453%), train_poison_data_count: 415
Global model norm: 44.46086954725962.
Norm before scaling: 44.420428166290364. Distance: 1.1960007425197479
Total norm for 4 adversaries is: 44.420428166290364. distance: 1.1960007425197479
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0305, Accuracy: 9827/9900 (99.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 58, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4582/4717 (97.1380%), train_poison_data_count: 370
Global model norm: 44.46086954725962.
Norm before scaling: 44.426288032643185. Distance: 1.1758379748275567
Total norm for 4 adversaries is: 44.426288032643185. distance: 1.1758379748275567
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0702, Accuracy: 9719/9900 (98.1717%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 167, local model 71, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4932/5066 (97.3549%), train_poison_data_count: 400
Global model norm: 44.46086954725962.
Norm before scaling: 44.42590060461634. Distance: 1.2545022944174349
Total norm for 4 adversaries is: 44.42590060461634. distance: 1.2545022944174349
___Test Local_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0655, Accuracy: 9736/9900 (98.3434%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3910/4184 (93.4512%)
___Train Local_ResNet_18,  epoch 167, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3832/4184 (91.5870%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8929, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3399/3590 (94.6797%)
___Train Local_ResNet_18,  epoch 167, local model 63, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3222/3590 (89.7493%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0980, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3777/4158 (90.8369%)
___Train Local_ResNet_18,  epoch 167, local model 91, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3747/4158 (90.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0207, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3764/4025 (93.5155%)
___Train Local_ResNet_18,  epoch 167, local model 78, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3810/4025 (94.6584%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8853, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3787/4046 (93.5986%)
___Train Local_ResNet_18,  epoch 167, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3812/4046 (94.2165%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.8484, Accuracy: 5859/10000 (58.5900%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4663/5025 (92.7960%)
___Train Local_ResNet_18,  epoch 167, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4576/5025 (91.0647%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1651, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4695/5063 (92.7316%)
___Train Local_ResNet_18,  epoch 167, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4482/5063 (88.5246%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2061, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4052/4356 (93.0211%)
___Train Local_ResNet_18,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3764/4356 (86.4096%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3241, Accuracy: 4885/10000 (48.8500%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4368/4651 (93.9153%)
___Train Local_ResNet_18,  epoch 167, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4252/4651 (91.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.0354, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4141/4356 (95.0643%)
___Train Local_ResNet_18,  epoch 167, local model 55, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3869/4356 (88.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.3463, Accuracy: 5070/10000 (50.7000%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4257/4576 (93.0288%)
___Train Local_ResNet_18,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4253/4576 (92.9414%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1787, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4188/4456 (93.9856%)
___Train Local_ResNet_18,  epoch 167, local model 66, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4134/4456 (92.7738%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.9367, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3144/3297 (95.3594%)
___Train Local_ResNet_18,  epoch 167, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3104/3297 (94.1462%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.6587, Accuracy: 6108/10000 (61.0800%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4498/4804 (93.6303%)
___Train Local_ResNet_18,  epoch 167, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4302/4804 (89.5504%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.2760, Accuracy: 5099/10000 (50.9900%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3758/3969 (94.6838%)
___Train Local_ResNet_18,  epoch 167, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3672/3969 (92.5170%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.7935, Accuracy: 5990/10000 (59.9000%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4847/5195 (93.3013%)
___Train Local_ResNet_18,  epoch 167, local model 54, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4667/5195 (89.8364%)
___Test Local_ResNet_18 poisoned: False, epoch: 167: Average loss: 2.1253, Accuracy: 5315/10000 (53.1500%)
time spent on training: 256.63640093803406
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 167: Average loss: 1.3986, Accuracy: 6529/10000 (65.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 167: Average loss: 0.0457, Accuracy: 9778/9900 (98.7677%)
Done in 283.45252871513367 sec.
Server Epoch:168 choose agents : [13, 36, 58, 71, 39, 15, 40, 96, 34, 81, 28, 11, 82, 19, 61, 98, 30, 76, 63, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.47918420057226.
Norm before scaling: 44.44134702273675. Distance: 1.1374089089275625
Total norm for 4 adversaries is: 44.44134702273675. distance: 1.1374089089275625
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0403, Accuracy: 9796/9900 (98.9495%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5182/5305 (97.6814%), train_poison_data_count: 415
Global model norm: 44.47918420057226.
Norm before scaling: 44.441002301330634. Distance: 1.2557406213597355
Total norm for 4 adversaries is: 44.441002301330634. distance: 1.2557406213597355
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0880, Accuracy: 9670/9900 (97.6768%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.47918420057226.
Norm before scaling: 44.44368309216592. Distance: 1.136839922447182
Total norm for 4 adversaries is: 44.44368309216592. distance: 1.136839922447182
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0217, Accuracy: 9846/9900 (99.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 168, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4947/5066 (97.6510%), train_poison_data_count: 400
Global model norm: 44.47918420057226.
Norm before scaling: 44.443996206778316. Distance: 1.2481496944668409
Total norm for 4 adversaries is: 44.443996206778316. distance: 1.2481496944668409
___Test Local_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0291, Accuracy: 9830/9900 (99.2929%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3654/3837 (95.2306%)
___Train Local_ResNet_18,  epoch 168, local model 39, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3660/3837 (95.3870%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8043, Accuracy: 5913/10000 (59.1300%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5282/5582 (94.6256%)
___Train Local_ResNet_18,  epoch 168, local model 15, internal_epoch   2,  Average loss: 0.0040, Accuracy: 5159/5582 (92.4221%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1528, Accuracy: 5263/10000 (52.6300%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5110/5455 (93.6755%)
___Train Local_ResNet_18,  epoch 168, local model 40, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4926/5455 (90.3025%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1002, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4397/4679 (93.9731%)
___Train Local_ResNet_18,  epoch 168, local model 96, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4356/4679 (93.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9188, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4229/4518 (93.6034%)
___Train Local_ResNet_18,  epoch 168, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4226/4518 (93.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9933, Accuracy: 5661/10000 (56.6100%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4370/4618 (94.6297%)
___Train Local_ResNet_18,  epoch 168, local model 81, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4329/4618 (93.7419%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8427, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4319/4716 (91.5818%)
___Train Local_ResNet_18,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4218/4716 (89.4402%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.1471, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4763/5244 (90.8276%)
___Train Local_ResNet_18,  epoch 168, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4664/5244 (88.9397%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0422, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4574/4874 (93.8449%)
___Train Local_ResNet_18,  epoch 168, local model 82, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4331/4874 (88.8593%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2790, Accuracy: 5134/10000 (51.3400%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4578/4928 (92.8977%)
___Train Local_ResNet_18,  epoch 168, local model 19, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4473/4928 (90.7670%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.0323, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3911/4126 (94.7891%)
___Train Local_ResNet_18,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3886/4126 (94.1832%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7771, Accuracy: 5981/10000 (59.8100%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3645/3828 (95.2194%)
___Train Local_ResNet_18,  epoch 168, local model 98, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3606/3828 (94.2006%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.7716, Accuracy: 5955/10000 (59.5500%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3270/3472 (94.1820%)
___Train Local_ResNet_18,  epoch 168, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3239/3472 (93.2892%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9869, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3413/3638 (93.8153%)
___Train Local_ResNet_18,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3357/3638 (92.2760%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.8589, Accuracy: 5711/10000 (57.1100%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3382/3590 (94.2061%)
___Train Local_ResNet_18,  epoch 168, local model 63, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3058/3590 (85.1811%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 2.2059, Accuracy: 5236/10000 (52.3600%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3971/4223 (94.0327%)
___Train Local_ResNet_18,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3936/4223 (93.2039%)
___Test Local_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.9774, Accuracy: 5662/10000 (56.6200%)
time spent on training: 261.3338391780853
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 168: Average loss: 1.4031, Accuracy: 6513/10000 (65.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 168: Average loss: 0.0448, Accuracy: 9782/9900 (98.8081%)
Done in 287.7715356349945 sec.
Server Epoch:169 choose agents : [13, 36, 58, 71, 48, 0, 3, 49, 55, 40, 68, 54, 98, 66, 97, 73, 80, 2, 91, 6].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4798/4885 (98.2190%), train_poison_data_count: 385
Global model norm: 44.496410439407214.
Norm before scaling: 44.45860851504183. Distance: 1.1180736521855015
Total norm for 4 adversaries is: 44.45860851504183. distance: 1.1180736521855015
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0663, Accuracy: 9728/9900 (98.2626%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5305 (97.4175%), train_poison_data_count: 415
Global model norm: 44.496410439407214.
Norm before scaling: 44.45821725007299. Distance: 1.2416058024054553
Total norm for 4 adversaries is: 44.45821725007299. distance: 1.2416058024054553
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0835, Accuracy: 9703/9900 (98.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4596/4717 (97.4348%), train_poison_data_count: 370
Global model norm: 44.496410439407214.
Norm before scaling: 44.4619306963834. Distance: 1.151499086287712
Total norm for 4 adversaries is: 44.4619306963834. distance: 1.151499086287712
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0198, Accuracy: 9852/9900 (99.5152%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 169, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4935/5066 (97.4141%), train_poison_data_count: 400
Global model norm: 44.496410439407214.
Norm before scaling: 44.46233428332204. Distance: 1.3048308973258373
Total norm for 4 adversaries is: 44.46233428332204. distance: 1.3048308973258373
___Test Local_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0199, Accuracy: 9855/9900 (99.5455%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4226/4441 (95.1587%)
___Train Local_ResNet_18,  epoch 169, local model 48, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4180/4441 (94.1229%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8654, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4727/5017 (94.2197%)
___Train Local_ResNet_18,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4616/5017 (92.0072%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8126, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4641/4918 (94.3676%)
___Train Local_ResNet_18,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4555/4918 (92.6190%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1828, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4884/5197 (93.9773%)
___Train Local_ResNet_18,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4663/5197 (89.7248%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3131, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4111/4356 (94.3756%)
___Train Local_ResNet_18,  epoch 169, local model 55, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3821/4356 (87.7181%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3598, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5113/5455 (93.7305%)
___Train Local_ResNet_18,  epoch 169, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5016/5455 (91.9523%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1109, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3129/3297 (94.9045%)
___Train Local_ResNet_18,  epoch 169, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3136/3297 (95.1168%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7278, Accuracy: 6029/10000 (60.2900%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4842/5195 (93.2050%)
___Train Local_ResNet_18,  epoch 169, local model 54, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4631/5195 (89.1434%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1494, Accuracy: 5264/10000 (52.6400%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3608/3828 (94.2529%)
___Train Local_ResNet_18,  epoch 169, local model 98, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3644/3828 (95.1933%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8668, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4251/4456 (95.3995%)
___Train Local_ResNet_18,  epoch 169, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4190/4456 (94.0305%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.8062, Accuracy: 5982/10000 (59.8200%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4093/4361 (93.8546%)
___Train Local_ResNet_18,  epoch 169, local model 97, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3944/4361 (90.4380%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.9947, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4004/4235 (94.5455%)
___Train Local_ResNet_18,  epoch 169, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3823/4235 (90.2715%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.3827, Accuracy: 5150/10000 (51.5000%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4686/5025 (93.2537%)
___Train Local_ResNet_18,  epoch 169, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4645/5025 (92.4378%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.0093, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3430/3646 (94.0757%)
___Train Local_ResNet_18,  epoch 169, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3409/3646 (93.4997%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.6752, Accuracy: 6124/10000 (61.2400%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3827/4158 (92.0394%)
___Train Local_ResNet_18,  epoch 169, local model 91, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3700/4158 (88.9851%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 2.1290, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4302/4538 (94.7995%)
___Train Local_ResNet_18,  epoch 169, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 4304/4538 (94.8435%)
___Test Local_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.7885, Accuracy: 5964/10000 (59.6400%)
time spent on training: 233.29187059402466
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 169: Average loss: 1.4066, Accuracy: 6513/10000 (65.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 169: Average loss: 0.0405, Accuracy: 9795/9900 (98.9394%)
Done in 256.6134932041168 sec.
Server Epoch:170 choose agents : [13, 36, 58, 71, 75, 15, 87, 34, 52, 90, 94, 67, 80, 68, 4, 42, 14, 82, 77, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 44.514451327104155.
Norm before scaling: 44.47674981846203. Distance: 1.122124653190125
Total norm for 4 adversaries is: 44.47674981846203. distance: 1.122124653190125
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0710, Accuracy: 9729/9900 (98.2727%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5171/5305 (97.4741%), train_poison_data_count: 415
Global model norm: 44.514451327104155.
Norm before scaling: 44.47587840353044. Distance: 1.2784773436542802
Total norm for 4 adversaries is: 44.47587840353044. distance: 1.2784773436542802
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0200, Accuracy: 9852/9900 (99.5152%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4604/4717 (97.6044%), train_poison_data_count: 370
Global model norm: 44.514451327104155.
Norm before scaling: 44.4778174500187. Distance: 1.1090918703508545
Total norm for 4 adversaries is: 44.4778174500187. distance: 1.1090918703508545
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0323, Accuracy: 9816/9900 (99.1515%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 170, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4940/5066 (97.5128%), train_poison_data_count: 400
Global model norm: 44.514451327104155.
Norm before scaling: 44.47758690964121. Distance: 1.2123363659743593
Total norm for 4 adversaries is: 44.47758690964121. distance: 1.2123363659743593
___Test Local_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0272, Accuracy: 9828/9900 (99.2727%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4070/4295 (94.7614%)
___Train Local_ResNet_18,  epoch 170, local model 75, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3891/4295 (90.5937%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2261, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5255/5582 (94.1419%)
___Train Local_ResNet_18,  epoch 170, local model 15, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5148/5582 (92.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2880, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3447/3672 (93.8725%)
___Train Local_ResNet_18,  epoch 170, local model 87, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3440/3672 (93.6819%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9580, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4250/4518 (94.0682%)
___Train Local_ResNet_18,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4143/4518 (91.6999%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0288, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3592/3797 (94.6010%)
___Train Local_ResNet_18,  epoch 170, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3538/3797 (93.1788%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9717, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4155/4362 (95.2545%)
___Train Local_ResNet_18,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4025/4362 (92.2742%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.0463, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4477/4804 (93.1932%)
___Train Local_ResNet_18,  epoch 170, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4328/4804 (90.0916%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.5348, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4803/5116 (93.8819%)
___Train Local_ResNet_18,  epoch 170, local model 67, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4702/5116 (91.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8604, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4673/5025 (92.9950%)
___Train Local_ResNet_18,  epoch 170, local model 80, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4636/5025 (92.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2284, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3130/3297 (94.9348%)
___Train Local_ResNet_18,  epoch 170, local model 68, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3127/3297 (94.8438%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.7232, Accuracy: 6089/10000 (60.8900%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3436/3704 (92.7646%)
___Train Local_ResNet_18,  epoch 170, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3491/3704 (94.2495%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8343, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5086/5424 (93.7684%)
___Train Local_ResNet_18,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4981/5424 (91.8326%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3749, Accuracy: 5063/10000 (50.6300%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3644/3861 (94.3797%)
___Train Local_ResNet_18,  epoch 170, local model 14, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3578/3861 (92.6703%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.8935, Accuracy: 5690/10000 (56.9000%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4559/4874 (93.5371%)
___Train Local_ResNet_18,  epoch 170, local model 82, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4356/4874 (89.3722%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.3829, Accuracy: 5177/10000 (51.7700%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4343/4647 (93.4581%)
___Train Local_ResNet_18,  epoch 170, local model 77, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4325/4647 (93.0708%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.9073, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4121/4356 (94.6051%)
___Train Local_ResNet_18,  epoch 170, local model 89, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3954/4356 (90.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 170: Average loss: 2.2358, Accuracy: 5259/10000 (52.5900%)
time spent on training: 230.47015976905823
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 18 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 16 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 170: Average loss: 1.4212, Accuracy: 6462/10000 (64.6200%)
___Test Target_ResNet_18 poisoned: True, epoch: 170: Average loss: 0.0358, Accuracy: 9804/9900 (99.0303%)
Done in 253.59395742416382 sec.
Server Epoch:171 choose agents : [13, 36, 58, 71, 64, 14, 23, 34, 12, 94, 89, 11, 96, 74, 3, 86, 43, 16, 69, 41].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4772/4885 (97.6868%), train_poison_data_count: 385
Global model norm: 44.53131030697671.
Norm before scaling: 44.494649158195834. Distance: 1.183747888984127
Total norm for 4 adversaries is: 44.494649158195834. distance: 1.183747888984127
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.1059, Accuracy: 9613/9900 (97.1010%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5137/5305 (96.8332%), train_poison_data_count: 415
Global model norm: 44.53131030697671.
Norm before scaling: 44.495710873440515. Distance: 1.3510633219343955
Total norm for 4 adversaries is: 44.495710873440515. distance: 1.3510633219343955
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0183, Accuracy: 9856/9900 (99.5556%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.53131030697671.
Norm before scaling: 44.49531033268071. Distance: 1.136981737055591
Total norm for 4 adversaries is: 44.49531033268071. distance: 1.136981737055591
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0402, Accuracy: 9793/9900 (98.9192%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4947/5066 (97.6510%), train_poison_data_count: 400
Global model norm: 44.53131030697671.
Norm before scaling: 44.49617039350128. Distance: 1.2384459088232782
Total norm for 4 adversaries is: 44.49617039350128. distance: 1.2384459088232782
___Test Local_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0728, Accuracy: 9716/9900 (98.1414%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4186/4503 (92.9602%)
___Train Local_ResNet_18,  epoch 171, local model 64, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4098/4503 (91.0060%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9703, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3634/3861 (94.1207%)
___Train Local_ResNet_18,  epoch 171, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3619/3861 (93.7322%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8524, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3957/4184 (94.5746%)
___Train Local_ResNet_18,  epoch 171, local model 23, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3937/4184 (94.0966%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.7489, Accuracy: 5948/10000 (59.4800%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4262/4518 (94.3338%)
___Train Local_ResNet_18,  epoch 171, local model 34, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4218/4518 (93.3599%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0080, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4756/5083 (93.5668%)
___Train Local_ResNet_18,  epoch 171, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4506/5083 (88.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1717, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4481/4804 (93.2764%)
___Train Local_ResNet_18,  epoch 171, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4062/4804 (84.5545%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.3904, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4076/4356 (93.5721%)
___Train Local_ResNet_18,  epoch 171, local model 89, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4010/4356 (92.0569%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9962, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4759/5244 (90.7513%)
___Train Local_ResNet_18,  epoch 171, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4601/5244 (87.7384%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.2542, Accuracy: 5076/10000 (50.7600%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4425/4679 (94.5715%)
___Train Local_ResNet_18,  epoch 171, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4143/4679 (88.5446%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.4202, Accuracy: 4967/10000 (49.6700%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4133/4416 (93.5915%)
___Train Local_ResNet_18,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4102/4416 (92.8895%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9183, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4667/4918 (94.8963%)
___Train Local_ResNet_18,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4573/4918 (92.9850%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.1031, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3395/3616 (93.8883%)
___Train Local_ResNet_18,  epoch 171, local model 86, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3373/3616 (93.2799%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9972, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4298/4576 (93.9248%)
___Train Local_ResNet_18,  epoch 171, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4219/4576 (92.1984%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9095, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4611/4928 (93.5674%)
___Train Local_ResNet_18,  epoch 171, local model 16, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4537/4928 (92.0657%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.9915, Accuracy: 5665/10000 (56.6500%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3808/4013 (94.8916%)
___Train Local_ResNet_18,  epoch 171, local model 69, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3798/4013 (94.6424%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.8024, Accuracy: 5873/10000 (58.7300%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4079/4336 (94.0729%)
___Train Local_ResNet_18,  epoch 171, local model 41, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4000/4336 (92.2509%)
___Test Local_ResNet_18 poisoned: False, epoch: 171: Average loss: 2.0621, Accuracy: 5492/10000 (54.9200%)
time spent on training: 242.5981640815735
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 16 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 171: Average loss: 1.4247, Accuracy: 6467/10000 (64.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 171: Average loss: 0.0373, Accuracy: 9800/9900 (98.9899%)
Done in 266.6142227649689 sec.
Server Epoch:172 choose agents : [13, 36, 58, 71, 92, 30, 91, 76, 82, 55, 6, 16, 81, 47, 96, 77, 43, 59, 93, 65].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4780/4885 (97.8506%), train_poison_data_count: 385
Global model norm: 44.54933569142053.
Norm before scaling: 44.51156774464294. Distance: 1.165537571632438
Total norm for 4 adversaries is: 44.51156774464294. distance: 1.165537571632438
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0458, Accuracy: 9781/9900 (98.7980%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5162/5305 (97.3044%), train_poison_data_count: 415
Global model norm: 44.54933569142053.
Norm before scaling: 44.51140045547671. Distance: 1.2932767933271787
Total norm for 4 adversaries is: 44.51140045547671. distance: 1.2932767933271787
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0382, Accuracy: 9806/9900 (99.0505%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4592/4717 (97.3500%), train_poison_data_count: 370
Global model norm: 44.54933569142053.
Norm before scaling: 44.513368120220356. Distance: 1.1424196834421885
Total norm for 4 adversaries is: 44.513368120220356. distance: 1.1424196834421885
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0686, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 172, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4927/5066 (97.2562%), train_poison_data_count: 400
Global model norm: 44.54933569142053.
Norm before scaling: 44.5134983806703. Distance: 1.2611090542211203
Total norm for 4 adversaries is: 44.5134983806703. distance: 1.2611090542211203
___Test Local_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0449, Accuracy: 9788/9900 (98.8687%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5874/6263 (93.7889%)
___Train Local_ResNet_18,  epoch 172, local model 92, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5827/6263 (93.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1739, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3295/3472 (94.9021%)
___Train Local_ResNet_18,  epoch 172, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3241/3472 (93.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9194, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3817/4158 (91.7989%)
___Train Local_ResNet_18,  epoch 172, local model 91, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3770/4158 (90.6686%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8588, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3375/3638 (92.7708%)
___Train Local_ResNet_18,  epoch 172, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3377/3638 (92.8257%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.7603, Accuracy: 5816/10000 (58.1600%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4513/4874 (92.5934%)
___Train Local_ResNet_18,  epoch 172, local model 82, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4481/4874 (91.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1618, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4140/4356 (95.0413%)
___Train Local_ResNet_18,  epoch 172, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3813/4356 (87.5344%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.3316, Accuracy: 5097/10000 (50.9700%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4317/4538 (95.1300%)
___Train Local_ResNet_18,  epoch 172, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4293/4538 (94.6011%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8015, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4602/4928 (93.3847%)
___Train Local_ResNet_18,  epoch 172, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4483/4928 (90.9700%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9850, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4387/4618 (94.9978%)
___Train Local_ResNet_18,  epoch 172, local model 81, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4315/4618 (93.4387%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9131, Accuracy: 5775/10000 (57.7500%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4418/4707 (93.8602%)
___Train Local_ResNet_18,  epoch 172, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4327/4707 (91.9269%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.8610, Accuracy: 5780/10000 (57.8000%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4456/4679 (95.2340%)
___Train Local_ResNet_18,  epoch 172, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4073/4679 (87.0485%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.2465, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4355/4647 (93.7164%)
___Train Local_ResNet_18,  epoch 172, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4240/4647 (91.2417%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0764, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4318/4576 (94.3619%)
___Train Local_ResNet_18,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4224/4576 (92.3077%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.9599, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3827/4046 (94.5872%)
___Train Local_ResNet_18,  epoch 172, local model 59, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3712/4046 (91.7449%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0512, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4387/4651 (94.3238%)
___Train Local_ResNet_18,  epoch 172, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4266/4651 (91.7222%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.0246, Accuracy: 5540/10000 (55.4000%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4681/5055 (92.6014%)
___Train Local_ResNet_18,  epoch 172, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4612/5055 (91.2364%)
___Test Local_ResNet_18 poisoned: False, epoch: 172: Average loss: 2.1447, Accuracy: 5397/10000 (53.9700%)
time spent on training: 235.97520995140076
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 172: Average loss: 1.4274, Accuracy: 6464/10000 (64.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 172: Average loss: 0.0374, Accuracy: 9801/9900 (99.0000%)
Done in 259.25819301605225 sec.
Server Epoch:173 choose agents : [13, 36, 58, 71, 38, 31, 3, 73, 40, 44, 99, 93, 81, 45, 37, 48, 6, 67, 53, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.568091941835895.
Norm before scaling: 44.52959152613434. Distance: 1.1446198308731543
Total norm for 4 adversaries is: 44.52959152613434. distance: 1.1446198308731543
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0542, Accuracy: 9767/9900 (98.6566%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5156/5305 (97.1913%), train_poison_data_count: 415
Global model norm: 44.568091941835895.
Norm before scaling: 44.53141447338047. Distance: 1.298418161039327
Total norm for 4 adversaries is: 44.53141447338047. distance: 1.298418161039327
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0295, Accuracy: 9818/9900 (99.1717%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.568091941835895.
Norm before scaling: 44.53235196004979. Distance: 1.1571917951165742
Total norm for 4 adversaries is: 44.53235196004979. distance: 1.1571917951165742
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0624, Accuracy: 9740/9900 (98.3838%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 173, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4923/5066 (97.1773%), train_poison_data_count: 400
Global model norm: 44.568091941835895.
Norm before scaling: 44.53297008739354. Distance: 1.2742836604141505
Total norm for 4 adversaries is: 44.53297008739354. distance: 1.2742836604141505
___Test Local_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0141, Accuracy: 9864/9900 (99.6364%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5304/5740 (92.4042%)
___Train Local_ResNet_18,  epoch 173, local model 38, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5273/5740 (91.8641%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.3571, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3908/4175 (93.6048%)
___Train Local_ResNet_18,  epoch 173, local model 31, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3821/4175 (91.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0253, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4653/4918 (94.6116%)
___Train Local_ResNet_18,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4603/4918 (93.5950%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8991, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4015/4235 (94.8052%)
___Train Local_ResNet_18,  epoch 173, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4009/4235 (94.6635%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9099, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5137/5455 (94.1705%)
___Train Local_ResNet_18,  epoch 173, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4995/5455 (91.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9698, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4365/4662 (93.6293%)
___Train Local_ResNet_18,  epoch 173, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4325/4662 (92.7713%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9628, Accuracy: 5650/10000 (56.5000%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4215/4465 (94.4009%)
___Train Local_ResNet_18,  epoch 173, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4185/4465 (93.7290%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.8937, Accuracy: 5702/10000 (57.0200%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4396/4651 (94.5173%)
___Train Local_ResNet_18,  epoch 173, local model 93, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4292/4651 (92.2812%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0425, Accuracy: 5556/10000 (55.5600%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4380/4618 (94.8463%)
___Train Local_ResNet_18,  epoch 173, local model 81, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4146/4618 (89.7791%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.0993, Accuracy: 5463/10000 (54.6300%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4664/5037 (92.5948%)
___Train Local_ResNet_18,  epoch 173, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4608/5037 (91.4830%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1278, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4079/4354 (93.6840%)
___Train Local_ResNet_18,  epoch 173, local model 37, internal_epoch   2,  Average loss: 0.0094, Accuracy: 3617/4354 (83.0730%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.7231, Accuracy: 4598/10000 (45.9800%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4218/4441 (94.9786%)
___Train Local_ResNet_18,  epoch 173, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4120/4441 (92.7719%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1029, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4301/4538 (94.7774%)
___Train Local_ResNet_18,  epoch 173, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4276/4538 (94.2265%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.9505, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4845/5116 (94.7029%)
___Train Local_ResNet_18,  epoch 173, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4715/5116 (92.1618%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1107, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5660/6124 (92.4233%)
___Train Local_ResNet_18,  epoch 173, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5497/6124 (89.7616%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.4328, Accuracy: 4922/10000 (49.2200%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4160/4362 (95.3691%)
___Train Local_ResNet_18,  epoch 173, local model 90, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4049/4362 (92.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 173: Average loss: 2.1372, Accuracy: 5358/10000 (53.5800%)
time spent on training: 245.70431447029114
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 13 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 173: Average loss: 1.4336, Accuracy: 6459/10000 (64.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 173: Average loss: 0.0356, Accuracy: 9803/9900 (99.0202%)
Done in 272.4408583641052 sec.
Server Epoch:174 choose agents : [13, 36, 58, 71, 97, 52, 3, 76, 63, 1, 70, 60, 80, 84, 46, 67, 65, 62, 33, 44].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.5870497440996.
Norm before scaling: 44.54721068139045. Distance: 1.1233684576940655
Total norm for 4 adversaries is: 44.54721068139045. distance: 1.1233684576940655
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0236, Accuracy: 9847/9900 (99.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5183/5305 (97.7003%), train_poison_data_count: 415
Global model norm: 44.5870497440996.
Norm before scaling: 44.54775735709796. Distance: 1.2425339893320366
Total norm for 4 adversaries is: 44.54775735709796. distance: 1.2425339893320366
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0313, Accuracy: 9812/9900 (99.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4583/4717 (97.1592%), train_poison_data_count: 370
Global model norm: 44.5870497440996.
Norm before scaling: 44.550455014423676. Distance: 1.1336289193332434
Total norm for 4 adversaries is: 44.550455014423676. distance: 1.1336289193332434
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0752, Accuracy: 9723/9900 (98.2121%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 174, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4954/5066 (97.7892%), train_poison_data_count: 400
Global model norm: 44.5870497440996.
Norm before scaling: 44.54871779115464. Distance: 1.1744201487439478
Total norm for 4 adversaries is: 44.54871779115464. distance: 1.1744201487439478
___Test Local_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0452, Accuracy: 9781/9900 (98.7980%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4079/4361 (93.5336%)
___Train Local_ResNet_18,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3911/4361 (89.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1426, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3600/3797 (94.8117%)
___Train Local_ResNet_18,  epoch 174, local model 52, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3575/3797 (94.1533%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9428, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4635/4918 (94.2456%)
___Train Local_ResNet_18,  epoch 174, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4597/4918 (93.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1687, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3381/3638 (92.9357%)
___Train Local_ResNet_18,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3378/3638 (92.8532%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.8784, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3422/3590 (95.3203%)
___Train Local_ResNet_18,  epoch 174, local model 63, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3278/3590 (91.3092%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1463, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4650/4986 (93.2611%)
___Train Local_ResNet_18,  epoch 174, local model 1, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4556/4986 (91.3759%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9937, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5011/5392 (92.9340%)
___Train Local_ResNet_18,  epoch 174, local model 70, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4831/5392 (89.5957%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1516, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3587/3804 (94.2955%)
___Train Local_ResNet_18,  epoch 174, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3558/3804 (93.5331%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9876, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4733/5025 (94.1891%)
___Train Local_ResNet_18,  epoch 174, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4654/5025 (92.6169%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0073, Accuracy: 5572/10000 (55.7200%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4488/4793 (93.6366%)
___Train Local_ResNet_18,  epoch 174, local model 84, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4415/4793 (92.1135%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0181, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4581/4956 (92.4334%)
___Train Local_ResNet_18,  epoch 174, local model 46, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4447/4956 (89.7296%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1691, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4830/5116 (94.4097%)
___Train Local_ResNet_18,  epoch 174, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4687/5116 (91.6145%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9453, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4739/5055 (93.7488%)
___Train Local_ResNet_18,  epoch 174, local model 65, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4616/5055 (91.3155%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.9614, Accuracy: 5682/10000 (56.8200%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4708/5063 (92.9883%)
___Train Local_ResNet_18,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4555/5063 (89.9664%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.1968, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4204/4433 (94.8342%)
___Train Local_ResNet_18,  epoch 174, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4102/4433 (92.5333%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0580, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4379/4662 (93.9296%)
___Train Local_ResNet_18,  epoch 174, local model 44, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4279/4662 (91.7846%)
___Test Local_ResNet_18 poisoned: False, epoch: 174: Average loss: 2.0454, Accuracy: 5458/10000 (54.5800%)
time spent on training: 235.1027500629425
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 174: Average loss: 1.4404, Accuracy: 6437/10000 (64.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 174: Average loss: 0.0335, Accuracy: 9809/9900 (99.0808%)
Done in 258.666362285614 sec.
Server Epoch:175 choose agents : [13, 36, 58, 71, 94, 84, 79, 31, 90, 12, 82, 2, 26, 27, 55, 80, 85, 34, 35, 96].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4788/4885 (98.0143%), train_poison_data_count: 385
Global model norm: 44.60509502235283.
Norm before scaling: 44.56432023149588. Distance: 1.1025636600963795
Total norm for 4 adversaries is: 44.56432023149588. distance: 1.1025636600963795
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0342, Accuracy: 9820/9900 (99.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5158/5305 (97.2290%), train_poison_data_count: 415
Global model norm: 44.60509502235283.
Norm before scaling: 44.566801872038816. Distance: 1.295474663719673
Total norm for 4 adversaries is: 44.566801872038816. distance: 1.295474663719673
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0951, Accuracy: 9659/9900 (97.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4612/4717 (97.7740%), train_poison_data_count: 370
Global model norm: 44.60509502235283.
Norm before scaling: 44.56720587880454. Distance: 1.0854960580347457
Total norm for 4 adversaries is: 44.56720587880454. distance: 1.0854960580347457
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0420, Accuracy: 9797/9900 (98.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 175, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4938/5066 (97.4734%), train_poison_data_count: 400
Global model norm: 44.60509502235283.
Norm before scaling: 44.56828914666725. Distance: 1.2391096647312814
Total norm for 4 adversaries is: 44.56828914666725. distance: 1.2391096647312814
___Test Local_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0115, Accuracy: 9874/9900 (99.7374%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4489/4804 (93.4430%)
___Train Local_ResNet_18,  epoch 175, local model 94, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4165/4804 (86.6986%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4341, Accuracy: 5068/10000 (50.6800%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4536/4793 (94.6380%)
___Train Local_ResNet_18,  epoch 175, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4474/4793 (93.3445%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9208, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3573/3781 (94.4988%)
___Train Local_ResNet_18,  epoch 175, local model 79, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3514/3781 (92.9384%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0709, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3898/4175 (93.3653%)
___Train Local_ResNet_18,  epoch 175, local model 31, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3687/4175 (88.3114%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0451, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4153/4362 (95.2086%)
___Train Local_ResNet_18,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4109/4362 (94.1999%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.9523, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4739/5083 (93.2323%)
___Train Local_ResNet_18,  epoch 175, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4542/5083 (89.3567%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0543, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4555/4874 (93.4551%)
___Train Local_ResNet_18,  epoch 175, local model 82, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4389/4874 (90.0492%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.4492, Accuracy: 5026/10000 (50.2600%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3436/3646 (94.2403%)
___Train Local_ResNet_18,  epoch 175, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3382/3646 (92.7592%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8420, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3584/3756 (95.4207%)
___Train Local_ResNet_18,  epoch 175, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3593/3756 (95.6603%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.8429, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3999/4223 (94.6957%)
___Train Local_ResNet_18,  epoch 175, local model 27, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3971/4223 (94.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0051, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4122/4356 (94.6281%)
___Train Local_ResNet_18,  epoch 175, local model 55, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3801/4356 (87.2590%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.3719, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4699/5025 (93.5124%)
___Train Local_ResNet_18,  epoch 175, local model 80, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4646/5025 (92.4577%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0470, Accuracy: 5590/10000 (55.9000%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5921/6391 (92.6459%)
___Train Local_ResNet_18,  epoch 175, local model 85, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5754/6391 (90.0329%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2098, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4239/4518 (93.8247%)
___Train Local_ResNet_18,  epoch 175, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4224/4518 (93.4927%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0200, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4866/5167 (94.1746%)
___Train Local_ResNet_18,  epoch 175, local model 35, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4776/5167 (92.4327%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.0629, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4452/4679 (95.1485%)
___Train Local_ResNet_18,  epoch 175, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4225/4679 (90.2971%)
___Test Local_ResNet_18 poisoned: False, epoch: 175: Average loss: 2.2294, Accuracy: 5252/10000 (52.5200%)
time spent on training: 234.9825723171234
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 175: Average loss: 1.4541, Accuracy: 6414/10000 (64.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 175: Average loss: 0.0323, Accuracy: 9814/9900 (99.1313%)
Done in 258.2042543888092 sec.
Server Epoch:176 choose agents : [13, 36, 58, 71, 46, 52, 0, 33, 79, 9, 49, 2, 89, 60, 63, 59, 11, 80, 26, 70].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4791/4885 (98.0757%), train_poison_data_count: 385
Global model norm: 44.623329964811425.
Norm before scaling: 44.58359861681199. Distance: 1.1111441998058336
Total norm for 4 adversaries is: 44.58359861681199. distance: 1.1111441998058336
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0890, Accuracy: 9671/9900 (97.6869%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5188/5305 (97.7945%), train_poison_data_count: 415
Global model norm: 44.623329964811425.
Norm before scaling: 44.58231173381714. Distance: 1.2078957532686607
Total norm for 4 adversaries is: 44.58231173381714. distance: 1.2078957532686607
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0551, Accuracy: 9768/9900 (98.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 44.623329964811425.
Norm before scaling: 44.58547548275601. Distance: 1.092753255894684
Total norm for 4 adversaries is: 44.58547548275601. distance: 1.092753255894684
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0229, Accuracy: 9843/9900 (99.4242%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 176, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4938/5066 (97.4734%), train_poison_data_count: 400
Global model norm: 44.623329964811425.
Norm before scaling: 44.5868088172703. Distance: 1.2450454751101114
Total norm for 4 adversaries is: 44.5868088172703. distance: 1.2450454751101114
___Test Local_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0863, Accuracy: 9679/9900 (97.7677%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4614/4956 (93.0993%)
___Train Local_ResNet_18,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4480/4956 (90.3955%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1168, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3582/3797 (94.3376%)
___Train Local_ResNet_18,  epoch 176, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3546/3797 (93.3895%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9648, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4731/5017 (94.2994%)
___Train Local_ResNet_18,  epoch 176, local model 0, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4654/5017 (92.7646%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.8909, Accuracy: 5829/10000 (58.2900%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4241/4433 (95.6688%)
___Train Local_ResNet_18,  epoch 176, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4180/4433 (94.2928%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9135, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3572/3781 (94.4724%)
___Train Local_ResNet_18,  epoch 176, local model 79, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3558/3781 (94.1021%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9492, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4915/5265 (93.3523%)
___Train Local_ResNet_18,  epoch 176, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4645/5265 (88.2241%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.0429, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4870/5197 (93.7079%)
___Train Local_ResNet_18,  epoch 176, local model 49, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4716/5197 (90.7447%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1297, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3452/3646 (94.6791%)
___Train Local_ResNet_18,  epoch 176, local model 2, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3431/3646 (94.1031%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7150, Accuracy: 6012/10000 (60.1200%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4044/4356 (92.8375%)
___Train Local_ResNet_18,  epoch 176, local model 89, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3869/4356 (88.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.3356, Accuracy: 5123/10000 (51.2300%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3561/3804 (93.6120%)
___Train Local_ResNet_18,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3530/3804 (92.7971%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.9425, Accuracy: 5697/10000 (56.9700%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3428/3590 (95.4875%)
___Train Local_ResNet_18,  epoch 176, local model 63, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3293/3590 (91.7270%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1899, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3850/4046 (95.1557%)
___Train Local_ResNet_18,  epoch 176, local model 59, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3820/4046 (94.4142%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7648, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4789/5244 (91.3234%)
___Train Local_ResNet_18,  epoch 176, local model 11, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4585/5244 (87.4333%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2642, Accuracy: 5239/10000 (52.3900%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4732/5025 (94.1692%)
___Train Local_ResNet_18,  epoch 176, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4603/5025 (91.6020%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.1316, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3605/3756 (95.9798%)
___Train Local_ResNet_18,  epoch 176, local model 26, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3621/3756 (96.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.7971, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5087/5392 (94.3435%)
___Train Local_ResNet_18,  epoch 176, local model 70, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4838/5392 (89.7255%)
___Test Local_ResNet_18 poisoned: False, epoch: 176: Average loss: 2.2984, Accuracy: 5125/10000 (51.2500%)
time spent on training: 236.77948093414307
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 176: Average loss: 1.4644, Accuracy: 6396/10000 (63.9600%)
___Test Target_ResNet_18 poisoned: True, epoch: 176: Average loss: 0.0336, Accuracy: 9809/9900 (99.0808%)
Done in 264.1914551258087 sec.
Server Epoch:177 choose agents : [13, 36, 58, 71, 10, 81, 44, 17, 90, 57, 98, 28, 99, 19, 40, 77, 32, 86, 1, 35].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4784/4885 (97.9324%), train_poison_data_count: 385
Global model norm: 44.640802742908306.
Norm before scaling: 44.601773925536726. Distance: 1.1122366304149236
Total norm for 4 adversaries is: 44.601773925536726. distance: 1.1122366304149236
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0336, Accuracy: 9816/9900 (99.1515%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5168/5305 (97.4175%), train_poison_data_count: 415
Global model norm: 44.640802742908306.
Norm before scaling: 44.60185740071539. Distance: 1.270716891139432
Total norm for 4 adversaries is: 44.60185740071539. distance: 1.270716891139432
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0369, Accuracy: 9809/9900 (99.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.640802742908306.
Norm before scaling: 44.60285224860555. Distance: 1.1475200491755635
Total norm for 4 adversaries is: 44.60285224860555. distance: 1.1475200491755635
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0317, Accuracy: 9817/9900 (99.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 177, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4957/5066 (97.8484%), train_poison_data_count: 400
Global model norm: 44.640802742908306.
Norm before scaling: 44.60125801809715. Distance: 1.1810147732449423
Total norm for 4 adversaries is: 44.60125801809715. distance: 1.1810147732449423
___Test Local_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0907, Accuracy: 9674/9900 (97.7172%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4411/4663 (94.5958%)
___Train Local_ResNet_18,  epoch 177, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4315/4663 (92.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0663, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4377/4618 (94.7813%)
___Train Local_ResNet_18,  epoch 177, local model 81, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4315/4618 (93.4387%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0044, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4409/4662 (94.5731%)
___Train Local_ResNet_18,  epoch 177, local model 44, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4301/4662 (92.2565%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0295, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4175/4511 (92.5515%)
___Train Local_ResNet_18,  epoch 177, local model 17, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4117/4511 (91.2658%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9930, Accuracy: 5516/10000 (55.1600%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4157/4362 (95.3003%)
___Train Local_ResNet_18,  epoch 177, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4133/4362 (94.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8669, Accuracy: 5796/10000 (57.9600%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4268/4558 (93.6376%)
___Train Local_ResNet_18,  epoch 177, local model 57, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4085/4558 (89.6226%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0900, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3629/3828 (94.8015%)
___Train Local_ResNet_18,  epoch 177, local model 98, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3653/3828 (95.4284%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7181, Accuracy: 6111/10000 (61.1100%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4417/4716 (93.6599%)
___Train Local_ResNet_18,  epoch 177, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4285/4716 (90.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0436, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4241/4465 (94.9832%)
___Train Local_ResNet_18,  epoch 177, local model 99, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4161/4465 (93.1915%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.8587, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4538/4928 (92.0860%)
___Train Local_ResNet_18,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4389/4928 (89.0625%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0635, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5117/5455 (93.8038%)
___Train Local_ResNet_18,  epoch 177, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4883/5455 (89.5142%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9921, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4380/4647 (94.2544%)
___Train Local_ResNet_18,  epoch 177, local model 77, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4301/4647 (92.5543%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0218, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5110/5591 (91.3969%)
___Train Local_ResNet_18,  epoch 177, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4894/5591 (87.5335%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.3523, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3397/3616 (93.9436%)
___Train Local_ResNet_18,  epoch 177, local model 86, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3362/3616 (92.9757%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.7592, Accuracy: 5961/10000 (59.6100%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4667/4986 (93.6021%)
___Train Local_ResNet_18,  epoch 177, local model 1, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4610/4986 (92.4589%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.9877, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4879/5167 (94.4262%)
___Train Local_ResNet_18,  epoch 177, local model 35, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4767/5167 (92.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 177: Average loss: 2.0666, Accuracy: 5528/10000 (55.2800%)
time spent on training: 262.22979164123535
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 177: Average loss: 1.4716, Accuracy: 6399/10000 (63.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 177: Average loss: 0.0329, Accuracy: 9813/9900 (99.1212%)
Done in 292.13882064819336 sec.
Server Epoch:178 choose agents : [13, 36, 58, 71, 31, 5, 86, 55, 11, 68, 2, 52, 66, 98, 15, 30, 90, 42, 96, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.65853656016185.
Norm before scaling: 44.61980093794892. Distance: 1.1589610304119065
Total norm for 4 adversaries is: 44.61980093794892. distance: 1.1589610304119065
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0267, Accuracy: 9832/9900 (99.3131%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5183/5305 (97.7003%), train_poison_data_count: 415
Global model norm: 44.65853656016185.
Norm before scaling: 44.61754385582607. Distance: 1.208344963719312
Total norm for 4 adversaries is: 44.61754385582607. distance: 1.208344963719312
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0425, Accuracy: 9784/9900 (98.8283%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4609/4717 (97.7104%), train_poison_data_count: 370
Global model norm: 44.65853656016185.
Norm before scaling: 44.621218053589004. Distance: 1.1128460485194631
Total norm for 4 adversaries is: 44.621218053589004. distance: 1.1128460485194631
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0580, Accuracy: 9757/9900 (98.5556%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 178, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4954/5066 (97.7892%), train_poison_data_count: 400
Global model norm: 44.65853656016185.
Norm before scaling: 44.620669542159774. Distance: 1.1984810315199852
Total norm for 4 adversaries is: 44.620669542159774. distance: 1.1984810315199852
___Test Local_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0208, Accuracy: 9857/9900 (99.5657%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3934/4175 (94.2275%)
___Train Local_ResNet_18,  epoch 178, local model 31, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3719/4175 (89.0778%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0784, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4325/4596 (94.1036%)
___Train Local_ResNet_18,  epoch 178, local model 5, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4274/4596 (92.9939%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0475, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3382/3616 (93.5288%)
___Train Local_ResNet_18,  epoch 178, local model 86, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3397/3616 (93.9436%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7954, Accuracy: 5938/10000 (59.3800%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4166/4356 (95.6382%)
___Train Local_ResNet_18,  epoch 178, local model 55, internal_epoch   2,  Average loss: 0.0114, Accuracy: 3479/4356 (79.8669%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.6293, Accuracy: 4653/10000 (46.5300%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4844/5244 (92.3722%)
___Train Local_ResNet_18,  epoch 178, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4638/5244 (88.4439%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1565, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3108/3297 (94.2675%)
___Train Local_ResNet_18,  epoch 178, local model 68, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3112/3297 (94.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.7850, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3443/3646 (94.4323%)
___Train Local_ResNet_18,  epoch 178, local model 2, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3383/3646 (92.7866%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8985, Accuracy: 5726/10000 (57.2600%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3603/3797 (94.8907%)
___Train Local_ResNet_18,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3543/3797 (93.3105%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.9599, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4246/4456 (95.2873%)
___Train Local_ResNet_18,  epoch 178, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4198/4456 (94.2101%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8710, Accuracy: 5899/10000 (58.9900%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3661/3828 (95.6374%)
___Train Local_ResNet_18,  epoch 178, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3631/3828 (94.8537%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.8402, Accuracy: 5834/10000 (58.3400%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5304/5582 (95.0197%)
___Train Local_ResNet_18,  epoch 178, local model 15, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5211/5582 (93.3536%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0808, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3296/3472 (94.9309%)
___Train Local_ResNet_18,  epoch 178, local model 30, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3211/3472 (92.4827%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0059, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4156/4362 (95.2774%)
___Train Local_ResNet_18,  epoch 178, local model 90, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4047/4362 (92.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1074, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5135/5424 (94.6718%)
___Train Local_ResNet_18,  epoch 178, local model 42, internal_epoch   2,  Average loss: 0.0032, Accuracy: 5080/5424 (93.6578%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0946, Accuracy: 5562/10000 (55.6200%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4445/4679 (94.9989%)
___Train Local_ResNet_18,  epoch 178, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4187/4679 (89.4849%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.1806, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3429/3590 (95.5153%)
___Train Local_ResNet_18,  epoch 178, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3266/3590 (90.9749%)
___Test Local_ResNet_18 poisoned: False, epoch: 178: Average loss: 2.0231, Accuracy: 5662/10000 (56.6200%)
time spent on training: 227.39853882789612
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 178: Average loss: 1.4903, Accuracy: 6366/10000 (63.6600%)
___Test Target_ResNet_18 poisoned: True, epoch: 178: Average loss: 0.0302, Accuracy: 9819/9900 (99.1818%)
Done in 250.47493743896484 sec.
Server Epoch:179 choose agents : [13, 36, 58, 71, 60, 68, 37, 33, 51, 54, 70, 11, 55, 74, 7, 48, 41, 2, 77, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4790/4885 (98.0553%), train_poison_data_count: 385
Global model norm: 44.67435613081766.
Norm before scaling: 44.634121857435204. Distance: 1.1212614246411519
Total norm for 4 adversaries is: 44.634121857435204. distance: 1.1212614246411519
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0284, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5159/5305 (97.2479%), train_poison_data_count: 415
Global model norm: 44.67435613081766.
Norm before scaling: 44.63789587387465. Distance: 1.34626587726436
Total norm for 4 adversaries is: 44.63789587387465. distance: 1.34626587726436
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0484, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4617/4717 (97.8800%), train_poison_data_count: 370
Global model norm: 44.67435613081766.
Norm before scaling: 44.636844377448575. Distance: 1.1031663730200423
Total norm for 4 adversaries is: 44.636844377448575. distance: 1.1031663730200423
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0620, Accuracy: 9746/9900 (98.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4974/5066 (98.1840%), train_poison_data_count: 400
Global model norm: 44.67435613081766.
Norm before scaling: 44.634223048995715. Distance: 1.144636077767265
Total norm for 4 adversaries is: 44.634223048995715. distance: 1.144636077767265
___Test Local_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0191, Accuracy: 9854/9900 (99.5354%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3608/3804 (94.8475%)
___Train Local_ResNet_18,  epoch 179, local model 60, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3613/3804 (94.9790%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8758, Accuracy: 5841/10000 (58.4100%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3168/3297 (96.0874%)
___Train Local_ResNet_18,  epoch 179, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3132/3297 (94.9955%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.7679, Accuracy: 6059/10000 (60.5900%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4098/4354 (94.1203%)
___Train Local_ResNet_18,  epoch 179, local model 37, internal_epoch   2,  Average loss: 0.0089, Accuracy: 3611/4354 (82.9352%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.6075, Accuracy: 4636/10000 (46.3600%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4235/4433 (95.5335%)
___Train Local_ResNet_18,  epoch 179, local model 33, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4098/4433 (92.4430%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8602, Accuracy: 5892/10000 (58.9200%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3600/3775 (95.3642%)
___Train Local_ResNet_18,  epoch 179, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3596/3775 (95.2583%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8623, Accuracy: 5824/10000 (58.2400%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4807/5195 (92.5313%)
___Train Local_ResNet_18,  epoch 179, local model 54, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4692/5195 (90.3176%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0737, Accuracy: 5424/10000 (54.2400%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5095/5392 (94.4918%)
___Train Local_ResNet_18,  epoch 179, local model 70, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4953/5392 (91.8583%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9925, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4779/5244 (91.1327%)
___Train Local_ResNet_18,  epoch 179, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4587/5244 (87.4714%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0751, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4136/4356 (94.9495%)
___Train Local_ResNet_18,  epoch 179, local model 55, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3652/4356 (83.8384%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.4774, Accuracy: 4862/10000 (48.6200%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4089/4416 (92.5951%)
___Train Local_ResNet_18,  epoch 179, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4039/4416 (91.4629%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.9093, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4149/4481 (92.5909%)
___Train Local_ResNet_18,  epoch 179, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3988/4481 (88.9980%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.2372, Accuracy: 5297/10000 (52.9700%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4220/4441 (95.0236%)
___Train Local_ResNet_18,  epoch 179, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4146/4441 (93.3574%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.0838, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4092/4336 (94.3727%)
___Train Local_ResNet_18,  epoch 179, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4007/4336 (92.4124%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 2.1238, Accuracy: 5356/10000 (53.5600%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3479/3646 (95.4196%)
___Train Local_ResNet_18,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3439/3646 (94.3225%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.6994, Accuracy: 6102/10000 (61.0200%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4397/4647 (94.6202%)
___Train Local_ResNet_18,  epoch 179, local model 77, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4363/4647 (93.8885%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8871, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3400/3638 (93.4579%)
___Train Local_ResNet_18,  epoch 179, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3378/3638 (92.8532%)
___Test Local_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.8632, Accuracy: 5841/10000 (58.4100%)
time spent on training: 230.6433846950531
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 5 ranked 1 as suspicious. Assigned small weight: 0.1
Client 18 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 179: Average loss: 1.5028, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 179: Average loss: 0.0293, Accuracy: 9823/9900 (99.2222%)
Done in 254.36432933807373 sec.
Server Epoch:180 choose agents : [13, 36, 58, 71, 6, 38, 88, 69, 17, 8, 34, 60, 79, 48, 44, 30, 18, 21, 81, 54].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4782/4885 (97.8915%), train_poison_data_count: 385
Global model norm: 44.6926392914531.
Norm before scaling: 44.654440349966876. Distance: 1.1790009578736533
Total norm for 4 adversaries is: 44.654440349966876. distance: 1.1790009578736533
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0214, Accuracy: 9844/9900 (99.4343%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5184/5305 (97.7191%), train_poison_data_count: 415
Global model norm: 44.6926392914531.
Norm before scaling: 44.65205516293105. Distance: 1.2151257840732743
Total norm for 4 adversaries is: 44.65205516293105. distance: 1.2151257840732743
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0303, Accuracy: 9827/9900 (99.2626%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4603/4717 (97.5832%), train_poison_data_count: 370
Global model norm: 44.6926392914531.
Norm before scaling: 44.65615432547484. Distance: 1.1336259749266697
Total norm for 4 adversaries is: 44.65615432547484. distance: 1.1336259749266697
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0299, Accuracy: 9811/9900 (99.1010%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 180, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4948/5066 (97.6707%), train_poison_data_count: 400
Global model norm: 44.6926392914531.
Norm before scaling: 44.653472621818565. Distance: 1.1909395398152764
Total norm for 4 adversaries is: 44.653472621818565. distance: 1.1909395398152764
___Test Local_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0257, Accuracy: 9832/9900 (99.3131%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4327/4538 (95.3504%)
___Train Local_ResNet_18,  epoch 180, local model 6, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4292/4538 (94.5791%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7298, Accuracy: 5996/10000 (59.9600%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5393/5740 (93.9547%)
___Train Local_ResNet_18,  epoch 180, local model 38, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5288/5740 (92.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1752, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4541/4934 (92.0349%)
___Train Local_ResNet_18,  epoch 180, local model 88, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4162/4934 (84.3535%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.4509, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3821/4013 (95.2155%)
___Train Local_ResNet_18,  epoch 180, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3796/4013 (94.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.7707, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4186/4511 (92.7954%)
___Train Local_ResNet_18,  epoch 180, local model 17, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4152/4511 (92.0417%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.1190, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4200/4501 (93.3126%)
___Train Local_ResNet_18,  epoch 180, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4121/4501 (91.5574%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9446, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4255/4518 (94.1788%)
___Train Local_ResNet_18,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4172/4518 (92.3417%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0548, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3595/3804 (94.5058%)
___Train Local_ResNet_18,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3570/3804 (93.8486%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9353, Accuracy: 5766/10000 (57.6600%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3558/3781 (94.1021%)
___Train Local_ResNet_18,  epoch 180, local model 79, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3311/3781 (87.5694%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.3027, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4261/4441 (95.9469%)
___Train Local_ResNet_18,  epoch 180, local model 48, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4244/4441 (95.5641%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8935, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4424/4662 (94.8949%)
___Train Local_ResNet_18,  epoch 180, local model 44, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4358/4662 (93.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.9232, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3285/3472 (94.6141%)
___Train Local_ResNet_18,  epoch 180, local model 30, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3291/3472 (94.7869%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.8493, Accuracy: 5930/10000 (59.3000%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3692/3911 (94.4004%)
___Train Local_ResNet_18,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3522/3911 (90.0537%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0415, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4342/4634 (93.6987%)
___Train Local_ResNet_18,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4233/4634 (91.3466%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0506, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4405/4618 (95.3876%)
___Train Local_ResNet_18,  epoch 180, local model 81, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4305/4618 (93.2222%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.0520, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4818/5195 (92.7430%)
___Train Local_ResNet_18,  epoch 180, local model 54, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4654/5195 (89.5861%)
___Test Local_ResNet_18 poisoned: False, epoch: 180: Average loss: 2.2622, Accuracy: 5213/10000 (52.1300%)
time spent on training: 239.37215852737427
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 15 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 180: Average loss: 1.4981, Accuracy: 6356/10000 (63.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 180: Average loss: 0.0298, Accuracy: 9821/9900 (99.2020%)
Done in 266.9417459964752 sec.
Server Epoch:181 choose agents : [13, 36, 58, 71, 83, 16, 94, 81, 26, 21, 76, 4, 47, 7, 37, 2, 27, 17, 66, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4797/4885 (98.1986%), train_poison_data_count: 385
Global model norm: 44.71035254837519.
Norm before scaling: 44.66924206345388. Distance: 1.0688310380517736
Total norm for 4 adversaries is: 44.66924206345388. distance: 1.0688310380517736
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0472, Accuracy: 9787/9900 (98.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5205/5305 (98.1150%), train_poison_data_count: 415
Global model norm: 44.71035254837519.
Norm before scaling: 44.66732362482318. Distance: 1.1687745851593054
Total norm for 4 adversaries is: 44.66732362482318. distance: 1.1687745851593054
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0523, Accuracy: 9755/9900 (98.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4618/4717 (97.9012%), train_poison_data_count: 370
Global model norm: 44.71035254837519.
Norm before scaling: 44.67207857814753. Distance: 1.095773242468074
Total norm for 4 adversaries is: 44.67207857814753. distance: 1.095773242468074
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0601, Accuracy: 9738/9900 (98.3636%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 181, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 44.71035254837519.
Norm before scaling: 44.6713790305626. Distance: 1.196355078296483
Total norm for 4 adversaries is: 44.6713790305626. distance: 1.196355078296483
___Test Local_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0429, Accuracy: 9797/9900 (98.9596%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3029/3271 (92.6017%)
___Train Local_ResNet_18,  epoch 181, local model 83, internal_epoch   2,  Average loss: 0.0061, Accuracy: 2877/3271 (87.9548%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.3051, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4667/4928 (94.7037%)
___Train Local_ResNet_18,  epoch 181, local model 16, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4528/4928 (91.8831%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9648, Accuracy: 5684/10000 (56.8400%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4499/4804 (93.6511%)
___Train Local_ResNet_18,  epoch 181, local model 94, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4095/4804 (85.2415%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.5115, Accuracy: 4912/10000 (49.1200%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4401/4618 (95.3010%)
___Train Local_ResNet_18,  epoch 181, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4338/4618 (93.9368%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0228, Accuracy: 5591/10000 (55.9100%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3595/3756 (95.7135%)
___Train Local_ResNet_18,  epoch 181, local model 26, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3575/3756 (95.1810%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7893, Accuracy: 5962/10000 (59.6200%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4364/4634 (94.1735%)
___Train Local_ResNet_18,  epoch 181, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4298/4634 (92.7492%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1070, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3416/3638 (93.8977%)
___Train Local_ResNet_18,  epoch 181, local model 76, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3428/3638 (94.2276%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.9344, Accuracy: 5624/10000 (56.2400%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3500/3704 (94.4924%)
___Train Local_ResNet_18,  epoch 181, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3489/3704 (94.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7427, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4416/4707 (93.8177%)
___Train Local_ResNet_18,  epoch 181, local model 47, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4343/4707 (92.2668%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8716, Accuracy: 5773/10000 (57.7300%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4165/4481 (92.9480%)
___Train Local_ResNet_18,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3973/4481 (88.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.1826, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4079/4354 (93.6840%)
___Train Local_ResNet_18,  epoch 181, local model 37, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3881/4354 (89.1364%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 3.1497, Accuracy: 4360/10000 (43.6000%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3454/3646 (94.7340%)
___Train Local_ResNet_18,  epoch 181, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3450/3646 (94.6242%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.7548, Accuracy: 6063/10000 (60.6300%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3974/4223 (94.1037%)
___Train Local_ResNet_18,  epoch 181, local model 27, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3961/4223 (93.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8617, Accuracy: 5809/10000 (58.0900%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4208/4511 (93.2831%)
___Train Local_ResNet_18,  epoch 181, local model 17, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4155/4511 (92.1082%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0012, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4227/4456 (94.8609%)
___Train Local_ResNet_18,  epoch 181, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4223/4456 (94.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.8678, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3629/3861 (93.9912%)
___Train Local_ResNet_18,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3572/3861 (92.5149%)
___Test Local_ResNet_18 poisoned: False, epoch: 181: Average loss: 2.0854, Accuracy: 5502/10000 (55.0200%)
time spent on training: 256.67663526535034
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 12 ranked 1 as suspicious. Assigned small weight: 0.1
Client 10 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 181: Average loss: 1.5035, Accuracy: 6351/10000 (63.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 181: Average loss: 0.0279, Accuracy: 9828/9900 (99.2727%)
Done in 284.0206446647644 sec.
Server Epoch:182 choose agents : [13, 36, 58, 71, 60, 8, 10, 32, 11, 33, 47, 66, 55, 43, 96, 21, 69, 22, 61, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4787/4885 (97.9939%), train_poison_data_count: 385
Global model norm: 44.726904338213345.
Norm before scaling: 44.68771989674918. Distance: 1.1435420738456243
Total norm for 4 adversaries is: 44.68771989674918. distance: 1.1435420738456243
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0409, Accuracy: 9799/9900 (98.9798%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5178/5305 (97.6060%), train_poison_data_count: 415
Global model norm: 44.726904338213345.
Norm before scaling: 44.685652005058486. Distance: 1.2268229894355305
Total norm for 4 adversaries is: 44.685652005058486. distance: 1.2268229894355305
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0233, Accuracy: 9845/9900 (99.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 58, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4595/4717 (97.4136%), train_poison_data_count: 370
Global model norm: 44.726904338213345.
Norm before scaling: 44.69016327291023. Distance: 1.1539900576892093
Total norm for 4 adversaries is: 44.69016327291023. distance: 1.1539900576892093
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0368, Accuracy: 9799/9900 (98.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 182, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4965/5066 (98.0063%), train_poison_data_count: 400
Global model norm: 44.726904338213345.
Norm before scaling: 44.68624615810915. Distance: 1.1535881435646083
Total norm for 4 adversaries is: 44.68624615810915. distance: 1.1535881435646083
___Test Local_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0748, Accuracy: 9696/9900 (97.9394%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3609/3804 (94.8738%)
___Train Local_ResNet_18,  epoch 182, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3544/3804 (93.1651%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.2371, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4236/4501 (94.1124%)
___Train Local_ResNet_18,  epoch 182, local model 8, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4104/4501 (91.1797%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0627, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4395/4663 (94.2526%)
___Train Local_ResNet_18,  epoch 182, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4373/4663 (93.7808%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9387, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5183/5591 (92.7026%)
___Train Local_ResNet_18,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5056/5591 (90.4310%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3657, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4810/5244 (91.7239%)
___Train Local_ResNet_18,  epoch 182, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4609/5244 (87.8909%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.1187, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4235/4433 (95.5335%)
___Train Local_ResNet_18,  epoch 182, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4181/4433 (94.3154%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8154, Accuracy: 5763/10000 (57.6300%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4462/4707 (94.7950%)
___Train Local_ResNet_18,  epoch 182, local model 47, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4354/4707 (92.5005%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8880, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4212/4456 (94.5242%)
___Train Local_ResNet_18,  epoch 182, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4195/4456 (94.1427%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9200, Accuracy: 5847/10000 (58.4700%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4156/4356 (95.4086%)
___Train Local_ResNet_18,  epoch 182, local model 55, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3906/4356 (89.6694%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0819, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4338/4576 (94.7990%)
___Train Local_ResNet_18,  epoch 182, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4248/4576 (92.8322%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.0662, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4412/4679 (94.2937%)
___Train Local_ResNet_18,  epoch 182, local model 96, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4131/4679 (88.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3499, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4348/4634 (93.8282%)
___Train Local_ResNet_18,  epoch 182, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4277/4634 (92.2961%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.9580, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3827/4013 (95.3651%)
___Train Local_ResNet_18,  epoch 182, local model 69, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3821/4013 (95.2155%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8149, Accuracy: 5896/10000 (58.9600%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4840/5232 (92.5076%)
___Train Local_ResNet_18,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4627/5232 (88.4365%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 2.3392, Accuracy: 5078/10000 (50.7800%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3902/4126 (94.5710%)
___Train Local_ResNet_18,  epoch 182, local model 61, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3868/4126 (93.7470%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.8657, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3635/3756 (96.7785%)
___Train Local_ResNet_18,  epoch 182, local model 26, internal_epoch   2,  Average loss: 0.0021, Accuracy: 3614/3756 (96.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.6869, Accuracy: 6181/10000 (61.8100%)
time spent on training: 245.8129539489746
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 17 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 182: Average loss: 1.5105, Accuracy: 6344/10000 (63.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 182: Average loss: 0.0283, Accuracy: 9825/9900 (99.2424%)
Done in 268.9824504852295 sec.
Server Epoch:183 choose agents : [13, 36, 58, 71, 65, 7, 72, 9, 57, 32, 22, 26, 33, 84, 73, 47, 78, 39, 85, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4794/4885 (98.1372%), train_poison_data_count: 385
Global model norm: 44.744066580281064.
Norm before scaling: 44.70286694918529. Distance: 1.0893191370426165
Total norm for 4 adversaries is: 44.70286694918529. distance: 1.0893191370426165
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0912, Accuracy: 9672/9900 (97.6970%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5191/5305 (97.8511%), train_poison_data_count: 415
Global model norm: 44.744066580281064.
Norm before scaling: 44.70372165147089. Distance: 1.2306122711282792
Total norm for 4 adversaries is: 44.70372165147089. distance: 1.2306122711282792
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0342, Accuracy: 9807/9900 (99.0606%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4624/4717 (98.0284%), train_poison_data_count: 370
Global model norm: 44.744066580281064.
Norm before scaling: 44.70390870075009. Distance: 1.017228020536281
Total norm for 4 adversaries is: 44.70390870075009. distance: 1.017228020536281
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0922, Accuracy: 9676/9900 (97.7374%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 183, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4945/5066 (97.6115%), train_poison_data_count: 400
Global model norm: 44.744066580281064.
Norm before scaling: 44.706655640897026. Distance: 1.2278482780574023
Total norm for 4 adversaries is: 44.706655640897026. distance: 1.2278482780574023
___Test Local_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0273, Accuracy: 9836/9900 (99.3535%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4785/5055 (94.6588%)
___Train Local_ResNet_18,  epoch 183, local model 65, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4604/5055 (91.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2021, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4210/4481 (93.9522%)
___Train Local_ResNet_18,  epoch 183, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4021/4481 (89.7344%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1155, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4448/4767 (93.3082%)
___Train Local_ResNet_18,  epoch 183, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4322/4767 (90.6650%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2004, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4903/5265 (93.1244%)
___Train Local_ResNet_18,  epoch 183, local model 9, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4644/5265 (88.2051%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1802, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4298/4558 (94.2957%)
___Train Local_ResNet_18,  epoch 183, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4202/4558 (92.1896%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.9230, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5193/5591 (92.8814%)
___Train Local_ResNet_18,  epoch 183, local model 32, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4954/5591 (88.6067%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.1719, Accuracy: 5333/10000 (53.3300%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4846/5232 (92.6223%)
___Train Local_ResNet_18,  epoch 183, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4712/5232 (90.0612%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.2560, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3605/3756 (95.9798%)
___Train Local_ResNet_18,  epoch 183, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3585/3756 (95.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7937, Accuracy: 5963/10000 (59.6300%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4214/4433 (95.0598%)
___Train Local_ResNet_18,  epoch 183, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4162/4433 (93.8868%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8464, Accuracy: 5771/10000 (57.7100%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4512/4793 (94.1373%)
___Train Local_ResNet_18,  epoch 183, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4462/4793 (93.0941%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0184, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4033/4235 (95.2302%)
___Train Local_ResNet_18,  epoch 183, local model 73, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3763/4235 (88.8548%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0766, Accuracy: 5376/10000 (53.7600%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4423/4707 (93.9664%)
___Train Local_ResNet_18,  epoch 183, local model 47, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4320/4707 (91.7782%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.0816, Accuracy: 5428/10000 (54.2800%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3822/4025 (94.9565%)
___Train Local_ResNet_18,  epoch 183, local model 78, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3782/4025 (93.9627%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.8453, Accuracy: 5858/10000 (58.5800%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3598/3837 (93.7712%)
___Train Local_ResNet_18,  epoch 183, local model 39, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3653/3837 (95.2046%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.7884, Accuracy: 5875/10000 (58.7500%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5849/6391 (91.5193%)
___Train Local_ResNet_18,  epoch 183, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5573/6391 (87.2008%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.3636, Accuracy: 4938/10000 (49.3800%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4093/4354 (94.0055%)
___Train Local_ResNet_18,  epoch 183, local model 37, internal_epoch   2,  Average loss: 0.0110, Accuracy: 3486/4354 (80.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 183: Average loss: 2.6182, Accuracy: 4677/10000 (46.7700%)
time spent on training: 236.5415654182434
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 183: Average loss: 1.5179, Accuracy: 6324/10000 (63.2400%)
___Test Target_ResNet_18 poisoned: True, epoch: 183: Average loss: 0.0292, Accuracy: 9822/9900 (99.2121%)
Done in 259.9973599910736 sec.
Server Epoch:184 choose agents : [13, 36, 58, 71, 42, 43, 88, 15, 46, 25, 68, 30, 16, 7, 80, 1, 19, 94, 2, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4799/4885 (98.2395%), train_poison_data_count: 385
Global model norm: 44.76360706621088.
Norm before scaling: 44.721910920780765. Distance: 1.0686024279520252
Total norm for 4 adversaries is: 44.721910920780765. distance: 1.0686024279520252
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0796, Accuracy: 9704/9900 (98.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5174/5305 (97.5306%), train_poison_data_count: 415
Global model norm: 44.76360706621088.
Norm before scaling: 44.72396348889765. Distance: 1.2905647079018072
Total norm for 4 adversaries is: 44.72396348889765. distance: 1.2905647079018072
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0446, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4599/4717 (97.4984%), train_poison_data_count: 370
Global model norm: 44.76360706621088.
Norm before scaling: 44.725483747907916. Distance: 1.1235714955858636
Total norm for 4 adversaries is: 44.725483747907916. distance: 1.1235714955858636
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0507, Accuracy: 9771/9900 (98.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 184, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4966/5066 (98.0261%), train_poison_data_count: 400
Global model norm: 44.76360706621088.
Norm before scaling: 44.723918453506926. Distance: 1.1503424383411265
Total norm for 4 adversaries is: 44.723918453506926. distance: 1.1503424383411265
___Test Local_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0209, Accuracy: 9851/9900 (99.5051%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5090/5424 (93.8422%)
___Train Local_ResNet_18,  epoch 184, local model 42, internal_epoch   2,  Average loss: 0.0036, Accuracy: 5029/5424 (92.7176%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1779, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4316/4576 (94.3182%)
___Train Local_ResNet_18,  epoch 184, local model 43, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4269/4576 (93.2911%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9553, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4550/4934 (92.2173%)
___Train Local_ResNet_18,  epoch 184, local model 88, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4207/4934 (85.2655%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.2803, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5294/5582 (94.8406%)
___Train Local_ResNet_18,  epoch 184, local model 15, internal_epoch   2,  Average loss: 0.0043, Accuracy: 5136/5582 (92.0100%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0902, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4635/4956 (93.5230%)
___Train Local_ResNet_18,  epoch 184, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4477/4956 (90.3349%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1898, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5494/5902 (93.0871%)
___Train Local_ResNet_18,  epoch 184, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5156/5902 (87.3602%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.4571, Accuracy: 5000/10000 (50.0000%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3124/3297 (94.7528%)
___Train Local_ResNet_18,  epoch 184, local model 68, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3075/3297 (93.2666%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8124, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3292/3472 (94.8157%)
___Train Local_ResNet_18,  epoch 184, local model 30, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3276/3472 (94.3548%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9499, Accuracy: 5754/10000 (57.5400%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4662/4928 (94.6023%)
___Train Local_ResNet_18,  epoch 184, local model 16, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4582/4928 (92.9789%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9940, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4189/4481 (93.4836%)
___Train Local_ResNet_18,  epoch 184, local model 7, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4021/4481 (89.7344%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0552, Accuracy: 5604/10000 (56.0400%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4736/5025 (94.2488%)
___Train Local_ResNet_18,  epoch 184, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4663/5025 (92.7960%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0584, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4643/4986 (93.1207%)
___Train Local_ResNet_18,  epoch 184, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4615/4986 (92.5592%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.0294, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4561/4928 (92.5528%)
___Train Local_ResNet_18,  epoch 184, local model 19, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4492/4928 (91.1526%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.1874, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4552/4804 (94.7544%)
___Train Local_ResNet_18,  epoch 184, local model 94, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4125/4804 (85.8659%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 2.3856, Accuracy: 5029/10000 (50.2900%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3424/3646 (93.9111%)
___Train Local_ResNet_18,  epoch 184, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3403/3646 (93.3352%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.8781, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4468/4707 (94.9225%)
___Train Local_ResNet_18,  epoch 184, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4294/4707 (91.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.9686, Accuracy: 5532/10000 (55.3200%)
time spent on training: 237.27195572853088
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 5 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 184: Average loss: 1.5154, Accuracy: 6337/10000 (63.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 184: Average loss: 0.0281, Accuracy: 9825/9900 (99.2424%)
Done in 260.5176022052765 sec.
Server Epoch:185 choose agents : [13, 36, 58, 71, 67, 93, 32, 94, 66, 62, 27, 88, 98, 25, 74, 6, 80, 95, 49, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4805/4885 (98.3623%), train_poison_data_count: 385
Global model norm: 44.78320035660345.
Norm before scaling: 44.74243782123969. Distance: 1.1025284123814394
Total norm for 4 adversaries is: 44.74243782123969. distance: 1.1025284123814394
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0122, Accuracy: 9863/9900 (99.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5187/5305 (97.7757%), train_poison_data_count: 415
Global model norm: 44.78320035660345.
Norm before scaling: 44.7430325843449. Distance: 1.2256982759458448
Total norm for 4 adversaries is: 44.7430325843449. distance: 1.2256982759458448
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0141, Accuracy: 9867/9900 (99.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 58, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4593/4717 (97.3712%), train_poison_data_count: 370
Global model norm: 44.78320035660345.
Norm before scaling: 44.74484410765949. Distance: 1.1160615168540065
Total norm for 4 adversaries is: 44.74484410765949. distance: 1.1160615168540065
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0431, Accuracy: 9797/9900 (98.9596%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 185, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4941/5066 (97.5326%), train_poison_data_count: 400
Global model norm: 44.78320035660345.
Norm before scaling: 44.74542792635355. Distance: 1.2448870038456301
Total norm for 4 adversaries is: 44.74542792635355. distance: 1.2448870038456301
___Test Local_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0371, Accuracy: 9805/9900 (99.0404%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4837/5116 (94.5465%)
___Train Local_ResNet_18,  epoch 185, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4710/5116 (92.0641%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0405, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4386/4651 (94.3023%)
___Train Local_ResNet_18,  epoch 185, local model 93, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4325/4651 (92.9908%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9879, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5225/5591 (93.4538%)
___Train Local_ResNet_18,  epoch 185, local model 32, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4973/5591 (88.9465%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2106, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4481/4804 (93.2764%)
___Train Local_ResNet_18,  epoch 185, local model 94, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4083/4804 (84.9917%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.5033, Accuracy: 4919/10000 (49.1900%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4242/4456 (95.1975%)
___Train Local_ResNet_18,  epoch 185, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4239/4456 (95.1302%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8369, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4726/5063 (93.3439%)
___Train Local_ResNet_18,  epoch 185, local model 62, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4473/5063 (88.3468%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.2272, Accuracy: 5211/10000 (52.1100%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4004/4223 (94.8141%)
___Train Local_ResNet_18,  epoch 185, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3983/4223 (94.3168%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8428, Accuracy: 5840/10000 (58.4000%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4577/4934 (92.7645%)
___Train Local_ResNet_18,  epoch 185, local model 88, internal_epoch   2,  Average loss: 0.0076, Accuracy: 4227/4934 (85.6709%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.6451, Accuracy: 4628/10000 (46.2800%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3628/3828 (94.7753%)
___Train Local_ResNet_18,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3623/3828 (94.6447%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.8704, Accuracy: 5825/10000 (58.2500%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5468/5902 (92.6466%)
___Train Local_ResNet_18,  epoch 185, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 4997/5902 (84.6662%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4129, Accuracy: 4949/10000 (49.4900%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4154/4416 (94.0670%)
___Train Local_ResNet_18,  epoch 185, local model 74, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4086/4416 (92.5272%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9531, Accuracy: 5695/10000 (56.9500%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4348/4538 (95.8131%)
___Train Local_ResNet_18,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4297/4538 (94.6893%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.7286, Accuracy: 5945/10000 (59.4500%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4677/5025 (93.0746%)
___Train Local_ResNet_18,  epoch 185, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4635/5025 (92.2388%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.0263, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4308/4625 (93.1459%)
___Train Local_ResNet_18,  epoch 185, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4115/4625 (88.9730%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.1046, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4919/5197 (94.6508%)
___Train Local_ResNet_18,  epoch 185, local model 49, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4688/5197 (90.2059%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 2.4249, Accuracy: 5039/10000 (50.3900%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3589/3804 (94.3481%)
___Train Local_ResNet_18,  epoch 185, local model 60, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3564/3804 (93.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.9457, Accuracy: 5685/10000 (56.8500%)
time spent on training: 248.44252586364746
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 8 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 185: Average loss: 1.5241, Accuracy: 6317/10000 (63.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 185: Average loss: 0.0268, Accuracy: 9830/9900 (99.2929%)
Done in 271.5589587688446 sec.
Server Epoch:186 choose agents : [13, 36, 58, 71, 94, 18, 69, 22, 32, 39, 42, 35, 66, 16, 33, 68, 28, 5, 84, 74].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4799/4885 (98.2395%), train_poison_data_count: 385
Global model norm: 44.80324962274291.
Norm before scaling: 44.76309438745969. Distance: 1.1279672591652288
Total norm for 4 adversaries is: 44.76309438745969. distance: 1.1279672591652288
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0663, Accuracy: 9732/9900 (98.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5196/5305 (97.9453%), train_poison_data_count: 415
Global model norm: 44.80324962274291.
Norm before scaling: 44.76101088786004. Distance: 1.1926608624513428
Total norm for 4 adversaries is: 44.76101088786004. distance: 1.1926608624513428
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0745, Accuracy: 9713/9900 (98.1111%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4600/4717 (97.5196%), train_poison_data_count: 370
Global model norm: 44.80324962274291.
Norm before scaling: 44.76399975234703. Distance: 1.0765795480737541
Total norm for 4 adversaries is: 44.76399975234703. distance: 1.0765795480737541
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0618, Accuracy: 9742/9900 (98.4040%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 186, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4963/5066 (97.9668%), train_poison_data_count: 400
Global model norm: 44.80324962274291.
Norm before scaling: 44.76279032255404. Distance: 1.1566188327085225
Total norm for 4 adversaries is: 44.76279032255404. distance: 1.1566188327085225
___Test Local_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0506, Accuracy: 9766/9900 (98.6465%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4508/4804 (93.8385%)
___Train Local_ResNet_18,  epoch 186, local model 94, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4321/4804 (89.9459%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2744, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3713/3911 (94.9374%)
___Train Local_ResNet_18,  epoch 186, local model 18, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3426/3911 (87.5991%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2007, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3831/4013 (95.4647%)
___Train Local_ResNet_18,  epoch 186, local model 69, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3805/4013 (94.8168%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7846, Accuracy: 5936/10000 (59.3600%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4831/5232 (92.3356%)
___Train Local_ResNet_18,  epoch 186, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4700/5232 (89.8318%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0101, Accuracy: 5512/10000 (55.1200%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5225/5591 (93.4538%)
___Train Local_ResNet_18,  epoch 186, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4996/5591 (89.3579%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.1476, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3610/3837 (94.0839%)
___Train Local_ResNet_18,  epoch 186, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3639/3837 (94.8397%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8870, Accuracy: 5827/10000 (58.2700%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5113/5424 (94.2662%)
___Train Local_ResNet_18,  epoch 186, local model 42, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5004/5424 (92.2566%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.4310, Accuracy: 5006/10000 (50.0600%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4861/5167 (94.0778%)
___Train Local_ResNet_18,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4714/5167 (91.2328%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.2417, Accuracy: 5299/10000 (52.9900%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4238/4456 (95.1077%)
___Train Local_ResNet_18,  epoch 186, local model 66, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4223/4456 (94.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.7830, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4666/4928 (94.6834%)
___Train Local_ResNet_18,  epoch 186, local model 16, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4605/4928 (93.4456%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8600, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4232/4433 (95.4658%)
___Train Local_ResNet_18,  epoch 186, local model 33, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4120/4433 (92.9393%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9517, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3133/3297 (95.0258%)
___Train Local_ResNet_18,  epoch 186, local model 68, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3163/3297 (95.9357%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.6980, Accuracy: 6156/10000 (61.5600%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4426/4716 (93.8507%)
___Train Local_ResNet_18,  epoch 186, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4277/4716 (90.6913%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.9808, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4375/4596 (95.1915%)
___Train Local_ResNet_18,  epoch 186, local model 5, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4321/4596 (94.0165%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.8786, Accuracy: 5791/10000 (57.9100%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4536/4793 (94.6380%)
___Train Local_ResNet_18,  epoch 186, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4459/4793 (93.0315%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0119, Accuracy: 5559/10000 (55.5900%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4132/4416 (93.5688%)
___Train Local_ResNet_18,  epoch 186, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4074/4416 (92.2554%)
___Test Local_ResNet_18 poisoned: False, epoch: 186: Average loss: 2.0163, Accuracy: 5531/10000 (55.3100%)
time spent on training: 235.01976823806763
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 7 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 186: Average loss: 1.5172, Accuracy: 6321/10000 (63.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 186: Average loss: 0.0280, Accuracy: 9824/9900 (99.2323%)
Done in 258.5351502895355 sec.
Server Epoch:187 choose agents : [13, 36, 58, 71, 83, 67, 8, 89, 50, 39, 38, 63, 68, 28, 65, 18, 91, 66, 17, 87].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4806/4885 (98.3828%), train_poison_data_count: 385
Global model norm: 44.82076801123769.
Norm before scaling: 44.7788674784909. Distance: 1.0742163640776061
Total norm for 4 adversaries is: 44.7788674784909. distance: 1.0742163640776061
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0217, Accuracy: 9846/9900 (99.4545%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5200/5305 (98.0207%), train_poison_data_count: 415
Global model norm: 44.82076801123769.
Norm before scaling: 44.77821458004509. Distance: 1.2034488588885208
Total norm for 4 adversaries is: 44.77821458004509. distance: 1.2034488588885208
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0271, Accuracy: 9825/9900 (99.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4608/4717 (97.6892%), train_poison_data_count: 370
Global model norm: 44.82076801123769.
Norm before scaling: 44.78336799335357. Distance: 1.1316370159772393
Total norm for 4 adversaries is: 44.78336799335357. distance: 1.1316370159772393
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0305, Accuracy: 9823/9900 (99.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 187, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4971/5066 (98.1248%), train_poison_data_count: 400
Global model norm: 44.82076801123769.
Norm before scaling: 44.780708900691124. Distance: 1.1579187568370233
Total norm for 4 adversaries is: 44.780708900691124. distance: 1.1579187568370233
___Test Local_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0207, Accuracy: 9849/9900 (99.4848%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3035/3271 (92.7851%)
___Train Local_ResNet_18,  epoch 187, local model 83, internal_epoch   2,  Average loss: 0.0057, Accuracy: 2921/3271 (89.2999%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0686, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4866/5116 (95.1134%)
___Train Local_ResNet_18,  epoch 187, local model 67, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4702/5116 (91.9077%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0061, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4235/4501 (94.0902%)
___Train Local_ResNet_18,  epoch 187, local model 8, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4178/4501 (92.8238%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0608, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4125/4356 (94.6970%)
___Train Local_ResNet_18,  epoch 187, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3922/4356 (90.0367%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3332, Accuracy: 5109/10000 (51.0900%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4065/4368 (93.0632%)
___Train Local_ResNet_18,  epoch 187, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3952/4368 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0576, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3634/3837 (94.7094%)
___Train Local_ResNet_18,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0028, Accuracy: 3627/3837 (94.5270%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9915, Accuracy: 5667/10000 (56.6700%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5381/5740 (93.7456%)
___Train Local_ResNet_18,  epoch 187, local model 38, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5281/5740 (92.0035%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.2193, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3427/3590 (95.4596%)
___Train Local_ResNet_18,  epoch 187, local model 63, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3135/3590 (87.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.4732, Accuracy: 5018/10000 (50.1800%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3142/3297 (95.2988%)
___Train Local_ResNet_18,  epoch 187, local model 68, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3112/3297 (94.3888%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.7950, Accuracy: 5922/10000 (59.2200%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4397/4716 (93.2358%)
___Train Local_ResNet_18,  epoch 187, local model 28, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4242/4716 (89.9491%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0312, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4842/5055 (95.7864%)
___Train Local_ResNet_18,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4756/5055 (94.0851%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9219, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3727/3911 (95.2953%)
___Train Local_ResNet_18,  epoch 187, local model 18, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3331/3911 (85.1700%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.3270, Accuracy: 4951/10000 (49.5100%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3839/4158 (92.3280%)
___Train Local_ResNet_18,  epoch 187, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3762/4158 (90.4762%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0422, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4260/4456 (95.6014%)
___Train Local_ResNet_18,  epoch 187, local model 66, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4217/4456 (94.6364%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.9314, Accuracy: 5722/10000 (57.2200%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4211/4511 (93.3496%)
___Train Local_ResNet_18,  epoch 187, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4151/4511 (92.0195%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 2.0515, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3453/3672 (94.0359%)
___Train Local_ResNet_18,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3413/3672 (92.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.8750, Accuracy: 5843/10000 (58.4300%)
time spent on training: 230.17609429359436
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 187: Average loss: 1.5240, Accuracy: 6310/10000 (63.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 187: Average loss: 0.0266, Accuracy: 9829/9900 (99.2828%)
Done in 253.76592373847961 sec.
Server Epoch:188 choose agents : [13, 36, 58, 71, 62, 12, 52, 53, 22, 14, 45, 67, 50, 87, 25, 97, 91, 80, 66, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4807/4885 (98.4033%), train_poison_data_count: 385
Global model norm: 44.83740155411551.
Norm before scaling: 44.79498246569098. Distance: 1.0634202898478604
Total norm for 4 adversaries is: 44.79498246569098. distance: 1.0634202898478604
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0366, Accuracy: 9809/9900 (99.0808%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5175/5305 (97.5495%), train_poison_data_count: 415
Global model norm: 44.83740155411551.
Norm before scaling: 44.79735731777322. Distance: 1.2604531947535977
Total norm for 4 adversaries is: 44.79735731777322. distance: 1.2604531947535977
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0166, Accuracy: 9858/9900 (99.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4606/4717 (97.6468%), train_poison_data_count: 370
Global model norm: 44.83740155411551.
Norm before scaling: 44.79838597251231. Distance: 1.083508471245914
Total norm for 4 adversaries is: 44.79838597251231. distance: 1.083508471245914
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0443, Accuracy: 9790/9900 (98.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 188, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4969/5066 (98.0853%), train_poison_data_count: 400
Global model norm: 44.83740155411551.
Norm before scaling: 44.79607657554956. Distance: 1.1385276009451917
Total norm for 4 adversaries is: 44.79607657554956. distance: 1.1385276009451917
___Test Local_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0606, Accuracy: 9747/9900 (98.4545%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4724/5063 (93.3044%)
___Train Local_ResNet_18,  epoch 188, local model 62, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4582/5063 (90.4997%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.2786, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4761/5083 (93.6652%)
___Train Local_ResNet_18,  epoch 188, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4525/5083 (89.0222%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3397, Accuracy: 5043/10000 (50.4300%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3598/3797 (94.7590%)
___Train Local_ResNet_18,  epoch 188, local model 52, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3545/3797 (93.3632%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9282, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5664/6124 (92.4886%)
___Train Local_ResNet_18,  epoch 188, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 5463/6124 (89.2064%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0298, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4848/5232 (92.6606%)
___Train Local_ResNet_18,  epoch 188, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4742/5232 (90.6346%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0504, Accuracy: 5458/10000 (54.5800%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3679/3861 (95.2862%)
___Train Local_ResNet_18,  epoch 188, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3539/3861 (91.6602%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9331, Accuracy: 5718/10000 (57.1800%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4651/5037 (92.3367%)
___Train Local_ResNet_18,  epoch 188, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4604/5037 (91.4036%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0138, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4878/5116 (95.3479%)
___Train Local_ResNet_18,  epoch 188, local model 67, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4722/5116 (92.2987%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9331, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4083/4368 (93.4753%)
___Train Local_ResNet_18,  epoch 188, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3918/4368 (89.6978%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1441, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3437/3672 (93.6002%)
___Train Local_ResNet_18,  epoch 188, local model 87, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3378/3672 (91.9935%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9492, Accuracy: 5710/10000 (57.1000%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5475/5902 (92.7652%)
___Train Local_ResNet_18,  epoch 188, local model 25, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5241/5902 (88.8004%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.3033, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4061/4361 (93.1208%)
___Train Local_ResNet_18,  epoch 188, local model 97, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4039/4361 (92.6164%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.9947, Accuracy: 5669/10000 (56.6900%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3808/4158 (91.5825%)
___Train Local_ResNet_18,  epoch 188, local model 91, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3729/4158 (89.6825%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.1016, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4734/5025 (94.2090%)
___Train Local_ResNet_18,  epoch 188, local model 80, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4693/5025 (93.3930%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 2.0614, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4254/4456 (95.4668%)
___Train Local_ResNet_18,  epoch 188, local model 66, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4200/4456 (94.2549%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8423, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4221/4433 (95.2177%)
___Train Local_ResNet_18,  epoch 188, local model 33, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4144/4433 (93.4807%)
___Test Local_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.8540, Accuracy: 5823/10000 (58.2300%)
time spent on training: 255.93210744857788
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 18 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 188: Average loss: 1.5370, Accuracy: 6289/10000 (62.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 188: Average loss: 0.0259, Accuracy: 9831/9900 (99.3030%)
Done in 283.9376537799835 sec.
Server Epoch:189 choose agents : [13, 36, 58, 71, 78, 19, 31, 74, 52, 54, 22, 40, 28, 96, 92, 3, 66, 25, 7, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4811/4885 (98.4852%), train_poison_data_count: 385
Global model norm: 44.856849676394184.
Norm before scaling: 44.814402690168286. Distance: 1.0507523202990758
Total norm for 4 adversaries is: 44.814402690168286. distance: 1.0507523202990758
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0744, Accuracy: 9704/9900 (98.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5179/5305 (97.6249%), train_poison_data_count: 415
Global model norm: 44.856849676394184.
Norm before scaling: 44.814571572149525. Distance: 1.2148272645083225
Total norm for 4 adversaries is: 44.814571572149525. distance: 1.2148272645083225
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0180, Accuracy: 9854/9900 (99.5354%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4623/4717 (98.0072%), train_poison_data_count: 370
Global model norm: 44.856849676394184.
Norm before scaling: 44.81674110422494. Distance: 1.0604572855446472
Total norm for 4 adversaries is: 44.81674110422494. distance: 1.0604572855446472
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0202, Accuracy: 9850/9900 (99.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 189, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4956/5066 (97.8287%), train_poison_data_count: 400
Global model norm: 44.856849676394184.
Norm before scaling: 44.81676017058239. Distance: 1.1771587021365764
Total norm for 4 adversaries is: 44.81676017058239. distance: 1.1771587021365764
___Test Local_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0762, Accuracy: 9692/9900 (97.8990%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3834/4025 (95.2547%)
___Train Local_ResNet_18,  epoch 189, local model 78, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3839/4025 (95.3789%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.7627, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4557/4928 (92.4716%)
___Train Local_ResNet_18,  epoch 189, local model 19, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4413/4928 (89.5495%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1499, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3923/4175 (93.9641%)
___Train Local_ResNet_18,  epoch 189, local model 31, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3804/4175 (91.1138%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2542, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4129/4416 (93.5009%)
___Train Local_ResNet_18,  epoch 189, local model 74, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4058/4416 (91.8931%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0360, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3612/3797 (95.1277%)
___Train Local_ResNet_18,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3578/3797 (94.2323%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9218, Accuracy: 5862/10000 (58.6200%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4867/5195 (93.6862%)
___Train Local_ResNet_18,  epoch 189, local model 54, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4679/5195 (90.0674%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2623, Accuracy: 5267/10000 (52.6700%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4878/5232 (93.2339%)
___Train Local_ResNet_18,  epoch 189, local model 22, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4776/5232 (91.2844%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0747, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5119/5455 (93.8405%)
___Train Local_ResNet_18,  epoch 189, local model 40, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4961/5455 (90.9441%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1689, Accuracy: 5334/10000 (53.3400%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4359/4716 (92.4300%)
___Train Local_ResNet_18,  epoch 189, local model 28, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4244/4716 (89.9915%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0706, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4436/4679 (94.8066%)
___Train Local_ResNet_18,  epoch 189, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4240/4679 (90.6177%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1002, Accuracy: 5413/10000 (54.1300%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5903/6263 (94.2520%)
___Train Local_ResNet_18,  epoch 189, local model 92, internal_epoch   2,  Average loss: 0.0039, Accuracy: 5755/6263 (91.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.2285, Accuracy: 5301/10000 (53.0100%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4671/4918 (94.9776%)
___Train Local_ResNet_18,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4590/4918 (93.3306%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.9672, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4263/4456 (95.6688%)
___Train Local_ResNet_18,  epoch 189, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4157/4456 (93.2899%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.0989, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5530/5902 (93.6971%)
___Train Local_ResNet_18,  epoch 189, local model 25, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5210/5902 (88.2752%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.5537, Accuracy: 4851/10000 (48.5100%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4192/4481 (93.5505%)
___Train Local_ResNet_18,  epoch 189, local model 7, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3999/4481 (89.2435%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.1462, Accuracy: 5436/10000 (54.3600%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5198/5591 (92.9708%)
___Train Local_ResNet_18,  epoch 189, local model 32, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4982/5591 (89.1075%)
___Test Local_ResNet_18 poisoned: False, epoch: 189: Average loss: 2.3624, Accuracy: 5113/10000 (51.1300%)
time spent on training: 239.66896510124207
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 4 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 189: Average loss: 1.5438, Accuracy: 6285/10000 (62.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 189: Average loss: 0.0267, Accuracy: 9832/9900 (99.3131%)
Done in 262.73615860939026 sec.
Server Epoch:190 choose agents : [13, 36, 58, 71, 8, 12, 60, 26, 31, 88, 41, 89, 11, 0, 98, 6, 76, 44, 52, 21].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4803/4885 (98.3214%), train_poison_data_count: 385
Global model norm: 44.87697484338433.
Norm before scaling: 44.83708438047893. Distance: 1.141648342978642
Total norm for 4 adversaries is: 44.83708438047893. distance: 1.141648342978642
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0216, Accuracy: 9851/9900 (99.5051%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5177/5305 (97.5872%), train_poison_data_count: 415
Global model norm: 44.87697484338433.
Norm before scaling: 44.83569722992774. Distance: 1.2210027464321032
Total norm for 4 adversaries is: 44.83569722992774. distance: 1.2210027464321032
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.1127, Accuracy: 9611/9900 (97.0808%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4617/4717 (97.8800%), train_poison_data_count: 370
Global model norm: 44.87697484338433.
Norm before scaling: 44.83832447579721. Distance: 1.1012735731912113
Total norm for 4 adversaries is: 44.83832447579721. distance: 1.1012735731912113
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0380, Accuracy: 9799/9900 (98.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 190, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4961/5066 (97.9274%), train_poison_data_count: 400
Global model norm: 44.87697484338433.
Norm before scaling: 44.837125218412055. Distance: 1.1703440520613213
Total norm for 4 adversaries is: 44.837125218412055. distance: 1.1703440520613213
___Test Local_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0378, Accuracy: 9810/9900 (99.0909%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4186/4501 (93.0016%)
___Train Local_ResNet_18,  epoch 190, local model 8, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4092/4501 (90.9131%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9574, Accuracy: 5607/10000 (56.0700%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4803/5083 (94.4914%)
___Train Local_ResNet_18,  epoch 190, local model 12, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4664/5083 (91.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9477, Accuracy: 5561/10000 (55.6100%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3590/3804 (94.3743%)
___Train Local_ResNet_18,  epoch 190, local model 60, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3574/3804 (93.9537%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8556, Accuracy: 5864/10000 (58.6400%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3599/3756 (95.8200%)
___Train Local_ResNet_18,  epoch 190, local model 26, internal_epoch   2,  Average loss: 0.0022, Accuracy: 3614/3756 (96.2194%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.7918, Accuracy: 5989/10000 (59.8900%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3926/4175 (94.0359%)
___Train Local_ResNet_18,  epoch 190, local model 31, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3917/4175 (93.8204%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9866, Accuracy: 5699/10000 (56.9900%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4634/4934 (93.9197%)
___Train Local_ResNet_18,  epoch 190, local model 88, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4152/4934 (84.1508%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.3310, Accuracy: 4955/10000 (49.5500%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4036/4336 (93.0812%)
___Train Local_ResNet_18,  epoch 190, local model 41, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3985/4336 (91.9050%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1106, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4129/4356 (94.7888%)
___Train Local_ResNet_18,  epoch 190, local model 89, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3802/4356 (87.2819%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.9359, Accuracy: 4417/10000 (44.1700%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4839/5244 (92.2769%)
___Train Local_ResNet_18,  epoch 190, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4646/5244 (88.5965%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.1141, Accuracy: 5357/10000 (53.5700%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4775/5017 (95.1764%)
___Train Local_ResNet_18,  epoch 190, local model 0, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4652/5017 (92.7247%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.9086, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3670/3828 (95.8725%)
___Train Local_ResNet_18,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3616/3828 (94.4619%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8088, Accuracy: 5887/10000 (58.8700%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4322/4538 (95.2402%)
___Train Local_ResNet_18,  epoch 190, local model 6, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4318/4538 (95.1520%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8080, Accuracy: 5953/10000 (59.5300%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3416/3638 (93.8977%)
___Train Local_ResNet_18,  epoch 190, local model 76, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3392/3638 (93.2380%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8218, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4406/4662 (94.5088%)
___Train Local_ResNet_18,  epoch 190, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4356/4662 (93.4363%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 2.0302, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3646/3797 (96.0232%)
___Train Local_ResNet_18,  epoch 190, local model 52, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3592/3797 (94.6010%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8387, Accuracy: 5879/10000 (58.7900%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4347/4634 (93.8066%)
___Train Local_ResNet_18,  epoch 190, local model 21, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4271/4634 (92.1666%)
___Test Local_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.8606, Accuracy: 5769/10000 (57.6900%)
time spent on training: 231.52196216583252
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 17 ranked 1 as suspicious. Assigned small weight: 0.1
Client 12 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 190: Average loss: 1.5543, Accuracy: 6254/10000 (62.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 190: Average loss: 0.0259, Accuracy: 9833/9900 (99.3232%)
Done in 254.73368287086487 sec.
Server Epoch:191 choose agents : [13, 36, 58, 71, 31, 99, 3, 45, 79, 21, 43, 14, 53, 27, 12, 89, 84, 65, 90, 33].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4808/4885 (98.4237%), train_poison_data_count: 385
Global model norm: 44.89340809985707.
Norm before scaling: 44.85109505395674. Distance: 1.0641768630716004
Total norm for 4 adversaries is: 44.85109505395674. distance: 1.0641768630716004
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0295, Accuracy: 9826/9900 (99.2525%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5172/5305 (97.4929%), train_poison_data_count: 415
Global model norm: 44.89340809985707.
Norm before scaling: 44.85275796939289. Distance: 1.2786230278182662
Total norm for 4 adversaries is: 44.85275796939289. distance: 1.2786230278182662
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0078, Accuracy: 9878/9900 (99.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4618/4717 (97.9012%), train_poison_data_count: 370
Global model norm: 44.89340809985707.
Norm before scaling: 44.852072126306915. Distance: 1.00880991940942
Total norm for 4 adversaries is: 44.852072126306915. distance: 1.00880991940942
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0250, Accuracy: 9834/9900 (99.3333%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 191, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4960/5066 (97.9076%), train_poison_data_count: 400
Global model norm: 44.89340809985707.
Norm before scaling: 44.8546045225571. Distance: 1.2026287392999342
Total norm for 4 adversaries is: 44.8546045225571. distance: 1.2026287392999342
___Test Local_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0384, Accuracy: 9801/9900 (99.0000%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3953/4175 (94.6826%)
___Train Local_ResNet_18,  epoch 191, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3785/4175 (90.6587%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2960, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4239/4465 (94.9384%)
___Train Local_ResNet_18,  epoch 191, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4164/4465 (93.2587%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8054, Accuracy: 5915/10000 (59.1500%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4645/4918 (94.4490%)
___Train Local_ResNet_18,  epoch 191, local model 3, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4546/4918 (92.4359%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1169, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4667/5037 (92.6544%)
___Train Local_ResNet_18,  epoch 191, local model 45, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4676/5037 (92.8330%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9294, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3626/3781 (95.9006%)
___Train Local_ResNet_18,  epoch 191, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3426/3781 (90.6109%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2937, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4361/4634 (94.1088%)
___Train Local_ResNet_18,  epoch 191, local model 21, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4291/4634 (92.5982%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.7898, Accuracy: 5914/10000 (59.1400%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4325/4576 (94.5149%)
___Train Local_ResNet_18,  epoch 191, local model 43, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4251/4576 (92.8977%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0304, Accuracy: 5688/10000 (56.8800%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3666/3861 (94.9495%)
___Train Local_ResNet_18,  epoch 191, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3503/3861 (90.7278%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1243, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5677/6124 (92.7008%)
___Train Local_ResNet_18,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5483/6124 (89.5330%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2545, Accuracy: 5262/10000 (52.6200%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4018/4223 (95.1456%)
___Train Local_ResNet_18,  epoch 191, local model 27, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4014/4223 (95.0509%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.8642, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4745/5083 (93.3504%)
___Train Local_ResNet_18,  epoch 191, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4596/5083 (90.4190%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2259, Accuracy: 5221/10000 (52.2100%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4106/4356 (94.2608%)
___Train Local_ResNet_18,  epoch 191, local model 89, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3996/4356 (91.7355%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.2860, Accuracy: 5271/10000 (52.7100%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4506/4793 (94.0121%)
___Train Local_ResNet_18,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4455/4793 (92.9480%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.0757, Accuracy: 5503/10000 (55.0300%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4791/5055 (94.7774%)
___Train Local_ResNet_18,  epoch 191, local model 65, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4661/5055 (92.2057%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9408, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4169/4362 (95.5754%)
___Train Local_ResNet_18,  epoch 191, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4001/4362 (91.7240%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 2.1737, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4219/4433 (95.1726%)
___Train Local_ResNet_18,  epoch 191, local model 33, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4190/4433 (94.5184%)
___Test Local_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.9153, Accuracy: 5838/10000 (58.3800%)
time spent on training: 258.74348282814026
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 10 ranked 1 as suspicious. Assigned small weight: 0.1
Client 9 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 191: Average loss: 1.5647, Accuracy: 6237/10000 (62.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 191: Average loss: 0.0256, Accuracy: 9834/9900 (99.3333%)
Done in 285.66826033592224 sec.
Server Epoch:192 choose agents : [13, 36, 58, 71, 80, 48, 32, 7, 72, 65, 34, 95, 84, 12, 11, 92, 31, 74, 9, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4800/4885 (98.2600%), train_poison_data_count: 385
Global model norm: 44.911106046155915.
Norm before scaling: 44.8682533229231. Distance: 1.0826523853727963
Total norm for 4 adversaries is: 44.8682533229231. distance: 1.0826523853727963
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0162, Accuracy: 9865/9900 (99.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5189/5305 (97.8134%), train_poison_data_count: 415
Global model norm: 44.911106046155915.
Norm before scaling: 44.866852172044844. Distance: 1.168874893043243
Total norm for 4 adversaries is: 44.866852172044844. distance: 1.168874893043243
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0413, Accuracy: 9790/9900 (98.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4605/4717 (97.6256%), train_poison_data_count: 370
Global model norm: 44.911106046155915.
Norm before scaling: 44.87096299738284. Distance: 1.09587272650595
Total norm for 4 adversaries is: 44.87096299738284. distance: 1.09587272650595
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0330, Accuracy: 9821/9900 (99.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 192, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4951/5066 (97.7300%), train_poison_data_count: 400
Global model norm: 44.911106046155915.
Norm before scaling: 44.873020989179146. Distance: 1.2456407829850449
Total norm for 4 adversaries is: 44.873020989179146. distance: 1.2456407829850449
___Test Local_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0150, Accuracy: 9855/9900 (99.5455%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4702/5025 (93.5721%)
___Train Local_ResNet_18,  epoch 192, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4599/5025 (91.5224%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2318, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4219/4441 (95.0011%)
___Train Local_ResNet_18,  epoch 192, local model 48, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4147/4441 (93.3799%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9788, Accuracy: 5680/10000 (56.8000%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5213/5591 (93.2391%)
___Train Local_ResNet_18,  epoch 192, local model 32, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5025/5591 (89.8766%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0673, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4246/4481 (94.7556%)
___Train Local_ResNet_18,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4089/4481 (91.2520%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0936, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4440/4767 (93.1403%)
___Train Local_ResNet_18,  epoch 192, local model 72, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4312/4767 (90.4552%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.4778, Accuracy: 5008/10000 (50.0800%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4768/5055 (94.3225%)
___Train Local_ResNet_18,  epoch 192, local model 65, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4676/5055 (92.5025%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0686, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4283/4518 (94.7986%)
___Train Local_ResNet_18,  epoch 192, local model 34, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4275/4518 (94.6215%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8643, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4308/4625 (93.1459%)
___Train Local_ResNet_18,  epoch 192, local model 95, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4162/4625 (89.9892%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1296, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4539/4793 (94.7006%)
___Train Local_ResNet_18,  epoch 192, local model 84, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4479/4793 (93.4488%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9753, Accuracy: 5724/10000 (57.2400%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4774/5083 (93.9209%)
___Train Local_ResNet_18,  epoch 192, local model 12, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4626/5083 (91.0092%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0661, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4842/5244 (92.3341%)
___Train Local_ResNet_18,  epoch 192, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4594/5244 (87.6049%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.2095, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5863/6263 (93.6133%)
___Train Local_ResNet_18,  epoch 192, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.1200, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3950/4175 (94.6108%)
___Train Local_ResNet_18,  epoch 192, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3864/4175 (92.5509%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.9434, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4095/4416 (92.7310%)
___Train Local_ResNet_18,  epoch 192, local model 74, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4061/4416 (91.9611%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 2.0367, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4914/5265 (93.3333%)
___Train Local_ResNet_18,  epoch 192, local model 9, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4827/5265 (91.6809%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8917, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3821/4025 (94.9317%)
___Train Local_ResNet_18,  epoch 192, local model 78, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3842/4025 (95.4534%)
___Test Local_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.8311, Accuracy: 5885/10000 (58.8500%)
time spent on training: 241.24379706382751
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 6 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 192: Average loss: 1.5673, Accuracy: 6237/10000 (62.3700%)
___Test Target_ResNet_18 poisoned: True, epoch: 192: Average loss: 0.0237, Accuracy: 9837/9900 (99.3636%)
Done in 264.3874292373657 sec.
Server Epoch:193 choose agents : [13, 36, 58, 71, 75, 27, 84, 47, 40, 93, 39, 48, 76, 73, 90, 52, 91, 61, 54, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4808/4885 (98.4237%), train_poison_data_count: 385
Global model norm: 44.93011065810989.
Norm before scaling: 44.88722440783193. Distance: 1.0670227392753522
Total norm for 4 adversaries is: 44.88722440783193. distance: 1.0670227392753522
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0368, Accuracy: 9817/9900 (99.1616%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5185/5305 (97.7380%), train_poison_data_count: 415
Global model norm: 44.93011065810989.
Norm before scaling: 44.88529760852934. Distance: 1.1695058652968027
Total norm for 4 adversaries is: 44.88529760852934. distance: 1.1695058652968027
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0599, Accuracy: 9766/9900 (98.6465%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4618/4717 (97.9012%), train_poison_data_count: 370
Global model norm: 44.93011065810989.
Norm before scaling: 44.89049311458176. Distance: 1.0744458877407383
Total norm for 4 adversaries is: 44.89049311458176. distance: 1.0744458877407383
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0496, Accuracy: 9772/9900 (98.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 193, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4961/5066 (97.9274%), train_poison_data_count: 400
Global model norm: 44.93011065810989.
Norm before scaling: 44.89008249976756. Distance: 1.1872615072785542
Total norm for 4 adversaries is: 44.89008249976756. distance: 1.1872615072785542
___Test Local_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0153, Accuracy: 9862/9900 (99.6162%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4039/4295 (94.0396%)
___Train Local_ResNet_18,  epoch 193, local model 75, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4012/4295 (93.4109%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9945, Accuracy: 5681/10000 (56.8100%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4018/4223 (95.1456%)
___Train Local_ResNet_18,  epoch 193, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3971/4223 (94.0327%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9406, Accuracy: 5693/10000 (56.9300%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4520/4793 (94.3042%)
___Train Local_ResNet_18,  epoch 193, local model 84, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4451/4793 (92.8646%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9727, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4419/4707 (93.8815%)
___Train Local_ResNet_18,  epoch 193, local model 47, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4398/4707 (93.4353%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9221, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5137/5455 (94.1705%)
___Train Local_ResNet_18,  epoch 193, local model 40, internal_epoch   2,  Average loss: 0.0035, Accuracy: 5071/5455 (92.9606%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1122, Accuracy: 5403/10000 (54.0300%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4410/4651 (94.8183%)
___Train Local_ResNet_18,  epoch 193, local model 93, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4270/4651 (91.8082%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.0780, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3653/3837 (95.2046%)
___Train Local_ResNet_18,  epoch 193, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3614/3837 (94.1882%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9500, Accuracy: 5707/10000 (57.0700%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4242/4441 (95.5190%)
___Train Local_ResNet_18,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4137/4441 (93.1547%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1185, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3407/3638 (93.6504%)
___Train Local_ResNet_18,  epoch 193, local model 76, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3409/3638 (93.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7734, Accuracy: 5811/10000 (58.1100%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4030/4235 (95.1594%)
___Train Local_ResNet_18,  epoch 193, local model 73, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3969/4235 (93.7190%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9431, Accuracy: 5810/10000 (58.1000%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4153/4362 (95.2086%)
___Train Local_ResNet_18,  epoch 193, local model 90, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4133/4362 (94.7501%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9536, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3640/3797 (95.8652%)
___Train Local_ResNet_18,  epoch 193, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3581/3797 (94.3113%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.9568, Accuracy: 5747/10000 (57.4700%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3853/4158 (92.6647%)
___Train Local_ResNet_18,  epoch 193, local model 91, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3718/4158 (89.4180%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1930, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3914/4126 (94.8619%)
___Train Local_ResNet_18,  epoch 193, local model 61, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3867/4126 (93.7227%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.7754, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4881/5195 (93.9557%)
___Train Local_ResNet_18,  epoch 193, local model 54, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4678/5195 (90.0481%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 2.1439, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3834/4046 (94.7603%)
___Train Local_ResNet_18,  epoch 193, local model 59, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3818/4046 (94.3648%)
___Test Local_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.8050, Accuracy: 5913/10000 (59.1300%)
time spent on training: 231.71364951133728
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 15 ranked 1 as suspicious. Assigned small weight: 0.1
Client 16 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 193: Average loss: 1.5705, Accuracy: 6223/10000 (62.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 193: Average loss: 0.0252, Accuracy: 9832/9900 (99.3131%)
Done in 254.9737904071808 sec.
Server Epoch:194 choose agents : [13, 36, 58, 71, 97, 68, 28, 35, 50, 96, 89, 25, 14, 55, 92, 73, 22, 0, 94, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4812/4885 (98.5056%), train_poison_data_count: 385
Global model norm: 44.94583735896393.
Norm before scaling: 44.90316730024453. Distance: 1.0691577780382087
Total norm for 4 adversaries is: 44.90316730024453. distance: 1.0691577780382087
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0627, Accuracy: 9742/9900 (98.4040%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5203/5305 (98.0773%), train_poison_data_count: 415
Global model norm: 44.94583735896393.
Norm before scaling: 44.90098019487924. Distance: 1.160551729452123
Total norm for 4 adversaries is: 44.90098019487924. distance: 1.160551729452123
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0561, Accuracy: 9759/9900 (98.5758%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4615/4717 (97.8376%), train_poison_data_count: 370
Global model norm: 44.94583735896393.
Norm before scaling: 44.90657619923278. Distance: 1.073246852597345
Total norm for 4 adversaries is: 44.90657619923278. distance: 1.073246852597345
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0211, Accuracy: 9844/9900 (99.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 194, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 44.94583735896393.
Norm before scaling: 44.90680861474057. Distance: 1.220200922086324
Total norm for 4 adversaries is: 44.90680861474057. distance: 1.220200922086324
___Test Local_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0129, Accuracy: 9868/9900 (99.6768%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4144/4361 (95.0241%)
___Train Local_ResNet_18,  epoch 194, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3949/4361 (90.5526%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0520, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3164/3297 (95.9660%)
___Train Local_ResNet_18,  epoch 194, local model 68, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3128/3297 (94.8741%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.6556, Accuracy: 6162/10000 (61.6200%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4419/4716 (93.7023%)
___Train Local_ResNet_18,  epoch 194, local model 28, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4300/4716 (91.1790%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0489, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4856/5167 (93.9810%)
___Train Local_ResNet_18,  epoch 194, local model 35, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4817/5167 (93.2262%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1729, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4101/4368 (93.8874%)
___Train Local_ResNet_18,  epoch 194, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3934/4368 (90.0641%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1811, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4443/4679 (94.9562%)
___Train Local_ResNet_18,  epoch 194, local model 96, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4262/4679 (91.0878%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0091, Accuracy: 5541/10000 (55.4100%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4099/4356 (94.1001%)
___Train Local_ResNet_18,  epoch 194, local model 89, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3778/4356 (86.7309%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.5313, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5540/5902 (93.8665%)
___Train Local_ResNet_18,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5203/5902 (88.1566%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2224, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3680/3861 (95.3121%)
___Train Local_ResNet_18,  epoch 194, local model 14, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3595/3861 (93.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.9904, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4122/4356 (94.6281%)
___Train Local_ResNet_18,  epoch 194, local model 55, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3849/4356 (88.3609%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2071, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5889/6263 (94.0284%)
___Train Local_ResNet_18,  epoch 194, local model 92, internal_epoch   2,  Average loss: 0.0041, Accuracy: 5752/6263 (91.8410%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1014, Accuracy: 5405/10000 (54.0500%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3999/4235 (94.4274%)
___Train Local_ResNet_18,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3819/4235 (90.1771%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0611, Accuracy: 5536/10000 (55.3600%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4912/5232 (93.8838%)
___Train Local_ResNet_18,  epoch 194, local model 22, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4775/5232 (91.2653%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.2572, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4709/5017 (93.8609%)
___Train Local_ResNet_18,  epoch 194, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4586/5017 (91.4092%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.0241, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4518/4804 (94.0466%)
___Train Local_ResNet_18,  epoch 194, local model 94, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4304/4804 (89.5920%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 2.1206, Accuracy: 5399/10000 (53.9900%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4572/4793 (95.3891%)
___Train Local_ResNet_18,  epoch 194, local model 84, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4516/4793 (94.2207%)
___Test Local_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.8862, Accuracy: 5787/10000 (57.8700%)
time spent on training: 235.97659420967102
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 14 ranked 1 as suspicious. Assigned small weight: 0.1
Client 6 ranked 2 as suspicious. Assigned small weight: 0.1
Client 19 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 194: Average loss: 1.5680, Accuracy: 6231/10000 (62.3100%)
___Test Target_ResNet_18 poisoned: True, epoch: 194: Average loss: 0.0246, Accuracy: 9835/9900 (99.3434%)
Done in 259.2467393875122 sec.
Server Epoch:195 choose agents : [13, 36, 58, 71, 39, 14, 31, 48, 41, 59, 46, 81, 86, 43, 27, 64, 63, 47, 69, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4798/4885 (98.2190%), train_poison_data_count: 385
Global model norm: 44.964483868608035.
Norm before scaling: 44.92206385829866. Distance: 1.0856477639068765
Total norm for 4 adversaries is: 44.92206385829866. distance: 1.0856477639068765
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0350, Accuracy: 9813/9900 (99.1212%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5154/5305 (97.1536%), train_poison_data_count: 415
Global model norm: 44.964483868608035.
Norm before scaling: 44.92355567508195. Distance: 1.3129591819798614
Total norm for 4 adversaries is: 44.92355567508195. distance: 1.3129591819798614
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0170, Accuracy: 9857/9900 (99.5657%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4601/4717 (97.5408%), train_poison_data_count: 370
Global model norm: 44.964483868608035.
Norm before scaling: 44.92367659430826. Distance: 1.0820320212020604
Total norm for 4 adversaries is: 44.92367659430826. distance: 1.0820320212020604
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0081, Accuracy: 9880/9900 (99.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 195, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 44.964483868608035.
Norm before scaling: 44.924887127275426. Distance: 1.2136051941753574
Total norm for 4 adversaries is: 44.924887127275426. distance: 1.2136051941753574
___Test Local_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0409, Accuracy: 9797/9900 (98.9596%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3660/3837 (95.3870%)
___Train Local_ResNet_18,  epoch 195, local model 39, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3617/3837 (94.2664%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8680, Accuracy: 5753/10000 (57.5300%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3681/3861 (95.3380%)
___Train Local_ResNet_18,  epoch 195, local model 14, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3653/3861 (94.6128%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9088, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3953/4175 (94.6826%)
___Train Local_ResNet_18,  epoch 195, local model 31, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3824/4175 (91.5928%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9403, Accuracy: 5653/10000 (56.5300%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4292/4441 (96.6449%)
___Train Local_ResNet_18,  epoch 195, local model 48, internal_epoch   2,  Average loss: 0.0023, Accuracy: 4252/4441 (95.7442%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8508, Accuracy: 5925/10000 (59.2500%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4062/4336 (93.6808%)
___Train Local_ResNet_18,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3993/4336 (92.0895%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2157, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3802/4046 (93.9694%)
___Train Local_ResNet_18,  epoch 195, local model 59, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3798/4046 (93.8705%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9093, Accuracy: 5779/10000 (57.7900%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4631/4956 (93.4423%)
___Train Local_ResNet_18,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4469/4956 (90.1735%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.1231, Accuracy: 5362/10000 (53.6200%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4405/4618 (95.3876%)
___Train Local_ResNet_18,  epoch 195, local model 81, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4068/4618 (88.0901%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.2663, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3402/3616 (94.0819%)
___Train Local_ResNet_18,  epoch 195, local model 86, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3389/3616 (93.7223%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8792, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4337/4576 (94.7771%)
___Train Local_ResNet_18,  epoch 195, local model 43, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4248/4576 (92.8322%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 2.0806, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3986/4223 (94.3879%)
___Train Local_ResNet_18,  epoch 195, local model 27, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3933/4223 (93.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9656, Accuracy: 5723/10000 (57.2300%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4290/4503 (95.2698%)
___Train Local_ResNet_18,  epoch 195, local model 64, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4202/4503 (93.3156%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9556, Accuracy: 5774/10000 (57.7400%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3421/3590 (95.2925%)
___Train Local_ResNet_18,  epoch 195, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3368/3590 (93.8162%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.9095, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4460/4707 (94.7525%)
___Train Local_ResNet_18,  epoch 195, local model 47, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4367/4707 (92.7767%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8684, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3784/4013 (94.2935%)
___Train Local_ResNet_18,  epoch 195, local model 69, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3790/4013 (94.4431%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.8266, Accuracy: 5838/10000 (58.3800%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3517/3704 (94.9514%)
___Train Local_ResNet_18,  epoch 195, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3489/3704 (94.1955%)
___Test Local_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.7998, Accuracy: 5983/10000 (59.8300%)
time spent on training: 229.2417516708374
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 13 ranked 1 as suspicious. Assigned small weight: 0.1
Client 14 ranked 2 as suspicious. Assigned small weight: 0.1
Client 8 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 195: Average loss: 1.5807, Accuracy: 6186/10000 (61.8600%)
___Test Target_ResNet_18 poisoned: True, epoch: 195: Average loss: 0.0230, Accuracy: 9839/9900 (99.3838%)
Done in 253.0989863872528 sec.
Server Epoch:196 choose agents : [13, 36, 58, 71, 5, 89, 75, 21, 72, 27, 59, 12, 90, 10, 68, 33, 9, 1, 77, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4796/4885 (98.1781%), train_poison_data_count: 385
Global model norm: 44.97936131534037.
Norm before scaling: 44.93883918814687. Distance: 1.1417634586504064
Total norm for 4 adversaries is: 44.93883918814687. distance: 1.1417634586504064
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0244, Accuracy: 9843/9900 (99.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 36, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5174/5305 (97.5306%), train_poison_data_count: 415
Global model norm: 44.97936131534037.
Norm before scaling: 44.93850779033362. Distance: 1.28337014793667
Total norm for 4 adversaries is: 44.93850779033362. distance: 1.28337014793667
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0214, Accuracy: 9846/9900 (99.4545%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4619/4717 (97.9224%), train_poison_data_count: 370
Global model norm: 44.97936131534037.
Norm before scaling: 44.93762495636312. Distance: 0.9990665131918756
Total norm for 4 adversaries is: 44.93762495636312. distance: 0.9990665131918756
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0197, Accuracy: 9844/9900 (99.4343%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 196, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4964/5066 (97.9866%), train_poison_data_count: 400
Global model norm: 44.97936131534037.
Norm before scaling: 44.94061837233106. Distance: 1.2175357344942725
Total norm for 4 adversaries is: 44.94061837233106. distance: 1.2175357344942725
___Test Local_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0334, Accuracy: 9814/9900 (99.1313%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4353/4596 (94.7128%)
___Train Local_ResNet_18,  epoch 196, local model 5, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4269/4596 (92.8851%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1596, Accuracy: 5456/10000 (54.5600%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4105/4356 (94.2378%)
___Train Local_ResNet_18,  epoch 196, local model 89, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3908/4356 (89.7153%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.3540, Accuracy: 5072/10000 (50.7200%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4117/4295 (95.8556%)
___Train Local_ResNet_18,  epoch 196, local model 75, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4001/4295 (93.1548%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9904, Accuracy: 5646/10000 (56.4600%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4353/4634 (93.9361%)
___Train Local_ResNet_18,  epoch 196, local model 21, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4263/4634 (91.9940%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0933, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4403/4767 (92.3642%)
___Train Local_ResNet_18,  epoch 196, local model 72, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4280/4767 (89.7839%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1925, Accuracy: 5372/10000 (53.7200%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4036/4223 (95.5719%)
___Train Local_ResNet_18,  epoch 196, local model 27, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3987/4223 (94.4116%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8299, Accuracy: 5877/10000 (58.7700%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3818/4046 (94.3648%)
___Train Local_ResNet_18,  epoch 196, local model 59, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3794/4046 (93.7716%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8521, Accuracy: 5788/10000 (57.8800%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4759/5083 (93.6258%)
___Train Local_ResNet_18,  epoch 196, local model 12, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4592/5083 (90.3404%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.1919, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4203/4362 (96.3549%)
___Train Local_ResNet_18,  epoch 196, local model 90, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4169/4362 (95.5754%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8119, Accuracy: 5950/10000 (59.5000%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4441/4663 (95.2391%)
___Train Local_ResNet_18,  epoch 196, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4355/4663 (93.3948%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 2.0274, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3140/3297 (95.2381%)
___Train Local_ResNet_18,  epoch 196, local model 68, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3085/3297 (93.5699%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8101, Accuracy: 5900/10000 (59.0000%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4239/4433 (95.6237%)
___Train Local_ResNet_18,  epoch 196, local model 33, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4191/4433 (94.5409%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8167, Accuracy: 5844/10000 (58.4400%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4926/5265 (93.5613%)
___Train Local_ResNet_18,  epoch 196, local model 9, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4786/5265 (90.9022%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9257, Accuracy: 5717/10000 (57.1700%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4729/4986 (94.8456%)
___Train Local_ResNet_18,  epoch 196, local model 1, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4612/4986 (92.4990%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9815, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4378/4647 (94.2113%)
___Train Local_ResNet_18,  epoch 196, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4308/4647 (92.7050%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.9935, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4756/5017 (94.7977%)
___Train Local_ResNet_18,  epoch 196, local model 0, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4636/5017 (92.4058%)
___Test Local_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.8568, Accuracy: 5795/10000 (57.9500%)
time spent on training: 233.92534112930298
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 13 ranked 2 as suspicious. Assigned small weight: 0.1
Client 7 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 196: Average loss: 1.5843, Accuracy: 6190/10000 (61.9000%)
___Test Target_ResNet_18 poisoned: True, epoch: 196: Average loss: 0.0226, Accuracy: 9841/9900 (99.4040%)
Done in 257.08900117874146 sec.
Server Epoch:197 choose agents : [13, 36, 58, 71, 23, 85, 88, 81, 73, 99, 64, 80, 15, 60, 91, 6, 50, 12, 67, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4809/4885 (98.4442%), train_poison_data_count: 385
Global model norm: 44.99601219309607.
Norm before scaling: 44.952514007839426. Distance: 1.069287386972186
Total norm for 4 adversaries is: 44.952514007839426. distance: 1.069287386972186
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0344, Accuracy: 9821/9900 (99.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5198/5305 (97.9830%), train_poison_data_count: 415
Global model norm: 44.99601219309607.
Norm before scaling: 44.95278420317464. Distance: 1.209479112111227
Total norm for 4 adversaries is: 44.95278420317464. distance: 1.209479112111227
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0706, Accuracy: 9725/9900 (98.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4624/4717 (98.0284%), train_poison_data_count: 370
Global model norm: 44.99601219309607.
Norm before scaling: 44.95541954084902. Distance: 1.0620397805200634
Total norm for 4 adversaries is: 44.95541954084902. distance: 1.0620397805200634
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0556, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 197, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4968/5066 (98.0655%), train_poison_data_count: 400
Global model norm: 44.99601219309607.
Norm before scaling: 44.95326213265493. Distance: 1.1348679934631054
Total norm for 4 adversaries is: 44.95326213265493. distance: 1.1348679934631054
___Test Local_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0550, Accuracy: 9758/9900 (98.5657%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3964/4184 (94.7419%)
___Train Local_ResNet_18,  epoch 197, local model 23, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3897/4184 (93.1405%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8562, Accuracy: 5830/10000 (58.3000%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5907/6391 (92.4269%)
___Train Local_ResNet_18,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5565/6391 (87.0756%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2697, Accuracy: 5045/10000 (50.4500%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4604/4934 (93.3117%)
___Train Local_ResNet_18,  epoch 197, local model 88, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4475/4934 (90.6972%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0752, Accuracy: 5504/10000 (55.0400%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4418/4618 (95.6691%)
___Train Local_ResNet_18,  epoch 197, local model 81, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4207/4618 (91.1000%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0768, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4018/4235 (94.8760%)
___Train Local_ResNet_18,  epoch 197, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3905/4235 (92.2078%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0691, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4216/4465 (94.4233%)
___Train Local_ResNet_18,  epoch 197, local model 99, internal_epoch   2,  Average loss: 0.0032, Accuracy: 4191/4465 (93.8634%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8167, Accuracy: 5969/10000 (59.6900%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4244/4503 (94.2483%)
___Train Local_ResNet_18,  epoch 197, local model 64, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4121/4503 (91.5168%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0971, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4725/5025 (94.0299%)
___Train Local_ResNet_18,  epoch 197, local model 80, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4707/5025 (93.6716%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0995, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5271/5582 (94.4285%)
___Train Local_ResNet_18,  epoch 197, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5026/5582 (90.0394%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.2724, Accuracy: 5119/10000 (51.1900%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3636/3804 (95.5836%)
___Train Local_ResNet_18,  epoch 197, local model 60, internal_epoch   2,  Average loss: 0.0026, Accuracy: 3618/3804 (95.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7459, Accuracy: 5974/10000 (59.7400%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3885/4158 (93.4343%)
___Train Local_ResNet_18,  epoch 197, local model 91, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3747/4158 (90.1154%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.9828, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4355/4538 (95.9674%)
___Train Local_ResNet_18,  epoch 197, local model 6, internal_epoch   2,  Average loss: 0.0028, Accuracy: 4284/4538 (94.4028%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.7271, Accuracy: 5980/10000 (59.8000%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4079/4368 (93.3837%)
___Train Local_ResNet_18,  epoch 197, local model 50, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3942/4368 (90.2473%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.3395, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4783/5083 (94.0980%)
___Train Local_ResNet_18,  epoch 197, local model 12, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4632/5083 (91.1273%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.0037, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4872/5116 (95.2306%)
___Train Local_ResNet_18,  epoch 197, local model 67, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4720/5116 (92.2596%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.8925, Accuracy: 5738/10000 (57.3800%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4110/4356 (94.3526%)
___Train Local_ResNet_18,  epoch 197, local model 89, internal_epoch   2,  Average loss: 0.0093, Accuracy: 3674/4356 (84.3434%)
___Test Local_ResNet_18 poisoned: False, epoch: 197: Average loss: 2.6921, Accuracy: 4620/10000 (46.2000%)
time spent on training: 235.35082173347473
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 6 ranked 1 as suspicious. Assigned small weight: 0.1
Client 5 ranked 2 as suspicious. Assigned small weight: 0.1
Client 15 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 197: Average loss: 1.5823, Accuracy: 6200/10000 (62.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 197: Average loss: 0.0239, Accuracy: 9836/9900 (99.3535%)
Done in 258.5421323776245 sec.
Server Epoch:198 choose agents : [13, 36, 58, 71, 92, 33, 87, 40, 80, 81, 47, 90, 56, 12, 77, 50, 37, 72, 44, 94].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4800/4885 (98.2600%), train_poison_data_count: 385
Global model norm: 45.013683357987105.
Norm before scaling: 44.97167212752171. Distance: 1.0992315534267616
Total norm for 4 adversaries is: 44.97167212752171. distance: 1.0992315534267616
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0679, Accuracy: 9730/9900 (98.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5193/5305 (97.8888%), train_poison_data_count: 415
Global model norm: 45.013683357987105.
Norm before scaling: 44.968866725873525. Distance: 1.1788825010583432
Total norm for 4 adversaries is: 44.968866725873525. distance: 1.1788825010583432
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0479, Accuracy: 9783/9900 (98.8182%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4628/4717 (98.1132%), train_poison_data_count: 370
Global model norm: 45.013683357987105.
Norm before scaling: 44.97265472319332. Distance: 1.0490725781158627
Total norm for 4 adversaries is: 44.97265472319332. distance: 1.0490725781158627
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0459, Accuracy: 9770/9900 (98.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 198, local model 71, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4962/5066 (97.9471%), train_poison_data_count: 400
Global model norm: 45.013683357987105.
Norm before scaling: 44.97243893399462. Distance: 1.1875491383073251
Total norm for 4 adversaries is: 44.97243893399462. distance: 1.1875491383073251
___Test Local_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0716, Accuracy: 9718/9900 (98.1616%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5904/6263 (94.2679%)
___Train Local_ResNet_18,  epoch 198, local model 92, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5716/6263 (91.2662%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0526, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4228/4433 (95.3756%)
___Train Local_ResNet_18,  epoch 198, local model 33, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4139/4433 (93.3679%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0175, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3484/3672 (94.8802%)
___Train Local_ResNet_18,  epoch 198, local model 87, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3434/3672 (93.5185%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0799, Accuracy: 5635/10000 (56.3500%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5111/5455 (93.6939%)
___Train Local_ResNet_18,  epoch 198, local model 40, internal_epoch   2,  Average loss: 0.0042, Accuracy: 5007/5455 (91.7874%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0887, Accuracy: 5450/10000 (54.5000%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4727/5025 (94.0697%)
___Train Local_ResNet_18,  epoch 198, local model 80, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4650/5025 (92.5373%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.1224, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4411/4618 (95.5175%)
___Train Local_ResNet_18,  epoch 198, local model 81, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4286/4618 (92.8107%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.2498, Accuracy: 5342/10000 (53.4200%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4471/4707 (94.9862%)
___Train Local_ResNet_18,  epoch 198, local model 47, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4374/4707 (92.9254%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9269, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4195/4362 (96.1715%)
___Train Local_ResNet_18,  epoch 198, local model 90, internal_epoch   2,  Average loss: 0.0030, Accuracy: 4100/4362 (93.9936%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9489, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4619/4989 (92.5837%)
___Train Local_ResNet_18,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4546/4989 (91.1205%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0984, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4837/5083 (95.1603%)
___Train Local_ResNet_18,  epoch 198, local model 12, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4687/5083 (92.2093%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.9189, Accuracy: 5698/10000 (56.9800%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4412/4647 (94.9430%)
___Train Local_ResNet_18,  epoch 198, local model 77, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4306/4647 (92.6619%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.8892, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4070/4368 (93.1777%)
___Train Local_ResNet_18,  epoch 198, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3982/4368 (91.1630%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0094, Accuracy: 5552/10000 (55.5200%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4118/4354 (94.5797%)
___Train Local_ResNet_18,  epoch 198, local model 37, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3751/4354 (86.1507%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.8780, Accuracy: 4460/10000 (44.6000%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4489/4767 (94.1682%)
___Train Local_ResNet_18,  epoch 198, local model 72, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4340/4767 (91.0426%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0854, Accuracy: 5519/10000 (55.1900%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4442/4662 (95.2810%)
___Train Local_ResNet_18,  epoch 198, local model 44, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4337/4662 (93.0287%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.0808, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4474/4804 (93.1307%)
___Train Local_ResNet_18,  epoch 198, local model 94, internal_epoch   2,  Average loss: 0.0092, Accuracy: 3976/4804 (82.7644%)
___Test Local_ResNet_18 poisoned: False, epoch: 198: Average loss: 2.4809, Accuracy: 4923/10000 (49.2300%)
time spent on training: 262.6680414676666
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 7 ranked 2 as suspicious. Assigned small weight: 0.1
Client 9 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 198: Average loss: 1.5922, Accuracy: 6187/10000 (61.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 198: Average loss: 0.0249, Accuracy: 9836/9900 (99.3535%)
Done in 289.72234416007996 sec.
Server Epoch:199 choose agents : [13, 36, 58, 71, 73, 51, 82, 9, 12, 17, 6, 28, 10, 48, 84, 44, 4, 56, 29, 90].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4802/4885 (98.3009%), train_poison_data_count: 385
Global model norm: 45.031723030565495.
Norm before scaling: 44.98935827946913. Distance: 1.0833111846322498
Total norm for 4 adversaries is: 44.98935827946913. distance: 1.0833111846322498
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0443, Accuracy: 9788/9900 (98.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5195/5305 (97.9265%), train_poison_data_count: 415
Global model norm: 45.031723030565495.
Norm before scaling: 44.989297229834285. Distance: 1.242148008858425
Total norm for 4 adversaries is: 44.989297229834285. distance: 1.242148008858425
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0122, Accuracy: 9867/9900 (99.6667%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4619/4717 (97.9224%), train_poison_data_count: 370
Global model norm: 45.031723030565495.
Norm before scaling: 44.99119379980098. Distance: 1.0593748694675782
Total norm for 4 adversaries is: 44.99119379980098. distance: 1.0593748694675782
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0536, Accuracy: 9771/9900 (98.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 199, local model 71, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4953/5066 (97.7694%), train_poison_data_count: 400
Global model norm: 45.031723030565495.
Norm before scaling: 44.99165097244779. Distance: 1.206223201948168
Total norm for 4 adversaries is: 44.99165097244779. distance: 1.206223201948168
___Test Local_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0380, Accuracy: 9800/9900 (98.9899%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4013/4235 (94.7580%)
___Train Local_ResNet_18,  epoch 199, local model 73, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3985/4235 (94.0968%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9312, Accuracy: 5803/10000 (58.0300%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3574/3775 (94.6755%)
___Train Local_ResNet_18,  epoch 199, local model 51, internal_epoch   2,  Average loss: 0.0025, Accuracy: 3605/3775 (95.4967%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8175, Accuracy: 5998/10000 (59.9800%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4576/4874 (93.8859%)
___Train Local_ResNet_18,  epoch 199, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4314/4874 (88.5105%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.5229, Accuracy: 4827/10000 (48.2700%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4960/5265 (94.2070%)
___Train Local_ResNet_18,  epoch 199, local model 9, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4686/5265 (89.0028%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1050, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4766/5083 (93.7635%)
___Train Local_ResNet_18,  epoch 199, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4529/5083 (89.1009%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.2847, Accuracy: 5235/10000 (52.3500%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4236/4511 (93.9038%)
___Train Local_ResNet_18,  epoch 199, local model 17, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4161/4511 (92.2412%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1297, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4313/4538 (95.0419%)
___Train Local_ResNet_18,  epoch 199, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4258/4538 (93.8299%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8541, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4394/4716 (93.1722%)
___Train Local_ResNet_18,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4267/4716 (90.4792%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0441, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4452/4663 (95.4750%)
___Train Local_ResNet_18,  epoch 199, local model 10, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4365/4663 (93.6093%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.1240, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4256/4441 (95.8343%)
___Train Local_ResNet_18,  epoch 199, local model 48, internal_epoch   2,  Average loss: 0.0022, Accuracy: 4255/4441 (95.8118%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8814, Accuracy: 5911/10000 (59.1100%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4549/4793 (94.9092%)
___Train Local_ResNet_18,  epoch 199, local model 84, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4465/4793 (93.1567%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9709, Accuracy: 5652/10000 (56.5200%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4426/4662 (94.9378%)
___Train Local_ResNet_18,  epoch 199, local model 44, internal_epoch   2,  Average loss: 0.0031, Accuracy: 4386/4662 (94.0798%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.9028, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3475/3704 (93.8175%)
___Train Local_ResNet_18,  epoch 199, local model 4, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3459/3704 (93.3855%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8644, Accuracy: 5880/10000 (58.8000%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4619/4989 (92.5837%)
___Train Local_ResNet_18,  epoch 199, local model 56, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4511/4989 (90.4189%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 2.0079, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4147/4346 (95.4211%)
___Train Local_ResNet_18,  epoch 199, local model 29, internal_epoch   2,  Average loss: 0.0029, Accuracy: 4112/4346 (94.6157%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.7475, Accuracy: 6084/10000 (60.8400%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4189/4362 (96.0339%)
___Train Local_ResNet_18,  epoch 199, local model 90, internal_epoch   2,  Average loss: 0.0026, Accuracy: 4146/4362 (95.0481%)
___Test Local_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.8444, Accuracy: 5874/10000 (58.7400%)
time spent on training: 261.0413239002228
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 19 ranked 1 as suspicious. Assigned small weight: 0.1
Client 8 ranked 2 as suspicious. Assigned small weight: 0.1
Client 12 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 199: Average loss: 1.5986, Accuracy: 6177/10000 (61.7700%)
___Test Target_ResNet_18 poisoned: True, epoch: 199: Average loss: 0.0254, Accuracy: 9833/9900 (99.3232%)
Done in 288.2190430164337 sec.
Server Epoch:200 choose agents : [13, 36, 58, 71, 24, 57, 3, 25, 9, 17, 95, 74, 68, 80, 48, 7, 52, 2, 78, 19].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 4829/4885 (98.8536%), train_poison_data_count: 385
Global model norm: 45.0483098431735.
Norm before scaling: 45.00317914117291. Distance: 1.0039215680449178
Total norm for 4 adversaries is: 45.00317914117291. distance: 1.0039215680449178
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0634, Accuracy: 9748/9900 (98.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5197/5305 (97.9642%), train_poison_data_count: 415
Global model norm: 45.0483098431735.
Norm before scaling: 45.00541417082505. Distance: 1.1895339512415402
Total norm for 4 adversaries is: 45.00541417082505. distance: 1.1895339512415402
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0655, Accuracy: 9746/9900 (98.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4632/4717 (98.1980%), train_poison_data_count: 370
Global model norm: 45.0483098431735.
Norm before scaling: 45.006962894471954. Distance: 1.0523882068512629
Total norm for 4 adversaries is: 45.006962894471954. distance: 1.0523882068512629
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0117, Accuracy: 9868/9900 (99.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 200, local model 71, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4970/5066 (98.1050%), train_poison_data_count: 400
Global model norm: 45.0483098431735.
Norm before scaling: 45.005701678717884. Distance: 1.1193445362778525
Total norm for 4 adversaries is: 45.005701678717884. distance: 1.1193445362778525
___Test Local_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0317, Accuracy: 9823/9900 (99.2222%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3791/3969 (95.5152%)
___Train Local_ResNet_18,  epoch 200, local model 24, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3674/3969 (92.5674%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8468, Accuracy: 5929/10000 (59.2900%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4283/4558 (93.9667%)
___Train Local_ResNet_18,  epoch 200, local model 57, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4177/4558 (91.6411%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0983, Accuracy: 5430/10000 (54.3000%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4672/4918 (94.9980%)
___Train Local_ResNet_18,  epoch 200, local model 3, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4584/4918 (93.2086%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1591, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5553/5902 (94.0868%)
___Train Local_ResNet_18,  epoch 200, local model 25, internal_epoch   2,  Average loss: 0.0055, Accuracy: 5249/5902 (88.9360%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.3001, Accuracy: 5270/10000 (52.7000%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4977/5265 (94.5299%)
___Train Local_ResNet_18,  epoch 200, local model 9, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4872/5265 (92.5356%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0076, Accuracy: 5677/10000 (56.7700%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4234/4511 (93.8595%)
___Train Local_ResNet_18,  epoch 200, local model 17, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4187/4511 (92.8176%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0995, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4329/4625 (93.6000%)
___Train Local_ResNet_18,  epoch 200, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4105/4625 (88.7568%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1239, Accuracy: 5365/10000 (53.6500%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4160/4416 (94.2029%)
___Train Local_ResNet_18,  epoch 200, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4077/4416 (92.3234%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0217, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3135/3297 (95.0864%)
___Train Local_ResNet_18,  epoch 200, local model 68, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3107/3297 (94.2372%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.7579, Accuracy: 6005/10000 (60.0500%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4718/5025 (93.8905%)
___Train Local_ResNet_18,  epoch 200, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4624/5025 (92.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1588, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4260/4441 (95.9243%)
___Train Local_ResNet_18,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4250/4441 (95.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0007, Accuracy: 5721/10000 (57.2100%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4247/4481 (94.7780%)
___Train Local_ResNet_18,  epoch 200, local model 7, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4006/4481 (89.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.0514, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3642/3797 (95.9178%)
___Train Local_ResNet_18,  epoch 200, local model 52, internal_epoch   2,  Average loss: 0.0024, Accuracy: 3615/3797 (95.2067%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8334, Accuracy: 5854/10000 (58.5400%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3448/3646 (94.5694%)
___Train Local_ResNet_18,  epoch 200, local model 2, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3411/3646 (93.5546%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8165, Accuracy: 5941/10000 (59.4100%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3848/4025 (95.6025%)
___Train Local_ResNet_18,  epoch 200, local model 78, internal_epoch   2,  Average loss: 0.0027, Accuracy: 3830/4025 (95.1553%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.8514, Accuracy: 5876/10000 (58.7600%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4562/4928 (92.5731%)
___Train Local_ResNet_18,  epoch 200, local model 19, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4505/4928 (91.4164%)
___Test Local_ResNet_18 poisoned: False, epoch: 200: Average loss: 2.1068, Accuracy: 5501/10000 (55.0100%)
time spent on training: 260.0215630531311
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Suspicious clients identified: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
Client 9 ranked 1 as suspicious. Assigned small weight: 0.1
Client 4 ranked 2 as suspicious. Assigned small weight: 0.1
Client 11 ranked 3 as suspicious. Assigned small weight: 0.1
Central model updated with weighted gradients.
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 200: Average loss: 1.6111, Accuracy: 6163/10000 (61.6300%)
___Test Target_ResNet_18 poisoned: True, epoch: 200: Average loss: 0.0244, Accuracy: 9836/9900 (99.3535%)
Done in 287.1023163795471 sec.
Saving all the graphs.
This run has a label: Dec.06_16.08.19. Visdom environment: cifar100_CerP
