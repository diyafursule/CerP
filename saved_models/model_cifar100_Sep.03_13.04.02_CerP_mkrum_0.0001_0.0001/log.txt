current path: saved_models/model_cifar100_Sep.03_13.04.02_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 85, 4, 97, 76, 38, 94, 86, 10, 29, 34, 7, 18, 6, 22, 69, 81].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4755/5308 (89.5818%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.4392287249147. Distance: 2.2835134486234026
Total norm for 4 adversaries is: 42.4392287249147. distance: 2.2835134486234026
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5702, Accuracy: 8576/9900 (86.6263%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5306/5777 (91.8470%), train_poison_data_count: 455
Global model norm: 42.432124970265015.
Norm before scaling: 42.429606224604534. Distance: 2.1738113443801446
Total norm for 4 adversaries is: 42.429606224604534. distance: 2.1738113443801446
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5883, Accuracy: 8550/9900 (86.3636%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4578/5123 (89.3617%), train_poison_data_count: 403
Global model norm: 42.432124970265015.
Norm before scaling: 42.43911510871707. Distance: 2.264569687882635
Total norm for 4 adversaries is: 42.43911510871707. distance: 2.264569687882635
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4872, Accuracy: 8716/9900 (88.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4944/5503 (89.8419%), train_poison_data_count: 430
Global model norm: 42.432124970265015.
Norm before scaling: 42.43929631921708. Distance: 2.3051449079330837
Total norm for 4 adversaries is: 42.43929631921708. distance: 2.3051449079330837
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.5318, Accuracy: 8605/9900 (86.9192%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 6178/6947 (88.9305%)
___Train Local_ResNet_18,  epoch  71, local model 85, internal_epoch   2,  Average loss: 0.0058, Accuracy: 6133/6947 (88.2827%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1251, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3581/4028 (88.9027%)
___Train Local_ResNet_18,  epoch  71, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3703/4028 (91.9315%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.8955, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4124/4736 (87.0777%)
___Train Local_ResNet_18,  epoch  71, local model 97, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4245/4736 (89.6326%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9476, Accuracy: 5520/10000 (55.2000%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3447/3959 (87.0674%)
___Train Local_ResNet_18,  epoch  71, local model 76, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3570/3959 (90.1743%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9194, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5478/6235 (87.8589%)
___Train Local_ResNet_18,  epoch  71, local model 38, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5455/6235 (87.4900%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2632, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4524/5224 (86.6003%)
___Train Local_ResNet_18,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4706/5224 (90.0842%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0016, Accuracy: 5383/10000 (53.8300%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3460/3929 (88.0631%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3594/3929 (91.4737%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9396, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4566/5068 (90.0947%)
___Train Local_ResNet_18,  epoch  71, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4662/5068 (91.9890%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0362, Accuracy: 5344/10000 (53.4400%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4297/4732 (90.8073%)
___Train Local_ResNet_18,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4407/4732 (93.1319%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7387, Accuracy: 5904/10000 (59.0400%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4431/4911 (90.2260%)
___Train Local_ResNet_18,  epoch  71, local model 34, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4486/4911 (91.3460%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9391, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4292/4869 (88.1495%)
___Train Local_ResNet_18,  epoch  71, local model 7, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4002/4869 (82.1935%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2821, Accuracy: 4909/10000 (49.0900%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3757/4249 (88.4208%)
___Train Local_ResNet_18,  epoch  71, local model 18, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3846/4249 (90.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0302, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4412/4929 (89.5111%)
___Train Local_ResNet_18,  epoch  71, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4472/4929 (90.7283%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0043, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5123/5696 (89.9403%)
___Train Local_ResNet_18,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5123/5696 (89.9403%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9950, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3919/4364 (89.8029%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3893/4364 (89.2071%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9606, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4534/5035 (90.0497%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4640/5035 (92.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0270, Accuracy: 5341/10000 (53.4100%)
time spent on training: 269.99187421798706
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1048, Accuracy: 7045/10000 (70.4500%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 8.8041, Accuracy: 140/9900 (1.4141%)
Done in 296.6794137954712 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 47, 10, 95, 98, 64, 57, 27, 85, 93, 6, 74, 54, 88, 45, 51, 52].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4869/5308 (91.7295%), train_poison_data_count: 415
Global model norm: 42.45327883437347.
Norm before scaling: 42.455390765815885. Distance: 2.065214162994236
Total norm for 4 adversaries is: 42.455390765815885. distance: 2.065214162994236
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2342, Accuracy: 9299/9900 (93.9293%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5375/5777 (93.0414%), train_poison_data_count: 455
Global model norm: 42.45327883437347.
Norm before scaling: 42.44501124386925. Distance: 1.9878621137376813
Total norm for 4 adversaries is: 42.44501124386925. distance: 1.9878621137376813
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2253, Accuracy: 9328/9900 (94.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4604/5123 (89.8692%), train_poison_data_count: 403
Global model norm: 42.45327883437347.
Norm before scaling: 42.45771966302918. Distance: 2.1521523281484254
Total norm for 4 adversaries is: 42.45771966302918. distance: 2.1521523281484254
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.1149, Accuracy: 9594/9900 (96.9091%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5045/5503 (91.6773%), train_poison_data_count: 430
Global model norm: 42.45327883437347.
Norm before scaling: 42.45582492794717. Distance: 2.104077844035478
Total norm for 4 adversaries is: 42.45582492794717. distance: 2.104077844035478
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2874, Accuracy: 9183/9900 (92.7576%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4496/5123 (87.7611%)
___Train Local_ResNet_18,  epoch  72, local model 47, internal_epoch   2,  Average loss: 0.0085, Accuracy: 4273/5123 (83.4082%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0506, Accuracy: 5323/10000 (53.2300%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4536/5068 (89.5028%)
___Train Local_ResNet_18,  epoch  72, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4594/5068 (90.6472%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0847, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4347/5018 (86.6281%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4442/5018 (88.5213%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3210, Accuracy: 4961/10000 (49.6100%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3757/4161 (90.2908%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3794/4161 (91.1800%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9514, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4307/4894 (88.0057%)
___Train Local_ResNet_18,  epoch  72, local model 64, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4316/4894 (88.1896%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1073, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4413/4956 (89.0436%)
___Train Local_ResNet_18,  epoch  72, local model 57, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4579/4956 (92.3931%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9739, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4090/4587 (89.1650%)
___Train Local_ResNet_18,  epoch  72, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4156/4587 (90.6039%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9951, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6189/6947 (89.0888%)
___Train Local_ResNet_18,  epoch  72, local model 85, internal_epoch   2,  Average loss: 0.0056, Accuracy: 6187/6947 (89.0600%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2945, Accuracy: 5111/10000 (51.1100%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4494/5055 (88.9021%)
___Train Local_ResNet_18,  epoch  72, local model 93, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4586/5055 (90.7221%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1768, Accuracy: 5266/10000 (52.6600%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4430/4929 (89.8762%)
___Train Local_ResNet_18,  epoch  72, local model 6, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4433/4929 (89.9371%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0923, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4211/4797 (87.7840%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4270/4797 (89.0140%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0053, Accuracy: 5386/10000 (53.8600%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4870/5645 (86.2710%)
___Train Local_ResNet_18,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4885/5645 (86.5368%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.3729, Accuracy: 4991/10000 (49.9100%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4832/5362 (90.1156%)
___Train Local_ResNet_18,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4875/5362 (90.9176%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0244, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4789/5489 (87.2472%)
___Train Local_ResNet_18,  epoch  72, local model 45, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4913/5489 (89.5063%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0979, Accuracy: 5298/10000 (52.9800%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3684/4108 (89.6787%)
___Train Local_ResNet_18,  epoch  72, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3816/4108 (92.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9807, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3721/4130 (90.0969%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3820/4130 (92.4939%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0062, Accuracy: 5486/10000 (54.8600%)
time spent on training: 278.5440056324005
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0969, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 7.4037, Accuracy: 352/9900 (3.5556%)
Done in 304.9046320915222 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 31, 47, 14, 73, 99, 60, 81, 39, 40, 78, 27, 59, 7, 22, 83, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4889/5308 (92.1063%), train_poison_data_count: 415
Global model norm: 42.47624278548981.
Norm before scaling: 42.47542373059685. Distance: 1.9771900010217482
Total norm for 4 adversaries is: 42.47542373059685. distance: 1.9771900010217482
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3156, Accuracy: 9128/9900 (92.2020%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5404/5777 (93.5434%), train_poison_data_count: 455
Global model norm: 42.47624278548981.
Norm before scaling: 42.46961660953554. Distance: 1.9601488085134566
Total norm for 4 adversaries is: 42.46961660953554. distance: 1.9601488085134566
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.3010, Accuracy: 9121/9900 (92.1313%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4685/5123 (91.4503%), train_poison_data_count: 403
Global model norm: 42.47624278548981.
Norm before scaling: 42.474162067772156. Distance: 1.9644367259052782
Total norm for 4 adversaries is: 42.474162067772156. distance: 1.9644367259052782
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2985, Accuracy: 9178/9900 (92.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5016/5503 (91.1503%), train_poison_data_count: 430
Global model norm: 42.47624278548981.
Norm before scaling: 42.47551569544212. Distance: 2.0818619936625815
Total norm for 4 adversaries is: 42.47551569544212. distance: 2.0818619936625815
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1107, Accuracy: 9630/9900 (97.2727%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4094/4537 (90.2358%)
___Train Local_ResNet_18,  epoch  73, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4183/4537 (92.1975%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8915, Accuracy: 5708/10000 (57.0800%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4543/5123 (88.6785%)
___Train Local_ResNet_18,  epoch  73, local model 47, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4495/5123 (87.7416%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1250, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3841/4196 (91.5396%)
___Train Local_ResNet_18,  epoch  73, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 3945/4196 (94.0181%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8188, Accuracy: 5795/10000 (57.9500%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4132/4605 (89.7286%)
___Train Local_ResNet_18,  epoch  73, local model 73, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4256/4605 (92.4213%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8765, Accuracy: 5678/10000 (56.7800%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4328/4851 (89.2187%)
___Train Local_ResNet_18,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4427/4851 (91.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9261, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3667/4145 (88.4680%)
___Train Local_ResNet_18,  epoch  73, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3774/4145 (91.0495%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9656, Accuracy: 5545/10000 (55.4500%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4552/5035 (90.4071%)
___Train Local_ResNet_18,  epoch  73, local model 81, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4668/5035 (92.7110%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8987, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3688/4175 (88.3353%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3756/4175 (89.9641%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0450, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5450/5939 (91.7663%)
___Train Local_ResNet_18,  epoch  73, local model 40, internal_epoch   2,  Average loss: 0.0038, Accuracy: 5501/5939 (92.6250%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0854, Accuracy: 5350/10000 (53.5000%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3995/4368 (91.4606%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4060/4368 (92.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0108, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4006/4587 (87.3338%)
___Train Local_ResNet_18,  epoch  73, local model 27, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4111/4587 (89.6228%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0757, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4129/4397 (93.9049%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0024, Accuracy: 4199/4397 (95.4969%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.7303, Accuracy: 5912/10000 (59.1200%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4274/4869 (87.7798%)
___Train Local_ResNet_18,  epoch  73, local model 7, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4206/4869 (86.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2098, Accuracy: 5017/10000 (50.1700%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5163/5696 (90.6426%)
___Train Local_ResNet_18,  epoch  73, local model 22, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5127/5696 (90.0105%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0162, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3172/3552 (89.3018%)
___Train Local_ResNet_18,  epoch  73, local model 83, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3274/3552 (92.1734%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8092, Accuracy: 5757/10000 (57.5700%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4162/4736 (87.8801%)
___Train Local_ResNet_18,  epoch  73, local model 97, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4267/4736 (90.0971%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0187, Accuracy: 5415/10000 (54.1500%)
time spent on training: 272.1268353462219
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0922, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 6.3299, Accuracy: 703/9900 (7.1010%)
Done in 298.51871633529663 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 10, 76, 15, 42, 57, 17, 9, 3, 70, 8, 65, 33, 59, 52, 69, 11].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4908/5308 (92.4642%), train_poison_data_count: 415
Global model norm: 42.496099315481295.
Norm before scaling: 42.4968820662359. Distance: 1.9509246639017024
Total norm for 4 adversaries is: 42.4968820662359. distance: 1.9509246639017024
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1219, Accuracy: 9602/9900 (96.9899%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5394/5777 (93.3703%), train_poison_data_count: 455
Global model norm: 42.496099315481295.
Norm before scaling: 42.486600311800515. Distance: 1.9400373272401759
Total norm for 4 adversaries is: 42.486600311800515. distance: 1.9400373272401759
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1320, Accuracy: 9551/9900 (96.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4627/5123 (90.3182%), train_poison_data_count: 403
Global model norm: 42.496099315481295.
Norm before scaling: 42.49972282768074. Distance: 2.0634733273164416
Total norm for 4 adversaries is: 42.49972282768074. distance: 2.0634733273164416
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1674, Accuracy: 9450/9900 (95.4545%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5052/5503 (91.8045%), train_poison_data_count: 430
Global model norm: 42.496099315481295.
Norm before scaling: 42.4977351763266. Distance: 2.0100321690276806
Total norm for 4 adversaries is: 42.4977351763266. distance: 2.0100321690276806
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1917, Accuracy: 9403/9900 (94.9798%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4636/5068 (91.4759%)
___Train Local_ResNet_18,  epoch  74, local model 10, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4546/5068 (89.7001%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3088, Accuracy: 5066/10000 (50.6600%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3466/3959 (87.5474%)
___Train Local_ResNet_18,  epoch  74, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3589/3959 (90.6542%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9456, Accuracy: 5538/10000 (55.3800%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5489/6068 (90.4581%)
___Train Local_ResNet_18,  epoch  74, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5506/6068 (90.7383%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0569, Accuracy: 5369/10000 (53.6900%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5327/5907 (90.1811%)
___Train Local_ResNet_18,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5371/5907 (90.9260%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3365, Accuracy: 4999/10000 (49.9900%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4502/4956 (90.8394%)
___Train Local_ResNet_18,  epoch  74, local model 57, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4543/4956 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0382, Accuracy: 5407/10000 (54.0700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4255/4903 (86.7836%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4424/4903 (90.2305%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.3055, Accuracy: 4977/10000 (49.7700%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4999/5727 (87.2883%)
___Train Local_ResNet_18,  epoch  74, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 5128/5727 (89.5408%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0057, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4891/5346 (91.4890%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4973/5346 (93.0228%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1940, Accuracy: 5168/10000 (51.6800%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 5374/5871 (91.5347%)
___Train Local_ResNet_18,  epoch  74, local model 70, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5352/5871 (91.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9894, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4347/4889 (88.9139%)
___Train Local_ResNet_18,  epoch  74, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4395/4889 (89.8957%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1634, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4844/5497 (88.1208%)
___Train Local_ResNet_18,  epoch  74, local model 65, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4920/5497 (89.5034%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0383, Accuracy: 5316/10000 (53.1600%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4239/4818 (87.9826%)
___Train Local_ResNet_18,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4307/4818 (89.3939%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9068, Accuracy: 5576/10000 (55.7600%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4122/4397 (93.7457%)
___Train Local_ResNet_18,  epoch  74, local model 59, internal_epoch   2,  Average loss: 0.0025, Accuracy: 4200/4397 (95.5197%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8520, Accuracy: 5764/10000 (57.6400%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3728/4130 (90.2663%)
___Train Local_ResNet_18,  epoch  74, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3789/4130 (91.7433%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8935, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3981/4364 (91.2236%)
___Train Local_ResNet_18,  epoch  74, local model 69, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3956/4364 (90.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9584, Accuracy: 5451/10000 (54.5100%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4853/5702 (85.1105%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0104, Accuracy: 4511/5702 (79.1126%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1941, Accuracy: 4985/10000 (49.8500%)
time spent on training: 277.6636106967926
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0940, Accuracy: 7068/10000 (70.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 5.4641, Accuracy: 1173/9900 (11.8485%)
Done in 304.2533988952637 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 57, 60, 74, 72, 70, 14, 43, 88, 9, 80, 22, 73, 66, 82, 56, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4926/5308 (92.8033%), train_poison_data_count: 415
Global model norm: 42.51895688203013.
Norm before scaling: 42.512891542044336. Distance: 1.8747671618532606
Total norm for 4 adversaries is: 42.512891542044336. distance: 1.8747671618532606
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2234, Accuracy: 9357/9900 (94.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5440/5777 (94.1665%), train_poison_data_count: 455
Global model norm: 42.51895688203013.
Norm before scaling: 42.50678656752208. Distance: 1.8236001903978145
Total norm for 4 adversaries is: 42.50678656752208. distance: 1.8236001903978145
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2150, Accuracy: 9382/9900 (94.7677%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4657/5123 (90.9038%), train_poison_data_count: 403
Global model norm: 42.51895688203013.
Norm before scaling: 42.51991577254931. Distance: 1.9906931339981957
Total norm for 4 adversaries is: 42.51991577254931. distance: 1.9906931339981957
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1776, Accuracy: 9469/9900 (95.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5107/5503 (92.8039%), train_poison_data_count: 430
Global model norm: 42.51895688203013.
Norm before scaling: 42.51643610260845. Distance: 1.9391876991791448
Total norm for 4 adversaries is: 42.51643610260845. distance: 1.9391876991791448
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1074, Accuracy: 9605/9900 (97.0202%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4562/4956 (92.0500%)
___Train Local_ResNet_18,  epoch  75, local model 57, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4557/4956 (91.9492%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0337, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3675/4145 (88.6610%)
___Train Local_ResNet_18,  epoch  75, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3757/4145 (90.6393%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9581, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4241/4797 (88.4094%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4313/4797 (89.9104%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9618, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4641/5193 (89.3703%)
___Train Local_ResNet_18,  epoch  75, local model 72, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4642/5193 (89.3896%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2570, Accuracy: 5121/10000 (51.2100%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5427/5871 (92.4374%)
___Train Local_ResNet_18,  epoch  75, local model 70, internal_epoch   2,  Average loss: 0.0044, Accuracy: 5358/5871 (91.2621%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1366, Accuracy: 5325/10000 (53.2500%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3868/4196 (92.1830%)
___Train Local_ResNet_18,  epoch  75, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3948/4196 (94.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9733, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4436/4979 (89.0942%)
___Train Local_ResNet_18,  epoch  75, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4496/4979 (90.2993%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0103, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4846/5362 (90.3767%)
___Train Local_ResNet_18,  epoch  75, local model 88, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4857/5362 (90.5819%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9456, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0059, Accuracy: 5073/5727 (88.5804%)
___Train Local_ResNet_18,  epoch  75, local model 9, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5030/5727 (87.8296%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1090, Accuracy: 5359/10000 (53.5900%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4921/5461 (90.1117%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4943/5461 (90.5146%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.1048, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5122/5696 (89.9228%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0047, Accuracy: 5199/5696 (91.2746%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9668, Accuracy: 5418/10000 (54.1800%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4182/4605 (90.8143%)
___Train Local_ResNet_18,  epoch  75, local model 73, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4262/4605 (92.5516%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9167, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4336/4843 (89.5313%)
___Train Local_ResNet_18,  epoch  75, local model 66, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4389/4843 (90.6256%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.3185, Accuracy: 4993/10000 (49.9300%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4882/5298 (92.1480%)
___Train Local_ResNet_18,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4933/5298 (93.1106%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0272, Accuracy: 5438/10000 (54.3800%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4823/5427 (88.8705%)
___Train Local_ResNet_18,  epoch  75, local model 56, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4844/5427 (89.2574%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9765, Accuracy: 5466/10000 (54.6600%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4430/4830 (91.7184%)
___Train Local_ResNet_18,  epoch  75, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4439/4830 (91.9048%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2379, Accuracy: 5251/10000 (52.5100%)
time spent on training: 279.04468727111816
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0972, Accuracy: 7053/10000 (70.5300%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 4.6771, Accuracy: 1784/9900 (18.0202%)
Done in 305.3525638580322 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 69, 16, 75, 60, 24, 8, 77, 11, 80, 28, 41, 2, 76, 57, 33, 78].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
