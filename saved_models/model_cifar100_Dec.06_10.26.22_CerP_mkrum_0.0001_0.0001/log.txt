current path: saved_models/model_cifar100_Dec.06_10.26.22_CerP_mkrum_0.0001_0.0001
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.01 and current epoch is 71
create model done
Poisoned following participants: [13, 36, 58, 71]
We use following environment for graphs:  cifar100_CerP
Server Epoch:71 choose agents : [13, 36, 58, 71, 89, 99, 77, 65, 67, 61, 30, 1, 69, 81, 12, 17, 52, 15, 86, 40].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4310/4885 (88.2293%), train_poison_data_count: 385
Global model norm: 42.432124970265015.
Norm before scaling: 42.43985720395614. Distance: 2.292534288256032
Total norm for 4 adversaries is: 42.43985720395614. distance: 2.292534288256032
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4495, Accuracy: 8813/9900 (89.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 36, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4742/5305 (89.3874%), train_poison_data_count: 415
Global model norm: 42.432124970265015.
Norm before scaling: 42.435241908811776. Distance: 2.2506111162812013
Total norm for 4 adversaries is: 42.435241908811776. distance: 2.2506111162812013
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.7234, Accuracy: 8317/9900 (84.0101%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4176/4717 (88.5308%), train_poison_data_count: 370
Global model norm: 42.432124970265015.
Norm before scaling: 42.43869084301199. Distance: 2.177834875413623
Total norm for 4 adversaries is: 42.43869084301199. distance: 2.177834875413623
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.4286, Accuracy: 8878/9900 (89.6768%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  71, local model 71, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4460/5066 (88.0379%), train_poison_data_count: 400
Global model norm: 42.432124970265015.
Norm before scaling: 42.44034042178723. Distance: 2.3028791154018067
Total norm for 4 adversaries is: 42.44034042178723. distance: 2.3028791154018067
___Test Local_ResNet_18 poisoned: True, epoch: 71: Average loss: 0.6073, Accuracy: 8497/9900 (85.8283%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3831/4356 (87.9477%)
___Train Local_ResNet_18,  epoch  71, local model 89, internal_epoch   2,  Average loss: 0.0082, Accuracy: 3659/4356 (83.9991%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.4473, Accuracy: 4715/10000 (47.1500%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3937/4465 (88.1747%)
___Train Local_ResNet_18,  epoch  71, local model 99, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4088/4465 (91.5566%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9904, Accuracy: 5542/10000 (55.4200%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4048/4647 (87.1100%)
___Train Local_ResNet_18,  epoch  71, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4155/4647 (89.4125%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9695, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4446/5055 (87.9525%)
___Train Local_ResNet_18,  epoch  71, local model 65, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4524/5055 (89.4955%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.2345, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4440/5116 (86.7866%)
___Train Local_ResNet_18,  epoch  71, local model 67, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4471/5116 (87.3925%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0353, Accuracy: 5165/10000 (51.6500%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3633/4126 (88.0514%)
___Train Local_ResNet_18,  epoch  71, local model 61, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3765/4126 (91.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9590, Accuracy: 5502/10000 (55.0200%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3086/3472 (88.8825%)
___Train Local_ResNet_18,  epoch  71, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3224/3472 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0615, Accuracy: 5480/10000 (54.8000%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4425/4986 (88.7485%)
___Train Local_ResNet_18,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4455/4986 (89.3502%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0799, Accuracy: 5423/10000 (54.2300%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3541/4013 (88.2382%)
___Train Local_ResNet_18,  epoch  71, local model 69, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3684/4013 (91.8016%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.7853, Accuracy: 5748/10000 (57.4800%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4031/4618 (87.2889%)
___Train Local_ResNet_18,  epoch  71, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4078/4618 (88.3066%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0972, Accuracy: 5282/10000 (52.8200%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4429/5083 (87.1336%)
___Train Local_ResNet_18,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4451/5083 (87.5664%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1524, Accuracy: 5189/10000 (51.8900%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3976/4511 (88.1401%)
___Train Local_ResNet_18,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4041/4511 (89.5810%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1396, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3337/3797 (87.8852%)
___Train Local_ResNet_18,  epoch  71, local model 52, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3389/3797 (89.2547%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9672, Accuracy: 5529/10000 (55.2900%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4999/5582 (89.5557%)
___Train Local_ResNet_18,  epoch  71, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5042/5582 (90.3260%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.0972, Accuracy: 5284/10000 (52.8400%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3151/3616 (87.1405%)
___Train Local_ResNet_18,  epoch  71, local model 86, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3208/3616 (88.7168%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 2.1213, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4826/5455 (88.4693%)
___Train Local_ResNet_18,  epoch  71, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4844/5455 (88.7993%)
___Test Local_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.9912, Accuracy: 5270/10000 (52.7000%)
time spent on training: 233.0859317779541
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 65, confusion matrix appended.
Validation completed for user 67, confusion matrix appended.
Validation completed for user 61, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 81, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 71: Average loss: 1.1053, Accuracy: 7050/10000 (70.5000%)
___Test Target_ResNet_18 poisoned: True, epoch: 71: Average loss: 9.0751, Accuracy: 115/9900 (1.1616%)
Done in 256.97154474258423 sec.
Server Epoch:72 choose agents : [13, 36, 58, 71, 78, 52, 95, 7, 20, 73, 98, 74, 76, 9, 79, 48, 33, 12, 16, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4397/4885 (90.0102%), train_poison_data_count: 385
Global model norm: 42.4547955826989.
Norm before scaling: 42.460814598488184. Distance: 2.110251915523987
Total norm for 4 adversaries is: 42.460814598488184. distance: 2.110251915523987
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2660, Accuracy: 9209/9900 (93.0202%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4774/5305 (89.9906%), train_poison_data_count: 415
Global model norm: 42.4547955826989.
Norm before scaling: 42.45812792567667. Distance: 2.1668758902645564
Total norm for 4 adversaries is: 42.45812792567667. distance: 2.1668758902645564
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.5593, Accuracy: 8557/9900 (86.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 58, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4192/4717 (88.8700%), train_poison_data_count: 370
Global model norm: 42.4547955826989.
Norm before scaling: 42.46212696701026. Distance: 2.166035437944776
Total norm for 4 adversaries is: 42.46212696701026. distance: 2.166035437944776
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2209, Accuracy: 9370/9900 (94.6465%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  72, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4500/5066 (88.8275%), train_poison_data_count: 400
Global model norm: 42.4547955826989.
Norm before scaling: 42.464811949498255. Distance: 2.2925264884059082
Total norm for 4 adversaries is: 42.464811949498255. distance: 2.2925264884059082
___Test Local_ResNet_18 poisoned: True, epoch: 72: Average loss: 0.2590, Accuracy: 9195/9900 (92.8788%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3600/4025 (89.4410%)
___Train Local_ResNet_18,  epoch  72, local model 78, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3709/4025 (92.1491%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9607, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3344/3797 (88.0695%)
___Train Local_ResNet_18,  epoch  72, local model 52, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3397/3797 (89.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1253, Accuracy: 5296/10000 (52.9600%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3935/4625 (85.0811%)
___Train Local_ResNet_18,  epoch  72, local model 95, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4027/4625 (87.0703%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1423, Accuracy: 5261/10000 (52.6100%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3851/4481 (85.9406%)
___Train Local_ResNet_18,  epoch  72, local model 7, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3888/4481 (86.7663%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1884, Accuracy: 5192/10000 (51.9200%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3866/4315 (89.5944%)
___Train Local_ResNet_18,  epoch  72, local model 20, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3979/4315 (92.2132%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0206, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3698/4235 (87.3200%)
___Train Local_ResNet_18,  epoch  72, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3829/4235 (90.4132%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9623, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3370/3828 (88.0355%)
___Train Local_ResNet_18,  epoch  72, local model 98, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3488/3828 (91.1181%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9701, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3824/4416 (86.5942%)
___Train Local_ResNet_18,  epoch  72, local model 74, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3980/4416 (90.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9313, Accuracy: 5566/10000 (55.6600%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3148/3638 (86.5311%)
___Train Local_ResNet_18,  epoch  72, local model 76, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3281/3638 (90.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9983, Accuracy: 5393/10000 (53.9300%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4546/5265 (86.3438%)
___Train Local_ResNet_18,  epoch  72, local model 9, internal_epoch   2,  Average loss: 0.0070, Accuracy: 4501/5265 (85.4891%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9870, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3356/3781 (88.7596%)
___Train Local_ResNet_18,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3312/3781 (87.5959%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.2663, Accuracy: 5020/10000 (50.2000%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3988/4441 (89.7996%)
___Train Local_ResNet_18,  epoch  72, local model 48, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4006/4441 (90.2049%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.1532, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3987/4433 (89.9391%)
___Train Local_ResNet_18,  epoch  72, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4012/4433 (90.5030%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0100, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4428/5083 (87.1139%)
___Train Local_ResNet_18,  epoch  72, local model 12, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4442/5083 (87.3893%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0771, Accuracy: 5294/10000 (52.9400%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4324/4928 (87.7435%)
___Train Local_ResNet_18,  epoch  72, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4422/4928 (89.7321%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.9624, Accuracy: 5575/10000 (55.7500%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4182/4793 (87.2522%)
___Train Local_ResNet_18,  epoch  72, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4372/4793 (91.2164%)
___Test Local_ResNet_18 poisoned: False, epoch: 72: Average loss: 2.0316, Accuracy: 5425/10000 (54.2500%)
time spent on training: 230.93797636032104
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 95, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 20, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 74, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 79, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 72: Average loss: 1.0966, Accuracy: 7060/10000 (70.6000%)
___Test Target_ResNet_18 poisoned: True, epoch: 72: Average loss: 8.0778, Accuracy: 224/9900 (2.2626%)
Done in 254.66990733146667 sec.
Server Epoch:73 choose agents : [13, 36, 58, 71, 86, 39, 96, 76, 59, 34, 52, 80, 90, 57, 87, 82, 78, 10, 18, 0].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4447/4885 (91.0338%), train_poison_data_count: 385
Global model norm: 42.47729891190779.
Norm before scaling: 42.47781618873624. Distance: 2.0163751433499377
Total norm for 4 adversaries is: 42.47781618873624. distance: 2.0163751433499377
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2253, Accuracy: 9293/9900 (93.8687%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4791/5305 (90.3110%), train_poison_data_count: 415
Global model norm: 42.47729891190779.
Norm before scaling: 42.47867830278577. Distance: 2.096980094265816
Total norm for 4 adversaries is: 42.47867830278577. distance: 2.096980094265816
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.0846, Accuracy: 9665/9900 (97.6263%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4252/4717 (90.1420%), train_poison_data_count: 370
Global model norm: 42.47729891190779.
Norm before scaling: 42.47887946021308. Distance: 1.9894534030317153
Total norm for 4 adversaries is: 42.47887946021308. distance: 1.9894534030317153
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.2198, Accuracy: 9337/9900 (94.3131%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  73, local model 71, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4511/5066 (89.0446%), train_poison_data_count: 400
Global model norm: 42.47729891190779.
Norm before scaling: 42.48347708457151. Distance: 2.1620288754633696
Total norm for 4 adversaries is: 42.48347708457151. distance: 2.1620288754633696
___Test Local_ResNet_18 poisoned: True, epoch: 73: Average loss: 0.1550, Accuracy: 9499/9900 (95.9495%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3151/3616 (87.1405%)
___Train Local_ResNet_18,  epoch  73, local model 86, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3303/3616 (91.3440%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8500, Accuracy: 5739/10000 (57.3900%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3411/3837 (88.8976%)
___Train Local_ResNet_18,  epoch  73, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3515/3837 (91.6080%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8932, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4164/4679 (88.9934%)
___Train Local_ResNet_18,  epoch  73, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4255/4679 (90.9382%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0575, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3098/3638 (85.1567%)
___Train Local_ResNet_18,  epoch  73, local model 76, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3262/3638 (89.6647%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0356, Accuracy: 5353/10000 (53.5300%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3632/4046 (89.7677%)
___Train Local_ResNet_18,  epoch  73, local model 59, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3644/4046 (90.0643%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9660, Accuracy: 5488/10000 (54.8800%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3991/4518 (88.3355%)
___Train Local_ResNet_18,  epoch  73, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4077/4518 (90.2390%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.1405, Accuracy: 5139/10000 (51.3900%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3386/3797 (89.1757%)
___Train Local_ResNet_18,  epoch  73, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3432/3797 (90.3871%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0749, Accuracy: 5402/10000 (54.0200%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4423/5025 (88.0199%)
___Train Local_ResNet_18,  epoch  73, local model 80, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4454/5025 (88.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2444, Accuracy: 5171/10000 (51.7100%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3911/4362 (89.6607%)
___Train Local_ResNet_18,  epoch  73, local model 90, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3937/4362 (90.2568%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9793, Accuracy: 5395/10000 (53.9500%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3993/4558 (87.6042%)
___Train Local_ResNet_18,  epoch  73, local model 57, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4042/4558 (88.6792%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0587, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3206/3672 (87.3094%)
___Train Local_ResNet_18,  epoch  73, local model 87, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3276/3672 (89.2157%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0186, Accuracy: 5392/10000 (53.9200%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4322/4874 (88.6746%)
___Train Local_ResNet_18,  epoch  73, local model 82, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4367/4874 (89.5979%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.2131, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3620/4025 (89.9379%)
___Train Local_ResNet_18,  epoch  73, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3708/4025 (92.1242%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.9988, Accuracy: 5501/10000 (55.0100%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4091/4663 (87.7332%)
___Train Local_ResNet_18,  epoch  73, local model 10, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4224/4663 (90.5855%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0662, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3453/3911 (88.2894%)
___Train Local_ResNet_18,  epoch  73, local model 18, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3440/3911 (87.9570%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 2.0284, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4443/5017 (88.5589%)
___Train Local_ResNet_18,  epoch  73, local model 0, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4550/5017 (90.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.8486, Accuracy: 5627/10000 (56.2700%)
time spent on training: 229.1188519001007
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 59, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 57, confusion matrix appended.
Validation completed for user 87, confusion matrix appended.
Validation completed for user 82, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 0, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 73: Average loss: 1.0909, Accuracy: 7059/10000 (70.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 73: Average loss: 7.0908, Accuracy: 421/9900 (4.2525%)
Done in 252.94418287277222 sec.
Server Epoch:74 choose agents : [13, 36, 58, 71, 53, 55, 91, 40, 17, 22, 11, 3, 61, 19, 27, 54, 96, 2, 86, 28].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4442/4885 (90.9314%), train_poison_data_count: 385
Global model norm: 42.4976935265683.
Norm before scaling: 42.49986931275863. Distance: 1.9707984560998189
Total norm for 4 adversaries is: 42.49986931275863. distance: 1.9707984560998189
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.5418, Accuracy: 8668/9900 (87.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4834/5305 (91.1216%), train_poison_data_count: 415
Global model norm: 42.4976935265683.
Norm before scaling: 42.49589823956543. Distance: 2.020036704230393
Total norm for 4 adversaries is: 42.49589823956543. distance: 2.020036704230393
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.0787, Accuracy: 9683/9900 (97.8081%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 58, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4257/4717 (90.2480%), train_poison_data_count: 370
Global model norm: 42.4976935265683.
Norm before scaling: 42.49926613566771. Distance: 1.9577741297975217
Total norm for 4 adversaries is: 42.49926613566771. distance: 1.9577741297975217
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.1433, Accuracy: 9529/9900 (96.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  74, local model 71, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4533/5066 (89.4789%), train_poison_data_count: 400
Global model norm: 42.4976935265683.
Norm before scaling: 42.50374380339557. Distance: 2.120998204785801
Total norm for 4 adversaries is: 42.50374380339557. distance: 2.120998204785801
___Test Local_ResNet_18 poisoned: True, epoch: 74: Average loss: 0.3433, Accuracy: 9023/9900 (91.1414%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5262/6124 (85.9242%)
___Train Local_ResNet_18,  epoch  74, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5289/6124 (86.3651%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1848, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3872/4356 (88.8889%)
___Train Local_ResNet_18,  epoch  74, local model 55, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3672/4356 (84.2975%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.4078, Accuracy: 4921/10000 (49.2100%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3531/4158 (84.9206%)
___Train Local_ResNet_18,  epoch  74, local model 91, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3581/4158 (86.1231%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1589, Accuracy: 5163/10000 (51.6300%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4896/5455 (89.7525%)
___Train Local_ResNet_18,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4925/5455 (90.2841%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9637, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3932/4511 (87.1647%)
___Train Local_ResNet_18,  epoch  74, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4060/4511 (90.0022%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0282, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   1,  Average loss: 0.0067, Accuracy: 4538/5232 (86.7355%)
___Train Local_ResNet_18,  epoch  74, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4535/5232 (86.6781%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0934, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4491/5244 (85.6407%)
___Train Local_ResNet_18,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 4541/5244 (86.5942%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0789, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4373/4918 (88.9183%)
___Train Local_ResNet_18,  epoch  74, local model 3, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4411/4918 (89.6909%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0648, Accuracy: 5268/10000 (52.6800%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3620/4126 (87.7363%)
___Train Local_ResNet_18,  epoch  74, local model 61, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3736/4126 (90.5477%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8485, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4355/4928 (88.3726%)
___Train Local_ResNet_18,  epoch  74, local model 19, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4374/4928 (88.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1694, Accuracy: 5164/10000 (51.6400%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3739/4223 (88.5390%)
___Train Local_ResNet_18,  epoch  74, local model 27, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3843/4223 (91.0017%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.8867, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4522/5195 (87.0452%)
___Train Local_ResNet_18,  epoch  74, local model 54, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4596/5195 (88.4697%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.1053, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4160/4679 (88.9079%)
___Train Local_ResNet_18,  epoch  74, local model 96, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4125/4679 (88.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 2.0723, Accuracy: 5302/10000 (53.0200%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3203/3646 (87.8497%)
___Train Local_ResNet_18,  epoch  74, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3285/3646 (90.0987%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9204, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3196/3616 (88.3850%)
___Train Local_ResNet_18,  epoch  74, local model 86, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3194/3616 (88.3296%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9193, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4081/4716 (86.5352%)
___Train Local_ResNet_18,  epoch  74, local model 28, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4091/4716 (86.7472%)
___Test Local_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.9610, Accuracy: 5451/10000 (54.5100%)
time spent on training: 232.75485181808472
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 61, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 54, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 28, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 74: Average loss: 1.0885, Accuracy: 7064/10000 (70.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 74: Average loss: 6.3985, Accuracy: 708/9900 (7.1515%)
Done in 256.64537835121155 sec.
Server Epoch:75 choose agents : [13, 36, 58, 71, 53, 33, 79, 24, 80, 96, 47, 1, 20, 74, 94, 84, 22, 44, 46, 50].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4475/4885 (91.6070%), train_poison_data_count: 385
Global model norm: 42.52274064168122.
Norm before scaling: 42.52581075156739. Distance: 1.959655707540472
Total norm for 4 adversaries is: 42.52581075156739. distance: 1.959655707540472
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1723, Accuracy: 9488/9900 (95.8384%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4866/5305 (91.7248%), train_poison_data_count: 415
Global model norm: 42.52274064168122.
Norm before scaling: 42.51775823847019. Distance: 1.9841294624827817
Total norm for 4 adversaries is: 42.51775823847019. distance: 1.9841294624827817
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1359, Accuracy: 9558/9900 (96.5455%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4275/4717 (90.6296%), train_poison_data_count: 370
Global model norm: 42.52274064168122.
Norm before scaling: 42.52350998409218. Distance: 1.9215278001730207
Total norm for 4 adversaries is: 42.52350998409218. distance: 1.9215278001730207
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.1859, Accuracy: 9412/9900 (95.0707%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  75, local model 71, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4556/5066 (89.9329%), train_poison_data_count: 400
Global model norm: 42.52274064168122.
Norm before scaling: 42.53000577946778. Distance: 2.0783537545178534
Total norm for 4 adversaries is: 42.53000577946778. distance: 2.0783537545178534
___Test Local_ResNet_18 poisoned: True, epoch: 75: Average loss: 0.2779, Accuracy: 9210/9900 (93.0303%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 5272/6124 (86.0875%)
___Train Local_ResNet_18,  epoch  75, local model 53, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5353/6124 (87.4102%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0051, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3964/4433 (89.4203%)
___Train Local_ResNet_18,  epoch  75, local model 33, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4031/4433 (90.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9480, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3380/3781 (89.3943%)
___Train Local_ResNet_18,  epoch  75, local model 79, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3207/3781 (84.8188%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.4294, Accuracy: 4779/10000 (47.7900%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3569/3969 (89.9219%)
___Train Local_ResNet_18,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3570/3969 (89.9471%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9860, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4463/5025 (88.8159%)
___Train Local_ResNet_18,  epoch  75, local model 80, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4535/5025 (90.2488%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2199, Accuracy: 5124/10000 (51.2400%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4195/4679 (89.6559%)
___Train Local_ResNet_18,  epoch  75, local model 96, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4236/4679 (90.5322%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0365, Accuracy: 5429/10000 (54.2900%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4152/4707 (88.2091%)
___Train Local_ResNet_18,  epoch  75, local model 47, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4221/4707 (89.6750%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.9974, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4441/4986 (89.0694%)
___Train Local_ResNet_18,  epoch  75, local model 1, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4485/4986 (89.9519%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8721, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3905/4315 (90.4983%)
___Train Local_ResNet_18,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3938/4315 (91.2630%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.8623, Accuracy: 5613/10000 (56.1300%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3847/4416 (87.1150%)
___Train Local_ResNet_18,  epoch  75, local model 74, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3924/4416 (88.8587%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0297, Accuracy: 5361/10000 (53.6100%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4249/4804 (88.4471%)
___Train Local_ResNet_18,  epoch  75, local model 94, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4082/4804 (84.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0921, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4175/4793 (87.1062%)
___Train Local_ResNet_18,  epoch  75, local model 84, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4282/4793 (89.3386%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0056, Accuracy: 5440/10000 (54.4000%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4554/5232 (87.0413%)
___Train Local_ResNet_18,  epoch  75, local model 22, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4527/5232 (86.5252%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0632, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4113/4662 (88.2239%)
___Train Local_ResNet_18,  epoch  75, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4203/4662 (90.1544%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0674, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4247/4956 (85.6941%)
___Train Local_ResNet_18,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4340/4956 (87.5706%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.2079, Accuracy: 5126/10000 (51.2600%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3816/4368 (87.3626%)
___Train Local_ResNet_18,  epoch  75, local model 50, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3836/4368 (87.8205%)
___Test Local_ResNet_18 poisoned: False, epoch: 75: Average loss: 2.0026, Accuracy: 5363/10000 (53.6300%)
time spent on training: 236.5701904296875
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 79, confusion matrix appended.
Validation completed for user 24, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 20, confusion matrix appended.
Validation completed for user 74, confusion matrix appended.
Validation completed for user 94, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 44, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 50, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 75: Average loss: 1.0876, Accuracy: 7075/10000 (70.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 75: Average loss: 5.7376, Accuracy: 1071/9900 (10.8182%)
Done in 260.2288179397583 sec.
Server Epoch:76 choose agents : [13, 36, 58, 71, 53, 25, 47, 77, 68, 92, 10, 46, 59, 23, 32, 21, 98, 76, 79, 39].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4468/4885 (91.4637%), train_poison_data_count: 385
Global model norm: 42.54706866233927.
Norm before scaling: 42.54742585945271. Distance: 1.923675871890107
Total norm for 4 adversaries is: 42.54742585945271. distance: 1.923675871890107
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2871, Accuracy: 9188/9900 (92.8081%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4854/5305 (91.4986%), train_poison_data_count: 415
Global model norm: 42.54706866233927.
Norm before scaling: 42.54394843956218. Distance: 1.954812747348775
Total norm for 4 adversaries is: 42.54394843956218. distance: 1.954812747348775
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2170, Accuracy: 9350/9900 (94.4444%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4314/4717 (91.4564%), train_poison_data_count: 370
Global model norm: 42.54706866233927.
Norm before scaling: 42.54701271553181. Distance: 1.863929747645145
Total norm for 4 adversaries is: 42.54701271553181. distance: 1.863929747645145
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.2406, Accuracy: 9295/9900 (93.8889%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4611/5066 (91.0186%), train_poison_data_count: 400
Global model norm: 42.54706866233927.
Norm before scaling: 42.551891287561325. Distance: 2.018991069749389
Total norm for 4 adversaries is: 42.551891287561325. distance: 2.018991069749389
___Test Local_ResNet_18 poisoned: True, epoch: 76: Average loss: 0.1125, Accuracy: 9607/9900 (97.0404%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0066, Accuracy: 5355/6124 (87.4428%)
___Train Local_ResNet_18,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0063, Accuracy: 5339/6124 (87.1816%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1167, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 5142/5902 (87.1230%)
___Train Local_ResNet_18,  epoch  76, local model 25, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5139/5902 (87.0722%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1010, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4187/4707 (88.9526%)
___Train Local_ResNet_18,  epoch  76, local model 47, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4232/4707 (89.9086%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8893, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4100/4647 (88.2290%)
___Train Local_ResNet_18,  epoch  76, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4179/4647 (89.9290%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9564, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2978/3297 (90.3245%)
___Train Local_ResNet_18,  epoch  76, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3026/3297 (91.7804%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.7985, Accuracy: 5833/10000 (58.3300%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5562/6263 (88.8073%)
___Train Local_ResNet_18,  epoch  76, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5653/6263 (90.2603%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.2060, Accuracy: 5101/10000 (51.0100%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4176/4663 (89.5561%)
___Train Local_ResNet_18,  epoch  76, local model 10, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4253/4663 (91.2074%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1066, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4344/4956 (87.6513%)
___Train Local_ResNet_18,  epoch  76, local model 46, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4318/4956 (87.1267%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1894, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3625/4046 (89.5947%)
___Train Local_ResNet_18,  epoch  76, local model 59, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3709/4046 (91.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9386, Accuracy: 5583/10000 (55.8300%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3735/4184 (89.2686%)
___Train Local_ResNet_18,  epoch  76, local model 23, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3785/4184 (90.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8602, Accuracy: 5615/10000 (56.1500%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4881/5591 (87.3010%)
___Train Local_ResNet_18,  epoch  76, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4902/5591 (87.6766%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1802, Accuracy: 5218/10000 (52.1800%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4099/4634 (88.4549%)
___Train Local_ResNet_18,  epoch  76, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4187/4634 (90.3539%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9136, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3397/3828 (88.7409%)
___Train Local_ResNet_18,  epoch  76, local model 98, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3493/3828 (91.2487%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9620, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3150/3638 (86.5860%)
___Train Local_ResNet_18,  epoch  76, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3281/3638 (90.1869%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.9080, Accuracy: 5574/10000 (55.7400%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3395/3781 (89.7911%)
___Train Local_ResNet_18,  epoch  76, local model 79, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3369/3781 (89.1034%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 2.1036, Accuracy: 5281/10000 (52.8100%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3420/3837 (89.1321%)
___Train Local_ResNet_18,  epoch  76, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3544/3837 (92.3638%)
___Test Local_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.8704, Accuracy: 5682/10000 (56.8200%)
time spent on training: 237.85558891296387
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 25, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 68, confusion matrix appended.
Validation completed for user 92, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 59, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 21, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 79, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 76: Average loss: 1.0854, Accuracy: 7076/10000 (70.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 76: Average loss: 5.1605, Accuracy: 1457/9900 (14.7172%)
Done in 261.56972002983093 sec.
Server Epoch:77 choose agents : [13, 36, 58, 71, 8, 31, 86, 21, 57, 35, 89, 28, 53, 65, 80, 3, 27, 7, 76, 69].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4476/4885 (91.6274%), train_poison_data_count: 385
Global model norm: 42.57051824252907.
Norm before scaling: 42.56874896766259. Distance: 1.8541764105494354
Total norm for 4 adversaries is: 42.56874896766259. distance: 1.8541764105494354
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2744, Accuracy: 9237/9900 (93.3030%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4879/5305 (91.9698%), train_poison_data_count: 415
Global model norm: 42.57051824252907.
Norm before scaling: 42.56792308971481. Distance: 1.9374912015653616
Total norm for 4 adversaries is: 42.56792308971481. distance: 1.9374912015653616
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1600, Accuracy: 9514/9900 (96.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 58, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4287/4717 (90.8840%), train_poison_data_count: 370
Global model norm: 42.57051824252907.
Norm before scaling: 42.57233618905298. Distance: 1.8832010208621373
Total norm for 4 adversaries is: 42.57233618905298. distance: 1.8832010208621373
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.1508, Accuracy: 9509/9900 (96.0505%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  77, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4625/5066 (91.2949%), train_poison_data_count: 400
Global model norm: 42.57051824252907.
Norm before scaling: 42.572261637567486. Distance: 1.947820249677028
Total norm for 4 adversaries is: 42.572261637567486. distance: 1.947820249677028
___Test Local_ResNet_18 poisoned: True, epoch: 77: Average loss: 0.2428, Accuracy: 9320/9900 (94.1414%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3905/4501 (86.7585%)
___Train Local_ResNet_18,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0062, Accuracy: 3947/4501 (87.6916%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1578, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3712/4175 (88.9102%)
___Train Local_ResNet_18,  epoch  77, local model 31, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3769/4175 (90.2754%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9716, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3165/3616 (87.5277%)
___Train Local_ResNet_18,  epoch  77, local model 86, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3238/3616 (89.5465%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8708, Accuracy: 5674/10000 (56.7400%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4069/4634 (87.8075%)
___Train Local_ResNet_18,  epoch  77, local model 21, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4100/4634 (88.4765%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9542, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4025/4558 (88.3063%)
___Train Local_ResNet_18,  epoch  77, local model 57, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3994/4558 (87.6262%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1559, Accuracy: 5100/10000 (51.0000%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4581/5167 (88.6588%)
___Train Local_ResNet_18,  epoch  77, local model 35, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4623/5167 (89.4716%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1410, Accuracy: 5272/10000 (52.7200%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3902/4356 (89.5776%)
___Train Local_ResNet_18,  epoch  77, local model 89, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3836/4356 (88.0624%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.2148, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4159/4716 (88.1891%)
___Train Local_ResNet_18,  epoch  77, local model 28, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4182/4716 (88.6768%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0943, Accuracy: 5283/10000 (52.8300%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5390/6124 (88.0144%)
___Train Local_ResNet_18,  epoch  77, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5300/6124 (86.5447%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0280, Accuracy: 5216/10000 (52.1600%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4469/5055 (88.4075%)
___Train Local_ResNet_18,  epoch  77, local model 65, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4553/5055 (90.0692%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.9910, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4515/5025 (89.8507%)
___Train Local_ResNet_18,  epoch  77, local model 80, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4602/5025 (91.5821%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.0765, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4368/4918 (88.8166%)
___Train Local_ResNet_18,  epoch  77, local model 3, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4379/4918 (89.0403%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1032, Accuracy: 5157/10000 (51.5700%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3760/4223 (89.0362%)
___Train Local_ResNet_18,  epoch  77, local model 27, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3804/4223 (90.0781%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8825, Accuracy: 5671/10000 (56.7100%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3925/4481 (87.5921%)
___Train Local_ResNet_18,  epoch  77, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3877/4481 (86.5209%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 2.1311, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3211/3638 (88.2628%)
___Train Local_ResNet_18,  epoch  77, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3288/3638 (90.3793%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8955, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3583/4013 (89.2848%)
___Train Local_ResNet_18,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3675/4013 (91.5774%)
___Test Local_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.8688, Accuracy: 5579/10000 (55.7900%)
time spent on training: 234.93070435523987
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 21, confusion matrix appended.
Validation completed for user 57, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Validation completed for user 28, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 65, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 77: Average loss: 1.0866, Accuracy: 7091/10000 (70.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 77: Average loss: 4.6186, Accuracy: 1981/9900 (20.0101%)
Done in 258.84582448005676 sec.
Server Epoch:78 choose agents : [13, 36, 58, 71, 2, 8, 93, 35, 40, 32, 96, 0, 84, 66, 42, 31, 67, 4, 22, 30].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4506/4885 (92.2416%), train_poison_data_count: 385
Global model norm: 42.59380731837669.
Norm before scaling: 42.59144573737783. Distance: 1.8370546229365603
Total norm for 4 adversaries is: 42.59144573737783. distance: 1.8370546229365603
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2295, Accuracy: 9327/9900 (94.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 36, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4857/5305 (91.5551%), train_poison_data_count: 415
Global model norm: 42.59380731837669.
Norm before scaling: 42.59057157528383. Distance: 1.9235232968566862
Total norm for 4 adversaries is: 42.59057157528383. distance: 1.9235232968566862
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.2321, Accuracy: 9345/9900 (94.3939%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 58, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4331/4717 (91.8168%), train_poison_data_count: 370
Global model norm: 42.59380731837669.
Norm before scaling: 42.59291457590467. Distance: 1.7821597402926719
Total norm for 4 adversaries is: 42.59291457590467. distance: 1.7821597402926719
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.4184, Accuracy: 8879/9900 (89.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  78, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4611/5066 (91.0186%), train_poison_data_count: 400
Global model norm: 42.59380731837669.
Norm before scaling: 42.59487342612371. Distance: 1.9518859595224083
Total norm for 4 adversaries is: 42.59487342612371. distance: 1.9518859595224083
___Test Local_ResNet_18 poisoned: True, epoch: 78: Average loss: 0.1452, Accuracy: 9532/9900 (96.2828%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3216/3646 (88.2063%)
___Train Local_ResNet_18,  epoch  78, local model 2, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3329/3646 (91.3055%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.7804, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3959/4501 (87.9582%)
___Train Local_ResNet_18,  epoch  78, local model 8, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4035/4501 (89.6467%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9966, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4108/4651 (88.3251%)
___Train Local_ResNet_18,  epoch  78, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4192/4651 (90.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9680, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4584/5167 (88.7169%)
___Train Local_ResNet_18,  epoch  78, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4653/5167 (90.0523%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1803, Accuracy: 5178/10000 (51.7800%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4912/5455 (90.0458%)
___Train Local_ResNet_18,  epoch  78, local model 40, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4888/5455 (89.6059%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0156, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4904/5591 (87.7124%)
___Train Local_ResNet_18,  epoch  78, local model 32, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4893/5591 (87.5157%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0758, Accuracy: 5237/10000 (52.3700%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4226/4679 (90.3184%)
___Train Local_ResNet_18,  epoch  78, local model 96, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4131/4679 (88.2881%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2236, Accuracy: 5071/10000 (50.7100%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4477/5017 (89.2366%)
___Train Local_ResNet_18,  epoch  78, local model 0, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4519/5017 (90.0737%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9170, Accuracy: 5579/10000 (55.7900%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4277/4793 (89.2343%)
___Train Local_ResNet_18,  epoch  78, local model 84, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4312/4793 (89.9645%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.0363, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4025/4456 (90.3276%)
___Train Local_ResNet_18,  epoch  78, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4095/4456 (91.8986%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.8738, Accuracy: 5683/10000 (56.8300%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4827/5424 (88.9934%)
___Train Local_ResNet_18,  epoch  78, local model 42, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4901/5424 (90.3577%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.2638, Accuracy: 5103/10000 (51.0300%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3685/4175 (88.2635%)
___Train Local_ResNet_18,  epoch  78, local model 31, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3698/4175 (88.5749%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9112, Accuracy: 5585/10000 (55.8500%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4563/5116 (89.1908%)
___Train Local_ResNet_18,  epoch  78, local model 67, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4586/5116 (89.6403%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9674, Accuracy: 5473/10000 (54.7300%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3308/3704 (89.3089%)
___Train Local_ResNet_18,  epoch  78, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3345/3704 (90.3078%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.9836, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4517/5232 (86.3341%)
___Train Local_ResNet_18,  epoch  78, local model 22, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4633/5232 (88.5512%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1227, Accuracy: 5217/10000 (52.1700%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3101/3472 (89.3145%)
___Train Local_ResNet_18,  epoch  78, local model 30, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3173/3472 (91.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 78: Average loss: 2.1015, Accuracy: 5457/10000 (54.5700%)
time spent on training: 237.14723801612854
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 93, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 67, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 78: Average loss: 1.0897, Accuracy: 7067/10000 (70.6700%)
___Test Target_ResNet_18 poisoned: True, epoch: 78: Average loss: 4.1123, Accuracy: 2568/9900 (25.9394%)
Done in 260.8801920413971 sec.
Server Epoch:79 choose agents : [13, 36, 58, 71, 63, 50, 4, 19, 55, 18, 93, 23, 29, 84, 60, 1, 53, 47, 73, 59].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4514/4885 (92.4053%), train_poison_data_count: 385
Global model norm: 42.61752047876334.
Norm before scaling: 42.61549249035276. Distance: 1.805944822197213
Total norm for 4 adversaries is: 42.61549249035276. distance: 1.805944822197213
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1873, Accuracy: 9444/9900 (95.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 36, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4878/5305 (91.9510%), train_poison_data_count: 415
Global model norm: 42.61752047876334.
Norm before scaling: 42.611570866135494. Distance: 1.881295317043826
Total norm for 4 adversaries is: 42.611570866135494. distance: 1.881295317043826
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.2012, Accuracy: 9429/9900 (95.2424%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4324/4717 (91.6684%), train_poison_data_count: 370
Global model norm: 42.61752047876334.
Norm before scaling: 42.61442116938305. Distance: 1.7846355054331984
Total norm for 4 adversaries is: 42.61442116938305. distance: 1.7846355054331984
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.1497, Accuracy: 9536/9900 (96.3232%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  79, local model 71, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4643/5066 (91.6502%), train_poison_data_count: 400
Global model norm: 42.61752047876334.
Norm before scaling: 42.6185344367807. Distance: 1.9196948579861124
Total norm for 4 adversaries is: 42.6185344367807. distance: 1.9196948579861124
___Test Local_ResNet_18 poisoned: True, epoch: 79: Average loss: 0.3736, Accuracy: 8977/9900 (90.6768%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3238/3590 (90.1950%)
___Train Local_ResNet_18,  epoch  79, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3333/3590 (92.8412%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9562, Accuracy: 5662/10000 (56.6200%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3880/4368 (88.8278%)
___Train Local_ResNet_18,  epoch  79, local model 50, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3848/4368 (88.0952%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8685, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3302/3704 (89.1469%)
___Train Local_ResNet_18,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3384/3704 (91.3607%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9491, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4359/4928 (88.4537%)
___Train Local_ResNet_18,  epoch  79, local model 19, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4354/4928 (88.3523%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0556, Accuracy: 5289/10000 (52.8900%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3917/4356 (89.9219%)
___Train Local_ResNet_18,  epoch  79, local model 55, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3878/4356 (89.0266%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.2027, Accuracy: 5191/10000 (51.9100%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3510/3911 (89.7469%)
___Train Local_ResNet_18,  epoch  79, local model 18, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3354/3911 (85.7581%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1796, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4155/4651 (89.3356%)
___Train Local_ResNet_18,  epoch  79, local model 93, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4170/4651 (89.6581%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0877, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3754/4184 (89.7228%)
___Train Local_ResNet_18,  epoch  79, local model 23, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3785/4184 (90.4637%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9165, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3940/4346 (90.6581%)
___Train Local_ResNet_18,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3998/4346 (91.9926%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8867, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4226/4793 (88.1702%)
___Train Local_ResNet_18,  epoch  79, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4361/4793 (90.9869%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9636, Accuracy: 5499/10000 (54.9900%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3429/3804 (90.1420%)
___Train Local_ResNet_18,  epoch  79, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3487/3804 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9176, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4497/4986 (90.1925%)
___Train Local_ResNet_18,  epoch  79, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4478/4986 (89.8115%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.8405, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5365/6124 (87.6061%)
___Train Local_ResNet_18,  epoch  79, local model 53, internal_epoch   2,  Average loss: 0.0067, Accuracy: 5296/6124 (86.4794%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.1900, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4193/4707 (89.0801%)
___Train Local_ResNet_18,  epoch  79, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4252/4707 (90.3335%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.9195, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3827/4235 (90.3660%)
___Train Local_ResNet_18,  epoch  79, local model 73, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3720/4235 (87.8394%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0475, Accuracy: 5452/10000 (54.5200%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3661/4046 (90.4844%)
___Train Local_ResNet_18,  epoch  79, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3692/4046 (91.2506%)
___Test Local_ResNet_18 poisoned: False, epoch: 79: Average loss: 2.0099, Accuracy: 5370/10000 (53.7000%)
time spent on training: 232.75947833061218
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 50, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 93, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 29, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 59, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 79: Average loss: 1.0958, Accuracy: 7051/10000 (70.5100%)
___Test Target_ResNet_18 poisoned: True, epoch: 79: Average loss: 3.6458, Accuracy: 3169/9900 (32.0101%)
Done in 256.90544986724854 sec.
Server Epoch:80 choose agents : [13, 36, 58, 71, 1, 21, 28, 53, 3, 52, 15, 46, 33, 37, 16, 18, 7, 49, 40, 97].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4549/4885 (93.1218%), train_poison_data_count: 385
Global model norm: 42.639834868091654.
Norm before scaling: 42.63412458467469. Distance: 1.7729643472011876
Total norm for 4 adversaries is: 42.63412458467469. distance: 1.7729643472011876
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.0626, Accuracy: 9735/9900 (98.3333%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4902/5305 (92.4034%), train_poison_data_count: 415
Global model norm: 42.639834868091654.
Norm before scaling: 42.635563321781326. Distance: 1.843833274900386
Total norm for 4 adversaries is: 42.635563321781326. distance: 1.843833274900386
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1002, Accuracy: 9653/9900 (97.5051%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4346/4717 (92.1348%), train_poison_data_count: 370
Global model norm: 42.639834868091654.
Norm before scaling: 42.63684740732994. Distance: 1.747877605063906
Total norm for 4 adversaries is: 42.63684740732994. distance: 1.747877605063906
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.3247, Accuracy: 9156/9900 (92.4848%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  80, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4627/5066 (91.3344%), train_poison_data_count: 400
Global model norm: 42.639834868091654.
Norm before scaling: 42.64133352974919. Distance: 1.9404847320136849
Total norm for 4 adversaries is: 42.64133352974919. distance: 1.9404847320136849
___Test Local_ResNet_18 poisoned: True, epoch: 80: Average loss: 0.1734, Accuracy: 9459/9900 (95.5455%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4453/4986 (89.3101%)
___Train Local_ResNet_18,  epoch  80, local model 1, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4470/4986 (89.6510%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0649, Accuracy: 5460/10000 (54.6000%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4069/4634 (87.8075%)
___Train Local_ResNet_18,  epoch  80, local model 21, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4145/4634 (89.4476%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8578, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4170/4716 (88.4224%)
___Train Local_ResNet_18,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4210/4716 (89.2706%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1448, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5366/6124 (87.6225%)
___Train Local_ResNet_18,  epoch  80, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5401/6124 (88.1940%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0707, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4399/4918 (89.4469%)
___Train Local_ResNet_18,  epoch  80, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4502/4918 (91.5413%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0713, Accuracy: 5293/10000 (52.9300%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3408/3797 (89.7551%)
___Train Local_ResNet_18,  epoch  80, local model 52, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3421/3797 (90.0974%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0416, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5008/5582 (89.7169%)
___Train Local_ResNet_18,  epoch  80, local model 15, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5023/5582 (89.9857%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1483, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4342/4956 (87.6110%)
___Train Local_ResNet_18,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4362/4956 (88.0145%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1612, Accuracy: 5131/10000 (51.3100%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4015/4433 (90.5707%)
___Train Local_ResNet_18,  epoch  80, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4054/4433 (91.4505%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8703, Accuracy: 5696/10000 (56.9600%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3885/4354 (89.2283%)
___Train Local_ResNet_18,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0111, Accuracy: 3422/4354 (78.5944%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.4578, Accuracy: 4682/10000 (46.8200%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4354/4928 (88.3523%)
___Train Local_ResNet_18,  epoch  80, local model 16, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4400/4928 (89.2857%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.8415, Accuracy: 5641/10000 (56.4100%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3490/3911 (89.2355%)
___Train Local_ResNet_18,  epoch  80, local model 18, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3469/3911 (88.6985%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9683, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3871/4481 (86.3870%)
___Train Local_ResNet_18,  epoch  80, local model 7, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3820/4481 (85.2488%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0576, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4606/5197 (88.6281%)
___Train Local_ResNet_18,  epoch  80, local model 49, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4584/5197 (88.2047%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.0186, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4846/5455 (88.8359%)
___Train Local_ResNet_18,  epoch  80, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4899/5455 (89.8075%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.9983, Accuracy: 5409/10000 (54.0900%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3837/4361 (87.9844%)
___Train Local_ResNet_18,  epoch  80, local model 97, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3811/4361 (87.3882%)
___Test Local_ResNet_18 poisoned: False, epoch: 80: Average loss: 2.1871, Accuracy: 5194/10000 (51.9400%)
time spent on training: 238.47951459884644
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 21, confusion matrix appended.
Validation completed for user 28, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 80: Average loss: 1.1021, Accuracy: 7052/10000 (70.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 80: Average loss: 3.2683, Accuracy: 3672/9900 (37.0909%)
Done in 262.5261015892029 sec.
Server Epoch:81 choose agents : [13, 36, 58, 71, 19, 23, 47, 98, 64, 44, 73, 11, 84, 7, 29, 97, 65, 54, 20, 10].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4537/4885 (92.8762%), train_poison_data_count: 385
Global model norm: 42.665466609608586.
Norm before scaling: 42.664902968511484. Distance: 1.7746908993292978
Total norm for 4 adversaries is: 42.664902968511484. distance: 1.7746908993292978
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1523, Accuracy: 9543/9900 (96.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4914/5305 (92.6296%), train_poison_data_count: 415
Global model norm: 42.665466609608586.
Norm before scaling: 42.65846634580951. Distance: 1.8289085730367227
Total norm for 4 adversaries is: 42.65846634580951. distance: 1.8289085730367227
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1419, Accuracy: 9513/9900 (96.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 58, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4363/4717 (92.4952%), train_poison_data_count: 370
Global model norm: 42.665466609608586.
Norm before scaling: 42.6595351299097. Distance: 1.7102523198161503
Total norm for 4 adversaries is: 42.6595351299097. distance: 1.7102523198161503
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.0670, Accuracy: 9721/9900 (98.1919%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  81, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4630/5066 (91.3936%), train_poison_data_count: 400
Global model norm: 42.665466609608586.
Norm before scaling: 42.66793710088774. Distance: 1.9065987314890487
Total norm for 4 adversaries is: 42.66793710088774. distance: 1.9065987314890487
___Test Local_ResNet_18 poisoned: True, epoch: 81: Average loss: 0.1647, Accuracy: 9493/9900 (95.8889%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4342/4928 (88.1088%)
___Train Local_ResNet_18,  epoch  81, local model 19, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4377/4928 (88.8190%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9589, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3791/4184 (90.6071%)
___Train Local_ResNet_18,  epoch  81, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3828/4184 (91.4914%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8883, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4266/4707 (90.6310%)
___Train Local_ResNet_18,  epoch  81, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4248/4707 (90.2486%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9902, Accuracy: 5485/10000 (54.8500%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3445/3828 (89.9948%)
___Train Local_ResNet_18,  epoch  81, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3541/3828 (92.5026%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.8548, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4016/4503 (89.1850%)
___Train Local_ResNet_18,  epoch  81, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4038/4503 (89.6736%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0828, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4198/4662 (90.0472%)
___Train Local_ResNet_18,  epoch  81, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4239/4662 (90.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9365, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3786/4235 (89.3979%)
___Train Local_ResNet_18,  epoch  81, local model 73, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3830/4235 (90.4368%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0851, Accuracy: 5305/10000 (53.0500%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0074, Accuracy: 4449/5244 (84.8398%)
___Train Local_ResNet_18,  epoch  81, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 4475/5244 (85.3356%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9975, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4268/4793 (89.0465%)
___Train Local_ResNet_18,  epoch  81, local model 84, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4346/4793 (90.6739%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9547, Accuracy: 5508/10000 (55.0800%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3990/4481 (89.0426%)
___Train Local_ResNet_18,  epoch  81, local model 7, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3872/4481 (86.4093%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.2631, Accuracy: 5143/10000 (51.4300%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3963/4346 (91.1873%)
___Train Local_ResNet_18,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4042/4346 (93.0051%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.7647, Accuracy: 5820/10000 (58.2000%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3843/4361 (88.1220%)
___Train Local_ResNet_18,  epoch  81, local model 97, internal_epoch   2,  Average loss: 0.0081, Accuracy: 3694/4361 (84.7053%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1826, Accuracy: 5117/10000 (51.1700%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4564/5055 (90.2868%)
___Train Local_ResNet_18,  epoch  81, local model 65, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4566/5055 (90.3264%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9289, Accuracy: 5602/10000 (56.0200%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4586/5195 (88.2772%)
___Train Local_ResNet_18,  epoch  81, local model 54, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4514/5195 (86.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.1171, Accuracy: 5314/10000 (53.1400%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3941/4315 (91.3326%)
___Train Local_ResNet_18,  epoch  81, local model 20, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3999/4315 (92.6767%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.9843, Accuracy: 5492/10000 (54.9200%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4225/4663 (90.6069%)
___Train Local_ResNet_18,  epoch  81, local model 10, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4289/4663 (91.9794%)
___Test Local_ResNet_18 poisoned: False, epoch: 81: Average loss: 2.0927, Accuracy: 5312/10000 (53.1200%)
time spent on training: 233.15448546409607
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 64, confusion matrix appended.
Validation completed for user 44, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 29, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 65, confusion matrix appended.
Validation completed for user 54, confusion matrix appended.
Validation completed for user 20, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 81: Average loss: 1.1053, Accuracy: 7034/10000 (70.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 81: Average loss: 2.8700, Accuracy: 4240/9900 (42.8283%)
Done in 257.11559987068176 sec.
Server Epoch:82 choose agents : [13, 36, 58, 71, 20, 63, 96, 35, 51, 98, 73, 77, 3, 33, 7, 75, 64, 37, 1, 92].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4550/4885 (93.1423%), train_poison_data_count: 385
Global model norm: 42.68885830104706.
Norm before scaling: 42.684944847118665. Distance: 1.6967867580674083
Total norm for 4 adversaries is: 42.684944847118665. distance: 1.6967867580674083
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1705, Accuracy: 9490/9900 (95.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4920/5305 (92.7427%), train_poison_data_count: 415
Global model norm: 42.68885830104706.
Norm before scaling: 42.683941046278605. Distance: 1.8147343642416096
Total norm for 4 adversaries is: 42.683941046278605. distance: 1.8147343642416096
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.2352, Accuracy: 9320/9900 (94.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4380/4717 (92.8556%), train_poison_data_count: 370
Global model norm: 42.68885830104706.
Norm before scaling: 42.683045899122085. Distance: 1.6697492543730175
Total norm for 4 adversaries is: 42.683045899122085. distance: 1.6697492543730175
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1793, Accuracy: 9482/9900 (95.7778%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  82, local model 71, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4671/5066 (92.2029%), train_poison_data_count: 400
Global model norm: 42.68885830104706.
Norm before scaling: 42.688976971611915. Distance: 1.8427159917516656
Total norm for 4 adversaries is: 42.688976971611915. distance: 1.8427159917516656
___Test Local_ResNet_18 poisoned: True, epoch: 82: Average loss: 0.1445, Accuracy: 9529/9900 (96.2525%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3982/4315 (92.2827%)
___Train Local_ResNet_18,  epoch  82, local model 20, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3955/4315 (91.6570%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8449, Accuracy: 5728/10000 (57.2800%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3279/3590 (91.3370%)
___Train Local_ResNet_18,  epoch  82, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3211/3590 (89.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1497, Accuracy: 5379/10000 (53.7900%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4217/4679 (90.1261%)
___Train Local_ResNet_18,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4233/4679 (90.4680%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9396, Accuracy: 5521/10000 (55.2100%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4637/5167 (89.7426%)
___Train Local_ResNet_18,  epoch  82, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4666/5167 (90.3039%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0558, Accuracy: 5318/10000 (53.1800%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3393/3775 (89.8808%)
___Train Local_ResNet_18,  epoch  82, local model 51, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3522/3775 (93.2980%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8575, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3446/3828 (90.0209%)
___Train Local_ResNet_18,  epoch  82, local model 98, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3500/3828 (91.4316%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.8304, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3813/4235 (90.0354%)
___Train Local_ResNet_18,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3834/4235 (90.5313%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9824, Accuracy: 5486/10000 (54.8600%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4151/4647 (89.3264%)
___Train Local_ResNet_18,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4212/4647 (90.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9542, Accuracy: 5517/10000 (55.1700%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4418/4918 (89.8333%)
___Train Local_ResNet_18,  epoch  82, local model 3, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4466/4918 (90.8093%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0384, Accuracy: 5308/10000 (53.0800%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4023/4433 (90.7512%)
___Train Local_ResNet_18,  epoch  82, local model 33, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4017/4433 (90.6158%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.0265, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3984/4481 (88.9087%)
___Train Local_ResNet_18,  epoch  82, local model 7, internal_epoch   2,  Average loss: 0.0077, Accuracy: 3870/4481 (86.3647%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1337, Accuracy: 5338/10000 (53.3800%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3829/4295 (89.1502%)
___Train Local_ResNet_18,  epoch  82, local model 75, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3675/4295 (85.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1871, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4016/4503 (89.1850%)
___Train Local_ResNet_18,  epoch  82, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4032/4503 (89.5403%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9980, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3866/4354 (88.7919%)
___Train Local_ResNet_18,  epoch  82, local model 37, internal_epoch   2,  Average loss: 0.0097, Accuracy: 3582/4354 (82.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.5331, Accuracy: 4598/10000 (45.9800%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4496/4986 (90.1725%)
___Train Local_ResNet_18,  epoch  82, local model 1, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4448/4986 (89.2098%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.9937, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5593/6263 (89.3023%)
___Train Local_ResNet_18,  epoch  82, local model 92, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5698/6263 (90.9788%)
___Test Local_ResNet_18 poisoned: False, epoch: 82: Average loss: 2.1240, Accuracy: 5228/10000 (52.2800%)
time spent on training: 234.5146520137787
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 20, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 51, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 75, confusion matrix appended.
Validation completed for user 64, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 92, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 82: Average loss: 1.1176, Accuracy: 6997/10000 (69.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 82: Average loss: 2.5650, Accuracy: 4755/9900 (48.0303%)
Done in 286.22493863105774 sec.
Server Epoch:83 choose agents : [13, 36, 58, 71, 27, 40, 15, 99, 32, 18, 55, 45, 96, 90, 34, 12, 69, 49, 68, 48].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4538/4885 (92.8966%), train_poison_data_count: 385
Global model norm: 42.71192280393585.
Norm before scaling: 42.707108245894645. Distance: 1.7323879509564302
Total norm for 4 adversaries is: 42.707108245894645. distance: 1.7323879509564302
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1560, Accuracy: 9521/9900 (96.1717%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4903/5305 (92.4222%), train_poison_data_count: 415
Global model norm: 42.71192280393585.
Norm before scaling: 42.70766561342867. Distance: 1.875449126812389
Total norm for 4 adversaries is: 42.70766561342867. distance: 1.875449126812389
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0751, Accuracy: 9701/9900 (97.9899%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4389/4717 (93.0464%), train_poison_data_count: 370
Global model norm: 42.71192280393585.
Norm before scaling: 42.70410119401956. Distance: 1.6499960523615922
Total norm for 4 adversaries is: 42.70410119401956. distance: 1.6499960523615922
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.1597, Accuracy: 9520/9900 (96.1616%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  83, local model 71, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4683/5066 (92.4398%), train_poison_data_count: 400
Global model norm: 42.71192280393585.
Norm before scaling: 42.71023798471436. Distance: 1.8271983479829725
Total norm for 4 adversaries is: 42.71023798471436. distance: 1.8271983479829725
___Test Local_ResNet_18 poisoned: True, epoch: 83: Average loss: 0.0554, Accuracy: 9767/9900 (98.6566%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3757/4223 (88.9652%)
___Train Local_ResNet_18,  epoch  83, local model 27, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3839/4223 (90.9069%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9668, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4935/5455 (90.4675%)
___Train Local_ResNet_18,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4863/5455 (89.1476%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1113, Accuracy: 5254/10000 (52.5400%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5095/5582 (91.2755%)
___Train Local_ResNet_18,  epoch  83, local model 15, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5087/5582 (91.1322%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1807, Accuracy: 5194/10000 (51.9400%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4022/4465 (90.0784%)
___Train Local_ResNet_18,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4058/4465 (90.8847%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8788, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4974/5591 (88.9644%)
___Train Local_ResNet_18,  epoch  83, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4946/5591 (88.4636%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.3467, Accuracy: 4969/10000 (49.6900%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3532/3911 (90.3094%)
___Train Local_ResNet_18,  epoch  83, local model 18, internal_epoch   2,  Average loss: 0.0069, Accuracy: 3418/3911 (87.3945%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0354, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3911/4356 (89.7842%)
___Train Local_ResNet_18,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0146, Accuracy: 3263/4356 (74.9082%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.6093, Accuracy: 4454/10000 (44.5400%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4478/5037 (88.9021%)
___Train Local_ResNet_18,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4545/5037 (90.2323%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.8863, Accuracy: 5514/10000 (55.1400%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4253/4679 (90.8955%)
___Train Local_ResNet_18,  epoch  83, local model 96, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4214/4679 (90.0620%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1975, Accuracy: 5140/10000 (51.4000%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3995/4362 (91.5864%)
___Train Local_ResNet_18,  epoch  83, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3920/4362 (89.8670%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1273, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4129/4518 (91.3900%)
___Train Local_ResNet_18,  epoch  83, local model 34, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4164/4518 (92.1647%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.9788, Accuracy: 5433/10000 (54.3300%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4520/5083 (88.9239%)
___Train Local_ResNet_18,  epoch  83, local model 12, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4512/5083 (88.7665%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1516, Accuracy: 5226/10000 (52.2600%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3596/4013 (89.6088%)
___Train Local_ResNet_18,  epoch  83, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3723/4013 (92.7735%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7730, Accuracy: 5705/10000 (57.0500%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4621/5197 (88.9167%)
___Train Local_ResNet_18,  epoch  83, local model 49, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4646/5197 (89.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.1437, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2985/3297 (90.5369%)
___Train Local_ResNet_18,  epoch  83, local model 68, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3055/3297 (92.6600%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.7995, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4036/4441 (90.8804%)
___Train Local_ResNet_18,  epoch  83, local model 48, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4024/4441 (90.6102%)
___Test Local_ResNet_18 poisoned: False, epoch: 83: Average loss: 2.0010, Accuracy: 5514/10000 (55.1400%)
time spent on training: 239.76160836219788
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 68, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 83: Average loss: 1.1191, Accuracy: 7011/10000 (70.1100%)
___Test Target_ResNet_18 poisoned: True, epoch: 83: Average loss: 2.3004, Accuracy: 5181/9900 (52.3333%)
Done in 264.61828446388245 sec.
Server Epoch:84 choose agents : [13, 36, 58, 71, 8, 17, 37, 29, 47, 32, 77, 6, 88, 94, 92, 7, 62, 27, 48, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4544/4885 (93.0194%), train_poison_data_count: 385
Global model norm: 42.734944865944456.
Norm before scaling: 42.72982579762422. Distance: 1.720852000002108
Total norm for 4 adversaries is: 42.72982579762422. distance: 1.720852000002108
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.0897, Accuracy: 9688/9900 (97.8586%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 36, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4918/5305 (92.7050%), train_poison_data_count: 415
Global model norm: 42.734944865944456.
Norm before scaling: 42.7268474860216. Distance: 1.7468309318429645
Total norm for 4 adversaries is: 42.7268474860216. distance: 1.7468309318429645
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.2873, Accuracy: 9250/9900 (93.4343%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4407/4717 (93.4280%), train_poison_data_count: 370
Global model norm: 42.734944865944456.
Norm before scaling: 42.72796027038019. Distance: 1.653629100644818
Total norm for 4 adversaries is: 42.72796027038019. distance: 1.653629100644818
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.3017, Accuracy: 9130/9900 (92.2222%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  84, local model 71, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4667/5066 (92.1240%), train_poison_data_count: 400
Global model norm: 42.734944865944456.
Norm before scaling: 42.733782274225824. Distance: 1.8287793154136622
Total norm for 4 adversaries is: 42.733782274225824. distance: 1.8287793154136622
___Test Local_ResNet_18 poisoned: True, epoch: 84: Average loss: 0.1780, Accuracy: 9450/9900 (95.4545%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4034/4501 (89.6245%)
___Train Local_ResNet_18,  epoch  84, local model 8, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4029/4501 (89.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0254, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4035/4511 (89.4480%)
___Train Local_ResNet_18,  epoch  84, local model 17, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4089/4511 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9453, Accuracy: 5477/10000 (54.7700%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3908/4354 (89.7565%)
___Train Local_ResNet_18,  epoch  84, local model 37, internal_epoch   2,  Average loss: 0.0104, Accuracy: 3477/4354 (79.8576%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.5976, Accuracy: 4432/10000 (44.3200%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3972/4346 (91.3944%)
___Train Local_ResNet_18,  epoch  84, local model 29, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4034/4346 (92.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8560, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4245/4707 (90.1848%)
___Train Local_ResNet_18,  epoch  84, local model 47, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4284/4707 (91.0134%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9059, Accuracy: 5553/10000 (55.5300%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4936/5591 (88.2847%)
___Train Local_ResNet_18,  epoch  84, local model 32, internal_epoch   2,  Average loss: 0.0060, Accuracy: 4913/5591 (87.8734%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0409, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4129/4647 (88.8530%)
___Train Local_ResNet_18,  epoch  84, local model 77, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4192/4647 (90.2087%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8981, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4123/4538 (90.8550%)
___Train Local_ResNet_18,  epoch  84, local model 6, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4204/4538 (92.6399%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.8791, Accuracy: 5595/10000 (55.9500%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4377/4934 (88.7110%)
___Train Local_ResNet_18,  epoch  84, local model 88, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4370/4934 (88.5691%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.2569, Accuracy: 5106/10000 (51.0600%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4336/4804 (90.2581%)
___Train Local_ResNet_18,  epoch  84, local model 94, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4284/4804 (89.1757%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0336, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5703/6263 (91.0586%)
___Train Local_ResNet_18,  epoch  84, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5673/6263 (90.5796%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.3161, Accuracy: 5077/10000 (50.7700%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0071, Accuracy: 3976/4481 (88.7302%)
___Train Local_ResNet_18,  epoch  84, local model 7, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3934/4481 (87.7929%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0200, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4455/5063 (87.9913%)
___Train Local_ResNet_18,  epoch  84, local model 62, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4434/5063 (87.5765%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0664, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3745/4223 (88.6810%)
___Train Local_ResNet_18,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3865/4223 (91.5226%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9781, Accuracy: 5511/10000 (55.1100%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4070/4441 (91.6460%)
___Train Local_ResNet_18,  epoch  84, local model 48, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4114/4441 (92.6368%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 2.0418, Accuracy: 5525/10000 (55.2500%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3412/3756 (90.8413%)
___Train Local_ResNet_18,  epoch  84, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3480/3756 (92.6518%)
___Test Local_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.9051, Accuracy: 5603/10000 (56.0300%)
time spent on training: 237.5411069393158
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 29, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 88, confusion matrix appended.
Validation completed for user 94, confusion matrix appended.
Validation completed for user 92, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 26, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 84: Average loss: 1.1253, Accuracy: 6995/10000 (69.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 84: Average loss: 2.0563, Accuracy: 5588/9900 (56.4444%)
Done in 261.70815896987915 sec.
Server Epoch:85 choose agents : [13, 36, 58, 71, 11, 16, 60, 69, 91, 15, 40, 37, 33, 2, 34, 73, 90, 70, 32, 26].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4583/4885 (93.8178%), train_poison_data_count: 385
Global model norm: 42.75830996764328.
Norm before scaling: 42.75107506186613. Distance: 1.6695534818433795
Total norm for 4 adversaries is: 42.75107506186613. distance: 1.6695534818433795
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1245, Accuracy: 9599/9900 (96.9596%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 36, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4927/5305 (92.8746%), train_poison_data_count: 415
Global model norm: 42.75830996764328.
Norm before scaling: 42.754764046043015. Distance: 1.8432147655443671
Total norm for 4 adversaries is: 42.754764046043015. distance: 1.8432147655443671
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.0620, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4395/4717 (93.1736%), train_poison_data_count: 370
Global model norm: 42.75830996764328.
Norm before scaling: 42.75173322053008. Distance: 1.6222009026347233
Total norm for 4 adversaries is: 42.75173322053008. distance: 1.6222009026347233
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.2126, Accuracy: 9376/9900 (94.7071%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  85, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4720/5066 (93.1702%), train_poison_data_count: 400
Global model norm: 42.75830996764328.
Norm before scaling: 42.752671186192416. Distance: 1.7561104905726994
Total norm for 4 adversaries is: 42.752671186192416. distance: 1.7561104905726994
___Test Local_ResNet_18 poisoned: True, epoch: 85: Average loss: 0.1932, Accuracy: 9409/9900 (95.0404%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4491/5244 (85.6407%)
___Train Local_ResNet_18,  epoch  85, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 4536/5244 (86.4989%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0380, Accuracy: 5285/10000 (52.8500%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4435/4928 (89.9959%)
___Train Local_ResNet_18,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4449/4928 (90.2800%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8905, Accuracy: 5645/10000 (56.4500%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3433/3804 (90.2471%)
___Train Local_ResNet_18,  epoch  85, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3478/3804 (91.4301%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9499, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3651/4013 (90.9793%)
___Train Local_ResNet_18,  epoch  85, local model 69, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3677/4013 (91.6272%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8560, Accuracy: 5647/10000 (56.4700%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3638/4158 (87.4940%)
___Train Local_ResNet_18,  epoch  85, local model 91, internal_epoch   2,  Average loss: 0.0065, Accuracy: 3620/4158 (87.0611%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9561, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5115/5582 (91.6338%)
___Train Local_ResNet_18,  epoch  85, local model 15, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5058/5582 (90.6127%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0773, Accuracy: 5258/10000 (52.5800%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4902/5455 (89.8625%)
___Train Local_ResNet_18,  epoch  85, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4945/5455 (90.6508%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9443, Accuracy: 5530/10000 (55.3000%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3900/4354 (89.5728%)
___Train Local_ResNet_18,  epoch  85, local model 37, internal_epoch   2,  Average loss: 0.0108, Accuracy: 3507/4354 (80.5466%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.5854, Accuracy: 4558/10000 (45.5800%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4029/4433 (90.8865%)
___Train Local_ResNet_18,  epoch  85, local model 33, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4051/4433 (91.3828%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9790, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3244/3646 (88.9742%)
___Train Local_ResNet_18,  epoch  85, local model 2, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3335/3646 (91.4701%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.8875, Accuracy: 5557/10000 (55.5700%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4090/4518 (90.5268%)
___Train Local_ResNet_18,  epoch  85, local model 34, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4101/4518 (90.7703%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0037, Accuracy: 5459/10000 (54.5900%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3865/4235 (91.2633%)
___Train Local_ResNet_18,  epoch  85, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3792/4235 (89.5396%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2037, Accuracy: 5138/10000 (51.3800%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4008/4362 (91.8845%)
___Train Local_ResNet_18,  epoch  85, local model 90, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3931/4362 (90.1192%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.0744, Accuracy: 5374/10000 (53.7400%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4860/5392 (90.1335%)
___Train Local_ResNet_18,  epoch  85, local model 70, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4741/5392 (87.9266%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.1831, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4933/5591 (88.2311%)
___Train Local_ResNet_18,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4903/5591 (87.6945%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 2.2519, Accuracy: 5013/10000 (50.1300%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3416/3756 (90.9478%)
___Train Local_ResNet_18,  epoch  85, local model 26, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3472/3756 (92.4388%)
___Test Local_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.9562, Accuracy: 5672/10000 (56.7200%)
time spent on training: 236.35044980049133
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 70, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 26, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 85: Average loss: 1.1311, Accuracy: 6991/10000 (69.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 85: Average loss: 1.8334, Accuracy: 5994/9900 (60.5455%)
Done in 261.07125449180603 sec.
Server Epoch:86 choose agents : [13, 36, 58, 71, 21, 64, 16, 60, 63, 77, 95, 55, 52, 66, 78, 30, 68, 74, 89, 76].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4559/4885 (93.3265%), train_poison_data_count: 385
Global model norm: 42.78150965498266.
Norm before scaling: 42.77337257415164. Distance: 1.6764451781336231
Total norm for 4 adversaries is: 42.77337257415164. distance: 1.6764451781336231
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0935, Accuracy: 9656/9900 (97.5354%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4937/5305 (93.0631%), train_poison_data_count: 415
Global model norm: 42.78150965498266.
Norm before scaling: 42.7727518495274. Distance: 1.7766614337841693
Total norm for 4 adversaries is: 42.7727518495274. distance: 1.7766614337841693
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.0214, Accuracy: 9843/9900 (99.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 58, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4393/4717 (93.1312%), train_poison_data_count: 370
Global model norm: 42.78150965498266.
Norm before scaling: 42.77374928539334. Distance: 1.6316757991068915
Total norm for 4 adversaries is: 42.77374928539334. distance: 1.6316757991068915
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1138, Accuracy: 9628/9900 (97.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4691/5066 (92.5977%), train_poison_data_count: 400
Global model norm: 42.78150965498266.
Norm before scaling: 42.77674573393747. Distance: 1.799929137954354
Total norm for 4 adversaries is: 42.77674573393747. distance: 1.799929137954354
___Test Local_ResNet_18 poisoned: True, epoch: 86: Average loss: 0.1296, Accuracy: 9581/9900 (96.7778%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4216/4634 (90.9797%)
___Train Local_ResNet_18,  epoch  86, local model 21, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4166/4634 (89.9007%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0656, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4091/4503 (90.8505%)
___Train Local_ResNet_18,  epoch  86, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4066/4503 (90.2954%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9289, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4388/4928 (89.0422%)
___Train Local_ResNet_18,  epoch  86, local model 16, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4511/4928 (91.5381%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8147, Accuracy: 5762/10000 (57.6200%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3417/3804 (89.8265%)
___Train Local_ResNet_18,  epoch  86, local model 60, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3457/3804 (90.8780%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9596, Accuracy: 5555/10000 (55.5500%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3284/3590 (91.4763%)
___Train Local_ResNet_18,  epoch  86, local model 63, internal_epoch   2,  Average loss: 0.0076, Accuracy: 3074/3590 (85.6267%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.3882, Accuracy: 4895/10000 (48.9500%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4181/4647 (89.9720%)
___Train Local_ResNet_18,  epoch  86, local model 77, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4274/4647 (91.9733%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8990, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4029/4625 (87.1135%)
___Train Local_ResNet_18,  epoch  86, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4025/4625 (87.0270%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.1289, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3968/4356 (91.0927%)
___Train Local_ResNet_18,  epoch  86, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3933/4356 (90.2893%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0949, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3454/3797 (90.9666%)
___Train Local_ResNet_18,  epoch  86, local model 52, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3502/3797 (92.2307%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9823, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4060/4456 (91.1131%)
___Train Local_ResNet_18,  epoch  86, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4079/4456 (91.5395%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9679, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3636/4025 (90.3354%)
___Train Local_ResNet_18,  epoch  86, local model 78, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3730/4025 (92.6708%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.9062, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3171/3472 (91.3306%)
___Train Local_ResNet_18,  epoch  86, local model 30, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3157/3472 (90.9274%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0022, Accuracy: 5468/10000 (54.6800%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2955/3297 (89.6269%)
___Train Local_ResNet_18,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3020/3297 (91.5984%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8440, Accuracy: 5672/10000 (56.7200%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3910/4416 (88.5417%)
___Train Local_ResNet_18,  epoch  86, local model 74, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3993/4416 (90.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0847, Accuracy: 5320/10000 (53.2000%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3963/4356 (90.9780%)
___Train Local_ResNet_18,  epoch  86, local model 89, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4027/4356 (92.4472%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 2.0261, Accuracy: 5507/10000 (55.0700%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3229/3638 (88.7576%)
___Train Local_ResNet_18,  epoch  86, local model 76, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3355/3638 (92.2210%)
___Test Local_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.8079, Accuracy: 5723/10000 (57.2300%)
time spent on training: 229.1684386730194
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 21, confusion matrix appended.
Validation completed for user 64, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 95, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 68, confusion matrix appended.
Validation completed for user 74, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 86: Average loss: 1.1360, Accuracy: 6984/10000 (69.8400%)
___Test Target_ResNet_18 poisoned: True, epoch: 86: Average loss: 1.6643, Accuracy: 6313/9900 (63.7677%)
Done in 252.90348649024963 sec.
Server Epoch:87 choose agents : [13, 36, 58, 71, 31, 46, 45, 84, 60, 70, 99, 5, 53, 83, 63, 8, 22, 87, 27, 37].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4559/4885 (93.3265%), train_poison_data_count: 385
Global model norm: 42.801556824507706.
Norm before scaling: 42.79564135452713. Distance: 1.695388581287145
Total norm for 4 adversaries is: 42.79564135452713. distance: 1.695388581287145
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1480, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4939/5305 (93.1008%), train_poison_data_count: 415
Global model norm: 42.801556824507706.
Norm before scaling: 42.79142101976312. Distance: 1.7408596161495213
Total norm for 4 adversaries is: 42.79142101976312. distance: 1.7408596161495213
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1019, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 58, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4387/4717 (93.0040%), train_poison_data_count: 370
Global model norm: 42.801556824507706.
Norm before scaling: 42.792459383378805. Distance: 1.622432220524458
Total norm for 4 adversaries is: 42.792459383378805. distance: 1.622432220524458
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.1175, Accuracy: 9607/9900 (97.0404%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  87, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4727/5066 (93.3083%), train_poison_data_count: 400
Global model norm: 42.801556824507706.
Norm before scaling: 42.79467437980382. Distance: 1.7544553445181224
Total norm for 4 adversaries is: 42.79467437980382. distance: 1.7544553445181224
___Test Local_ResNet_18 poisoned: True, epoch: 87: Average loss: 0.0934, Accuracy: 9656/9900 (97.5354%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3742/4175 (89.6287%)
___Train Local_ResNet_18,  epoch  87, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3690/4175 (88.3832%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9958, Accuracy: 5431/10000 (54.3100%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4361/4956 (87.9944%)
___Train Local_ResNet_18,  epoch  87, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4449/4956 (89.7700%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1470, Accuracy: 5230/10000 (52.3000%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4465/5037 (88.6440%)
___Train Local_ResNet_18,  epoch  87, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4567/5037 (90.6690%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9277, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4306/4793 (89.8393%)
___Train Local_ResNet_18,  epoch  87, local model 84, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.1492, Accuracy: 5389/10000 (53.8900%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3407/3804 (89.5636%)
___Train Local_ResNet_18,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3391/3804 (89.1430%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0378, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4868/5392 (90.2819%)
___Train Local_ResNet_18,  epoch  87, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4863/5392 (90.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0951, Accuracy: 5324/10000 (53.2400%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4078/4465 (91.3326%)
___Train Local_ResNet_18,  epoch  87, local model 99, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4087/4465 (91.5342%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9372, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4169/4596 (90.7093%)
___Train Local_ResNet_18,  epoch  87, local model 5, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4252/4596 (92.5152%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9427, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5409/6124 (88.3246%)
___Train Local_ResNet_18,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0061, Accuracy: 5391/6124 (88.0307%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0115, Accuracy: 5367/10000 (53.6700%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2916/3271 (89.1470%)
___Train Local_ResNet_18,  epoch  87, local model 83, internal_epoch   2,  Average loss: 0.0049, Accuracy: 2965/3271 (90.6451%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.9005, Accuracy: 5570/10000 (55.7000%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3252/3590 (90.5850%)
___Train Local_ResNet_18,  epoch  87, local model 63, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3286/3590 (91.5320%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0465, Accuracy: 5465/10000 (54.6500%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3963/4501 (88.0471%)
___Train Local_ResNet_18,  epoch  87, local model 8, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4037/4501 (89.6912%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0203, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4655/5232 (88.9717%)
___Train Local_ResNet_18,  epoch  87, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4587/5232 (87.6720%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0626, Accuracy: 5329/10000 (53.2900%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3275/3672 (89.1885%)
___Train Local_ResNet_18,  epoch  87, local model 87, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3284/3672 (89.4336%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0886, Accuracy: 5384/10000 (53.8400%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3833/4223 (90.7649%)
___Train Local_ResNet_18,  epoch  87, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3890/4223 (92.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.0778, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3930/4354 (90.2618%)
___Train Local_ResNet_18,  epoch  87, local model 37, internal_epoch   2,  Average loss: 0.0179, Accuracy: 2953/4354 (67.8227%)
___Test Local_ResNet_18 poisoned: False, epoch: 87: Average loss: 2.7762, Accuracy: 4141/10000 (41.4100%)
time spent on training: 234.22829413414001
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 70, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 5, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 83, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 87, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 87: Average loss: 1.1428, Accuracy: 6981/10000 (69.8100%)
___Test Target_ResNet_18 poisoned: True, epoch: 87: Average loss: 1.4920, Accuracy: 6637/9900 (67.0404%)
Done in 258.5232491493225 sec.
Server Epoch:88 choose agents : [13, 36, 58, 71, 15, 77, 99, 12, 74, 46, 90, 55, 79, 63, 93, 44, 30, 42, 83, 45].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4639/4885 (94.9642%), train_poison_data_count: 385
Global model norm: 42.82456633108282.
Norm before scaling: 42.81160754088049. Distance: 1.5703372478907316
Total norm for 4 adversaries is: 42.81160754088049. distance: 1.5703372478907316
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.2735, Accuracy: 9245/9900 (93.3838%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4972/5305 (93.7229%), train_poison_data_count: 415
Global model norm: 42.82456633108282.
Norm before scaling: 42.81156477080697. Distance: 1.700426676442712
Total norm for 4 adversaries is: 42.81156477080697. distance: 1.700426676442712
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0586, Accuracy: 9754/9900 (98.5253%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 58, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4403/4717 (93.3432%), train_poison_data_count: 370
Global model norm: 42.82456633108282.
Norm before scaling: 42.816711129570955. Distance: 1.6492439213886916
Total norm for 4 adversaries is: 42.816711129570955. distance: 1.6492439213886916
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.0743, Accuracy: 9713/9900 (98.1111%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  88, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4729/5066 (93.3478%), train_poison_data_count: 400
Global model norm: 42.82456633108282.
Norm before scaling: 42.81631341365038. Distance: 1.6832838724757373
Total norm for 4 adversaries is: 42.81631341365038. distance: 1.6832838724757373
___Test Local_ResNet_18 poisoned: True, epoch: 88: Average loss: 0.1808, Accuracy: 9450/9900 (95.4545%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5115/5582 (91.6338%)
___Train Local_ResNet_18,  epoch  88, local model 15, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5055/5582 (90.5589%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0551, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4171/4647 (89.7568%)
___Train Local_ResNet_18,  epoch  88, local model 77, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4221/4647 (90.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0209, Accuracy: 5518/10000 (55.1800%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4057/4465 (90.8623%)
___Train Local_ResNet_18,  epoch  88, local model 99, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4139/4465 (92.6988%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8510, Accuracy: 5689/10000 (56.8900%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4542/5083 (89.3567%)
___Train Local_ResNet_18,  epoch  88, local model 12, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4480/5083 (88.1369%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2716, Accuracy: 5115/10000 (51.1500%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3869/4416 (87.6132%)
___Train Local_ResNet_18,  epoch  88, local model 74, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3952/4416 (89.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8836, Accuracy: 5544/10000 (55.4400%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4427/4956 (89.3261%)
___Train Local_ResNet_18,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4399/4956 (88.7611%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2462, Accuracy: 5044/10000 (50.4400%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4029/4362 (92.3659%)
___Train Local_ResNet_18,  epoch  88, local model 90, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3892/4362 (89.2251%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9954, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3948/4356 (90.6336%)
___Train Local_ResNet_18,  epoch  88, local model 55, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3811/4356 (87.4885%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2329, Accuracy: 5073/10000 (50.7300%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3420/3781 (90.4523%)
___Train Local_ResNet_18,  epoch  88, local model 79, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3474/3781 (91.8805%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9842, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3291/3590 (91.6713%)
___Train Local_ResNet_18,  epoch  88, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3311/3590 (92.2284%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0001, Accuracy: 5489/10000 (54.8900%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4209/4651 (90.4967%)
___Train Local_ResNet_18,  epoch  88, local model 93, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4260/4651 (91.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9597, Accuracy: 5603/10000 (56.0300%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4215/4662 (90.4118%)
___Train Local_ResNet_18,  epoch  88, local model 44, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4219/4662 (90.4976%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9244, Accuracy: 5617/10000 (56.1700%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3161/3472 (91.0426%)
___Train Local_ResNet_18,  epoch  88, local model 30, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3229/3472 (93.0012%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.8818, Accuracy: 5642/10000 (56.4200%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4901/5424 (90.3577%)
___Train Local_ResNet_18,  epoch  88, local model 42, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4946/5424 (91.1873%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.2382, Accuracy: 5151/10000 (51.5100%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2964/3271 (90.6145%)
___Train Local_ResNet_18,  epoch  88, local model 83, internal_epoch   2,  Average loss: 0.0056, Accuracy: 2930/3271 (89.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 2.0003, Accuracy: 5445/10000 (54.4500%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4498/5037 (89.2992%)
___Train Local_ResNet_18,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4530/5037 (89.9345%)
___Test Local_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.9675, Accuracy: 5554/10000 (55.5400%)
time spent on training: 233.37810802459717
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 74, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 79, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 93, confusion matrix appended.
Validation completed for user 44, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 83, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 88: Average loss: 1.1440, Accuracy: 6978/10000 (69.7800%)
___Test Target_ResNet_18 poisoned: True, epoch: 88: Average loss: 1.4192, Accuracy: 6785/9900 (68.5354%)
Done in 257.3061304092407 sec.
Server Epoch:89 choose agents : [13, 36, 58, 71, 56, 69, 54, 24, 55, 48, 34, 18, 90, 60, 27, 21, 37, 11, 45, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4632/4885 (94.8209%), train_poison_data_count: 385
Global model norm: 42.84638827580745.
Norm before scaling: 42.83837037706383. Distance: 1.5977756297085723
Total norm for 4 adversaries is: 42.83837037706383. distance: 1.5977756297085723
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1685, Accuracy: 9493/9900 (95.8889%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4961/5305 (93.5156%), train_poison_data_count: 415
Global model norm: 42.84638827580745.
Norm before scaling: 42.83704388845666. Distance: 1.7332593749235854
Total norm for 4 adversaries is: 42.83704388845666. distance: 1.7332593749235854
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.1067, Accuracy: 9625/9900 (97.2222%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4428/4717 (93.8732%), train_poison_data_count: 370
Global model norm: 42.84638827580745.
Norm before scaling: 42.83438651327634. Distance: 1.5768424383877067
Total norm for 4 adversaries is: 42.83438651327634. distance: 1.5768424383877067
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2027, Accuracy: 9408/9900 (95.0303%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  89, local model 71, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4697/5066 (92.7161%), train_poison_data_count: 400
Global model norm: 42.84638827580745.
Norm before scaling: 42.84110586297347. Distance: 1.7656646318967066
Total norm for 4 adversaries is: 42.84110586297347. distance: 1.7656646318967066
___Test Local_ResNet_18 poisoned: True, epoch: 89: Average loss: 0.2661, Accuracy: 9271/9900 (93.6465%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4393/4989 (88.0537%)
___Train Local_ResNet_18,  epoch  89, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4467/4989 (89.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0867, Accuracy: 5400/10000 (54.0000%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3650/4013 (90.9544%)
___Train Local_ResNet_18,  epoch  89, local model 69, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3743/4013 (93.2719%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8365, Accuracy: 5755/10000 (57.5500%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4624/5195 (89.0087%)
___Train Local_ResNet_18,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0075, Accuracy: 4474/5195 (86.1213%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1078, Accuracy: 5327/10000 (53.2700%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3608/3969 (90.9045%)
___Train Local_ResNet_18,  epoch  89, local model 24, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3587/3969 (90.3754%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8978, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3977/4356 (91.2994%)
___Train Local_ResNet_18,  epoch  89, local model 55, internal_epoch   2,  Average loss: 0.0075, Accuracy: 3772/4356 (86.5932%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1902, Accuracy: 5166/10000 (51.6600%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4058/4441 (91.3758%)
___Train Local_ResNet_18,  epoch  89, local model 48, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4080/4441 (91.8712%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9387, Accuracy: 5628/10000 (56.2800%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4098/4518 (90.7039%)
___Train Local_ResNet_18,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4125/4518 (91.3015%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0484, Accuracy: 5322/10000 (53.2200%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3543/3911 (90.5906%)
___Train Local_ResNet_18,  epoch  89, local model 18, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3272/3911 (83.6615%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1477, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4016/4362 (92.0679%)
___Train Local_ResNet_18,  epoch  89, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3928/4362 (90.0504%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9643, Accuracy: 5441/10000 (54.4100%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3451/3804 (90.7203%)
___Train Local_ResNet_18,  epoch  89, local model 60, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3502/3804 (92.0610%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.1638, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3813/4223 (90.2913%)
___Train Local_ResNet_18,  epoch  89, local model 27, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3874/4223 (91.7357%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.9722, Accuracy: 5461/10000 (54.6100%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4196/4634 (90.5481%)
___Train Local_ResNet_18,  epoch  89, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4211/4634 (90.8718%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8550, Accuracy: 5655/10000 (56.5500%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3941/4354 (90.5145%)
___Train Local_ResNet_18,  epoch  89, local model 37, internal_epoch   2,  Average loss: 0.0147, Accuracy: 3210/4354 (73.7253%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.9208, Accuracy: 4148/10000 (41.4800%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4508/5244 (85.9649%)
___Train Local_ResNet_18,  epoch  89, local model 11, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4540/5244 (86.5751%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0246, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4495/5037 (89.2396%)
___Train Local_ResNet_18,  epoch  89, local model 45, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4588/5037 (91.0860%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 2.0006, Accuracy: 5448/10000 (54.4800%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3328/3704 (89.8488%)
___Train Local_ResNet_18,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3378/3704 (91.1987%)
___Test Local_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.8959, Accuracy: 5620/10000 (56.2000%)
time spent on training: 233.4099349975586
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 56, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 54, confusion matrix appended.
Validation completed for user 24, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 21, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 89: Average loss: 1.1421, Accuracy: 6985/10000 (69.8500%)
___Test Target_ResNet_18 poisoned: True, epoch: 89: Average loss: 1.3375, Accuracy: 6936/9900 (70.0606%)
Done in 257.5125925540924 sec.
Server Epoch:90 choose agents : [13, 36, 58, 71, 74, 49, 3, 92, 2, 47, 62, 75, 84, 6, 12, 76, 53, 81, 24, 91].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4612/4885 (94.4115%), train_poison_data_count: 385
Global model norm: 42.8690661892407.
Norm before scaling: 42.85829553416409. Distance: 1.5856433464074529
Total norm for 4 adversaries is: 42.85829553416409. distance: 1.5856433464074529
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1266, Accuracy: 9582/9900 (96.7879%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4967/5305 (93.6287%), train_poison_data_count: 415
Global model norm: 42.8690661892407.
Norm before scaling: 42.857043718495824. Distance: 1.6956539952758483
Total norm for 4 adversaries is: 42.857043718495824. distance: 1.6956539952758483
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0750, Accuracy: 9702/9900 (98.0000%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4416/4717 (93.6188%), train_poison_data_count: 370
Global model norm: 42.8690661892407.
Norm before scaling: 42.856991024656644. Distance: 1.5439942633863226
Total norm for 4 adversaries is: 42.856991024656644. distance: 1.5439942633863226
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.0987, Accuracy: 9647/9900 (97.4444%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  90, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4743/5066 (93.6242%), train_poison_data_count: 400
Global model norm: 42.8690661892407.
Norm before scaling: 42.859571522517. Distance: 1.6483823938786093
Total norm for 4 adversaries is: 42.859571522517. distance: 1.6483823938786093
___Test Local_ResNet_18 poisoned: True, epoch: 90: Average loss: 0.1874, Accuracy: 9446/9900 (95.4141%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3938/4416 (89.1757%)
___Train Local_ResNet_18,  epoch  90, local model 74, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3964/4416 (89.7645%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9484, Accuracy: 5483/10000 (54.8300%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4647/5197 (89.4170%)
___Train Local_ResNet_18,  epoch  90, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4601/5197 (88.5318%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9453, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4419/4918 (89.8536%)
___Train Local_ResNet_18,  epoch  90, local model 3, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4497/4918 (91.4396%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1165, Accuracy: 5259/10000 (52.5900%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5671/6263 (90.5477%)
___Train Local_ResNet_18,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5676/6263 (90.6275%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.1763, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3281/3646 (89.9890%)
___Train Local_ResNet_18,  epoch  90, local model 2, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3316/3646 (90.9490%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8241, Accuracy: 5758/10000 (57.5800%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4307/4707 (91.5020%)
___Train Local_ResNet_18,  epoch  90, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4310/4707 (91.5658%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9333, Accuracy: 5633/10000 (56.3300%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4468/5063 (88.2481%)
___Train Local_ResNet_18,  epoch  90, local model 62, internal_epoch   2,  Average loss: 0.0078, Accuracy: 4288/5063 (84.6929%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.3417, Accuracy: 4965/10000 (49.6500%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3836/4295 (89.3132%)
___Train Local_ResNet_18,  epoch  90, local model 75, internal_epoch   2,  Average loss: 0.0056, Accuracy: 3840/4295 (89.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.9735, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4325/4793 (90.2358%)
___Train Local_ResNet_18,  epoch  90, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4354/4793 (90.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0063, Accuracy: 5471/10000 (54.7100%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4126/4538 (90.9211%)
___Train Local_ResNet_18,  epoch  90, local model 6, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4226/4538 (93.1247%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8748, Accuracy: 5692/10000 (56.9200%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4548/5083 (89.4747%)
___Train Local_ResNet_18,  epoch  90, local model 12, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4540/5083 (89.3173%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0350, Accuracy: 5444/10000 (54.4400%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3252/3638 (89.3898%)
___Train Local_ResNet_18,  epoch  90, local model 76, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3286/3638 (90.3244%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.7857, Accuracy: 5740/10000 (57.4000%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5446/6124 (88.9288%)
___Train Local_ResNet_18,  epoch  90, local model 53, internal_epoch   2,  Average loss: 0.0058, Accuracy: 5414/6124 (88.4063%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0790, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4178/4618 (90.4721%)
___Train Local_ResNet_18,  epoch  90, local model 81, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3980/4618 (86.1845%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0886, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3616/3969 (91.1061%)
___Train Local_ResNet_18,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3603/3969 (90.7785%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.8577, Accuracy: 5783/10000 (57.8300%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3601/4158 (86.6041%)
___Train Local_ResNet_18,  epoch  90, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3655/4158 (87.9028%)
___Test Local_ResNet_18 poisoned: False, epoch: 90: Average loss: 2.0762, Accuracy: 5163/10000 (51.6300%)
time spent on training: 237.21069264411926
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 74, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 92, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 75, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 81, confusion matrix appended.
Validation completed for user 24, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 90: Average loss: 1.1452, Accuracy: 6982/10000 (69.8200%)
___Test Target_ResNet_18 poisoned: True, epoch: 90: Average loss: 1.2556, Accuracy: 7088/9900 (71.5960%)
Done in 261.70776319503784 sec.
Server Epoch:91 choose agents : [13, 36, 58, 71, 28, 7, 97, 84, 75, 11, 56, 49, 89, 77, 69, 6, 47, 92, 73, 14].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4597/4885 (94.1044%), train_poison_data_count: 385
Global model norm: 42.89278796914028.
Norm before scaling: 42.8828943397379. Distance: 1.5587011314630272
Total norm for 4 adversaries is: 42.8828943397379. distance: 1.5587011314630272
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1977, Accuracy: 9433/9900 (95.2828%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4940/5305 (93.1197%), train_poison_data_count: 415
Global model norm: 42.89278796914028.
Norm before scaling: 42.88135714988071. Distance: 1.7365367579547244
Total norm for 4 adversaries is: 42.88135714988071. distance: 1.7365367579547244
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.1708, Accuracy: 9474/9900 (95.6970%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4441/4717 (94.1488%), train_poison_data_count: 370
Global model norm: 42.89278796914028.
Norm before scaling: 42.88142689394719. Distance: 1.5489253317885987
Total norm for 4 adversaries is: 42.88142689394719. distance: 1.5489253317885987
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.0826, Accuracy: 9668/9900 (97.6566%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  91, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4715/5066 (93.0715%), train_poison_data_count: 400
Global model norm: 42.89278796914028.
Norm before scaling: 42.88532099490381. Distance: 1.7225602657366879
Total norm for 4 adversaries is: 42.88532099490381. distance: 1.7225602657366879
___Test Local_ResNet_18 poisoned: True, epoch: 91: Average loss: 0.2965, Accuracy: 9186/9900 (92.7879%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4143/4716 (87.8499%)
___Train Local_ResNet_18,  epoch  91, local model 28, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4174/4716 (88.5072%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1106, Accuracy: 5250/10000 (52.5000%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4007/4481 (89.4220%)
___Train Local_ResNet_18,  epoch  91, local model 7, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3933/4481 (87.7706%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1160, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3918/4361 (89.8418%)
___Train Local_ResNet_18,  epoch  91, local model 97, internal_epoch   2,  Average loss: 0.0067, Accuracy: 3789/4361 (86.8837%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1734, Accuracy: 5170/10000 (51.7000%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4359/4793 (90.9451%)
___Train Local_ResNet_18,  epoch  91, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4407/4793 (91.9466%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.9685, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3908/4295 (90.9895%)
___Train Local_ResNet_18,  epoch  91, local model 75, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3770/4295 (87.7765%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1541, Accuracy: 5255/10000 (52.5500%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4575/5244 (87.2426%)
___Train Local_ResNet_18,  epoch  91, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4593/5244 (87.5858%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0331, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4444/4989 (89.0760%)
___Train Local_ResNet_18,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4474/4989 (89.6773%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0163, Accuracy: 5434/10000 (54.3400%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4647/5197 (89.4170%)
___Train Local_ResNet_18,  epoch  91, local model 49, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4626/5197 (89.0129%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1358, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3947/4356 (90.6107%)
___Train Local_ResNet_18,  epoch  91, local model 89, internal_epoch   2,  Average loss: 0.0084, Accuracy: 3683/4356 (84.5500%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.3793, Accuracy: 4749/10000 (47.4900%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4169/4647 (89.7138%)
___Train Local_ResNet_18,  epoch  91, local model 77, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4199/4647 (90.3594%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0144, Accuracy: 5408/10000 (54.0800%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3672/4013 (91.5026%)
___Train Local_ResNet_18,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3709/4013 (92.4246%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8254, Accuracy: 5651/10000 (56.5100%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4157/4538 (91.6042%)
___Train Local_ResNet_18,  epoch  91, local model 6, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4195/4538 (92.4416%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.7601, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4290/4707 (91.1409%)
___Train Local_ResNet_18,  epoch  91, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4285/4707 (91.0346%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.8637, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5662/6263 (90.4040%)
___Train Local_ResNet_18,  epoch  91, local model 92, internal_epoch   2,  Average loss: 0.0048, Accuracy: 5674/6263 (90.5956%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0476, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3871/4235 (91.4050%)
___Train Local_ResNet_18,  epoch  91, local model 73, internal_epoch   2,  Average loss: 0.0063, Accuracy: 3761/4235 (88.8076%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.0323, Accuracy: 5396/10000 (53.9600%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3480/3861 (90.1321%)
___Train Local_ResNet_18,  epoch  91, local model 14, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3444/3861 (89.1997%)
___Test Local_ResNet_18 poisoned: False, epoch: 91: Average loss: 2.1116, Accuracy: 5273/10000 (52.7300%)
time spent on training: 237.17039513587952
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 28, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 75, confusion matrix appended.
Validation completed for user 11, confusion matrix appended.
Validation completed for user 56, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 92, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 91: Average loss: 1.1496, Accuracy: 6969/10000 (69.6900%)
___Test Target_ResNet_18 poisoned: True, epoch: 91: Average loss: 1.2126, Accuracy: 7178/9900 (72.5051%)
Done in 261.37201142311096 sec.
Server Epoch:92 choose agents : [13, 36, 58, 71, 65, 98, 97, 69, 34, 57, 61, 96, 73, 45, 87, 16, 55, 66, 84, 80].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4596/4885 (94.0839%), train_poison_data_count: 385
Global model norm: 42.916711386253.
Norm before scaling: 42.90880619889188. Distance: 1.6327642406285923
Total norm for 4 adversaries is: 42.90880619889188. distance: 1.6327642406285923
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1184, Accuracy: 9617/9900 (97.1414%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4978/5305 (93.8360%), train_poison_data_count: 415
Global model norm: 42.916711386253.
Norm before scaling: 42.905249954205054. Distance: 1.708653497545205
Total norm for 4 adversaries is: 42.905249954205054. distance: 1.708653497545205
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1163, Accuracy: 9592/9900 (96.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 58, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4416/4717 (93.6188%), train_poison_data_count: 370
Global model norm: 42.916711386253.
Norm before scaling: 42.90561412720732. Distance: 1.5454037538127645
Total norm for 4 adversaries is: 42.90561412720732. distance: 1.5454037538127645
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.1429, Accuracy: 9530/9900 (96.2626%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  92, local model 71, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4732/5066 (93.4070%), train_poison_data_count: 400
Global model norm: 42.916711386253.
Norm before scaling: 42.910754895972026. Distance: 1.7155393262917964
Total norm for 4 adversaries is: 42.910754895972026. distance: 1.7155393262917964
___Test Local_ResNet_18 poisoned: True, epoch: 92: Average loss: 0.0951, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4593/5055 (90.8605%)
___Train Local_ResNet_18,  epoch  92, local model 65, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4652/5055 (92.0277%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9761, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3467/3828 (90.5695%)
___Train Local_ResNet_18,  epoch  92, local model 98, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3590/3828 (93.7827%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8980, Accuracy: 5638/10000 (56.3800%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3919/4361 (89.8647%)
___Train Local_ResNet_18,  epoch  92, local model 97, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3916/4361 (89.7959%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9563, Accuracy: 5523/10000 (55.2300%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3652/4013 (91.0042%)
___Train Local_ResNet_18,  epoch  92, local model 69, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3745/4013 (93.3217%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8447, Accuracy: 5768/10000 (57.6800%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4123/4518 (91.2572%)
___Train Local_ResNet_18,  epoch  92, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4182/4518 (92.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8909, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4107/4558 (90.1053%)
___Train Local_ResNet_18,  epoch  92, local model 57, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4049/4558 (88.8328%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0189, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3720/4126 (90.1600%)
___Train Local_ResNet_18,  epoch  92, local model 61, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3802/4126 (92.1474%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9466, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4267/4679 (91.1947%)
___Train Local_ResNet_18,  epoch  92, local model 96, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3912/4679 (83.6076%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.2889, Accuracy: 4925/10000 (49.2500%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3919/4235 (92.5384%)
___Train Local_ResNet_18,  epoch  92, local model 73, internal_epoch   2,  Average loss: 0.0053, Accuracy: 3810/4235 (89.9646%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8940, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4490/5037 (89.1404%)
___Train Local_ResNet_18,  epoch  92, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4607/5037 (91.4632%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8675, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3292/3672 (89.6514%)
___Train Local_ResNet_18,  epoch  92, local model 87, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3350/3672 (91.2309%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.8261, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4438/4928 (90.0568%)
___Train Local_ResNet_18,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4421/4928 (89.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9959, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3970/4356 (91.1387%)
___Train Local_ResNet_18,  epoch  92, local model 55, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3830/4356 (87.9247%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.1219, Accuracy: 5238/10000 (52.3800%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4083/4456 (91.6293%)
___Train Local_ResNet_18,  epoch  92, local model 66, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4146/4456 (93.0431%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9635, Accuracy: 5610/10000 (56.1000%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4322/4793 (90.1732%)
___Train Local_ResNet_18,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4400/4793 (91.8005%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.9497, Accuracy: 5679/10000 (56.7900%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4542/5025 (90.3881%)
___Train Local_ResNet_18,  epoch  92, local model 80, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4527/5025 (90.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 92: Average loss: 2.0411, Accuracy: 5316/10000 (53.1600%)
time spent on training: 232.78592228889465
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 65, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 57, confusion matrix appended.
Validation completed for user 61, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 87, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 92: Average loss: 1.1470, Accuracy: 6980/10000 (69.8000%)
___Test Target_ResNet_18 poisoned: True, epoch: 92: Average loss: 1.1213, Accuracy: 7351/9900 (74.2525%)
Done in 256.74551796913147 sec.
Server Epoch:93 choose agents : [13, 36, 58, 71, 29, 23, 55, 2, 12, 89, 57, 31, 30, 8, 42, 7, 40, 22, 85, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4638/4885 (94.9437%), train_poison_data_count: 385
Global model norm: 42.93841827165825.
Norm before scaling: 42.927261220107845. Distance: 1.5412370065851422
Total norm for 4 adversaries is: 42.927261220107845. distance: 1.5412370065851422
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0956, Accuracy: 9645/9900 (97.4242%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4983/5305 (93.9303%), train_poison_data_count: 415
Global model norm: 42.93841827165825.
Norm before scaling: 42.92643228672967. Distance: 1.692561365251917
Total norm for 4 adversaries is: 42.92643228672967. distance: 1.692561365251917
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.0766, Accuracy: 9688/9900 (97.8586%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4457/4717 (94.4880%), train_poison_data_count: 370
Global model norm: 42.93841827165825.
Norm before scaling: 42.92389277883662. Distance: 1.4905629526976008
Total norm for 4 adversaries is: 42.92389277883662. distance: 1.4905629526976008
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1644, Accuracy: 9502/9900 (95.9798%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  93, local model 71, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4735/5066 (93.4662%), train_poison_data_count: 400
Global model norm: 42.93841827165825.
Norm before scaling: 42.93122367019501. Distance: 1.686585001658444
Total norm for 4 adversaries is: 42.93122367019501. distance: 1.686585001658444
___Test Local_ResNet_18 poisoned: True, epoch: 93: Average loss: 0.1227, Accuracy: 9567/9900 (96.6364%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3982/4346 (91.6245%)
___Train Local_ResNet_18,  epoch  93, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4033/4346 (92.7980%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8713, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3804/4184 (90.9178%)
___Train Local_ResNet_18,  epoch  93, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3794/4184 (90.6788%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9368, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3948/4356 (90.6336%)
___Train Local_ResNet_18,  epoch  93, local model 55, internal_epoch   2,  Average loss: 0.0128, Accuracy: 3353/4356 (76.9743%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.3647, Accuracy: 4802/10000 (48.0200%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3311/3646 (90.8118%)
___Train Local_ResNet_18,  epoch  93, local model 2, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3372/3646 (92.4849%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.7614, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4600/5083 (90.4977%)
___Train Local_ResNet_18,  epoch  93, local model 12, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4570/5083 (89.9075%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0765, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3955/4356 (90.7943%)
___Train Local_ResNet_18,  epoch  93, local model 89, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3897/4356 (89.4628%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1726, Accuracy: 5083/10000 (50.8300%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4101/4558 (89.9737%)
___Train Local_ResNet_18,  epoch  93, local model 57, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4108/4558 (90.1272%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0016, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3755/4175 (89.9401%)
___Train Local_ResNet_18,  epoch  93, local model 31, internal_epoch   2,  Average loss: 0.0060, Accuracy: 3693/4175 (88.4551%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0059, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3191/3472 (91.9067%)
___Train Local_ResNet_18,  epoch  93, local model 30, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3165/3472 (91.1578%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1331, Accuracy: 5447/10000 (54.4700%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4100/4501 (91.0909%)
___Train Local_ResNet_18,  epoch  93, local model 8, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4083/4501 (90.7132%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.9552, Accuracy: 5577/10000 (55.7700%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4911/5424 (90.5420%)
___Train Local_ResNet_18,  epoch  93, local model 42, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4944/5424 (91.1504%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1800, Accuracy: 5219/10000 (52.1900%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4027/4481 (89.8683%)
___Train Local_ResNet_18,  epoch  93, local model 7, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3980/4481 (88.8195%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0569, Accuracy: 5484/10000 (54.8400%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4915/5455 (90.1008%)
___Train Local_ResNet_18,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4925/5455 (90.2841%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.2193, Accuracy: 5175/10000 (51.7500%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4700/5232 (89.8318%)
___Train Local_ResNet_18,  epoch  93, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4660/5232 (89.0673%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.0537, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5584/6391 (87.3729%)
___Train Local_ResNet_18,  epoch  93, local model 85, internal_epoch   2,  Average loss: 0.0068, Accuracy: 5540/6391 (86.6844%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 2.1518, Accuracy: 5149/10000 (51.4900%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3484/3775 (92.2914%)
___Train Local_ResNet_18,  epoch  93, local model 51, internal_epoch   2,  Average loss: 0.0029, Accuracy: 3581/3775 (94.8609%)
___Test Local_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.8419, Accuracy: 5775/10000 (57.7500%)
time spent on training: 236.81335377693176
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 29, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 2, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Validation completed for user 57, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 85, confusion matrix appended.
Validation completed for user 51, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 93: Average loss: 1.1526, Accuracy: 6958/10000 (69.5800%)
___Test Target_ResNet_18 poisoned: True, epoch: 93: Average loss: 1.0064, Accuracy: 7576/9900 (76.5253%)
Done in 261.8298852443695 sec.
Server Epoch:94 choose agents : [13, 36, 58, 71, 78, 27, 76, 62, 82, 94, 91, 34, 73, 88, 85, 75, 26, 7, 31, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4590/4885 (93.9611%), train_poison_data_count: 385
Global model norm: 42.961769319324766.
Norm before scaling: 42.95157042930735. Distance: 1.6341882777726295
Total norm for 4 adversaries is: 42.95157042930735. distance: 1.6341882777726295
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0859, Accuracy: 9664/9900 (97.6162%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5000/5305 (94.2507%), train_poison_data_count: 415
Global model norm: 42.961769319324766.
Norm before scaling: 42.94727019937501. Distance: 1.6445249435050173
Total norm for 4 adversaries is: 42.94727019937501. distance: 1.6445249435050173
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.0372, Accuracy: 9795/9900 (98.9394%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 58, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4445/4717 (94.2336%), train_poison_data_count: 370
Global model norm: 42.961769319324766.
Norm before scaling: 42.948361640208404. Distance: 1.5146532384524574
Total norm for 4 adversaries is: 42.948361640208404. distance: 1.5146532384524574
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1551, Accuracy: 9484/9900 (95.7980%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  94, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4749/5066 (93.7426%), train_poison_data_count: 400
Global model norm: 42.961769319324766.
Norm before scaling: 42.95505605653789. Distance: 1.6978483439860068
Total norm for 4 adversaries is: 42.95505605653789. distance: 1.6978483439860068
___Test Local_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.1497, Accuracy: 9513/9900 (96.0909%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3690/4025 (91.6770%)
___Train Local_ResNet_18,  epoch  94, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3752/4025 (93.2174%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8101, Accuracy: 5750/10000 (57.5000%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3875/4223 (91.7594%)
___Train Local_ResNet_18,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3866/4223 (91.5463%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9372, Accuracy: 5509/10000 (55.0900%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3267/3638 (89.8021%)
___Train Local_ResNet_18,  epoch  94, local model 76, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3375/3638 (92.7708%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8469, Accuracy: 5714/10000 (57.1400%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4488/5063 (88.6431%)
___Train Local_ResNet_18,  epoch  94, local model 62, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4433/5063 (87.5568%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1410, Accuracy: 5241/10000 (52.4100%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4380/4874 (89.8646%)
___Train Local_ResNet_18,  epoch  94, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4284/4874 (87.8950%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2904, Accuracy: 5114/10000 (51.1400%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4344/4804 (90.4246%)
___Train Local_ResNet_18,  epoch  94, local model 94, internal_epoch   2,  Average loss: 0.0084, Accuracy: 4050/4804 (84.3047%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.3382, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3674/4158 (88.3598%)
___Train Local_ResNet_18,  epoch  94, local model 91, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3654/4158 (87.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0033, Accuracy: 5368/10000 (53.6800%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4081/4518 (90.3276%)
___Train Local_ResNet_18,  epoch  94, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4151/4518 (91.8769%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0987, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3901/4235 (92.1133%)
___Train Local_ResNet_18,  epoch  94, local model 73, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3788/4235 (89.4451%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9269, Accuracy: 5629/10000 (56.2900%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4373/4934 (88.6299%)
___Train Local_ResNet_18,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0094, Accuracy: 4059/4934 (82.2659%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.2955, Accuracy: 4888/10000 (48.8800%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5619/6391 (87.9205%)
___Train Local_ResNet_18,  epoch  94, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5591/6391 (87.4824%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0811, Accuracy: 5290/10000 (52.9000%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3885/4295 (90.4540%)
___Train Local_ResNet_18,  epoch  94, local model 75, internal_epoch   2,  Average loss: 0.0061, Accuracy: 3824/4295 (89.0338%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1112, Accuracy: 5288/10000 (52.8800%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3457/3756 (92.0394%)
___Train Local_ResNet_18,  epoch  94, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3550/3756 (94.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.8594, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4040/4481 (90.1584%)
___Train Local_ResNet_18,  epoch  94, local model 7, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3891/4481 (86.8333%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.0285, Accuracy: 5404/10000 (54.0400%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3754/4175 (89.9162%)
___Train Local_ResNet_18,  epoch  94, local model 31, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3732/4175 (89.3892%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.9372, Accuracy: 5515/10000 (55.1500%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3301/3590 (91.9499%)
___Train Local_ResNet_18,  epoch  94, local model 63, internal_epoch   2,  Average loss: 0.0058, Accuracy: 3198/3590 (89.0808%)
___Test Local_ResNet_18 poisoned: False, epoch: 94: Average loss: 2.1941, Accuracy: 5181/10000 (51.8100%)
time spent on training: 233.9884467124939
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 82, confusion matrix appended.
Validation completed for user 94, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 88, confusion matrix appended.
Validation completed for user 85, confusion matrix appended.
Validation completed for user 75, confusion matrix appended.
Validation completed for user 26, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 94: Average loss: 1.1630, Accuracy: 6943/10000 (69.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 94: Average loss: 0.9190, Accuracy: 7770/9900 (78.4848%)
Done in 257.91605162620544 sec.
Server Epoch:95 choose agents : [13, 36, 58, 71, 98, 18, 90, 49, 96, 84, 67, 95, 81, 83, 31, 86, 7, 50, 38, 77].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4631/4885 (94.8004%), train_poison_data_count: 385
Global model norm: 42.984913153210655.
Norm before scaling: 42.97128259581842. Distance: 1.5424629251485313
Total norm for 4 adversaries is: 42.97128259581842. distance: 1.5424629251485313
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1970, Accuracy: 9427/9900 (95.2222%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5046/5305 (95.1178%), train_poison_data_count: 415
Global model norm: 42.984913153210655.
Norm before scaling: 42.96703121562363. Distance: 1.5398977888545131
Total norm for 4 adversaries is: 42.96703121562363. distance: 1.5398977888545131
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.2507, Accuracy: 9325/9900 (94.1919%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4454/4717 (94.4244%), train_poison_data_count: 370
Global model norm: 42.984913153210655.
Norm before scaling: 42.970019867599255. Distance: 1.4616291224588653
Total norm for 4 adversaries is: 42.970019867599255. distance: 1.4616291224588653
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.1068, Accuracy: 9627/9900 (97.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  95, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4760/5066 (93.9597%), train_poison_data_count: 400
Global model norm: 42.984913153210655.
Norm before scaling: 42.976916837523085. Distance: 1.66099423072084
Total norm for 4 adversaries is: 42.976916837523085. distance: 1.66099423072084
___Test Local_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.0773, Accuracy: 9703/9900 (98.0101%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3521/3828 (91.9801%)
___Train Local_ResNet_18,  epoch  95, local model 98, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3581/3828 (93.5475%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.7688, Accuracy: 5843/10000 (58.4300%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3574/3911 (91.3833%)
___Train Local_ResNet_18,  epoch  95, local model 18, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3369/3911 (86.1417%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1198, Accuracy: 5358/10000 (53.5800%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4033/4362 (92.4576%)
___Train Local_ResNet_18,  epoch  95, local model 90, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3929/4362 (90.0734%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9394, Accuracy: 5454/10000 (54.5400%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4791/5197 (92.1878%)
___Train Local_ResNet_18,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4628/5197 (89.0514%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.2655, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4293/4679 (91.7504%)
___Train Local_ResNet_18,  epoch  95, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4205/4679 (89.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1053, Accuracy: 5278/10000 (52.7800%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4351/4793 (90.7782%)
___Train Local_ResNet_18,  epoch  95, local model 84, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4379/4793 (91.3624%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0777, Accuracy: 5373/10000 (53.7300%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4593/5116 (89.7772%)
___Train Local_ResNet_18,  epoch  95, local model 67, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4583/5116 (89.5817%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.1474, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4100/4625 (88.6486%)
___Train Local_ResNet_18,  epoch  95, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4090/4625 (88.4324%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9593, Accuracy: 5494/10000 (54.9400%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4254/4618 (92.1178%)
___Train Local_ResNet_18,  epoch  95, local model 81, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4182/4618 (90.5587%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0008, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2961/3271 (90.5228%)
___Train Local_ResNet_18,  epoch  95, local model 83, internal_epoch   2,  Average loss: 0.0045, Accuracy: 2984/3271 (91.2259%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8996, Accuracy: 5588/10000 (55.8800%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3827/4175 (91.6647%)
___Train Local_ResNet_18,  epoch  95, local model 31, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3784/4175 (90.6347%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9522, Accuracy: 5487/10000 (54.8700%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3231/3616 (89.3529%)
___Train Local_ResNet_18,  epoch  95, local model 86, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3321/3616 (91.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.8462, Accuracy: 5745/10000 (57.4500%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3972/4481 (88.6409%)
___Train Local_ResNet_18,  epoch  95, local model 7, internal_epoch   2,  Average loss: 0.0073, Accuracy: 3938/4481 (87.8822%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0555, Accuracy: 5449/10000 (54.4900%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3953/4368 (90.4991%)
___Train Local_ResNet_18,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3933/4368 (90.0412%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9276, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5130/5740 (89.3728%)
___Train Local_ResNet_18,  epoch  95, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5197/5740 (90.5401%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 2.0515, Accuracy: 5435/10000 (54.3500%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4182/4647 (89.9935%)
___Train Local_ResNet_18,  epoch  95, local model 77, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4239/4647 (91.2201%)
___Test Local_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.9336, Accuracy: 5553/10000 (55.5300%)
time spent on training: 232.33754658699036
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 18, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 67, confusion matrix appended.
Validation completed for user 95, confusion matrix appended.
Validation completed for user 81, confusion matrix appended.
Validation completed for user 83, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 50, confusion matrix appended.
Validation completed for user 38, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 95: Average loss: 1.1752, Accuracy: 6935/10000 (69.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 95: Average loss: 0.8159, Accuracy: 7997/9900 (80.7778%)
Done in 256.0974485874176 sec.
Server Epoch:96 choose agents : [13, 36, 58, 71, 32, 46, 17, 69, 63, 84, 60, 39, 97, 62, 50, 96, 9, 72, 25, 27].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4656/4885 (95.3122%), train_poison_data_count: 385
Global model norm: 43.007107879105284.
Norm before scaling: 42.99350707247113. Distance: 1.514849041383108
Total norm for 4 adversaries is: 42.99350707247113. distance: 1.514849041383108
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.2297, Accuracy: 9327/9900 (94.2121%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 36, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5008/5305 (94.4015%), train_poison_data_count: 415
Global model norm: 43.007107879105284.
Norm before scaling: 42.98950351084989. Distance: 1.6205446347378063
Total norm for 4 adversaries is: 42.98950351084989. distance: 1.6205446347378063
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.1078, Accuracy: 9650/9900 (97.4747%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4459/4717 (94.5304%), train_poison_data_count: 370
Global model norm: 43.007107879105284.
Norm before scaling: 42.992540289075876. Distance: 1.4819339155168514
Total norm for 4 adversaries is: 42.992540289075876. distance: 1.4819339155168514
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0522, Accuracy: 9756/9900 (98.5455%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  96, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4767/5066 (94.0979%), train_poison_data_count: 400
Global model norm: 43.007107879105284.
Norm before scaling: 42.997168159386526. Distance: 1.6517957134754244
Total norm for 4 adversaries is: 42.997168159386526. distance: 1.6517957134754244
___Test Local_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.0586, Accuracy: 9745/9900 (98.4343%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5003/5591 (89.4831%)
___Train Local_ResNet_18,  epoch  96, local model 32, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4983/5591 (89.1254%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0290, Accuracy: 5326/10000 (53.2600%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4408/4956 (88.9427%)
___Train Local_ResNet_18,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4337/4956 (87.5101%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1583, Accuracy: 5195/10000 (51.9500%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4030/4511 (89.3372%)
___Train Local_ResNet_18,  epoch  96, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4100/4511 (90.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9905, Accuracy: 5439/10000 (54.3900%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3674/4013 (91.5525%)
___Train Local_ResNet_18,  epoch  96, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3719/4013 (92.6738%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.8976, Accuracy: 5626/10000 (56.2600%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3315/3590 (92.3398%)
___Train Local_ResNet_18,  epoch  96, local model 63, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3363/3590 (93.6769%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9167, Accuracy: 5706/10000 (57.0600%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4339/4793 (90.5279%)
___Train Local_ResNet_18,  epoch  96, local model 84, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4374/4793 (91.2581%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0754, Accuracy: 5416/10000 (54.1600%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3470/3804 (91.2198%)
___Train Local_ResNet_18,  epoch  96, local model 60, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3466/3804 (91.1146%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0315, Accuracy: 5437/10000 (54.3700%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3502/3837 (91.2692%)
___Train Local_ResNet_18,  epoch  96, local model 39, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3557/3837 (92.7026%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9662, Accuracy: 5539/10000 (55.3900%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3937/4361 (90.2775%)
___Train Local_ResNet_18,  epoch  96, local model 97, internal_epoch   2,  Average loss: 0.0068, Accuracy: 3776/4361 (86.5856%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1613, Accuracy: 5248/10000 (52.4800%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4511/5063 (89.0974%)
___Train Local_ResNet_18,  epoch  96, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4403/5063 (86.9643%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2064, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3923/4368 (89.8123%)
___Train Local_ResNet_18,  epoch  96, local model 50, internal_epoch   2,  Average loss: 0.0050, Accuracy: 3951/4368 (90.4533%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0566, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4333/4679 (92.6053%)
___Train Local_ResNet_18,  epoch  96, local model 96, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4183/4679 (89.3994%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.0687, Accuracy: 5307/10000 (53.0700%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4746/5265 (90.1425%)
___Train Local_ResNet_18,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4700/5265 (89.2688%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.1207, Accuracy: 5300/10000 (53.0000%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4241/4767 (88.9658%)
___Train Local_ResNet_18,  epoch  96, local model 72, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4164/4767 (87.3505%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.2238, Accuracy: 5179/10000 (51.7900%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5229/5902 (88.5971%)
___Train Local_ResNet_18,  epoch  96, local model 25, internal_epoch   2,  Average loss: 0.0083, Accuracy: 4933/5902 (83.5818%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 2.3362, Accuracy: 5016/10000 (50.1600%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3812/4223 (90.2676%)
___Train Local_ResNet_18,  epoch  96, local model 27, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3862/4223 (91.4516%)
___Test Local_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.9378, Accuracy: 5600/10000 (56.0000%)
time spent on training: 236.12621235847473
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 50, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 72, confusion matrix appended.
Validation completed for user 25, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 96: Average loss: 1.1746, Accuracy: 6923/10000 (69.2300%)
___Test Target_ResNet_18 poisoned: True, epoch: 96: Average loss: 0.8089, Accuracy: 8000/9900 (80.8081%)
Done in 260.18604254722595 sec.
Server Epoch:97 choose agents : [13, 36, 58, 71, 52, 14, 47, 34, 69, 35, 24, 48, 57, 99, 76, 6, 38, 39, 97, 84].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4674/4885 (95.6807%), train_poison_data_count: 385
Global model norm: 43.03027413563037.
Norm before scaling: 43.01409255352396. Distance: 1.4320585673838484
Total norm for 4 adversaries is: 43.01409255352396. distance: 1.4320585673838484
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1806, Accuracy: 9444/9900 (95.3939%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4998/5305 (94.2130%), train_poison_data_count: 415
Global model norm: 43.03027413563037.
Norm before scaling: 43.017422717156855. Distance: 1.656927222224297
Total norm for 4 adversaries is: 43.017422717156855. distance: 1.656927222224297
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1473, Accuracy: 9527/9900 (96.2323%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4447/4717 (94.2760%), train_poison_data_count: 370
Global model norm: 43.03027413563037.
Norm before scaling: 43.01441465560193. Distance: 1.4522963591544367
Total norm for 4 adversaries is: 43.01441465560193. distance: 1.4522963591544367
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.1680, Accuracy: 9473/9900 (95.6869%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  97, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4772/5066 (94.1966%), train_poison_data_count: 400
Global model norm: 43.03027413563037.
Norm before scaling: 43.01790796021393. Distance: 1.644743844469122
Total norm for 4 adversaries is: 43.01790796021393. distance: 1.644743844469122
___Test Local_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.0471, Accuracy: 9780/9900 (98.7879%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3497/3797 (92.0990%)
___Train Local_ResNet_18,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3460/3797 (91.1246%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9381, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3488/3861 (90.3393%)
___Train Local_ResNet_18,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3464/3861 (89.7177%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9834, Accuracy: 5420/10000 (54.2000%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4292/4707 (91.1833%)
___Train Local_ResNet_18,  epoch  97, local model 47, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4220/4707 (89.6537%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.1278, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4133/4518 (91.4785%)
___Train Local_ResNet_18,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 4182/4518 (92.5631%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0604, Accuracy: 5364/10000 (53.6400%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3703/4013 (92.2751%)
___Train Local_ResNet_18,  epoch  97, local model 69, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3708/4013 (92.3997%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9691, Accuracy: 5549/10000 (55.4900%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4708/5167 (91.1167%)
___Train Local_ResNet_18,  epoch  97, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4703/5167 (91.0199%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.2301, Accuracy: 5212/10000 (52.1200%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3616/3969 (91.1061%)
___Train Local_ResNet_18,  epoch  97, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3645/3969 (91.8367%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8940, Accuracy: 5756/10000 (57.5600%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4084/4441 (91.9613%)
___Train Local_ResNet_18,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4072/4441 (91.6911%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0510, Accuracy: 5533/10000 (55.3300%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4107/4558 (90.1053%)
___Train Local_ResNet_18,  epoch  97, local model 57, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4097/4558 (89.8859%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0488, Accuracy: 5341/10000 (53.4100%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4061/4465 (90.9518%)
___Train Local_ResNet_18,  epoch  97, local model 99, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4139/4465 (92.6988%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9120, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3297/3638 (90.6267%)
___Train Local_ResNet_18,  epoch  97, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3366/3638 (92.5234%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9591, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4134/4538 (91.0974%)
___Train Local_ResNet_18,  epoch  97, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4203/4538 (92.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.9020, Accuracy: 5614/10000 (56.1400%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5124/5740 (89.2683%)
___Train Local_ResNet_18,  epoch  97, local model 38, internal_epoch   2,  Average loss: 0.0050, Accuracy: 5161/5740 (89.9129%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.4264, Accuracy: 4928/10000 (49.2800%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3498/3837 (91.1650%)
___Train Local_ResNet_18,  epoch  97, local model 39, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3541/3837 (92.2856%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.8774, Accuracy: 5648/10000 (56.4800%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3944/4361 (90.4380%)
___Train Local_ResNet_18,  epoch  97, local model 97, internal_epoch   2,  Average loss: 0.0085, Accuracy: 3638/4361 (83.4212%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0694, Accuracy: 5276/10000 (52.7600%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4370/4793 (91.1746%)
___Train Local_ResNet_18,  epoch  97, local model 84, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4336/4793 (90.4653%)
___Test Local_ResNet_18 poisoned: False, epoch: 97: Average loss: 2.0612, Accuracy: 5374/10000 (53.7400%)
time spent on training: 233.9224555492401
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 24, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 57, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 38, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 97: Average loss: 1.1762, Accuracy: 6920/10000 (69.2000%)
___Test Target_ResNet_18 poisoned: True, epoch: 97: Average loss: 0.7361, Accuracy: 8153/9900 (82.3535%)
Done in 258.5246422290802 sec.
Server Epoch:98 choose agents : [13, 36, 58, 71, 72, 48, 55, 85, 23, 29, 45, 21, 88, 42, 79, 14, 65, 33, 35, 63].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4656/4885 (95.3122%), train_poison_data_count: 385
Global model norm: 43.05089874569984.
Norm before scaling: 43.03399166329522. Distance: 1.479332480292972
Total norm for 4 adversaries is: 43.03399166329522. distance: 1.479332480292972
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0942, Accuracy: 9654/9900 (97.5152%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 36, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4995/5305 (94.1565%), train_poison_data_count: 415
Global model norm: 43.05089874569984.
Norm before scaling: 43.036029713666956. Distance: 1.649874959889465
Total norm for 4 adversaries is: 43.036029713666956. distance: 1.649874959889465
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.0830, Accuracy: 9691/9900 (97.8889%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4456/4717 (94.4668%), train_poison_data_count: 370
Global model norm: 43.05089874569984.
Norm before scaling: 43.03601411309123. Distance: 1.4610067748918576
Total norm for 4 adversaries is: 43.03601411309123. distance: 1.4610067748918576
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1888, Accuracy: 9440/9900 (95.3535%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  98, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4768/5066 (94.1176%), train_poison_data_count: 400
Global model norm: 43.05089874569984.
Norm before scaling: 43.037891814492234. Distance: 1.6226980337127153
Total norm for 4 adversaries is: 43.037891814492234. distance: 1.6226980337127153
___Test Local_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.1289, Accuracy: 9570/9900 (96.6667%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4256/4767 (89.2805%)
___Train Local_ResNet_18,  epoch  98, local model 72, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4257/4767 (89.3014%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2366, Accuracy: 5199/10000 (51.9900%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4099/4441 (92.2990%)
___Train Local_ResNet_18,  epoch  98, local model 48, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4143/4441 (93.2898%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3243, Accuracy: 5231/10000 (52.3100%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4000/4356 (91.8274%)
___Train Local_ResNet_18,  epoch  98, local model 55, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3869/4356 (88.8200%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3799, Accuracy: 5053/10000 (50.5300%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5565/6391 (87.0756%)
___Train Local_ResNet_18,  epoch  98, local model 85, internal_epoch   2,  Average loss: 0.0065, Accuracy: 5558/6391 (86.9660%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2171, Accuracy: 5051/10000 (50.5100%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3809/4184 (91.0373%)
___Train Local_ResNet_18,  epoch  98, local model 23, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3797/4184 (90.7505%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9628, Accuracy: 5505/10000 (55.0500%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4001/4346 (92.0617%)
___Train Local_ResNet_18,  epoch  98, local model 29, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4034/4346 (92.8210%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8152, Accuracy: 5765/10000 (57.6500%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4491/5037 (89.1602%)
___Train Local_ResNet_18,  epoch  98, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4611/5037 (91.5426%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9251, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4191/4634 (90.4402%)
___Train Local_ResNet_18,  epoch  98, local model 21, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4203/4634 (90.6992%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.9544, Accuracy: 5597/10000 (55.9700%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4412/4934 (89.4203%)
___Train Local_ResNet_18,  epoch  98, local model 88, internal_epoch   2,  Average loss: 0.0073, Accuracy: 4256/4934 (86.2586%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.2041, Accuracy: 5104/10000 (51.0400%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4922/5424 (90.7448%)
___Train Local_ResNet_18,  epoch  98, local model 42, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4890/5424 (90.1549%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1600, Accuracy: 5187/10000 (51.8700%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3457/3781 (91.4308%)
___Train Local_ResNet_18,  epoch  98, local model 79, internal_epoch   2,  Average loss: 0.0071, Accuracy: 3273/3781 (86.5644%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1533, Accuracy: 5144/10000 (51.4400%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3534/3861 (91.5307%)
___Train Local_ResNet_18,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 3480/3861 (90.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.0209, Accuracy: 5377/10000 (53.7700%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4640/5055 (91.7903%)
___Train Local_ResNet_18,  epoch  98, local model 65, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4632/5055 (91.6320%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8962, Accuracy: 5625/10000 (56.2500%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4087/4433 (92.1949%)
___Train Local_ResNet_18,  epoch  98, local model 33, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4038/4433 (91.0896%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.8459, Accuracy: 5666/10000 (56.6600%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4705/5167 (91.0586%)
___Train Local_ResNet_18,  epoch  98, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4640/5167 (89.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.1118, Accuracy: 5273/10000 (52.7300%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3327/3590 (92.6741%)
___Train Local_ResNet_18,  epoch  98, local model 63, internal_epoch   2,  Average loss: 0.0064, Accuracy: 3166/3590 (88.1894%)
___Test Local_ResNet_18 poisoned: False, epoch: 98: Average loss: 2.3990, Accuracy: 5023/10000 (50.2300%)
time spent on training: 233.34601354599
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 72, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 85, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 29, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 21, confusion matrix appended.
Validation completed for user 88, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 79, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 65, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 98: Average loss: 1.1786, Accuracy: 6916/10000 (69.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 98: Average loss: 0.6894, Accuracy: 8259/9900 (83.4242%)
Done in 257.47658586502075 sec.
Server Epoch:99 choose agents : [13, 36, 58, 71, 50, 98, 55, 14, 30, 6, 70, 75, 73, 66, 9, 48, 69, 99, 92, 1].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4641/4885 (95.0051%), train_poison_data_count: 385
Global model norm: 43.07364327656981.
Norm before scaling: 43.05639782372287. Distance: 1.467074148331181
Total norm for 4 adversaries is: 43.05639782372287. distance: 1.467074148331181
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1503, Accuracy: 9548/9900 (96.4444%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5022/5305 (94.6654%), train_poison_data_count: 415
Global model norm: 43.07364327656981.
Norm before scaling: 43.055270846392894. Distance: 1.5711875489174711
Total norm for 4 adversaries is: 43.055270846392894. distance: 1.5711875489174711
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.1427, Accuracy: 9542/9900 (96.3838%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4480/4717 (94.9756%), train_poison_data_count: 370
Global model norm: 43.07364327656981.
Norm before scaling: 43.05825904370728. Distance: 1.451919055258826
Total norm for 4 adversaries is: 43.05825904370728. distance: 1.451919055258826
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.0690, Accuracy: 9714/9900 (98.1212%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch  99, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4784/5066 (94.4335%), train_poison_data_count: 400
Global model norm: 43.07364327656981.
Norm before scaling: 43.06249149582645. Distance: 1.5899629665356467
Total norm for 4 adversaries is: 43.06249149582645. distance: 1.5899629665356467
___Test Local_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.2345, Accuracy: 9311/9900 (94.0505%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3932/4368 (90.0183%)
___Train Local_ResNet_18,  epoch  99, local model 50, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3937/4368 (90.1328%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8482, Accuracy: 5632/10000 (56.3200%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3497/3828 (91.3532%)
___Train Local_ResNet_18,  epoch  99, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3557/3828 (92.9206%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8051, Accuracy: 5863/10000 (58.6300%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4046/4356 (92.8834%)
___Train Local_ResNet_18,  epoch  99, local model 55, internal_epoch   2,  Average loss: 0.0078, Accuracy: 3693/4356 (84.7796%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1166, Accuracy: 5234/10000 (52.3400%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3508/3861 (90.8573%)
___Train Local_ResNet_18,  epoch  99, local model 14, internal_epoch   2,  Average loss: 0.0051, Accuracy: 3492/3861 (90.4429%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9042, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3209/3472 (92.4251%)
___Train Local_ResNet_18,  epoch  99, local model 30, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3240/3472 (93.3180%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8813, Accuracy: 5725/10000 (57.2500%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4172/4538 (91.9348%)
___Train Local_ResNet_18,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4198/4538 (92.5077%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9446, Accuracy: 5568/10000 (55.6800%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4918/5392 (91.2092%)
___Train Local_ResNet_18,  epoch  99, local model 70, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4867/5392 (90.2634%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0239, Accuracy: 5388/10000 (53.8800%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3912/4295 (91.0827%)
___Train Local_ResNet_18,  epoch  99, local model 75, internal_epoch   2,  Average loss: 0.0072, Accuracy: 3675/4295 (85.5646%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.1294, Accuracy: 5214/10000 (52.1400%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3881/4235 (91.6411%)
___Train Local_ResNet_18,  epoch  99, local model 73, internal_epoch   2,  Average loss: 0.0052, Accuracy: 3831/4235 (90.4604%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9744, Accuracy: 5592/10000 (55.9200%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4114/4456 (92.3250%)
___Train Local_ResNet_18,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4086/4456 (91.6966%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8535, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4739/5265 (90.0095%)
___Train Local_ResNet_18,  epoch  99, local model 9, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4639/5265 (88.1102%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 2.0454, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4132/4441 (93.0421%)
___Train Local_ResNet_18,  epoch  99, local model 48, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4158/4441 (93.6276%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9959, Accuracy: 5582/10000 (55.8200%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3711/4013 (92.4745%)
___Train Local_ResNet_18,  epoch  99, local model 69, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3733/4013 (93.0227%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.7547, Accuracy: 5871/10000 (58.7100%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4096/4465 (91.7357%)
___Train Local_ResNet_18,  epoch  99, local model 99, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4136/4465 (92.6316%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8141, Accuracy: 5786/10000 (57.8600%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5690/6263 (90.8510%)
___Train Local_ResNet_18,  epoch  99, local model 92, internal_epoch   2,  Average loss: 0.0049, Accuracy: 5670/6263 (90.5317%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.9461, Accuracy: 5526/10000 (55.2600%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4533/4986 (90.9146%)
___Train Local_ResNet_18,  epoch  99, local model 1, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4534/4986 (90.9346%)
___Test Local_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.8545, Accuracy: 5733/10000 (57.3300%)
time spent on training: 234.36402082443237
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 50, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 70, confusion matrix appended.
Validation completed for user 75, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 69, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 92, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 99: Average loss: 1.1756, Accuracy: 6907/10000 (69.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 99: Average loss: 0.6798, Accuracy: 8288/9900 (83.7172%)
Done in 258.14788246154785 sec.
Server Epoch:100 choose agents : [13, 36, 58, 71, 91, 35, 98, 10, 33, 23, 28, 27, 96, 4, 39, 14, 42, 43, 78, 51].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4634/4885 (94.8618%), train_poison_data_count: 385
Global model norm: 43.09509549658029.
Norm before scaling: 43.07939589392982. Distance: 1.4975433896104209
Total norm for 4 adversaries is: 43.07939589392982. distance: 1.4975433896104209
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1949, Accuracy: 9416/9900 (95.1111%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5026/5305 (94.7408%), train_poison_data_count: 415
Global model norm: 43.09509549658029.
Norm before scaling: 43.07965941908156. Distance: 1.5822194682113977
Total norm for 4 adversaries is: 43.07965941908156. distance: 1.5822194682113977
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1136, Accuracy: 9613/9900 (97.1010%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4466/4717 (94.6788%), train_poison_data_count: 370
Global model norm: 43.09509549658029.
Norm before scaling: 43.078744158136594. Distance: 1.4496909963274118
Total norm for 4 adversaries is: 43.078744158136594. distance: 1.4496909963274118
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.0661, Accuracy: 9726/9900 (98.2424%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 100, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4798/5066 (94.7098%), train_poison_data_count: 400
Global model norm: 43.09509549658029.
Norm before scaling: 43.0816754748321. Distance: 1.5722167961167757
Total norm for 4 adversaries is: 43.0816754748321. distance: 1.5722167961167757
___Test Local_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.1153, Accuracy: 9620/9900 (97.1717%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3694/4158 (88.8408%)
___Train Local_ResNet_18,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0057, Accuracy: 3698/4158 (88.9370%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0030, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4671/5167 (90.4006%)
___Train Local_ResNet_18,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4689/5167 (90.7490%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1125, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3512/3828 (91.7450%)
___Train Local_ResNet_18,  epoch 100, local model 98, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3509/3828 (91.6667%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9545, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4254/4663 (91.2288%)
___Train Local_ResNet_18,  epoch 100, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4261/4663 (91.3789%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9199, Accuracy: 5537/10000 (55.3700%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4068/4433 (91.7663%)
___Train Local_ResNet_18,  epoch 100, local model 33, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4113/4433 (92.7814%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9563, Accuracy: 5605/10000 (56.0500%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3818/4184 (91.2524%)
___Train Local_ResNet_18,  epoch 100, local model 23, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3827/4184 (91.4675%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9869, Accuracy: 5581/10000 (55.8100%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4251/4716 (90.1399%)
___Train Local_ResNet_18,  epoch 100, local model 28, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4235/4716 (89.8007%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0601, Accuracy: 5340/10000 (53.4000%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3885/4223 (91.9962%)
___Train Local_ResNet_18,  epoch 100, local model 27, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3901/4223 (92.3751%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8563, Accuracy: 5657/10000 (56.5700%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4310/4679 (92.1137%)
___Train Local_ResNet_18,  epoch 100, local model 96, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4142/4679 (88.5232%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1510, Accuracy: 5193/10000 (51.9300%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3318/3704 (89.5788%)
___Train Local_ResNet_18,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3409/3704 (92.0356%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8743, Accuracy: 5631/10000 (56.3100%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3516/3837 (91.6341%)
___Train Local_ResNet_18,  epoch 100, local model 39, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3574/3837 (93.1457%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.0113, Accuracy: 5496/10000 (54.9600%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3535/3861 (91.5566%)
___Train Local_ResNet_18,  epoch 100, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3516/3861 (91.0645%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.9406, Accuracy: 5573/10000 (55.7300%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4934/5424 (90.9661%)
___Train Local_ResNet_18,  epoch 100, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4908/5424 (90.4867%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 2.1744, Accuracy: 5247/10000 (52.4700%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4199/4576 (91.7614%)
___Train Local_ResNet_18,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4212/4576 (92.0455%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.8052, Accuracy: 5761/10000 (57.6100%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3677/4025 (91.3540%)
___Train Local_ResNet_18,  epoch 100, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3764/4025 (93.5155%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7863, Accuracy: 5749/10000 (57.4900%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3484/3775 (92.2914%)
___Train Local_ResNet_18,  epoch 100, local model 51, internal_epoch   2,  Average loss: 0.0030, Accuracy: 3572/3775 (94.6225%)
___Test Local_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.7841, Accuracy: 5872/10000 (58.7200%)
time spent on training: 232.31726837158203
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 28, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 43, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 51, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 100: Average loss: 1.1745, Accuracy: 6918/10000 (69.1800%)
___Test Target_ResNet_18 poisoned: True, epoch: 100: Average loss: 0.6403, Accuracy: 8373/9900 (84.5758%)
Done in 257.2275273799896 sec.
Server Epoch:101 choose agents : [13, 36, 58, 71, 43, 87, 81, 6, 80, 63, 47, 3, 41, 25, 48, 22, 94, 24, 70, 98].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4653/4885 (95.2508%), train_poison_data_count: 385
Global model norm: 43.11501950859541.
Norm before scaling: 43.10075462017023. Distance: 1.5043492841246144
Total norm for 4 adversaries is: 43.10075462017023. distance: 1.5043492841246144
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0722, Accuracy: 9707/9900 (98.0505%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 36, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5013/5305 (94.4958%), train_poison_data_count: 415
Global model norm: 43.11501950859541.
Norm before scaling: 43.099402219516776. Distance: 1.6240461924800162
Total norm for 4 adversaries is: 43.099402219516776. distance: 1.6240461924800162
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0897, Accuracy: 9671/9900 (97.6869%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4482/4717 (95.0180%), train_poison_data_count: 370
Global model norm: 43.11501950859541.
Norm before scaling: 43.095800803268524. Distance: 1.387612798762409
Total norm for 4 adversaries is: 43.095800803268524. distance: 1.387612798762409
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.2591, Accuracy: 9276/9900 (93.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 101, local model 71, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4787/5066 (94.4927%), train_poison_data_count: 400
Global model norm: 43.11501950859541.
Norm before scaling: 43.10205175202655. Distance: 1.592244278454125
Total norm for 4 adversaries is: 43.10205175202655. distance: 1.592244278454125
___Test Local_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.0447, Accuracy: 9785/9900 (98.8384%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4156/4576 (90.8217%)
___Train Local_ResNet_18,  epoch 101, local model 43, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4231/4576 (92.4607%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9191, Accuracy: 5660/10000 (56.6000%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3315/3672 (90.2778%)
___Train Local_ResNet_18,  epoch 101, local model 87, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3314/3672 (90.2505%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0331, Accuracy: 5349/10000 (53.4900%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4256/4618 (92.1611%)
___Train Local_ResNet_18,  epoch 101, local model 81, internal_epoch   2,  Average loss: 0.0058, Accuracy: 4102/4618 (88.8263%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1207, Accuracy: 5274/10000 (52.7400%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4214/4538 (92.8603%)
___Train Local_ResNet_18,  epoch 101, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4265/4538 (93.9841%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8369, Accuracy: 5814/10000 (58.1400%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4554/5025 (90.6269%)
___Train Local_ResNet_18,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4615/5025 (91.8408%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1710, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3318/3590 (92.4234%)
___Train Local_ResNet_18,  epoch 101, local model 63, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3346/3590 (93.2033%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.8977, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4303/4707 (91.4170%)
___Train Local_ResNet_18,  epoch 101, local model 47, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4290/4707 (91.1409%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0603, Accuracy: 5401/10000 (54.0100%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4496/4918 (91.4193%)
___Train Local_ResNet_18,  epoch 101, local model 3, internal_epoch   2,  Average loss: 0.0048, Accuracy: 4454/4918 (90.5653%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9651, Accuracy: 5394/10000 (53.9400%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3939/4336 (90.8441%)
___Train Local_ResNet_18,  epoch 101, local model 41, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3972/4336 (91.6052%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9477, Accuracy: 5567/10000 (55.6700%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5239/5902 (88.7665%)
___Train Local_ResNet_18,  epoch 101, local model 25, internal_epoch   2,  Average loss: 0.0075, Accuracy: 5052/5902 (85.5981%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1605, Accuracy: 5244/10000 (52.4400%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4116/4441 (92.6818%)
___Train Local_ResNet_18,  epoch 101, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4163/4441 (93.7401%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9821, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4694/5232 (89.7171%)
___Train Local_ResNet_18,  epoch 101, local model 22, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4686/5232 (89.5642%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0932, Accuracy: 5306/10000 (53.0600%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4351/4804 (90.5704%)
___Train Local_ResNet_18,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4237/4804 (88.1973%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.1874, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3638/3969 (91.6604%)
___Train Local_ResNet_18,  epoch 101, local model 24, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3649/3969 (91.9375%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9731, Accuracy: 5649/10000 (56.4900%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4929/5392 (91.4132%)
___Train Local_ResNet_18,  epoch 101, local model 70, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4863/5392 (90.1892%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 2.0512, Accuracy: 5467/10000 (54.6700%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3529/3828 (92.1891%)
___Train Local_ResNet_18,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3535/3828 (92.3459%)
___Test Local_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.9201, Accuracy: 5617/10000 (56.1700%)
time spent on training: 235.93105554580688
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 43, confusion matrix appended.
Validation completed for user 87, confusion matrix appended.
Validation completed for user 81, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 63, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Validation completed for user 41, confusion matrix appended.
Validation completed for user 25, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 94, confusion matrix appended.
Validation completed for user 24, confusion matrix appended.
Validation completed for user 70, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 101: Average loss: 1.1843, Accuracy: 6908/10000 (69.0800%)
___Test Target_ResNet_18 poisoned: True, epoch: 101: Average loss: 0.5781, Accuracy: 8494/9900 (85.7980%)
Done in 260.30503368377686 sec.
Server Epoch:102 choose agents : [13, 36, 58, 71, 22, 46, 62, 78, 48, 95, 32, 15, 25, 6, 80, 27, 97, 37, 87, 89].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4683/4885 (95.8649%), train_poison_data_count: 385
Global model norm: 43.13653463268911.
Norm before scaling: 43.11676919868663. Distance: 1.3929465556877114
Total norm for 4 adversaries is: 43.11676919868663. distance: 1.3929465556877114
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0958, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5032/5305 (94.8539%), train_poison_data_count: 415
Global model norm: 43.13653463268911.
Norm before scaling: 43.1202669504144. Distance: 1.5873297983077055
Total norm for 4 adversaries is: 43.1202669504144. distance: 1.5873297983077055
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0832, Accuracy: 9680/9900 (97.7778%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4460/4717 (94.5516%), train_poison_data_count: 370
Global model norm: 43.13653463268911.
Norm before scaling: 43.119419079549445. Distance: 1.443703327828245
Total norm for 4 adversaries is: 43.119419079549445. distance: 1.443703327828245
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.1138, Accuracy: 9605/9900 (97.0202%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 102, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4784/5066 (94.4335%), train_poison_data_count: 400
Global model norm: 43.13653463268911.
Norm before scaling: 43.12097609170695. Distance: 1.542965427829691
Total norm for 4 adversaries is: 43.12097609170695. distance: 1.542965427829691
___Test Local_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.0939, Accuracy: 9650/9900 (97.4747%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4691/5232 (89.6598%)
___Train Local_ResNet_18,  epoch 102, local model 22, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4624/5232 (88.3792%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1640, Accuracy: 5198/10000 (51.9800%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4467/4956 (90.1332%)
___Train Local_ResNet_18,  epoch 102, local model 46, internal_epoch   2,  Average loss: 0.0054, Accuracy: 4416/4956 (89.1041%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1201, Accuracy: 5229/10000 (52.2900%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4520/5063 (89.2751%)
___Train Local_ResNet_18,  epoch 102, local model 62, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4488/5063 (88.6431%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1654, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3748/4025 (93.1180%)
___Train Local_ResNet_18,  epoch 102, local model 78, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3759/4025 (93.3913%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8246, Accuracy: 5798/10000 (57.9800%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4117/4441 (92.7043%)
___Train Local_ResNet_18,  epoch 102, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4092/4441 (92.1414%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0696, Accuracy: 5470/10000 (54.7000%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4119/4625 (89.0595%)
___Train Local_ResNet_18,  epoch 102, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 4065/4625 (87.8919%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.0255, Accuracy: 5464/10000 (54.6400%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4992/5591 (89.2864%)
___Train Local_ResNet_18,  epoch 102, local model 32, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4835/5591 (86.4783%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2964, Accuracy: 5112/10000 (51.1200%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5168/5582 (92.5833%)
___Train Local_ResNet_18,  epoch 102, local model 15, internal_epoch   2,  Average loss: 0.0045, Accuracy: 5080/5582 (91.0068%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1154, Accuracy: 5246/10000 (52.4600%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5251/5902 (88.9698%)
___Train Local_ResNet_18,  epoch 102, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 5109/5902 (86.5639%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.3320, Accuracy: 4920/10000 (49.2000%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4221/4538 (93.0145%)
___Train Local_ResNet_18,  epoch 102, local model 6, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4241/4538 (93.4553%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.7745, Accuracy: 5835/10000 (58.3500%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4613/5025 (91.8010%)
___Train Local_ResNet_18,  epoch 102, local model 80, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4616/5025 (91.8607%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.9865, Accuracy: 5476/10000 (54.7600%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3865/4223 (91.5226%)
___Train Local_ResNet_18,  epoch 102, local model 27, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3895/4223 (92.2330%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.8676, Accuracy: 5686/10000 (56.8600%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3923/4361 (89.9564%)
___Train Local_ResNet_18,  epoch 102, local model 97, internal_epoch   2,  Average loss: 0.0079, Accuracy: 3700/4361 (84.8429%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1815, Accuracy: 5188/10000 (51.8800%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3958/4354 (90.9049%)
___Train Local_ResNet_18,  epoch 102, local model 37, internal_epoch   2,  Average loss: 0.0095, Accuracy: 3598/4354 (82.6367%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.4038, Accuracy: 4812/10000 (48.1200%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3333/3672 (90.7680%)
___Train Local_ResNet_18,  epoch 102, local model 87, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3335/3672 (90.8224%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.1654, Accuracy: 5232/10000 (52.3200%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3991/4356 (91.6208%)
___Train Local_ResNet_18,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3889/4356 (89.2792%)
___Test Local_ResNet_18 poisoned: False, epoch: 102: Average loss: 2.2626, Accuracy: 5012/10000 (50.1200%)
time spent on training: 239.09647464752197
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 46, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 48, confusion matrix appended.
Validation completed for user 95, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 25, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 27, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 87, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 102: Average loss: 1.1840, Accuracy: 6899/10000 (68.9900%)
___Test Target_ResNet_18 poisoned: True, epoch: 102: Average loss: 0.5754, Accuracy: 8506/9900 (85.9192%)
Done in 263.23405051231384 sec.
Server Epoch:103 choose agents : [13, 36, 58, 71, 98, 73, 4, 59, 16, 38, 12, 43, 77, 42, 64, 85, 17, 66, 94, 60].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4644/4885 (95.0665%), train_poison_data_count: 385
Global model norm: 43.160018899964726.
Norm before scaling: 43.14313618868374. Distance: 1.457069621462942
Total norm for 4 adversaries is: 43.14313618868374. distance: 1.457069621462942
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0583, Accuracy: 9754/9900 (98.5253%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5034/5305 (94.8916%), train_poison_data_count: 415
Global model norm: 43.160018899964726.
Norm before scaling: 43.13994447806247. Distance: 1.520582291598742
Total norm for 4 adversaries is: 43.13994447806247. distance: 1.520582291598742
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1206, Accuracy: 9583/9900 (96.7980%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4486/4717 (95.1028%), train_poison_data_count: 370
Global model norm: 43.160018899964726.
Norm before scaling: 43.14124467591889. Distance: 1.3955619272960966
Total norm for 4 adversaries is: 43.14124467591889. distance: 1.3955619272960966
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.1419, Accuracy: 9543/9900 (96.3939%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 103, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4809/5066 (94.9270%), train_poison_data_count: 400
Global model norm: 43.160018899964726.
Norm before scaling: 43.14627390804955. Distance: 1.5586726042033703
Total norm for 4 adversaries is: 43.14627390804955. distance: 1.5586726042033703
___Test Local_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.0968, Accuracy: 9674/9900 (97.7172%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3561/3828 (93.0251%)
___Train Local_ResNet_18,  epoch 103, local model 98, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3553/3828 (92.8161%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8505, Accuracy: 5733/10000 (57.3300%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3929/4235 (92.7745%)
___Train Local_ResNet_18,  epoch 103, local model 73, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3780/4235 (89.2562%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9818, Accuracy: 5546/10000 (55.4600%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3377/3704 (91.1717%)
___Train Local_ResNet_18,  epoch 103, local model 4, internal_epoch   2,  Average loss: 0.0054, Accuracy: 3320/3704 (89.6328%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0704, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3713/4046 (91.7696%)
___Train Local_ResNet_18,  epoch 103, local model 59, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3755/4046 (92.8077%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8283, Accuracy: 5784/10000 (57.8400%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4497/4928 (91.2541%)
___Train Local_ResNet_18,  epoch 103, local model 16, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4448/4928 (90.2597%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9244, Accuracy: 5580/10000 (55.8000%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5218/5740 (90.9059%)
___Train Local_ResNet_18,  epoch 103, local model 38, internal_epoch   2,  Average loss: 0.0052, Accuracy: 5168/5740 (90.0348%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1249, Accuracy: 5260/10000 (52.6000%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4603/5083 (90.5568%)
___Train Local_ResNet_18,  epoch 103, local model 12, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4561/5083 (89.7305%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.8435, Accuracy: 5640/10000 (56.4000%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4189/4576 (91.5428%)
___Train Local_ResNet_18,  epoch 103, local model 43, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4112/4576 (89.8601%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9822, Accuracy: 5531/10000 (55.3100%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4234/4647 (91.1125%)
___Train Local_ResNet_18,  epoch 103, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4258/4647 (91.6290%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9607, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4990/5424 (91.9985%)
___Train Local_ResNet_18,  epoch 103, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4947/5424 (91.2058%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.2612, Accuracy: 5113/10000 (51.1300%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4077/4503 (90.5396%)
___Train Local_ResNet_18,  epoch 103, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4074/4503 (90.4730%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1111, Accuracy: 5482/10000 (54.8200%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5663/6391 (88.6090%)
___Train Local_ResNet_18,  epoch 103, local model 85, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5581/6391 (87.3259%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0942, Accuracy: 5337/10000 (53.3700%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4093/4511 (90.7338%)
___Train Local_ResNet_18,  epoch 103, local model 17, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4074/4511 (90.3126%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.1001, Accuracy: 5347/10000 (53.4700%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4128/4456 (92.6391%)
___Train Local_ResNet_18,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4099/4456 (91.9883%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.9736, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4365/4804 (90.8618%)
___Train Local_ResNet_18,  epoch 103, local model 94, internal_epoch   2,  Average loss: 0.0090, Accuracy: 3978/4804 (82.8060%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.3456, Accuracy: 4997/10000 (49.9700%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3463/3804 (91.0358%)
___Train Local_ResNet_18,  epoch 103, local model 60, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3493/3804 (91.8244%)
___Test Local_ResNet_18 poisoned: False, epoch: 103: Average loss: 2.0483, Accuracy: 5390/10000 (53.9000%)
time spent on training: 236.8547694683075
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 73, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 59, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 38, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 43, confusion matrix appended.
Validation completed for user 77, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 64, confusion matrix appended.
Validation completed for user 85, confusion matrix appended.
Validation completed for user 17, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Validation completed for user 94, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 103: Average loss: 1.1856, Accuracy: 6910/10000 (69.1000%)
___Test Target_ResNet_18 poisoned: True, epoch: 103: Average loss: 0.5427, Accuracy: 8569/9900 (86.5556%)
Done in 260.720520734787 sec.
Server Epoch:104 choose agents : [13, 36, 58, 71, 16, 45, 70, 8, 60, 39, 62, 7, 34, 76, 10, 95, 49, 12, 98, 4].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4668/4885 (95.5578%), train_poison_data_count: 385
Global model norm: 43.182744119016306.
Norm before scaling: 43.16458073783918. Distance: 1.44370274982501
Total norm for 4 adversaries is: 43.16458073783918. distance: 1.44370274982501
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0919, Accuracy: 9658/9900 (97.5556%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5053/5305 (95.2498%), train_poison_data_count: 415
Global model norm: 43.182744119016306.
Norm before scaling: 43.16458215184933. Distance: 1.582123402866794
Total norm for 4 adversaries is: 43.16458215184933. distance: 1.582123402866794
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.1007, Accuracy: 9631/9900 (97.2828%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 58, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4484/4717 (95.0604%), train_poison_data_count: 370
Global model norm: 43.182744119016306.
Norm before scaling: 43.165604469064114. Distance: 1.4239375487091774
Total norm for 4 adversaries is: 43.165604469064114. distance: 1.4239375487091774
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0821, Accuracy: 9689/9900 (97.8687%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 104, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4823/5066 (95.2033%), train_poison_data_count: 400
Global model norm: 43.182744119016306.
Norm before scaling: 43.1654121678131. Distance: 1.486906683425101
Total norm for 4 adversaries is: 43.1654121678131. distance: 1.486906683425101
___Test Local_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.0689, Accuracy: 9706/9900 (98.0404%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4513/4928 (91.5787%)
___Train Local_ResNet_18,  epoch 104, local model 16, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4486/4928 (91.0308%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9531, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4501/5037 (89.3587%)
___Train Local_ResNet_18,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4586/5037 (91.0463%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9503, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4961/5392 (92.0067%)
___Train Local_ResNet_18,  epoch 104, local model 70, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4829/5392 (89.5586%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0901, Accuracy: 5339/10000 (53.3900%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4092/4501 (90.9131%)
___Train Local_ResNet_18,  epoch 104, local model 8, internal_epoch   2,  Average loss: 0.0052, Accuracy: 4052/4501 (90.0244%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0093, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3453/3804 (90.7729%)
___Train Local_ResNet_18,  epoch 104, local model 60, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3499/3804 (91.9821%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9522, Accuracy: 5560/10000 (55.6000%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3526/3837 (91.8947%)
___Train Local_ResNet_18,  epoch 104, local model 39, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3591/3837 (93.5887%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9552, Accuracy: 5535/10000 (55.3500%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4535/5063 (89.5714%)
___Train Local_ResNet_18,  epoch 104, local model 62, internal_epoch   2,  Average loss: 0.0082, Accuracy: 4260/5063 (84.1398%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.4820, Accuracy: 4823/10000 (48.2300%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4053/4481 (90.4486%)
___Train Local_ResNet_18,  epoch 104, local model 7, internal_epoch   2,  Average loss: 0.0066, Accuracy: 3968/4481 (88.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0573, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4162/4518 (92.1204%)
___Train Local_ResNet_18,  epoch 104, local model 34, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4141/4518 (91.6556%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0019, Accuracy: 5491/10000 (54.9100%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3277/3638 (90.0770%)
___Train Local_ResNet_18,  epoch 104, local model 76, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3333/3638 (91.6163%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8641, Accuracy: 5670/10000 (56.7000%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4280/4663 (91.7864%)
___Train Local_ResNet_18,  epoch 104, local model 10, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4294/4663 (92.0866%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.0110, Accuracy: 5419/10000 (54.1900%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4144/4625 (89.6000%)
___Train Local_ResNet_18,  epoch 104, local model 95, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4052/4625 (87.6108%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1929, Accuracy: 5182/10000 (51.8200%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4687/5197 (90.1866%)
___Train Local_ResNet_18,  epoch 104, local model 49, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4671/5197 (89.8788%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1294, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4621/5083 (90.9109%)
___Train Local_ResNet_18,  epoch 104, local model 12, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4574/5083 (89.9862%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 2.1191, Accuracy: 5312/10000 (53.1200%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3560/3828 (92.9990%)
___Train Local_ResNet_18,  epoch 104, local model 98, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3597/3828 (93.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.8108, Accuracy: 5842/10000 (58.4200%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3340/3704 (90.1728%)
___Train Local_ResNet_18,  epoch 104, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3394/3704 (91.6307%)
___Test Local_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.9079, Accuracy: 5654/10000 (56.5400%)
time spent on training: 233.3208291530609
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 70, confusion matrix appended.
Validation completed for user 8, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 10, confusion matrix appended.
Validation completed for user 95, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 98, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 104: Average loss: 1.1837, Accuracy: 6903/10000 (69.0300%)
___Test Target_ResNet_18 poisoned: True, epoch: 104: Average loss: 0.5357, Accuracy: 8575/9900 (86.6162%)
Done in 257.2223496437073 sec.
Server Epoch:105 choose agents : [13, 36, 58, 71, 14, 23, 45, 49, 80, 67, 7, 43, 22, 37, 83, 40, 61, 52, 4, 88].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4656/4885 (95.3122%), train_poison_data_count: 385
Global model norm: 43.20460412251005.
Norm before scaling: 43.186960131394116. Distance: 1.490126379657059
Total norm for 4 adversaries is: 43.186960131394116. distance: 1.490126379657059
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0955, Accuracy: 9649/9900 (97.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 36, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5073/5305 (95.6268%), train_poison_data_count: 415
Global model norm: 43.20460412251005.
Norm before scaling: 43.18342820665918. Distance: 1.5033999693171873
Total norm for 4 adversaries is: 43.18342820665918. distance: 1.5033999693171873
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0573, Accuracy: 9744/9900 (98.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4481/4717 (94.9968%), train_poison_data_count: 370
Global model norm: 43.20460412251005.
Norm before scaling: 43.18590157362195. Distance: 1.419921875
Total norm for 4 adversaries is: 43.18590157362195. distance: 1.419921875
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.1256, Accuracy: 9573/9900 (96.6970%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 105, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4797/5066 (94.6901%), train_poison_data_count: 400
Global model norm: 43.20460412251005.
Norm before scaling: 43.18789288442856. Distance: 1.528705584924991
Total norm for 4 adversaries is: 43.18789288442856. distance: 1.528705584924991
___Test Local_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.0799, Accuracy: 9695/9900 (97.9293%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3558/3861 (92.1523%)
___Train Local_ResNet_18,  epoch 105, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3548/3861 (91.8933%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8759, Accuracy: 5630/10000 (56.3000%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3833/4184 (91.6109%)
___Train Local_ResNet_18,  epoch 105, local model 23, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3830/4184 (91.5392%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.8763, Accuracy: 5620/10000 (56.2000%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4533/5037 (89.9940%)
___Train Local_ResNet_18,  epoch 105, local model 45, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4591/5037 (91.1455%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0007, Accuracy: 5432/10000 (54.3200%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4672/5197 (89.8980%)
___Train Local_ResNet_18,  epoch 105, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 4548/5197 (87.5120%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0554, Accuracy: 5311/10000 (53.1100%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4528/5025 (90.1095%)
___Train Local_ResNet_18,  epoch 105, local model 80, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4511/5025 (89.7711%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9058, Accuracy: 5569/10000 (55.6900%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4640/5116 (90.6959%)
___Train Local_ResNet_18,  epoch 105, local model 67, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4533/5116 (88.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1227, Accuracy: 5317/10000 (53.1700%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4053/4481 (90.4486%)
___Train Local_ResNet_18,  epoch 105, local model 7, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4028/4481 (89.8906%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1571, Accuracy: 5331/10000 (53.3100%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4246/4576 (92.7885%)
___Train Local_ResNet_18,  epoch 105, local model 43, internal_epoch   2,  Average loss: 0.0042, Accuracy: 4188/4576 (91.5210%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0808, Accuracy: 5481/10000 (54.8100%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4728/5232 (90.3670%)
___Train Local_ResNet_18,  epoch 105, local model 22, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4715/5232 (90.1185%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9978, Accuracy: 5527/10000 (55.2700%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3948/4354 (90.6752%)
___Train Local_ResNet_18,  epoch 105, local model 37, internal_epoch   2,  Average loss: 0.0083, Accuracy: 3690/4354 (84.7497%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.2208, Accuracy: 5202/10000 (52.0200%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2972/3271 (90.8591%)
___Train Local_ResNet_18,  epoch 105, local model 83, internal_epoch   2,  Average loss: 0.0053, Accuracy: 2958/3271 (90.4311%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9453, Accuracy: 5637/10000 (56.3700%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4915/5455 (90.1008%)
___Train Local_ResNet_18,  epoch 105, local model 40, internal_epoch   2,  Average loss: 0.0053, Accuracy: 4871/5455 (89.2942%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.1090, Accuracy: 5220/10000 (52.2000%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3761/4126 (91.1537%)
___Train Local_ResNet_18,  epoch 105, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3802/4126 (92.1474%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0000, Accuracy: 5398/10000 (53.9800%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3477/3797 (91.5723%)
___Train Local_ResNet_18,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3534/3797 (93.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.9105, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3371/3704 (91.0097%)
___Train Local_ResNet_18,  epoch 105, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3405/3704 (91.9276%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.7851, Accuracy: 5818/10000 (58.1800%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4491/4934 (91.0215%)
___Train Local_ResNet_18,  epoch 105, local model 88, internal_epoch   2,  Average loss: 0.0069, Accuracy: 4286/4934 (86.8666%)
___Test Local_ResNet_18 poisoned: False, epoch: 105: Average loss: 2.0919, Accuracy: 5219/10000 (52.1900%)
time spent on training: 236.35596323013306
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 14, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 45, confusion matrix appended.
Validation completed for user 49, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 67, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 43, confusion matrix appended.
Validation completed for user 22, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 83, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 61, confusion matrix appended.
Validation completed for user 52, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 88, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 105: Average loss: 1.1803, Accuracy: 6917/10000 (69.1700%)
___Test Target_ResNet_18 poisoned: True, epoch: 105: Average loss: 0.5172, Accuracy: 8619/9900 (87.0606%)
Done in 260.74132013320923 sec.
Server Epoch:106 choose agents : [13, 36, 58, 71, 81, 95, 38, 74, 61, 86, 91, 29, 82, 9, 78, 93, 39, 76, 30, 66].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4681/4885 (95.8240%), train_poison_data_count: 385
Global model norm: 43.22682724593606.
Norm before scaling: 43.206475909831795. Distance: 1.4003007293322243
Total norm for 4 adversaries is: 43.206475909831795. distance: 1.4003007293322243
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0981, Accuracy: 9652/9900 (97.4949%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5048/5305 (95.1555%), train_poison_data_count: 415
Global model norm: 43.22682724593606.
Norm before scaling: 43.20749582320757. Distance: 1.5420422053665437
Total norm for 4 adversaries is: 43.20749582320757. distance: 1.5420422053665437
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.1884, Accuracy: 9414/9900 (95.0909%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4467/4717 (94.7000%), train_poison_data_count: 370
Global model norm: 43.22682724593606.
Norm before scaling: 43.20763990875196. Distance: 1.442263216653413
Total norm for 4 adversaries is: 43.20763990875196. distance: 1.442263216653413
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0850, Accuracy: 9679/9900 (97.7677%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 106, local model 71, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4828/5066 (95.3020%), train_poison_data_count: 400
Global model norm: 43.22682724593606.
Norm before scaling: 43.20877421248273. Distance: 1.504864434508158
Total norm for 4 adversaries is: 43.20877421248273. distance: 1.504864434508158
___Test Local_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.0657, Accuracy: 9727/9900 (98.2525%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4261/4618 (92.2694%)
___Train Local_ResNet_18,  epoch 106, local model 81, internal_epoch   2,  Average loss: 0.0059, Accuracy: 4104/4618 (88.8696%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9654, Accuracy: 5593/10000 (55.9300%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4120/4625 (89.0811%)
___Train Local_ResNet_18,  epoch 106, local model 95, internal_epoch   2,  Average loss: 0.0065, Accuracy: 4038/4625 (87.3081%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.2183, Accuracy: 5141/10000 (51.4100%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5233/5740 (91.1672%)
___Train Local_ResNet_18,  epoch 106, local model 38, internal_epoch   2,  Average loss: 0.0057, Accuracy: 5101/5740 (88.8676%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.3553, Accuracy: 5037/10000 (50.3700%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4002/4416 (90.6250%)
___Train Local_ResNet_18,  epoch 106, local model 74, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4036/4416 (91.3949%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9690, Accuracy: 5532/10000 (55.3200%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3814/4126 (92.4382%)
___Train Local_ResNet_18,  epoch 106, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3824/4126 (92.6806%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8459, Accuracy: 5731/10000 (57.3100%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3260/3616 (90.1549%)
___Train Local_ResNet_18,  epoch 106, local model 86, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3314/3616 (91.6482%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8023, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3678/4158 (88.4560%)
___Train Local_ResNet_18,  epoch 106, local model 91, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3708/4158 (89.1775%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0171, Accuracy: 5417/10000 (54.1700%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4030/4346 (92.7289%)
___Train Local_ResNet_18,  epoch 106, local model 29, internal_epoch   2,  Average loss: 0.0034, Accuracy: 4053/4346 (93.2582%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9307, Accuracy: 5618/10000 (56.1800%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4359/4874 (89.4337%)
___Train Local_ResNet_18,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0062, Accuracy: 4268/4874 (87.5667%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.4898, Accuracy: 4872/10000 (48.7200%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4746/5265 (90.1425%)
___Train Local_ResNet_18,  epoch 106, local model 9, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4658/5265 (88.4710%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.1594, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3715/4025 (92.2981%)
___Train Local_ResNet_18,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3750/4025 (93.1677%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.8764, Accuracy: 5719/10000 (57.1900%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4224/4651 (90.8192%)
___Train Local_ResNet_18,  epoch 106, local model 93, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4192/4651 (90.1312%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0942, Accuracy: 5346/10000 (53.4600%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3483/3837 (90.7740%)
___Train Local_ResNet_18,  epoch 106, local model 39, internal_epoch   2,  Average loss: 0.0044, Accuracy: 3512/3837 (91.5298%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 2.0450, Accuracy: 5397/10000 (53.9700%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3289/3638 (90.4068%)
___Train Local_ResNet_18,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0040, Accuracy: 3344/3638 (91.9186%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9215, Accuracy: 5551/10000 (55.5100%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3228/3472 (92.9724%)
___Train Local_ResNet_18,  epoch 106, local model 30, internal_epoch   2,  Average loss: 0.0035, Accuracy: 3251/3472 (93.6348%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9832, Accuracy: 5601/10000 (56.0100%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4144/4456 (92.9982%)
___Train Local_ResNet_18,  epoch 106, local model 66, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4159/4456 (93.3348%)
___Test Local_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.9983, Accuracy: 5530/10000 (55.3000%)
time spent on training: 233.3083906173706
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 81, confusion matrix appended.
Validation completed for user 95, confusion matrix appended.
Validation completed for user 38, confusion matrix appended.
Validation completed for user 74, confusion matrix appended.
Validation completed for user 61, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Validation completed for user 29, confusion matrix appended.
Validation completed for user 82, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 93, confusion matrix appended.
Validation completed for user 39, confusion matrix appended.
Validation completed for user 76, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 106: Average loss: 1.1774, Accuracy: 6932/10000 (69.3200%)
___Test Target_ResNet_18 poisoned: True, epoch: 106: Average loss: 0.5068, Accuracy: 8643/9900 (87.3030%)
Done in 257.54040718078613 sec.
Server Epoch:107 choose agents : [13, 36, 58, 71, 42, 1, 35, 28, 50, 89, 94, 7, 78, 0, 86, 23, 54, 97, 26, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4645/4885 (95.0870%), train_poison_data_count: 385
Global model norm: 43.24733271670491.
Norm before scaling: 43.232853130966845. Distance: 1.5036471056913518
Total norm for 4 adversaries is: 43.232853130966845. distance: 1.5036471056913518
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1158, Accuracy: 9616/9900 (97.1313%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5073/5305 (95.6268%), train_poison_data_count: 415
Global model norm: 43.24733271670491.
Norm before scaling: 43.227202829388865. Distance: 1.5103198930278026
Total norm for 4 adversaries is: 43.227202829388865. distance: 1.5103198930278026
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0611, Accuracy: 9739/9900 (98.3737%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4493/4717 (95.2512%), train_poison_data_count: 370
Global model norm: 43.24733271670491.
Norm before scaling: 43.22778031788051. Distance: 1.3998294913818332
Total norm for 4 adversaries is: 43.22778031788051. distance: 1.3998294913818332
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.1027, Accuracy: 9623/9900 (97.2020%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 107, local model 71, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4805/5066 (94.8480%), train_poison_data_count: 400
Global model norm: 43.24733271670491.
Norm before scaling: 43.23165310369389. Distance: 1.550900702115866
Total norm for 4 adversaries is: 43.23165310369389. distance: 1.550900702115866
___Test Local_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.0657, Accuracy: 9731/9900 (98.2929%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4974/5424 (91.7035%)
___Train Local_ResNet_18,  epoch 107, local model 42, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4965/5424 (91.5376%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1554, Accuracy: 5279/10000 (52.7900%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4549/4986 (91.2355%)
___Train Local_ResNet_18,  epoch 107, local model 1, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4513/4986 (90.5134%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9418, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4705/5167 (91.0586%)
___Train Local_ResNet_18,  epoch 107, local model 35, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4695/5167 (90.8651%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0650, Accuracy: 5390/10000 (53.9000%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4251/4716 (90.1399%)
___Train Local_ResNet_18,  epoch 107, local model 28, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4252/4716 (90.1612%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0758, Accuracy: 5313/10000 (53.1300%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3944/4368 (90.2930%)
___Train Local_ResNet_18,  epoch 107, local model 50, internal_epoch   2,  Average loss: 0.0055, Accuracy: 3873/4368 (88.6676%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.9946, Accuracy: 5497/10000 (54.9700%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4013/4356 (92.1258%)
___Train Local_ResNet_18,  epoch 107, local model 89, internal_epoch   2,  Average loss: 0.0086, Accuracy: 3648/4356 (83.7466%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.4516, Accuracy: 4632/10000 (46.3200%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4399/4804 (91.5695%)
___Train Local_ResNet_18,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0056, Accuracy: 4268/4804 (88.8426%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1840, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4071/4481 (90.8503%)
___Train Local_ResNet_18,  epoch 107, local model 7, internal_epoch   2,  Average loss: 0.0070, Accuracy: 3973/4481 (88.6632%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0436, Accuracy: 5479/10000 (54.7900%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3714/4025 (92.2733%)
___Train Local_ResNet_18,  epoch 107, local model 78, internal_epoch   2,  Average loss: 0.0032, Accuracy: 3801/4025 (94.4348%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8387, Accuracy: 5781/10000 (57.8100%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4570/5017 (91.0903%)
___Train Local_ResNet_18,  epoch 107, local model 0, internal_epoch   2,  Average loss: 0.0045, Accuracy: 4564/5017 (90.9707%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0706, Accuracy: 5385/10000 (53.8500%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3286/3616 (90.8739%)
___Train Local_ResNet_18,  epoch 107, local model 86, internal_epoch   2,  Average loss: 0.0042, Accuracy: 3321/3616 (91.8418%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8458, Accuracy: 5772/10000 (57.7200%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3807/4184 (90.9895%)
___Train Local_ResNet_18,  epoch 107, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 3825/4184 (91.4197%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8441, Accuracy: 5709/10000 (57.0900%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4653/5195 (89.5669%)
___Train Local_ResNet_18,  epoch 107, local model 54, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4616/5195 (88.8547%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.0700, Accuracy: 5354/10000 (53.5400%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3959/4361 (90.7819%)
___Train Local_ResNet_18,  epoch 107, local model 97, internal_epoch   2,  Average loss: 0.0048, Accuracy: 3959/4361 (90.7819%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1412, Accuracy: 5321/10000 (53.2100%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3516/3756 (93.6102%)
___Train Local_ResNet_18,  epoch 107, local model 26, internal_epoch   2,  Average loss: 0.0031, Accuracy: 3550/3756 (94.5154%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.8491, Accuracy: 5812/10000 (58.1200%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5034/5591 (90.0376%)
___Train Local_ResNet_18,  epoch 107, local model 32, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4922/5591 (88.0343%)
___Test Local_ResNet_18 poisoned: False, epoch: 107: Average loss: 2.1542, Accuracy: 5276/10000 (52.7600%)
time spent on training: 237.4354293346405
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 42, confusion matrix appended.
Validation completed for user 1, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 28, confusion matrix appended.
Validation completed for user 50, confusion matrix appended.
Validation completed for user 89, confusion matrix appended.
Validation completed for user 94, confusion matrix appended.
Validation completed for user 7, confusion matrix appended.
Validation completed for user 78, confusion matrix appended.
Validation completed for user 0, confusion matrix appended.
Validation completed for user 86, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 54, confusion matrix appended.
Validation completed for user 97, confusion matrix appended.
Validation completed for user 26, confusion matrix appended.
Validation completed for user 32, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 107: Average loss: 1.1799, Accuracy: 6926/10000 (69.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 107: Average loss: 0.4754, Accuracy: 8713/9900 (88.0101%)
Done in 261.32838439941406 sec.
Server Epoch:108 choose agents : [13, 36, 58, 71, 31, 40, 4, 56, 16, 60, 41, 59, 84, 26, 85, 87, 57, 43, 66, 55].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4678/4885 (95.7625%), train_poison_data_count: 385
Global model norm: 43.26926729432219.
Norm before scaling: 43.24879480347545. Distance: 1.3972099499998782
Total norm for 4 adversaries is: 43.24879480347545. distance: 1.3972099499998782
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.1674, Accuracy: 9451/9900 (95.4646%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5013/5305 (94.4958%), train_poison_data_count: 415
Global model norm: 43.26926729432219.
Norm before scaling: 43.25385245215881. Distance: 1.6174446675477758
Total norm for 4 adversaries is: 43.25385245215881. distance: 1.6174446675477758
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0950, Accuracy: 9645/9900 (97.4242%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4488/4717 (95.1452%), train_poison_data_count: 370
Global model norm: 43.26926729432219.
Norm before scaling: 43.24839823849332. Distance: 1.379564468583549
Total norm for 4 adversaries is: 43.24839823849332. distance: 1.379564468583549
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0681, Accuracy: 9727/9900 (98.2525%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 108, local model 71, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4808/5066 (94.9072%), train_poison_data_count: 400
Global model norm: 43.26926729432219.
Norm before scaling: 43.25281105387834. Distance: 1.565039592644285
Total norm for 4 adversaries is: 43.25281105387834. distance: 1.565039592644285
___Test Local_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.0511, Accuracy: 9768/9900 (98.6667%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3821/4175 (91.5210%)
___Train Local_ResNet_18,  epoch 108, local model 31, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3797/4175 (90.9461%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1357, Accuracy: 5406/10000 (54.0600%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4997/5455 (91.6040%)
___Train Local_ResNet_18,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4963/5455 (90.9808%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9747, Accuracy: 5411/10000 (54.1100%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3388/3704 (91.4687%)
___Train Local_ResNet_18,  epoch 108, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 3435/3704 (92.7376%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8402, Accuracy: 5787/10000 (57.8700%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4478/4989 (89.7575%)
___Train Local_ResNet_18,  epoch 108, local model 56, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4463/4989 (89.4568%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9590, Accuracy: 5571/10000 (55.7100%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4511/4928 (91.5381%)
___Train Local_ResNet_18,  epoch 108, local model 16, internal_epoch   2,  Average loss: 0.0049, Accuracy: 4447/4928 (90.2394%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0759, Accuracy: 5469/10000 (54.6900%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3488/3804 (91.6930%)
___Train Local_ResNet_18,  epoch 108, local model 60, internal_epoch   2,  Average loss: 0.0038, Accuracy: 3527/3804 (92.7182%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0851, Accuracy: 5453/10000 (54.5300%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3954/4336 (91.1900%)
___Train Local_ResNet_18,  epoch 108, local model 41, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3935/4336 (90.7518%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0266, Accuracy: 5366/10000 (53.6600%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3711/4046 (91.7202%)
___Train Local_ResNet_18,  epoch 108, local model 59, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3699/4046 (91.4236%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8275, Accuracy: 5654/10000 (56.5400%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4368/4793 (91.1329%)
___Train Local_ResNet_18,  epoch 108, local model 84, internal_epoch   2,  Average loss: 0.0043, Accuracy: 4379/4793 (91.3624%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8872, Accuracy: 5659/10000 (56.5900%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3483/3756 (92.7316%)
___Train Local_ResNet_18,  epoch 108, local model 26, internal_epoch   2,  Average loss: 0.0034, Accuracy: 3518/3756 (93.6635%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9358, Accuracy: 5522/10000 (55.2200%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5711/6391 (89.3600%)
___Train Local_ResNet_18,  epoch 108, local model 85, internal_epoch   2,  Average loss: 0.0066, Accuracy: 5553/6391 (86.8878%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.3294, Accuracy: 5048/10000 (50.4800%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3323/3672 (90.4956%)
___Train Local_ResNet_18,  epoch 108, local model 87, internal_epoch   2,  Average loss: 0.0045, Accuracy: 3359/3672 (91.4760%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.9699, Accuracy: 5493/10000 (54.9300%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4140/4558 (90.8293%)
___Train Local_ResNet_18,  epoch 108, local model 57, internal_epoch   2,  Average loss: 0.0051, Accuracy: 4111/4558 (90.1931%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.1433, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4221/4576 (92.2421%)
___Train Local_ResNet_18,  epoch 108, local model 43, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4175/4576 (91.2369%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.0615, Accuracy: 5443/10000 (54.4300%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4138/4456 (92.8636%)
___Train Local_ResNet_18,  epoch 108, local model 66, internal_epoch   2,  Average loss: 0.0033, Accuracy: 4182/4456 (93.8510%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.8728, Accuracy: 5685/10000 (56.8500%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4060/4356 (93.2048%)
___Train Local_ResNet_18,  epoch 108, local model 55, internal_epoch   2,  Average loss: 0.0088, Accuracy: 3640/4356 (83.5629%)
___Test Local_ResNet_18 poisoned: False, epoch: 108: Average loss: 2.5224, Accuracy: 4829/10000 (48.2900%)
time spent on training: 233.69804191589355
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 31, confusion matrix appended.
Validation completed for user 40, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 56, confusion matrix appended.
Validation completed for user 16, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 41, confusion matrix appended.
Validation completed for user 59, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 26, confusion matrix appended.
Validation completed for user 85, confusion matrix appended.
Validation completed for user 87, confusion matrix appended.
Validation completed for user 57, confusion matrix appended.
Validation completed for user 43, confusion matrix appended.
Validation completed for user 66, confusion matrix appended.
Validation completed for user 55, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 108: Average loss: 1.1840, Accuracy: 6919/10000 (69.1900%)
___Test Target_ResNet_18 poisoned: True, epoch: 108: Average loss: 0.4532, Accuracy: 8753/9900 (88.4141%)
Done in 258.24027585983276 sec.
Server Epoch:109 choose agents : [13, 36, 58, 71, 67, 15, 19, 61, 91, 62, 53, 37, 80, 96, 84, 34, 35, 33, 64, 47].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4674/4885 (95.6807%), train_poison_data_count: 385
Global model norm: 43.29078330251501.
Norm before scaling: 43.26904583126877. Distance: 1.3870039955444653
Total norm for 4 adversaries is: 43.26904583126877. distance: 1.3870039955444653
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0662, Accuracy: 9734/9900 (98.3232%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5039/5305 (94.9859%), train_poison_data_count: 415
Global model norm: 43.29078330251501.
Norm before scaling: 43.273067254464124. Distance: 1.5733962264798713
Total norm for 4 adversaries is: 43.273067254464124. distance: 1.5733962264798713
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.1048, Accuracy: 9617/9900 (97.1414%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4481/4717 (94.9968%), train_poison_data_count: 370
Global model norm: 43.29078330251501.
Norm before scaling: 43.27300096254808. Distance: 1.4530482938476408
Total norm for 4 adversaries is: 43.27300096254808. distance: 1.4530482938476408
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0512, Accuracy: 9751/9900 (98.4949%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 109, local model 71, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4831/5066 (95.3612%), train_poison_data_count: 400
Global model norm: 43.29078330251501.
Norm before scaling: 43.27365400401698. Distance: 1.512418126814398
Total norm for 4 adversaries is: 43.27365400401698. distance: 1.512418126814398
___Test Local_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.0566, Accuracy: 9757/9900 (98.5556%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4632/5116 (90.5395%)
___Train Local_ResNet_18,  epoch 109, local model 67, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4560/5116 (89.1321%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0319, Accuracy: 5391/10000 (53.9100%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5183/5582 (92.8520%)
___Train Local_ResNet_18,  epoch 109, local model 15, internal_epoch   2,  Average loss: 0.0046, Accuracy: 5083/5582 (91.0606%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1248, Accuracy: 5223/10000 (52.2300%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4410/4928 (89.4886%)
___Train Local_ResNet_18,  epoch 109, local model 19, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4471/4928 (90.7265%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0105, Accuracy: 5455/10000 (54.5500%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3849/4126 (93.2865%)
___Train Local_ResNet_18,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3818/4126 (92.5351%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8319, Accuracy: 5742/10000 (57.4200%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3694/4158 (88.8408%)
___Train Local_ResNet_18,  epoch 109, local model 91, internal_epoch   2,  Average loss: 0.0059, Accuracy: 3686/4158 (88.6484%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.9485, Accuracy: 5506/10000 (55.0600%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4550/5063 (89.8677%)
___Train Local_ResNet_18,  epoch 109, local model 62, internal_epoch   2,  Average loss: 0.0066, Accuracy: 4407/5063 (87.0433%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1556, Accuracy: 5215/10000 (52.1500%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5488/6124 (89.6146%)
___Train Local_ResNet_18,  epoch 109, local model 53, internal_epoch   2,  Average loss: 0.0059, Accuracy: 5408/6124 (88.3083%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0366, Accuracy: 5286/10000 (52.8600%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3976/4354 (91.3183%)
___Train Local_ResNet_18,  epoch 109, local model 37, internal_epoch   2,  Average loss: 0.0074, Accuracy: 3776/4354 (86.7249%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.7667, Accuracy: 4441/10000 (44.4100%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4582/5025 (91.1841%)
___Train Local_ResNet_18,  epoch 109, local model 80, internal_epoch   2,  Average loss: 0.0041, Accuracy: 4611/5025 (91.7612%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0322, Accuracy: 5472/10000 (54.7200%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4336/4679 (92.6694%)
___Train Local_ResNet_18,  epoch 109, local model 96, internal_epoch   2,  Average loss: 0.0061, Accuracy: 4125/4679 (88.1599%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.2350, Accuracy: 5108/10000 (51.0800%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4400/4793 (91.8005%)
___Train Local_ResNet_18,  epoch 109, local model 84, internal_epoch   2,  Average loss: 0.0040, Accuracy: 4431/4793 (92.4473%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8576, Accuracy: 5673/10000 (56.7300%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4167/4518 (92.2311%)
___Train Local_ResNet_18,  epoch 109, local model 34, internal_epoch   2,  Average loss: 0.0039, Accuracy: 4178/4518 (92.4745%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.0216, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4720/5167 (91.3489%)
___Train Local_ResNet_18,  epoch 109, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4660/5167 (90.1877%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1204, Accuracy: 5256/10000 (52.5600%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4150/4433 (93.6161%)
___Train Local_ResNet_18,  epoch 109, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4031/4433 (90.9316%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8913, Accuracy: 5687/10000 (56.8700%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4131/4503 (91.7388%)
___Train Local_ResNet_18,  epoch 109, local model 64, internal_epoch   2,  Average loss: 0.0047, Accuracy: 4105/4503 (91.1614%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 2.1237, Accuracy: 5257/10000 (52.5700%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4350/4707 (92.4156%)
___Train Local_ResNet_18,  epoch 109, local model 47, internal_epoch   2,  Average loss: 0.0046, Accuracy: 4282/4707 (90.9709%)
___Test Local_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.8775, Accuracy: 5745/10000 (57.4500%)
time spent on training: 239.02947354316711
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 67, confusion matrix appended.
Validation completed for user 15, confusion matrix appended.
Validation completed for user 19, confusion matrix appended.
Validation completed for user 61, confusion matrix appended.
Validation completed for user 91, confusion matrix appended.
Validation completed for user 62, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 37, confusion matrix appended.
Validation completed for user 80, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 84, confusion matrix appended.
Validation completed for user 34, confusion matrix appended.
Validation completed for user 35, confusion matrix appended.
Validation completed for user 33, confusion matrix appended.
Validation completed for user 64, confusion matrix appended.
Validation completed for user 47, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 109: Average loss: 1.1851, Accuracy: 6926/10000 (69.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 109: Average loss: 0.4365, Accuracy: 8782/9900 (88.7071%)
Done in 263.0301649570465 sec.
Server Epoch:110 choose agents : [13, 36, 58, 71, 4, 70, 90, 6, 23, 26, 96, 30, 85, 9, 25, 53, 12, 99, 60, 3].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4676/4885 (95.7216%), train_poison_data_count: 385
Global model norm: 43.314109254916865.
Norm before scaling: 43.29459265231269. Distance: 1.4249851460268261
Total norm for 4 adversaries is: 43.29459265231269. distance: 1.4249851460268261
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.2091, Accuracy: 9370/9900 (94.6465%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5021/5305 (94.6466%), train_poison_data_count: 415
Global model norm: 43.314109254916865.
Norm before scaling: 43.2948830627138. Distance: 1.5684967930924838
Total norm for 4 adversaries is: 43.2948830627138. distance: 1.5684967930924838
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1125, Accuracy: 9598/9900 (96.9495%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4497/4717 (95.3360%), train_poison_data_count: 370
Global model norm: 43.314109254916865.
Norm before scaling: 43.29220162661732. Distance: 1.3668393372957872
Total norm for 4 adversaries is: 43.29220162661732. distance: 1.3668393372957872
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.0922, Accuracy: 9659/9900 (97.5657%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 110, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4847/5066 (95.6771%), train_poison_data_count: 400
Global model norm: 43.314109254916865.
Norm before scaling: 43.2969891847105. Distance: 1.4903247650851223
Total norm for 4 adversaries is: 43.2969891847105. distance: 1.4903247650851223
___Test Local_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.1841, Accuracy: 9434/9900 (95.2929%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3402/3704 (91.8467%)
___Train Local_ResNet_18,  epoch 110, local model 4, internal_epoch   2,  Average loss: 0.0043, Accuracy: 3391/3704 (91.5497%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8834, Accuracy: 5746/10000 (57.4600%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4903/5392 (90.9310%)
___Train Local_ResNet_18,  epoch 110, local model 70, internal_epoch   2,  Average loss: 0.0057, Accuracy: 4806/5392 (89.1320%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1337, Accuracy: 5253/10000 (52.5300%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4074/4362 (93.3975%)
___Train Local_ResNet_18,  epoch 110, local model 90, internal_epoch   2,  Average loss: 0.0037, Accuracy: 4068/4362 (93.2600%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9152, Accuracy: 5609/10000 (56.0900%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4211/4538 (92.7942%)
___Train Local_ResNet_18,  epoch 110, local model 6, internal_epoch   2,  Average loss: 0.0035, Accuracy: 4232/4538 (93.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8441, Accuracy: 5737/10000 (57.3700%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3850/4184 (92.0172%)
___Train Local_ResNet_18,  epoch 110, local model 23, internal_epoch   2,  Average loss: 0.0047, Accuracy: 3805/4184 (90.9417%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8335, Accuracy: 5776/10000 (57.7600%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3475/3756 (92.5186%)
___Train Local_ResNet_18,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0036, Accuracy: 3495/3756 (93.0511%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.9502, Accuracy: 5639/10000 (56.3900%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4317/4679 (92.2633%)
___Train Local_ResNet_18,  epoch 110, local model 96, internal_epoch   2,  Average loss: 0.0055, Accuracy: 4180/4679 (89.3353%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1719, Accuracy: 5304/10000 (53.0400%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3234/3472 (93.1452%)
___Train Local_ResNet_18,  epoch 110, local model 30, internal_epoch   2,  Average loss: 0.0039, Accuracy: 3226/3472 (92.9147%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1062, Accuracy: 5332/10000 (53.3200%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5700/6391 (89.1879%)
___Train Local_ResNet_18,  epoch 110, local model 85, internal_epoch   2,  Average loss: 0.0062, Accuracy: 5598/6391 (87.5919%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0788, Accuracy: 5240/10000 (52.4000%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4789/5265 (90.9592%)
___Train Local_ResNet_18,  epoch 110, local model 9, internal_epoch   2,  Average loss: 0.0072, Accuracy: 4503/5265 (85.5271%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.2019, Accuracy: 5133/10000 (51.3300%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5276/5902 (89.3934%)
___Train Local_ResNet_18,  epoch 110, local model 25, internal_epoch   2,  Average loss: 0.0064, Accuracy: 5142/5902 (87.1230%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.3261, Accuracy: 5093/10000 (50.9300%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5442/6124 (88.8635%)
___Train Local_ResNet_18,  epoch 110, local model 53, internal_epoch   2,  Average loss: 0.0060, Accuracy: 5396/6124 (88.1123%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.1592, Accuracy: 5172/10000 (51.7200%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4642/5083 (91.3240%)
___Train Local_ResNet_18,  epoch 110, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 4599/5083 (90.4781%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0415, Accuracy: 5375/10000 (53.7500%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4130/4465 (92.4972%)
___Train Local_ResNet_18,  epoch 110, local model 99, internal_epoch   2,  Average loss: 0.0036, Accuracy: 4152/4465 (92.9899%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8834, Accuracy: 5700/10000 (57.0000%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3498/3804 (91.9558%)
___Train Local_ResNet_18,  epoch 110, local model 60, internal_epoch   2,  Average loss: 0.0041, Accuracy: 3518/3804 (92.4816%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.8732, Accuracy: 5712/10000 (57.1200%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4532/4918 (92.1513%)
___Train Local_ResNet_18,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0044, Accuracy: 4495/4918 (91.3989%)
___Test Local_ResNet_18 poisoned: False, epoch: 110: Average loss: 2.0025, Accuracy: 5477/10000 (54.7700%)
time spent on training: 238.3797812461853
!!!!!!! Updates: 20, Expected shape: (20, 2820740)
Collected gradients for 20 agents.
users count: 20 and corrupted count: 4.
Original model state backed up.
Validation completed, confusion matrix created.
Validation completed for user 13, confusion matrix appended.
Validation completed for user 36, confusion matrix appended.
Validation completed for user 58, confusion matrix appended.
Validation completed for user 71, confusion matrix appended.
Validation completed for user 4, confusion matrix appended.
Validation completed for user 70, confusion matrix appended.
Validation completed for user 90, confusion matrix appended.
Validation completed for user 6, confusion matrix appended.
Validation completed for user 23, confusion matrix appended.
Validation completed for user 26, confusion matrix appended.
Validation completed for user 96, confusion matrix appended.
Validation completed for user 30, confusion matrix appended.
Validation completed for user 85, confusion matrix appended.
Validation completed for user 9, confusion matrix appended.
Validation completed for user 25, confusion matrix appended.
Validation completed for user 53, confusion matrix appended.
Validation completed for user 12, confusion matrix appended.
Validation completed for user 99, confusion matrix appended.
Validation completed for user 60, confusion matrix appended.
Validation completed for user 3, confusion matrix appended.
Suspicious clients identified: []
Central model updated with weighted gradients.
Identified adversaries: []
Actual adversaries: [13, 36, 58, 71]
Accuracy of identifying adversarial clients: 0.00% (0/4 correctly identified).
___Test Target_ResNet_18 poisoned: False, epoch: 110: Average loss: 1.1854, Accuracy: 6915/10000 (69.1500%)
___Test Target_ResNet_18 poisoned: True, epoch: 110: Average loss: 0.4324, Accuracy: 8798/9900 (88.8687%)
Done in 262.6803352832794 sec.
Server Epoch:111 choose agents : [13, 36, 58, 71, 6, 56, 84, 91, 14, 22, 10, 49, 35, 74, 37, 40, 66, 83, 68, 32].
poison local model 13 index 0 
poison_now
start trigger fine-tuning
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4693/4885 (96.0696%), train_poison_data_count: 385
Global model norm: 43.336969154612234.
Norm before scaling: 43.31662306764431. Distance: 1.4092680017154933
Total norm for 4 adversaries is: 43.31662306764431. distance: 1.4092680017154933
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.1116, Accuracy: 9622/9900 (97.1919%)
poison local model 36 index 1 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5039/5305 (94.9859%), train_poison_data_count: 415
Global model norm: 43.336969154612234.
Norm before scaling: 43.31849846855628. Distance: 1.5703209264728437
Total norm for 4 adversaries is: 43.31849846855628. distance: 1.5703209264728437
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0394, Accuracy: 9799/9900 (98.9798%)
poison local model 58 index 2 
poison_now
normally training
save normal model, normally training ending
Current lr: [0.005]
___PoisonTrain Local_ResNet_18 , epoch 111, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4520/4717 (95.8236%), train_poison_data_count: 370
Global model norm: 43.336969154612234.
Norm before scaling: 43.315054769982254. Distance: 1.2932023128446362
Total norm for 4 adversaries is: 43.315054769982254. distance: 1.2932023128446362
___Test Local_ResNet_18 poisoned: True, epoch: 111: Average loss: 0.0997, Accuracy: 9621/9900 (97.1818%)
poison local model 71 index 3 
poison_now
normally training
save normal model, normally training ending
